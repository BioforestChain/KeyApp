# BFM Pay 软件开发说明书

> **版本**：1.0  
> **状态**：编写中  
> **最后更新**：2024年12月

---

## 关于本书

本说明书是 BFM Pay 多链钱包应用的完整技术文档，涵盖从产品设计到技术实现的全部内容。

**BFM Pay** 是一款现代化的多链数字钱包，是 mpay 的技术重构版本。在保留原有功能的同时，在交互体验、视觉设计、代码质量和项目管理上进行了全面提升。

---

## 目录

### [第一篇：产品篇](./01-产品篇/)

定义产品的「做什么」和「为什么」。

| 章节 | 内容 |
|-----|------|
| [01 产品愿景](./01-产品篇/01-产品愿景/) | 产品定位、目标市场、价值主张 |
| [02 用户画像](./01-产品篇/02-用户画像/) | 用户分析、心智模型、需求洞察 |
| [03 用户故事](./01-产品篇/03-用户故事/) | 核心 Epic、用户旅程、验收标准 |

### [第二篇：设计篇](./02-设计篇/)

定义产品的「长什么样」。

| 章节 | 内容 |
|-----|------|
| [01 交互设计](./02-设计篇/01-交互设计/) | 信息架构、导航流程、页面结构 |
| [02 视觉设计](./02-设计篇/02-视觉设计/) | 设计系统、色彩、字体、图标 |
| [03 设计原则](./02-设计篇/03-设计原则/) | 信任优先、渐进复杂度、响应式 |

### [第三篇：架构篇](./03-架构篇/)

定义产品的「怎么构建」。

| 章节 | 内容 |
|-----|------|
| [01 技术选型](./03-架构篇/01-技术选型/) | 技术栈、选型理由、版本说明 |
| [02 系统架构](./03-架构篇/02-系统架构/) | 分层架构、模块划分、依赖关系 |
| [03 导航系统](./03-架构篇/03-导航系统/) | 栈式导航、路由设计、手势返回 |
| [04 状态管理](./03-架构篇/04-状态管理/) | 客户端状态、服务端状态、持久化 |
| [05 离线能力](./03-架构篇/05-离线能力/) | 离线检测、缓存策略、离线签名 |
| [06 错误处理](./03-架构篇/06-错误处理/) | 错误码目录、恢复策略、UI 规范 |
| [07 性能预算](./03-架构篇/07-性能预算/) | 加载指标、操作预算、包体积限制 |

### [第四篇：服务篇](./04-服务篇/)

定义产品的「数据怎么流动」。

| 章节 | 内容 |
|-----|------|
| [01 服务架构](./04-服务篇/01-服务架构/) | 服务分层、Adapter 模式、Registry |
| [02 链服务](./04-服务篇/02-链服务/) | IAssetService、ITransactionService 等 |
| [03 平台服务](./04-服务篇/03-平台服务/) | 生物识别、安全存储、剪贴板 |
| [04 事件系统](./04-服务篇/04-事件系统/) | Subscribable、事件定义、订阅模式 |

### [第五篇：组件篇](./05-组件篇/)

定义产品的「UI 怎么构建」。

| 章节 | 内容 |
|-----|------|
| [01 基础组件](./05-组件篇/01-基础组件/) | Button、Input、Card、Sheet 等 |
| [02 通用组件](./05-组件篇/02-通用组件/) | AddressDisplay、AmountDisplay 等 |
| [03 钱包组件](./05-组件篇/03-钱包组件/) | WalletCard、ChainSelector 等 |
| [04 布局组件](./05-组件篇/04-布局组件/) | AppLayout、TabBar、Header |
| [05 表单系统](./05-组件篇/05-表单系统/) | 表单状态、验证、错误处理 |
| [06 交互规范](./05-组件篇/06-交互规范/) | 触摸、手势、动效、可访问性 |

### [第六篇：安全篇](./06-安全篇/)

定义产品的「如何保护用户」。

| 章节 | 内容 |
|-----|------|
| [01 密钥管理](./06-安全篇/01-密钥管理/) | 助记词生成、私钥派生、加密存储 |
| [02 身份认证](./06-安全篇/02-身份认证/) | 钱包锁（图案锁）、指纹支付、应用锁 |
| [03 DWEB 授权](./06-安全篇/03-DWEB授权/) | Plaoc 协议、授权流程、签名 |
| [04 安全审计清单](./06-安全篇/04-安全审计清单/) | 审计检查项、攻击防护、合规要求 |

### [第七篇：国际化篇](./07-国际化篇/)

定义产品的「如何支持多语言」。

| 章节 | 内容 |
|-----|------|
| [01 多语言支持](./07-国际化篇/01-多语言支持/) | i18next、语言检测、RTL 布局 |
| [02 本地化规范](./07-国际化篇/02-本地化规范/) | 翻译流程、格式化、术语表 |

### [第八篇：测试篇](./08-测试篇/)

定义产品的「如何保证质量」。

| 章节 | 内容 |
|-----|------|
| [01 测试策略](./08-测试篇/01-测试策略/) | 分层测试、覆盖率目标 |
| [02 Vitest 配置](./08-测试篇/02-Vitest配置/) | 单元测试、组件测试、Mock |
| [03 Playwright 配置](./08-测试篇/03-Playwright配置/) | E2E、截图、视觉回归 |
| [04 性能测试](./08-测试篇/04-性能测试/) | 性能指标、回归检测、自动化 |
| [05 安全测试](./08-测试篇/05-安全测试/) | SAST、SCA、渗透测试 |
| [06 测试网络](./08-测试篇/06-测试网络/) | Sepolia、BSC Testnet、Nile、Signet |

### [第九篇：部署篇](./09-部署篇/)

定义产品的「如何发布和运维」。

| 章节 | 内容 |
|-----|------|
| [01 构建配置](./09-部署篇/01-构建配置/) | Vite、环境变量、多目标构建 |
| [02 发布流程](./09-部署篇/02-发布流程/) | Web、DWEB、版本管理 |
| [03 数据迁移](./09-部署篇/03-数据迁移/) | 版本化存储、迁移策略、向后兼容 |
| [04 监控告警](./09-部署篇/04-监控告警/) | 埋点规范、性能监控、告警规则 |

### [附录](./附录/)

| 附录 | 内容 |
|-----|------|
| [A 术语表](./附录/A-术语表/) | 技术术语、用户术语对照 |
| [B 链网络列表](./附录/B-链网络列表/) | 支持的区块链、配置参数 |
| [C mpay 迁移指南](./附录/C-mpay迁移指南/) | 原始代码参考、迁移注意事项 |
| [D API 参考](./附录/D-API参考/) | 核心 API、类型定义 |
| [E 状态机规范](./附录/E-状态机规范/) | 核心流程状态机定义 |
| [F 边界条件目录](./附录/F-边界条件目录/) | 各功能边界条件处理 |
| [G 网络故障矩阵](./附录/G-网络故障矩阵/) | 故障场景检测和处理 |

---

## 阅读建议

| 读者角色 | 推荐阅读路径 |
|---------|-------------|
| **产品经理** | 第一篇 → 第二篇 → 第六篇 |
| **前端开发** | 第三篇 → 第五篇 → 第八篇 |
| **服务开发** | 第四篇 → 第六篇 |
| **测试工程师** | 第八篇 → 附录 |
| **新成员入职** | 本目录 → 第一篇 → 第三篇 → 附录C |

---

## 文档来源

本说明书基于以下项目核心文档展开：

| 文档 | 说明 | 对应章节 |
|-----|------|---------|
| `PDR.md` | 产品需求文档 | 第一篇、第二篇、第六篇 |
| `TDD.md` | 技术设计文档 | 第三篇、第五篇、第七篇、第八篇、第九篇 |
| `SERVICE-SPEC.md` | 服务接口规范 | 第四篇 |
| mpay 原始代码 | 参考实现 | 附录C |

**文档优先级**：`TDD.md > PDR.md > SERVICE-SPEC.md > mpay 原始代码`

---

## 版本历史

| 版本 | 日期 | 变更说明 |
|-----|------|---------|
| 1.0 | 2024-12 | 初版发布 |
