# 第二十三章：测试策略

> 分层测试、覆盖率目标

---

## 23.1 测试分层

| 层级 | 工具 | 测试内容 | 运行频率 |
|-----|------|---------|---------|
| 单元测试 | Vitest | 业务逻辑、工具函数、Hooks | 每次提交 |
| 组件测试 | Storybook + Vitest | 组件交互、状态 | 每次提交 |
| E2E 测试 | Playwright | 完整用户流程 | PR / 发布前 |

---

## 23.2 覆盖率目标

| 类型 | 目标 |
|-----|------|
| 语句覆盖 | ≥ 70% |
| 分支覆盖 | ≥ 70% |
| 函数覆盖 | ≥ 70% |
| 行覆盖 | ≥ 70% |

---

## 23.3 测试优先级

| 优先级 | 测试内容 |
|-------|---------|
| P0 | 密钥生成/派生、加密/解密、签名验证 |
| P1 | 钱包创建/导入、转账流程 |
| P2 | 余额查询、交易历史 |
| P3 | 设置、语言切换 |

---

## 23.4 测试命名规范

```typescript
describe('WalletStore', () => {
  describe('addWallet', () => {
    it('should add wallet to list', () => {})
    it('should set as current wallet', () => {})
    it('should persist to localStorage', () => {})
  })
})
```

---

## 本章小结

- 三层测试：单元 → 组件 → E2E
- 覆盖率目标 70%
- 安全相关代码优先测试
