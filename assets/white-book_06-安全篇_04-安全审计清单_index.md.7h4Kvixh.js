import{_ as d,c as a,o as r,ag as e}from"./chunks/framework.B0we9iV-.js";const c=JSON.parse('{"title":"安全审计清单","description":"","frontmatter":{},"headers":[],"relativePath":"white-book/06-安全篇/04-安全审计清单/index.md","filePath":"white-book/06-安全篇/04-安全审计清单/index.md"}'),n={name:"white-book/06-安全篇/04-安全审计清单/index.md"};function l(o,t,h,s,i,b){return r(),a("div",null,[...t[0]||(t[0]=[e(`<h1 id="安全审计清单" tabindex="-1">安全审计清单 <a class="header-anchor" href="#安全审计清单" aria-label="Permalink to &quot;安全审计清单&quot;">​</a></h1><blockquote><p>定义安全审计检查项和常见攻击防护规范</p></blockquote><hr><h2 id="审计检查清单" tabindex="-1">审计检查清单 <a class="header-anchor" href="#审计检查清单" aria-label="Permalink to &quot;审计检查清单&quot;">​</a></h2><h3 id="_1-密钥安全" tabindex="-1">1. 密钥安全 <a class="header-anchor" href="#_1-密钥安全" aria-label="Permalink to &quot;1. 密钥安全&quot;">​</a></h3><table tabindex="0"><thead><tr><th>检查项</th><th>要求级别</th><th>说明</th></tr></thead><tbody><tr><td>助记词不明文存储</td><td>MUST</td><td>必须加密存储</td></tr><tr><td>私钥不明文存储</td><td>MUST</td><td>必须加密存储</td></tr><tr><td>密钥不出现在日志</td><td>MUST</td><td>禁止记录敏感数据</td></tr><tr><td>密钥不通过网络传输</td><td>MUST</td><td>所有签名本地完成</td></tr><tr><td>使用后清除内存</td><td>MUST</td><td>及时清理敏感变量</td></tr><tr><td>加密使用安全随机数</td><td>MUST</td><td>crypto.getRandomValues</td></tr><tr><td>PBKDF2 迭代次数足够</td><td>MUST</td><td>≥100,000 次</td></tr><tr><td>使用安全的加密算法</td><td>MUST</td><td>AES-256-GCM</td></tr></tbody></table><h3 id="_2-认证安全" tabindex="-1">2. 认证安全 <a class="header-anchor" href="#_2-认证安全" aria-label="Permalink to &quot;2. 认证安全&quot;">​</a></h3><table tabindex="0"><thead><tr><th>检查项</th><th>要求级别</th><th>说明</th></tr></thead><tbody><tr><td>图案复杂度验证</td><td>MUST</td><td>至少4点</td></tr><tr><td>图案错误次数限制</td><td>MUST</td><td>防暴力破解</td></tr><tr><td>图案不明文传输</td><td>MUST</td><td>本地验证</td></tr><tr><td>会话超时自动锁定</td><td>SHOULD</td><td>默认 5 分钟</td></tr><tr><td>生物识别有图案锁回退</td><td>MUST</td><td>防止锁死</td></tr></tbody></table><h3 id="_3-数据安全" tabindex="-1">3. 数据安全 <a class="header-anchor" href="#_3-数据安全" aria-label="Permalink to &quot;3. 数据安全&quot;">​</a></h3><table tabindex="0"><thead><tr><th>检查项</th><th>要求级别</th><th>说明</th></tr></thead><tbody><tr><td>敏感数据加密存储</td><td>MUST</td><td>钱包数据</td></tr><tr><td>缓存数据有过期机制</td><td>SHOULD</td><td>防止数据泄露</td></tr><tr><td>剪贴板敏感数据及时清除</td><td>SHOULD</td><td>复制后 30s 清除</td></tr><tr><td>不在 URL 中传递敏感数据</td><td>MUST</td><td>防止历史记录泄露</td></tr><tr><td>导出数据加密</td><td>SHOULD</td><td>备份文件加密</td></tr></tbody></table><h3 id="_4-网络安全" tabindex="-1">4. 网络安全 <a class="header-anchor" href="#_4-网络安全" aria-label="Permalink to &quot;4. 网络安全&quot;">​</a></h3><table tabindex="0"><thead><tr><th>检查项</th><th>要求级别</th><th>说明</th></tr></thead><tbody><tr><td>使用 HTTPS</td><td>MUST</td><td>所有 API 请求</td></tr><tr><td>验证 SSL 证书</td><td>MUST</td><td>防中间人攻击</td></tr><tr><td>API 请求签名</td><td>SHOULD</td><td>防篡改</td></tr><tr><td>防重放攻击</td><td>SHOULD</td><td>请求时间戳/nonce</td></tr></tbody></table><h3 id="_5-输入验证" tabindex="-1">5. 输入验证 <a class="header-anchor" href="#_5-输入验证" aria-label="Permalink to &quot;5. 输入验证&quot;">​</a></h3><table tabindex="0"><thead><tr><th>检查项</th><th>要求级别</th><th>说明</th></tr></thead><tbody><tr><td>地址格式验证</td><td>MUST</td><td>防止转错链</td></tr><tr><td>金额范围验证</td><td>MUST</td><td>防止溢出</td></tr><tr><td>二维码内容验证</td><td>MUST</td><td>防恶意链接</td></tr><tr><td>深度链接参数验证</td><td>MUST</td><td>防注入攻击</td></tr><tr><td>HTML/JS 注入防护</td><td>MUST</td><td>XSS 防护</td></tr></tbody></table><h3 id="_6-授权安全" tabindex="-1">6. 授权安全 <a class="header-anchor" href="#_6-授权安全" aria-label="Permalink to &quot;6. 授权安全&quot;">​</a></h3><table tabindex="0"><thead><tr><th>检查项</th><th>要求级别</th><th>说明</th></tr></thead><tbody><tr><td>DWEB 授权需用户确认</td><td>MUST</td><td>显示授权详情</td></tr><tr><td>签名内容可读展示</td><td>MUST</td><td>用户可理解</td></tr><tr><td>授权范围最小化</td><td>SHOULD</td><td>按需授权</td></tr><tr><td>授权可撤销</td><td>SHOULD</td><td>管理已授权应用</td></tr></tbody></table><hr><h2 id="常见攻击防护" tabindex="-1">常见攻击防护 <a class="header-anchor" href="#常见攻击防护" aria-label="Permalink to &quot;常见攻击防护&quot;">​</a></h2><h3 id="xss-跨站脚本攻击" tabindex="-1">XSS (跨站脚本攻击) <a class="header-anchor" href="#xss-跨站脚本攻击" aria-label="Permalink to &quot;XSS (跨站脚本攻击)&quot;">​</a></h3><p><strong>攻击方式：</strong> 注入恶意脚本窃取数据</p><p><strong>防护措施：</strong></p><ul><li><strong>MUST</strong> 对用户输入进行转义</li><li><strong>MUST</strong> 使用 Content-Security-Policy</li><li><strong>MUST</strong> 避免使用 innerHTML</li><li><strong>SHOULD</strong> 使用框架自带的 XSS 防护</li></ul><p><strong>检查点：</strong></p><table tabindex="0"><thead><tr><th>位置</th><th>检查内容</th></tr></thead><tbody><tr><td>地址输入</td><td>禁止 HTML 标签</td></tr><tr><td>备注输入</td><td>转义特殊字符</td></tr><tr><td>二维码解析</td><td>验证 URL 格式</td></tr></tbody></table><h3 id="钓鱼攻击" tabindex="-1">钓鱼攻击 <a class="header-anchor" href="#钓鱼攻击" aria-label="Permalink to &quot;钓鱼攻击&quot;">​</a></h3><p><strong>攻击方式：</strong> 伪造界面骗取助记词/图案</p><p><strong>防护措施：</strong></p><ul><li><strong>MUST</strong> 显示应用来源标识</li><li><strong>MUST</strong> 授权页面显示请求方信息</li><li><strong>SHOULD</strong> 提供反钓鱼码功能</li><li><strong>SHOULD</strong> 警告可疑请求</li></ul><p><strong>检查点：</strong></p><table tabindex="0"><thead><tr><th>场景</th><th>防护</th></tr></thead><tbody><tr><td>DWEB 授权</td><td>显示 DApp 域名</td></tr><tr><td>签名请求</td><td>解析并显示内容</td></tr><tr><td>深度链接</td><td>显示来源应用</td></tr></tbody></table><h3 id="重放攻击" tabindex="-1">重放攻击 <a class="header-anchor" href="#重放攻击" aria-label="Permalink to &quot;重放攻击&quot;">​</a></h3><p><strong>攻击方式：</strong> 重复发送已签名的交易</p><p><strong>防护措施：</strong></p><ul><li><strong>MUST</strong> 交易包含 nonce</li><li><strong>MUST</strong> 每笔交易 nonce 递增</li><li><strong>SHOULD</strong> 检测重复交易</li></ul><h3 id="中间人攻击" tabindex="-1">中间人攻击 <a class="header-anchor" href="#中间人攻击" aria-label="Permalink to &quot;中间人攻击&quot;">​</a></h3><p><strong>攻击方式：</strong> 拦截并篡改网络请求</p><p><strong>防护措施：</strong></p><ul><li><strong>MUST</strong> 使用 HTTPS</li><li><strong>MUST</strong> 验证 SSL 证书</li><li><strong>SHOULD</strong> 证书固定 (Certificate Pinning)</li><li><strong>SHOULD</strong> 本地签名，服务端不接触私钥</li></ul><h3 id="侧信道攻击" tabindex="-1">侧信道攻击 <a class="header-anchor" href="#侧信道攻击" aria-label="Permalink to &quot;侧信道攻击&quot;">​</a></h3><p><strong>攻击方式：</strong> 通过时序/功耗分析推断密钥</p><p><strong>防护措施：</strong></p><ul><li><strong>SHOULD</strong> 使用恒定时间的图案比较</li><li><strong>SHOULD</strong> 图案验证添加随机延迟</li><li><strong>SHOULD</strong> 使用经过审计的加密库</li></ul><h3 id="社会工程攻击" tabindex="-1">社会工程攻击 <a class="header-anchor" href="#社会工程攻击" aria-label="Permalink to &quot;社会工程攻击&quot;">​</a></h3><p><strong>攻击方式：</strong> 欺骗用户泄露信息</p><p><strong>防护措施：</strong></p><ul><li><strong>MUST</strong> 明确告知&quot;永远不要分享助记词&quot;</li><li><strong>MUST</strong> 敏感操作需二次确认</li><li><strong>SHOULD</strong> 可疑操作显示警告</li><li><strong>SHOULD</strong> 提供安全教育内容</li></ul><hr><h2 id="安全开发规范" tabindex="-1">安全开发规范 <a class="header-anchor" href="#安全开发规范" aria-label="Permalink to &quot;安全开发规范&quot;">​</a></h2><h3 id="代码审查要点" tabindex="-1">代码审查要点 <a class="header-anchor" href="#代码审查要点" aria-label="Permalink to &quot;代码审查要点&quot;">​</a></h3><table tabindex="0"><thead><tr><th>类别</th><th>检查点</th></tr></thead><tbody><tr><td>密钥处理</td><td>是否加密、是否及时清除</td></tr><tr><td>用户输入</td><td>是否验证、是否转义</td></tr><tr><td>网络请求</td><td>是否 HTTPS、是否验证响应</td></tr><tr><td>错误处理</td><td>是否泄露敏感信息</td></tr><tr><td>日志记录</td><td>是否记录敏感数据</td></tr></tbody></table><h3 id="依赖安全" tabindex="-1">依赖安全 <a class="header-anchor" href="#依赖安全" aria-label="Permalink to &quot;依赖安全&quot;">​</a></h3><table tabindex="0"><thead><tr><th>要求</th><th>说明</th></tr></thead><tbody><tr><td>定期更新依赖</td><td>修复已知漏洞</td></tr><tr><td>检查依赖许可</td><td>避免法律风险</td></tr><tr><td>使用 lockfile</td><td>锁定依赖版本</td></tr><tr><td>审计依赖</td><td>npm audit / pnpm audit</td></tr></tbody></table><h3 id="安全测试" tabindex="-1">安全测试 <a class="header-anchor" href="#安全测试" aria-label="Permalink to &quot;安全测试&quot;">​</a></h3><table tabindex="0"><thead><tr><th>测试类型</th><th>说明</th></tr></thead><tbody><tr><td>渗透测试</td><td>模拟攻击</td></tr><tr><td>代码审计</td><td>静态分析</td></tr><tr><td>模糊测试</td><td>异常输入测试</td></tr><tr><td>依赖扫描</td><td>漏洞检测</td></tr></tbody></table><hr><h2 id="事件响应" tabindex="-1">事件响应 <a class="header-anchor" href="#事件响应" aria-label="Permalink to &quot;事件响应&quot;">​</a></h2><h3 id="安全事件分级" tabindex="-1">安全事件分级 <a class="header-anchor" href="#安全事件分级" aria-label="Permalink to &quot;安全事件分级&quot;">​</a></h3><table tabindex="0"><thead><tr><th>级别</th><th>定义</th><th>响应时间</th></tr></thead><tbody><tr><td>P0</td><td>资产可能被盗</td><td>立即</td></tr><tr><td>P1</td><td>敏感数据泄露</td><td>1 小时</td></tr><tr><td>P2</td><td>功能性安全漏洞</td><td>24 小时</td></tr><tr><td>P3</td><td>潜在安全风险</td><td>1 周</td></tr></tbody></table><h3 id="响应流程" tabindex="-1">响应流程 <a class="header-anchor" href="#响应流程" aria-label="Permalink to &quot;响应流程&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>发现安全问题</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ▼</span></span>
<span class="line"><span>评估影响范围和级别</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ├── P0/P1 ──► 立即下线/热修复</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      └── P2/P3 ──► 排期修复</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ▼</span></span>
<span class="line"><span>修复并验证</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ▼</span></span>
<span class="line"><span>复盘和改进</span></span></code></pre></div><hr><h2 id="合规要求" tabindex="-1">合规要求 <a class="header-anchor" href="#合规要求" aria-label="Permalink to &quot;合规要求&quot;">​</a></h2><h3 id="数据保护" tabindex="-1">数据保护 <a class="header-anchor" href="#数据保护" aria-label="Permalink to &quot;数据保护&quot;">​</a></h3><table tabindex="0"><thead><tr><th>要求</th><th>说明</th></tr></thead><tbody><tr><td>最小数据收集</td><td>只收集必要数据</td></tr><tr><td>用户知情同意</td><td>告知数据用途</td></tr><tr><td>数据本地存储</td><td>敏感数据不上传</td></tr><tr><td>用户数据可删除</td><td>提供清除功能</td></tr></tbody></table><h3 id="加密标准" tabindex="-1">加密标准 <a class="header-anchor" href="#加密标准" aria-label="Permalink to &quot;加密标准&quot;">​</a></h3><table tabindex="0"><thead><tr><th>用途</th><th>算法</th><th>标准</th></tr></thead><tbody><tr><td>对称加密</td><td>AES-256-GCM</td><td>NIST</td></tr><tr><td>密钥派生</td><td>PBKDF2-SHA256</td><td>RFC 8018</td></tr><tr><td>随机数</td><td>CSPRNG</td><td>系统级</td></tr><tr><td>哈希</td><td>SHA-256/SHA-512</td><td>FIPS 180-4</td></tr></tbody></table><hr><h2 id="本章小结" tabindex="-1">本章小结 <a class="header-anchor" href="#本章小结" aria-label="Permalink to &quot;本章小结&quot;">​</a></h2><ul><li>全面的安全检查清单覆盖各个层面</li><li>针对常见攻击类型的具体防护措施</li><li>安全开发规范和代码审查要点</li><li>安全事件分级响应机制</li><li>符合数据保护和加密标准</li></ul>`,69)])])}const u=d(n,[["render",l]]);export{c as __pageData,u as default};
