import{_ as a,c as i,o as e,ag as t}from"./chunks/framework.B0we9iV-.js";const k=JSON.parse('{"title":"贡献指南","description":"","frontmatter":{},"headers":[],"relativePath":"contributing.md","filePath":"contributing.md"}'),n={name:"contributing.md"};function l(p,s,h,d,o,r){return e(),i("div",null,[...s[0]||(s[0]=[t(`<h1 id="贡献指南" tabindex="-1">贡献指南 <a class="header-anchor" href="#贡献指南" aria-label="Permalink to &quot;贡献指南&quot;">​</a></h1><p>本文档为开发者和贡献者提供项目开发、部署和贡献的详细指南。</p><h2 id="快速开始" tabindex="-1">快速开始 <a class="header-anchor" href="#快速开始" aria-label="Permalink to &quot;快速开始&quot;">​</a></h2><h3 id="环境要求" tabindex="-1">环境要求 <a class="header-anchor" href="#环境要求" aria-label="Permalink to &quot;环境要求&quot;">​</a></h3><ul><li>Node.js 20+</li><li>pnpm 9+</li><li>Git</li></ul><h3 id="本地开发" tabindex="-1">本地开发 <a class="header-anchor" href="#本地开发" aria-label="Permalink to &quot;本地开发&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 克隆仓库</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/BioforestChain/KeyApp.git</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> KeyApp</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装依赖</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 启动开发服务器</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 启动 Storybook</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> storybook</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 启动文档站点</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docs:dev</span></span></code></pre></div><h3 id="常用命令" tabindex="-1">常用命令 <a class="header-anchor" href="#常用命令" aria-label="Permalink to &quot;常用命令&quot;">​</a></h3><table tabindex="0"><thead><tr><th>命令</th><th>说明</th></tr></thead><tbody><tr><td><code>pnpm dev</code></td><td>启动开发服务器 (端口 5173)</td></tr><tr><td><code>pnpm dev:mock</code></td><td>使用 Mock 服务启动 (端口 5174)</td></tr><tr><td><code>pnpm build</code></td><td>构建生产版本</td></tr><tr><td><code>pnpm test</code></td><td>运行单元测试</td></tr><tr><td><code>pnpm test:storybook</code></td><td>运行 Storybook 测试</td></tr><tr><td><code>pnpm storybook</code></td><td>启动 Storybook (端口 6006)</td></tr><tr><td><code>pnpm typecheck</code></td><td>TypeScript 类型检查</td></tr><tr><td><code>pnpm lint</code></td><td>代码检查</td></tr><tr><td><code>pnpm docs:dev</code></td><td>启动文档站点 (端口 5200)</td></tr></tbody></table><h2 id="项目结构" tabindex="-1">项目结构 <a class="header-anchor" href="#项目结构" aria-label="Permalink to &quot;项目结构&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>KeyApp/</span></span>
<span class="line"><span>├── src/                    # 应用源码</span></span>
<span class="line"><span>│   ├── components/         # React 组件</span></span>
<span class="line"><span>│   ├── pages/              # 页面组件</span></span>
<span class="line"><span>│   ├── stores/             # 状态管理 (TanStack Store)</span></span>
<span class="line"><span>│   ├── services/           # 平台服务抽象</span></span>
<span class="line"><span>│   ├── routes/             # 路由配置 (TanStack Router)</span></span>
<span class="line"><span>│   ├── i18n/               # 国际化</span></span>
<span class="line"><span>│   ├── styles/             # 全局样式</span></span>
<span class="line"><span>│   ├── test/               # 测试工具</span></span>
<span class="line"><span>│   └── types/              # TypeScript 类型定义</span></span>
<span class="line"><span>├── docs/                   # VitePress 文档站点</span></span>
<span class="line"><span>│   ├── .vitepress/         # VitePress 配置</span></span>
<span class="line"><span>│   └── public/             # 静态资源</span></span>
<span class="line"><span>├── .storybook/             # Storybook 配置</span></span>
<span class="line"><span>├── e2e/                    # E2E 测试 (Playwright)</span></span>
<span class="line"><span>└── scripts/                # 构建脚本</span></span></code></pre></div><h2 id="fork-与自定义部署" tabindex="-1">Fork 与自定义部署 <a class="header-anchor" href="#fork-与自定义部署" aria-label="Permalink to &quot;Fork 与自定义部署&quot;">​</a></h2><h3 id="github-pages-部署" tabindex="-1">GitHub Pages 部署 <a class="header-anchor" href="#github-pages-部署" aria-label="Permalink to &quot;GitHub Pages 部署&quot;">​</a></h3><p>Fork 本项目后，默认部署到 <code>https://{owner}.github.io/{repo}/</code>，通常无需额外改动。</p><h4 id="默认行为" tabindex="-1">默认行为 <a class="header-anchor" href="#默认行为" aria-label="Permalink to &quot;默认行为&quot;">​</a></h4><ul><li>默认站点：<code>https://{owner}.github.io/{repo}/</code></li><li>默认 Base Path：<code>/{repo_name}/</code>（如 <code>/KeyApp/</code>）</li><li><code>SITE_ORIGIN</code> / <code>SITE_BASE_URL</code> 为可选覆盖项，未设置时自动按仓库推导</li></ul><h4 id="可选配置" tabindex="-1">可选配置 <a class="header-anchor" href="#可选配置" aria-label="Permalink to &quot;可选配置&quot;">​</a></h4><p>如果确实需要覆盖路径，可在仓库 Variables 设置：</p><table tabindex="0"><thead><tr><th>变量名</th><th>说明</th><th>示例值</th></tr></thead><tbody><tr><td><code>VITEPRESS_BASE</code></td><td>站点 base path</td><td><code>/</code> 或 <code>/my-app/</code></td></tr></tbody></table><h3 id="构建产物" tabindex="-1">构建产物 <a class="header-anchor" href="#构建产物" aria-label="Permalink to &quot;构建产物&quot;">​</a></h3><p>CI/CD 会自动构建以下产物：</p><table tabindex="0"><thead><tr><th>路径</th><th>说明</th></tr></thead><tbody><tr><td><code>/</code></td><td>VitePress 文档站点</td></tr><tr><td><code>/webapp/</code></td><td>Web 应用（稳定版）</td></tr><tr><td><code>/webapp-dev/</code></td><td>Web 应用（测试版）</td></tr><tr><td><code>/storybook/</code></td><td>Storybook 组件文档</td></tr></tbody></table><h2 id="开发规范" tabindex="-1">开发规范 <a class="header-anchor" href="#开发规范" aria-label="Permalink to &quot;开发规范&quot;">​</a></h2><h3 id="组件开发流程" tabindex="-1">组件开发流程 <a class="header-anchor" href="#组件开发流程" aria-label="Permalink to &quot;组件开发流程&quot;">​</a></h3><ol><li><strong>创建 Story</strong> - 先在 Storybook 中定义组件的各种状态</li><li><strong>编写测试</strong> - 使用 Vitest 编写单元测试</li><li><strong>实现组件</strong> - 开发 React 组件</li><li><strong>类型检查</strong> - 运行 <code>pnpm typecheck</code> 确保类型安全</li></ol><h3 id="文件命名规范" tabindex="-1">文件命名规范 <a class="header-anchor" href="#文件命名规范" aria-label="Permalink to &quot;文件命名规范&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>component-name.tsx          # 组件实现</span></span>
<span class="line"><span>component-name.stories.tsx  # Storybook stories</span></span>
<span class="line"><span>component-name.test.tsx     # 单元测试</span></span></code></pre></div><h3 id="typescript-严格模式" tabindex="-1">TypeScript 严格模式 <a class="header-anchor" href="#typescript-严格模式" aria-label="Permalink to &quot;TypeScript 严格模式&quot;">​</a></h3><p>项目启用了 TypeScript 严格模式，包括：</p><ul><li><code>strict: true</code></li><li><code>noUncheckedIndexedAccess: true</code></li><li><code>exactOptionalPropertyTypes: true</code></li><li><code>noUnusedLocals: true</code></li><li><code>noUnusedParameters: true</code></li></ul><h3 id="代码风格" tabindex="-1">代码风格 <a class="header-anchor" href="#代码风格" aria-label="Permalink to &quot;代码风格&quot;">​</a></h3><ul><li>使用 Prettier 格式化代码</li><li>使用 oxlint 进行代码检查</li><li>组件使用函数式写法</li><li>优先使用 TypeScript 类型推断</li></ul><h2 id="服务实现" tabindex="-1">服务实现 <a class="header-anchor" href="#服务实现" aria-label="Permalink to &quot;服务实现&quot;">​</a></h2><p>项目支持多平台服务实现，通过环境变量 <code>SERVICE_IMPL</code> 切换：</p><table tabindex="0"><thead><tr><th>值</th><th>说明</th></tr></thead><tbody><tr><td><code>web</code></td><td>浏览器环境（默认）</td></tr><tr><td><code>dweb</code></td><td>DWEB/Plaoc 平台</td></tr><tr><td><code>mock</code></td><td>测试/开发环境</td></tr></tbody></table><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用 Mock 服务开发</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SERVICE_IMPL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mock</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 构建 DWEB 版本</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SERVICE_IMPL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">dweb</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span></code></pre></div><h2 id="测试" tabindex="-1">测试 <a class="header-anchor" href="#测试" aria-label="Permalink to &quot;测试&quot;">​</a></h2><h3 id="单元测试" tabindex="-1">单元测试 <a class="header-anchor" href="#单元测试" aria-label="Permalink to &quot;单元测试&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 运行所有单元测试</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 运行特定文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> src/components/common/button.test.tsx</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 生成覆盖率报告</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test:coverage</span></span></code></pre></div><h3 id="storybook-测试" tabindex="-1">Storybook 测试 <a class="header-anchor" href="#storybook-测试" aria-label="Permalink to &quot;Storybook 测试&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 运行 Storybook 组件测试</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test:storybook</span></span></code></pre></div><h3 id="e2e-测试" tabindex="-1">E2E 测试 <a class="header-anchor" href="#e2e-测试" aria-label="Permalink to &quot;E2E 测试&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 运行 E2E 测试</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> e2e</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 带 UI 的 E2E 测试</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> e2e:ui</span></span></code></pre></div><h2 id="提交规范" tabindex="-1">提交规范 <a class="header-anchor" href="#提交规范" aria-label="Permalink to &quot;提交规范&quot;">​</a></h2><h3 id="commit-message-格式" tabindex="-1">Commit Message 格式 <a class="header-anchor" href="#commit-message-格式" aria-label="Permalink to &quot;Commit Message 格式&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;body&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;footer&gt;</span></span></code></pre></div><p><strong>Type 类型</strong>：</p><ul><li><code>feat</code> - 新功能</li><li><code>fix</code> - Bug 修复</li><li><code>docs</code> - 文档更新</li><li><code>style</code> - 代码格式（不影响功能）</li><li><code>refactor</code> - 重构</li><li><code>test</code> - 测试相关</li><li><code>chore</code> - 构建/工具相关</li></ul><h3 id="pull-request" tabindex="-1">Pull Request <a class="header-anchor" href="#pull-request" aria-label="Permalink to &quot;Pull Request&quot;">​</a></h3><ol><li>Fork 仓库并创建功能分支</li><li>确保所有测试通过：<code>pnpm test &amp;&amp; pnpm typecheck</code></li><li>提交 PR 到 <code>main</code> 分支</li><li>等待 CI 检查通过和代码审查</li></ol><h2 id="发布流程" tabindex="-1">发布流程 <a class="header-anchor" href="#发布流程" aria-label="Permalink to &quot;发布流程&quot;">​</a></h2><h3 id="beta-发布" tabindex="-1">Beta 发布 <a class="header-anchor" href="#beta-发布" aria-label="Permalink to &quot;Beta 发布&quot;">​</a></h3><p>每次推送到 <code>main</code> 分支会自动触发 Beta 发布：</p><ul><li>构建并部署到 GitHub Pages</li><li>创建/更新 <code>beta</code> release</li></ul><h3 id="稳定版发布" tabindex="-1">稳定版发布 <a class="header-anchor" href="#稳定版发布" aria-label="Permalink to &quot;稳定版发布&quot;">​</a></h3><p>创建版本标签触发稳定版发布：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tag</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> v1.0.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> push</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> origin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> v1.0.0</span></span></code></pre></div><h2 id="常见问题" tabindex="-1">常见问题 <a class="header-anchor" href="#常见问题" aria-label="Permalink to &quot;常见问题&quot;">​</a></h2><h3 id="typescript-类型错误" tabindex="-1">TypeScript 类型错误 <a class="header-anchor" href="#typescript-类型错误" aria-label="Permalink to &quot;TypeScript 类型错误&quot;">​</a></h3><p>如果遇到 <code>exactOptionalPropertyTypes</code> 相关错误，确保可选属性不要显式传递 <code>undefined</code>：</p><div class="language-tsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ❌ 错误</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Component</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> prop</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">undefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} /&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ✅ 正确 - 省略属性</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ✅ 或者类型定义允许 undefined</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Props</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  prop</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> undefined</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="本地开发-base-path" tabindex="-1">本地开发 base path <a class="header-anchor" href="#本地开发-base-path" aria-label="Permalink to &quot;本地开发 base path&quot;">​</a></h3><p>本地开发默认使用 <code>/</code>，无需配置。生产构建时通过环境变量设置：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">VITE_BASE_URL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/my-path/</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span></code></pre></div><h2 id="获取帮助" tabindex="-1">获取帮助 <a class="header-anchor" href="#获取帮助" aria-label="Permalink to &quot;获取帮助&quot;">​</a></h2><ul><li><a href="https://github.com/BioforestChain/KeyApp/issues" target="_blank" rel="noreferrer">GitHub Issues</a> - 报告 Bug 或功能请求</li><li><a href="https://github.com/BioforestChain/KeyApp/discussions" target="_blank" rel="noreferrer">GitHub Discussions</a> - 讨论和问答</li></ul>`,66)])])}const b=a(n,[["render",l]]);export{k as __pageData,b as default};
