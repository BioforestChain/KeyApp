import{_ as t,c as s,o as n,ag as i}from"./chunks/framework.B0we9iV-.js";const k=JSON.parse('{"title":"密钥管理","description":"","frontmatter":{},"headers":[],"relativePath":"white-book/08-Security-Ref/01-Key-Management.md","filePath":"white-book/08-Security-Ref/01-Key-Management.md"}'),e={name:"white-book/08-Security-Ref/01-Key-Management.md"};function d(p,a,l,r,h,o){return n(),s("div",null,[...a[0]||(a[0]=[i(`<h1 id="密钥管理" tabindex="-1">密钥管理 <a class="header-anchor" href="#密钥管理" aria-label="Permalink to &quot;密钥管理&quot;">​</a></h1><blockquote><p>源码: <a href="https://github.com/BioforestChain/KeyApp/blob/main/src/services/wallet/" target="_blank" rel="noreferrer"><code>src/services/wallet/</code></a></p></blockquote><hr><h2 id="助记词规范" tabindex="-1">助记词规范 <a class="header-anchor" href="#助记词规范" aria-label="Permalink to &quot;助记词规范&quot;">​</a></h2><h3 id="bip39-标准" tabindex="-1">BIP39 标准 <a class="header-anchor" href="#bip39-标准" aria-label="Permalink to &quot;BIP39 标准&quot;">​</a></h3><table tabindex="0"><thead><tr><th>约束级别</th><th>要求</th></tr></thead><tbody><tr><td><strong>MUST</strong></td><td>遵循 BIP39 标准生成助记词</td></tr><tr><td><strong>MUST</strong></td><td>支持 12 词 (128 bits) 和 24 词 (256 bits)</td></tr><tr><td><strong>MUST</strong></td><td>使用标准英文词库</td></tr><tr><td><strong>MAY</strong></td><td>支持其他语言词库</td></tr></tbody></table><h3 id="词数与安全性" tabindex="-1">词数与安全性 <a class="header-anchor" href="#词数与安全性" aria-label="Permalink to &quot;词数与安全性&quot;">​</a></h3><table tabindex="0"><thead><tr><th>词数</th><th>熵 (bits)</th><th>安全级别</th></tr></thead><tbody><tr><td>12</td><td>128</td><td>标准</td></tr><tr><td>15</td><td>160</td><td>高</td></tr><tr><td>18</td><td>192</td><td>很高</td></tr><tr><td>24</td><td>256</td><td>最高</td></tr></tbody></table><h3 id="助记词验证" tabindex="-1">助记词验证 <a class="header-anchor" href="#助记词验证" aria-label="Permalink to &quot;助记词验证&quot;">​</a></h3><table tabindex="0"><thead><tr><th>约束级别</th><th>要求</th></tr></thead><tbody><tr><td><strong>MUST</strong></td><td>验证单词是否在标准词库中</td></tr><tr><td><strong>MUST</strong></td><td>验证校验和是否正确</td></tr><tr><td><strong>MUST</strong></td><td>验证词数是否符合标准</td></tr><tr><td><strong>SHOULD</strong></td><td>提示相似但错误的单词</td></tr></tbody></table><hr><h2 id="多链地址派生" tabindex="-1">多链地址派生 <a class="header-anchor" href="#多链地址派生" aria-label="Permalink to &quot;多链地址派生&quot;">​</a></h2><h3 id="派生架构" tabindex="-1">派生架构 <a class="header-anchor" href="#派生架构" aria-label="Permalink to &quot;派生架构&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>助记词</span></span>
<span class="line"><span>   │</span></span>
<span class="line"><span>   ▼</span></span>
<span class="line"><span>种子 (Seed)</span></span>
<span class="line"><span>   │</span></span>
<span class="line"><span>   ├──────────────────────────────────────┐</span></span>
<span class="line"><span>   │                                      │</span></span>
<span class="line"><span>   ▼                                      ▼</span></span>
<span class="line"><span>BIP32/BIP44                          Ed25519</span></span>
<span class="line"><span>(外部链)                             (BioForest 链)</span></span>
<span class="line"><span>   │                                      │</span></span>
<span class="line"><span>   ├── Ethereum (m/44&#39;/60&#39;/0&#39;/0/x)       ├── BFMeta</span></span>
<span class="line"><span>   ├── Bitcoin (m/44&#39;/0&#39;/0&#39;/0/x)         ├── PMChain</span></span>
<span class="line"><span>   ├── Tron (m/44&#39;/195&#39;/0&#39;/0/x)          └── CCChain</span></span>
<span class="line"><span>   └── BSC (m/44&#39;/60&#39;/0&#39;/0/x)</span></span></code></pre></div><h3 id="bip44-派生规范" tabindex="-1">BIP44 派生规范 <a class="header-anchor" href="#bip44-派生规范" aria-label="Permalink to &quot;BIP44 派生规范&quot;">​</a></h3><table tabindex="0"><thead><tr><th>链类型</th><th>Coin Type</th><th>派生路径</th></tr></thead><tbody><tr><td>Ethereum</td><td>60</td><td>m/44&#39;/60&#39;/0&#39;/0/x</td></tr><tr><td>Bitcoin</td><td>0</td><td>m/44&#39;/0&#39;/0&#39;/0/x</td></tr><tr><td>Tron</td><td>195</td><td>m/44&#39;/195&#39;/0&#39;/0/x</td></tr><tr><td>BSC</td><td>60</td><td>m/44&#39;/60&#39;/0&#39;/0/x</td></tr></tbody></table><h3 id="bioforest-派生" tabindex="-1">BioForest 派生 <a class="header-anchor" href="#bioforest-派生" aria-label="Permalink to &quot;BioForest 派生&quot;">​</a></h3><table tabindex="0"><thead><tr><th>约束级别</th><th>要求</th></tr></thead><tbody><tr><td><strong>MUST</strong></td><td>从种子派生 Ed25519 私钥</td></tr><tr><td><strong>MUST</strong></td><td>支持链前缀区分不同网络</td></tr><tr><td><strong>SHOULD</strong></td><td>使用 SHA256(seed + index) 作为私钥种子</td></tr></tbody></table><hr><h2 id="加密存储规范" tabindex="-1">加密存储规范 <a class="header-anchor" href="#加密存储规范" aria-label="Permalink to &quot;加密存储规范&quot;">​</a></h2><h3 id="存储数据结构" tabindex="-1">存储数据结构 <a class="header-anchor" href="#存储数据结构" aria-label="Permalink to &quot;存储数据结构&quot;">​</a></h3><table tabindex="0"><thead><tr><th>字段</th><th>类型</th><th>加密</th><th>说明</th></tr></thead><tbody><tr><td>id</td><td>string</td><td>否</td><td>钱包唯一标识</td></tr><tr><td>name</td><td>string</td><td>否</td><td>钱包名称</td></tr><tr><td>encryptedMnemonic</td><td>EncryptedData</td><td>是</td><td>加密的助记词</td></tr><tr><td>chainAddresses</td><td>ChainAddress[]</td><td>否</td><td>各链地址</td></tr><tr><td>createdAt</td><td>number</td><td>否</td><td>创建时间</td></tr><tr><td>isBackedUp</td><td>boolean</td><td>否</td><td>是否已备份</td></tr></tbody></table><h3 id="加密数据结构" tabindex="-1">加密数据结构 <a class="header-anchor" href="#加密数据结构" aria-label="Permalink to &quot;加密数据结构&quot;">​</a></h3><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> EncryptedData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  ciphertext</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   // Base64 编码的密文</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           // Base64 编码的初始向量</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  salt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         // Base64 编码的盐</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  iterations</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   // 密钥派生迭代次数</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="加密算法规范" tabindex="-1">加密算法规范 <a class="header-anchor" href="#加密算法规范" aria-label="Permalink to &quot;加密算法规范&quot;">​</a></h3><table tabindex="0"><thead><tr><th>用途</th><th>算法</th><th>参数</th></tr></thead><tbody><tr><td>对称加密</td><td>AES-256-GCM</td><td>256-bit key, 96-bit IV</td></tr><tr><td>密钥派生</td><td>PBKDF2</td><td>SHA-256, 100,000+ iterations</td></tr></tbody></table><h3 id="加密要求" tabindex="-1">加密要求 <a class="header-anchor" href="#加密要求" aria-label="Permalink to &quot;加密要求&quot;">​</a></h3><table tabindex="0"><thead><tr><th>约束级别</th><th>要求</th></tr></thead><tbody><tr><td><strong>MUST</strong></td><td>使用 AES-GCM 模式（提供认证加密）</td></tr><tr><td><strong>MUST</strong></td><td>使用随机生成的 IV（每次加密不同）</td></tr><tr><td><strong>MUST</strong></td><td>使用随机生成的 Salt（每个钱包不同）</td></tr><tr><td><strong>MUST</strong></td><td>使用高迭代次数的 PBKDF2（≥100,000）</td></tr><tr><td><strong>MUST NOT</strong></td><td>存储明文助记词或私钥</td></tr></tbody></table><hr><h2 id="密钥使用流程" tabindex="-1">密钥使用流程 <a class="header-anchor" href="#密钥使用流程" aria-label="Permalink to &quot;密钥使用流程&quot;">​</a></h2><h3 id="创建钱包流程" tabindex="-1">创建钱包流程 <a class="header-anchor" href="#创建钱包流程" aria-label="Permalink to &quot;创建钱包流程&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>用户绘制图案</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ▼</span></span>
<span class="line"><span>验证图案复杂度（至少4点）</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ▼</span></span>
<span class="line"><span>生成助记词 (BIP39)</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ▼</span></span>
<span class="line"><span>显示助记词让用户备份</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ▼</span></span>
<span class="line"><span>验证用户备份（随机选词确认）</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ▼</span></span>
<span class="line"><span>加密助记词 (AES-GCM)</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ▼</span></span>
<span class="line"><span>从助记词派生各链地址</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ▼</span></span>
<span class="line"><span>存储加密数据到安全存储</span></span></code></pre></div><h3 id="签名交易流程" tabindex="-1">签名交易流程 <a class="header-anchor" href="#签名交易流程" aria-label="Permalink to &quot;签名交易流程&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>用户确认交易</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ▼</span></span>
<span class="line"><span>绘制图案 / 生物识别验证</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ▼</span></span>
<span class="line"><span>解密助记词</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ▼</span></span>
<span class="line"><span>派生对应链的私钥</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ▼</span></span>
<span class="line"><span>签名交易</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ▼</span></span>
<span class="line"><span>清除内存中的私钥 ← 关键安全步骤</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ▼</span></span>
<span class="line"><span>广播交易</span></span></code></pre></div><hr><h2 id="图案锁规范" tabindex="-1">图案锁规范 <a class="header-anchor" href="#图案锁规范" aria-label="Permalink to &quot;图案锁规范&quot;">​</a></h2><h3 id="图案复杂度要求" tabindex="-1">图案复杂度要求 <a class="header-anchor" href="#图案复杂度要求" aria-label="Permalink to &quot;图案复杂度要求&quot;">​</a></h3><table tabindex="0"><thead><tr><th>规则</th><th>要求</th><th>约束级别</th></tr></thead><tbody><tr><td>最少连接点</td><td>4 个</td><td><strong>MUST</strong></td></tr><tr><td>最多连接点</td><td>9 个</td><td>3x3 网格</td></tr></tbody></table><h3 id="图案验证规范" tabindex="-1">图案验证规范 <a class="header-anchor" href="#图案验证规范" aria-label="Permalink to &quot;图案验证规范&quot;">​</a></h3><table tabindex="0"><thead><tr><th>约束级别</th><th>要求</th></tr></thead><tbody><tr><td><strong>MUST</strong></td><td>在客户端验证图案复杂度</td></tr><tr><td><strong>MUST NOT</strong></td><td>将图案明文发送到服务器</td></tr><tr><td><strong>SHOULD</strong></td><td>提供连接点数实时显示</td></tr><tr><td><strong>MAY</strong></td><td>支持图案可见性切换</td></tr></tbody></table><hr><h2 id="内存安全" tabindex="-1">内存安全 <a class="header-anchor" href="#内存安全" aria-label="Permalink to &quot;内存安全&quot;">​</a></h2><h3 id="清除敏感数据" tabindex="-1">清除敏感数据 <a class="header-anchor" href="#清除敏感数据" aria-label="Permalink to &quot;清除敏感数据&quot;">​</a></h3><table tabindex="0"><thead><tr><th>约束级别</th><th>要求</th></tr></thead><tbody><tr><td><strong>MUST</strong></td><td>使用后立即清除敏感数据</td></tr><tr><td><strong>MUST</strong></td><td>用随机数覆盖内存（不只是置零）</td></tr><tr><td><strong>SHOULD</strong></td><td>限制私钥在内存中的存在时间</td></tr><tr><td><strong>SHOULD</strong></td><td>使用安全的内存分配（如可用）</td></tr></tbody></table><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> clearSensitiveData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Uint8Array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 用随机数覆盖</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  crypto.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getRandomValues</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 再次覆盖为零</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  data.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fill</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="防暴力破解" tabindex="-1">防暴力破解 <a class="header-anchor" href="#防暴力破解" aria-label="Permalink to &quot;防暴力破解&quot;">​</a></h3><table tabindex="0"><thead><tr><th>错误次数</th><th>响应</th></tr></thead><tbody><tr><td>1-3</td><td>正常提示</td></tr><tr><td>4-5</td><td>增加 30s 延迟</td></tr><tr><td>6-9</td><td>增加 5min 延迟</td></tr><tr><td>10+</td><td>锁定 24 小时</td></tr></tbody></table><hr><h2 id="备份与恢复" tabindex="-1">备份与恢复 <a class="header-anchor" href="#备份与恢复" aria-label="Permalink to &quot;备份与恢复&quot;">​</a></h2><h3 id="备份验证规范" tabindex="-1">备份验证规范 <a class="header-anchor" href="#备份验证规范" aria-label="Permalink to &quot;备份验证规范&quot;">​</a></h3><table tabindex="0"><thead><tr><th>约束级别</th><th>要求</th></tr></thead><tbody><tr><td><strong>MUST</strong></td><td>创建钱包时强制显示助记词</td></tr><tr><td><strong>MUST</strong></td><td>随机选择 2-3 个词位置让用户确认</td></tr><tr><td><strong>SHOULD</strong></td><td>标记钱包是否已完成备份</td></tr><tr><td><strong>SHOULD</strong></td><td>未备份钱包显示提醒</td></tr></tbody></table><h3 id="恢复流程" tabindex="-1">恢复流程 <a class="header-anchor" href="#恢复流程" aria-label="Permalink to &quot;恢复流程&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>用户输入助记词</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ▼</span></span>
<span class="line"><span>验证助记词格式和校验和</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ▼</span></span>
<span class="line"><span>用户设置新密码</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ▼</span></span>
<span class="line"><span>加密助记词</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ▼</span></span>
<span class="line"><span>重新派生所有链地址</span></span>
<span class="line"><span>      │</span></span>
<span class="line"><span>      ▼</span></span>
<span class="line"><span>创建钱包记录</span></span></code></pre></div><hr><h2 id="相关文档" tabindex="-1">相关文档 <a class="header-anchor" href="#相关文档" aria-label="Permalink to &quot;相关文档&quot;">​</a></h2><ul><li><a href="./02-Authentication.html">身份认证</a></li><li><a href="./03-DWEB-Authorization.html">DWEB 授权</a></li><li><a href="./04-Security-Audit.html">安全审计</a></li></ul>`,56)])])}const b=t(e,[["render",d]]);export{k as __pageData,b as default};
