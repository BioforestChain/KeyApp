import{_ as n,c as e,o as d,ag as a,j as t}from"./chunks/framework.B0we9iV-.js";const u=JSON.parse('{"title":"IIdentityService 身份服务","description":"","frontmatter":{},"headers":[],"relativePath":"white-book/04-服务篇/02-链服务/IIdentityService.md","filePath":"white-book/04-服务篇/02-链服务/IIdentityService.md"}'),r={name:"white-book/04-服务篇/02-链服务/IIdentityService.md"};function l(i,s,p,o,h,c){return d(),e("div",null,[...s[0]||(s[0]=[a(`<h1 id="iidentityservice-身份服务" tabindex="-1">IIdentityService 身份服务 <a class="header-anchor" href="#iidentityservice-身份服务" aria-label="Permalink to &quot;IIdentityService 身份服务&quot;">​</a></h1><blockquote><p>地址派生和消息签名</p></blockquote><hr><h2 id="职责" tabindex="-1">职责 <a class="header-anchor" href="#职责" aria-label="Permalink to &quot;职责&quot;">​</a></h2><p>管理用户身份，包括从种子派生地址、签名消息、验证签名。</p><hr><h2 id="接口定义" tabindex="-1">接口定义 <a class="header-anchor" href="#接口定义" aria-label="Permalink to &quot;接口定义&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>IIdentityService {</span></span>
<span class="line"><span>  // 从种子派生地址</span></span>
<span class="line"><span>  deriveAddress(seed: bytes, index?: number): Address</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>  // 批量派生地址</span></span>
<span class="line"><span>  deriveAddresses(seed: bytes, startIndex: number, count: number): Address[]</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>  // 验证地址格式</span></span>
<span class="line"><span>  isValidAddress(address: string): boolean</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>  // 规范化地址（如 EVM 的 checksum）</span></span>
<span class="line"><span>  normalizeAddress(address: string): Address</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>  // 签名消息</span></span>
<span class="line"><span>  signMessage(message: string | bytes, privateKey: bytes): Signature</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>  // 验证消息签名</span></span>
<span class="line"><span>  verifyMessage(message: string | bytes, signature: Signature, address: Address): boolean</span></span>
<span class="line"><span>}</span></span></code></pre></div><hr><h2 id="方法详情" tabindex="-1">方法详情 <a class="header-anchor" href="#方法详情" aria-label="Permalink to &quot;方法详情&quot;">​</a></h2><h3 id="deriveaddress" tabindex="-1">deriveAddress <a class="header-anchor" href="#deriveaddress" aria-label="Permalink to &quot;deriveAddress&quot;">​</a></h3><p>从助记词种子派生区块链地址。</p><p><strong>参数</strong>：</p><table tabindex="0"><thead><tr><th>参数</th><th>类型</th><th>必需</th><th>说明</th></tr></thead><tbody><tr><td>seed</td><td>bytes</td><td>Y</td><td>助记词种子（64 bytes）</td></tr><tr><td>index</td><td>number</td><td>N</td><td>地址索引，默认 0</td></tr></tbody></table><p><strong>返回</strong>：<code>Address</code> - 派生的区块链地址</p><p><strong>行为规范</strong>：</p><ul><li><strong>MUST</strong> 使用 BIP44 标准派生路径</li><li><strong>MUST</strong> 返回规范化格式的地址</li><li><strong>SHOULD</strong> 缓存派生结果以提高性能</li></ul><hr><h3 id="isvalidaddress" tabindex="-1">isValidAddress <a class="header-anchor" href="#isvalidaddress" aria-label="Permalink to &quot;isValidAddress&quot;">​</a></h3><p>验证地址格式是否正确。</p><p><strong>参数</strong>：</p><table tabindex="0"><thead><tr><th>参数</th><th>类型</th><th>必需</th><th>说明</th></tr></thead><tbody><tr><td>address</td><td>string</td><td>Y</td><td>待验证的地址</td></tr></tbody></table><p><strong>返回</strong>：<code>boolean</code> - 是否有效</p><p><strong>验证规则</strong>：</p><table tabindex="0"><thead><tr><th>链类型</th><th>规则</th></tr></thead><tbody><tr><td>EVM</td><td>0x 开头，40 位十六进制，可选 checksum</td></tr><tr><td>Bitcoin</td><td>符合 Base58Check 或 Bech32</td></tr><tr><td>BFM</td><td>符合 BFM 地址规范</td></tr></tbody></table><hr><h3 id="signmessage" tabindex="-1">signMessage <a class="header-anchor" href="#signmessage" aria-label="Permalink to &quot;signMessage&quot;">​</a></h3><p>使用私钥签名消息。</p><p><strong>参数</strong>：</p><table tabindex="0"><thead><tr><th>参数</th><th>类型</th><th>必需</th><th>说明</th></tr></thead><tbody><tr><td>message</td><td>string | bytes</td><td>Y</td><td>待签名消息</td></tr><tr><td>privateKey</td><td>bytes</td><td>Y</td><td>私钥</td></tr></tbody></table><p><strong>返回</strong>：<code>Signature</code> - 签名结果</p><p><strong>行为规范</strong>：</p><ul><li><strong>MUST</strong> 签名后立即清除私钥内存</li><li><strong>MUST</strong> 使用链对应的签名算法</li><li><strong>SHOULD</strong> 对消息添加前缀防止跨链重放</li></ul><hr><h2 id="派生路径规范" tabindex="-1">派生路径规范 <a class="header-anchor" href="#派生路径规范" aria-label="Permalink to &quot;派生路径规范&quot;">​</a></h2>`,35),t("table",{tabindex:"0"},[t("thead",null,[t("tr",null,[t("th",null,"链类型"),t("th",null,"派生路径"),t("th",null,"算法"),t("th",null,"地址格式")])]),t("tbody",null,[t("tr",null,[t("td",null,"EVM 兼容"),t("td",{index:""},"m/44'/60'/0'/0/"),t("td",null,"secp256k1"),t("td",null,"0x... (checksum)")]),t("tr",null,[t("td",null,"Bitcoin"),t("td",{index:""},"m/84'/0'/0'/0/"),t("td",null,"secp256k1"),t("td",null,"bc1q... (Native SegWit)")]),t("tr",null,[t("td",null,"Tron"),t("td",{index:""},"m/44'/195'/0'/0/"),t("td",null,"secp256k1"),t("td",null,"T... (Base58Check)")]),t("tr",null,[t("td",null,"BioForest"),t("td",{index:""},"m/44'/9999'/0'/0/"),t("td",null,"Ed25519"),t("td",null,"b... (Base58)")])])],-1),a(`<blockquote><p><strong>注意</strong>: Bitcoin 使用 BIP84 路径（Native SegWit），不再使用 BIP44 Legacy 路径。</p></blockquote><h3 id="派生流程" tabindex="-1">派生流程 <a class="header-anchor" href="#派生流程" aria-label="Permalink to &quot;派生流程&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>助记词</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ▼ BIP39</span></span>
<span class="line"><span>种子 (64 bytes)</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ▼ BIP32/SLIP-0010</span></span>
<span class="line"><span>主密钥</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ▼ 派生路径</span></span>
<span class="line"><span>私钥</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ▼ 椭圆曲线</span></span>
<span class="line"><span>公钥</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ▼ 哈希 + 编码</span></span>
<span class="line"><span>地址</span></span></code></pre></div><hr><h2 id="错误码" tabindex="-1">错误码 <a class="header-anchor" href="#错误码" aria-label="Permalink to &quot;错误码&quot;">​</a></h2><table tabindex="0"><thead><tr><th>错误码</th><th>说明</th><th>处理建议</th></tr></thead><tbody><tr><td>INVALID_SEED</td><td>种子格式无效</td><td>检查助记词</td></tr><tr><td>INVALID_ADDRESS</td><td>地址格式无效</td><td>提示用户检查</td></tr><tr><td>SIGNATURE_FAILED</td><td>签名失败</td><td>检查私钥</td></tr><tr><td>VERIFICATION_FAILED</td><td>签名验证失败</td><td>签名可能被篡改</td></tr><tr><td>UNSUPPORTED_CHAIN</td><td>不支持的链类型</td><td>检查链配置</td></tr></tbody></table><hr><h2 id="安全要求" tabindex="-1">安全要求 <a class="header-anchor" href="#安全要求" aria-label="Permalink to &quot;安全要求&quot;">​</a></h2><table tabindex="0"><thead><tr><th>要求</th><th>说明</th></tr></thead><tbody><tr><td>私钥不持久化</td><td>私钥仅在内存中临时存在</td></tr><tr><td>及时清除</td><td>使用后立即覆写内存</td></tr><tr><td>不记录日志</td><td>私钥相关数据不写入日志</td></tr><tr><td>隔离环境</td><td><strong>SHOULD</strong> 在 Web Worker 中执行</td></tr></tbody></table>`,9)])])}const g=n(r,[["render",l]]);export{u as __pageData,g as default};
