import{_ as d,c as a,o as r,ag as h}from"./chunks/framework.B0we9iV-.js";const u=JSON.parse('{"title":"性能预算篇","description":"","frontmatter":{},"headers":[],"relativePath":"white-book/03-架构篇/07-性能预算/index.md","filePath":"white-book/03-架构篇/07-性能预算/index.md"}'),e={name:"white-book/03-架构篇/07-性能预算/index.md"};function l(o,t,i,b,n,s){return r(),a("div",null,[...t[0]||(t[0]=[h('<h1 id="性能预算篇" tabindex="-1">性能预算篇 <a class="header-anchor" href="#性能预算篇" aria-label="Permalink to &quot;性能预算篇&quot;">​</a></h1><blockquote><p>定义关键操作的性能指标和优化目标</p></blockquote><hr><h2 id="核心性能指标" tabindex="-1">核心性能指标 <a class="header-anchor" href="#核心性能指标" aria-label="Permalink to &quot;核心性能指标&quot;">​</a></h2><h3 id="加载性能" tabindex="-1">加载性能 <a class="header-anchor" href="#加载性能" aria-label="Permalink to &quot;加载性能&quot;">​</a></h3><table tabindex="0"><thead><tr><th>指标</th><th>目标值</th><th>测量方式</th></tr></thead><tbody><tr><td>首次内容绘制 (FCP)</td><td>&lt; 1.5s</td><td>Lighthouse</td></tr><tr><td>最大内容绘制 (LCP)</td><td>&lt; 2.5s</td><td>Lighthouse</td></tr><tr><td>可交互时间 (TTI)</td><td>&lt; 3.5s</td><td>Lighthouse</td></tr><tr><td>首字节时间 (TTFB)</td><td>&lt; 600ms</td><td>Lighthouse</td></tr><tr><td>累积布局偏移 (CLS)</td><td>&lt; 0.1</td><td>Lighthouse</td></tr></tbody></table><h3 id="运行时性能" tabindex="-1">运行时性能 <a class="header-anchor" href="#运行时性能" aria-label="Permalink to &quot;运行时性能&quot;">​</a></h3><table tabindex="0"><thead><tr><th>指标</th><th>目标值</th><th>说明</th></tr></thead><tbody><tr><td>帧率 (FPS)</td><td>60fps</td><td>滚动/动画时</td></tr><tr><td>输入延迟</td><td>&lt; 100ms</td><td>点击响应</td></tr><tr><td>长任务</td><td>&lt; 50ms</td><td>单个 JS 任务</td></tr><tr><td>内存占用</td><td>&lt; 150MB</td><td>正常使用时</td></tr></tbody></table><hr><h2 id="操作性能预算" tabindex="-1">操作性能预算 <a class="header-anchor" href="#操作性能预算" aria-label="Permalink to &quot;操作性能预算&quot;">​</a></h2><h3 id="导航操作" tabindex="-1">导航操作 <a class="header-anchor" href="#导航操作" aria-label="Permalink to &quot;导航操作&quot;">​</a></h3><table tabindex="0"><thead><tr><th>操作</th><th>目标时间</th><th>说明</th></tr></thead><tbody><tr><td>页面切换动画</td><td>250-300ms</td><td>Stackflow 过渡</td></tr><tr><td>Tab 切换</td><td>&lt; 100ms</td><td>无动画情况</td></tr><tr><td>返回上一页</td><td>&lt; 150ms</td><td>含动画</td></tr><tr><td>深度链接打开</td><td>&lt; 1s</td><td>从外部唤起</td></tr></tbody></table><h3 id="钱包操作" tabindex="-1">钱包操作 <a class="header-anchor" href="#钱包操作" aria-label="Permalink to &quot;钱包操作&quot;">​</a></h3><table tabindex="0"><thead><tr><th>操作</th><th>目标时间</th><th>说明</th></tr></thead><tbody><tr><td>钱包列表加载</td><td>&lt; 100ms</td><td>本地数据</td></tr><tr><td>单钱包余额显示</td><td>&lt; 200ms</td><td>缓存命中</td></tr><tr><td>单钱包余额刷新</td><td>&lt; 2s</td><td>网络请求</td></tr><tr><td>多链余额并行查询</td><td>&lt; 3s</td><td>5 条链</td></tr><tr><td>交易历史加载</td><td>&lt; 1s</td><td>首页（20条）</td></tr></tbody></table><h3 id="加密操作" tabindex="-1">加密操作 <a class="header-anchor" href="#加密操作" aria-label="Permalink to &quot;加密操作&quot;">​</a></h3><table tabindex="0"><thead><tr><th>操作</th><th>目标时间</th><th>说明</th></tr></thead><tbody><tr><td>助记词生成</td><td>&lt; 100ms</td><td>BIP39</td></tr><tr><td>地址派生（单链）</td><td>&lt; 50ms</td><td>BIP44/Ed25519</td></tr><tr><td>地址派生（全链）</td><td>&lt; 500ms</td><td>10 条链</td></tr><tr><td>图案验证</td><td>&lt; 500ms</td><td>PBKDF2</td></tr><tr><td>交易签名</td><td>&lt; 200ms</td><td>单笔交易</td></tr><tr><td>助记词解密</td><td>&lt; 300ms</td><td>AES-GCM</td></tr></tbody></table><h3 id="表单操作" tabindex="-1">表单操作 <a class="header-anchor" href="#表单操作" aria-label="Permalink to &quot;表单操作&quot;">​</a></h3><table tabindex="0"><thead><tr><th>操作</th><th>目标时间</th><th>说明</th></tr></thead><tbody><tr><td>输入响应</td><td>&lt; 16ms</td><td>每次按键</td></tr><tr><td>验证反馈</td><td>&lt; 100ms</td><td>字段级验证</td></tr><tr><td>表单提交</td><td>&lt; 50ms</td><td>本地验证</td></tr><tr><td>地址解析</td><td>&lt; 200ms</td><td>ENS/域名解析</td></tr></tbody></table><h3 id="扫码操作" tabindex="-1">扫码操作 <a class="header-anchor" href="#扫码操作" aria-label="Permalink to &quot;扫码操作&quot;">​</a></h3><table tabindex="0"><thead><tr><th>操作</th><th>目标时间</th><th>说明</th></tr></thead><tbody><tr><td>相机启动</td><td>&lt; 500ms</td><td>首次打开</td></tr><tr><td>二维码识别</td><td>&lt; 100ms</td><td>识别延迟</td></tr><tr><td>结果解析</td><td>&lt; 50ms</td><td>URL/地址解析</td></tr></tbody></table><hr><h2 id="包体积预算" tabindex="-1">包体积预算 <a class="header-anchor" href="#包体积预算" aria-label="Permalink to &quot;包体积预算&quot;">​</a></h2><h3 id="总体预算" tabindex="-1">总体预算 <a class="header-anchor" href="#总体预算" aria-label="Permalink to &quot;总体预算&quot;">​</a></h3><table tabindex="0"><thead><tr><th>资源类型</th><th>预算 (gzip)</th><th>说明</th></tr></thead><tbody><tr><td>首屏 JS</td><td>&lt; 150KB</td><td>关键路径</td></tr><tr><td>首屏 CSS</td><td>&lt; 30KB</td><td>关键样式</td></tr><tr><td>总 JS</td><td>&lt; 400KB</td><td>所有路由</td></tr><tr><td>总 CSS</td><td>&lt; 50KB</td><td>所有样式</td></tr><tr><td>图片/图标</td><td>&lt; 100KB</td><td>首屏资源</td></tr></tbody></table><h3 id="分包预算" tabindex="-1">分包预算 <a class="header-anchor" href="#分包预算" aria-label="Permalink to &quot;分包预算&quot;">​</a></h3><table tabindex="0"><thead><tr><th>包</th><th>预算 (gzip)</th><th>触发条件</th></tr></thead><tbody><tr><td>vendor (核心依赖)</td><td>&lt; 100KB</td><td>首屏</td></tr><tr><td>framework</td><td>&lt; 50KB</td><td>首屏</td></tr><tr><td>单路由 chunk</td><td>&lt; 30KB</td><td>导航时</td></tr><tr><td>加密库</td><td>&lt; 80KB</td><td>延迟加载</td></tr><tr><td>i18n 资源</td><td>&lt; 20KB/语言</td><td>切换语言</td></tr></tbody></table><h3 id="依赖预算" tabindex="-1">依赖预算 <a class="header-anchor" href="#依赖预算" aria-label="Permalink to &quot;依赖预算&quot;">​</a></h3><table tabindex="0"><thead><tr><th>依赖类别</th><th>预算</th><th>说明</th></tr></thead><tbody><tr><td>UI 框架</td><td>&lt; 50KB</td><td>React 等</td></tr><tr><td>状态管理</td><td>&lt; 15KB</td><td>TanStack 等</td></tr><tr><td>导航</td><td>&lt; 20KB</td><td>Stackflow 等</td></tr><tr><td>加密</td><td>&lt; 80KB</td><td>noble/scure</td></tr><tr><td>工具库</td><td>&lt; 30KB</td><td>总计</td></tr></tbody></table><hr><h2 id="内存预算" tabindex="-1">内存预算 <a class="header-anchor" href="#内存预算" aria-label="Permalink to &quot;内存预算&quot;">​</a></h2><h3 id="常驻内存" tabindex="-1">常驻内存 <a class="header-anchor" href="#常驻内存" aria-label="Permalink to &quot;常驻内存&quot;">​</a></h3><table tabindex="0"><thead><tr><th>数据</th><th>预算</th><th>说明</th></tr></thead><tbody><tr><td>应用基础</td><td>&lt; 30MB</td><td>框架+组件</td></tr><tr><td>钱包数据</td><td>&lt; 5MB</td><td>10 个钱包</td></tr><tr><td>缓存数据</td><td>&lt; 20MB</td><td>余额+历史</td></tr><tr><td>UI 状态</td><td>&lt; 10MB</td><td>组件状态</td></tr><tr><td>总计</td><td>&lt; 100MB</td><td>正常使用</td></tr></tbody></table><h3 id="峰值内存" tabindex="-1">峰值内存 <a class="header-anchor" href="#峰值内存" aria-label="Permalink to &quot;峰值内存&quot;">​</a></h3><table tabindex="0"><thead><tr><th>场景</th><th>预算</th><th>说明</th></tr></thead><tbody><tr><td>交易签名</td><td>&lt; 150MB</td><td>临时增加</td></tr><tr><td>大列表渲染</td><td>&lt; 130MB</td><td>虚拟滚动</td></tr><tr><td>相机扫码</td><td>&lt; 180MB</td><td>视频流</td></tr></tbody></table><h3 id="内存泄漏" tabindex="-1">内存泄漏 <a class="header-anchor" href="#内存泄漏" aria-label="Permalink to &quot;内存泄漏&quot;">​</a></h3><ul><li><strong>MUST</strong> 页面卸载后释放所有订阅</li><li><strong>MUST</strong> 组件卸载后清理定时器</li><li><strong>MUST</strong> 大对象使用后置 null</li><li><strong>SHOULD</strong> 定期检查内存增长</li></ul><hr><h2 id="网络预算" tabindex="-1">网络预算 <a class="header-anchor" href="#网络预算" aria-label="Permalink to &quot;网络预算&quot;">​</a></h2><h3 id="请求数量" tabindex="-1">请求数量 <a class="header-anchor" href="#请求数量" aria-label="Permalink to &quot;请求数量&quot;">​</a></h3><table tabindex="0"><thead><tr><th>场景</th><th>预算</th><th>说明</th></tr></thead><tbody><tr><td>首屏加载</td><td>&lt; 15</td><td>资源请求</td></tr><tr><td>首页展示</td><td>&lt; 5</td><td>API 请求</td></tr><tr><td>页面切换</td><td>&lt; 3</td><td>数据请求</td></tr></tbody></table><h3 id="请求大小" tabindex="-1">请求大小 <a class="header-anchor" href="#请求大小" aria-label="Permalink to &quot;请求大小&quot;">​</a></h3><table tabindex="0"><thead><tr><th>请求类型</th><th>预算</th><th>说明</th></tr></thead><tbody><tr><td>余额查询</td><td>&lt; 2KB</td><td>单次响应</td></tr><tr><td>交易历史</td><td>&lt; 10KB</td><td>20 条记录</td></tr><tr><td>链配置</td><td>&lt; 5KB</td><td>全量配置</td></tr></tbody></table><h3 id="并发请求" tabindex="-1">并发请求 <a class="header-anchor" href="#并发请求" aria-label="Permalink to &quot;并发请求&quot;">​</a></h3><table tabindex="0"><thead><tr><th>场景</th><th>最大并发</th><th>说明</th></tr></thead><tbody><tr><td>多链余额</td><td>5</td><td>限流保护</td></tr><tr><td>图片加载</td><td>3</td><td>资源加载</td></tr><tr><td>API 请求</td><td>4</td><td>总并发</td></tr></tbody></table><hr><h2 id="动画性能" tabindex="-1">动画性能 <a class="header-anchor" href="#动画性能" aria-label="Permalink to &quot;动画性能&quot;">​</a></h2><h3 id="动画帧预算" tabindex="-1">动画帧预算 <a class="header-anchor" href="#动画帧预算" aria-label="Permalink to &quot;动画帧预算&quot;">​</a></h3><table tabindex="0"><thead><tr><th>时间</th><th>用途</th></tr></thead><tbody><tr><td>16ms</td><td>一帧（60fps）</td></tr><tr><td>&lt; 10ms</td><td>JS 执行</td></tr><tr><td>&lt; 4ms</td><td>渲染+合成</td></tr><tr><td>&lt; 2ms</td><td>余量</td></tr></tbody></table><h3 id="动画规范" tabindex="-1">动画规范 <a class="header-anchor" href="#动画规范" aria-label="Permalink to &quot;动画规范&quot;">​</a></h3><table tabindex="0"><thead><tr><th>动画类型</th><th>实现方式</th><th>说明</th></tr></thead><tbody><tr><td>页面切换</td><td>CSS transform</td><td>GPU 加速</td></tr><tr><td>列表滚动</td><td>原生滚动</td><td>避免 JS 干预</td></tr><tr><td>按钮反馈</td><td>CSS transition</td><td>&lt; 100ms</td></tr><tr><td>加载动画</td><td>CSS animation</td><td>避免 JS</td></tr></tbody></table><h3 id="禁止的动画模式" tabindex="-1">禁止的动画模式 <a class="header-anchor" href="#禁止的动画模式" aria-label="Permalink to &quot;禁止的动画模式&quot;">​</a></h3><ul><li><strong>MUST NOT</strong> 动画中修改布局属性（width/height）</li><li><strong>MUST NOT</strong> 动画中触发重排（offsetTop 等）</li><li><strong>MUST NOT</strong> 使用 setInterval 做动画</li><li><strong>SHOULD NOT</strong> 同时运行超过 3 个动画</li></ul><hr><h2 id="性能监控" tabindex="-1">性能监控 <a class="header-anchor" href="#性能监控" aria-label="Permalink to &quot;性能监控&quot;">​</a></h2><h3 id="关键指标采集" tabindex="-1">关键指标采集 <a class="header-anchor" href="#关键指标采集" aria-label="Permalink to &quot;关键指标采集&quot;">​</a></h3><table tabindex="0"><thead><tr><th>指标</th><th>采集频率</th><th>上报</th></tr></thead><tbody><tr><td>页面加载时间</td><td>每次</td><td>聚合上报</td></tr><tr><td>接口响应时间</td><td>每次</td><td>P95/P99</td></tr><tr><td>长任务</td><td>检测到时</td><td>即时上报</td></tr><tr><td>内存峰值</td><td>每分钟</td><td>超阈值上报</td></tr></tbody></table><h3 id="性能预警" tabindex="-1">性能预警 <a class="header-anchor" href="#性能预警" aria-label="Permalink to &quot;性能预警&quot;">​</a></h3><table tabindex="0"><thead><tr><th>指标</th><th>预警阈值</th><th>严重阈值</th></tr></thead><tbody><tr><td>FCP</td><td>&gt; 2s</td><td>&gt; 3s</td></tr><tr><td>LCP</td><td>&gt; 3s</td><td>&gt; 5s</td></tr><tr><td>接口 P95</td><td>&gt; 3s</td><td>&gt; 5s</td></tr><tr><td>内存</td><td>&gt; 200MB</td><td>&gt; 300MB</td></tr></tbody></table><hr><h2 id="优化策略" tabindex="-1">优化策略 <a class="header-anchor" href="#优化策略" aria-label="Permalink to &quot;优化策略&quot;">​</a></h2><h3 id="加载优化" tabindex="-1">加载优化 <a class="header-anchor" href="#加载优化" aria-label="Permalink to &quot;加载优化&quot;">​</a></h3><table tabindex="0"><thead><tr><th>策略</th><th>说明</th></tr></thead><tbody><tr><td>代码分割</td><td>路由级别懒加载</td></tr><tr><td>资源预加载</td><td>prefetch 下一页</td></tr><tr><td>图片优化</td><td>WebP + 响应式</td></tr><tr><td>字体优化</td><td>font-display: swap</td></tr></tbody></table><h3 id="运行时优化" tabindex="-1">运行时优化 <a class="header-anchor" href="#运行时优化" aria-label="Permalink to &quot;运行时优化&quot;">​</a></h3><table tabindex="0"><thead><tr><th>策略</th><th>说明</th></tr></thead><tbody><tr><td>虚拟滚动</td><td>长列表</td></tr><tr><td>防抖节流</td><td>频繁操作</td></tr><tr><td>Web Worker</td><td>密集计算</td></tr><tr><td>请求合并</td><td>相似请求</td></tr></tbody></table><h3 id="缓存优化" tabindex="-1">缓存优化 <a class="header-anchor" href="#缓存优化" aria-label="Permalink to &quot;缓存优化&quot;">​</a></h3><table tabindex="0"><thead><tr><th>策略</th><th>说明</th></tr></thead><tbody><tr><td>强缓存</td><td>带 hash 的资源</td></tr><tr><td>协商缓存</td><td>HTML 入口</td></tr><tr><td>本地缓存</td><td>业务数据</td></tr><tr><td>内存缓存</td><td>热点数据</td></tr></tbody></table><hr><h2 id="性能测试" tabindex="-1">性能测试 <a class="header-anchor" href="#性能测试" aria-label="Permalink to &quot;性能测试&quot;">​</a></h2><h3 id="测试环境" tabindex="-1">测试环境 <a class="header-anchor" href="#测试环境" aria-label="Permalink to &quot;测试环境&quot;">​</a></h3><table tabindex="0"><thead><tr><th>设备类型</th><th>配置</th><th>说明</th></tr></thead><tbody><tr><td>低端设备</td><td>2GB RAM, 慢 4G</td><td>最低基准</td></tr><tr><td>中端设备</td><td>4GB RAM, 4G</td><td>主要目标</td></tr><tr><td>高端设备</td><td>8GB RAM, WiFi</td><td>理想体验</td></tr></tbody></table><h3 id="测试场景" tabindex="-1">测试场景 <a class="header-anchor" href="#测试场景" aria-label="Permalink to &quot;测试场景&quot;">​</a></h3><table tabindex="0"><thead><tr><th>场景</th><th>验证点</th></tr></thead><tbody><tr><td>冷启动</td><td>FCP &lt; 1.5s</td></tr><tr><td>热启动</td><td>TTI &lt; 1s</td></tr><tr><td>10 个钱包</td><td>列表流畅</td></tr><tr><td>100 条交易</td><td>滚动 60fps</td></tr><tr><td>弱网环境</td><td>超时处理正确</td></tr></tbody></table><hr><h2 id="本章小结" tabindex="-1">本章小结 <a class="header-anchor" href="#本章小结" aria-label="Permalink to &quot;本章小结&quot;">​</a></h2><ul><li>所有关键操作都有明确的性能预算</li><li>包体积、内存、网络分别设定预算</li><li>动画必须保持 60fps</li><li>建立性能监控和预警机制</li><li>针对低端设备优化</li></ul>',75)])])}const q=d(e,[["render",l]]);export{u as __pageData,q as default};
