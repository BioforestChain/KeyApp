import{_ as t,c as s,o as i,ag as n}from"./chunks/framework.B0we9iV-.js";const k=JSON.parse('{"title":"Sheet 底部抽屉","description":"","frontmatter":{},"headers":[],"relativePath":"white-book/05-组件篇/01-基础组件/Sheet.md","filePath":"white-book/05-组件篇/01-基础组件/Sheet.md"}'),e={name:"white-book/05-组件篇/01-基础组件/Sheet.md"};function l(d,a,h,p,r,o){return i(),s("div",null,[...a[0]||(a[0]=[n(`<h1 id="sheet-底部抽屉" tabindex="-1">Sheet 底部抽屉 <a class="header-anchor" href="#sheet-底部抽屉" aria-label="Permalink to &quot;Sheet 底部抽屉&quot;">​</a></h1><blockquote><p>从底部滑出的模态面板</p></blockquote><hr><h2 id="功能描述" tabindex="-1">功能描述 <a class="header-anchor" href="#功能描述" aria-label="Permalink to &quot;功能描述&quot;">​</a></h2><p>从屏幕底部滑出的模态面板，用于展示次级操作或信息，不离开当前页面。</p><hr><h2 id="属性规范" tabindex="-1">属性规范 <a class="header-anchor" href="#属性规范" aria-label="Permalink to &quot;属性规范&quot;">​</a></h2><table tabindex="0"><thead><tr><th>属性</th><th>类型</th><th>必需</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td>open</td><td>boolean</td><td>Y</td><td>-</td><td>是否打开</td></tr><tr><td>onOpenChange</td><td>(open) =&gt; void</td><td>Y</td><td>-</td><td>状态变更回调</td></tr><tr><td>title</td><td>string</td><td>N</td><td>-</td><td>标题</td></tr><tr><td>description</td><td>string</td><td>N</td><td>-</td><td>描述文本</td></tr><tr><td>children</td><td>node</td><td>Y</td><td>-</td><td>内容</td></tr><tr><td>snapPoints</td><td>number[]</td><td>N</td><td>-</td><td>吸附高度点</td></tr><tr><td>dismissible</td><td>boolean</td><td>N</td><td>true</td><td>是否可关闭</td></tr></tbody></table><h3 id="snappoints-吸附点" tabindex="-1">snapPoints 吸附点 <a class="header-anchor" href="#snappoints-吸附点" aria-label="Permalink to &quot;snapPoints 吸附点&quot;">​</a></h3><p>定义 Sheet 可以停留的高度（占屏幕高度的比例）：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>snapPoints: [0.25, 0.5, 0.9]</span></span>
<span class="line"><span>// 25%、50%、90% 三个停留点</span></span></code></pre></div><hr><h2 id="状态机" tabindex="-1">状态机 <a class="header-anchor" href="#状态机" aria-label="Permalink to &quot;状态机&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>    ┌─────────┐  open=true   ┌─────────┐</span></span>
<span class="line"><span>    │ Closed  │ ───────────► │ Opening │</span></span>
<span class="line"><span>    └─────────┘              └─────────┘</span></span>
<span class="line"><span>         ▲                        │</span></span>
<span class="line"><span>         │                        │ animation done</span></span>
<span class="line"><span>         │                        ▼</span></span>
<span class="line"><span>         │                   ┌─────────┐</span></span>
<span class="line"><span>         │                   │  Open   │ ◄─┐</span></span>
<span class="line"><span>         │                   └─────────┘   │ snap</span></span>
<span class="line"><span>         │                        │        │</span></span>
<span class="line"><span>         │                        ├────────┘</span></span>
<span class="line"><span>         │                        │</span></span>
<span class="line"><span>         │    close               │ swipe down / backdrop / button</span></span>
<span class="line"><span>         │                        ▼</span></span>
<span class="line"><span>         │                   ┌─────────┐</span></span>
<span class="line"><span>         └─────────────────  │ Closing │</span></span>
<span class="line"><span>                             └─────────┘</span></span></code></pre></div><hr><h2 id="行为规范" tabindex="-1">行为规范 <a class="header-anchor" href="#行为规范" aria-label="Permalink to &quot;行为规范&quot;">​</a></h2><h3 id="必须-must" tabindex="-1">必须 (MUST) <a class="header-anchor" href="#必须-must" aria-label="Permalink to &quot;必须 (MUST)&quot;">​</a></h3><ol><li>打开时显示半透明背景遮罩</li><li>支持向下滑动关闭（滑动超过 30% 或速度快）</li><li>支持点击背景遮罩关闭（dismissible=true 时）</li><li>有流畅的打开/关闭动画</li><li>顶部显示拖动指示条</li></ol><h3 id="建议-should" tabindex="-1">建议 (SHOULD) <a class="header-anchor" href="#建议-should" aria-label="Permalink to &quot;建议 (SHOULD)&quot;">​</a></h3><ol><li>打开时阻止背景滚动</li><li>使用弹簧动画</li><li>支持多个吸附点</li><li>最大高度不超过 90% 屏幕高度</li></ol><h3 id="可选-may" tabindex="-1">可选 (MAY) <a class="header-anchor" href="#可选-may" aria-label="Permalink to &quot;可选 (MAY)&quot;">​</a></h3><ol><li>支持嵌套 Sheet</li><li>支持左右滑动切换内容</li></ol><hr><h2 id="可访问性" tabindex="-1">可访问性 <a class="header-anchor" href="#可访问性" aria-label="Permalink to &quot;可访问性&quot;">​</a></h2><table tabindex="0"><thead><tr><th>要求</th><th>说明</th></tr></thead><tbody><tr><td>role</td><td>dialog</td></tr><tr><td>aria-modal</td><td>true</td></tr><tr><td>aria-labelledby</td><td>关联标题</td></tr><tr><td>焦点陷阱</td><td>焦点限制在 Sheet 内</td></tr><tr><td>打开时</td><td>焦点移入 Sheet</td></tr><tr><td>关闭时</td><td>焦点返回触发元素</td></tr><tr><td>ESC 键</td><td>关闭 Sheet</td></tr></tbody></table><hr><h2 id="布局规范" tabindex="-1">布局规范 <a class="header-anchor" href="#布局规范" aria-label="Permalink to &quot;布局规范&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>┌─────────────────────────────────────┐</span></span>
<span class="line"><span>│              [遮罩层]               │</span></span>
<span class="line"><span>│                                     │</span></span>
<span class="line"><span>│  ┌─────────────────────────────────┐│</span></span>
<span class="line"><span>│  │           ═══════               ││ ← 拖动指示条</span></span>
<span class="line"><span>│  │         标题（可选）             ││</span></span>
<span class="line"><span>│  │         描述（可选）             ││</span></span>
<span class="line"><span>│  ├─────────────────────────────────┤│</span></span>
<span class="line"><span>│  │                                 ││</span></span>
<span class="line"><span>│  │           内容区域              ││ ← 可滚动</span></span>
<span class="line"><span>│  │                                 ││</span></span>
<span class="line"><span>│  ├─────────────────────────────────┤│</span></span>
<span class="line"><span>│  │         操作按钮（可选）         ││</span></span>
<span class="line"><span>│  │         [安全区域]              ││</span></span>
<span class="line"><span>│  └─────────────────────────────────┘│</span></span>
<span class="line"><span>└─────────────────────────────────────┘</span></span></code></pre></div><hr><h2 id="设计标注" tabindex="-1">设计标注 <a class="header-anchor" href="#设计标注" aria-label="Permalink to &quot;设计标注&quot;">​</a></h2><h3 id="尺寸规格" tabindex="-1">尺寸规格 <a class="header-anchor" href="#尺寸规格" aria-label="Permalink to &quot;尺寸规格&quot;">​</a></h3><table tabindex="0"><thead><tr><th>部分</th><th>规格</th></tr></thead><tbody><tr><td>圆角</td><td>顶部 24px</td></tr><tr><td>拖动条宽度</td><td>36px</td></tr><tr><td>拖动条高度</td><td>4px</td></tr><tr><td>拖动条距顶部</td><td>8px</td></tr><tr><td>内边距</td><td>16px</td></tr><tr><td>安全区域</td><td>底部 env(safe-area-inset-bottom)</td></tr></tbody></table><h3 id="颜色规格" tabindex="-1">颜色规格 <a class="header-anchor" href="#颜色规格" aria-label="Permalink to &quot;颜色规格&quot;">​</a></h3><table tabindex="0"><thead><tr><th>部分</th><th>颜色</th></tr></thead><tbody><tr><td>遮罩</td><td>rgba(0, 0, 0, 0.5)</td></tr><tr><td>背景</td><td>--color-background</td></tr><tr><td>拖动条</td><td>--color-muted</td></tr></tbody></table><h3 id="动画规格" tabindex="-1">动画规格 <a class="header-anchor" href="#动画规格" aria-label="Permalink to &quot;动画规格&quot;">​</a></h3><table tabindex="0"><thead><tr><th>属性</th><th>值</th></tr></thead><tbody><tr><td>打开时长</td><td>300ms</td></tr><tr><td>关闭时长</td><td>200ms</td></tr><tr><td>缓动函数</td><td>spring (damping: 0.8) 或 ease-out</td></tr></tbody></table><hr><h2 id="手势规范" tabindex="-1">手势规范 <a class="header-anchor" href="#手势规范" aria-label="Permalink to &quot;手势规范&quot;">​</a></h2><h3 id="下滑关闭" tabindex="-1">下滑关闭 <a class="header-anchor" href="#下滑关闭" aria-label="Permalink to &quot;下滑关闭&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>滑动距离 &lt; 30% 高度 → 弹回当前位置</span></span>
<span class="line"><span>滑动距离 ≥ 30% 高度 → 关闭</span></span>
<span class="line"><span>滑动速度 &gt; 500px/s → 无论距离，直接关闭</span></span></code></pre></div><h3 id="多吸附点" tabindex="-1">多吸附点 <a class="header-anchor" href="#多吸附点" aria-label="Permalink to &quot;多吸附点&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>松手时，根据当前位置和速度方向</span></span>
<span class="line"><span>选择最近的吸附点或上/下一个吸附点</span></span></code></pre></div><hr><h2 id="使用场景" tabindex="-1">使用场景 <a class="header-anchor" href="#使用场景" aria-label="Permalink to &quot;使用场景&quot;">​</a></h2><table tabindex="0"><thead><tr><th>场景</th><th>配置</th></tr></thead><tbody><tr><td>确认操作</td><td>固定高度，有操作按钮</td></tr><tr><td>选择列表</td><td>可滚动内容，选中后自动关闭</td></tr><tr><td>详情展示</td><td>多吸附点，可展开查看更多</td></tr><tr><td>表单输入</td><td>键盘弹出时自动调整高度</td></tr></tbody></table><hr><h2 id="技术实现" tabindex="-1">技术实现 <a class="header-anchor" href="#技术实现" aria-label="Permalink to &quot;技术实现&quot;">​</a></h2><h3 id="必须-must-1" tabindex="-1">必须 (MUST) <a class="header-anchor" href="#必须-must-1" aria-label="Permalink to &quot;必须 (MUST)&quot;">​</a></h3><ol><li><p><strong>使用 Stackflow 的 BottomSheet 组件作为底层实现</strong></p><div class="language-tsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { BottomSheet } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@stackflow/plugin-basic-ui&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div></li><li><p>这确保 Sheet 与 Stackflow Activity 系统正确集成，避免页面动画冲突</p></li><li><p><strong>禁止</strong>使用自定义 <code>position: fixed</code> 实现，会导致：</p><ul><li>与 Stackflow 页面转场动画冲突</li><li>背景页面&quot;运动&quot;问题</li><li>滚动锁定与 Activity 生命周期不同步</li></ul></li></ol><h3 id="封装规范" tabindex="-1">封装规范 <a class="header-anchor" href="#封装规范" aria-label="Permalink to &quot;封装规范&quot;">​</a></h3><p>项目的 <code>BottomSheet</code> 组件（<code>src/components/layout/bottom-sheet.tsx</code>）应：</p><ol><li>内部使用 <code>@stackflow/plugin-basic-ui</code> 的 <code>BottomSheet</code></li><li>对外暴露符合本规范的 API</li><li>添加项目特定的样式和行为扩展</li></ol><div class="language-tsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 正确的实现方式</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { BottomSheet </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> StackflowBottomSheet } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@stackflow/plugin-basic-ui&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> BottomSheet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">open</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">onClose</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">children</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">props</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">open) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StackflowBottomSheet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 自定义样式和内容 */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {children}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StackflowBottomSheet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><hr><h2 id="roadmap-待办事项" tabindex="-1">Roadmap / 待办事项 <a class="header-anchor" href="#roadmap-待办事项" aria-label="Permalink to &quot;Roadmap / 待办事项&quot;">​</a></h2><table tabindex="0"><thead><tr><th>优先级</th><th>事项</th><th>状态</th><th>说明</th></tr></thead><tbody><tr><td>P1</td><td>统一 safe-area-inset-bottom 处理</td><td>待处理</td><td>确保所有 Sheet Activity 在 iOS 设备上正确处理底部安全区域</td></tr><tr><td>P2</td><td>Sheet 手势下滑关闭</td><td>待评估</td><td>Stackflow BottomSheet 是否原生支持，或需要额外实现</td></tr><tr><td>P2</td><td>Sheet 多吸附点支持</td><td>待评估</td><td>评估是否需要支持多个高度吸附点</td></tr></tbody></table><hr><h2 id="参考文档" tabindex="-1">参考文档 <a class="header-anchor" href="#参考文档" aria-label="Permalink to &quot;参考文档&quot;">​</a></h2><ul><li><strong>Stackflow 官方文档（LLM 友好版）</strong>: <a href="https://stackflow.so/llms-full.txt" target="_blank" rel="noreferrer">https://stackflow.so/llms-full.txt</a></li><li><strong><code>@stackflow/plugin-basic-ui</code> API</strong>: 包含 <code>AppScreen</code>、<code>BottomSheet</code>、<code>Modal</code> 三种 Activity 容器组件</li></ul>`,59)])])}const b=t(e,[["render",l]]);export{k as __pageData,b as default};
