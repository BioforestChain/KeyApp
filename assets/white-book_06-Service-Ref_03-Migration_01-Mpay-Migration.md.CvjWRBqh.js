import{_ as t,c as a,o,ag as r}from"./chunks/framework.B0we9iV-.js";const h=JSON.parse('{"title":"Migration Service","description":"","frontmatter":{},"headers":[],"relativePath":"white-book/06-Service-Ref/03-Migration/01-Mpay-Migration.md","filePath":"white-book/06-Service-Ref/03-Migration/01-Mpay-Migration.md"}'),i={name:"white-book/06-Service-Ref/03-Migration/01-Mpay-Migration.md"};function n(s,e,l,c,d,g){return o(),a("div",null,[...e[0]||(e[0]=[r('<h1 id="migration-service" tabindex="-1">Migration Service <a class="header-anchor" href="#migration-service" aria-label="Permalink to &quot;Migration Service&quot;">​</a></h1><blockquote><p><strong>Code Source</strong>: <a href="https://github.com/BioforestChain/KeyApp/blob/main/src/services/migration/migration-service.ts" target="_blank" rel="noreferrer"><code>src/services/migration/migration-service.ts</code></a></p></blockquote><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>The <code>MigrationService</code> handles the critical task of importing data from the legacy &quot;mpay&quot; application. It orchestrates a multi-step process ensuring data integrity and security.</p><h2 id="migration-flow" tabindex="-1">Migration Flow <a class="header-anchor" href="#migration-flow" aria-label="Permalink to &quot;Migration Flow&quot;">​</a></h2><p>The process is defined as a state machine:</p><ol><li><strong><code>idle</code></strong></li><li><strong><code>detect</code></strong>: Scans <code>localStorage</code> for legacy mpay data structures.</li><li><strong><code>verify</code></strong>: Validates the user&#39;s password against the legacy wallet encryption.</li><li><strong><code>transform</code></strong>: Converts legacy data formats to the new KeyApp schema (<code>WalletInfo</code>, <code>ChainAddressInfo</code>).</li><li><strong><code>import</code></strong>: Writes the transformed data to <code>WalletStorageService</code> (IndexedDB).</li><li><strong><code>complete</code></strong></li></ol><h2 id="key-features" tabindex="-1">Key Features <a class="header-anchor" href="#key-features" aria-label="Permalink to &quot;Key Features&quot;">​</a></h2><ul><li><strong>Progress Tracking</strong>: Reports granular progress updates to the UI.</li><li><strong>Resumability</strong>: Stores migration status in <code>localStorage</code> (<code>keyapp_migration_status</code>).</li><li><strong>Security</strong>: Decrypts legacy data in memory and immediately re-encrypts it using the new wallet lock system.</li></ul><h2 id="data-mapping" tabindex="-1">Data Mapping <a class="header-anchor" href="#data-mapping" aria-label="Permalink to &quot;Data Mapping&quot;">​</a></h2><table tabindex="0"><thead><tr><th style="text-align:left;">Legacy (mpay)</th><th style="text-align:left;">New (KeyApp)</th></tr></thead><tbody><tr><td style="text-align:left;"><code>Wallet</code> (localStorage)</td><td style="text-align:left;"><code>WalletInfo</code> (IndexedDB)</td></tr><tr><td style="text-align:left;"><code>AddressBook</code></td><td style="text-align:left;"><code>Contact</code> (Store)</td></tr><tr><td style="text-align:left;"><code>importPhrase</code></td><td style="text-align:left;"><code>encryptedMnemonic</code></td></tr></tbody></table>',11)])])}const m=t(i,[["render",n]]);export{h as __pageData,m as default};
