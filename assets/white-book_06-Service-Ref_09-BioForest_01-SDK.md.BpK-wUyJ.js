import{_ as n,c as t,o as e,ag as i,j as s}from"./chunks/framework.B0we9iV-.js";const E=JSON.parse('{"title":"BioForest Chain SDK","description":"","frontmatter":{},"headers":[],"relativePath":"white-book/06-Service-Ref/09-BioForest/01-SDK.md","filePath":"white-book/06-Service-Ref/09-BioForest/01-SDK.md"}'),l={name:"white-book/06-Service-Ref/09-BioForest/01-SDK.md"};function p(h,a,k,r,d,c){return e(),t("div",null,[...a[0]||(a[0]=[i(`<h1 id="bioforest-chain-sdk" tabindex="-1">BioForest Chain SDK <a class="header-anchor" href="#bioforest-chain-sdk" aria-label="Permalink to &quot;BioForest Chain SDK&quot;">​</a></h1><blockquote><p>源码: <a href="https://github.com/BioforestChain/KeyApp/blob/main/src/services/bioforest-sdk/" target="_blank" rel="noreferrer"><code>src/services/bioforest-sdk/</code></a></p></blockquote><h2 id="概述" tabindex="-1">概述 <a class="header-anchor" href="#概述" aria-label="Permalink to &quot;概述&quot;">​</a></h2><p>BioForest Chain SDK 是 BioForest 链交易创建和签名的唯一入口，封装了 SDK Bundle 加载、Genesis Block 获取、交易构建等功能。</p><h2 id="架构" tabindex="-1">架构 <a class="header-anchor" href="#架构" aria-label="Permalink to &quot;架构&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>bioforest-sdk (本模块)</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ├── SDK Bundle (预编译 .cjs)</span></span>
<span class="line"><span>    │   └── 动态加载 bioforest-chain-bundle.js</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ├── Genesis Blocks</span></span>
<span class="line"><span>    │   └── /configs/genesis/{chainId}.json</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ├── Crypto Helper</span></span>
<span class="line"><span>    │   └── @noble/hashes (SHA-256, MD5, RIPEMD-160)</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    └── Network API</span></span>
<span class="line"><span>        └── BnqklWalletBioforestApi</span></span></code></pre></div><h2 id="支持的链" tabindex="-1">支持的链 <a class="header-anchor" href="#支持的链" aria-label="Permalink to &quot;支持的链&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Chain ID</th><th>Magic</th><th>API Path</th><th>说明</th></tr></thead><tbody><tr><td>bfmeta</td><td>nxOGQ</td><td>bfm</td><td>BFMeta 主网</td></tr><tr><td>bfchain</td><td>...</td><td>bfchain</td><td>BFChain</td></tr><tr><td>ccchain</td><td>...</td><td>ccchain</td><td>CCChain</td></tr><tr><td>pmchain</td><td>...</td><td>pmchain</td><td>PMChain</td></tr></tbody></table><h2 id="核心-api" tabindex="-1">核心 API <a class="header-anchor" href="#核心-api" aria-label="Permalink to &quot;核心 API&quot;">​</a></h2><h3 id="getbioforestcore" tabindex="-1">getBioforestCore <a class="header-anchor" href="#getbioforestcore" aria-label="Permalink to &quot;getBioforestCore&quot;">​</a></h3><p>获取链核心实例：</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { getBioforestCore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/services/bioforest-sdk&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> core</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getBioforestCore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;bfmeta&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// core.transactionController - 交易控制器</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// core.accountBaseHelper() - 账户助手</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// core.getAssetType() - 获取主资产类型</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// core.getChainName() - 获取链名</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// core.getMagic() - 获取 Magic</span></span></code></pre></div><h3 id="getlastblock" tabindex="-1">getLastBlock <a class="header-anchor" href="#getlastblock" aria-label="Permalink to &quot;getLastBlock&quot;">​</a></h3><p>获取最新区块信息：</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { getLastBlock } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/services/bioforest-sdk&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> block</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getLastBlock</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;https://walletapi.bfmeta.info&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;bfm&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // API path, not chainId</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// { height: 123456, timestamp: 1705312800 }</span></span></code></pre></div><h3 id="getaddressinfo" tabindex="-1">getAddressInfo <a class="header-anchor" href="#getaddressinfo" aria-label="Permalink to &quot;getAddressInfo&quot;">​</a></h3><p>获取地址信息（含安全密码公钥）：</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { getAddressInfo } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/services/bioforest-sdk&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> info</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getAddressInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;https://walletapi.bfmeta.info&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;bfm&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;bXXX...&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// { address, secondPublicKey?, accountStatus? }</span></span></code></pre></div><h3 id="getaccountbalance" tabindex="-1">getAccountBalance <a class="header-anchor" href="#getaccountbalance" aria-label="Permalink to &quot;getAccountBalance&quot;">​</a></h3><p>获取账户余额：</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { getAccountBalance } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/services/bioforest-sdk&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> balance</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getAccountBalance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;https://walletapi.bfmeta.info&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;bfmeta&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// chainId for genesis</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;bXXX...&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &#39;100000000&#39; (in chain units, 1e8)</span></span></code></pre></div><h3 id="createtransfertransaction" tabindex="-1">createTransferTransaction <a class="header-anchor" href="#createtransfertransaction" aria-label="Permalink to &quot;createTransferTransaction&quot;">​</a></h3><p>创建转账交易：</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { createTransferTransaction } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/services/bioforest-sdk&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> tx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> createTransferTransaction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  rpcUrl: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;https://walletapi.bfmeta.info&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  chainId: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;bfmeta&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  apiPath: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;bfm&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 可选，默认根据 chainId 推断</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  mainSecret: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;mnemonic or private key&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  paySecret: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;pay password&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 可选，如果设置了安全密码</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  from: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;bXXX...&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  to: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;bYYY...&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  amount: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;100000000&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 1 BFM (1e8)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  assetType: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;BFM&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  fee: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;10000&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 可选，自动计算</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  remark: { memo: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;test&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h3 id="broadcasttransaction" tabindex="-1">broadcastTransaction <a class="header-anchor" href="#broadcasttransaction" aria-label="Permalink to &quot;broadcastTransaction&quot;">​</a></h3><p>广播交易：</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { broadcastTransaction } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/services/bioforest-sdk&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> txHash</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> broadcastTransaction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;https://walletapi.bfmeta.info&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;bfm&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  signedTransaction</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="verifytwostepsecret" tabindex="-1">verifyTwoStepSecret <a class="header-anchor" href="#verifytwostepsecret" aria-label="Permalink to &quot;verifyTwoStepSecret&quot;">​</a></h3><p>验证安全密码：</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { verifyTwoStepSecret } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/services/bioforest-sdk&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> version</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> verifyTwoStepSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;bfmeta&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  mainSecret,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  paySecret,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  secondPublicKey</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &#39;v2&#39; | &#39;v1&#39; | false</span></span></code></pre></div><h3 id="settwostepsecret" tabindex="-1">setTwoStepSecret <a class="header-anchor" href="#settwostepsecret" aria-label="Permalink to &quot;setTwoStepSecret&quot;">​</a></h3><p>设置安全密码：</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { setTwoStepSecret } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/services/bioforest-sdk&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setTwoStepSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  rpcUrl: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;https://walletapi.bfmeta.info&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  chainId: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;bfmeta&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  mainSecret: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;mnemonic...&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  newPaySecret: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;new pay password&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// { txHash, success: true }</span></span></code></pre></div><h2 id="genesis-block-加载" tabindex="-1">Genesis Block 加载 <a class="header-anchor" href="#genesis-block-加载" aria-label="Permalink to &quot;Genesis Block 加载&quot;">​</a></h2><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 浏览器环境</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 从 /configs/genesis/bfmeta.json 加载</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Node.js 环境</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { setGenesisBaseUrl } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/services/bioforest-sdk&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setGenesisBaseUrl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;file:///path/to/public/configs/genesis&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  { with: { type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;json&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h2 id="缓存机制" tabindex="-1">缓存机制 <a class="header-anchor" href="#缓存机制" aria-label="Permalink to &quot;缓存机制&quot;">​</a></h2>`,36),s("table",{tabindex:"0"},[s("thead",null,[s("tr",null,[s("th",null,"缓存"),s("th",null,"Key"),s("th",null,"说明")])]),s("tbody",null,[s("tr",null,[s("td",null,"API Client"),s("td",{baseUrl:""},"`$"),s("td",null,"${chainPath}`")]),s("tr",null,[s("td",null,"Genesis Block"),s("td",null,"chainId"),s("td",null,"按链 ID 缓存")]),s("tr",null,[s("td",null,"Core Instance"),s("td",null,"chainMagic"),s("td",null,"按链 Magic 缓存")]),s("tr",null,[s("td",null,"SDK Bundle"),s("td",null,"singleton"),s("td",null,"全局单例")])])],-1),i(`<h2 id="交易流程" tabindex="-1">交易流程 <a class="header-anchor" href="#交易流程" aria-label="Permalink to &quot;交易流程&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>createTransferTransaction()</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ├── getBioforestCore(chainId)</span></span>
<span class="line"><span>    │   ├── 加载 Genesis Block</span></span>
<span class="line"><span>    │   ├── 加载 SDK Bundle</span></span>
<span class="line"><span>    │   └── 初始化 Core</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ├── getLastBlock()</span></span>
<span class="line"><span>    │   └── 获取 applyBlockHeight + timestamp</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ├── 计算手续费 (如未提供)</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ├── 处理安全密码</span></span>
<span class="line"><span>    │   ├── getAddressInfo() → secondPublicKey</span></span>
<span class="line"><span>    │   └── verifyTwoStepSecret() → v1/v2</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    └── core.transactionController.createTransferTransactionJSON()</span></span></code></pre></div><h2 id="crypto-helper" tabindex="-1">Crypto Helper <a class="header-anchor" href="#crypto-helper" aria-label="Permalink to &quot;Crypto Helper&quot;">​</a></h2><p>使用 @noble/hashes 实现跨平台兼容：</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cryptoHelper</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> BFChainCore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CryptoHelperInterface</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  sha256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) { </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* @noble/hashes/sha2 */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  md5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) { </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* @noble/hashes/legacy */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  ripemd160</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) { </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* @noble/hashes/legacy */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="注意事项" tabindex="-1">注意事项 <a class="header-anchor" href="#注意事项" aria-label="Permalink to &quot;注意事项&quot;">​</a></h2><ol><li><p><strong>API Path vs Chain ID</strong>:</p><ul><li><code>bfmeta</code> 链的 API 路径是 <code>bfm</code>，不是 <code>bfmeta</code></li><li>其他链 API 路径与 Chain ID 相同</li></ul></li><li><p><strong>安全密码版本</strong>:</p><ul><li>V2: 新算法 <code>createSecondSecretKeypairV2</code></li><li>V1: 旧算法 <code>createSecondSecretKeypair</code></li><li>验证时先尝试 V2，失败再尝试 V1</li></ul></li><li><p><strong>单位转换</strong>:</p><ul><li>链上单位: 1e8 (8位小数)</li><li>显示单位: 实际数量</li></ul></li></ol>`,7)])])}const g=n(l,[["render",p]]);export{E as __pageData,g as default};
