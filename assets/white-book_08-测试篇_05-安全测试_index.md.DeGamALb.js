import{_ as n,c as s,o as t,ag as e}from"./chunks/framework.B0we9iV-.js";const b=JSON.parse('{"title":"安全测试规范","description":"","frontmatter":{},"headers":[],"relativePath":"white-book/08-测试篇/05-安全测试/index.md","filePath":"white-book/08-测试篇/05-安全测试/index.md"}'),l={name:"white-book/08-测试篇/05-安全测试/index.md"};function p(d,a,i,r,h,o){return t(),s("div",null,[...a[0]||(a[0]=[e(`<h1 id="安全测试规范" tabindex="-1">安全测试规范 <a class="header-anchor" href="#安全测试规范" aria-label="Permalink to &quot;安全测试规范&quot;">​</a></h1><blockquote><p>定义安全测试策略、测试用例和自动化方案</p></blockquote><hr><h2 id="安全测试类型" tabindex="-1">安全测试类型 <a class="header-anchor" href="#安全测试类型" aria-label="Permalink to &quot;安全测试类型&quot;">​</a></h2><table tabindex="0"><thead><tr><th>类型</th><th>目的</th><th>执行频率</th></tr></thead><tbody><tr><td>静态分析 (SAST)</td><td>代码漏洞检测</td><td>每次 PR</td></tr><tr><td>依赖扫描 (SCA)</td><td>依赖漏洞检测</td><td>每日</td></tr><tr><td>动态测试 (DAST)</td><td>运行时漏洞检测</td><td>每周</td></tr><tr><td>渗透测试</td><td>模拟真实攻击</td><td>每季度</td></tr></tbody></table><hr><h2 id="静态安全分析" tabindex="-1">静态安全分析 <a class="header-anchor" href="#静态安全分析" aria-label="Permalink to &quot;静态安全分析&quot;">​</a></h2><h3 id="代码扫描规则" tabindex="-1">代码扫描规则 <a class="header-anchor" href="#代码扫描规则" aria-label="Permalink to &quot;代码扫描规则&quot;">​</a></h3><table tabindex="0"><thead><tr><th>规则类别</th><th>检测项</th><th>严重级别</th></tr></thead><tbody><tr><td>硬编码密钥</td><td>API Key、图案</td><td>Critical</td></tr><tr><td>敏感数据泄露</td><td>日志中的私钥</td><td>Critical</td></tr><tr><td>不安全随机数</td><td>Math.random() 用于加密</td><td>High</td></tr><tr><td>XSS 漏洞</td><td>innerHTML, dangerouslySetInnerHTML</td><td>High</td></tr><tr><td>不安全依赖</td><td>eval(), Function()</td><td>Medium</td></tr></tbody></table><h3 id="自动化检测" tabindex="-1">自动化检测 <a class="header-anchor" href="#自动化检测" aria-label="Permalink to &quot;自动化检测&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>PR 提交</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ▼</span></span>
<span class="line"><span>静态分析扫描</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ├── Critical ──► 阻止合并</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ├── High ──► 阻止合并 + 通知</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ├── Medium ──► 警告</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    └── Low ──► 记录</span></span></code></pre></div><h3 id="敏感信息检测模式" tabindex="-1">敏感信息检测模式 <a class="header-anchor" href="#敏感信息检测模式" aria-label="Permalink to &quot;敏感信息检测模式&quot;">​</a></h3><table tabindex="0"><thead><tr><th>类型</th><th>检测模式</th><th>动作</th></tr></thead><tbody><tr><td>私钥</td><td><code>/[0-9a-f]{64}/i</code></td><td>阻止</td></tr><tr><td>助记词</td><td>12/24 个单词序列</td><td>阻止</td></tr><tr><td>API Key</td><td>已知格式的 Key</td><td>警告</td></tr></tbody></table><hr><h2 id="依赖安全扫描" tabindex="-1">依赖安全扫描 <a class="header-anchor" href="#依赖安全扫描" aria-label="Permalink to &quot;依赖安全扫描&quot;">​</a></h2><h3 id="漏洞评级" tabindex="-1">漏洞评级 <a class="header-anchor" href="#漏洞评级" aria-label="Permalink to &quot;漏洞评级&quot;">​</a></h3><table tabindex="0"><thead><tr><th>级别</th><th>CVSS</th><th>要求</th></tr></thead><tbody><tr><td>Critical</td><td>9.0-10.0</td><td>24h 内修复</td></tr><tr><td>High</td><td>7.0-8.9</td><td>7 天内修复</td></tr><tr><td>Medium</td><td>4.0-6.9</td><td>30 天内修复</td></tr><tr><td>Low</td><td>0.1-3.9</td><td>下次发布修复</td></tr></tbody></table><h3 id="扫描配置" tabindex="-1">扫描配置 <a class="header-anchor" href="#扫描配置" aria-label="Permalink to &quot;扫描配置&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>依赖扫描策略：</span></span>
<span class="line"><span>- 每日自动扫描所有依赖</span></span>
<span class="line"><span>- PR 时检查新增依赖</span></span>
<span class="line"><span>- Critical/High 漏洞阻止合并</span></span>
<span class="line"><span>- 生成修复建议报告</span></span></code></pre></div><h3 id="处理流程" tabindex="-1">处理流程 <a class="header-anchor" href="#处理流程" aria-label="Permalink to &quot;处理流程&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>发现漏洞</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ▼</span></span>
<span class="line"><span>评估影响范围</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ├── 有补丁 ──► 升级依赖</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    └── 无补丁</span></span>
<span class="line"><span>         │</span></span>
<span class="line"><span>         ├── 可替换 ──► 更换依赖</span></span>
<span class="line"><span>         │</span></span>
<span class="line"><span>         └── 不可替换 ──► 添加缓解措施 + 监控</span></span></code></pre></div><hr><h2 id="安全功能测试" tabindex="-1">安全功能测试 <a class="header-anchor" href="#安全功能测试" aria-label="Permalink to &quot;安全功能测试&quot;">​</a></h2><h3 id="认证测试" tabindex="-1">认证测试 <a class="header-anchor" href="#认证测试" aria-label="Permalink to &quot;认证测试&quot;">​</a></h3><table tabindex="0"><thead><tr><th>测试用例</th><th>验证点</th></tr></thead><tbody><tr><td>正确图案解锁</td><td>成功解锁</td></tr><tr><td>错误图案 5 次</td><td>显示延迟警告</td></tr><tr><td>错误图案 10 次</td><td>账户锁定</td></tr><tr><td>生物识别取消</td><td>回退图案锁</td></tr><tr><td>生物识别 3 次失败</td><td>强制图案锁</td></tr></tbody></table><h3 id="加密测试" tabindex="-1">加密测试 <a class="header-anchor" href="#加密测试" aria-label="Permalink to &quot;加密测试&quot;">​</a></h3><table tabindex="0"><thead><tr><th>测试用例</th><th>验证点</th></tr></thead><tbody><tr><td>助记词加密存储</td><td>存储中无明文</td></tr><tr><td>不同图案产生不同密文</td><td>密文不同</td></tr><tr><td>图案验证</td><td>正确图案能解密</td></tr><tr><td>错误图案解密</td><td>解密失败</td></tr><tr><td>随机数唯一性</td><td>每次加密 IV 不同</td></tr></tbody></table><h3 id="输入验证测试" tabindex="-1">输入验证测试 <a class="header-anchor" href="#输入验证测试" aria-label="Permalink to &quot;输入验证测试&quot;">​</a></h3><table tabindex="0"><thead><tr><th>测试用例</th><th>输入</th><th>预期结果</th></tr></thead><tbody><tr><td>地址 XSS</td><td><code>&lt;script&gt;alert(1)&lt;/script&gt;</code></td><td>拒绝/转义</td></tr><tr><td>金额溢出</td><td><code>99999999999999999</code></td><td>显示错误</td></tr><tr><td>负数金额</td><td><code>-100</code></td><td>拒绝</td></tr><tr><td>SQL 注入</td><td><code>&#39;; DROP TABLE;--</code></td><td>无影响</td></tr><tr><td>路径穿越</td><td><code>../../etc/passwd</code></td><td>拒绝</td></tr></tbody></table><h3 id="授权测试" tabindex="-1">授权测试 <a class="header-anchor" href="#授权测试" aria-label="Permalink to &quot;授权测试&quot;">​</a></h3><table tabindex="0"><thead><tr><th>测试用例</th><th>验证点</th></tr></thead><tbody><tr><td>DWEB 授权显示</td><td>显示请求方信息</td></tr><tr><td>授权拒绝</td><td>正确返回拒绝</td></tr><tr><td>签名内容展示</td><td>可读格式显示</td></tr><tr><td>恶意签名请求</td><td>警告提示</td></tr></tbody></table><hr><h2 id="渗透测试场景" tabindex="-1">渗透测试场景 <a class="header-anchor" href="#渗透测试场景" aria-label="Permalink to &quot;渗透测试场景&quot;">​</a></h2><h3 id="场景-1-助记词窃取" tabindex="-1">场景 1: 助记词窃取 <a class="header-anchor" href="#场景-1-助记词窃取" aria-label="Permalink to &quot;场景 1: 助记词窃取&quot;">​</a></h3><p><strong>攻击路径：</strong></p><ol><li>尝试从存储读取助记词</li><li>尝试从内存 dump 获取</li><li>尝试通过日志获取</li><li>尝试通过网络拦截</li></ol><p><strong>验证点：</strong></p><ul><li>存储加密</li><li>内存及时清理</li><li>日志无敏感数据</li><li>无网络传输</li></ul><h3 id="场景-2-中间人攻击" tabindex="-1">场景 2: 中间人攻击 <a class="header-anchor" href="#场景-2-中间人攻击" aria-label="Permalink to &quot;场景 2: 中间人攻击&quot;">​</a></h3><p><strong>攻击路径：</strong></p><ol><li>代理拦截 HTTPS 请求</li><li>尝试篡改 API 响应</li><li>尝试伪造交易</li></ol><p><strong>验证点：</strong></p><ul><li>SSL 证书验证</li><li>响应签名验证</li><li>本地签名不可篡改</li></ul><h3 id="场景-3-钓鱼攻击" tabindex="-1">场景 3: 钓鱼攻击 <a class="header-anchor" href="#场景-3-钓鱼攻击" aria-label="Permalink to &quot;场景 3: 钓鱼攻击&quot;">​</a></h3><p><strong>攻击路径：</strong></p><ol><li>伪造授权页面</li><li>诱骗用户签名</li><li>窃取资产</li></ol><p><strong>验证点：</strong></p><ul><li>显示请求来源</li><li>签名内容可读</li><li>可疑请求警告</li></ul><h3 id="场景-4-重放攻击" tabindex="-1">场景 4: 重放攻击 <a class="header-anchor" href="#场景-4-重放攻击" aria-label="Permalink to &quot;场景 4: 重放攻击&quot;">​</a></h3><p><strong>攻击路径：</strong></p><ol><li>截获已签名交易</li><li>重复广播交易</li></ol><p><strong>验证点：</strong></p><ul><li>nonce 机制防重放</li><li>交易幂等性</li></ul><hr><h2 id="安全测试自动化" tabindex="-1">安全测试自动化 <a class="header-anchor" href="#安全测试自动化" aria-label="Permalink to &quot;安全测试自动化&quot;">​</a></h2><h3 id="ci-集成" tabindex="-1">CI 集成 <a class="header-anchor" href="#ci-集成" aria-label="Permalink to &quot;CI 集成&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>┌─────────────────────────────────────┐</span></span>
<span class="line"><span>│              PR 提交                 │</span></span>
<span class="line"><span>└──────────────┬──────────────────────┘</span></span>
<span class="line"><span>               │</span></span>
<span class="line"><span>    ┌──────────┼──────────┐</span></span>
<span class="line"><span>    │          │          │</span></span>
<span class="line"><span>    ▼          ▼          ▼</span></span>
<span class="line"><span>┌───────┐ ┌───────┐ ┌───────┐</span></span>
<span class="line"><span>│ SAST  │ │  SCA  │ │ 单元  │</span></span>
<span class="line"><span>│ 扫描  │ │ 扫描  │ │ 测试  │</span></span>
<span class="line"><span>└───┬───┘ └───┬───┘ └───┬───┘</span></span>
<span class="line"><span>    │         │         │</span></span>
<span class="line"><span>    └─────────┼─────────┘</span></span>
<span class="line"><span>              │</span></span>
<span class="line"><span>              ▼</span></span>
<span class="line"><span>        ┌───────────┐</span></span>
<span class="line"><span>        │ 结果汇总  │</span></span>
<span class="line"><span>        └─────┬─────┘</span></span>
<span class="line"><span>              │</span></span>
<span class="line"><span>    ┌─────────┼─────────┐</span></span>
<span class="line"><span>    │         │         │</span></span>
<span class="line"><span>    ▼         ▼         ▼</span></span>
<span class="line"><span> 通过      警告      失败</span></span>
<span class="line"><span>              │</span></span>
<span class="line"><span>              ▼</span></span>
<span class="line"><span>         阻止合并</span></span></code></pre></div><h3 id="安全测试报告" tabindex="-1">安全测试报告 <a class="header-anchor" href="#安全测试报告" aria-label="Permalink to &quot;安全测试报告&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>SecurityTestReport {</span></span>
<span class="line"><span>  timestamp: number</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>  staticAnalysis: {</span></span>
<span class="line"><span>    critical: number</span></span>
<span class="line"><span>    high: number</span></span>
<span class="line"><span>    medium: number</span></span>
<span class="line"><span>    low: number</span></span>
<span class="line"><span>    findings: Finding[]</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>  dependencyAudit: {</span></span>
<span class="line"><span>    vulnerabilities: Vulnerability[]</span></span>
<span class="line"><span>    outdatedPackages: number</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>  securityTests: {</span></span>
<span class="line"><span>    passed: number</span></span>
<span class="line"><span>    failed: number</span></span>
<span class="line"><span>    skipped: number</span></span>
<span class="line"><span>    failures: TestFailure[]</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre></div><hr><h2 id="安全测试环境" tabindex="-1">安全测试环境 <a class="header-anchor" href="#安全测试环境" aria-label="Permalink to &quot;安全测试环境&quot;">​</a></h2><h3 id="隔离要求" tabindex="-1">隔离要求 <a class="header-anchor" href="#隔离要求" aria-label="Permalink to &quot;隔离要求&quot;">​</a></h3><table tabindex="0"><thead><tr><th>要求</th><th>说明</th></tr></thead><tbody><tr><td>独立环境</td><td>不影响生产数据</td></tr><tr><td>测试钱包</td><td>使用测试网</td></tr><tr><td>模拟攻击</td><td>安全沙箱内</td></tr><tr><td>数据清理</td><td>测试后清除</td></tr></tbody></table><h3 id="测试数据" tabindex="-1">测试数据 <a class="header-anchor" href="#测试数据" aria-label="Permalink to &quot;测试数据&quot;">​</a></h3><table tabindex="0"><thead><tr><th>数据</th><th>来源</th><th>安全要求</th></tr></thead><tbody><tr><td>测试助记词</td><td>预生成</td><td>不含真实资产</td></tr><tr><td>测试私钥</td><td>预生成</td><td>测试网专用</td></tr><tr><td>攻击向量</td><td>OWASP</td><td>持续更新</td></tr></tbody></table><hr><h2 id="漏洞响应" tabindex="-1">漏洞响应 <a class="header-anchor" href="#漏洞响应" aria-label="Permalink to &quot;漏洞响应&quot;">​</a></h2><h3 id="发现漏洞后" tabindex="-1">发现漏洞后 <a class="header-anchor" href="#发现漏洞后" aria-label="Permalink to &quot;发现漏洞后&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>发现漏洞</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ▼</span></span>
<span class="line"><span>评估严重性</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ├── Critical ──► 立即修复 + 通知</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ├── High ──► 24h 内修复</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    └── Medium/Low ──► 排期修复</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ▼</span></span>
<span class="line"><span>修复并验证</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ▼</span></span>
<span class="line"><span>更新测试用例</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ▼</span></span>
<span class="line"><span>复盘总结</span></span></code></pre></div><h3 id="漏洞赏金" tabindex="-1">漏洞赏金 <a class="header-anchor" href="#漏洞赏金" aria-label="Permalink to &quot;漏洞赏金&quot;">​</a></h3><ul><li><strong>SHOULD</strong> 建立漏洞赏金计划</li><li><strong>MUST</strong> 提供安全问题报告渠道</li><li><strong>MUST</strong> 及时响应安全报告</li></ul><hr><h2 id="本章小结" tabindex="-1">本章小结 <a class="header-anchor" href="#本章小结" aria-label="Permalink to &quot;本章小结&quot;">​</a></h2><ul><li>多层次安全测试：静态分析、依赖扫描、动态测试、渗透测试</li><li>自动化集成到 CI，阻止带漏洞的代码合并</li><li>完整的安全功能测试用例覆盖</li><li>渗透测试场景模拟真实攻击</li><li>漏洞发现后快速响应机制</li></ul>`,74)])])}const u=n(l,[["render",p]]);export{b as __pageData,u as default};
