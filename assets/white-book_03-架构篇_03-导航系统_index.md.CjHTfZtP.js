import{_ as a,c as e,o as n,ag as s}from"./chunks/framework.B0we9iV-.js";const b=JSON.parse('{"title":"导航系统","description":"","frontmatter":{},"headers":[],"relativePath":"white-book/03-架构篇/03-导航系统/index.md","filePath":"white-book/03-架构篇/03-导航系统/index.md"}'),d={name:"white-book/03-架构篇/03-导航系统/index.md"};function r(i,t,l,h,o,p){return n(),e("div",null,[...t[0]||(t[0]=[s(`<h1 id="导航系统" tabindex="-1">导航系统 <a class="header-anchor" href="#导航系统" aria-label="Permalink to &quot;导航系统&quot;">​</a></h1><blockquote><p>定义栈式导航架构规范</p></blockquote><hr><h2 id="导航模式" tabindex="-1">导航模式 <a class="header-anchor" href="#导航模式" aria-label="Permalink to &quot;导航模式&quot;">​</a></h2><h3 id="栈式导航" tabindex="-1">栈式导航 <a class="header-anchor" href="#栈式导航" aria-label="Permalink to &quot;栈式导航&quot;">​</a></h3><p>BFM Pay 采用栈式导航模式，提供原生 App 般的用户体验。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>┌─────────────────────────────────────┐</span></span>
<span class="line"><span>│            Navigation Stack          │</span></span>
<span class="line"><span>├─────────────────────────────────────┤</span></span>
<span class="line"><span>│  [4] 交易详情页                       │ ← 栈顶（当前页面）</span></span>
<span class="line"><span>│  [3] 发送确认页                       │</span></span>
<span class="line"><span>│  [2] 发送页                          │</span></span>
<span class="line"><span>│  [1] 钱包详情页                       │</span></span>
<span class="line"><span>│  [0] 首页 (Tab)                      │ ← 栈底</span></span>
<span class="line"><span>└─────────────────────────────────────┘</span></span></code></pre></div><h3 id="导航类型" tabindex="-1">导航类型 <a class="header-anchor" href="#导航类型" aria-label="Permalink to &quot;导航类型&quot;">​</a></h3><table tabindex="0"><thead><tr><th>操作</th><th>说明</th><th>动画方向</th></tr></thead><tbody><tr><td>Push</td><td>压入新页面到栈顶</td><td>从右进入</td></tr><tr><td>Pop</td><td>弹出栈顶页面</td><td>向右退出</td></tr><tr><td>Replace</td><td>替换栈顶页面</td><td>淡入淡出</td></tr><tr><td>Reset</td><td>重置导航栈</td><td>无动画</td></tr></tbody></table><hr><h2 id="页面-screen-规范" tabindex="-1">页面（Screen）规范 <a class="header-anchor" href="#页面-screen-规范" aria-label="Permalink to &quot;页面（Screen）规范&quot;">​</a></h2><h3 id="screen-定义" tabindex="-1">Screen 定义 <a class="header-anchor" href="#screen-定义" aria-label="Permalink to &quot;Screen 定义&quot;">​</a></h3><p>每个 Screen MUST 包含：</p><table tabindex="0"><thead><tr><th>属性</th><th>类型</th><th>必填</th><th>说明</th></tr></thead><tbody><tr><td>name</td><td>string</td><td>是</td><td>唯一标识符</td></tr><tr><td>path</td><td>string</td><td>是</td><td>URL 路径模式</td></tr><tr><td>params</td><td>ParamSchema</td><td>否</td><td>参数定义</td></tr><tr><td>component</td><td>Component</td><td>是</td><td>渲染组件</td></tr><tr><td>options</td><td>ScreenOptions</td><td>否</td><td>页面配置</td></tr></tbody></table><h3 id="screen-参数" tabindex="-1">Screen 参数 <a class="header-anchor" href="#screen-参数" aria-label="Permalink to &quot;Screen 参数&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ParamSchema = {</span></span>
<span class="line"><span>  [paramName: string]: {</span></span>
<span class="line"><span>    type: &#39;string&#39; | &#39;number&#39; | &#39;boolean&#39;</span></span>
<span class="line"><span>    required: boolean</span></span>
<span class="line"><span>    default?: any</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre></div><h3 id="screen-配置" tabindex="-1">Screen 配置 <a class="header-anchor" href="#screen-配置" aria-label="Permalink to &quot;Screen 配置&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ScreenOptions = {</span></span>
<span class="line"><span>  title: string | null        // 页面标题</span></span>
<span class="line"><span>  headerVisible: boolean      // 是否显示头部</span></span>
<span class="line"><span>  gestureEnabled: boolean     // 是否启用手势返回</span></span>
<span class="line"><span>  animation: AnimationType    // 过渡动画类型</span></span>
<span class="line"><span>}</span></span></code></pre></div><hr><h2 id="screen-列表" tabindex="-1">Screen 列表 <a class="header-anchor" href="#screen-列表" aria-label="Permalink to &quot;Screen 列表&quot;">​</a></h2><h3 id="tab-页面" tabindex="-1">Tab 页面 <a class="header-anchor" href="#tab-页面" aria-label="Permalink to &quot;Tab 页面&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Screen</th><th>路径</th><th>说明</th></tr></thead><tbody><tr><td>MainTabs</td><td>/</td><td>Tab 容器页</td></tr><tr><td>HomeTab</td><td>/home</td><td>首页 Tab</td></tr><tr><td>HistoryTab</td><td>/history</td><td>历史 Tab</td></tr><tr><td>SettingsTab</td><td>/settings</td><td>设置 Tab</td></tr></tbody></table><h3 id="钱包相关" tabindex="-1">钱包相关 <a class="header-anchor" href="#钱包相关" aria-label="Permalink to &quot;钱包相关&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Screen</th><th>路径</th><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>WalletCreate</td><td>/wallet/create</td><td>-</td><td>创建钱包</td></tr><tr><td>WalletImport</td><td>/wallet/import</td><td>-</td><td>导入钱包</td></tr><tr><td>WalletDetail</td><td>/wallet/:id</td><td>id: string</td><td>钱包详情</td></tr><tr><td>WalletBackup</td><td>/wallet/:id/backup</td><td>id: string</td><td>备份钱包</td></tr></tbody></table><h3 id="交易相关" tabindex="-1">交易相关 <a class="header-anchor" href="#交易相关" aria-label="Permalink to &quot;交易相关&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Screen</th><th>路径</th><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>Send</td><td>/send</td><td>token?: string</td><td>发送页</td></tr><tr><td>SendConfirm</td><td>/send/confirm</td><td>tx: TxData</td><td>发送确认</td></tr><tr><td>Receive</td><td>/receive</td><td>-</td><td>收款页</td></tr><tr><td>TxDetail</td><td>/tx/:hash</td><td>hash: string</td><td>交易详情</td></tr></tbody></table><h3 id="设置相关" tabindex="-1">设置相关 <a class="header-anchor" href="#设置相关" aria-label="Permalink to &quot;设置相关&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Screen</th><th>路径</th><th>说明</th></tr></thead><tbody><tr><td>SettingsLanguage</td><td>/settings/language</td><td>语言设置</td></tr><tr><td>SettingsCurrency</td><td>/settings/currency</td><td>货币设置</td></tr><tr><td>SettingsChains</td><td>/settings/chains</td><td>链配置</td></tr><tr><td>SettingsWalletLock</td><td>/settings/wallet-lock</td><td>修改钱包锁</td></tr><tr><td>SettingsMnemonic</td><td>/settings/mnemonic</td><td>查看助记词</td></tr></tbody></table><h3 id="dweb-授权" tabindex="-1">DWEB 授权 <a class="header-anchor" href="#dweb-授权" aria-label="Permalink to &quot;DWEB 授权&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Screen</th><th>路径</th><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>AuthorizeAddress</td><td>/authorize/address/:eventId</td><td>eventId: string</td><td>地址授权</td></tr><tr><td>AuthorizeSignature</td><td>/authorize/signature/:eventId</td><td>eventId: string</td><td>签名授权</td></tr></tbody></table><hr><h2 id="导航接口规范" tabindex="-1">导航接口规范 <a class="header-anchor" href="#导航接口规范" aria-label="Permalink to &quot;导航接口规范&quot;">​</a></h2><h3 id="inavigator" tabindex="-1">INavigator <a class="header-anchor" href="#inavigator" aria-label="Permalink to &quot;INavigator&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>INavigator {</span></span>
<span class="line"><span>  // 导航操作</span></span>
<span class="line"><span>  push(screen: string, params?: object): void</span></span>
<span class="line"><span>  pop(): void</span></span>
<span class="line"><span>  replace(screen: string, params?: object): void</span></span>
<span class="line"><span>  reset(screens: ScreenConfig[]): void</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>  // 状态查询</span></span>
<span class="line"><span>  canGoBack(): boolean</span></span>
<span class="line"><span>  getCurrentScreen(): ScreenInfo</span></span>
<span class="line"><span>  getNavigationState(): NavigationState</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>  // 事件监听</span></span>
<span class="line"><span>  addListener(event: NavigationEvent, callback: Function): Unsubscribe</span></span>
<span class="line"><span>}</span></span></code></pre></div><h3 id="navigationevent" tabindex="-1">NavigationEvent <a class="header-anchor" href="#navigationevent" aria-label="Permalink to &quot;NavigationEvent&quot;">​</a></h3><table tabindex="0"><thead><tr><th>事件</th><th>触发时机</th></tr></thead><tbody><tr><td>beforeNavigate</td><td>导航开始前</td></tr><tr><td>afterNavigate</td><td>导航完成后</td></tr><tr><td>focus</td><td>页面获得焦点</td></tr><tr><td>blur</td><td>页面失去焦点</td></tr></tbody></table><hr><h2 id="tab-导航规范" tabindex="-1">Tab 导航规范 <a class="header-anchor" href="#tab-导航规范" aria-label="Permalink to &quot;Tab 导航规范&quot;">​</a></h2><h3 id="tab-配置" tabindex="-1">Tab 配置 <a class="header-anchor" href="#tab-配置" aria-label="Permalink to &quot;Tab 配置&quot;">​</a></h3><table tabindex="0"><thead><tr><th>属性</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>key</td><td>string</td><td>Tab 唯一标识</td></tr><tr><td>label</td><td>string</td><td>Tab 显示文本</td></tr><tr><td>icon</td><td>Icon</td><td>Tab 图标</td></tr><tr><td>screen</td><td>string</td><td>对应 Screen</td></tr><tr><td>badge</td><td>number</td><td>角标数字</td></tr></tbody></table><h3 id="tab-列表" tabindex="-1">Tab 列表 <a class="header-anchor" href="#tab-列表" aria-label="Permalink to &quot;Tab 列表&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Tab</th><th>图标</th><th>Screen</th><th>说明</th></tr></thead><tbody><tr><td>home</td><td>Wallet</td><td>HomeTab</td><td>首页/钱包</td></tr><tr><td>history</td><td>History</td><td>HistoryTab</td><td>交易历史</td></tr><tr><td>settings</td><td>Settings</td><td>SettingsTab</td><td>设置</td></tr></tbody></table><h3 id="tab-行为规范" tabindex="-1">Tab 行为规范 <a class="header-anchor" href="#tab-行为规范" aria-label="Permalink to &quot;Tab 行为规范&quot;">​</a></h3><ul><li><strong>MUST</strong> 点击当前 Tab 滚动到顶部</li><li><strong>MUST</strong> 记住每个 Tab 的滚动位置</li><li><strong>SHOULD</strong> 支持 Tab 切换动画</li><li><strong>MAY</strong> 支持 Tab 长按快捷操作</li></ul><hr><h2 id="url-同步规范" tabindex="-1">URL 同步规范 <a class="header-anchor" href="#url-同步规范" aria-label="Permalink to &quot;URL 同步规范&quot;">​</a></h2><h3 id="路由模式" tabindex="-1">路由模式 <a class="header-anchor" href="#路由模式" aria-label="Permalink to &quot;路由模式&quot;">​</a></h3><ul><li><strong>MUST</strong> 支持 Hash 路由模式（兼容静态部署）</li><li><strong>SHOULD</strong> 支持 History 路由模式（可选）</li></ul><h3 id="url-格式" tabindex="-1">URL 格式 <a class="header-anchor" href="#url-格式" aria-label="Permalink to &quot;URL 格式&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Hash 模式：https://example.com/#/wallet/abc123</span></span>
<span class="line"><span>History 模式：https://example.com/wallet/abc123</span></span></code></pre></div><h3 id="参数编码" tabindex="-1">参数编码 <a class="header-anchor" href="#参数编码" aria-label="Permalink to &quot;参数编码&quot;">​</a></h3><ul><li><strong>MUST</strong> 路径参数使用 URL 安全字符</li><li><strong>MUST</strong> 复杂参数使用 URL Search 编码</li><li><strong>SHOULD</strong> 敏感参数加密后传递</li></ul><hr><h2 id="过渡动画规范" tabindex="-1">过渡动画规范 <a class="header-anchor" href="#过渡动画规范" aria-label="Permalink to &quot;过渡动画规范&quot;">​</a></h2><h3 id="动画类型" tabindex="-1">动画类型 <a class="header-anchor" href="#动画类型" aria-label="Permalink to &quot;动画类型&quot;">​</a></h3><table tabindex="0"><thead><tr><th>类型</th><th>说明</th><th>使用场景</th></tr></thead><tbody><tr><td>slideRight</td><td>从右滑入</td><td>进入新页面</td></tr><tr><td>slideLeft</td><td>从左滑入</td><td>返回上一页</td></tr><tr><td>slideUp</td><td>从下滑入</td><td>弹出层/Sheet</td></tr><tr><td>fade</td><td>淡入淡出</td><td>替换页面</td></tr><tr><td>none</td><td>无动画</td><td>快速切换</td></tr></tbody></table><h3 id="动画参数" tabindex="-1">动画参数 <a class="header-anchor" href="#动画参数" aria-label="Permalink to &quot;动画参数&quot;">​</a></h3><table tabindex="0"><thead><tr><th>参数</th><th>建议值</th><th>说明</th></tr></thead><tbody><tr><td>duration</td><td>250-300ms</td><td>动画时长</td></tr><tr><td>easing</td><td>ease-out</td><td>缓动函数</td></tr><tr><td>delay</td><td>0ms</td><td>延迟时间</td></tr></tbody></table><hr><h2 id="手势导航规范" tabindex="-1">手势导航规范 <a class="header-anchor" href="#手势导航规范" aria-label="Permalink to &quot;手势导航规范&quot;">​</a></h2><h3 id="手势返回" tabindex="-1">手势返回 <a class="header-anchor" href="#手势返回" aria-label="Permalink to &quot;手势返回&quot;">​</a></h3><ul><li><strong>MUST</strong> 支持从屏幕左边缘向右滑动返回</li><li><strong>MUST</strong> 滑动距离 &gt; 屏幕 1/3 时触发返回</li><li><strong>SHOULD</strong> 显示返回预览效果</li><li><strong>MAY</strong> 支持自定义触发阈值</li></ul><h3 id="禁用场景" tabindex="-1">禁用场景 <a class="header-anchor" href="#禁用场景" aria-label="Permalink to &quot;禁用场景&quot;">​</a></h3><p>以下页面 SHOULD 禁用手势返回：</p><ul><li>支付确认页（防止误操作）</li><li>图案锁页面（防止泄露）</li><li>重要表单页（防止数据丢失）</li></ul><hr><h2 id="深度链接规范" tabindex="-1">深度链接规范 <a class="header-anchor" href="#深度链接规范" aria-label="Permalink to &quot;深度链接规范&quot;">​</a></h2><h3 id="支持的-scheme" tabindex="-1">支持的 Scheme <a class="header-anchor" href="#支持的-scheme" aria-label="Permalink to &quot;支持的 Scheme&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Scheme</th><th>说明</th></tr></thead><tbody><tr><td>bfmpay://</td><td>应用内链接</td></tr><tr><td><a href="https://pay.bfm.network" target="_blank" rel="noreferrer">https://pay.bfm.network</a></td><td>Web 链接</td></tr></tbody></table><h3 id="链接格式" tabindex="-1">链接格式 <a class="header-anchor" href="#链接格式" aria-label="Permalink to &quot;链接格式&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>bfmpay://send?to=ADDRESS&amp;amount=100</span></span>
<span class="line"><span>bfmpay://wallet/WALLET_ID</span></span>
<span class="line"><span>bfmpay://authorize/address/EVENT_ID</span></span></code></pre></div><h3 id="处理流程" tabindex="-1">处理流程 <a class="header-anchor" href="#处理流程" aria-label="Permalink to &quot;处理流程&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>接收深度链接</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ▼</span></span>
<span class="line"><span>解析 scheme 和 path</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ▼</span></span>
<span class="line"><span>验证参数合法性</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    ├── 无效 ──► 显示错误</span></span>
<span class="line"><span>    │</span></span>
<span class="line"><span>    └── 有效 ──► 导航到对应页面</span></span></code></pre></div><hr><h2 id="本章小结" tabindex="-1">本章小结 <a class="header-anchor" href="#本章小结" aria-label="Permalink to &quot;本章小结&quot;">​</a></h2><ul><li>栈式导航提供原生 App 体验</li><li>Screen 统一定义页面和参数</li><li>Tab 导航管理主要功能入口</li><li>URL 同步支持页面分享和书签</li><li>手势导航增强操作体验</li><li>深度链接支持外部唤起</li></ul>`,76)])])}const u=a(d,[["render",r]]);export{b as __pageData,u as default};
