import{_ as a,c as e,o as r,ag as d}from"./chunks/framework.B0we9iV-.js";const p=JSON.parse('{"title":"链服务","description":"","frontmatter":{},"headers":[],"relativePath":"white-book/04-服务篇/02-链服务/index.md","filePath":"white-book/04-服务篇/02-链服务/index.md"}'),n={name:"white-book/04-服务篇/02-链服务/index.md"};function s(i,t,o,l,h,c){return r(),e("div",null,[...t[0]||(t[0]=[d(`<h1 id="链服务" tabindex="-1">链服务 <a class="header-anchor" href="#链服务" aria-label="Permalink to &quot;链服务&quot;">​</a></h1><blockquote><p>定义与区块链交互的标准接口规范</p></blockquote><hr><h2 id="概述" tabindex="-1">概述 <a class="header-anchor" href="#概述" aria-label="Permalink to &quot;概述&quot;">​</a></h2><p>链服务层提供与区块链网络交互的统一抽象接口，屏蔽不同链的协议差异。</p><hr><h2 id="服务列表" tabindex="-1">服务列表 <a class="header-anchor" href="#服务列表" aria-label="Permalink to &quot;服务列表&quot;">​</a></h2><table tabindex="0"><thead><tr><th>服务</th><th>说明</th><th>必需性</th></tr></thead><tbody><tr><td><a href="./IIdentityService.html">IIdentityService</a></td><td>地址派生、消息签名</td><td>MUST</td></tr><tr><td><a href="./IAssetService.html">IAssetService</a></td><td>资产余额查询</td><td>MUST</td></tr><tr><td><a href="./ITransactionService.html">ITransactionService</a></td><td>交易构建、签名、广播</td><td>MUST</td></tr><tr><td><a href="./IChainService.html">IChainService</a></td><td>链信息查询</td><td>MUST</td></tr><tr><td><a href="./IStakingService.html">IStakingService</a></td><td>质押操作</td><td>MAY</td></tr><tr><td>INFTService</td><td>NFT 资产查询</td><td>MAY</td></tr></tbody></table><h2 id="实现规范" tabindex="-1">实现规范 <a class="header-anchor" href="#实现规范" aria-label="Permalink to &quot;实现规范&quot;">​</a></h2><table tabindex="0"><thead><tr><th>文档</th><th>说明</th></tr></thead><tbody><tr><td><a href="./实现规范/">实现规范</a></td><td>各链适配器的具体实现要求（BioForest/EVM/Tron/Bitcoin）</td></tr></tbody></table><hr><h2 id="接口设计原则" tabindex="-1">接口设计原则 <a class="header-anchor" href="#接口设计原则" aria-label="Permalink to &quot;接口设计原则&quot;">​</a></h2><ol><li><strong>异步优先</strong>：所有涉及网络/计算的方法 <strong>MUST</strong> 返回 Promise</li><li><strong>错误明确</strong>：失败时 <strong>MUST</strong> 抛出带有错误码的异常</li><li><strong>可取消</strong>：长时间操作 <strong>SHOULD</strong> 支持 AbortSignal</li><li><strong>类型安全</strong>：参数和返回值 <strong>MUST</strong> 有明确类型定义</li></ol><hr><h2 id="事件订阅规范" tabindex="-1">事件订阅规范 <a class="header-anchor" href="#事件订阅规范" aria-label="Permalink to &quot;事件订阅规范&quot;">​</a></h2><p>所有 <code>subscribe*</code> 方法 <strong>MUST</strong> 遵循：</p><ol><li>返回 <code>Unsubscribe</code> 函数用于取消订阅</li><li>立即调用一次 callback 返回当前状态</li><li>状态变化时调用 callback</li><li>网络错误时通过 callback 第二个参数传递错误</li></ol><h3 id="重连策略" tabindex="-1">重连策略 <a class="header-anchor" href="#重连策略" aria-label="Permalink to &quot;重连策略&quot;">​</a></h3><table tabindex="0"><thead><tr><th>场景</th><th>策略</th></tr></thead><tbody><tr><td>网络断开</td><td>指数退避重连（1s, 2s, 4s, 8s, max 30s）</td></tr><tr><td>服务端错误</td><td>延迟 5s 后重试</td></tr><tr><td>认证失败</td><td>不重试，通知上层</td></tr></tbody></table><hr><h2 id="错误处理规范" tabindex="-1">错误处理规范 <a class="header-anchor" href="#错误处理规范" aria-label="Permalink to &quot;错误处理规范&quot;">​</a></h2><h3 id="错误结构" tabindex="-1">错误结构 <a class="header-anchor" href="#错误结构" aria-label="Permalink to &quot;错误结构&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ChainServiceError {</span></span>
<span class="line"><span>  code: string              // 机器可读错误码</span></span>
<span class="line"><span>  message: string           // 人类可读错误信息</span></span>
<span class="line"><span>  details?: object          // 额外错误详情</span></span>
<span class="line"><span>  cause?: Error             // 原始错误</span></span>
<span class="line"><span>}</span></span></code></pre></div><h3 id="错误分类" tabindex="-1">错误分类 <a class="header-anchor" href="#错误分类" aria-label="Permalink to &quot;错误分类&quot;">​</a></h3><table tabindex="0"><thead><tr><th>类别</th><th>前缀</th><th>处理策略</th></tr></thead><tbody><tr><td>网络错误</td><td>NETWORK_</td><td>可重试</td></tr><tr><td>验证错误</td><td>VALIDATION_</td><td>不可重试，需用户修改输入</td></tr><tr><td>业务错误</td><td>BUSINESS_</td><td>根据具体情况</td></tr><tr><td>系统错误</td><td>SYSTEM_</td><td>记录日志，提示用户联系支持</td></tr></tbody></table>`,25)])])}const u=a(n,[["render",s]]);export{p as __pageData,u as default};
