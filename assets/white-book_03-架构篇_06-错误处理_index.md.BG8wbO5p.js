import{_ as a,c as n,o as s,ag as d}from"./chunks/framework.B0we9iV-.js";const b=JSON.parse('{"title":"错误处理篇","description":"","frontmatter":{},"headers":[],"relativePath":"white-book/03-架构篇/06-错误处理/index.md","filePath":"white-book/03-架构篇/06-错误处理/index.md"}'),e={name:"white-book/03-架构篇/06-错误处理/index.md"};function r(l,t,p,i,o,h){return s(),n("div",null,[...t[0]||(t[0]=[d(`<h1 id="错误处理篇" tabindex="-1">错误处理篇 <a class="header-anchor" href="#错误处理篇" aria-label="Permalink to &quot;错误处理篇&quot;">​</a></h1><blockquote><p>定义统一的错误处理架构和用户体验规范</p></blockquote><hr><h2 id="错误分类体系" tabindex="-1">错误分类体系 <a class="header-anchor" href="#错误分类体系" aria-label="Permalink to &quot;错误分类体系&quot;">​</a></h2><h3 id="一级分类" tabindex="-1">一级分类 <a class="header-anchor" href="#一级分类" aria-label="Permalink to &quot;一级分类&quot;">​</a></h3><table tabindex="0"><thead><tr><th>类别</th><th>前缀</th><th>说明</th><th>用户可恢复</th></tr></thead><tbody><tr><td>网络错误</td><td>NET_</td><td>网络连接问题</td><td>是（重试）</td></tr><tr><td>链错误</td><td>CHAIN_</td><td>区块链交互问题</td><td>部分</td></tr><tr><td>验证错误</td><td>VALID_</td><td>输入验证失败</td><td>是（修正输入）</td></tr><tr><td>认证错误</td><td>AUTH_</td><td>身份认证问题</td><td>是（重新认证）</td></tr><tr><td>存储错误</td><td>STORE_</td><td>本地存储问题</td><td>部分</td></tr><tr><td>系统错误</td><td>SYS_</td><td>系统级异常</td><td>否</td></tr></tbody></table><hr><h2 id="错误码目录" tabindex="-1">错误码目录 <a class="header-anchor" href="#错误码目录" aria-label="Permalink to &quot;错误码目录&quot;">​</a></h2><h3 id="net-网络错误" tabindex="-1">NET_ 网络错误 <a class="header-anchor" href="#net-网络错误" aria-label="Permalink to &quot;NET_ 网络错误&quot;">​</a></h3><table tabindex="0"><thead><tr><th>错误码</th><th>名称</th><th>用户消息</th><th>恢复方式</th></tr></thead><tbody><tr><td>NET_001</td><td>NetworkOffline</td><td>网络已断开</td><td>检查网络后重试</td></tr><tr><td>NET_002</td><td>RequestTimeout</td><td>请求超时</td><td>自动重试</td></tr><tr><td>NET_003</td><td>ServerUnavailable</td><td>服务暂时不可用</td><td>稍后重试</td></tr><tr><td>NET_004</td><td>RateLimited</td><td>请求过于频繁</td><td>等待后重试</td></tr><tr><td>NET_005</td><td>InvalidResponse</td><td>服务器响应异常</td><td>重试或联系支持</td></tr></tbody></table><h3 id="chain-链错误" tabindex="-1">CHAIN_ 链错误 <a class="header-anchor" href="#chain-链错误" aria-label="Permalink to &quot;CHAIN_ 链错误&quot;">​</a></h3><table tabindex="0"><thead><tr><th>错误码</th><th>名称</th><th>用户消息</th><th>恢复方式</th></tr></thead><tbody><tr><td>CHAIN_001</td><td>InsufficientBalance</td><td>余额不足</td><td>充值后重试</td></tr><tr><td>CHAIN_002</td><td>InsufficientGas</td><td>Gas 费不足</td><td>增加 Gas 或充值</td></tr><tr><td>CHAIN_003</td><td>NonceConflict</td><td>交易序号冲突</td><td>重新获取 nonce</td></tr><tr><td>CHAIN_004</td><td>TransactionRejected</td><td>交易被拒绝</td><td>检查交易参数</td></tr><tr><td>CHAIN_005</td><td>ContractError</td><td>合约执行失败</td><td>检查合约调用</td></tr><tr><td>CHAIN_006</td><td>ChainNotSupported</td><td>不支持此链</td><td>切换到支持的链</td></tr><tr><td>CHAIN_007</td><td>NodeUnavailable</td><td>节点不可用</td><td>自动切换备用节点</td></tr><tr><td>CHAIN_008</td><td>TransactionDropped</td><td>交易已被丢弃</td><td>重新发起交易</td></tr><tr><td>CHAIN_009</td><td>GasPriceTooLow</td><td>Gas 价格过低</td><td>提高 Gas 价格</td></tr><tr><td>CHAIN_010</td><td>InvalidAddress</td><td>地址格式无效</td><td>检查收款地址</td></tr></tbody></table><h3 id="valid-验证错误" tabindex="-1">VALID_ 验证错误 <a class="header-anchor" href="#valid-验证错误" aria-label="Permalink to &quot;VALID_ 验证错误&quot;">​</a></h3><table tabindex="0"><thead><tr><th>错误码</th><th>名称</th><th>用户消息</th><th>恢复方式</th></tr></thead><tbody><tr><td>VALID_001</td><td>RequiredField</td><td>请填写此字段</td><td>填写必填项</td></tr><tr><td>VALID_002</td><td>InvalidFormat</td><td>格式不正确</td><td>按提示修正</td></tr><tr><td>VALID_003</td><td>AmountTooSmall</td><td>金额过小</td><td>增加金额</td></tr><tr><td>VALID_004</td><td>AmountTooLarge</td><td>金额超出限制</td><td>减少金额</td></tr><tr><td>VALID_005</td><td>InvalidMnemonic</td><td>助记词无效</td><td>检查助记词</td></tr><tr><td>VALID_006</td><td>PatternMismatch</td><td>两次图案不一致</td><td>重新绘制</td></tr><tr><td>VALID_007</td><td>PatternTooSimple</td><td>图案连接点不足</td><td>连接更多点</td></tr><tr><td>VALID_008</td><td>InvalidQRCode</td><td>无法识别二维码</td><td>重新扫描</td></tr></tbody></table><h3 id="auth-认证错误" tabindex="-1">AUTH_ 认证错误 <a class="header-anchor" href="#auth-认证错误" aria-label="Permalink to &quot;AUTH_ 认证错误&quot;">​</a></h3><table tabindex="0"><thead><tr><th>错误码</th><th>名称</th><th>用户消息</th><th>恢复方式</th></tr></thead><tbody><tr><td>AUTH_001</td><td>WrongPattern</td><td>图案错误</td><td>重新绘制</td></tr><tr><td>AUTH_002</td><td>BiometricFailed</td><td>生物识别失败</td><td>使用图案锁</td></tr><tr><td>AUTH_003</td><td>BiometricNotAvailable</td><td>生物识别不可用</td><td>使用图案锁</td></tr><tr><td>AUTH_004</td><td>TooManyAttempts</td><td>尝试次数过多</td><td>等待解锁</td></tr><tr><td>AUTH_005</td><td>SessionExpired</td><td>会话已过期</td><td>重新认证</td></tr><tr><td>AUTH_006</td><td>AuthorizationDenied</td><td>授权被拒绝</td><td>重新请求授权</td></tr></tbody></table><h3 id="store-存储错误" tabindex="-1">STORE_ 存储错误 <a class="header-anchor" href="#store-存储错误" aria-label="Permalink to &quot;STORE_ 存储错误&quot;">​</a></h3><table tabindex="0"><thead><tr><th>错误码</th><th>名称</th><th>用户消息</th><th>恢复方式</th></tr></thead><tbody><tr><td>STORE_001</td><td>StorageFull</td><td>存储空间不足</td><td>清理空间</td></tr><tr><td>STORE_002</td><td>DataCorrupted</td><td>数据已损坏</td><td>重新导入钱包</td></tr><tr><td>STORE_003</td><td>DecryptionFailed</td><td>解密失败</td><td>检查图案</td></tr><tr><td>STORE_004</td><td>WalletNotFound</td><td>钱包不存在</td><td>创建或导入</td></tr><tr><td>STORE_005</td><td>MigrationFailed</td><td>数据迁移失败</td><td>联系支持</td></tr></tbody></table><h3 id="sys-系统错误" tabindex="-1">SYS_ 系统错误 <a class="header-anchor" href="#sys-系统错误" aria-label="Permalink to &quot;SYS_ 系统错误&quot;">​</a></h3><table tabindex="0"><thead><tr><th>错误码</th><th>名称</th><th>用户消息</th><th>恢复方式</th></tr></thead><tbody><tr><td>SYS_001</td><td>UnknownError</td><td>发生未知错误</td><td>重试或联系支持</td></tr><tr><td>SYS_002</td><td>CryptoNotSupported</td><td>加密功能不可用</td><td>升级浏览器</td></tr><tr><td>SYS_003</td><td>OutOfMemory</td><td>内存不足</td><td>关闭其他应用</td></tr><tr><td>SYS_004</td><td>FeatureNotSupported</td><td>功能暂不支持</td><td>等待更新</td></tr></tbody></table><hr><h2 id="错误数据结构" tabindex="-1">错误数据结构 <a class="header-anchor" href="#错误数据结构" aria-label="Permalink to &quot;错误数据结构&quot;">​</a></h2><h3 id="apperror-基础结构" tabindex="-1">AppError 基础结构 <a class="header-anchor" href="#apperror-基础结构" aria-label="Permalink to &quot;AppError 基础结构&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>AppError {</span></span>
<span class="line"><span>  code: string           // 错误码 (如 &quot;CHAIN_001&quot;)</span></span>
<span class="line"><span>  name: string           // 错误名称</span></span>
<span class="line"><span>  message: string        // 开发者消息（英文）</span></span>
<span class="line"><span>  userMessage: string    // 用户消息（多语言 key）</span></span>
<span class="line"><span>  severity: Severity     // 严重程度</span></span>
<span class="line"><span>  recoverable: boolean   // 是否可恢复</span></span>
<span class="line"><span>  retryable: boolean     // 是否可重试</span></span>
<span class="line"><span>  context?: object       // 上下文信息</span></span>
<span class="line"><span>  cause?: Error          // 原始错误</span></span>
<span class="line"><span>  timestamp: number      // 发生时间</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Severity = &#39;info&#39; | &#39;warning&#39; | &#39;error&#39; | &#39;critical&#39;</span></span></code></pre></div><h3 id="错误上下文" tabindex="-1">错误上下文 <a class="header-anchor" href="#错误上下文" aria-label="Permalink to &quot;错误上下文&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ErrorContext {</span></span>
<span class="line"><span>  // 操作上下文</span></span>
<span class="line"><span>  operation: string      // 操作名称</span></span>
<span class="line"><span>  chainId?: string       // 链 ID</span></span>
<span class="line"><span>  address?: string       // 相关地址</span></span>
<span class="line"><span>  txHash?: string        // 交易哈希</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>  // 请求上下文</span></span>
<span class="line"><span>  requestId?: string     // 请求 ID</span></span>
<span class="line"><span>  endpoint?: string      // API 端点</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>  // 设备上下文</span></span>
<span class="line"><span>  platform: string       // 平台</span></span>
<span class="line"><span>  version: string        // 应用版本</span></span>
<span class="line"><span>}</span></span></code></pre></div><hr><h2 id="错误处理层级" tabindex="-1">错误处理层级 <a class="header-anchor" href="#错误处理层级" aria-label="Permalink to &quot;错误处理层级&quot;">​</a></h2><h3 id="处理架构" tabindex="-1">处理架构 <a class="header-anchor" href="#处理架构" aria-label="Permalink to &quot;处理架构&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>┌─────────────────────────────────────────────────────────┐</span></span>
<span class="line"><span>│                    UI Layer                              │</span></span>
<span class="line"><span>│            显示用户友好的错误消息                          │</span></span>
<span class="line"><span>├─────────────────────────────────────────────────────────┤</span></span>
<span class="line"><span>│                Application Layer                         │</span></span>
<span class="line"><span>│          决定重试/降级/上报策略                            │</span></span>
<span class="line"><span>├─────────────────────────────────────────────────────────┤</span></span>
<span class="line"><span>│                  Service Layer                           │</span></span>
<span class="line"><span>│            转换为 AppError，添加上下文                     │</span></span>
<span class="line"><span>├─────────────────────────────────────────────────────────┤</span></span>
<span class="line"><span>│                 Provider Layer                           │</span></span>
<span class="line"><span>│              捕获原始错误                                 │</span></span>
<span class="line"><span>└─────────────────────────────────────────────────────────┘</span></span></code></pre></div><h3 id="各层职责" tabindex="-1">各层职责 <a class="header-anchor" href="#各层职责" aria-label="Permalink to &quot;各层职责&quot;">​</a></h3><table tabindex="0"><thead><tr><th>层级</th><th>职责</th><th>输出</th></tr></thead><tbody><tr><td>Provider</td><td>捕获原始异常</td><td>原始 Error</td></tr><tr><td>Service</td><td>转换、分类、添加上下文</td><td>AppError</td></tr><tr><td>Application</td><td>决定处理策略</td><td>处理决策</td></tr><tr><td>UI</td><td>展示给用户</td><td>用户界面</td></tr></tbody></table><hr><h2 id="错误恢复策略" tabindex="-1">错误恢复策略 <a class="header-anchor" href="#错误恢复策略" aria-label="Permalink to &quot;错误恢复策略&quot;">​</a></h2><h3 id="自动重试" tabindex="-1">自动重试 <a class="header-anchor" href="#自动重试" aria-label="Permalink to &quot;自动重试&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>RetryConfig {</span></span>
<span class="line"><span>  maxAttempts: number    // 最大重试次数</span></span>
<span class="line"><span>  baseDelay: number      // 基础延迟 (ms)</span></span>
<span class="line"><span>  maxDelay: number       // 最大延迟 (ms)</span></span>
<span class="line"><span>  backoffFactor: number  // 退避系数</span></span>
<span class="line"><span>  retryableErrors: string[]  // 可重试的错误码</span></span>
<span class="line"><span>}</span></span></code></pre></div><p><strong>默认配置：</strong></p><table tabindex="0"><thead><tr><th>参数</th><th>值</th></tr></thead><tbody><tr><td>maxAttempts</td><td>3</td></tr><tr><td>baseDelay</td><td>1000ms</td></tr><tr><td>maxDelay</td><td>30000ms</td></tr><tr><td>backoffFactor</td><td>2</td></tr></tbody></table><p><strong>可重试错误码：</strong></p><ul><li>NET_002 (RequestTimeout)</li><li>NET_003 (ServerUnavailable)</li><li>CHAIN_007 (NodeUnavailable)</li></ul><h3 id="降级策略" tabindex="-1">降级策略 <a class="header-anchor" href="#降级策略" aria-label="Permalink to &quot;降级策略&quot;">​</a></h3><table tabindex="0"><thead><tr><th>错误</th><th>降级方案</th></tr></thead><tbody><tr><td>主节点不可用</td><td>切换备用节点</td></tr><tr><td>实时数据不可用</td><td>显示缓存数据</td></tr><tr><td>生物识别失败</td><td>回退图案锁认证</td></tr><tr><td>WebSocket 断开</td><td>降级轮询</td></tr></tbody></table><h3 id="用户干预" tabindex="-1">用户干预 <a class="header-anchor" href="#用户干预" aria-label="Permalink to &quot;用户干预&quot;">​</a></h3><p>需要用户干预的情况：</p><table tabindex="0"><thead><tr><th>情况</th><th>用户操作</th></tr></thead><tbody><tr><td>余额不足</td><td>充值</td></tr><tr><td>图案错误</td><td>重新绘制</td></tr><tr><td>授权被拒</td><td>重新授权</td></tr><tr><td>数据损坏</td><td>重新导入钱包</td></tr></tbody></table><hr><h2 id="错误-ui-规范" tabindex="-1">错误 UI 规范 <a class="header-anchor" href="#错误-ui-规范" aria-label="Permalink to &quot;错误 UI 规范&quot;">​</a></h2><h3 id="toast-提示-轻量级" tabindex="-1">Toast 提示（轻量级） <a class="header-anchor" href="#toast-提示-轻量级" aria-label="Permalink to &quot;Toast 提示（轻量级）&quot;">​</a></h3><p>适用：可自动恢复的临时错误</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>┌─────────────────────────────────────┐</span></span>
<span class="line"><span>│ ⚠️ 网络连接不稳定，正在重试...        │</span></span>
<span class="line"><span>└─────────────────────────────────────┘</span></span></code></pre></div><p><strong>规范：</strong></p><ul><li>自动消失（3-5 秒）</li><li>不阻塞用户操作</li><li>简短消息</li></ul><h3 id="内联错误-表单级" tabindex="-1">内联错误（表单级） <a class="header-anchor" href="#内联错误-表单级" aria-label="Permalink to &quot;内联错误（表单级）&quot;">​</a></h3><p>适用：验证错误</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>┌─────────────────────────────────────┐</span></span>
<span class="line"><span>│ 收款地址                             │</span></span>
<span class="line"><span>│ ┌─────────────────────────────────┐ │</span></span>
<span class="line"><span>│ │ 0xinvalid...                    │ │</span></span>
<span class="line"><span>│ └─────────────────────────────────┘ │</span></span>
<span class="line"><span>│ ❌ 地址格式无效                      │</span></span>
<span class="line"><span>└─────────────────────────────────────┘</span></span></code></pre></div><p><strong>规范：</strong></p><ul><li>紧邻出错字段</li><li>红色文字 + 图标</li><li>具体说明错误原因</li></ul><h3 id="对话框-阻塞级" tabindex="-1">对话框（阻塞级） <a class="header-anchor" href="#对话框-阻塞级" aria-label="Permalink to &quot;对话框（阻塞级）&quot;">​</a></h3><p>适用：需要用户决策的错误</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>┌─────────────────────────────────────┐</span></span>
<span class="line"><span>│              交易失败                │</span></span>
<span class="line"><span>├─────────────────────────────────────┤</span></span>
<span class="line"><span>│                                     │</span></span>
<span class="line"><span>│  Gas 价格过低，交易未被确认。         │</span></span>
<span class="line"><span>│                                     │</span></span>
<span class="line"><span>│  建议操作：                          │</span></span>
<span class="line"><span>│  • 提高 Gas 价格重新发送             │</span></span>
<span class="line"><span>│  • 取消此交易                        │</span></span>
<span class="line"><span>│                                     │</span></span>
<span class="line"><span>├─────────────────────────────────────┤</span></span>
<span class="line"><span>│  [取消]              [重新发送]      │</span></span>
<span class="line"><span>└─────────────────────────────────────┘</span></span></code></pre></div><p><strong>规范：</strong></p><ul><li>清晰的错误说明</li><li>提供解决方案</li><li>明确的操作按钮</li></ul><h3 id="全屏错误页-严重级" tabindex="-1">全屏错误页（严重级） <a class="header-anchor" href="#全屏错误页-严重级" aria-label="Permalink to &quot;全屏错误页（严重级）&quot;">​</a></h3><p>适用：系统级错误、无法恢复的错误</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>┌─────────────────────────────────────┐</span></span>
<span class="line"><span>│                                     │</span></span>
<span class="line"><span>│              😵                     │</span></span>
<span class="line"><span>│                                     │</span></span>
<span class="line"><span>│        出了点问题                    │</span></span>
<span class="line"><span>│                                     │</span></span>
<span class="line"><span>│   应用遇到了意外错误。               │</span></span>
<span class="line"><span>│   我们已记录此问题。                 │</span></span>
<span class="line"><span>│                                     │</span></span>
<span class="line"><span>│   错误代码: SYS_001                 │</span></span>
<span class="line"><span>│                                     │</span></span>
<span class="line"><span>│        [重新启动]                   │</span></span>
<span class="line"><span>│        [联系支持]                   │</span></span>
<span class="line"><span>│                                     │</span></span>
<span class="line"><span>└─────────────────────────────────────┘</span></span></code></pre></div><hr><h2 id="错误日志规范" tabindex="-1">错误日志规范 <a class="header-anchor" href="#错误日志规范" aria-label="Permalink to &quot;错误日志规范&quot;">​</a></h2><h3 id="日志级别" tabindex="-1">日志级别 <a class="header-anchor" href="#日志级别" aria-label="Permalink to &quot;日志级别&quot;">​</a></h3><table tabindex="0"><thead><tr><th>级别</th><th>用途</th><th>上报</th></tr></thead><tbody><tr><td>DEBUG</td><td>调试信息</td><td>否</td></tr><tr><td>INFO</td><td>一般信息</td><td>否</td></tr><tr><td>WARN</td><td>警告，已处理</td><td>可选</td></tr><tr><td>ERROR</td><td>错误，需关注</td><td>是</td></tr><tr><td>FATAL</td><td>严重错误</td><td>立即上报</td></tr></tbody></table><h3 id="日志结构" tabindex="-1">日志结构 <a class="header-anchor" href="#日志结构" aria-label="Permalink to &quot;日志结构&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ErrorLog {</span></span>
<span class="line"><span>  level: LogLevel</span></span>
<span class="line"><span>  error: AppError</span></span>
<span class="line"><span>  context: ErrorContext</span></span>
<span class="line"><span>  stack?: string</span></span>
<span class="line"><span>  userAgent: string</span></span>
<span class="line"><span>  timestamp: number</span></span>
<span class="line"><span>}</span></span></code></pre></div><h3 id="敏感信息过滤" tabindex="-1">敏感信息过滤 <a class="header-anchor" href="#敏感信息过滤" aria-label="Permalink to &quot;敏感信息过滤&quot;">​</a></h3><p><strong>MUST NOT</strong> 记录以下信息：</p><ul><li>助记词</li><li>私钥</li><li>图案锁</li><li>完整地址（仅记录前 6 + 后 4 位）</li></ul><hr><h2 id="错误上报规范" tabindex="-1">错误上报规范 <a class="header-anchor" href="#错误上报规范" aria-label="Permalink to &quot;错误上报规范&quot;">​</a></h2><h3 id="上报条件" tabindex="-1">上报条件 <a class="header-anchor" href="#上报条件" aria-label="Permalink to &quot;上报条件&quot;">​</a></h3><table tabindex="0"><thead><tr><th>错误级别</th><th>上报</th><th>时机</th></tr></thead><tbody><tr><td>info/warning</td><td>否</td><td>-</td></tr><tr><td>error (可恢复)</td><td>聚合上报</td><td>每 5 分钟</td></tr><tr><td>error (不可恢复)</td><td>即时上报</td><td>立即</td></tr><tr><td>fatal</td><td>即时上报</td><td>立即</td></tr></tbody></table><h3 id="上报数据" tabindex="-1">上报数据 <a class="header-anchor" href="#上报数据" aria-label="Permalink to &quot;上报数据&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ErrorReport {</span></span>
<span class="line"><span>  errors: ErrorLog[]</span></span>
<span class="line"><span>  sessionId: string</span></span>
<span class="line"><span>  deviceInfo: DeviceInfo</span></span>
<span class="line"><span>  appVersion: string</span></span>
<span class="line"><span>}</span></span></code></pre></div><h3 id="用户隐私" tabindex="-1">用户隐私 <a class="header-anchor" href="#用户隐私" aria-label="Permalink to &quot;用户隐私&quot;">​</a></h3><ul><li><strong>MUST</strong> 脱敏后再上报</li><li><strong>MUST</strong> 允许用户关闭错误上报</li><li><strong>SHOULD</strong> 上报前显示上报内容</li></ul><hr><h2 id="测试要求" tabindex="-1">测试要求 <a class="header-anchor" href="#测试要求" aria-label="Permalink to &quot;测试要求&quot;">​</a></h2><h3 id="错误场景覆盖" tabindex="-1">错误场景覆盖 <a class="header-anchor" href="#错误场景覆盖" aria-label="Permalink to &quot;错误场景覆盖&quot;">​</a></h3><table tabindex="0"><thead><tr><th>场景</th><th>测试点</th></tr></thead><tbody><tr><td>网络断开</td><td>显示离线提示</td></tr><tr><td>请求超时</td><td>自动重试</td></tr><tr><td>余额不足</td><td>禁用发送 + 提示</td></tr><tr><td>图案错误</td><td>显示错误动画 + 清空</td></tr><tr><td>节点不可用</td><td>自动切换</td></tr></tbody></table><h3 id="错误恢复测试" tabindex="-1">错误恢复测试 <a class="header-anchor" href="#错误恢复测试" aria-label="Permalink to &quot;错误恢复测试&quot;">​</a></h3><ul><li>重试后成功</li><li>降级后可用</li><li>用户干预后恢复</li></ul><hr><h2 id="本章小结" tabindex="-1">本章小结 <a class="header-anchor" href="#本章小结" aria-label="Permalink to &quot;本章小结&quot;">​</a></h2><ul><li>统一的错误码体系，便于追踪和处理</li><li>分层处理：捕获 → 转换 → 决策 → 展示</li><li>自动恢复优先，必要时引导用户</li><li>错误 UI 分级：Toast → 内联 → 对话框 → 全屏</li><li>完善的日志和上报机制</li></ul>`,91)])])}const u=a(e,[["render",r]]);export{b as __pageData,u as default};
