import{_ as t,c as s,o as n,ag as e}from"./chunks/framework.B0we9iV-.js";const b=JSON.parse('{"title":"IAssetService 资产服务","description":"","frontmatter":{},"headers":[],"relativePath":"white-book/04-服务篇/02-链服务/IAssetService.md","filePath":"white-book/04-服务篇/02-链服务/IAssetService.md"}'),d={name:"white-book/04-服务篇/02-链服务/IAssetService.md"};function r(l,a,i,p,o,h){return n(),s("div",null,[...a[0]||(a[0]=[e(`<h1 id="iassetservice-资产服务" tabindex="-1">IAssetService 资产服务 <a class="header-anchor" href="#iassetservice-资产服务" aria-label="Permalink to &quot;IAssetService 资产服务&quot;">​</a></h1><blockquote><p>资产余额查询</p></blockquote><hr><h2 id="职责" tabindex="-1">职责 <a class="header-anchor" href="#职责" aria-label="Permalink to &quot;职责&quot;">​</a></h2><p>查询用户资产余额和代币信息，支持实时订阅。</p><hr><h2 id="接口定义" tabindex="-1">接口定义 <a class="header-anchor" href="#接口定义" aria-label="Permalink to &quot;接口定义&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>IAssetService {</span></span>
<span class="line"><span>  // 获取原生代币余额</span></span>
<span class="line"><span>  getNativeBalance(address: Address): Balance</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>  // 获取代币余额</span></span>
<span class="line"><span>  getTokenBalance(address: Address, tokenAddress: Address): Balance</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>  // 获取所有代币余额</span></span>
<span class="line"><span>  getTokenBalances(address: Address): Balance[]</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>  // 获取代币元数据</span></span>
<span class="line"><span>  getTokenMetadata(tokenAddress: Address): TokenMetadata</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>  // 订阅余额变化</span></span>
<span class="line"><span>  subscribeBalance(address: Address, callback: (balance: Balance) =&gt; void): Unsubscribe</span></span>
<span class="line"><span>}</span></span></code></pre></div><hr><h2 id="数据结构" tabindex="-1">数据结构 <a class="header-anchor" href="#数据结构" aria-label="Permalink to &quot;数据结构&quot;">​</a></h2><h3 id="balance" tabindex="-1">Balance <a class="header-anchor" href="#balance" aria-label="Permalink to &quot;Balance&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Balance {</span></span>
<span class="line"><span>  raw: bigint           // 原始值（最小单位）</span></span>
<span class="line"><span>  formatted: string     // 格式化值（人类可读）</span></span>
<span class="line"><span>  symbol: string        // 代币符号</span></span>
<span class="line"><span>  decimals: number      // 小数位数</span></span>
<span class="line"><span>}</span></span></code></pre></div><p><strong>示例</strong>：</p><table tabindex="0"><thead><tr><th>raw</th><th>decimals</th><th>formatted</th></tr></thead><tbody><tr><td>1000000000000000000</td><td>18</td><td>&quot;1.0&quot;</td></tr><tr><td>50000000</td><td>8</td><td>&quot;0.5&quot;</td></tr></tbody></table><h3 id="tokenmetadata" tabindex="-1">TokenMetadata <a class="header-anchor" href="#tokenmetadata" aria-label="Permalink to &quot;TokenMetadata&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>TokenMetadata {</span></span>
<span class="line"><span>  address: Address      // 合约地址（原生为空）</span></span>
<span class="line"><span>  name: string          // 代币全名</span></span>
<span class="line"><span>  symbol: string        // 代币符号</span></span>
<span class="line"><span>  decimals: number      // 小数位数</span></span>
<span class="line"><span>  logoUri?: string      // 图标 URL</span></span>
<span class="line"><span>  standard: TokenStandard</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TokenStandard = &#39;native&#39; | &#39;ERC20&#39; | &#39;TRC20&#39; | &#39;BFM-TOKEN&#39; | &#39;SPL&#39;</span></span></code></pre></div><hr><h2 id="方法详情" tabindex="-1">方法详情 <a class="header-anchor" href="#方法详情" aria-label="Permalink to &quot;方法详情&quot;">​</a></h2><h3 id="getnativebalance" tabindex="-1">getNativeBalance <a class="header-anchor" href="#getnativebalance" aria-label="Permalink to &quot;getNativeBalance&quot;">​</a></h3><p>获取原生代币（如 ETH、BFM）余额。</p><p><strong>参数</strong>：</p><table tabindex="0"><thead><tr><th>参数</th><th>类型</th><th>必需</th><th>说明</th></tr></thead><tbody><tr><td>address</td><td>Address</td><td>Y</td><td>查询地址</td></tr></tbody></table><p><strong>返回</strong>：<code>Balance</code></p><p><strong>行为规范</strong>：</p><ul><li><strong>MUST</strong> 返回最新链上数据</li><li><strong>SHOULD</strong> 支持请求缓存（staleTime: 10s）</li><li><strong>MUST</strong> 处理地址不存在的情况（返回 0）</li></ul><hr><h3 id="gettokenbalances" tabindex="-1">getTokenBalances <a class="header-anchor" href="#gettokenbalances" aria-label="Permalink to &quot;getTokenBalances&quot;">​</a></h3><p>批量获取地址持有的所有代币余额。</p><p><strong>参数</strong>：</p><table tabindex="0"><thead><tr><th>参数</th><th>类型</th><th>必需</th><th>说明</th></tr></thead><tbody><tr><td>address</td><td>Address</td><td>Y</td><td>查询地址</td></tr></tbody></table><p><strong>返回</strong>：<code>Balance[]</code></p><p><strong>行为规范</strong>：</p><ul><li><strong>SHOULD</strong> 使用批量 RPC 调用优化性能</li><li><strong>MAY</strong> 使用索引服务加速查询</li><li><strong>MUST</strong> 包含原生代币</li></ul><hr><h3 id="subscribebalance" tabindex="-1">subscribeBalance <a class="header-anchor" href="#subscribebalance" aria-label="Permalink to &quot;subscribeBalance&quot;">​</a></h3><p>订阅余额实时变化。</p><p><strong>参数</strong>：</p><table tabindex="0"><thead><tr><th>参数</th><th>类型</th><th>必需</th><th>说明</th></tr></thead><tbody><tr><td>address</td><td>Address</td><td>Y</td><td>订阅地址</td></tr><tr><td>callback</td><td>function</td><td>Y</td><td>变化回调</td></tr></tbody></table><p><strong>返回</strong>：<code>Unsubscribe</code> - 取消订阅函数</p><p><strong>行为规范</strong>：</p><ul><li><strong>MUST</strong> 立即回调一次当前余额</li><li><strong>MUST</strong> 区块更新时检查余额变化</li><li><strong>SHOULD</strong> 使用 WebSocket 实时推送</li><li><strong>MAY</strong> 使用轮询作为降级方案</li></ul><hr><h2 id="缓存策略" tabindex="-1">缓存策略 <a class="header-anchor" href="#缓存策略" aria-label="Permalink to &quot;缓存策略&quot;">​</a></h2><table tabindex="0"><thead><tr><th>数据类型</th><th>缓存时间</th><th>失效条件</th></tr></thead><tbody><tr><td>原生余额</td><td>10s</td><td>发送交易后</td></tr><tr><td>代币余额</td><td>30s</td><td>发送交易后</td></tr><tr><td>代币元数据</td><td>24h</td><td>几乎不变</td></tr></tbody></table><hr><h2 id="错误码" tabindex="-1">错误码 <a class="header-anchor" href="#错误码" aria-label="Permalink to &quot;错误码&quot;">​</a></h2><table tabindex="0"><thead><tr><th>错误码</th><th>说明</th><th>处理建议</th></tr></thead><tbody><tr><td>ADDRESS_NOT_FOUND</td><td>地址在链上不存在</td><td>返回余额 0</td></tr><tr><td>TOKEN_NOT_FOUND</td><td>代币合约不存在</td><td>提示用户检查地址</td></tr><tr><td>NETWORK_ERROR</td><td>网络请求失败</td><td>显示缓存数据 + 重试</td></tr><tr><td>RATE_LIMIT</td><td>请求频率限制</td><td>降低请求频率</td></tr></tbody></table><hr><h2 id="性能要求" tabindex="-1">性能要求 <a class="header-anchor" href="#性能要求" aria-label="Permalink to &quot;性能要求&quot;">​</a></h2><table tabindex="0"><thead><tr><th>指标</th><th>目标值</th></tr></thead><tbody><tr><td>单次查询延迟</td><td>&lt; 500ms</td></tr><tr><td>批量查询延迟</td><td>&lt; 2s（100个代币）</td></tr><tr><td>订阅更新延迟</td><td>&lt; 5s（新区块后）</td></tr></tbody></table>`,50)])])}const g=t(d,[["render",r]]);export{b as __pageData,g as default};
