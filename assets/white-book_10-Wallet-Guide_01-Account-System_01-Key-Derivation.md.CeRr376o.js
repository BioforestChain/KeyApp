import{_ as e,c as s,o as a,ag as t}from"./chunks/framework.B0we9iV-.js";const c=JSON.parse('{"title":"Key Derivation","description":"","frontmatter":{},"headers":[],"relativePath":"white-book/10-Wallet-Guide/01-Account-System/01-Key-Derivation.md","filePath":"white-book/10-Wallet-Guide/01-Account-System/01-Key-Derivation.md"}'),n={name:"white-book/10-Wallet-Guide/01-Account-System/01-Key-Derivation.md"};function r(h,i,l,d,o,p){return a(),s("div",null,[...i[0]||(i[0]=[t(`<h1 id="key-derivation" tabindex="-1">Key Derivation <a class="header-anchor" href="#key-derivation" aria-label="Permalink to &quot;Key Derivation&quot;">​</a></h1><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>KeyApp uses a unified key derivation strategy based on standard BIP protocols where applicable, while respecting chain-specific requirements.</p><h2 id="master-seed" tabindex="-1">Master Seed <a class="header-anchor" href="#master-seed" aria-label="Permalink to &quot;Master Seed&quot;">​</a></h2><p>The root of all keys is a <strong>12 or 24 word mnemonic phrase</strong> (BIP-39). This mnemonic is converted into a binary seed which is then used to derive chain-specific keys.</p><blockquote><p><strong>Note</strong>: For BioForest chains, the mnemonic string itself (UTF-8 encoded) acts as the seed for Ed25519 key generation, rather than the BIP-39 binary seed. This is a legacy compatibility requirement.</p></blockquote><h2 id="derivation-paths" tabindex="-1">Derivation Paths <a class="header-anchor" href="#derivation-paths" aria-label="Permalink to &quot;Derivation Paths&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Chain Kind</th><th>Algorithm</th><th>Path / Method</th><th>Standard</th></tr></thead><tbody><tr><td><strong>BioForest</strong></td><td>Ed25519</td><td><code>sha256(mnemonic)</code></td><td>Custom</td></tr><tr><td><strong>Bitcoin</strong></td><td>Secp256k1</td><td><code>m/84&#39;/0&#39;/0&#39;/0/0</code></td><td>BIP-84 (Native SegWit)</td></tr><tr><td><strong>Ethereum</strong></td><td>Secp256k1</td><td><code>m/44&#39;/60&#39;/0&#39;/0/0</code></td><td>BIP-44</td></tr><tr><td><strong>Tron</strong></td><td>Secp256k1</td><td><code>m/44&#39;/195&#39;/0&#39;/0/0</code></td><td>BIP-44</td></tr></tbody></table><h2 id="implementation" tabindex="-1">Implementation <a class="header-anchor" href="#implementation" aria-label="Permalink to &quot;Implementation&quot;">​</a></h2><h3 id="unified-interface" tabindex="-1">Unified Interface <a class="header-anchor" href="#unified-interface" aria-label="Permalink to &quot;Unified Interface&quot;">​</a></h3><p>Address derivation is exposed via the <code>IIdentityService</code> interface implemented by each chain adapter.</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IIdentityService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  deriveAddress</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">seed</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Uint8Array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  deriveAddresses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">seed</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Uint8Array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">startIndex</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">count</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[]&gt;;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="usage" tabindex="-1">Usage <a class="header-anchor" href="#usage" aria-label="Permalink to &quot;Usage&quot;">​</a></h3><p>The helper function <code>deriveWalletChainAddresses</code> acts as the single entry point for deriving addresses for a user&#39;s wallet across multiple selected chains.</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// src/services/chain-adapter/derive-wallet-chain-addresses.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> deriveWalletChainAddresses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Iterates through selected chains and calls provider.deriveAddress</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="specific-implementations" tabindex="-1">Specific Implementations <a class="header-anchor" href="#specific-implementations" aria-label="Permalink to &quot;Specific Implementations&quot;">​</a></h3><ul><li><p><strong>BioForest (<code>BioforestIdentityService</code>)</strong>:</p><ul><li>Uses <code>createBioforestKeypair(seedString)</code>.</li><li>Same keypair for all indices (no HD support yet).</li></ul></li><li><p><strong>Bitcoin (<code>BitcoinIdentityService</code>)</strong>:</p><ul><li>Uses <code>deriveBitcoinKey(mnemonic, 84, index)</code>.</li><li>Supports full HD derivation.</li></ul></li></ul><h2 id="security-considerations" tabindex="-1">Security Considerations <a class="header-anchor" href="#security-considerations" aria-label="Permalink to &quot;Security Considerations&quot;">​</a></h2><ul><li><strong>Memory</strong>: Mnemonics are kept in memory only during the derivation process and cleared immediately after.</li><li><strong>Storage</strong>: Keys are never stored in plain text. See <a href="./02-Wallet-Storage.html">Wallet Storage</a> for encryption details.</li></ul>`,19)])])}const g=e(n,[["render",r]]);export{c as __pageData,g as default};
