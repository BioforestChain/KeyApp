import{_ as e,c as i,o as s,ag as r}from"./chunks/framework.B0we9iV-.js";const m=JSON.parse('{"title":"01. Iframe 管理 (Iframe Manager)","description":"","frontmatter":{},"headers":[],"relativePath":"white-book/01-Kernel-Ref/03-Sandbox/01-Iframe-Manager.md","filePath":"white-book/01-Kernel-Ref/03-Sandbox/01-Iframe-Manager.md"}'),t={name:"white-book/01-Kernel-Ref/03-Sandbox/01-Iframe-Manager.md"};function n(o,a,l,p,d,h){return s(),i("div",null,[...a[0]||(a[0]=[r('<h1 id="_01-iframe-管理-iframe-manager" tabindex="-1">01. Iframe 管理 (Iframe Manager) <a class="header-anchor" href="#_01-iframe-管理-iframe-manager" aria-label="Permalink to &quot;01. Iframe 管理 (Iframe Manager)&quot;">​</a></h1><p>Code: <code>src/services/miniapp-runtime/iframe-manager.ts</code></p><p>Iframe 是 DApp 的容器。KeyApp 对 Iframe 进行了深度的定制管理。</p><h2 id="创建策略" tabindex="-1">创建策略 <a class="header-anchor" href="#创建策略" aria-label="Permalink to &quot;创建策略&quot;">​</a></h2><ul><li><strong>URL 构造</strong>: 基础 URL + 上下文参数 (Context Params)。</li><li><strong>Sandbox</strong>: 启用严格的沙箱模式：<div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">iframe.sandbox.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;allow-scripts&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;allow-forms&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;allow-same-origin&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div>注意：通常不开启 <code>allow-top-navigation</code>，防止 DApp 篡改主页面。</li></ul><h2 id="挂载策略" tabindex="-1">挂载策略 <a class="header-anchor" href="#挂载策略" aria-label="Permalink to &quot;挂载策略&quot;">​</a></h2><p>为了支持后台保活，KeyApp 使用了 <strong>双容器策略</strong>：</p><ol><li><strong>Visible Container</strong>: 用于存放前台 Active 应用的 iframe。</li><li><strong>Hidden Container</strong>: 用于存放后台 Background 应用的 iframe。 <ul><li>样式: <code>position: fixed; top: -9999px; visibility: hidden</code>。</li><li>目的: 保持 DOM 节点存在，不触发 reload，但移出可视区域。</li></ul></li></ol><p>当应用在 前台/后台 切换时，我们只是简单地将 iframe 节点在两个容器之间 <code>appendChild</code> (移动节点)，而不是销毁重建。这保证了 DApp 状态不丢失。</p>',9)])])}const g=e(t,[["render",n]]);export{m as __pageData,g as default};
