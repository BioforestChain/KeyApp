import{_ as d,c as a,o as e,ag as i}from"./chunks/framework.B0we9iV-.js";const k=JSON.parse('{"title":"外部服务提供商","description":"","frontmatter":{},"headers":[],"relativePath":"white-book/99-Appendix/05-API-Providers.md","filePath":"white-book/99-Appendix/05-API-Providers.md"}'),s={name:"white-book/99-Appendix/05-API-Providers.md"};function r(o,t,n,l,h,c){return e(),a("div",null,[...t[0]||(t[0]=[i(`<h1 id="外部服务提供商" tabindex="-1">外部服务提供商 <a class="header-anchor" href="#外部服务提供商" aria-label="Permalink to &quot;外部服务提供商&quot;">​</a></h1><blockquote><p>源码: <a href="https://github.com/BioforestChain/KeyApp/blob/main/src/apis/" target="_blank" rel="noreferrer"><code>src/apis/</code></a></p></blockquote><hr><h2 id="概述" tabindex="-1">概述 <a class="header-anchor" href="#概述" aria-label="Permalink to &quot;概述&quot;">​</a></h2><p>本文档描述 <code>walletapi.bfmeta.info</code> 后端提供的 API 接口。不同链类型有完全不同的 API 模式。</p><hr><h2 id="keyapp-provider-配置" tabindex="-1">KeyApp Provider 配置 <a class="header-anchor" href="#keyapp-provider-配置" aria-label="Permalink to &quot;KeyApp Provider 配置&quot;">​</a></h2><p>KeyApp 的链配置（<code>public/configs/*.json</code>）使用有序数组 <code>apis[]</code> 描述外部 Provider。</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ApiConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // Provider 类型</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  endpoint</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // API 端点</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    apiKeyEnv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 环境变量名 (如 VITE_TRONGRID_API_KEY)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>优先级</strong>: 数组顺序从前到后，前一个失败会自动 fallback 到下一个</p><h3 id="常见-provider-类型" tabindex="-1">常见 Provider 类型 <a class="header-anchor" href="#常见-provider-类型" aria-label="Permalink to &quot;常见 Provider 类型&quot;">​</a></h3><table tabindex="0"><thead><tr><th>链类型</th><th>Provider</th><th>说明</th></tr></thead><tbody><tr><td>EVM</td><td><code>ethwallet-v1</code></td><td>ETH 钱包 API</td></tr><tr><td>EVM</td><td><code>bscwallet-v1</code></td><td>BSC 钱包 API</td></tr><tr><td>EVM</td><td><code>blockscout-v1</code></td><td>Blockscout 浏览器</td></tr><tr><td>Tron</td><td><code>tronwallet-v1</code></td><td>Tron 钱包 API</td></tr><tr><td>Tron</td><td><code>tron-rpc-pro</code></td><td>TronGrid (需 API Key)</td></tr><tr><td>Bitcoin</td><td><code>btcwallet-v1</code></td><td>BTC 钱包 API (代理 blockbook)</td></tr><tr><td>BioForest</td><td>-</td><td>直接连接</td></tr></tbody></table><hr><h2 id="链类型分类" tabindex="-1">链类型分类 <a class="header-anchor" href="#链类型分类" aria-label="Permalink to &quot;链类型分类&quot;">​</a></h2><table tabindex="0"><thead><tr><th>类型</th><th>链</th><th>API 路径前缀</th><th>特点</th></tr></thead><tbody><tr><td><strong>bioforest</strong></td><td>bfm, ccchain, pmchain</td><td><code>/wallet/{chain}/</code></td><td>本地构建交易，支付密码</td></tr><tr><td><strong>evm</strong></td><td>eth, bsc</td><td><code>/wallet/eth/</code>, <code>/wallet/bsc/</code></td><td>web3.js, ERC20/BEP20</td></tr><tr><td><strong>bitcoin</strong></td><td>btc</td><td><code>/wallet/btc/blockbook/</code></td><td>UTXO 模型，blockbook 代理</td></tr><tr><td><strong>tron</strong></td><td>tron</td><td><code>/wallet/tron/</code></td><td>tronweb, TRC20</td></tr></tbody></table><hr><h2 id="bioforest-链-api" tabindex="-1">BioForest 链 API <a class="header-anchor" href="#bioforest-链-api" aria-label="Permalink to &quot;BioForest 链 API&quot;">​</a></h2><p><strong>路径前缀</strong>: <code>/wallet/{chain}/</code> (chain = bfm, ccchain, pmchain)</p><p><strong>特点</strong>:</p><ul><li>本地构建交易 (<code>bundleCore</code>)</li><li>支持支付密码 (<code>secondPublicKey</code>)</li><li>统一响应格式 <code>{ success, result }</code></li></ul><h3 id="api-端点" tabindex="-1">API 端点 <a class="header-anchor" href="#api-端点" aria-label="Permalink to &quot;API 端点&quot;">​</a></h3><table tabindex="0"><thead><tr><th>方法</th><th>路径</th><th>说明</th></tr></thead><tbody><tr><td>POST</td><td><code>/wallet/{chain}/address/balance</code></td><td>获取余额</td></tr><tr><td>POST</td><td><code>/wallet/{chain}/address/info</code></td><td>获取地址信息 (含 secondPublicKey)</td></tr><tr><td>POST</td><td><code>/wallet/{chain}/address/asset</code></td><td>获取地址资产</td></tr><tr><td>GET</td><td><code>/wallet/{chain}/lastblock</code></td><td>获取最新区块</td></tr><tr><td>POST</td><td><code>/wallet/{chain}/block/query</code></td><td>根据高度查区块</td></tr><tr><td>GET</td><td><code>/wallet/{chain}/blockAveFee</code></td><td>获取平均手续费</td></tr><tr><td>POST</td><td><code>/wallet/{chain}/transactions/broadcast</code></td><td>广播交易</td></tr><tr><td>POST</td><td><code>/wallet/{chain}/transactions/query</code></td><td>查询已上链交易</td></tr><tr><td>POST</td><td><code>/wallet/{chain}/pendingTr</code></td><td>查询未上链交易</td></tr><tr><td>POST</td><td><code>/wallet/{chain}/assets</code></td><td>获取代币列表</td></tr><tr><td>POST</td><td><code>/wallet/{chain}/asset/details</code></td><td>获取代币详情</td></tr></tbody></table><h3 id="响应格式" tabindex="-1">响应格式 <a class="header-anchor" href="#响应格式" aria-label="Permalink to &quot;响应格式&quot;">​</a></h3><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ApiResponse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  success</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> boolean</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  message</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><hr><h2 id="evm-兼容链-api" tabindex="-1">EVM 兼容链 API <a class="header-anchor" href="#evm-兼容链-api" aria-label="Permalink to &quot;EVM 兼容链 API&quot;">​</a></h2><p><strong>路径前缀</strong>: <code>/wallet/eth/</code>, <code>/wallet/bsc/</code></p><p><strong>特点</strong>:</p><ul><li>使用 web3.js 签名</li><li>支持 ERC20/BEP20 合约</li><li>EIP-1559 (maxFeePerGas, maxPriorityFeePerGas)</li></ul><h3 id="api-端点-以-eth-为例" tabindex="-1">API 端点 (以 ETH 为例) <a class="header-anchor" href="#api-端点-以-eth-为例" aria-label="Permalink to &quot;API 端点 (以 ETH 为例)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>方法</th><th>路径</th><th>说明</th></tr></thead><tbody><tr><td>GET</td><td><code>/wallet/eth/balance</code></td><td>获取 ETH 余额</td></tr><tr><td>POST</td><td><code>/wallet/eth/balance/erc20</code></td><td>获取 ERC20 余额</td></tr><tr><td>GET</td><td><code>/wallet/eth/trans/count</code></td><td>获取 nonce</td></tr><tr><td>GET</td><td><code>/wallet/eth/gasPrice</code></td><td>获取 gasPrice</td></tr><tr><td>GET</td><td><code>/wallet/eth/baseGas</code></td><td>获取 gasLimit</td></tr><tr><td>POST</td><td><code>/wallet/eth/trans/prep</code></td><td>交易预备信息</td></tr><tr><td>POST</td><td><code>/wallet/eth/trans/erc20/data</code></td><td>获取合约 data</td></tr><tr><td>POST</td><td><code>/wallet/eth/trans/send</code></td><td>广播交易</td></tr><tr><td>GET</td><td><code>/wallet/eth/trans/query</code></td><td>查询交易</td></tr><tr><td>POST</td><td><code>/wallet/eth/trans/normal/history</code></td><td>普通交易历史</td></tr><tr><td>POST</td><td><code>/wallet/eth/trans/erc20/history</code></td><td>ERC20 交易历史</td></tr><tr><td>POST</td><td><code>/wallet/eth/trans/pending</code></td><td>查询 pending 交易</td></tr><tr><td>POST</td><td><code>/wallet/eth/contract/tokens</code></td><td>代币列表</td></tr><tr><td>POST</td><td><code>/wallet/eth/contract/token/detail</code></td><td>代币详情</td></tr><tr><td>POST</td><td><code>/wallet/eth/account/balance/v2</code></td><td>批量查余额</td></tr><tr><td>GET</td><td><code>/wallet/eth/getChainId</code></td><td>获取 chainId</td></tr></tbody></table><hr><h2 id="比特币-api" tabindex="-1">比特币 API <a class="header-anchor" href="#比特币-api" aria-label="Permalink to &quot;比特币 API&quot;">​</a></h2><p><strong>路径前缀</strong>: <code>/wallet/btc/blockbook/</code> (代理到 blockbook API)</p><p><strong>特点</strong>:</p><ul><li>UTXO 模型</li><li>代理 blockbook API</li><li>本地 PSBT 签名</li></ul><h3 id="api-端点-1" tabindex="-1">API 端点 <a class="header-anchor" href="#api-端点-1" aria-label="Permalink to &quot;API 端点&quot;">​</a></h3><table tabindex="0"><thead><tr><th>方法</th><th>路径</th><th>说明</th></tr></thead><tbody><tr><td>GET</td><td><code>/api/v2/address/{address}</code></td><td>地址信息</td></tr><tr><td>GET</td><td><code>/api/v2/utxo/{address}</code></td><td>获取 UTXO</td></tr><tr><td>GET</td><td><code>/api/v2/tx/{txid}</code></td><td>交易详情</td></tr><tr><td>GET</td><td><code>/api/v2/sendtx/{hex}</code></td><td>广播交易</td></tr><tr><td>GET</td><td><code>/api/v2/estimatefee/{blocks}</code></td><td>费率估算</td></tr></tbody></table><p><strong>注意</strong>: Bitcoin API 使用代理模式，通过 POST 发送 <code>{ url, method }</code> 参数。</p><hr><h2 id="波场-api" tabindex="-1">波场 API <a class="header-anchor" href="#波场-api" aria-label="Permalink to &quot;波场 API&quot;">​</a></h2><p><strong>路径前缀</strong>: <code>/wallet/tron/</code></p><p><strong>特点</strong>:</p><ul><li>使用 tronweb</li><li>地址有 hex/base58 转换</li><li>TRC20 合约</li></ul><h3 id="api-端点-2" tabindex="-1">API 端点 <a class="header-anchor" href="#api-端点-2" aria-label="Permalink to &quot;API 端点&quot;">​</a></h3><table tabindex="0"><thead><tr><th>方法</th><th>路径</th><th>说明</th></tr></thead><tbody><tr><td>GET</td><td><code>/wallet/tron/balance</code></td><td>获取 TRX 余额</td></tr><tr><td>POST</td><td><code>/wallet/tron/balance/trc20</code></td><td>获取 TRC20 余额</td></tr><tr><td>GET</td><td><code>/wallet/tron/account</code></td><td>账户信息</td></tr><tr><td>GET</td><td><code>/wallet/tron/account/resource</code></td><td>账户资源 (带宽/能量)</td></tr><tr><td>POST</td><td><code>/wallet/tron/trans/create</code></td><td>创建 TRX 交易</td></tr><tr><td>POST</td><td><code>/wallet/tron/trans/contract</code></td><td>创建 TRC20 交易</td></tr><tr><td>POST</td><td><code>/wallet/tron/trans/broadcast</code></td><td>广播 TRX 交易</td></tr><tr><td>POST</td><td><code>/wallet/tron/trans/trc20/broadcast</code></td><td>广播 TRC20 交易</td></tr><tr><td>POST</td><td><code>/wallet/tron/trans/common/history</code></td><td>TRX 交易历史</td></tr><tr><td>POST</td><td><code>/wallet/tron/trans/trc20/history</code></td><td>TRC20 交易历史</td></tr><tr><td>POST</td><td><code>/wallet/tron/trans/pending</code></td><td>pending 交易</td></tr><tr><td>POST</td><td><code>/wallet/tron/trans/receipt</code></td><td>交易回执</td></tr><tr><td>POST</td><td><code>/wallet/tron/contract/tokens</code></td><td>代币列表</td></tr><tr><td>POST</td><td><code>/wallet/tron/contract/token/detail</code></td><td>代币详情</td></tr><tr><td>POST</td><td><code>/wallet/tron/account/balance/v2</code></td><td>批量查余额</td></tr></tbody></table><h3 id="trongrid-api-key" tabindex="-1">TronGrid API Key <a class="header-anchor" href="#trongrid-api-key" aria-label="Permalink to &quot;TronGrid API Key&quot;">​</a></h3><p><code>tron-rpc-pro</code> 支持在 <code>config.apiKeyEnv</code> 指定环境变量：</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tron-rpc-pro&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;endpoint&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://api.trongrid.io&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;config&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;apiKeyEnv&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;VITE_TRONGRID_API_KEY&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>注入请求头: <code>TRON-PRO-API-KEY: {apiKey}</code></p><hr><h2 id="相关文档" tabindex="-1">相关文档 <a class="header-anchor" href="#相关文档" aria-label="Permalink to &quot;相关文档&quot;">​</a></h2><ul><li><a href="./../02-Driver-Ref/README.html">Driver Reference</a> - 链适配器实现</li><li><a href="./02-Chain-Networks.html">Chain Networks</a> - 链网络配置</li></ul>`,53)])])}const b=d(s,[["render",r]]);export{k as __pageData,b as default};
