import{_ as t,c as a,o as i,ag as e}from"./chunks/framework.B0we9iV-.js";const c=JSON.parse('{"title":"AI 开发指南 - 必读","description":"","frontmatter":{},"headers":[],"relativePath":"white-book/00-必读/index.md","filePath":"white-book/00-必读/index.md"}'),l={name:"white-book/00-必读/index.md"};function n(h,s,o,d,r,p){return i(),a("div",null,[...s[0]||(s[0]=[e(`<h1 id="ai-开发指南-必读" tabindex="-1">AI 开发指南 - 必读 <a class="header-anchor" href="#ai-开发指南-必读" aria-label="Permalink to &quot;AI 开发指南 - 必读&quot;">​</a></h1><blockquote><p><strong>重要</strong>：本章节是 AI 模型开发本项目前的必读内容。</p></blockquote><hr><h2 id="序言-纠正-ai-直觉" tabindex="-1">序言：纠正 AI 直觉 <a class="header-anchor" href="#序言-纠正-ai-直觉" aria-label="Permalink to &quot;序言：纠正 AI 直觉&quot;">​</a></h2><p>AI 模型在开发移动端 Web 应用时，往往会基于通用 Web 开发经验做出直觉性的选择。但本项目使用了特定的技术栈和架构模式，这些&quot;直觉&quot;可能导致严重的问题。</p><h3 id="🚫-常见错误直觉" tabindex="-1">🚫 常见错误直觉 <a class="header-anchor" href="#🚫-常见错误直觉" aria-label="Permalink to &quot;🚫 常见错误直觉&quot;">​</a></h3><p>最佳实践已独立维护在：</p><ul><li><code>00-必读/best-practices.md</code></li><li><code>pnpm agent practice list</code></li></ul><h3 id="📚-为什么会出错" tabindex="-1">📚 为什么会出错？ <a class="header-anchor" href="#📚-为什么会出错" aria-label="Permalink to &quot;📚 为什么会出错？&quot;">​</a></h3><ol><li><p><strong>Stackflow 是页面栈管理器</strong>：它管理整个页面栈的动画和生命周期。使用 <code>position: fixed</code> 会绕过 Stackflow 的控制，导致动画冲突、页面&quot;抖动&quot;等问题。</p></li><li><p><strong>本项目是移动端优先</strong>：需要原生 App 般的用户体验，包括滑动返回、栈式导航等。传统 Web 的弹窗模式不适用。</p></li><li><p><strong>组件已经封装好</strong>：不要重新发明轮子，查看 <code>src/components/</code> 和 <code>src/stackflow/activities/sheets/</code> 下的现有实现。</p></li></ol><hr><h2 id="目录索引" tabindex="-1">目录索引 <a class="header-anchor" href="#目录索引" aria-label="Permalink to &quot;目录索引&quot;">​</a></h2><p>使用以下命令获取白皮书完整目录：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 列出所有白皮书章节</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">find</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docs/white-book</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;*.md&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span></span></code></pre></div><p>或者让 AI 执行 Grep 命令动态获取。</p><h3 id="核心章节速查" tabindex="-1">核心章节速查 <a class="header-anchor" href="#核心章节速查" aria-label="Permalink to &quot;核心章节速查&quot;">​</a></h3><table tabindex="0"><thead><tr><th>章节</th><th>路径</th><th>何时阅读</th></tr></thead><tbody><tr><td><strong>导航系统</strong></td><td><code>03-架构篇/03-导航系统/</code></td><td>实现页面跳转、Tab 切换时</td></tr><tr><td><strong>Sheet 组件</strong></td><td><code>05-组件篇/01-基础组件/Sheet.md</code></td><td>实现底部弹出层时</td></tr><tr><td><strong>Dialog 组件</strong></td><td><code>05-组件篇/01-基础组件/Dialog.md</code></td><td>实现居中对话框时</td></tr><tr><td><strong>服务架构</strong></td><td><code>04-服务篇/01-服务架构/</code></td><td>调用后端 API 或链服务时</td></tr><tr><td><strong>钱包存储</strong></td><td><code>04-服务篇/08-钱包数据存储/</code></td><td>操作钱包数据时</td></tr><tr><td><strong>国际化</strong></td><td><code>07-国际化篇/</code></td><td>添加文案或多语言时</td></tr><tr><td><strong>测试策略</strong></td><td><code>08-测试篇/</code></td><td>编写测试用例时</td></tr><tr><td><strong>E2E 最佳实践</strong></td><td><code>08-测试篇/03-Playwright配置/e2e-best-practices.md</code></td><td><strong>必读：禁止使用明文选择器</strong></td></tr></tbody></table><hr><h2 id="外部文档链接" tabindex="-1">外部文档链接 <a class="header-anchor" href="#外部文档链接" aria-label="Permalink to &quot;外部文档链接&quot;">​</a></h2><p>以下是本项目依赖的核心库的 LLM 友好文档：</p><table tabindex="0"><thead><tr><th>库</th><th>文档链接</th><th>用途</th></tr></thead><tbody><tr><td><strong>Stackflow</strong></td><td><a href="https://stackflow.so/llms-full.txt" target="_blank" rel="noreferrer">https://stackflow.so/llms-full.txt</a></td><td>页面栈导航、Activity、Sheet、Modal</td></tr><tr><td><strong>shadcn/ui</strong></td><td><a href="https://ui.shadcn.com/docs" target="_blank" rel="noreferrer">https://ui.shadcn.com/docs</a></td><td>UI 组件库</td></tr><tr><td><strong>TanStack Query</strong></td><td><a href="https://tanstack.com/query/latest" target="_blank" rel="noreferrer">https://tanstack.com/query/latest</a></td><td>数据获取和缓存</td></tr><tr><td><strong>TanStack Store</strong></td><td><a href="https://tanstack.com/store/latest" target="_blank" rel="noreferrer">https://tanstack.com/store/latest</a></td><td>状态管理</td></tr></tbody></table><hr><h2 id="开发检查清单" tabindex="-1">开发检查清单 <a class="header-anchor" href="#开发检查清单" aria-label="Permalink to &quot;开发检查清单&quot;">​</a></h2><p>在开始编码前，请确认：</p><ul><li>[ ] 是否已阅读相关白皮书章节？</li><li>[ ] 是否已查看 <code>src/</code> 下的类似实现？</li><li>[ ] 弹出层是否使用了 Stackflow 的 <code>BottomSheet</code> 或 <code>Modal</code>？</li><li>[ ] 是否遵循了现有的代码风格和模式？</li><li>[ ] 是否添加了必要的国际化文案？</li><li>[ ] 是否更新了相关测试？</li></ul><hr><h2 id="快速参考" tabindex="-1">快速参考 <a class="header-anchor" href="#快速参考" aria-label="Permalink to &quot;快速参考&quot;">​</a></h2><h3 id="stackflow-activity-类型" tabindex="-1">Stackflow Activity 类型 <a class="header-anchor" href="#stackflow-activity-类型" aria-label="Permalink to &quot;Stackflow Activity 类型&quot;">​</a></h3><div class="language-tsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 普通全屏页面</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { AppScreen } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@stackflow/plugin-basic-ui&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 底部弹出层（Sheet）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { BottomSheet } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@stackflow/plugin-basic-ui&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 居中对话框（Modal）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Modal } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@stackflow/plugin-basic-ui&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h3 id="导航操作" tabindex="-1">导航操作 <a class="header-anchor" href="#导航操作" aria-label="Permalink to &quot;导航操作&quot;">​</a></h3><div class="language-tsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { useFlow } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@/stackflow&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">replace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useFlow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 打开新页面</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ActivityName&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { param: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;value&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 返回上一页</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 替换当前页面</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">replace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ActivityName&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { param: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;value&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span></code></pre></div><h3 id="sheet-activity-模式" tabindex="-1">Sheet Activity 模式 <a class="header-anchor" href="#sheet-activity-模式" aria-label="Permalink to &quot;Sheet Activity 模式&quot;">​</a></h3><p>当需要创建新的 Sheet 时，参考 <code>src/stackflow/activities/sheets/</code> 下的实现：</p><ol><li>创建 Activity 组件，使用 <code>&lt;BottomSheet&gt;</code> 或 <code>&lt;Modal&gt;</code> 包裹</li><li>在 <code>stackflow.ts</code> 中注册路由和组件</li><li>在 <code>sheets/index.ts</code> 中导出</li></ol><hr><h2 id="常见问题" tabindex="-1">常见问题 <a class="header-anchor" href="#常见问题" aria-label="Permalink to &quot;常见问题&quot;">​</a></h2><h3 id="q-为什么我的弹窗导致页面-抖动-或消失" tabindex="-1">Q: 为什么我的弹窗导致页面&quot;抖动&quot;或消失？ <a class="header-anchor" href="#q-为什么我的弹窗导致页面-抖动-或消失" aria-label="Permalink to &quot;Q: 为什么我的弹窗导致页面&quot;抖动&quot;或消失？&quot;">​</a></h3><p>A: 你可能使用了 Radix Dialog 或自定义 <code>position: fixed</code>。这会与 Stackflow 的动画系统冲突。请改用 Stackflow 的 <code>BottomSheet</code> 或 <code>Modal</code>。</p><h3 id="q-如何传递数据给-sheet-并获取返回值" tabindex="-1">Q: 如何传递数据给 Sheet 并获取返回值？ <a class="header-anchor" href="#q-如何传递数据给-sheet-并获取返回值" aria-label="Permalink to &quot;Q: 如何传递数据给 Sheet 并获取返回值？&quot;">​</a></h3><p>A: 使用全局回调模式。参考 <code>WalletLockConfirmJob</code> 的实现：</p><div class="language-tsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 设置回调</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setWalletLockConfirmCallback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">patternKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 处理返回的图案密钥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 打开 Sheet</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;WalletLockConfirmJob&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {});</span></span></code></pre></div><h3 id="q-什么时候用-bottomsheet-什么时候用-modal" tabindex="-1">Q: 什么时候用 BottomSheet，什么时候用 Modal？ <a class="header-anchor" href="#q-什么时候用-bottomsheet-什么时候用-modal" aria-label="Permalink to &quot;Q: 什么时候用 BottomSheet，什么时候用 Modal？&quot;">​</a></h3><ul><li><strong>BottomSheet</strong>：选择列表、表单输入、确认操作（从底部滑入）</li><li><strong>Modal</strong>：警告、确认对话框（居中显示）</li></ul>`,43)])])}const g=t(l,[["render",n]]);export{c as __pageData,g as default};
