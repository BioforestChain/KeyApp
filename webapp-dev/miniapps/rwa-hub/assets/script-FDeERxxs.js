import{B as c}from"./bioforestChainBundle-D4MYt0oV.js";import{OPS as l,REVERSE_OPS as q}from"./ops-CO93g0rg.js";import{a as C}from"./page-BOxexyJV.js";import{t as i}from"./typeforce-Dwy2dsyn.js";function L(n){if(n.length<8||n.length>72||n[0]!==48||n[1]!==n.length-2||n[2]!==2)return!1;const e=n[3];if(e===0||5+e>=n.length||n[4+e]!==2)return!1;const t=n[5+e];return!(t===0||6+e+t!==n.length||n[4]&128||e>1&&n[4]===0&&!(n[5]&128)||n[e+6]&128||t>1&&n[e+6]===0&&!(n[e+7]&128))}function K(n){if(n.length<8)throw new Error("DER sequence length is too short");if(n.length>72)throw new Error("DER sequence length is too long");if(n[0]!==48)throw new Error("Expected DER sequence");if(n[1]!==n.length-2)throw new Error("DER sequence length is invalid");if(n[2]!==2)throw new Error("Expected DER integer");const e=n[3];if(e===0)throw new Error("R length is zero");if(5+e>=n.length)throw new Error("R length is too long");if(n[4+e]!==2)throw new Error("Expected DER integer (2)");const t=n[5+e];if(t===0)throw new Error("S length is zero");if(6+e+t!==n.length)throw new Error("S length is invalid");if(n[4]&128)throw new Error("R value is negative");if(e>1&&n[4]===0&&!(n[5]&128))throw new Error("R value excessively padded");if(n[e+6]&128)throw new Error("S value is negative");if(t>1&&n[e+6]===0&&!(n[e+7]&128))throw new Error("S value excessively padded");return{r:n.slice(4,4+e),s:n.slice(6+e)}}function F(n,e){const t=n.length,r=e.length;if(t===0)throw new Error("R length is zero");if(r===0)throw new Error("S length is zero");if(t>33)throw new Error("R length is too long");if(r>33)throw new Error("S length is too long");if(n[0]&128)throw new Error("R value is negative");if(e[0]&128)throw new Error("S value is negative");if(t>1&&n[0]===0&&!(n[1]&128))throw new Error("R value excessively padded");if(r>1&&e[0]===0&&!(e[1]&128))throw new Error("S value excessively padded");const o=c.allocUnsafe(6+t+r);return o[0]=48,o[1]=o.length-2,o[2]=2,o[3]=n.length,n.copy(o,4),o[4+t]=2,o[5+t]=e.length,e.copy(o,6+t),o}function P(n){return n<l.OP_PUSHDATA1?1:n<=255?2:n<=65535?3:5}function V(n,e,t){const r=P(e);return r===1?n.writeUInt8(e,t):r===2?(n.writeUInt8(l.OP_PUSHDATA1,t),n.writeUInt8(e,t+1)):r===3?(n.writeUInt8(l.OP_PUSHDATA2,t),n.writeUInt16LE(e,t+1)):(n.writeUInt8(l.OP_PUSHDATA4,t),n.writeUInt32LE(e,t+1)),r}function G(n,e){const t=n.readUInt8(e);let r,o;if(t<l.OP_PUSHDATA1)r=t,o=1;else if(t===l.OP_PUSHDATA1){if(e+2>n.length)return null;r=n.readUInt8(e+1),o=2}else if(t===l.OP_PUSHDATA2){if(e+3>n.length)return null;r=n.readUInt16LE(e+1),o=3}else{if(e+5>n.length)return null;if(t!==l.OP_PUSHDATA4)throw new Error("Unexpected opcode");r=n.readUInt32LE(e+1),o=5}return{opcode:t,number:r,size:o}}function X(n,e,t){e=e||4,t=t===void 0?!0:t;const r=n.length;if(r===0)return 0;if(r>e)throw new TypeError("Script number overflow");if(t&&(n[r-1]&127)===0&&(r<=1||(n[r-2]&128)===0))throw new Error("Non-minimally encoded script number");if(r===5){const s=n.readUInt32LE(0),f=n.readUInt8(4);return f&128?-((f&-129)*4294967296+s):f*4294967296+s}let o=0;for(let s=0;s<r;++s)o|=n[s]<<8*s;return n[r-1]&128?-(o&~(128<<8*(r-1))):o}function Z(n){return n>2147483647?5:n>8388607?4:n>32767?3:n>127?2:n>0?1:0}function U(n){let e=Math.abs(n);const t=Z(e),r=C.allocUnsafe(t),o=n<0;for(let s=0;s<t;++s)r.writeUInt8(e&255,s),e>>=8;return r[t-1]&128?r.writeUInt8(o?128:0,t-1):o&&(r[t-1]|=128),r}const J=Object.freeze(Object.defineProperty({__proto__:null,decode:X,encode:U},Symbol.toStringTag,{value:"Module"})),p=c.alloc(32,0),E=c.from("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f","hex");function Q(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.equals(e[r]))}function I(n){if(!c.isBuffer(n)||n.length<33)return!1;const e=n[0],t=n.subarray(1,33);if(t.compare(p)===0||t.compare(E)>=0)return!1;if((e===2||e===3)&&n.length===33)return!0;const r=n.subarray(33);return r.compare(p)===0||r.compare(E)>=0?!1:e===4&&n.length===65}const W=Math.pow(2,31)-1;function Y(n){return i.UInt32(n)&&n<=W}function O(n){return i.String(n)&&!!n.match(/^(m\/)?(\d+'?\/)*\d+'?$/)}O.toJSON=()=>"BIP32 derivation path";function k(n){return(i.Buffer(n.publicKey)||typeof n.getPublicKey=="function")&&typeof n.sign=="function"}const b=21*1e14;function nn(n){return i.UInt53(n)&&n<=b}const en=i.quacksLike("Point"),tn=i.compile({messagePrefix:i.anyOf(i.Buffer,i.String),bip32:{public:i.UInt32,private:i.UInt32},pubKeyHash:i.UInt8,scriptHash:i.UInt8,wif:i.UInt8}),_=254;function m(n){return!n||!("output"in n)||!c.isBuffer(n.output)?!1:n.version!==void 0?(n.version&_)===n.version:!0}function A(n){return u(n)?n.length!==2?!1:n.every(e=>A(e)):m(n)}const rn=i.BufferN(32),on=i.BufferN(20),sn=i.BufferN(32),B=i.Number,u=i.Array,ln=i.Boolean,v=i.String,g=i.Buffer,R=i.Hex,cn=i.maybe,fn=i.tuple,T=i.UInt8,an=i.UInt32,un=i.Function,N=i.BufferN,hn=i.Null,dn=i.oneOf,gn=i.Nil,wn=i.anyOf,D=Object.freeze(Object.defineProperty({__proto__:null,Array:u,BIP32Path:O,Boolean:ln,Buffer:g,Buffer256bit:rn,BufferN:N,ECPoint:en,Function:un,Hash160bit:on,Hash256bit:sn,Hex:R,Network:tn,Nil:gn,Null:hn,Number:B,Satoshi:nn,Signer:k,String:v,TAPLEAF_VERSION_MASK:_,UInt31:Y,UInt32:an,UInt8:T,anyOf:wn,isPoint:I,isTapleaf:m,isTaptree:A,maybe:cn,oneOf:dn,stacksEqual:Q,tuple:fn,typeforce:i},Symbol.toStringTag,{value:"Module"})),{typeforce:pn}=D,x=c.alloc(1,0);function y(n){let e=0;for(;n[e]===0;)++e;return e===n.length?x:(n=n.slice(e),n[0]&128?c.concat([x,n],1+n.length):n)}function S(n){n[0]===0&&(n=n.slice(1));const e=c.alloc(32,0),t=Math.max(0,32-n.length);return n.copy(e,t),e}function En(n){const e=n.readUInt8(n.length-1),t=e&-129;if(t<=0||t>=4)throw new Error("Invalid hashType "+e);const r=K(n.slice(0,-1)),o=S(r.r),s=S(r.s);return{signature:c.concat([o,s],64),hashType:e}}function xn(n,e){pn({signature:N(64),hashType:T},{signature:n,hashType:e});const t=e&-129;if(t<=0||t>=4)throw new Error("Invalid hashType "+e);const r=c.allocUnsafe(1);r.writeUInt8(e,0);const o=y(n.slice(0,32)),s=y(n.slice(32,64));return c.concat([F(o,s),r])}const yn=Object.freeze(Object.defineProperty({__proto__:null,decode:En,encode:xn},Symbol.toStringTag,{value:"Module"})),{typeforce:a}=D,H=l.OP_RESERVED;function Sn(n){return B(n)&&(n===l.OP_0||n>=l.OP_1&&n<=l.OP_16||n===l.OP_1NEGATE)}function Pn(n){return g(n)||Sn(n)}function M(n){return u(n)&&n.every(Pn)}function h(n){if(n.length===0)return l.OP_0;if(n.length===1){if(n[0]>=1&&n[0]<=16)return H+n[0];if(n[0]===129)return l.OP_1NEGATE}}function z(n){return c.isBuffer(n)}function Un(n){return u(n)}function d(n){return c.isBuffer(n)}function $(n){if(z(n))return n;a(u,n);const e=n.reduce((o,s)=>d(s)?s.length===1&&h(s)!==void 0?o+1:o+P(s.length)+s.length:o+1,0),t=c.allocUnsafe(e);let r=0;if(n.forEach(o=>{if(d(o)){const s=h(o);if(s!==void 0){t.writeUInt8(s,r),r+=1;return}r+=V(t,o.length,r),o.copy(t,r),r+=o.length}else t.writeUInt8(o,r),r+=1}),r!==t.length)throw new Error("Could not decode chunks");return t}function w(n){if(Un(n))return n;a(g,n);const e=[];let t=0;for(;t<n.length;){const r=n[t];if(r>l.OP_0&&r<=l.OP_PUSHDATA4){const o=G(n,t);if(o===null||(t+=o.size,t+o.number>n.length))return null;const s=n.slice(t,t+o.number);t+=o.number;const f=h(s);f!==void 0?e.push(f):e.push(s)}else e.push(r),t+=1}return e}function In(n){return z(n)&&(n=w(n)),n.map(e=>{if(d(e)){const t=h(e);if(t===void 0)return e.toString("hex");e=t}return q[e]}).join(" ")}function On(n){return a(v,n),$(n.split(" ").map(e=>l[e]!==void 0?l[e]:(a(R,e),c.from(e,"hex"))))}function _n(n){return n=w(n),a(M,n),n.map(e=>d(e)?e:e===l.OP_0?c.allocUnsafe(0):U(e-H))}function mn(n){return I(n)}function j(n){const e=n&-129;return e>0&&e<4}function An(n){return!c.isBuffer(n)||!j(n[n.length-1])?!1:L(n.slice(0,-1))}const Bn=J,vn=yn,Hn=Object.freeze(Object.defineProperty({__proto__:null,OPS:l,compile:$,decompile:w,fromASM:On,isCanonicalPubKey:mn,isCanonicalScriptSignature:An,isDefinedHashType:j,isPushOnly:M,number:Bn,signature:vn,toASM:In,toStack:_n},Symbol.toStringTag,{value:"Module"}));export{g as B,on as H,hn as N,nn as S,_ as T,T as U,An as a,M as b,$ as c,w as d,m as e,A as f,D as g,fn as h,I as i,In as j,an as k,sn as l,cn as m,B as n,vn as o,mn as p,Hn as q,Q as s,_n as t};
