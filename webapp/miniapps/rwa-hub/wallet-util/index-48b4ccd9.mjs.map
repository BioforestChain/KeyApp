{"version":3,"file":"index-48b4ccd9.mjs","sources":["../../dist/lib/bip39/crypto.mjs","../../dist/lib/bip39/index.mjs"],"sourcesContent":["import * as crypto from '../hash-wasm/pbkdf2.mjs';\nimport { createSHA256Sync } from '../hash-wasm/sha256.mjs';\nimport { createSHA512, createSHA512Sync } from '../hash-wasm/sha512.mjs';\nimport { Buffer } from '../buffer.mjs';\nexport const pbkdf2Sync = (password, salt, iterations, hashLength, _hash) => {\n    const buf = crypto.pbkdf2Sync({\n        hashFunction: createSHA512Sync(),\n        password,\n        salt,\n        iterations,\n        hashLength,\n        outputType: 'binary',\n    });\n    return Buffer.from(buf);\n};\nexport const pbkdf2 = async (password, salt, iterations, hashLength, _hash) => {\n    const buf = await crypto.pbkdf2({\n        hashFunction: createSHA512(),\n        password,\n        salt,\n        iterations,\n        hashLength,\n        outputType: 'binary',\n    });\n    return Buffer.from(buf);\n};\nexport const sha256 = (data) => {\n    return createSHA256Sync().update(data).digest();\n};\n//# sourceMappingURL=crypto.mjs.map","// import * as createHash from 'create-hash';\n// import { pbkdf2, pbkdf2Sync } from 'pbkdf2';\nimport { pbkdf2, pbkdf2Sync, sha256 } from './crypto.mjs';\nimport { randomBytes } from '../crypto.mjs';\nimport { Buffer } from '../buffer.mjs';\nimport { getDefaultWordlist } from './wordlists.mjs';\nconst INVALID_MNEMONIC = 'Invalid mnemonic';\nconst INVALID_ENTROPY = 'Invalid entropy';\nconst INVALID_CHECKSUM = 'Invalid mnemonic checksum';\nconst WORDLIST_REQUIRED = 'A wordlist is required but a default could not be found.\\n' +\n    'Please pass a 2048 word array explicitly.';\nexport function normalize(str) {\n    return (str || '').normalize('NFKD');\n}\nfunction binaryToByte(bin) {\n    return parseInt(bin, 2);\n}\nfunction bytesToBinary(bytes) {\n    let binary = '';\n    for (let i = 0; i < bytes.length; i++) {\n        const byte = bytes[i];\n        binary += byte.toString(2).padStart(8, '0');\n    }\n    return binary;\n}\nfunction deriveChecksumBits(entropyBuffer) {\n    const ENT = entropyBuffer.length * 8;\n    const CS = ENT / 32;\n    const hash = sha256(entropyBuffer);\n    return bytesToBinary(hash).slice(0, CS);\n}\nfunction salt(password) {\n    return 'mnemonic' + (password || '');\n}\nexport function mnemonicToSeedSync(mnemonic, password) {\n    const mnemonicBuffer = Buffer.from(normalize(mnemonic), 'utf8');\n    const saltBuffer = Buffer.from(salt(normalize(password)), 'utf8');\n    return pbkdf2Sync(mnemonicBuffer, saltBuffer, 2048, 64, 'sha512');\n}\nexport function mnemonicToSeed(mnemonic, password) {\n    const mnemonicBuffer = Buffer.from(normalize(mnemonic), 'utf8');\n    const saltBuffer = Buffer.from(salt(normalize(password)), 'utf8');\n    return pbkdf2(mnemonicBuffer, saltBuffer, 2048, 64, 'sha512');\n}\nexport function mnemonicToEntropy(mnemonic, wordlist) {\n    wordlist = wordlist || getDefaultWordlist()?.wordlist;\n    if (!wordlist) {\n        throw new Error(WORDLIST_REQUIRED);\n    }\n    const words = normalize(mnemonic).split(' ');\n    if (words.length % 3 !== 0) {\n        throw new Error(INVALID_MNEMONIC);\n    }\n    // convert word indices to 11 bit binary strings\n    const bits = words\n        .map((word) => {\n        const index = wordlist.indexOf(word);\n        if (index === -1) {\n            throw new Error(INVALID_MNEMONIC);\n        }\n        return index.toString(2).padStart(11, '0');\n    })\n        .join('');\n    // split the binary string into ENT/CS\n    const dividerIndex = Math.floor(bits.length / 33) * 32;\n    const entropyBits = bits.slice(0, dividerIndex);\n    const checksumBits = bits.slice(dividerIndex);\n    // calculate the checksum and compare\n    const entropyBytes = entropyBits.match(/(.{1,8})/g).map(binaryToByte);\n    if (entropyBytes.length < 16) {\n        throw new Error(INVALID_ENTROPY);\n    }\n    // if (entropyBytes.length > 32) {\n    //   throw new Error(INVALID_ENTROPY);\n    // }\n    if (entropyBytes.length % 4 !== 0) {\n        throw new Error(INVALID_ENTROPY);\n    }\n    const entropy = Buffer.from(entropyBytes);\n    const newChecksum = deriveChecksumBits(entropy);\n    if (newChecksum !== checksumBits) {\n        throw new Error(INVALID_CHECKSUM);\n    }\n    return entropy.toString('hex');\n}\nexport function entropyToMnemonic(entropy, wordlist) {\n    if (!Buffer.isBuffer(entropy)) {\n        entropy = Buffer.from(entropy, 'hex');\n    }\n    wordlist = wordlist || getDefaultWordlist()?.wordlist;\n    if (!wordlist) {\n        throw new Error(WORDLIST_REQUIRED);\n    }\n    // 128 <= ENT <= 256\n    if (entropy.length < 16) {\n        throw new TypeError(INVALID_ENTROPY);\n    }\n    // if (entropy.length > 32) {\n    //   throw new TypeError(INVALID_ENTROPY);\n    // }\n    if (entropy.length % 4 !== 0) {\n        throw new TypeError(INVALID_ENTROPY);\n    }\n    const entropyBits = bytesToBinary(Array.from(entropy));\n    const checksumBits = deriveChecksumBits(entropy);\n    const bits = entropyBits + checksumBits;\n    const chunks = bits.match(/(.{1,11})/g);\n    const words = chunks.map((binary) => {\n        const index = binaryToByte(binary);\n        return wordlist[index];\n    });\n    return wordlist[0] === '\\u3042\\u3044\\u3053\\u304f\\u3057\\u3093' // Japanese wordlist\n        ? words.join('\\u3000')\n        : words.join(' ');\n}\nexport function generateMnemonic(strength, rng = randomBytes, wordlist) {\n    strength = strength || 128;\n    if (strength % 32 !== 0) {\n        throw new TypeError(INVALID_ENTROPY);\n    }\n    return entropyToMnemonic(Buffer.from(rng(strength / 8)), wordlist);\n}\nexport function validateMnemonic(mnemonic, wordlist) {\n    try {\n        mnemonicToEntropy(mnemonic, wordlist);\n    }\n    catch (e) {\n        return false;\n    }\n    return true;\n}\n//# sourceMappingURL=index.mjs.map"],"names":["crypto.pbkdf2Sync","crypto.pbkdf2"],"mappings":"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"}