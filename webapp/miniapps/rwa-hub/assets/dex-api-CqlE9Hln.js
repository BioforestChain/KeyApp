import{Q as D,R as P,T as H,U as _,V as O,W as j,X as C,Y as B,$,_ as f,o as a,k as r,s as e,n as t,q as A,r as L,p as U,f as k,S as F,g as q,a0 as G,a as K,c as V}from"./page-BOxexyJV.js";import{L as X,f as N,T as Y,t as J,M as I,d as Q,N as Z}from"./index-Dk9SKzm0.js";const ee=({url:n,onError:s,headers:l,disableBatch:d,loggerColor:c=typeof process=="object"&&Array.isArray(process.argv)&&process.argv.includes("--no-color")})=>D({links:[P({colorMode:c===!1?"none":void 0}),...s?[H({retry(o){return s&&s(X(o,"op","error")),!1}})]:[],_({condition:o=>o.type==="subscription",true:$({url:n,eventSourceOptions:()=>({withCredentials:!0,headers:{}}),transformer:B}),false:_({condition:o=>C(o.input)||d===!0,true:j({url:n,headers:l?async o=>l(o.op):void 0,fetch:(o,T)=>fetch(new Request(o,{credentials:"include",...T})),transformer:{deserialize:B.deserialize,serialize(o){return C(o)?o:B.serialize(o)}}}),false:O({url:n,headers:l?async o=>l(o.opList):void 0,fetch:(o,T)=>fetch(new Request(o,{credentials:"include",...T})),transformer:B})})})]}),te=N.toast;await N.loadModule(Y);const ae=async(n,s={open:!0,autoDestroy:!0})=>{const l=te.create({text:n,position:s.position||"bottom",closeTimeout:s.closeTimeout||2e3,cssClass:s.cssClass||"!bg-primary"});s.autoDestroy&&l.once("closed",()=>{l.destroy()});let d;return l.on("open",()=>{d?.reject("open"),d=Promise.withResolvers()}),l.on("closed",()=>{d?.resolve(),d=void 0}),s.open&&l.open(),J(l,{get closed(){return d?.promise}})},i=f(["Tron","Ethereum","Binance","BIWMeta","Malibu","BFMeta"]),u=f(["TRON","ETH","BSC","BIWMETA","BFMCHAIN","BFMCHAIN"]);i.enum.BIWMeta,i.enum.Malibu,i.enum.BFMeta,u.enum.BIWMETA,u.enum.BFMCHAIN,u.enum.BFMCHAIN;u.enum.BIWMETA+"",i.enum.BIWMeta,u.enum.BFMCHAIN+"",i.enum.BFMeta,u.enum.ETH+"",i.enum.Ethereum,u.enum.BSC+"",i.enum.Binance,u.enum.TRON+"",i.enum.Tron;const Me={[i.enum.BIWMeta]:u.enum.BIWMETA,[i.enum.BFMeta]:u.enum.BFMCHAIN,[i.enum.Malibu]:u.enum.BFMCHAIN,[i.enum.Ethereum]:u.enum.ETH,[i.enum.Binance]:u.enum.BSC,[i.enum.Tron]:u.enum.TRON};a({uid:e(),superiorId:e(),beforeSuperiorIdList:A(a({superiorId:e(),time:t()})).optional(),address:e(),addressList:A(a({chainName:i,address:e()})),nickname:e(),mobile:e().optional(),level:t(),exp:t(),createTime:t(),token:e(),freeze:r().optional()});a({level:t(),exp:t()}).array();const re=a({assetId:e(),priority:t().int(),configs:L(e(),U()).default({})});a({enableLevelUpCompositeDeduction:r(),priorityList:A(re)});a({manualPaymentPendingMs:t().int().nonnegative()});a({promoted:r(),withdrawal:r(),signInRewardEnabled:r(),newUserRewardEnabled:r(),withdrawalAMGTDestory:r(),withdrawalByAMGTFromUSDT:r(),withdrawalAddAMGTFromUSDT:r(),withdrawalByAMGTFromBIW:r(),withdrawalAddAMGTFromBIW:r(),withdrawalBIWDestory:r(),withdrawalMLBDestory:r(),withdrawalByMLBFromUSDT:r(),withdrawalAddMLBFromUSDT:r(),withdrawalDEXTDestory:r(),withdrawalByDEXTFromUSDT:r(),withdrawalAddDEXTFromUSDT:r()});a({ratio:e().array().length(2),mini:t(),usdt2biw:e().array().length(2),usdt2amgt:e().array().length(2),usdt2mlb:e().array().length(2),usdt2dext:e().array().length(2),allowAutoUpdate:r(),autoUpdateThrottle:t(),lastAutoUpdateTime:t(),withdrawalLimit:A(t().array().length(2))});const ne=a({usdt2tron:e().array().length(2),usdt2bsc:e().array().length(2),usdt2eth:e().array().length(2),usdt2biw:e().array().length(2),usdt2mlb:e().array().length(2),usdt2dext:e().array().length(2),usdt2amgt:e().array().length(2),usdt2biw_usdt:e().array().length(2),usdt2mlb_usdt:e().array().length(2),allowAutoUpdate:r(),autoUpdateThrottle:t(),lastAutoUpdateTime:t()}),se=a({maxRelationshipLevel:t(),chainName:i,assetType:e(),token:e(),endpoint:e(),amountExpression:e(),matchs:L(e(),a({exp:e(),with:e(),result:e()}).array())});se.array();a({relationshipLevel:t(),toLevel:t(),targetLevel:t()});const oe=f(["airdrop-freeze"]);a({title:e(),type:oe,enabled:r(),unfreezeEnabled:r(),rewards:A(a({chain:i,assetType:e(),amount:e()}))});const ie=a({type:f(["success","error","warn","info"]),text:e(),time:t()}),le=a({toAddress:e(),fromAddress:e(),amount:e(),timestamp:t(),trsInfo:a({chain:u,info:k([a({contractAddress:e(),trs:U()}),a({assetType:e(),trs:U()})])}),trsId:e()}),ue=f(["idle","awaiting-payment","processing-deduction","succeeded","failed"]);a({tid:e(),fromUid:e(),toUid:e(),toLevel:t(),reqExp:t(),gotExp:t(),logs:ie.array(),exchangeConfigSnapshot:ne.omit({allowAutoUpdate:!0,autoUpdateThrottle:!0,lastAutoUpdateTime:!0}),pendingUntil:t().optional(),status:ue.default("idle"),transactions:le.array(),deductionAssetInfo:a({assetType:e(),chainName:i}).optional()});const z=f(["manual","fixed"]);a({id:e().uuid(),chain_name:i,asset_type:e().min(1),ratio_to_usdt:e().regex(/^\d+:\d+$/,"æ¯”ä¾‹æ ¼å¼å¿…é¡»ä¸º 'number:number'"),decimal:t().int().min(0).default(8),source:z,enabled:r().default(!0),remark:e().optional(),updated_at:t(),updated_by:e().optional()});a({id:e().uuid().optional(),chain_name:i,asset_type:e().min(1),ratio_to_usdt:e().regex(/^\d+:\d+$/,"æ¯”ä¾‹æ ¼å¼å¿…é¡»ä¸º 'number:number'"),decimal:t().int().min(0).default(8),source:z,enabled:r().default(!0),remark:e().optional()});const de=async(n,s,l={})=>{const{transformer:d=JSON,storage:c=localStorage}=l,o=typeof s=="function"?s:()=>s,T=await(async()=>{let v,w=await c.getItem(n);if(w)try{v=d.parse(w)}catch(S){console.warn("useInfo_json parse error:",S,w)}let y;v==null?(y=o(),c.setItem(n,d.stringify(y))):y=v;let M=!1;return new Proxy(y,{get:function(S,b){return Reflect.get(y,b)},set:function(S,b,W){return Reflect.set(y,b,W),M===!1&&(M=!0,queueMicrotask(()=>{d.stringify(y)!==w&&h.emit(y),M=!1})),!0}})})(),h=new F(T);return h.on(v=>{const w=d.stringify(v);return w===void 0||w==="null"?c.removeItem(n):c.setItem(n,w)}),h},p=f(["Tron","Ethereum","Binance","BIWMeta"]),g=f(["TRON","ETH","BSC","BIWMETA"]);g.enum.BIWMETA+"",p.enum.BIWMeta,g.enum.ETH+"",p.enum.Ethereum,g.enum.BSC+"",p.enum.Binance,g.enum.TRON+"",p.enum.Tron;p.enum.BIWMeta+"",g.enum.BIWMETA,p.enum.Ethereum+"",g.enum.ETH,p.enum.Binance+"",g.enum.BSC,p.enum.Tron+"",g.enum.TRON;a({uid:e(),superiorId:e(),address:e(),addressList:A(a({chainName:p,address:e()})),nickname:e(),mobile:e().optional(),level:t(),exp:t(),createTime:t(),token:e(),freeze:r().optional()});a({level:t(),exp:t()}).array();a({promoted:r(),withdrawal:r(),withdrawalAMGTDestory:r(),withdrawalByAMGTFromUSDT:r(),withdrawalAddAMGTFromUSDT:r(),withdrawalByAMGTFromBIW:r(),withdrawalAddAMGTFromBIW:r(),withdrawalBIWDestory:r()});a({ratio:e().array().length(2),mini:t(),usdt2biw:e().array().length(2),usdt2amgt:e().array().length(2),allowAutoUpdate:r(),autoUpdateThrottle:t(),lastAutoUpdateTime:t()});const ce=a({usdt2tron:e().array().length(2),usdt2bsc:e().array().length(2),usdt2eth:e().array().length(2),usdt2biw:e().array().length(2),usdt2amgt:e().array().length(2),usdt2biw_usdt:e().array().length(2),allowAutoUpdate:r(),autoUpdateThrottle:t(),lastAutoUpdateTime:t()}),me=a({maxRelationshipLevel:t(),chainName:p,assetType:e(),token:e(),endpoint:e(),amountExpression:e(),matchs:L(e(),a({exp:e(),with:e(),result:e()}).array())});me.array();a({relationshipLevel:t(),toLevel:t(),targetLevel:t()});const pe=a({type:f(["success","error","warn","info"]),text:e(),time:t()}),ge=a({toAddress:e(),fromAddress:e(),amount:e(),timestamp:t(),trsInfo:a({chain:g,info:k([a({contractAddress:e(),trs:U()}),a({assetType:e(),trs:U()})])}),trsId:e()});a({tid:e(),fromUid:e(),toUid:e(),toLevel:t(),reqExp:t(),gotExp:t(),logs:pe.array(),exchangeConfigSnapshot:ce.omit({allowAutoUpdate:!0,autoUpdateThrottle:!0,lastAutoUpdateTime:!0}),transactions:ge.array()});const fe=I(),Se=I(),be=I(),Le=I(),xe=I(),he=I(),_e=I(),R="ðŸ‘¨â€ðŸ‘©â€ðŸ‘¦â€ðŸ‘¦appUserInfo",we="ðŸ‘¨â€ðŸ‘©â€ðŸ‘¦â€ðŸ‘¦appUserMain",x="ðŸ‘¨â€ðŸ‘©â€ðŸ‘¦â€ðŸ‘¦external_user_id",m=await de(R,()=>({uid:"",superiorId:"",address:"",addressList:[],nickname:"",mobile:"",level:0,exp:0,createTime:0,token:"",rwaExp:"0"})),ye=async n=>{if(n==m.value.uid){const s=await E.user.getUserInfo.query(),l=await q().trpcClient.profile.getProfileUseExp.query(Ie());if(s.level-1>=0){const c=(await E.user.getLevelUpTasks.query()).find(o=>o.toLevel==s.level);if(c){const o=c.logs.find(h=>h.type==="success"),T=c.logs.find(h=>h.type==="info"&&h.text=="upgrade confirmation");o&&!T&&(fe.emit(s.level),await E.user.addLogToLevelUp.mutate({tid:c.tid,type:"info",text:"upgrade confirmation"}))}}return console.log("get User",s),s?.uid==m.value.uid?(Object.assign(m.value,{...s,rwaExp:l}),localStorage.setItem(R,JSON.stringify(m.value)),m.emit(m.value),!0):!1}return!1};(async()=>{for(;;){await Q(3e4);const n=m.value;n.uid&&await ye(n.uid)}})();const Te=new F({expired:!1}),Ie=()=>localStorage.getItem(x)||"",Ce=n=>(localStorage.setItem(x,n),n),ke=()=>{localStorage.removeItem("rwa-app-token"),localStorage.removeItem(we),localStorage.removeItem(x),G(),m.value={uid:"",superiorId:"",createTime:0,address:"",addressList:[],nickname:"",mobile:"",level:0,exp:0,token:""},m.emit(m.value),he.emit(!0)},E=ee({url:new URL("trpc","https://inviteapi.bfmeta.info/").href,headers:()=>{const n=localStorage.getItem("rwa-app-token");return n?{Authorization:`Bearer ${n}`}:{}},onError(n){if(n.error?.message||n.error.shape?.message){const s=n.error?.message||n.error.shape?.message;s==="ç™»å½•å·²è¿‡æœŸ"&&(Te.value={expired:!0}),s&&ae(s)}}}),Ae=Z(()=>E.login.signcodePublicKey.query()),Fe=async n=>{const s=K.from(`${Date.now()}`),l=await Ae();return await V.signUtil.asymmetricEncrypt(s,l,n)};export{we as S,Ie as a,m as b,ke as c,E as d,he as e,Se as f,Fe as g,Me as h,_e as i,Le as j,be as k,Te as l,xe as m,fe as o,Ce as s,ae as t,ye as u,i as z};
