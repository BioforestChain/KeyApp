import{b as fn}from"./bioforestChainBundle-C9za-Hm3.js";const un=globalThis.indexedDB?.cmp??function(t,i){const r=Math.min(t.length,i.length);for(let f=0;f<r;++f)if(t[f]!==i[f])return t[f]<i[f]?-1:1;return t.length===i.length?0:t.length>i.length?1:-1},V=0,Z=1,$=2,z=3,N=4,j=5,q=6,J=7,sn={[V.toString()]:"Expected Private",[Z.toString()]:"Expected Point",[$.toString()]:"Expected Tweak",[z.toString()]:"Expected Hash",[N.toString()]:"Expected Signature",[j.toString()]:"Expected Extra Data (32 bytes)",[q.toString()]:"Expected Parity (1 | 0)",[J.toString()]:"Bad Recovery Id"};function _(n){const t=sn[n.toString()]||`Unknow error code: ${n}`;throw new TypeError(t)}const O=32,g=33,h=65,E=32,k=32,Q=32,nn=32,b=64,tn=new Uint8Array(32),v=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65]),an=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,69,81,35,25,80,183,95,196,64,45,161,114,47,201,186,238]);function y(n){return n instanceof Uint8Array}function A(n,t){for(let i=0;i<32;++i)if(n[i]!==t[i])return n[i]<t[i]?-1:1;return 0}function W(n){return A(n,tn)===0}function en(n){return y(n)&&n.length===O&&A(n,tn)>0&&A(n,v)<0}function cn(n){return y(n)&&(n.length===g||n.length===h||n.length===E)}function ln(n){return y(n)&&n.length===E}function _n(n){return y(n)&&(n.length===g||n.length===h)}function Pn(n){return y(n)&&n.length===g}function yn(n){return y(n)&&n.length===k&&A(n,v)<0}function En(n){return y(n)&&n.length===Q}function Tn(n){return n===void 0||y(n)&&n.length===nn}function An(n){return y(n)&&n.length===64&&A(n.subarray(0,32),v)<0&&A(n.subarray(32,64),v)<0}function Sn(n){return y(n)&&n.length===64&&A(n.subarray(0,32),an)<0}function In(n){n!==0&&n!==1&&_(q)}function T(n){en(n)||_(V)}function S(n){cn(n)||_(Z)}function B(n){ln(n)||_(Z)}function d(n){yn(n)||_($)}function R(n){En(n)||_(z)}function w(n){Tn(n)||_(j)}function F(n){An(n)||_(N)}function dn(n){n()||_(N)}function Rn(n){W(n.subarray(0,32))&&_(N),W(n.subarray(32,64))&&_(N)}function Un(n){Sn(n)||_(J)}let e,P,C,Y,m,K,L,x,D,M,p,o,l,X,u,H,s,a,I,c;const Nn=fn(n=>{e=n,P=new Uint8Array(e.memory.buffer),C=e.PRIVATE_INPUT.value,Y=e.PUBLIC_KEY_INPUT.value,m=e.PUBLIC_KEY_INPUT2.value,K=e.X_ONLY_PUBLIC_KEY_INPUT.value,L=e.X_ONLY_PUBLIC_KEY_INPUT2.value,x=e.TWEAK_INPUT.value,D=e.HASH_INPUT.value,M=e.EXTRA_DATA_INPUT.value,p=e.SIGNATURE_INPUT.value,o=P.subarray(C,C+O),l=P.subarray(Y,Y+h),X=P.subarray(m,m+h),u=P.subarray(K,K+E),H=P.subarray(L,L+E),s=P.subarray(x,x+k),a=P.subarray(D,D+Q),I=P.subarray(M,M+nn),c=P.subarray(p,p+b)});function U(n,t){return n===void 0?t!==void 0?t.length:g:n?g:h}function G(n){try{return l.set(n),e.isPoint(n.length)===1}finally{l.fill(0)}}function gn(){e.initializeContext()}function hn(n){return _n(n)&&G(n)}function On(n){return Pn(n)&&G(n)}function rn(n){return ln(n)&&G(n)}function vn(n){return en(n)}function Bn(n,t,i){S(n),S(t);const r=U(i,n);try{return l.set(n),X.set(t),e.pointAdd(n.length,t.length,r)===1?l.slice(0,r):null}finally{l.fill(0),X.fill(0)}}function bn(n,t,i){S(n),d(t);const r=U(i,n);try{return l.set(n),s.set(t),e.pointAddScalar(n.length,r)===1?l.slice(0,r):null}finally{l.fill(0),s.fill(0)}}function Cn(n,t){S(n);const i=U(t,n);try{return l.set(n),e.pointCompress(n.length,i),l.slice(0,i)}finally{l.fill(0)}}function Yn(n,t){T(n);const i=U(t);try{return o.set(n),e.pointFromScalar(i)===1?l.slice(0,i):null}finally{o.fill(0),l.fill(0)}}function mn(n){T(n);try{return o.set(n),e.xOnlyPointFromScalar(),u.slice(0,E)}finally{o.fill(0),u.fill(0)}}function Kn(n){S(n);try{return l.set(n),e.xOnlyPointFromPoint(n.length),u.slice(0,E)}finally{l.fill(0),u.fill(0)}}function Ln(n,t,i){S(n),d(t);const r=U(i,n);try{return l.set(n),s.set(t),e.pointMultiply(n.length,r)===1?l.slice(0,r):null}finally{l.fill(0),s.fill(0)}}function xn(n,t){T(n),d(t);try{return o.set(n),s.set(t),e.privateAdd()===1?o.slice(0,O):null}finally{o.fill(0),s.fill(0)}}function Dn(n,t){if(T(n),d(t),W(t))return new Uint8Array(n);try{return o.set(n),s.set(t),e.privateSub()===1?o.slice(0,O):null}finally{o.fill(0),s.fill(0)}}function Mn(n){T(n);try{return o.set(n),e.privateNegate(),o.slice(0,O)}finally{o.fill(0)}}function pn(n,t){B(n),d(t);try{u.set(n),s.set(t);const i=e.xOnlyPointAddTweak();return i!==-1?{parity:i,xOnlyPubkey:u.slice(0,E)}:null}finally{u.fill(0),s.fill(0)}}function Wn(n,t,i,r){B(n),B(i),d(t);const f=r!==void 0;f&&In(r);try{if(u.set(n),H.set(i),s.set(t),f)return e.xOnlyPointAddTweakCheck(r)===1;{e.xOnlyPointAddTweak();const on=u.slice(0,E);return un(on,i)===0}}finally{u.fill(0),H.fill(0),s.fill(0)}}function Xn(n,t,i){R(n),T(t),w(i);try{return a.set(n),o.set(t),i!==void 0&&I.set(i),e.sign(i===void 0?0:1),c.slice(0,b)}finally{a.fill(0),o.fill(0),i!==void 0&&I.fill(0),c.fill(0)}}function Hn(n,t,i){R(n),T(t),w(i);try{a.set(n),o.set(t),i!==void 0&&I.set(i);const r=e.signRecoverable(i===void 0?0:1);return{signature:c.slice(0,b),recoveryId:r}}finally{a.fill(0),o.fill(0),i!==void 0&&I.fill(0),c.fill(0)}}function Zn(n,t,i){R(n),T(t),w(i);try{return a.set(n),o.set(t),i!==void 0&&I.set(i),e.signSchnorr(i===void 0?0:1),c.slice(0,b)}finally{a.fill(0),o.fill(0),i!==void 0&&I.fill(0),c.fill(0)}}function wn(n,t,i,r=!1){R(n),S(t),F(i);try{return a.set(n),l.set(t),c.set(i),e.verify(t.length,r===!0?1:0)===1}finally{a.fill(0),l.fill(0),c.fill(0)}}function Fn(n,t,i,r=!1){R(n),F(t),Rn(t),i&2&&Un(t),dn(()=>rn(t.subarray(0,32)));const f=U(r);try{return a.set(n),c.set(t),e.recover(f,i)===1?l.slice(0,f):null}finally{a.fill(0),c.fill(0),l.fill(0)}}function Gn(n,t,i){R(n),B(t),F(i);try{return a.set(n),u.set(t),c.set(i),e.verifySchnorr()===1}finally{a.fill(0),u.fill(0),c.fill(0)}}const $n=Object.freeze(Object.defineProperty({__proto__:null,__initializeContext:gn,init:Nn,isPoint:hn,isPointCompressed:On,isPrivate:vn,isXOnlyPoint:rn,pointAdd:Bn,pointAddScalar:bn,pointCompress:Cn,pointFromScalar:Yn,pointMultiply:Ln,privateAdd:xn,privateNegate:Mn,privateSub:Dn,recover:Fn,sign:Xn,signRecoverable:Hn,signSchnorr:Zn,verify:wn,verifySchnorr:Gn,xOnlyPointAddTweak:pn,xOnlyPointAddTweakCheck:Wn,xOnlyPointFromPoint:Kn,xOnlyPointFromScalar:mn},Symbol.toStringTag,{value:"Module"}));export{$n as a,Nn as i,Cn as p,_ as t};
