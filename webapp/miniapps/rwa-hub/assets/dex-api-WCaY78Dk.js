import{Q as D,R as P,T as O,U as _,V as H,W as q,X as j,Y as C,$ as U,a0 as $,_ as g,o as a,k as r,s as e,n as t,q as A,r as L,p as B,f as k,S as R,g as G,a1 as K,a as V,c as X}from"./page-BnBmgj2e.js";import{L as Y,f as F,T as J,t as Q,M as I,d as Z,N as ee}from"./index-AshhoVut.js";const te=(()=>{if(typeof ReadableStream>"u"||typeof Request>"u")return!1;try{const n=new ReadableStream({start(s){s.close()}});return new Request("/",{body:n,method:"POST",duplex:"half"}).body!==null}catch{return!1}})(),ae=({url:n,onError:s,headers:l,disableBatch:d,loggerColor:c=typeof process=="object"&&Array.isArray(process.argv)&&process.argv.includes("--no-color")})=>D({links:[P({colorMode:c===!1?"none":void 0}),...s?[O({retry(o){return s&&s(Y(o,"op","error")),!1}})]:[],_({condition:o=>o.type==="subscription",true:$({url:n,eventSourceOptions:()=>({withCredentials:!0,headers:{}}),transformer:U}),false:_({condition:o=>C(o.input)||d===!0,true:j({url:n,headers:l?async o=>l(o.op):void 0,fetch:(o,f)=>fetch(new Request(o,{credentials:"include",...f})),transformer:{deserialize:U.deserialize,serialize(o){return C(o)?o:U.serialize(o)}}}),false:te?H({url:n,headers:l?async o=>l(o.opList):void 0,fetch:(o,f)=>fetch(new Request(o,{credentials:"include",...f})),transformer:U}):q({url:n,headers:l?async o=>l(o.opList):void 0,fetch:(o,f)=>fetch(new Request(o,{credentials:"include",...f})),transformer:U})})})]}),re=F.toast;await F.loadModule(J);const ne=async(n,s={open:!0,autoDestroy:!0})=>{const l=re.create({text:n,position:s.position||"bottom",closeTimeout:s.closeTimeout||2e3,cssClass:s.cssClass||"!bg-primary"});s.autoDestroy&&l.once("closed",()=>{l.destroy()});let d;return l.on("open",()=>{d?.reject("open"),d=Promise.withResolvers()}),l.on("closed",()=>{d?.resolve(),d=void 0}),s.open&&l.open(),Q(l,{get closed(){return d?.promise}})},i=g(["Tron","Ethereum","Binance","BIWMeta","Malibu","BFMeta"]),u=g(["TRON","ETH","BSC","BIWMETA","BFMCHAIN","BFMCHAIN"]);i.enum.BIWMeta,i.enum.Malibu,i.enum.BFMeta,u.enum.BIWMETA,u.enum.BFMCHAIN,u.enum.BFMCHAIN;u.enum.BIWMETA+"",i.enum.BIWMeta,u.enum.BFMCHAIN+"",i.enum.BFMeta,u.enum.ETH+"",i.enum.Ethereum,u.enum.BSC+"",i.enum.Binance,u.enum.TRON+"",i.enum.Tron;const Me={[i.enum.BIWMeta]:u.enum.BIWMETA,[i.enum.BFMeta]:u.enum.BFMCHAIN,[i.enum.Malibu]:u.enum.BFMCHAIN,[i.enum.Ethereum]:u.enum.ETH,[i.enum.Binance]:u.enum.BSC,[i.enum.Tron]:u.enum.TRON};a({uid:e(),superiorId:e(),beforeSuperiorIdList:A(a({superiorId:e(),time:t()})).optional(),address:e(),addressList:A(a({chainName:i,address:e()})),nickname:e(),mobile:e().optional(),level:t(),exp:t(),createTime:t(),token:e(),freeze:r().optional()});a({level:t(),exp:t()}).array();const se=a({assetId:e(),priority:t().int(),configs:L(e(),B()).default({})});a({enableLevelUpCompositeDeduction:r(),priorityList:A(se)});a({manualPaymentPendingMs:t().int().nonnegative()});a({promoted:r(),withdrawal:r(),signInRewardEnabled:r(),newUserRewardEnabled:r(),withdrawalAMGTDestory:r(),withdrawalByAMGTFromUSDT:r(),withdrawalAddAMGTFromUSDT:r(),withdrawalByAMGTFromBIW:r(),withdrawalAddAMGTFromBIW:r(),withdrawalBIWDestory:r(),withdrawalMLBDestory:r(),withdrawalByMLBFromUSDT:r(),withdrawalAddMLBFromUSDT:r(),withdrawalDEXTDestory:r(),withdrawalByDEXTFromUSDT:r(),withdrawalAddDEXTFromUSDT:r()});a({ratio:e().array().length(2),mini:t(),usdt2biw:e().array().length(2),usdt2amgt:e().array().length(2),usdt2mlb:e().array().length(2),usdt2dext:e().array().length(2),allowAutoUpdate:r(),autoUpdateThrottle:t(),lastAutoUpdateTime:t(),withdrawalLimit:A(t().array().length(2))});const oe=a({usdt2tron:e().array().length(2),usdt2bsc:e().array().length(2),usdt2eth:e().array().length(2),usdt2biw:e().array().length(2),usdt2mlb:e().array().length(2),usdt2dext:e().array().length(2),usdt2amgt:e().array().length(2),usdt2biw_usdt:e().array().length(2),usdt2mlb_usdt:e().array().length(2),allowAutoUpdate:r(),autoUpdateThrottle:t(),lastAutoUpdateTime:t()}),ie=a({maxRelationshipLevel:t(),chainName:i,assetType:e(),token:e(),endpoint:e(),amountExpression:e(),matchs:L(e(),a({exp:e(),with:e(),result:e()}).array())});ie.array();a({relationshipLevel:t(),toLevel:t(),targetLevel:t()});const le=g(["airdrop-freeze"]);a({title:e(),type:le,enabled:r(),unfreezeEnabled:r(),rewards:A(a({chain:i,assetType:e(),amount:e()}))});const ue=a({type:g(["success","error","warn","info"]),text:e(),time:t()}),de=a({toAddress:e(),fromAddress:e(),amount:e(),timestamp:t(),trsInfo:a({chain:u,info:k([a({contractAddress:e(),trs:B()}),a({assetType:e(),trs:B()})])}),trsId:e()}),ce=g(["idle","awaiting-payment","processing-deduction","succeeded","failed"]);a({tid:e(),fromUid:e(),toUid:e(),toLevel:t(),reqExp:t(),gotExp:t(),logs:ue.array(),exchangeConfigSnapshot:oe.omit({allowAutoUpdate:!0,autoUpdateThrottle:!0,lastAutoUpdateTime:!0}),pendingUntil:t().optional(),status:ce.default("idle"),transactions:de.array(),deductionAssetInfo:a({assetType:e(),chainName:i}).optional()});const N=g(["manual","fixed"]);a({id:e().uuid(),chain_name:i,asset_type:e().min(1),ratio_to_usdt:e().regex(/^\d+:\d+$/,"æ¯”ä¾‹æ ¼å¼å¿…é¡»ä¸º 'number:number'"),decimal:t().int().min(0).default(8),source:N,enabled:r().default(!0),remark:e().optional(),updated_at:t(),updated_by:e().optional()});a({id:e().uuid().optional(),chain_name:i,asset_type:e().min(1),ratio_to_usdt:e().regex(/^\d+:\d+$/,"æ¯”ä¾‹æ ¼å¼å¿…é¡»ä¸º 'number:number'"),decimal:t().int().min(0).default(8),source:N,enabled:r().default(!0),remark:e().optional()});const me=async(n,s,l={})=>{const{transformer:d=JSON,storage:c=localStorage}=l,o=typeof s=="function"?s:()=>s,f=await(async()=>{let v,w=await c.getItem(n);if(w)try{v=d.parse(w)}catch(E){console.warn("useInfo_json parse error:",E,w)}let T;v==null?(T=o(),c.setItem(n,d.stringify(T))):T=v;let b=!1;return new Proxy(T,{get:function(E,M){return Reflect.get(T,M)},set:function(E,M,W){return Reflect.set(T,M,W),b===!1&&(b=!0,queueMicrotask(()=>{d.stringify(T)!==w&&y.emit(T),b=!1})),!0}})})(),y=new R(f);return y.on(v=>{const w=d.stringify(v);return w===void 0||w==="null"?c.removeItem(n):c.setItem(n,w)}),y},p=g(["Tron","Ethereum","Binance","BIWMeta"]),h=g(["TRON","ETH","BSC","BIWMETA"]);h.enum.BIWMETA+"",p.enum.BIWMeta,h.enum.ETH+"",p.enum.Ethereum,h.enum.BSC+"",p.enum.Binance,h.enum.TRON+"",p.enum.Tron;p.enum.BIWMeta+"",h.enum.BIWMETA,p.enum.Ethereum+"",h.enum.ETH,p.enum.Binance+"",h.enum.BSC,p.enum.Tron+"",h.enum.TRON;a({uid:e(),superiorId:e(),address:e(),addressList:A(a({chainName:p,address:e()})),nickname:e(),mobile:e().optional(),level:t(),exp:t(),createTime:t(),token:e(),freeze:r().optional()});a({level:t(),exp:t()}).array();a({promoted:r(),withdrawal:r(),withdrawalAMGTDestory:r(),withdrawalByAMGTFromUSDT:r(),withdrawalAddAMGTFromUSDT:r(),withdrawalByAMGTFromBIW:r(),withdrawalAddAMGTFromBIW:r(),withdrawalBIWDestory:r()});a({ratio:e().array().length(2),mini:t(),usdt2biw:e().array().length(2),usdt2amgt:e().array().length(2),allowAutoUpdate:r(),autoUpdateThrottle:t(),lastAutoUpdateTime:t()});const pe=a({usdt2tron:e().array().length(2),usdt2bsc:e().array().length(2),usdt2eth:e().array().length(2),usdt2biw:e().array().length(2),usdt2amgt:e().array().length(2),usdt2biw_usdt:e().array().length(2),allowAutoUpdate:r(),autoUpdateThrottle:t(),lastAutoUpdateTime:t()}),fe=a({maxRelationshipLevel:t(),chainName:p,assetType:e(),token:e(),endpoint:e(),amountExpression:e(),matchs:L(e(),a({exp:e(),with:e(),result:e()}).array())});fe.array();a({relationshipLevel:t(),toLevel:t(),targetLevel:t()});const he=a({type:g(["success","error","warn","info"]),text:e(),time:t()}),ge=a({toAddress:e(),fromAddress:e(),amount:e(),timestamp:t(),trsInfo:a({chain:h,info:k([a({contractAddress:e(),trs:B()}),a({assetType:e(),trs:B()})])}),trsId:e()});a({tid:e(),fromUid:e(),toUid:e(),toLevel:t(),reqExp:t(),gotExp:t(),logs:he.array(),exchangeConfigSnapshot:pe.omit({allowAutoUpdate:!0,autoUpdateThrottle:!0,lastAutoUpdateTime:!0}),transactions:ge.array()});const ye=I(),Le=I(),xe=I(),_e=I(),Ce=I(),we=I(),ke=I(),z="ðŸ‘¨â€ðŸ‘©â€ðŸ‘¦â€ðŸ‘¦appUserInfo",Te="ðŸ‘¨â€ðŸ‘©â€ðŸ‘¦â€ðŸ‘¦appUserMain",x="ðŸ‘¨â€ðŸ‘©â€ðŸ‘¦â€ðŸ‘¦external_user_id",m=await me(z,()=>({uid:"",superiorId:"",address:"",addressList:[],nickname:"",mobile:"",level:0,exp:0,createTime:0,token:"",rwaExp:"0"})),Ie=async n=>{if(n==m.value.uid){const s=await S.user.getUserInfo.query(),l=await G().trpcClient.profile.getProfileUseExp.query(ve());if(s.level-1>=0){const c=(await S.user.getLevelUpTasks.query()).find(o=>o.toLevel==s.level);if(c){const o=c.logs.find(y=>y.type==="success"),f=c.logs.find(y=>y.type==="info"&&y.text=="upgrade confirmation");o&&!f&&(ye.emit(s.level),await S.user.addLogToLevelUp.mutate({tid:c.tid,type:"info",text:"upgrade confirmation"}))}}return console.log("get User",s),s?.uid==m.value.uid?(Object.assign(m.value,{...s,rwaExp:l}),localStorage.setItem(z,JSON.stringify(m.value)),m.emit(m.value),!0):!1}return!1};(async()=>{for(;;){await Z(3e4);const n=m.value;n.uid&&await Ie(n.uid)}})();const Ae=new R({expired:!1}),ve=()=>localStorage.getItem(x)||"",Re=n=>(localStorage.setItem(x,n),n),Fe=()=>{localStorage.removeItem("rwa-app-token"),localStorage.removeItem(Te),localStorage.removeItem(x),K(),m.value={uid:"",superiorId:"",createTime:0,address:"",addressList:[],nickname:"",mobile:"",level:0,exp:0,token:""},m.emit(m.value),we.emit(!0)},S=ae({url:new URL("trpc","https://inviteapi.bfmeta.info/").href,headers:()=>{const n=localStorage.getItem("rwa-app-token");return n?{Authorization:`Bearer ${n}`}:{}},onError(n){if(n.error?.message||n.error.shape?.message){const s=n.error?.message||n.error.shape?.message;s==="ç™»å½•å·²è¿‡æœŸ"&&(Ae.value={expired:!0}),s&&ne(s)}}}),Ue=ee(()=>S.login.signcodePublicKey.query()),Ne=async n=>{const s=V.from(`${Date.now()}`),l=await Ue();return await X.signUtil.asymmetricEncrypt(s,l,n)};export{Te as S,ve as a,m as b,Fe as c,S as d,we as e,Le as f,Ne as g,Me as h,ke as i,_e as j,xe as k,Ae as l,Ce as m,ye as o,Re as s,ne as t,Ie as u,i as z};
