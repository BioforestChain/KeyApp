import{r as m,j as e,f as v,b as u}from"./index-15D1tlVU.js";import{N as L,g as _,a as q}from"./icon.component-DqZ9lCdm.js";import{L as p}from"./loading-page-data-CCKDne7Y.js";import{N as z}from"./no-data-CDzRffdr.js";import{C as J,A as O}from"./nilai-dialog-YTWh9anD.js";import{f as b,a as g}from"./asset-type-balance-BGw1Ilcq.js";import{f as E}from"./date-time-format-CBKMROy6.js";import{u as l}from"./use_easy_state-D4HEqK2h.js";import{B as U}from"./dialog-DgNFENJS.js";import{N as V}from"./navbar-DAOi6kaL.js";import{d as X,g as Y,P as ee}from"./page-BL_iZuG4.js";import{S as se,a as te}from"./subnavbar-Mkpp6rKn.js";import{u as W}from"./use_page_query_state-DR-eHdQu.js";import{u as ae}from"./use_refresh-BOPBhM6q.js";import{B as ie}from"./big-Dt19vo1Q.js";import"./actions-MKoW9Iiu.js";import{d as D}from"./dex-api-54xdAOHY.js";import{g as ne}from"./setting.page-DIHCe7FA.js";import"./preloader-DItl4yqJ.js";import"./messages-T-UDpzuG.js";import"./polyfills-BATEtbik.js";import"./pull-to-refresh-BMqB5p-4.js";import"./use_flow-CkeMNJ0N.js";import"./list-item-CsDeqkSQ.js";import"./list-C2Pi8W4W.js";import"./noop-ChEnm3CV.js";const y=o=>{const a=o?new Date(o):new Date;return new Intl.DateTimeFormat("zh-CN",{timeZone:"Asia/Shanghai",year:"numeric",month:"numeric",day:"numeric"}).formatToParts(a).filter(i=>i.type!="literal").map(i=>i.value).join("-")},Pe=X(o=>{const a=l("rwa"),[N,F]=m.useState(!1),d=l(!1),i=l(!1),h=ne(),w=m.useRef({el:null}),I=l(void 0),f=()=>{const s=new Date,t=s.getUTCHours(),c=s.getUTCMinutes();let n=t+8,G=c;n>=24&&(n-=24);const H=n*60+G;return H>=10&&H<=1410},x=l(!1),$=async()=>{try{v.preloader.show(),await D.user.dailyAttendance.query(),await T(!0)}finally{v.preloader.hide()}},T=async s=>{try{if(!s&&N)return;const t=await D.user.getDailyAttendanceInfo.query();t&&(I.value=t,x.value=y(t.last_checkin_date)==y(Date.now()))}finally{F(!0)}};m.useEffect(()=>{a.value==="rwa"?S(!1):T(!1)},[a.value]);const R=l(!1),A=l(void 0),r=l(!1),K=async()=>{try{v.preloader.show();const{hasMotivationAccelerate:s}=await k.trpcClient.motivation.dailyAttendance.query();await S(!0),s&&(i.value=s)}finally{v.preloader.hide()}},[M,Q]=m.useState(!1),S=async s=>{try{if(!s&&M)return;const t=await k.trpcClient.motivation.getDailyAttendanceInfo.query();t.signInfo&&(A.value=t.signInfo,r.value=y(t.signInfo.last_checkin_date)==y(Date.now())),t.hasMotivationAccelerate&&(R.value=!0)}finally{Q(!0)}},Z=ae(),k=Y(),P=async s=>{a.value!==s&&(w.current.el&&w.current.el.scrollTo({left:0,top:0,behavior:"smooth"}),a.value=s,await B[s].loadFirst(),Z())},C=()=>a.value==="rwa"?{bg:"rgb(255,169,40)",text:u.title,activeText:u.white}:{bg:u.active,text:u.title,activeText:u.white},B={rwa:W([],1,async(s,t)=>{const c=await k.trpcClient.motivation.dailyAttendanceRewardList.query({page:t,pageSize:20});s.push(...c.data);const n=s;return{content:n,nextPage:t+1,end:n.length>=c.total}}),paradise:W([],1,async(s,t)=>{const c=await D.user.dailyAttendanceRewardList.query({page:t,pageSize:20});s.push(...c.data);const n=s;return{content:n,nextPage:t+1,end:n.length>=c.total}})},j=B[a.value];return m.useEffect(()=>{j.loadFirst()},[]),e.jsxs(ee,{name:"daily-motivation",style:{"--f7-toolbar-bottom-height":"3.25rem"},ref:w,...j.f7PageInfiniteProps,children:[e.jsx(V,{title:"每日激励",backLink:!0,children:e.jsx(se,{className:"bg-white",children:e.jsx("div",{className:"w-full",children:e.jsxs(te,{strong:!0,style:{"--f7-segmented-strong-button-active-bg-color":C().bg,"--f7-segmented-strong-button-text-color":C().text,"--f7-segmented-strong-button-active-text-color":C().activeText},className:"w-full flex-shrink-0",children:[e.jsx(U,{active:a.value==="rwa",onClick:()=>P("rwa"),children:"RWA"}),e.jsx(U,{active:a.value==="paradise",onClick:()=>P("paradise"),children:"乐园"})]})})})}),e.jsx("div",{className:"min-h-full w-full p-4",style:{background:"linear-gradient(180deg,#DBC3FF 0%,#DBC4FF 0%,#F6F4FF 40%)"},children:a.value==="rwa"?e.jsx("div",{children:M?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 w-full rounded-2 bg-white py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"mr-1 pl-5 text-base font-bold text-title",children:e.jsx("div",{className:"ng-star-inserted",children:r.value?"今天已签到成功":"未签到"})}),e.jsxs("div",{onClick:()=>{o.safeF7Navigater.rwaMotivationDescribe()},className:"flex flex-shrink-0 items-center rounded-l-full bg-[rgb(255,169,40)] p-1 pl-2 text-xs text-white",children:[e.jsx("span",{children:"RWA签到说明"}),e.jsx(L,{name:"common-back",className:"flex rotate-180"})]})]}),e.jsx("div",{className:"mb-5 mt-4 w-full border-b-tiny border-dashed border-subtext"}),e.jsxs("div",{className:"mb-6 flex items-center justify-around",children:[e.jsxs("div",{className:"text-center text-sm text-subtext",children:[e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"text-lg font-bold text-title",children:A.value?.consecutive_checkins||0}),"/",e.jsx("span",{children:"天"})]}),e.jsx("div",{children:"连续签到"})]}),e.jsx("div",{className:"h-8 border-l-tiny border-solid border-subtext/60"}),e.jsxs("div",{className:"text-center text-sm text-subtext",children:[e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"text-lg font-bold text-title",children:A.value?.total_checkins||0}),"/",e.jsx("span",{children:"天"})]}),e.jsx("div",{children:"累计签到"})]})]}),!!R.value&&e.jsx("div",{className:"my-2 px-2 text-center text-xs text-primary",children:"签到后，将记录当前链上 快照作为“每日激励加速”销毁基准"}),e.jsxs("button",{onClick:()=>K(),disabled:!f()||r.value,className:`mx-auto my-0 block w-[58%] rounded-full bg-red !py-2 px-4 text-center text-base text-white ${f()?r.value&&"opacity-40":"opacity-40"}`,type:"button",children:[e.jsx("div",{className:"grid-in-[content] ng-tns-c210011865-165 z-[1] scale-100 opacity-100 duration-ios ease-ios-out",children:e.jsx("span",{className:"ng-star-inserted",children:r.value?"已签到":"签到"})}),e.jsx("div",{className:"grid-in-[content] ng-tns-c210011865-165 pointer-events-none z-[2] flex w-full scale-150 justify-center opacity-0 duration-ios ease-ios-out"})]}),e.jsx("div",{className:"pt-3 text-center text-xs text-red",children:"每日签到时间：00:10~23:30（香港时间）"})]}),e.jsxs("div",{className:"mb-4 flex items-center justify-between rounded-2 bg-white px-4 py-2",onClick:()=>o.safeF7Navigater.dailyMotivationAccelerateInfo({props:{hasRwaSignIn:!!r.value}}),children:[e.jsx("img",{src:"./images/icon_accelerate.webp",className:"ml-1 h-auto w-8"}),e.jsxs("div",{className:"flex items-center justify-end text-base font-bold text-title",children:["每日激励加速",e.jsx("img",{src:"./images/ico_settings_right.webp",className:"ml-1 h-auto w-2.5"})]})]}),e.jsx("div",{className:"flex items-center justify-between pb-3",children:e.jsx("div",{className:"flex items-center justify-start align-baseline",children:e.jsx("h2",{className:"text-2xl font-semibold",children:"RWA收益"})})}),e.jsx("div",{className:"mb-4 w-full rounded-2 bg-white p-4",children:j.render({loading:()=>e.jsx(p,{}),listEmpty:()=>e.jsx(z,{}),listItem:(s,t)=>e.jsx("div",{className:"mb-2",children:e.jsx("div",{className:"w-full rounded-2 bg-[#F6F6F8] p-2",children:e.jsxs("div",{className:"w-full p-1",children:[e.jsxs("div",{className:"mb-1 flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"relative mr-1",children:[e.jsx("img",{src:_(s.assetType,s.chain),alt:"",className:"h-5 w-5"}),e.jsx("img",{src:q(s.chain),alt:"",className:"absolute -bottom-0.5 -right-0.5 h-2.5 w-2.5"})]}),e.jsx("div",{children:s.assetType}),e.jsxs("div",{className:"text-xs text-title",children:["(",s.chain,")"]})]}),e.jsx("div",{children:E(s.createTime)})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("div",{children:"快照数量"}),e.jsxs("div",{className:"my-1 flex items-center justify-center text-primary",children:[" ",b(g(s.addressAmount,s.decimals,h))," ",e.jsx("span",{className:"text-title",children:"signInAssetType"in s&&s.signInAssetType})," "]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("div",{children:"激励加速"}),e.jsxs("div",{className:"my-1 flex items-center justify-center text-orange-500",children:[e.jsx("span",{children:"accelerateRatio"in s?String(ie(s.accelerateRatio||"0").mul(100)):"0"}),"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("div",{children:"奖励数量"}),e.jsxs("div",{className:"text-green-500 my-1 ml-0.5 flex items-center justify-center",children:["+",b(g(s.amount,s.decimals,h))," ",e.jsx("span",{className:"text-title",children:s.assetType})," "]})]})]})})},s.signInDate+t)})})]}):e.jsx(p,{color:"black"})}):e.jsx("div",{children:N?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 w-full rounded-2 bg-white py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"mr-1 pl-5 text-base font-bold text-title",children:e.jsx("div",{className:"ng-star-inserted",children:x.value?"今天已签到成功":"未签到"})}),e.jsxs("div",{onClick:()=>{d.value=!0},className:"flex flex-shrink-0 items-center rounded-l-full bg-primary p-1 pl-2 text-xs text-white",children:[e.jsxs("span",{children:[a.value==="paradise"?"乐园":"RWA","签到说明"]}),e.jsx(L,{name:"common-back",className:"flex rotate-180"})]})]}),e.jsx("div",{className:"mb-5 mt-4 w-full border-b-tiny border-dashed border-subtext"}),e.jsxs("div",{className:"mb-6 flex items-center justify-around",children:[e.jsxs("div",{className:"text-center text-sm text-subtext",children:[e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"text-lg font-bold text-title",children:I.value?.consecutive_checkins||0}),"/",e.jsx("span",{children:"天"})]}),e.jsx("div",{children:"连续签到"})]}),e.jsx("div",{className:"h-8 border-l-tiny border-solid border-subtext/60"}),e.jsxs("div",{className:"text-center text-sm text-subtext",children:[e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"text-lg font-bold text-title",children:I.value?.total_checkins||0}),"/",e.jsx("span",{children:"天"})]}),e.jsx("div",{children:"累计签到"})]})]}),e.jsxs("button",{onClick:()=>$(),disabled:!f()||x.value,className:`mx-auto my-0 block w-[58%] rounded-full bg-red !py-2 px-4 text-center text-base text-white ${f()?x.value&&"opacity-40":"opacity-40"}`,type:"button",children:[e.jsx("div",{className:"grid-in-[content] ng-tns-c210011865-165 z-[1] scale-100 opacity-100 duration-ios ease-ios-out",children:e.jsx("span",{className:"ng-star-inserted",children:x.value?"已签到":"签到"})}),e.jsx("div",{className:"grid-in-[content] ng-tns-c210011865-165 pointer-events-none z-[2] flex w-full scale-150 justify-center opacity-0 duration-ios ease-ios-out"})]}),e.jsx("div",{className:"pt-3 text-center text-xs text-red",children:"每日签到时间：00:10~23:30（香港时间）"})]}),e.jsx("div",{className:"flex items-center justify-between pb-3",children:e.jsx("div",{className:"flex items-center justify-start align-baseline",children:e.jsx("h2",{className:"text-2xl font-semibold",children:"乐园收益"})})}),e.jsx("div",{className:"mb-4 w-full rounded-2 bg-white p-4",children:j.render({loading:()=>e.jsx(p,{}),listEmpty:()=>e.jsx(z,{}),listItem:s=>e.jsx("div",{className:"mb-2",children:e.jsx("div",{className:"w-full rounded-2 bg-[#F6F6F8] p-2",children:e.jsxs("div",{className:"w-full p-1",children:[e.jsxs("div",{className:"mb-1 flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"relative mr-1",children:[e.jsx("img",{src:_(s.assetType,s.chain),alt:"",className:"h-5 w-5"}),e.jsx("img",{src:q(s.chain),alt:"",className:"absolute -bottom-0.5 -right-0.5 h-2.5 w-2.5"})]}),e.jsx("div",{children:s.assetType}),e.jsxs("div",{className:"text-xs text-title",children:["(",s.chain,")"]})]}),e.jsx("div",{children:E(s.createTime)})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("div",{children:"快照数量"}),e.jsxs("div",{className:"my-1 flex items-center justify-center text-primary",children:[" ",b(g(s.addressAmount,s.decimals,h))," "]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("div",{children:"奖励数量"}),e.jsxs("div",{className:"text-green-500 my-1 ml-0.5 flex items-center justify-center",children:["+",b(g(s.amount,s.decimals,h))," "]})]})]})})},s.signInDate)})})]}):e.jsx(p,{color:"black"})})}),e.jsx(J,{open:i.value,title:"每日激励加速",confirmText:"加速",cancelText:"取消",onRequireClose:()=>{i.value=!1},onCancelCallback:()=>{i.value=!1},onConfirmCallback:()=>{o.safeF7Navigater.dailyMotivationAccelerateInfo({props:{hasRwaSignIn:!!r.value}}),i.value=!1},children:e.jsx("div",{children:"您可前往“每日激励加速”，获得更多收益"})}),e.jsx(O,{open:d.value,title:"签到说明",confirmText:"确定",maxHeight:"max-h-[80%]",onRequireClose:()=>{d.value=!1},onConfirmCallback:()=>{d.value=!1},children:e.jsx("div",{className:"text-left text-sm",children:e.jsxs("ol",{children:[e.jsx("li",{className:"mb-3",children:e.jsx("p",{children:"1.每日签到时间：00:10~23:30（香港时间）"})}),e.jsx("li",{className:"mb-3",children:e.jsx("p",{children:"2.数据快照时间：23:30（香港时间）"})}),e.jsxs("li",{className:"mb-3",children:[e.jsx("p",{children:"3.每天到达快照时间段时，将获取当前签到的帐户地址所拥有的BFM数量链上数据快照，并向其空投奖励，空投数量为："}),e.jsx("p",{children:"持有BFM数量的0.03%"})]}),e.jsxs("li",{className:"mb-1",children:[e.jsx("p",{children:"4.例子："}),e.jsx("p",{children:"当前账户等级为Lv.2，在快照数据持有10000 BFM，可以获得： 10000 * 0.03% = 3 "})]})]})})})]})});export{Pe as default};
