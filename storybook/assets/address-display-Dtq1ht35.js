import{r as m,j as r}from"./iframe-Cctxta_P.js";import{c as b}from"./utils-CDN07tui.js";import{c as A}from"./web-DodBcwRj.js";import{u as S}from"./useTranslation-Cyi9axMr.js";import{I as M}from"./IconCheck-BUbIsnVA.js";import{I as W}from"./IconCopy-XrsQyI7S.js";let T=null,v=null;function w(e,t){return typeof document>"u"||(T||(T=document.createElement("canvas"),v=T.getContext("2d")),!v)?e.length*8:(v.font=t,v.measureText(e).width)}function R(e,t,i){if(w(e,i)<=t)return e;const p=w("...",i),h=t-p;if(h<=0)return"...";const s=w(e.charAt(0),i),l=Math.floor(h/s);let n,a;l<4*2?(n=Math.max(2,Math.floor(l/2)),a=Math.max(2,l-n)):(n=Math.ceil(l*.55),a=l-n);const o=e.length-a-1;return n=Math.min(n,o),n+a>=e.length?e:`${e.slice(0,n)}...${e.slice(-a)}`}function z(e,t,i){return e.length<=t+i+3?e:`${e.slice(0,t)}...${e.slice(-i)}`}function D({address:e,startChars:t,endChars:i,placeholder:d="---",copyable:f=!0,className:p,onCopy:h,testId:s}){const{t:l}=S("common"),[n,a]=m.useState(!1),[x,o]=m.useState(null),y=m.useRef(null),g=m.useCallback(()=>{const u=y.current;if(!u)return;if(!e){o(d);return}if(t!==void 0||i!==void 0){o(z(e,t??6,i??4));return}const c=getComputedStyle(u),N=`${c.fontSize} ${c.fontFamily}`,q=f?24:0,j=u.clientWidth-q;if(j<=0){o(e);return}const k=R(e,j,N);o(k)},[e,f,i,d,t]);m.useLayoutEffect(()=>{const u=y.current;if(!u)return;g();const c=new ResizeObserver(g);return c.observe(u),()=>c.disconnect()},[g]);const $=async()=>{try{await A.write({text:e}),a(!0),h?.(),setTimeout(()=>a(!1),2e3)}catch{console.error("Failed to copy address")}},C=x!==null;return f?r.jsxs("button",{ref:y,type:"button",onClick:$,...s&&{"data-testid":s},className:b("relative flex w-full items-center gap-1.5 font-mono text-sm transition-colors","hover:text-primary focus-visible:ring-ring rounded focus:outline-none focus-visible:ring-2",p),title:e,"aria-label":n?`已复制 ${e}`:`复制 ${e}`,children:[r.jsxs("span",{className:"relative min-w-0 flex-1",children:[r.jsx("span",{className:"invisible","aria-hidden":"true",children:"0"}),r.jsx("span",{...s&&{"data-testid":`${s}-text`},className:b("absolute inset-0 truncate",!C&&"invisible"),"aria-hidden":"true",children:x})]}),n?r.jsx(M,{className:"text-green-500 size-4 shrink-0","aria-hidden":"true"}):r.jsx(W,{className:"text-muted-foreground size-4 shrink-0","aria-hidden":"true"}),r.jsx("span",{role:"status","aria-live":"polite",className:"sr-only",children:n?l("copiedToClipboard"):""})]}):r.jsxs("span",{ref:y,...s&&{"data-testid":s},className:b("relative block font-mono text-sm",p),title:e,"aria-label":e,children:[r.jsx("span",{className:"invisible","aria-hidden":"true",children:"0"}),r.jsx("span",{...s&&{"data-testid":`${s}-text`},className:b("absolute inset-0 truncate",!C&&"invisible"),children:x})]})}D.__docgenInfo={description:"",methods:[],displayName:"AddressDisplay",props:{address:{required:!0,tsType:{name:"string"},description:""},startChars:{required:!1,tsType:{name:"union",raw:"number | undefined",elements:[{name:"number"},{name:"undefined"}]},description:""},endChars:{required:!1,tsType:{name:"union",raw:"number | undefined",elements:[{name:"number"},{name:"undefined"}]},description:""},placeholder:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"",defaultValue:{value:"'---'",computed:!1}},copyable:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"",defaultValue:{value:"true",computed:!1}},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},onCopy:{required:!1,tsType:{name:"union",raw:"(() => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},testId:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""}}};export{D as A};
