const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./snapdom-CO8q8LPW.js","./preload-helper-PPVm8Dsz.js","./index-DdArusCF.js","./iframe-DAf0Rw6h.js","./iframe-BnfMbOkf.css","./service-BWXDLSov.js","./schemas-CO8_C8zP.js","./index-D0E7N0oa.js","./derivation-cNkBwRV-.js","./amount-BQsqQYGO.js","./bioforest-BXwckqu6.js"])))=>i.map(i=>d[i]);
import{g as Vu,r as c,j as e,R as Ha,u as Ae,S as Ju,as as bo,at as qn,v as Ce,au as Xt,x as jo,av as Ku,y as Or}from"./iframe-DAf0Rw6h.js";import{a as Hn,c as R}from"./utils-4perknFd.js";import{u as No,d as ja,W as Gu}from"./useWalletTheme-Bd-rrJve.js";import{W as Qu,u as wo}from"./wallet-card-carousel-Cj7H20Ot.js";import{W as Co}from"./wallet-card-oHiw73Pq.js";import{B as J,c as Yu}from"./button-BADhSYs7.js";import{f as ge,d as hs,W as Js,g as xs,c as Ls,a as Ds,b as Ua,w as Le,e as Ks,u as Va,h as Xu,i as Zu,j as cs}from"./user-profile-B_Ho0wG7.js";import{c as lt,h as em,u as dt,b as He,j as Zt,d as Gs,e as Na,k as Ja,l as tm,m as sm,n as nm,o as am,f as rs,p as Qs,q as rm}from"./service-BWXDLSov.js";import{u as im,a as om,b as Et,c as Fe,d as Un,e as Je,f as Ka,g as ko,p as cm,T as lm}from"./TabBar-BTrmRsFK.js";import{s as Is}from"./index-D0E7N0oa.js";import{g as dm,v as So,R as um,I as mm,a as fm,b as pm,c as hm}from"./recover-wallet-form-L4XwwrCN.js";import{S as xm}from"./swiper-sync-context-CagD34dL.js";import{h as gm,c as vm,W as ym,C as Ga,s as Vt}from"./token-item-CXWqonXP.js";import{L as Te,G as Ue,A as Jt,P as yt,I as Ys,b as ea}from"./LoadingSpinner-BlBFZ_HX.js";import{u as O}from"./useTranslation-DcuaidzW.js";import{I as Oe}from"./IconAlertTriangle-B4a1jius.js";import{I as es}from"./IconTrash-B04QTRRB.js";import{c as Qa,I as Ao}from"./web-BGou904B.js";import{t as bm}from"./web-uRgD7_iB.js";import{B as fs,k as $e,M as Ht,q as at,E as jm,N as Nm,O as wm}from"./derivation-cNkBwRV-.js";import{p as Nt,g as Io,n as ws,a as Cm}from"./notification-BcL0dhJ1.js";import{g as Pe,N as To,o as km,q as Kt,u as Br,C as Ya,v as us,I as Sm}from"./index-DdArusCF.js";import"./breakpoint-DQ_qwb34.js";import{T as Po}from"./transaction-item-BaU3WjLH.js";import{A as re}from"./amount-BQsqQYGO.js";import{I as ut}from"./IconPlus-Bll0SYR1.js";import{c as ue}from"./createReactComponent-DfMnD9Gx.js";import{I as Cn,b as _o,c as ta,d as zs,e as Am,g as Im,f as Tm,h as Pm}from"./transaction-meta-f0DnSHtx.js";import{I as _m,i as Em,A as Mm}from"./address-input-DMuabLeg.js";import{A as jt}from"./amount-display-HIkOl8Pj.js";import"./animated-number-DXTjEMlD.js";import{T as Rm}from"./time-display-C5xgBEE6.js";import{F as Lm,E as Eo,S as Dm,C as Fr}from"./service-status-alert-DbYCX38s.js";import{e as Xa,K as zm,L as Mo,M as Om,u as Bm,J as Re,l as Ro,N as Lo,O as Fm,T as Wm,P as $m,Q as qm,R as Wr,d as Hm,S as $r,U as qr,V as Hr,W as Ur,X as Vr,Y as Jr,Z as Kr,_ as Gr,$ as Qr,a0 as Yr,a1 as Xr,a2 as Do,a3 as Um,a4 as Vm,a5 as Zr,a6 as Jm,a7 as Km}from"./index-DmvvjShM.js";import{I as Gm,a as Qm}from"./my-apps-page-BUVSmz-w.js";import{E as Ym,c as Mt}from"./ecosystem-desktop-BHJbs7jH.js";import"./miniapp-splash-screen-VHK2JM0Z.js";import{u as Xm}from"./item-DkNY8kcZ.js";import{_ as Tt}from"./preload-helper-PPVm8Dsz.js";import{P as K}from"./page-header-DtTGVJkT.js";import{C as ys,I as Zm}from"./contact-avatar-6pZXdrWg.js";import{I as De}from"./IconChevronRight-DE_a9KQB.js";import{S as Ct,a as kt,b as St,c as At,u as ef,f as tf,D as sf,g as nf,h as af,i as rf,j as of,k as cf,l as lf,m as df,n as uf}from"./sheet-CASVnGeR.js";import{I as je}from"./IconCheck-CDq4Jde6.js";import{C as Pt,a as kn}from"./chain-icon-DjJEUbre.js";import{p as Be,P as mt}from"./pattern-lock-CrMS9hrr.js";import{P as gs}from"./password-input-DEHTBJZy.js";import{I as Xs}from"./IconLock-DFyHLU2l.js";import{I as _t}from"./IconAlertCircle-CbBbua2j.js";import{F as Za}from"./fee-display-vPXwiwFC.js";import{T as zo}from"./tx-status-display-DzpHpujO.js";import{I as Ve}from"./input-DPvOZPVe.js";import{b as Ut,i as mf,d as ff}from"./avatar-codec-KCABu4DY.js";import{I as ts}from"./IconRefresh-sLngvuG_.js";import{I as Zs}from"./IconSearch-D5sqKuvG.js";import{I as en}from"./IconDownload-DsNLUOW7.js";import{W as pf,r as hf}from"./wallet-mini-card-DukzY5Uv.js";import{I as xf,W as gf}from"./wallet-list-Bc-0Lgbs.js";import{C as Oo}from"./checkbox-BcxcRTJf.js";import{I as Bo,S as Os,a as Bs,b as Fs,c as Ws,d as Gt,A as Fo}from"./asset-selector-BHL-zD9c.js";import{I as Wo}from"./IconChevronDown-HJIlMXZ7.js";import{p as $o,g as er}from"./qr-parser-BWSeIkyX.js";import{c as qo}from"./index-I6rmUTm8.js";import{g as vf,a as yf,b as bf}from"./scanner-validators-YRGmuXyx.js";import{I as tn}from"./IconX-DMGXeuG5.js";import{I as tr}from"./IconWallet-D6DQLV_K.js";import{C as sr}from"./contact-card-DTgEFuoV.js";import{I as ve}from"./IconLoader2-D4ErfFzM.js";import{g as Vn,n as jf,p as Nf}from"./index-BwiwV7zE.js";import{a as yn,c as bn,s as jn,p as wf,i as Cf}from"./bioforest-BXwckqu6.js";import{I as kf}from"./IconApps-BToufB5U.js";import{I as nr}from"./IconShieldCheck-DBuCdmLq.js";import{A as it}from"./address-display-BvSQI1KQ.js";import{z as Sf}from"./composite-CZ8gweUp.js";import{f as Af,u as ar,d as If,m as Tf}from"./useRenderElement-TTPX5Cln.js";import{I as rr}from"./IconEye-JgtmNvoS.js";import{M as Ho}from"./mnemonic-display-BQBWTB4x.js";import{P as ir}from"./pattern-lock-setup-CJjIxCkx.js";import{g as Uo,C as or}from"./chain-selector-BS24VUt-.js";import{deriveWalletChainAddresses as Vo}from"./index-DVojaqwU.js";import{I as Jo}from"./IconEyeOff-Bj-_aZTW.js";import{I as bs}from"./IconCircleCheck-v2ZCslrx.js";import"./asset-item-Bt5Cy43k.js";import"./asset-list-T15QQGoO.js";import{A as Ko}from"./amount-input-Cwrhvv3a.js";import{B as Pf}from"./balance-display-BAgkI9b5.js";import{S as _f,I as Go}from"./send-result-CBuA5Z57.js";import{T as Qo}from"./Trans-Blp3nY8A.js";import{M as Ef}from"./mnemonic-input-BZJNAfqs.js";import{T as Yo}from"./transaction-list-Dt2lIDDD.js";import{T as Mf}from"./transaction-status-CxE75a3M.js";import{I as wa}from"./IconExternalLink-CkEb2egs.js";import{A as Xo}from"./AppInfoCard-DAl1vpfN.js";import{P as Rf}from"./PermissionList-mv0VX96D.js";import{W as Lf}from"./wallet-selector-Dj_2ZLUi.js";import{T as ot}from"./token-icon-DTxoo1Ks.js";import{T as ei}from"./TransactionDetails-DuSAvC_c.js";import{B as ti}from"./BalanceWarning-Dzo6u8ZR.js";import{K as Df}from"./key-type-selector-CU1GjQny.js";import{A as zf}from"./arbitrary-key-input-HDoPHfdi.js";import{C as Of}from"./chain-address-preview-C7Ic6yWn.js";import{C as Bf}from"./collision-confirm-dialog-B0gOUh05.js";import{I as Ff}from"./dropdown-menu-CUXyfcT4.js";import"./hologram-canvas-CJ1u0yrl.js";import{I as Wf}from"./IconPencil-CtpI5QK4.js";import{I as $f}from"./IconBell-NWt7TH34.js";import{I as qf}from"./IconCircleX-qfHVUuPQ.js";import{I as Hf}from"./IconClock-CtK7VAxv.js";import{j as js,s as ie,c as It,n as Jn,i as Zo,l as wt,a as cr}from"./schemas-CO8_C8zP.js";import{I as Uf}from"./IconShield-CjldPfwe.js";const Vf=[["path",{d:"M20 6v12a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2z",key:"svg-0"}],["path",{d:"M10 16h6",key:"svg-1"}],["path",{d:"M13 11m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-2"}],["path",{d:"M4 8h3",key:"svg-3"}],["path",{d:"M4 12h3",key:"svg-4"}],["path",{d:"M4 16h3",key:"svg-5"}]],Jf=ue("outline","address-book","AddressBook",Vf);const Kf=[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 15h10.55",key:"svg-1"}],["path",{d:"M6.551 4.938l3.26 10.034",key:"svg-2"}],["path",{d:"M17.032 4.636l-8.535 6.201",key:"svg-3"}],["path",{d:"M20.559 14.51l-8.535 -6.201",key:"svg-4"}],["path",{d:"M12.257 20.916l3.261 -10.034",key:"svg-5"}]],ec=ue("outline","aperture","Aperture",Kf);const Gf=[["path",{d:"M17 7l-10 10",key:"svg-0"}],["path",{d:"M16 17l-9 0l0 -9",key:"svg-1"}]],Qf=ue("outline","arrow-down-left","ArrowDownLeft",Gf);const Yf=[["path",{d:"M7 7l10 10",key:"svg-0"}],["path",{d:"M17 8l0 9l-9 0",key:"svg-1"}]],Xf=ue("outline","arrow-down-right","ArrowDownRight",Yf);const Zf=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M13 18l6 -6",key:"svg-1"}],["path",{d:"M13 6l6 6",key:"svg-2"}]],tc=ue("outline","arrow-right","ArrowRight",Zf);const ep=[["path",{d:"M17 7l-10 10",key:"svg-0"}],["path",{d:"M8 7l9 0l0 9",key:"svg-1"}]],sc=ue("outline","arrow-up-right","ArrowUpRight",ep);const tp=[["path",{d:"M3 12h1m8 -9v1m8 8h1m-15.4 -6.4l.7 .7m12.1 -.7l-.7 .7",key:"svg-0"}],["path",{d:"M9 16a5 5 0 1 1 6 0a3.5 3.5 0 0 0 -1 3a2 2 0 0 1 -4 0a3.5 3.5 0 0 0 -1 -3",key:"svg-1"}],["path",{d:"M9.7 17l4.6 0",key:"svg-2"}]],nc=ue("outline","bulb","Bulb",tp);const sp=[["path",{d:"M5 7h1a2 2 0 0 0 2 -2a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1a2 2 0 0 0 2 2h1a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-9a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M9 13a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-1"}]],np=ue("outline","camera","Camera",sp);const ap=[["path",{d:"M14 10m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-0"}],["path",{d:"M21 12a9 9 0 1 1 -18 0a9 9 0 0 1 18 0z",key:"svg-1"}],["path",{d:"M12.5 11.5l-4 4l1.5 1.5",key:"svg-2"}],["path",{d:"M12 15l-1.5 -1.5",key:"svg-3"}]],lr=ue("outline","circle-key","CircleKey",ap);const rp=[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M14.8 9a2 2 0 0 0 -1.8 -1h-2a2 2 0 1 0 0 4h2a2 2 0 1 1 0 4h-2a2 2 0 0 1 -1.8 -1",key:"svg-1"}],["path",{d:"M12 7v10",key:"svg-2"}]],ip=ue("outline","coin","Coin",rp);const op=[["path",{d:"M16.7 8a3 3 0 0 0 -2.7 -2h-4a3 3 0 0 0 0 6h4a3 3 0 0 1 0 6h-4a3 3 0 0 1 -2.7 -2",key:"svg-0"}],["path",{d:"M12 3v3m0 12v3",key:"svg-1"}]],cp=ue("outline","currency-dollar","CurrencyDollar",op);const lp=[["path",{d:"M6 12l6 -9l6 9l-6 9z",key:"svg-0"}],["path",{d:"M6 12l6 -3l6 3l-6 2z",key:"svg-1"}]],dp=ue("outline","currency-ethereum","CurrencyEthereum",lp);const up=[["path",{d:"M12 6m-8 0a8 3 0 1 0 16 0a8 3 0 1 0 -16 0",key:"svg-0"}],["path",{d:"M4 6v6a8 3 0 0 0 16 0v-6",key:"svg-1"}],["path",{d:"M4 12v6a8 3 0 0 0 16 0v-6",key:"svg-2"}]],ac=ue("outline","database","Database",up);const mp=[["path",{d:"M3 5a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v10a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1v-10z",key:"svg-0"}],["path",{d:"M7 20h10",key:"svg-1"}],["path",{d:"M9 16v4",key:"svg-2"}],["path",{d:"M15 16v4",key:"svg-3"}]],fp=ue("outline","device-desktop","DeviceDesktop",mp);const pp=[["path",{d:"M3 3m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["circle",{cx:"8.5",cy:"8.5",r:".5",fill:"currentColor",key:"svg-1"}],["circle",{cx:"15.5",cy:"8.5",r:".5",fill:"currentColor",key:"svg-2"}],["circle",{cx:"15.5",cy:"15.5",r:".5",fill:"currentColor",key:"svg-3"}],["circle",{cx:"8.5",cy:"15.5",r:".5",fill:"currentColor",key:"svg-4"}],["circle",{cx:"12",cy:"12",r:".5",fill:"currentColor",key:"svg-5"}]],hp=ue("outline","dice-5","Dice5",pp);const xp=[["path",{d:"M4 4h16v2.172a2 2 0 0 1 -.586 1.414l-4.414 4.414v7l-6 2v-8.5l-4.48 -4.928a2 2 0 0 1 -.52 -1.345v-2.227z",key:"svg-0"}]],rc=ue("outline","filter","Filter",xp);const gp=[["path",{d:"M18.9 7a8 8 0 0 1 1.1 5v1a6 6 0 0 0 .8 3",key:"svg-0"}],["path",{d:"M8 11a4 4 0 0 1 8 0v1a10 10 0 0 0 2 6",key:"svg-1"}],["path",{d:"M12 11v2a14 14 0 0 0 2.5 8",key:"svg-2"}],["path",{d:"M8 15a18 18 0 0 0 1.8 6",key:"svg-3"}],["path",{d:"M4.9 19a22 22 0 0 1 -.9 -7v-1a8 8 0 0 1 12 -6.95",key:"svg-4"}]],vp=ue("outline","fingerprint","Fingerprint",gp);const yp=[["path",{d:"M7 12h3v4h-3z",key:"svg-0"}],["path",{d:"M10 6h-6a1 1 0 0 0 -1 1v12a1 1 0 0 0 1 1h16a1 1 0 0 0 1 -1v-12a1 1 0 0 0 -1 -1h-6",key:"svg-1"}],["path",{d:"M10 3m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v3a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M14 16h2",key:"svg-3"}],["path",{d:"M14 12h4",key:"svg-4"}]],bp=ue("outline","id-badge-2","IdBadge2",yp);const jp=[["path",{d:"M9 6.371c0 4.418 -2.239 6.629 -5 6.629",key:"svg-0"}],["path",{d:"M4 6.371h7",key:"svg-1"}],["path",{d:"M5 9c0 2.144 2.252 3.908 6 4",key:"svg-2"}],["path",{d:"M12 20l4 -9l4 9",key:"svg-3"}],["path",{d:"M19.1 18h-6.2",key:"svg-4"}],["path",{d:"M6.694 3l.793 .582",key:"svg-5"}]],Np=ue("outline","language","Language",jp);const wp=[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]],ic=ue("outline","link","Link",wp);const Cp=[["path",{d:"M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z",key:"svg-0"}]],kp=ue("outline","moon","Moon",Cp);const Sp=[["path",{d:"M6 9a6 6 0 1 0 12 0a6 6 0 0 0 -12 0",key:"svg-0"}],["path",{d:"M12 3c1.333 .333 2 2.333 2 6s-.667 5.667 -2 6",key:"svg-1"}],["path",{d:"M12 3c-1.333 .333 -2 2.333 -2 6s.667 5.667 2 6",key:"svg-2"}],["path",{d:"M6 9h12",key:"svg-3"}],["path",{d:"M3 20h7",key:"svg-4"}],["path",{d:"M14 20h7",key:"svg-5"}],["path",{d:"M10 20a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-6"}],["path",{d:"M12 15v3",key:"svg-7"}]],Ap=ue("outline","network","Network",Sp);const Ip=[["path",{d:"M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25",key:"svg-0"}],["path",{d:"M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}],["path",{d:"M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-3"}]],Tp=ue("outline","palette","Palette",Ip);const Pp=[["path",{d:"M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4",key:"svg-0"}],["path",{d:"M13.5 6.5l4 4",key:"svg-1"}],["path",{d:"M16 19h6",key:"svg-2"}]],_p=ue("outline","pencil-minus","PencilMinus",Pp);const Ep=[["path",{d:"M4 4m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M7 17l0 .01",key:"svg-1"}],["path",{d:"M14 4m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M7 7l0 .01",key:"svg-3"}],["path",{d:"M4 14m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-4"}],["path",{d:"M17 7l0 .01",key:"svg-5"}],["path",{d:"M14 14l3 0",key:"svg-6"}],["path",{d:"M20 14l0 .01",key:"svg-7"}],["path",{d:"M14 14l0 3",key:"svg-8"}],["path",{d:"M14 20l3 0",key:"svg-9"}],["path",{d:"M17 17l3 0",key:"svg-10"}],["path",{d:"M20 17l0 3",key:"svg-11"}]],Mp=ue("outline","qrcode","Qrcode",Ep);const Rp=[["path",{d:"M10 14l11 -11",key:"svg-0"}],["path",{d:"M21 3l-6.5 18a.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a.55 .55 0 0 1 0 -1l18 -6.5",key:"svg-1"}]],oc=ue("outline","send","Send",Rp);const Lp=[["path",{d:"M8 9h-1a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-8a2 2 0 0 0 -2 -2h-1",key:"svg-0"}],["path",{d:"M12 14v-11",key:"svg-1"}],["path",{d:"M9 6l3 -3l3 3",key:"svg-2"}]],Dp=ue("outline","share-2","Share2",Lp);const zp=[["path",{d:"M6 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-0"}],["path",{d:"M18 6m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-1"}],["path",{d:"M18 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-2"}],["path",{d:"M8.7 10.7l6.6 -3.4",key:"svg-3"}],["path",{d:"M8.7 13.3l6.6 3.4",key:"svg-4"}]],$s=ue("outline","share","Share",zp);const Op=[["path",{d:"M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7",key:"svg-1"}]],Bp=ue("outline","sun","Sun",Op);const Fp=[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 9h16.8",key:"svg-1"}],["path",{d:"M3.6 15h16.8",key:"svg-2"}],["path",{d:"M11.5 3a17 17 0 0 0 0 18",key:"svg-3"}],["path",{d:"M12.5 3a17 17 0 0 1 0 18",key:"svg-4"}]],cc=ue("outline","world","World",Fp),Wp=15,$p=1440*60*1e3;function qp(t){return Math.floor(t.getTime()/$p)}function Hp(t=new Date){const s=qp(t);return Wp*(s+1)%100}function si(t,s=new Date){const n=typeof t.officialScore=="number"?t.officialScore:0,a=typeof t.communityScore=="number"?t.communityScore:0,r=Hp(s),o=100-r;return(n*r+a*o)/100}function dr(){return Qa}function st(){return bm}function sn(){return gm}function lc(){return vm}const Sn={authorizeAddress:"/wallet/authorize/address",authorizeSignature:"/wallet/authorize/signature"};class Up{constructor(s,n){this.adapter=s,this.eventId=n}hasResponded=!1;handleNetworkAddresses(s,n){const a=n.trim().toLowerCase();if(!a)return[];const r=[];for(const o of s)for(const d of o.chainAddresses)String(d.chain).toLowerCase()===a&&r.push({name:o.name,address:d.address,chainName:d.chain,publicKey:"",magic:`${o.id}:${d.chain}`,signMessage:""});return r}handleMainAddresses(s){return s.chainAddresses.map(n=>({name:s.name,address:n.address,chainName:n.chain,publicKey:"",magic:`${s.id}:${n.chain}`,signMessage:""}))}async handleMainAddressesSigned(s,n){const a=this.handleMainAddresses(s);return await this.applySensitiveOptions(a,[s],{password:n.password,signMessage:n.signMessage,getMain:!1})}handleAllAddresses(s){const n=[];for(const a of s)n.push(...this.handleMainAddresses(a));return n}async handleAllAddressesSigned(s,n){const a=this.handleAllAddresses(s);return await this.applySensitiveOptions(a,s,{password:n.password,signMessage:n.signMessage,getMain:!1})}async handleNetworkAddressesSigned(s,n,a){const r=this.handleNetworkAddresses(s,n);return await this.applySensitiveOptions(r,s,{password:a.password,signMessage:a.signMessage,getMain:!1})}async applySensitiveOptions(s,n,a){return await this.applyPasswordProtectedFields(s,n,a)}async approve(s){await this.respondOnce(Sn.authorizeAddress,s)}async reject(s){await this.respondOnce(Sn.authorizeAddress,null)}async respondOnce(s,n){if(!this.hasResponded){this.hasResponded=!0;try{await this.adapter.respondWith(this.eventId,s,n)}finally{await this.adapter.removeEventId(this.eventId)}}}async applyPasswordProtectedFields(s,n,a){const r=a.signMessage?.trim()??"",o=!!r,d=!!a.getMain;if(!o&&!d)return s;const i=new Map;for(const u of n)i.set(u.id,u);const l=new Map,m=new Set;for(const u of s){const f=this.getWalletIdFromMagic(u.magic),h=i.get(f),x=h?.encryptedMnemonic;if(!h||!x)throw new Error("Missing secret");const y=u.chainName.trim().toLowerCase();if(d){let p=l.get(f);if(!p){try{p=await fs(x,a.password)}catch{throw new Error("Invalid password")}l.set(f,p)}u.main=p}if(o){if(yn(y)){let p=l.get(f);if(!p){try{p=await fs(x,a.password)}catch{throw new Error("Invalid password")}l.set(f,p)}const g=bn(p),v=jn(r,g.secretKey);u.signMessage=`0x${$e(v)}`,u.publicKey=$e(g.publicKey);continue}if(!m.has(f))if(l.has(f))m.add(f);else{if(!await Ht(x,a.password))throw new Error("Invalid password");m.add(f)}u.signMessage=this.createDeterministicMockSignature({message:r,address:u.address,chainName:u.chainName})}}return s}getWalletIdFromMagic(s){const n=s.indexOf(":");return n===-1?s:s.slice(0,n)}createDeterministicMockSignature({message:s,address:n,chainName:a}){const r=new TextEncoder,o=at(r.encode(`address:${n}|chain:${a}|message:${s}`)),d=at(r.encode(`event:${this.eventId}`)),i=new Uint8Array(64);return i.set(o,0),i.set(d,32),`0x${$e(i)}`}}class dc{constructor(s,n){this.adapter=s,this.eventId=n}hasResponded=!1;async approve(s){await this.respondOnce(Sn.authorizeSignature,s)}async reject(s){await this.respondOnce(Sn.authorizeSignature,null)}async handleMessageSign(s,n,a){const r=s.chainName.trim(),o=r.toLowerCase(),d=lt.getConfig(r)??lt.getConfig(o);if(yn(o)||d?.chainKind==="bioforest"){let m;try{m=await fs(n,a)}catch{throw new Error("Invalid password")}const u=bn(m),f=d?.prefix??(s.senderAddress.slice(0,1)||"b");if(wf(u.publicKey,f)!==s.senderAddress)throw new Error("Signing address mismatch");const x=jn(s.message,u.secretKey);return{signature:`0x${$e(x)}`,publicKey:$e(u.publicKey)}}if(!await Ht(n,a))throw new Error("Invalid password");{const m=new TextEncoder,u=at(m.encode(`message:${s.message}`)),f=at(m.encode(`event:${this.eventId}`)),h=new Uint8Array(64);h.set(u,0),h.set(f,32);const x=at(m.encode(`pubkey:${s.senderAddress}`));return{signature:`0x${$e(h)}`,publicKey:$e(x)}}}async handleTransferSign(s,n,a){const r=s.chainName.trim().toLowerCase(),o=["transfer",r,s.senderAddress,s.receiveAddress,s.balance,s.fee??"",s.contractInfo?.assetType??s.assetType??"",s.contractInfo?.contractAddress??"",s.contractInfo?.decimals?.toString()??""].join("|");if(yn(r)){let f;try{f=await fs(n,a)}catch{throw new Error("Invalid password")}const h=bn(f),x=jn(o,h.secretKey);return`0x${$e(x)}`}if(!await Ht(n,a))throw new Error("Invalid password");const i=new TextEncoder,l=at(i.encode(o)),m=at(i.encode(`event:${this.eventId}`)),u=new Uint8Array(64);return u.set(l,0),u.set(m,32),`0x${$e(u)}`}async handleDestroySign(s,n,a){const r=s.chainName.trim().toLowerCase(),o=["destory",r,s.senderAddress,s.destoryAddress,s.destoryAmount,s.fee??"",s.assetType??""].join("|");if(yn(r)){let f;try{f=await fs(n,a)}catch{throw new Error("Invalid password")}const h=bn(f),x=jn(o,h.secretKey);return`0x${$e(x)}`}if(!await Ht(n,a))throw new Error("Invalid password");const i=new TextEncoder,l=at(i.encode(o)),m=at(i.encode(`event:${this.eventId}`)),u=new Uint8Array(64);return u.set(l,0),u.set(m,32),`0x${$e(u)}`}async respondOnce(s,n){if(!this.hasResponded){this.hasResponded=!0;try{await this.adapter.respondWith(this.eventId,s,n)}finally{await this.adapter.removeEventId(this.eventId)}}}}class Vp{async getCallerAppInfo(s){throw new Error("DWEB runtime not available in web environment")}async respondWith(s,n,a){throw new Error("DWEB runtime not available in web environment")}async removeEventId(s){}isAvailable(){return!1}}const qs=new Vp,Jp={"zh-CN":Is.wordlists.chinese_simplified,"zh-TW":Is.wordlists.chinese_traditional,ja:Is.wordlists.japanese,ko:Is.wordlists.korean},Kp=["zh-CN","zh-TW","ja","ko"];function An(t){const s=Jp[t]??Is.wordlists.english,n=s[Math.floor(Math.random()*s.length)];return Kp.includes(t)?n:n.charAt(0).toUpperCase()+n.slice(1)}function Gp(){return typeof window>"u"}function un(){return!Gp()}function Qp(){const t={value:null};function s(){return t.value}function n(a){t.value=a}return[s,n]}var sa,ni;function Yp(){if(ni)return sa;ni=1;var t=typeof Element<"u",s=typeof Map=="function",n=typeof Set=="function",a=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function r(o,d){if(o===d)return!0;if(o&&d&&typeof o=="object"&&typeof d=="object"){if(o.constructor!==d.constructor)return!1;var i,l,m;if(Array.isArray(o)){if(i=o.length,i!=d.length)return!1;for(l=i;l--!==0;)if(!r(o[l],d[l]))return!1;return!0}var u;if(s&&o instanceof Map&&d instanceof Map){if(o.size!==d.size)return!1;for(u=o.entries();!(l=u.next()).done;)if(!d.has(l.value[0]))return!1;for(u=o.entries();!(l=u.next()).done;)if(!r(l.value[1],d.get(l.value[0])))return!1;return!0}if(n&&o instanceof Set&&d instanceof Set){if(o.size!==d.size)return!1;for(u=o.entries();!(l=u.next()).done;)if(!d.has(l.value[0]))return!1;return!0}if(a&&ArrayBuffer.isView(o)&&ArrayBuffer.isView(d)){if(i=o.length,i!=d.length)return!1;for(l=i;l--!==0;)if(o[l]!==d[l])return!1;return!0}if(o.constructor===RegExp)return o.source===d.source&&o.flags===d.flags;if(o.valueOf!==Object.prototype.valueOf&&typeof o.valueOf=="function"&&typeof d.valueOf=="function")return o.valueOf()===d.valueOf();if(o.toString!==Object.prototype.toString&&typeof o.toString=="function"&&typeof d.toString=="function")return o.toString()===d.toString();if(m=Object.keys(o),i=m.length,i!==Object.keys(d).length)return!1;for(l=i;l--!==0;)if(!Object.prototype.hasOwnProperty.call(d,m[l]))return!1;if(t&&o instanceof Element)return!1;for(l=i;l--!==0;)if(!((m[l]==="_owner"||m[l]==="__v"||m[l]==="__o")&&o.$$typeof)&&!r(o[m[l]],d[m[l]]))return!1;return!0}return o!==o&&d!==d}return sa=function(d,i){try{return r(d,i)}catch(l){if((l.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw l}},sa}var Xp=Yp();const Ps=Vu(Xp);function uc(t){const s=c.useRef(t),n=s.current,a=Ps(n,t);return c.useEffect(()=>{a||(s.current=t)},[t]),a?n:t}var ur=c.createContext(null),mc=({children:t,value:s})=>e.jsx(ur.Provider,{value:uc(s),children:t});mc.displayName="ActivityProvider";var Zp=()=>c.useContext(ur);function eh(){return c.useContext(ur).params}var fc=c.createContext(null),pc=({children:t,value:s})=>e.jsx(fc.Provider,{value:uc(s),children:t});pc.displayName="StackProvider";var th=()=>c.useContext(fc),sh=Object.defineProperty,nh=Object.defineProperties,ah=Object.getOwnPropertyDescriptors,In=Object.getOwnPropertySymbols,hc=Object.prototype.hasOwnProperty,xc=Object.prototype.propertyIsEnumerable,ai=(t,s,n)=>s in t?sh(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,xe=(t,s)=>{for(var n in s||(s={}))hc.call(s,n)&&ai(t,n,s[n]);if(In)for(var n of In(s))xc.call(s,n)&&ai(t,n,s[n]);return t},we=(t,s)=>nh(t,ah(s)),rh=(t,s)=>{var n={};for(var a in t)hc.call(t,a)&&s.indexOf(a)<0&&(n[a]=t[a]);if(t!=null&&In)for(var a of In(t))s.indexOf(a)<0&&xc.call(t,a)&&(n[a]=t[a]);return n};function ih(t,s,n){const a=n(t),r=n(s);return a<r?-1:a===r?0:1}var oh=(t,s)=>{const n=[],a=[];return t.forEach(r=>{s(r)?n.push(r):a.push(r)}),[n,a]};function gc(t,s){return t.map((n,a)=>s(n)?a:void 0).filter(n=>typeof n=="number")}var na=0,ri=0,vc=()=>{const t=new Date().getTime();return ri===t?na+=1:(ri=t,na=0),(t*1e3+na)/1e3};function rt(){return(vc()*1e3).toString(16)}function Kn(t){return t.length===0?void 0:t[t.length-1]}function ii(t,s){const n=xe({},t);return s.forEach(a=>{delete n[a]}),n}function ch(t){let s=!1;return()=>{s||(s=!0,t())}}function lh(t,s){const n=new Map;return[...t].reverse().filter(a=>{const r=s(a);if(r===null)return!0;const o=!!n.get(r);return n.set(r,!0),!o}).reverse()}function Ca(t){return!t.exitedBy}function ka(t,s){return s.enteredBy.eventDate-t.enteredBy.eventDate}function oi(t){return t.filter(Ca).sort(ka)[0]}function dh(t,s,n){const a=[];switch(s.name){case"Replaced":{if(Kn(gc(t,l=>l.id===s.activityId))!==void 0)break;const o=t.slice().sort(ka).filter(Ca),d=n.now-s.eventDate>=n.transitionDuration;if((s.skipEnterActiveState||d?"enter-done":"enter-active")==="enter-done"){const l=o.findIndex(m=>!(s.skipEnterActiveState&&m.enteredBy.name==="Replaced"&&m.transitionState==="enter-active"));return o.slice(0,l+1).map(m=>t.indexOf(m))}break}case"Popped":{const r=t.filter(Ca).sort(ka),o=r.slice(0,r.length-1)[0];o&&a.push(t.indexOf(o));break}case"StepPushed":case"StepReplaced":{const r=oi(t);if(r){if(s.targetActivityId&&s.targetActivityId!==r.id)break;a.push(t.indexOf(r))}break}case"StepPopped":{const r=oi(t);if(r&&r.steps.length>1){if(s.targetActivityId&&s.targetActivityId!==r.id)break;a.push(t.indexOf(r))}break}}return a}function ci(t,s){switch(s.name){case"Pushed":case"Replaced":{const n=Kn(gc(t,a=>a.id===s.activityId));return n??t.length}default:return-1}}function li(t,s){return{id:t.activityId,name:t.activityName,transitionState:s,params:t.activityParams,context:t.activityContext,steps:[{id:t.activityId,params:t.activityParams,enteredBy:t,zIndex:-1}],enteredBy:t,isTop:!1,isActive:!1,isRoot:!1,zIndex:-1}}function mr(t){return(s,n)=>{const a=t[n.name].bind(t);if(a)return a(s,n);throw new Error(`No reducer for event ${JSON.stringify(n)}`)}}function xt(t){return t}function uh({transitionDuration:t,now:s,resumedAt:n}){return mr({Pushed(a,r){const o=s-(n??r.eventDate)>=t,d=r.skipEnterActiveState||o?"enter-done":"enter-active",i=ci(a,r);return[...a.slice(0,i),li(r,d),...a.slice(i+1)]},Replaced(a,r){var o,d;const i=s-(n??r.eventDate)>=t,l=ci(a,r),m=(d=(o=a[l])==null?void 0:o.transitionState)!=null?d:r.skipEnterActiveState||i?"enter-done":"enter-active";return[...a.slice(0,l),li(r,m),...a.slice(l+1)]},Initialized:xt,ActivityRegistered:xt,Popped:xt,StepPushed:xt,StepReplaced:xt,StepPopped:xt,Paused:xt,Resumed:xt})}function Cs(t){return t}function mh(t){return mr({Replaced:(s,n)=>we(xe({},s),{exitedBy:n,transitionState:"exit-done"}),Popped:(s,n)=>{var a;const r=t.now-((a=t.resumedAt)!=null?a:n.eventDate)>=t.transitionDuration,o=n.skipExitActiveState||r?"exit-done":"exit-active";return we(xe({},s),{exitedBy:n,transitionState:o,params:o==="exit-done"?s.steps[0].params:s.params,steps:o==="exit-done"?[s.steps[0]]:s.steps})},StepPushed:(s,n)=>{var a;const r={id:n.stepId,params:n.stepParams,enteredBy:n,zIndex:s.zIndex,hasZIndex:(a=n.hasZIndex)!=null?a:!1};return we(xe({},s),{params:n.stepParams,steps:[...s.steps,r]})},StepReplaced:(s,n)=>{var a;const r={id:n.stepId,params:n.stepParams,enteredBy:n,zIndex:s.zIndex,hasZIndex:(a=n.hasZIndex)!=null?a:!1};return we(xe({},s),{params:n.stepParams,steps:[...s.steps.slice(0,s.steps.length-1),r]})},StepPopped:(s,n)=>{var a;s.steps.pop();const r=(a=Kn(s.steps))==null?void 0:a.params;return we(xe({},s),{params:r??s.params})},Initialized:Cs,ActivityRegistered:Cs,Pushed:Cs,Paused:Cs,Resumed:Cs})}function nt(t){return(s,n)=>s.globalTransitionState==="paused"?we(xe({},s),{pausedEvents:s.pausedEvents?[...s.pausedEvents,n]:[n]}):t(s,n)}function Ke(t,s){return(n,a)=>{const r=uh({transitionDuration:n.transitionDuration,now:s.now,resumedAt:s.resumedAt}),o=mh({transitionDuration:n.transitionDuration,now:s.now,resumedAt:s.resumedAt}),d=r(n.activities,a),i=dh(n.activities,a,{transitionDuration:n.transitionDuration,now:s.now});for(const u of i)d[u]=o(d[u],a);const l=d.find(u=>u.transitionState==="enter-active"||u.transitionState==="exit-active"),m=n.globalTransitionState==="paused"?"paused":l?"loading":"idle";return t(we(xe({},n),{activities:d,globalTransitionState:m}),a)}}function is(t,s){return we(xe({},t),{events:[...t.events,s]})}function yc(t){return mr({Initialized:nt(Ke((s,n)=>we(xe({},s),{transitionDuration:n.transitionDuration,events:[...s.events,n]}),t)),ActivityRegistered:nt(Ke((s,n)=>we(xe({},s),{registeredActivities:[...s.registeredActivities,xe({name:n.activityName},n.activityParamsSchema?{paramsSchema:n.activityParamsSchema}:null)],events:[...s.events,n]}),t)),Paused:nt(Ke((s,n)=>we(xe({},s),{globalTransitionState:"paused",events:[...s.events,n]}),t)),Resumed:Ke((s,n)=>{if(s.globalTransitionState!=="paused"||!s.pausedEvents)return we(xe({},s),{events:[...s.events,n]});const a=yc({now:t.now,resumedAt:n.eventDate}),r=s,{pausedEvents:o}=r,d=rh(r,["pausedEvents"]),i=o.reduce(a,we(xe({},d),{globalTransitionState:"idle"}));return we(xe({},i),{events:[...i.events,n]})},t),Pushed:nt(Ke(is,t)),Replaced:nt(Ke(is,t)),Popped:nt(Ke(is,t)),StepPushed:nt(Ke(is,t)),StepReplaced:nt(Ke(is,t)),StepPopped:nt(Ke(is,t))})}function aa(t,s){return t.filter(n=>n.name===s)}function Nn(t,s){return we(xe({id:rt(),eventDate:vc()},s),{name:t})}function fh(t){if(t.length===0)throw new Error("events parameter is empty");if(aa(t,"Initialized").length>1)throw new Error("InitializedEvent can only exist once");const n=aa(t,"ActivityRegistered"),a=new Set(n.map(o=>o.activityName));if(aa(t,"Pushed").some(o=>!a.has(o.activityName)))throw new Error("the corresponding activity does not exist")}function ra(t,s){const n=lh([...t].sort((u,f)=>u.eventDate-f.eventDate),u=>u.id);fh(n);const a=yc({now:s}),r=n.reduce(a,{activities:[],globalTransitionState:"idle",registeredActivities:[],transitionDuration:0,events:[]}),o=r.activities.filter(u=>u.transitionState==="enter-active"||u.transitionState==="enter-done"||u.transitionState==="exit-active"),d=o.filter(u=>u.transitionState==="enter-active"||u.transitionState==="enter-done"),i=o[o.length-1],l=d[d.length-1];return we(xe({},r),{activities:r.activities.map(u=>{let f=o.findIndex(({id:y})=>y===u.id);const h=o.slice(0,f);for(const y of h)for(const p of y.steps)p.hasZIndex&&(f+=1);const x=u.steps.reduce((y,p)=>{var g;const v=Kn(y),j=(g=v?.zIndex)!=null?g:f;return[...y,we(xe({},p),{zIndex:j+(p.hasZIndex?1:0)})]},[]);return xe(xe({id:u.id,name:u.name,transitionState:u.transitionState,params:u.params,steps:x,enteredBy:u.enteredBy,zIndex:f,isTop:i?.id===u.id,isActive:l?.id===u.id,isRoot:f===0||f===1&&u.transitionState==="enter-active"&&u.enteredBy.name==="Replaced"},u.exitedBy?{exitedBy:u.exitedBy}:null),u.context?{context:u.context}:null)}).sort((u,f)=>ih(u,f,h=>h.id))})}function ph(t,s){var n,a,r,o,d,i,l,m;const u=[];!Ps(t,s)&&u.push({_TAG:"%SOMETHING_CHANGED%"});const h=t.globalTransitionState!=="paused"&&s.globalTransitionState==="paused",x=t.globalTransitionState==="paused"&&s.globalTransitionState!=="paused";h&&u.push({_TAG:"PAUSED"}),x&&u.push({_TAG:"RESUMED"});for(let y=0;y<Math.max(t.activities.length,s.activities.length);y+=1){const p=t.activities[y],g=s.activities[y],v=p?.transitionState==="exit-done"||p?.transitionState==="exit-active",j=g?.transitionState==="enter-active"||g?.transitionState==="enter-done";if(p&&g&&p.id===g.id)for(let N=0;N<Math.max(((n=p.steps)!=null?n:[]).length,((a=g.steps)!=null?a:[]).length);N+=1){const b=p.steps[N],S=g.steps[N];!b&&S?u.push({_TAG:"STEP_PUSHED",activity:g,step:S}):b&&!S?u.push({_TAG:"STEP_POPPED",activity:g}):p.steps.length===g.steps.length&&b.id!==S.id&&u.push({_TAG:"STEP_REPLACED",activity:g,step:S})}!p&&g?u.push({_TAG:g.enteredBy.name==="Pushed"?"PUSHED":"REPLACED",activity:g}):v&&j?u.push({_TAG:g.enteredBy.name==="Pushed"?"PUSHED":"REPLACED",activity:g}):p&&g&&p.id===g.id&&!Ps(ii(p,["isActive","isTop","isRoot","transitionState","zIndex"]),ii(g,["isActive","isTop","isRoot","transitionState","zIndex"]))&&g.enteredBy.name==="Replaced"&&!Ps(p.enteredBy,g.enteredBy)&&u.push({_TAG:"REPLACED",activity:g})}for(let y=Math.max(t.activities.length,s.activities.length)-1;y>=0;y-=1){const p=((r=t.activities[y])==null?void 0:r.transitionState)==="enter-done"||((o=t.activities[y])==null?void 0:o.transitionState)==="enter-active",g=((d=s.activities[y])==null?void 0:d.transitionState)==="exit-active"||((i=s.activities[y])==null?void 0:i.transitionState)==="exit-done",v=((l=s.activities[y+1])==null?void 0:l.enteredBy.name)==="Replaced"&&((m=s.activities[y+1])==null?void 0:m.transitionState)==="enter-done";p&&g&&!v&&u.push({_TAG:"POPPED",activity:s.activities[y]})}return u}var hh={Pushed:"onBeforePush",Replaced:"onBeforeReplace",Popped:"onBeforePop",StepPushed:"onBeforeStepPush",StepReplaced:"onBeforeStepReplace",StepPopped:"onBeforeStepPop",Paused:"onBeforePause",Resumed:"onBeforeResume"};function gt(t,s,n,a){let r=!1,o=xe({},s);for(const d of n){const i=d[hh[t]];i&&i({actionParams:xe({},o),actions:we(xe({},a),{preventDefault:()=>{r=!0},overrideActionParams:l=>{o=xe(xe({},o),l)}})})}return{isPrevented:r,nextActionParams:o}}function xh({dispatchEvent:t,pluginInstances:s,actions:n}){return{push(a){const{isPrevented:r,nextActionParams:o}=gt("Pushed",a,s,n);r||t("Pushed",o)},replace(a){const{isPrevented:r,nextActionParams:o}=gt("Replaced",a,s,n);r||t("Replaced",o)},pop(a={}){const{isPrevented:r,nextActionParams:o}=gt("Popped",a,s,n);r||t("Popped",o)},stepPush(a){const{isPrevented:r,nextActionParams:o}=gt("StepPushed",a,s,n);r||t("StepPushed",o)},stepReplace(a){const{isPrevented:r,nextActionParams:o}=gt("StepReplaced",a,s,n);r||t("StepReplaced",o)},stepPop(a={}){const{isPrevented:r,nextActionParams:o}=gt("StepPopped",a,s,n);r||t("StepPopped",o)},pause(a={}){const{isPrevented:r,nextActionParams:o}=gt("Paused",a,s,n);r||t("Paused",o)},resume(a={}){const{isPrevented:r,nextActionParams:o}=gt("Resumed",a,s,n);r||t("Resumed",o)}}}function gh(t,s,n){t.forEach(a=>{s.forEach(r=>{var o,d,i,l,m,u,f,h,x;switch(a._TAG){case"PUSHED":(o=r.onPushed)==null||o.call(r,{actions:n,effect:a});break;case"REPLACED":(d=r.onReplaced)==null||d.call(r,{actions:n,effect:a});break;case"POPPED":(i=r.onPopped)==null||i.call(r,{actions:n,effect:a});break;case"STEP_PUSHED":(l=r.onStepPushed)==null||l.call(r,{actions:n,effect:a});break;case"STEP_REPLACED":(m=r.onStepReplaced)==null||m.call(r,{actions:n,effect:a});break;case"STEP_POPPED":(u=r.onStepPopped)==null||u.call(r,{actions:n,effect:a});break;case"PAUSED":(f=r.onPaused)==null||f.call(r,{actions:n,effect:a});break;case"RESUMED":(h=r.onResumed)==null||h.call(r,{actions:n,effect:a});break;case"%SOMETHING_CHANGED%":(x=r.onChanged)==null||x.call(r,{actions:n,effect:a});break}})})}var vh=1e3,yh=vh/60;function di(t){var s,n,a,r;const o=[],i=[{key:"@stackflow/core",onChanged(){o.forEach(g=>g())}},...t.plugins.map(g=>g())],[l,m]=oh(t.initialEvents,g=>g.name==="Pushed"||g.name==="StepPushed"),u=i.reduce((g,v)=>{var j,N,b;return(b=(N=v.overrideInitialEvents)==null?void 0:N.call(v,{initialEvents:g,initialContext:(j=t.initialContext)!=null?j:{}}))!=null?b:g},l);u.length>0&&l.length>0&&u!==l&&((n=(s=t.handlers)==null?void 0:s.onInitialActivityIgnored)==null||n.call(s,u)),u.length===0&&((r=(a=t.handlers)==null?void 0:a.onInitialActivityNotFound)==null||r.call(a));const h={value:[...m,...u]},x={value:ra(h.value,new Date().getTime())},y={getStack(){return x.value},dispatchEvent(g,v){const j=Nn(g,v),N=ra([...h.value,j],new Date().getTime());h.value.push(j),p(N);const b=setInterval(()=>{const S=ra(h.value,new Date().getTime());Ps(x.value,S)||p(S),S.globalTransitionState==="idle"&&clearInterval(b)},yh)},push:()=>{},replace:()=>{},pop:()=>{},stepPush:()=>{},stepReplace:()=>{},stepPop:()=>{},pause:()=>{},resume:()=>{}},p=g=>{const v=ph(x.value,g);x.value=g,gh(v,i,y)};return Object.assign(y,xh({dispatchEvent:y.dispatchEvent,pluginInstances:i,actions:y})),{actions:y,init:ch(()=>{i.forEach(g=>{var v;(v=g.onInit)==null||v.call(g,{actions:y})})}),pullEvents:()=>h.value,subscribe(g){return o.push(g),function(){const j=o.findIndex(N=>N===g);j>-1&&o.splice(j,1)}},pluginInstances:i}}var bc=c.createContext(null);function bh(){const t=c.useContext(bc);if(t===null)throw new Error("useActivityComponentMap must be used within ActivityComponentMapProvider");return t}function jh({children:t,value:s}){return e.jsx(bc.Provider,{value:s,children:t})}var Tn=t=>s=>s.find(({id:n})=>n===t);function Nh(t){return!t.exitedBy}function wh(t,s){return s.enteredBy.eventDate-t.enteredBy.eventDate}function Pn(t){return t.filter(Nh).sort(wh)[0]}function $t(){return rt()}function _n(){return rt()}var ui,Ch=(ui=Ha.useDeferredValue)!=null?ui:t=>t,mi,kh=(mi=Ha.useSyncExternalStore)!=null?mi:(t,s)=>{const[n,a]=c.useState(()=>s());return c.useEffect(()=>t(()=>{a(()=>s())})),n},fi,jc=(fi=Ha.useTransition)!=null?fi:()=>[!1,t=>t()],Nc=c.createContext(null),wc=c.createContext(null),Cc=({coreStore:t,children:s})=>{const n=kh(t.subscribe,t.actions.getStack,t.actions.getStack),a=Ch(n);return e.jsx(wc.Provider,{value:a,children:e.jsx(Nc.Provider,{value:t.actions,children:s})})};Cc.displayName="CoreProvider";var kc=()=>c.useContext(Nc),Sc=()=>c.useContext(wc),Ac=c.createContext(null),Ic=({children:t,value:s})=>e.jsx(Ac.Provider,{value:s,children:t});Ic.displayName="PluginsProvider";function Tc(){return c.useContext(Ac)}function Sh(t){return typeof t=="object"&&t!==null&&"then"in t&&typeof t.then=="function"}var ke={PENDING:"pending",FULFILLED:"fulfilled",REJECTED:"rejected"};function fr(t){if(t.status===ke.PENDING)return{status:ke.PENDING};if(t.status===ke.FULFILLED&&"value"in t)return{status:ke.FULFILLED,value:t.value};if(t.status===ke.REJECTED&&"reason"in t)return{status:ke.REJECTED,reason:t.reason};throw new Error("Invalid promise state")}function Ah(t){if("status"in t&&Object.values(ke).some(n=>n===t.status))return t;const s=Object.assign(t,{status:ke.PENDING});return s.then(n=>{s.status=ke.FULFILLED,s.value=n},n=>{s.status=ke.REJECTED,s.reason=n}),s}function wn(t){return Sh(t)?Ah(t instanceof Promise?t:Promise.resolve(t)):Object.assign(Promise.resolve(t),{status:ke.FULFILLED,value:t})}function Ih(t){return Object.assign(Promise.reject(t),{status:ke.REJECTED,reason:t})}function Th(t){const s=wn(t),n=fr(s);if(n.status===ke.FULFILLED)return n.value;throw n.status===ke.REJECTED?n.reason:s}var Ph=Object.defineProperty,pi=Object.getOwnPropertySymbols,_h=Object.prototype.hasOwnProperty,Eh=Object.prototype.propertyIsEnumerable,hi=(t,s,n)=>s in t?Ph(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Mh=(t,s)=>{for(var n in s||(s={}))_h.call(s,n)&&hi(t,n,s[n]);if(pi)for(var n of pi(s))Eh.call(s,n)&&hi(t,n,s[n]);return t},Rh=(t,s,n)=>new Promise((a,r)=>{var o=l=>{try{i(n.next(l))}catch(m){r(m)}},d=l=>{try{i(n.throw(l))}catch(m){r(m)}},i=l=>l.done?a(l.value):Promise.resolve(l.value).then(o,d);i((n=n.apply(t,s)).next())});function Lh(t){let s=null;const n=()=>((!s||fr(s).status===ke.REJECTED)&&(s=t()),s);return{Component:r=>{const{default:o}=Th(n());return e.jsx(o,Mh({},r))},preload:()=>Rh(this,null,function*(){yield n()})}}var Dh=Symbol("STRUCTURED_ACTIVITY_COMPONENT_TYPE");function zh(t){return t!==null&&typeof t=="object"&&Dh in t}var ia=new WeakMap;function Oh(t){if(ia.has(t))return ia.get(t);const{Component:s}=Lh(()=>{const n=t.content,a=wn(typeof n=="function"?n():{default:n}),r=fr(a);return r.status===ke.FULFILLED?wn({default:r.value.default.component}):r.status===ke.REJECTED?Ih(r.reason):wn(a.then(o=>({default:o.default.component})))});return ia.set(t,s),s}var Bh=Object.defineProperty,Fh=Object.defineProperties,Wh=Object.getOwnPropertyDescriptors,xi=Object.getOwnPropertySymbols,$h=Object.prototype.hasOwnProperty,qh=Object.prototype.propertyIsEnumerable,Sa=(t,s,n)=>s in t?Bh(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,zt=(t,s)=>{for(var n in s||(s={}))$h.call(s,n)&&Sa(t,n,s[n]);if(xi)for(var n of xi(s))qh.call(s,n)&&Sa(t,n,s[n]);return t},oa=(t,s)=>Fh(t,Wh(s)),gi=(t,s,n)=>Sa(t,typeof s!="symbol"?s+"":s,n),Pc=({plugin:t,initialContext:s})=>{const n=bh(),a=Sc(),r=Tc();return t.render({stack:oa(zt({},a),{render(o){return{activities:zt(zt({},a),o).activities.map(i=>oa(zt({},i),{key:i.id,render(l){const m=n[i.name];let u=zh(m)?Uh(m,i.params):e.jsx(m,{params:i.params});return r.forEach(f=>{var h,x;u=(x=(h=f.wrapActivity)==null?void 0:h.call(f,{activity:oa(zt({},i),{render:()=>u}),initialContext:s}))!=null?x:u}),e.jsx(mc,{value:zt(zt({},i),l),children:u},i.id)}}))}}}),initialContext:s})};Pc.displayName="PluginRenderer";var Hh=Pc;function Uh(t,s){const{layout:n,loading:a,errorHandler:r}=t,o=Oh(t);return[i=>a?.component?e.jsx(c.Suspense,{fallback:e.jsx(a.component,{params:s}),children:i}):i,i=>{var l;if(!r)return i;const m=(l=r.boundary)!=null?l:Vh;return e.jsx(m,{renderFallback:(u,f)=>e.jsx(r.component,{params:s,error:u,reset:f}),children:i})},i=>n?.component?e.jsx(n.component,{params:s,children:i}):i].reduce((i,l)=>l(i),e.jsx(o,{params:s}))}var Vh=class extends c.Component{constructor(){super(...arguments),gi(this,"state",{hasError:!1,error:null}),gi(this,"reset",()=>this.setState({hasError:!1,error:null}))}render(){return this.state.hasError?this.props.renderFallback(this.state.error,this.reset):this.props.children}static getDerivedStateFromError(t){return{hasError:!0,error:t}}},Jh=Object.defineProperty,Kh=Object.defineProperties,Gh=Object.getOwnPropertyDescriptors,vi=Object.getOwnPropertySymbols,Qh=Object.prototype.hasOwnProperty,Yh=Object.prototype.propertyIsEnumerable,yi=(t,s,n)=>s in t?Jh(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Xh=(t,s)=>{for(var n in s||(s={}))Qh.call(s,n)&&yi(t,n,s[n]);if(vi)for(var n of vi(s))Yh.call(s,n)&&yi(t,n,s[n]);return t},Zh=(t,s)=>Kh(t,Gh(s)),_c=({initialContext:t})=>{const s=Sc(),n=Tc(),a=n.filter(o=>!!o.render);c.useEffect(()=>{a.length===0&&console.warn(`Stackflow - There is no rendering plugin, so "<Stack />" doesn't render anything. If you want to render some UI, use "@stackflow/plugin-renderer-basic" or add another rendering plugin.`)},[a]);let r=e.jsx(e.Fragment,{children:a.map(o=>e.jsx(Hh,{plugin:o,initialContext:t},o.key))});return n.forEach(o=>{var d,i;r=(i=(d=o.wrapStack)==null?void 0:d.call(o,{stack:Zh(Xh({},s),{render(){return r}}),initialContext:t}))!=null?i:r}),e.jsx(pc,{value:s,children:r})};_c.displayName="MainRenderer";var ex=_c,tx=Object.defineProperty,bi=Object.getOwnPropertySymbols,sx=Object.prototype.hasOwnProperty,nx=Object.prototype.propertyIsEnumerable,ji=(t,s,n)=>s in t?tx(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Ni=(t,s)=>{for(var n in s||(s={}))sx.call(s,n)&&ji(t,n,s[n]);if(bi)for(var n of bi(s))nx.call(s,n)&&ji(t,n,s[n]);return t};function ca(t){return t?t.animate==null?{skipActiveState:!1}:{skipActiveState:!t.animate}:{skipActiveState:!1}}function nn(){const t=kc(),[s]=jc();return c.useMemo(()=>({pending:s,push(n,a,r){const o=$t();return t?.push({activityId:o,activityName:n,activityParams:a,skipEnterActiveState:ca(r).skipActiveState}),{activityId:o}},replace(n,a,r){var o;const d=$t();return t?.replace({activityId:(o=r?.activityId)!=null?o:$t(),activityName:n,activityParams:a,skipEnterActiveState:ca(r).skipActiveState}),{activityId:d}},pop(n,a){let r=1,o={};typeof n=="object"&&(o=Ni({},n)),typeof n=="number"&&(r=n),a&&(o=Ni({},a));for(let d=0;d<r;d+=1)t?.pop({skipExitActiveState:d===0?ca(o).skipActiveState:!0})}}),[t?.push,t?.replace,t?.pop,s])}var ax=()=>{const t=kc(),[s]=jc();return c.useMemo(()=>({pending:s,stepPush(n,a){const r=t?.getStack().activities,o=a?.targetActivityId?Tn(a.targetActivityId):Pn,d=r&&o(r);if(!d)throw new Error("The target activity is not found.");const i=typeof n=="function"?n(d.params):n,l=_n();t?.stepPush({stepId:l,stepParams:i,targetActivityId:a?.targetActivityId})},stepReplace(n,a){const r=t?.getStack().activities,o=a?.targetActivityId?Tn(a.targetActivityId):Pn,d=r&&o(r);if(!d)throw new Error("The target activity is not found.");const i=typeof n=="function"?n(d.params):n,l=_n();t?.stepReplace({stepId:l,stepParams:i,targetActivityId:a?.targetActivityId})},stepPop(n){t?.stepPop({targetActivityId:n?.targetActivityId})}}),[t?.stepPush,t?.stepReplace,t?.stepPop,t?.getStack,s])},rx=Object.defineProperty,ix=Object.defineProperties,ox=Object.getOwnPropertyDescriptors,wi=Object.getOwnPropertySymbols,cx=Object.prototype.hasOwnProperty,lx=Object.prototype.propertyIsEnumerable,Ci=(t,s,n)=>s in t?rx(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,mn=(t,s)=>{for(var n in s||(s={}))cx.call(s,n)&&Ci(t,n,s[n]);if(wi)for(var n of wi(s))lx.call(s,n)&&Ci(t,n,s[n]);return t},dx=(t,s)=>ix(t,ox(s));function la(t){return t?t.animate==null?{skipActiveState:!1}:{skipActiveState:!t.animate}:{skipActiveState:!1}}function ux(t){var s;const n=((s=t.plugins)!=null?s:[]).flat(Number.POSITIVE_INFINITY).map(m=>m),a=Object.entries(t.activities).reduce((m,[u,f])=>dx(mn({},m),{[u]:"component"in f?f.component:f}),{}),r=()=>new Date().getTime()-t.transitionDuration*2,o=di({initialEvents:[Nn("Initialized",{transitionDuration:t.transitionDuration,eventDate:r()}),...Object.entries(t.activities).map(([m,u])=>Nn("ActivityRegistered",mn({activityName:m,eventDate:r()},"component"in u?{activityParamsSchema:u.paramsSchema}:null)))],plugins:[]}),[d,i]=Qp(),l=c.memo(m=>{const u=c.useMemo(()=>{const f=d();if(un()&&f)return f;const h=t.initialActivity?[Nn("Pushed",{activityId:$t(),activityName:t.initialActivity(),activityParams:{},eventDate:r(),skipEnterActiveState:!1})]:[],x=di({initialEvents:[...o.pullEvents(),...h],initialContext:m.initialContext,plugins:n,handlers:{onInitialActivityIgnored:y=>{un()&&console.warn(`Stackflow - Some plugin overrides an "initialActivity" option. The "initialActivity" option you set to "${y[0].activityName}" in the "stackflow" is ignored.`)},onInitialActivityNotFound:()=>{un()&&console.warn("Stackflow - There is no initial activity. If you want to set the initial activity, add the `initialActivity` option of the `stackflow()` function or add a plugin that sets the initial activity. (e.g. `@stackflow/plugin-history-sync`)")}}});return un()&&(x.init(),i(x)),x},[]);return e.jsx(Ic,{value:u.pluginInstances,children:e.jsx(Cc,{coreStore:u,children:e.jsx(jh,{value:a,children:e.jsx(ex,{initialContext:m.initialContext})})})})});return l.displayName="Stack",{activities:t.activities,Stack:l,useFlow:nn,useStepFlow:ax,addActivity(m){if(d()){console.warn("Stackflow - `addActivity()` API cannot be called after a `<Stack />` component has been rendered");return}a[m.name]=c.memo(m.component),o.actions.dispatchEvent("ActivityRegistered",{activityName:m.name,activityParamsSchema:m.paramsSchema,eventDate:r()})},addPlugin(m){if(d()){console.warn("Stackflow - `addPlugin()` API cannot be called after a `<Stack />` component has been rendered");return}[m].flat(Number.POSITIVE_INFINITY).map(u=>u).forEach(u=>{n.push(u)})},actions:{getStack(){var m,u;return(u=(m=d())==null?void 0:m.actions.getStack())!=null?u:o.actions.getStack()},dispatchEvent(m,u){var f;return(f=d())==null?void 0:f.actions.dispatchEvent(m,u)},push(m,u,f){var h;const x=$t();return(h=d())==null||h.actions.push({activityId:x,activityName:m,activityParams:u,skipEnterActiveState:la(f).skipActiveState}),{activityId:x}},replace(m,u,f){var h,x,y;const p=(h=f?.activityId)!=null?h:$t();return(y=d())==null||y.actions.replace({activityId:(x=f?.activityId)!=null?x:$t(),activityName:m,activityParams:u,skipEnterActiveState:la(f).skipActiveState}),{activityId:p}},pop(m,u){var f;let h=1,x={};typeof m=="object"&&(x=mn({},m)),typeof m=="number"&&(h=m),u&&(x=mn({},u));for(let y=0;y<h;y+=1)(f=d())==null||f.actions.pop({skipExitActiveState:y===0?la(x).skipActiveState:!0})},stepPush(m,u){var f,h;const x=(f=d())==null?void 0:f.actions.getStack().activities,y=u?.targetActivityId?Tn(u.targetActivityId):Pn,p=x&&y(x);if(!p)throw new Error("The target activity is not found.");const g=typeof m=="function"?m(p.params):m,v=_n();return(h=d())==null?void 0:h.actions.stepPush({stepId:v,stepParams:g,targetActivityId:u?.targetActivityId})},stepReplace(m,u){var f,h;const x=(f=d())==null?void 0:f.actions.getStack().activities,y=u?.targetActivityId?Tn(u.targetActivityId):Pn,p=x&&y(x);if(!p)throw new Error("The target activity is not found.");const g=typeof m=="function"?m(p.params):m,v=_n();return(h=d())==null?void 0:h.actions.stepReplace({stepId:v,stepParams:g,targetActivityId:u?.targetActivityId})},stepPop(m){var u;return(u=d())==null?void 0:u.actions.stepPop({targetActivityId:m?.targetActivityId})}}}}function mx(){return()=>({key:"plugin-renderer-basic",render({stack:t}){return e.jsx(e.Fragment,{children:t.render().activities.filter(s=>s.transitionState!=="exit-done").map(s=>e.jsx(c.Fragment,{children:s.render()},s.key))})}})}function fx(t){var s=t.match(/^var\((.*)\)$/);return s?s[1]:t}function an(t,s){var n={};{var a=t;for(var r in a){var o=a[r];o!=null&&(n[fx(r)]=o)}}return Object.defineProperty(n,"toString",{value:function(){return Object.keys(this).map(i=>"".concat(i,":").concat(this[i])).join(";")},writable:!1}),n}function px(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function hx(t){var s=px(t,"string");return typeof s=="symbol"?s:String(s)}function xx(t,s,n){return s=hx(s),s in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function ki(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,a)}return n}function Si(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?ki(Object(n),!0).forEach(function(a){xx(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ki(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function Ai(t,s){var n={};for(var a in t)n[a]=s(t[a],a);return n}var gx=(t,s,n)=>{for(var a of Object.keys(t)){var r;if(t[a]!==((r=s[a])!==null&&r!==void 0?r:n[a]))return!1}return!0},Rt=t=>{var s=n=>{var a=t.defaultClassName,r=Si(Si({},t.defaultVariants),n);for(var o in r){var d,i=(d=r[o])!==null&&d!==void 0?d:t.defaultVariants[o];if(i!=null){var l=i;typeof l=="boolean"&&(l=l===!0?"true":"false");var m=t.variantClassNames[o][l];m&&(a+=" "+m)}}for(var[u,f]of t.compoundVariants)gx(u,r,t.defaultVariants)&&(a+=" "+f);return a};return s.variants=()=>Object.keys(t.variantClassNames),s.classNames={get base(){return t.defaultClassName.split(" ")[0]},get variants(){return Ai(t.variantClassNames,n=>Ai(n,a=>a.split(" ")[0]))}},s},vx=Object.defineProperty,Ii=Object.getOwnPropertySymbols,yx=Object.prototype.hasOwnProperty,bx=Object.prototype.propertyIsEnumerable,Ti=(t,s,n)=>s in t?vx(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,jx=(t,s)=>{for(var n in s||(s={}))yx.call(s,n)&&Ti(t,n,s[n]);if(Ii)for(var n of Ii(s))bx.call(s,n)&&Ti(t,n,s[n]);return t};function pr(){const[t,s]=c.useReducer(()=>!0,!1);return c.useEffect(()=>{s()},[]),t}function ss(){return Zp()}function Ec(){const t=ss(),s=pr();return jx({},s?{"data-stackflow-activity-id":t?.id,"data-stackflow-activity-is-active":t?.isActive,"data-stackflow-activity-transition-state":t?.transitionState}:null)}function Mc(t,s,n){const a=()=>{s.forEach(r=>{t.removeEventListener(r,a)}),n()};s.forEach(r=>{t.addEventListener(r,a)})}var Nx=t=>(t(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}),tt=()=>{};function Aa(t){requestAnimationFrame(()=>{requestAnimationFrame(()=>{t()})})}function wx({outerRef:t,innerRef:s,enable:n}){const[a,r]=c.useState(void 0);return c.useEffect(()=>{const o=t&&"current"in t&&t.current,d=s.current;return!n||!o||!d?tt:Nx(()=>{const l=o.clientWidth,m=d.offsetLeft,u=d.clientWidth,f=l-m-u,h=Math.max(m,f);r(l-2*h)})}),{maxWidth:a}}function hr(t){const[s,n]=c.useState(void 0);return c.useEffect(()=>{Aa(()=>{n(t)})},[t]),s}function Cx(){return th()}function xr({ref:t}){const s=Cx();c.useEffect(()=>{if(!s)return;const n=t.current;if(!n||s.globalTransitionState==="idle")return;const a=r=>{r.preventDefault(),r.stopPropagation()};return n.addEventListener("touchstart",a,{capture:!0}),n.addEventListener("touchmove",a,{capture:!0}),n.addEventListener("touchend",a,{capture:!0}),n.addEventListener("touchcancel",a,{capture:!0}),()=>{n.removeEventListener("touchstart",a,{capture:!0}),n.removeEventListener("touchmove",a,{capture:!0}),n.removeEventListener("touchend",a,{capture:!0}),n.removeEventListener("touchcancel",a,{capture:!0})}},[s?.globalTransitionState])}var ks={};function ct({styleName:t,refs:s,effect:n,effectDeps:a}){const r=ss();c.useEffect(()=>r?(ks[t]||(ks[t]=new Map),ks[t].set(r.zIndex,{refs:s,hasEffect:!!n}),()=>{ks[t].delete(r.zIndex)}):tt,[r?.id,s,n]),c.useEffect(()=>{if(!r||!n)return tt;const o=(()=>{let i=[];for(let l=1;l<=r.zIndex;l+=1){const m=ks[t].get(r.zIndex-l);if(m?.refs&&(i=[...i,...m.refs]),m?.hasEffect)break}return i})(),d=n({activityTransitionState:r.transitionState,refs:o});return()=>{d?.()}},[r?.transitionState,...a??[]])}function kx({refs:t}){ct({styleName:"hide",refs:t,effect:({activityTransitionState:s,refs:n})=>{const a=()=>{n.forEach(r=>{if(!r.current)return;const o=r.current;o.style.display=""})};return s==="enter-done"?(n.forEach(r=>{if(!r.current)return;const o=r.current;o.style.display="none"}),()=>{a()}):(a(),tt)}})}function Sx({refs:t,transitionDuration:s,offsetStyles:n,hasEffect:a=!1}){ct({styleName:"offset",refs:t,effect:a?({activityTransitionState:r,refs:o})=>{const d=()=>{Aa(()=>{o.forEach(i=>{if(!i.current)return;const l=i.current;l.style.transform="",l.style.opacity="",Mc(l,["transitionend","transitioncancel"],()=>{l.style.transition=""})})})};switch(r){case"enter-active":case"enter-done":return o.forEach(i=>{i.current&&(i.current.style.transition=s,i.current.style.transform=n.transform,i.current.style.opacity=n.opacity)}),r==="enter-done"?()=>{d()}:tt;case"exit-active":case"exit-done":return Aa(()=>{d()}),tt;default:return tt}}:void 0})}var fn="--stackflow-swipe-back-ratio";function Ax({dimRef:t,edgeRef:s,paperRef:n,appBarRef:a,offset:r,transitionDuration:o,preventSwipeBack:d,moveAppBarTogether:i,getActivityTransitionState:l,onSwipeStart:m,onSwipeMove:u,onSwipeEnd:f,onTransitionEnd:h}){ct({styleName:"swipe-back",refs:i&&a?[n,a]:[n],effect:({refs:x})=>{if(d||!t.current||!s.current||!n.current)return tt;const y=t.current,p=s.current,g=n.current,v=a?.current;let j=null,N=null,b=null,S=[];const k=()=>{j=null,N=null,b=null,S=[]};let P=!1;function _({dx:w,ratio:E}){P||(P=!0,requestAnimationFrame(()=>{y.style.opacity=`${1-E}`,y.style.transition="0s",g.style.overflowY="hidden",g.style.transform=`translate3d(${w}px, 0, 0)`,g.style.transition="0s",i&&v&&(v.style.overflowY="hidden",v.style.transform=`translate3d(${w}px, 0, 0)`,v.style.transition="0s"),v?.style.setProperty(fn,String(E)),x.forEach(D=>{var z,L;D.current&&(D.current.style.transform=`translate3d(${-1*(1-E)*r}px, 0, 0)`,D.current.style.transition="0s",((z=D.current.parentElement)==null?void 0:z.style.display)==="none"&&(D.current.parentElement.style.display="block"),(L=D.current.parentElement)==null||L.style.setProperty(fn,String(E)))}),P=!1}))}function A({swiped:w}){return new Promise(E=>{requestAnimationFrame(()=>{y.style.opacity=`${w?0:1}`,y.style.transition=o,g.style.overflowY="hidden",g.style.transform=`translateX(${w?"100%":"0"})`,g.style.transition=o,i&&v&&(v.style.overflowY="hidden",v.style.transform=`translateX(${w?"100%":"0"})`,v.style.transition=o),x.forEach(z=>{z.current&&(z.current.style.transition=o,z.current.style.transform=`translate3d(${w?"0":`-${r/16}rem`}, 0, 0)`)});const D=[...S];E(),Mc(g,["transitionend","transitioncancel"],()=>{const z=w||l()==="exit-active"||l()==="exit-done";y.style.opacity="",g.style.overflowY="",g.style.transform="",i&&v&&(v.style.overflowY="",v.style.transform="",v.style.removeProperty("transition")),v?.style.removeProperty(fn),x.forEach((L,q)=>{var M;if(!L.current)return;const F=D[q];z?(L.current.style.transition="",L.current.style.transform="",L.current.parentElement&&(L.current.parentElement.style.display="")):F&&(L.current.style.transition=F.style.transition,L.current.style.transform=F.style.transform,L.current.parentElement&&F.parentElement&&(L.current.parentElement.style.display=F.parentElement.style.display)),(M=L.current.parentElement)==null||M.style.removeProperty(fn)}),h?.({swiped:w})})})})}const T=w=>{var E;const{activeElement:D}=document;(E=D?.blur)==null||E.call(D),j=b=w.touches[0].clientX,N=Date.now(),S=x.map(z=>z.current?{style:{transform:z.current.style.transform,transition:z.current.style.transition},parentElement:z.current.parentElement?{style:{display:z.current.parentElement.style.display}}:void 0}:{style:{transform:"",transition:""}}),m?.()},C=w=>{if(!j){k();return}b=w.touches[0].clientX;const E=b-j,D=E/g.clientWidth;_({dx:E,ratio:D}),u?.({dx:E,ratio:D})},I=()=>{if(!j||!N||!b){k();return}const w=Date.now(),D=(b-j)/(w-N)>1||b/g.clientWidth>.4;f?.({swiped:D}),Promise.resolve().then(()=>A({swiped:D})).then(()=>k())};return p.addEventListener("touchstart",T,{passive:!0}),p.addEventListener("touchmove",C,{passive:!0}),p.addEventListener("touchend",I,{passive:!0}),p.addEventListener("touchcancel",I,{passive:!0}),()=>{p.removeEventListener("touchstart",T),p.removeEventListener("touchmove",C),p.removeEventListener("touchend",I),p.removeEventListener("touchcancel",I)}},effectDeps:[d]})}function Hs(){var t;const s=ss();return((t=s?.zIndex)!=null?t:0)*5}var Ix=Object.defineProperty,Tx=Object.defineProperties,Px=Object.getOwnPropertyDescriptors,Pi=Object.getOwnPropertySymbols,_x=Object.prototype.hasOwnProperty,Ex=Object.prototype.propertyIsEnumerable,_i=(t,s,n)=>s in t?Ix(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Ft=(t,s)=>{for(var n in s||(s={}))_x.call(s,n)&&_i(t,n,s[n]);if(Pi)for(var n of Pi(s))Ex.call(s,n)&&_i(t,n,s[n]);return t},_s=(t,s)=>Tx(t,Px(s)),Mx=t=>e.jsx("svg",{className:t.className,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.7241 2.76052C17.105 3.16043 17.0896 3.79341 16.6897 4.17431L8.45 12.0222L16.6896 19.8689C17.0896 20.2498 17.105 20.8827 16.7242 21.2827C16.3433 21.6826 15.7103 21.6981 15.3104 21.3172L6.31037 12.7464C6.11218 12.5576 6.00001 12.2959 6 12.0222C5.99999 11.7486 6.11215 11.4868 6.31032 11.2981L15.3103 2.72608C15.7102 2.34518 16.3432 2.3606 16.7241 2.76052Z",fill:"currentColor"})}),Ei=Mx,Rx=t=>e.jsx("svg",{className:t.className,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M20.7071 4.70711C21.0976 4.31658 21.0976 3.68342 20.7071 3.29289C20.3166 2.90237 19.6834 2.90237 19.2929 3.29289L12 10.5858L4.70711 3.29289C4.31658 2.90237 3.68342 2.90237 3.29289 3.29289C2.90237 3.68342 2.90237 4.31658 3.29289 4.70711L10.5858 12L3.29289 19.2929C2.90237 19.6834 2.90237 20.3166 3.29289 20.7071C3.68342 21.0976 4.31658 21.0976 4.70711 20.7071L12 13.4142L19.2929 20.7071C19.6834 21.0976 20.3166 21.0976 20.7071 20.7071C21.0976 20.3166 21.0976 19.6834 20.7071 19.2929L13.4142 12L20.7071 4.70711Z",fill:"currentColor"})}),Mi=Rx,V={backgroundColor:"var(--stackflow-plugin-basic-ui-background-color)",backgroundImage:"var(--stackflow-plugin-basic-ui-background-image)",dimBackgroundColor:"var(--stackflow-plugin-basic-ui-dim-background-color)",dimHeight:"var(--stackflow-plugin-basic-ui-dim-height)",transitionDuration:"var(--stackflow-plugin-basic-ui-transition-duration)",computedTransitionDuration:"var(--stackflow-plugin-basic-ui-computed-transition-duration)",defaultTransitionOffSet:"var(--stackflow-plugin-basic-ui-default-transition-off-set)",appBar:{borderColor:"var(--stackflow-plugin-basic-ui-app-bar-border-color)",borderColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-border-color-transition-duration)",borderSize:"var(--stackflow-plugin-basic-ui-app-bar-border-size)",height:"var(--stackflow-plugin-basic-ui-app-bar-height)",heightTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-height-transition-duration)",minHeight:"var(--stackflow-plugin-basic-ui-app-bar-min-height)",iconColor:"var(--stackflow-plugin-basic-ui-app-bar-icon-color)",iconColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-icon-color-transition-duration)",textColor:"var(--stackflow-plugin-basic-ui-app-bar-text-color)",textColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-text-color-transition-duration)",backgroundColor:"var(--stackflow-plugin-basic-ui-app-bar-background-color)",backgroundColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-background-color-transition-duration)",backgroundImage:"var(--stackflow-plugin-basic-ui-app-bar-background-image)",backgroundImageTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-background-image-transition-duration)",overflow:"var(--stackflow-plugin-basic-ui-app-bar-overflow)",minSafeAreaInsetTop:"var(--stackflow-plugin-basic-ui-app-bar-min-safe-area-inset-top)",containerPadding:"var(--stackflow-plugin-basic-ui-app-bar-container-padding)",itemGap:"var(--stackflow-plugin-basic-ui-app-bar-item-gap)",fontSize:"var(--stackflow-plugin-basic-ui-app-bar-font-size)",lineHeight:"var(--stackflow-plugin-basic-ui-app-bar-line-height)",hitSlop:"var(--stackflow-plugin-basic-ui-app-bar-hit-slop)"},bottomSheet:{borderRadius:"var(--stackflow-plugin-basic-ui-bottom-sheet-border-radius)"},modal:{borderRadius:"var(--stackflow-plugin-basic-ui-modal-border-radius)",maxWidth:"var(--stackflow-plugin-basic-ui-modal-max-width)"},edge:{width:"var(--stackflow-plugin-basic-ui-edge-width)"}},Lx=Rt({defaultClassName:"_1q6dj2j2",variantClassNames:{theme:{android:"_1q6dj2j0",cupertino:"_1q6dj2j1"}},defaultVariants:{},compoundVariants:[]});function Dx(t){return t.filter(s=>s!=null)}function rn(t){return Object.entries(t).reduce((s,[n,a])=>(a!=null&&(s[n]=a),s),{})}var Rc=c.createContext({theme:"android"}),zx=Rc.Provider;function Lc(){return c.useContext(Rc)}var Ox=t=>()=>({key:"basic-ui",wrapStack({stack:s,initialContext:n}){var a,r,o,d,i,l,m,u,f,h,x,y,p,g,v,j,N;const b=typeof t=="function"?t({initialContext:n}):t;return e.jsx(zx,{value:_s(Ft({},b),{theme:(a=n?.theme)!=null?a:b.theme}),children:e.jsx("div",{className:Dx([Lx({theme:(r=n?.theme)!=null?r:b.theme}),b.rootClassName]).join(" "),style:an(rn({[V.backgroundColor]:b.backgroundColor,[V.backgroundImage]:b.backgroundImage,[V.dimBackgroundColor]:b.dimBackgroundColor,[V.dimHeight]:b.dimHeight,[V.transitionDuration]:`${s.transitionDuration}ms`,[V.computedTransitionDuration]:s.globalTransitionState==="loading"?`${s.transitionDuration}ms`:"0ms",[V.defaultTransitionOffSet]:b.defaultTransitionOffSet,[V.appBar.borderColor]:(o=b.appBar)==null?void 0:o.borderColor,[V.appBar.borderSize]:(d=b.appBar)==null?void 0:d.borderSize,[V.appBar.height]:(i=b.appBar)==null?void 0:i.height,[V.appBar.minHeight]:(l=b.appBar)==null?void 0:l.minHeight,[V.appBar.iconColor]:(m=b.appBar)==null?void 0:m.iconColor,[V.appBar.textColor]:(u=b.appBar)==null?void 0:u.textColor,[V.appBar.minSafeAreaInsetTop]:(f=b.appBar)==null?void 0:f.minSafeAreaInsetTop,[V.bottomSheet.borderRadius]:(h=b.bottomSheet)==null?void 0:h.borderRadius,[V.modal.borderRadius]:(x=b.modal)==null?void 0:x.borderRadius,[V.appBar.containerPadding]:(y=b.appBar)==null?void 0:y.containerPadding,[V.appBar.fontSize]:(p=b.appBar)==null?void 0:p.fontSize,[V.appBar.lineHeight]:(g=b.appBar)==null?void 0:g.lineHeight,[V.appBar.hitSlop]:(v=b.appBar)==null?void 0:v.hitSlop,[V.appBar.itemGap]:(j=b.appBar)==null?void 0:j.itemGap,[V.edge.width]:(N=b.edge)==null?void 0:N.width})),children:s.render()})})}}),Bx=Rt({defaultClassName:"_1yk3a452 dhthxq4 dhthxq0 dhthxqh _1yk3a451",variantClassNames:{activityEnterStyle:{slideInLeft:"_1yk3a453"},enterStyle:{cover:"_1yk3a454"},border:{true:"_1yk3a455"},modalPresentationStyle:{fullScreen:"_1yk3a456"}},defaultVariants:{},compoundVariants:[[{activityEnterStyle:"slideInLeft",enterStyle:"cover"},"_1yk3a457"]]}),Ri="_1yk3a45b dhthxq9 dhthxq7 dhthxqb dhthxqf dhthxqi",Fx="dhthxq9 dhthxq7 dhthxq8 _1yk3a450",Wx="_1yk3a45e",$x="_1yk3a45f dhthxqi dhthxq4 dhthxq2 dhthxqf",qx="_1yk3a45g dhthxqc dhthxqd dhthxq0",Hx="_1yk3a45b dhthxq9 dhthxq7 dhthxqb dhthxqf dhthxqi",Ux="_1yk3a459 dhthxqa dhthxq7 _1yk3a451",Vx="_1yk3a45a dhthxq9 dhthxq7 dhthxq1 _1yk3a450",Jx="_1yk3a45h dhthxq9 dhthxq7 dhthxq1 dhthxq5 _1yk3a450",Kx="_1yk3a458",Gx=Rt({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_1dlf434a","enter-done":"_1dlf434b","exit-active":"_1dlf434c","exit-done":"_1dlf434d"},hasAppBar:{true:"_1dlf434j"}},defaultVariants:{},compoundVariants:[]}),Qx="_1dlf434k dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 _1dlf4347 _1dlf4349",Yx=Rt({defaultClassName:"_1dlf434r dhthxq4 dhthxq2 dhthxq3 dhthxq1",variantClassNames:{hasAppBar:{true:"_1dlf434s"}},defaultVariants:{},compoundVariants:[]}),Xx="_1dlf434a",Zx="_1dlf434b",eg="_1dlf434c",tg="_1dlf434d",sg=Rt({defaultClassName:"_1dlf434l dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 _1dlf4348 _1dlf4349",variantClassNames:{hasAppBar:{true:"_1dlf434m dhthxqg"},modalPresentationStyle:{fullScreen:"_1dlf434n"},activityEnterStyle:{slideInLeft:"_1dlf434o"}},defaultVariants:{},compoundVariants:[]}),ng=Rt({defaultClassName:"_1dlf434p dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3",variantClassNames:{hasAppBar:{true:"_1dlf434q"}},defaultVariants:{},compoundVariants:[]}),ls={transitionDuration:"var(--_1dlf4340)",zIndexes:{dim:"var(--_1dlf4341)",paper:"var(--_1dlf4342)",edge:"var(--_1dlf4343)",appBar:"var(--_1dlf4344)"},appBar:{center:{mainWidth:"var(--_1dlf4346)"}}},Dc=c.forwardRef(({title:t,renderLeft:s,renderRight:n,backButton:a,closeButton:r,closeButtonLocation:o="left",border:d=!0,modalPresentationStyle:i,activityEnterStyle:l,iconColor:m,iconColorTransitionDuration:u,textColor:f,textColorTransitionDuration:h,borderColor:x,borderColorTransitionDuration:y,borderSize:p,height:g,heightTransitionDuration:v,overflow:j,backgroundColor:N,backgroundColorTransitionDuration:b,backgroundImage:S,backgroundImageTransitionDuration:k,onTopClick:P,enterStyle:_,className:A,minHeight:T,fontSize:C,lineHeight:I,hitSlop:w,containerPadding:E,itemGap:D},z)=>{var L,q;const M=nn(),F=ss(),G=Ec();pr();const Z=Lc(),B=(L=Z.appBar)==null?void 0:L.closeButton,$=(q=Z.appBar)==null?void 0:q.backButton,ye=c.useRef(null),{maxWidth:se}=wx({outerRef:z,innerRef:ye,enable:Z.theme==="cupertino"}),U=(Z.theme==="cupertino"&&i!=="fullScreen"||l==="slideInLeft")&&_!=="cover",H=ee=>{a&&"onClick"in a&&a.onClick&&a.onClick(ee),ee.defaultPrevented||M.pop()},Q=()=>{var ee,le;return!F||F.isRoot?null:!a&&!$?e.jsx("button",{type:"button","aria-label":"Go Back",className:Ri,onClick:H,children:e.jsx(Ei,{})}):a&&"render"in a&&a.render?(ee=a.render)==null?void 0:ee.call(a):$&&"render"in $&&$.render?(le=$.render)==null?void 0:le.call($):e.jsx("button",{type:"button",className:Ri,"aria-label":a&&"ariaLabel"in a?a.ariaLabel:$&&"ariaLabel"in $?$.ariaLabel:void 0,onClick:H,children:a&&"renderIcon"in a&&a.renderIcon?a.renderIcon():$&&"renderIcon"in $&&$.renderIcon?$.renderIcon():i==="fullScreen"?e.jsx(Mi,{}):e.jsx(Ei,{})})},te=ee=>{var le;r&&"onClick"in r&&r.onClick&&r.onClick(ee),!ee.defaultPrevented&&B&&"onClick"in B&&((le=B.onClick)==null||le.call(B,ee))},W=()=>{var ee;const le=!F||F.isRoot,be=he=>he&&"render"in he&&he.render||he&&"renderIcon"in he&&he.renderIcon||he&&"onClick"in he&&he.onClick;return!(be(r)||be((ee=Z.appBar)==null?void 0:ee.closeButton))||!le?null:r&&"render"in r&&r.render?r.render():B&&"render"in B&&B.render?B.render():e.jsx("button",{type:"button",className:Hx,"aria-label":r&&"ariaLabel"in r?r.ariaLabel:B&&"ariaLabel"in B?B.ariaLabel:void 0,onClick:te,children:r&&"renderIcon"in r&&r.renderIcon?r.renderIcon():B&&"renderIcon"in B&&B.renderIcon?B.renderIcon():e.jsx(Mi,{})})};return e.jsxs("div",_s(Ft({ref:z,className:Hn(Bx({border:d,modalPresentationStyle:i,activityEnterStyle:l,enterStyle:_}),A),style:an(rn({[V.appBar.iconColor]:m,[V.appBar.iconColorTransitionDuration]:u,[V.appBar.textColor]:f,[V.appBar.textColorTransitionDuration]:h,[V.appBar.borderColor]:x,[V.appBar.borderColorTransitionDuration]:y,[V.appBar.borderSize]:p,[V.appBar.height]:g,[V.appBar.heightTransitionDuration]:v,[V.appBar.overflow]:j,[V.appBar.backgroundColor]:N??(U?V.backgroundColor:"transparent"),[V.appBar.backgroundColorTransitionDuration]:b,[V.appBar.backgroundImage]:S??(U?V.appBar.backgroundImage:"none"),[V.appBar.backgroundImageTransitionDuration]:k,[ls.appBar.center.mainWidth]:`${se}px`,[V.appBar.minHeight]:T,[V.appBar.containerPadding]:E,[V.appBar.fontSize]:C,[V.appBar.hitSlop]:w,[V.appBar.lineHeight]:I,[V.appBar.itemGap]:D})),"data-part":"appBar"},G),{children:[e.jsx("div",{className:Kx}),e.jsxs("div",{className:Ux,children:[e.jsxs("div",{className:Vx,children:[o==="left"&&W(),Q(),s?.()]}),e.jsx("div",{ref:ye,className:Fx,children:e.jsxs("div",{className:Wx,children:[typeof t=="string"?e.jsx("div",{className:qx,children:t}):t,e.jsx("button",{className:$x,type:"button",onClick:P})]})}),e.jsxs("div",{className:Jx,children:[n?.(),o==="right"&&W()]})]})]}))});Dc.displayName="AppBar";var ag=Dc,rg=32,Li=80,ig=c.createContext(null),og=({backgroundColor:t,backgroundImage:s,dimBackgroundColor:n,appBar:a,preventSwipeBack:r,CUPERTINO_ONLY_modalPresentationStyle:o,ANDROID_ONLY_activityEnterStyle:d,className:i,children:l})=>{var m;const u=Lc(),f=ss(),h=Ec();pr();const{pop:x}=nn(),y=c.useRef(null),p=c.useRef(null),g=c.useRef(null),v=c.useRef(null),j=c.useRef(null),N=c.useRef(null),b=u.theme==="cupertino"?o:void 0,S=u.theme==="android"?d:void 0,k=r||b==="fullScreen",P=!!a,_=Hs();let A,T,C,I;u.theme==="cupertino"?(A=_+(b==="fullScreen"?2:0),T=_+(P&&b!=="fullScreen"?a.enterStyle==="cover"?2:1:3),C=_+4,I=_+7):(A=_,T=_+(S==="slideInLeft"&&a?.enterStyle!=="cover"?0:2),C=_+4,I=_+(S==="slideInLeft"?6:4));const w=(m=f?.transitionState)!=null?m:"enter-done",E=hr(w);kx({refs:[y]}),Sx({refs:(u.theme==="cupertino"||S==="slideInLeft")&&a?.enterStyle!=="cover"?[g]:[g,j],offsetStyles:u.theme==="cupertino"?{transform:`translate3d(-${Li/16}rem, 0, 0)`,opacity:"1"}:S==="slideInLeft"?{transform:"translate3d(-50%, 0, 0)",opacity:"0"}:{transform:`translate3d(0, -${rg/16}rem, 0)`,opacity:"1"},transitionDuration:V.computedTransitionDuration,hasEffect:b!=="fullScreen"}),Ax({dimRef:p,edgeRef:v,paperRef:g,appBarRef:j,offset:Li,transitionDuration:V.transitionDuration,moveAppBarTogether:a?.enterStyle==="cover",preventSwipeBack:k||u.theme!=="cupertino",getActivityTransitionState(){const z=g.current,L=z?.parentElement;return L?L.classList.contains(Xx)?"enter-active":L.classList.contains(Zx)?"enter-done":L.classList.contains(eg)?"exit-active":L.classList.contains(tg)?"exit-done":null:null},onSwipeEnd({swiped:z}){z&&x()}});const D=z=>{var L,q;(L=a?.onTopClick)==null||L.call(a,z),z.defaultPrevented||(q=N.current)==null||q.scroll({top:0,behavior:"smooth"})};return xr({ref:y}),e.jsx(ig.Provider,{value:c.useMemo(()=>({scroll({top:z}){var L;(L=N?.current)==null||L.scroll({top:z,behavior:"smooth"})},zIndices:{dim:A,paper:T,edge:C,appBar:I}}),[N,A,T,C,I]),children:e.jsxs("div",_s(Ft({ref:y,className:Hn(Gx({hasAppBar:P,transitionState:w==="enter-done"||w==="exit-done"?w:E}),i),style:an(rn({[V.backgroundColor]:t,[V.backgroundImage]:s,[V.dimBackgroundColor]:n,[V.appBar.height]:a?.height,[V.appBar.heightTransitionDuration]:a?.heightTransitionDuration,[ls.zIndexes.dim]:`${A}`,[ls.zIndexes.paper]:`${T}`,[ls.zIndexes.edge]:`${C}`,[ls.zIndexes.appBar]:`${I}`,[ls.transitionDuration]:w==="enter-active"||w==="exit-active"?V.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"AppScreen"},h),{children:[S!=="slideInLeft"&&e.jsx("div",Ft({ref:p,className:Qx,"data-part":"dim"},h)),a&&e.jsx(ag,_s(Ft({},a),{ref:j,modalPresentationStyle:b,activityEnterStyle:S,onTopClick:D})),e.jsx("div",_s(Ft({ref:g,className:sg({hasAppBar:P,modalPresentationStyle:b,activityEnterStyle:S}),"data-part":"paper"},h),{children:e.jsx("div",{ref:N,className:ng({hasAppBar:P}),children:l})}),f?.id),!f?.isRoot&&u.theme==="cupertino"&&!k&&e.jsx("div",Ft({ref:v,className:Yx({hasAppBar:P}),"data-part":"edge"},h))]}))})},oe=og,cg=Rt({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_1ht38h04","enter-done":"_1ht38h05","exit-active":"_1ht38h06","exit-done":"_1ht38h07"}},defaultVariants:{},compoundVariants:[]}),lg="_1ht38h0d dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc dhthxqa dhthxq7 _1ht38h03",dg="_1ht38h0e dhthxqc _1ht38h03",da={transitionDuration:"var(--_1ht38h00)",zIndexes:{dim:"var(--_1ht38h01)",paper:"var(--_1ht38h02)"}},zc=({borderRadius:t="1rem",backgroundColor:s,backgroundImage:n,dimBackgroundColor:a,paperRef:r,onOutsideClick:o,children:d,className:i})=>{var l;const m=ss(),{pop:u}=nn(),f=c.useRef(null),h=c.useRef(null);ct({styleName:"hide",refs:[f]}),ct({styleName:"offset",refs:[h]}),ct({styleName:"swipe-back",refs:[h]});const x=c.useRef(!1),y=N=>{o?.(N),!N.defaultPrevented&&(x.current||(x.current=!0,u()))},p=N=>{N.stopPropagation()},g=Hs()+3,v=Hs()+4,j=(l=m?.transitionState)!=null?l:"enter-done";return xr({ref:f}),e.jsx("div",{className:Hn(cg({transitionState:hr(j)}),i),ref:f,style:an(rn({[V.bottomSheet.borderRadius]:t,[V.backgroundColor]:s,[V.backgroundImage]:n,[V.dimBackgroundColor]:a,[da.zIndexes.dim]:`${g}`,[da.zIndexes.paper]:`${v}`,[da.transitionDuration]:j==="enter-active"||j==="exit-active"?V.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"BottomSheet","data-stackflow-activity-id":m?.id,"data-stackflow-activity-is-active":m?.isActive,children:e.jsx("div",{className:lg,ref:h,onClick:y,children:e.jsx("div",{className:dg,ref:r,onClick:p,children:d})})})};zc.displayName="BottomSheet";var ug=zc,mg=Rt({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_5ozg8c4","enter-done":"_5ozg8c5","exit-active":"_5ozg8c6","exit-done":"_5ozg8c7"}},defaultVariants:{},compoundVariants:[]}),fg="_5ozg8cd dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc dhthxq9 dhthxq7 dhthxqb _5ozg8c3",pg="_5ozg8ce dhthxqc _5ozg8c3",ua={transitionDuration:"var(--_5ozg8c0)",zIndexes:{dim:"var(--_5ozg8c1)",paper:"var(--_5ozg8c2)"}},Oc=({backgroundColor:t,backgroundImage:s,dimBackgroundColor:n,borderRadius:a="1rem",maxWidth:r,onOutsideClick:o,children:d,className:i})=>{var l;const m=ss(),{pop:u}=nn(),f=c.useRef(null),h=c.useRef(null);ct({styleName:"hide",refs:[f]}),ct({styleName:"offset",refs:[h]}),ct({styleName:"swipe-back",refs:[h]});const x=c.useRef(!1),y=N=>{o?.(N),!N.defaultPrevented&&(x.current||(x.current=!0,u()))},p=N=>{N.stopPropagation()},g=Hs()+3,v=Hs()+4,j=(l=m?.transitionState)!=null?l:"enter-done";return xr({ref:f}),e.jsx("div",{className:Hn(mg({transitionState:hr(j)}),i),ref:f,style:an(rn({[V.backgroundColor]:t,[V.backgroundImage]:s,[V.dimBackgroundColor]:n,[V.modal.borderRadius]:a,[V.modal.maxWidth]:r,[ua.zIndexes.dim]:`${g}`,[ua.zIndexes.paper]:`${v}`,[ua.transitionDuration]:j==="enter-active"||j==="exit-active"?V.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"Modal","data-stackflow-activity-id":m?.id,"data-stackflow-activity-is-active":m?.isActive,children:e.jsx("div",{className:fg,ref:h,onClick:y,children:e.jsx("div",{className:pg,onClick:p,children:d})})})};Oc.displayName="Modal";var hg=Oc,xg=Object.defineProperty,Y=(t,s)=>xg(t,"name",{value:s,configurable:!0}),ps=class{type=3;name="";prefix="";value="";suffix="";modifier=3;constructor(t,s,n,a,r,o){this.type=t,this.name=s,this.prefix=n,this.value=a,this.suffix=r,this.modifier=o}hasCustomName(){return this.name!==""&&typeof this.name!="number"}};Y(ps,"Part");var gg=/[$_\p{ID_Start}]/u,vg=/[$_\u200C\u200D\p{ID_Continue}]/u,Ia=".*";function Bc(t,s){return(s?/^[\x00-\xFF]*$/:/^[\x00-\x7F]*$/).test(t)}Y(Bc,"isASCII");function gr(t,s=!1){let n=[],a=0;for(;a<t.length;){let r=t[a],o=Y(function(d){if(!s)throw new TypeError(d);n.push({type:"INVALID_CHAR",index:a,value:t[a++]})},"ErrorOrInvalid");if(r==="*"){n.push({type:"ASTERISK",index:a,value:t[a++]});continue}if(r==="+"||r==="?"){n.push({type:"OTHER_MODIFIER",index:a,value:t[a++]});continue}if(r==="\\"){n.push({type:"ESCAPED_CHAR",index:a++,value:t[a++]});continue}if(r==="{"){n.push({type:"OPEN",index:a,value:t[a++]});continue}if(r==="}"){n.push({type:"CLOSE",index:a,value:t[a++]});continue}if(r===":"){let d="",i=a+1;for(;i<t.length;){let l=t.substr(i,1);if(i===a+1&&gg.test(l)||i!==a+1&&vg.test(l)){d+=t[i++];continue}break}if(!d){o(`Missing parameter name at ${a}`);continue}n.push({type:"NAME",index:a,value:d}),a=i;continue}if(r==="("){let d=1,i="",l=a+1,m=!1;if(t[l]==="?"){o(`Pattern cannot start with "?" at ${l}`);continue}for(;l<t.length;){if(!Bc(t[l],!1)){o(`Invalid character '${t[l]}' at ${l}.`),m=!0;break}if(t[l]==="\\"){i+=t[l++]+t[l++];continue}if(t[l]===")"){if(d--,d===0){l++;break}}else if(t[l]==="("&&(d++,t[l+1]!=="?")){o(`Capturing groups are not allowed at ${l}`),m=!0;break}i+=t[l++]}if(m)continue;if(d){o(`Unbalanced pattern at ${a}`);continue}if(!i){o(`Missing pattern at ${a}`);continue}n.push({type:"REGEX",index:a,value:i}),a=l;continue}n.push({type:"CHAR",index:a,value:t[a++]})}return n.push({type:"END",index:a,value:""}),n}Y(gr,"lexer");function vr(t,s={}){let n=gr(t);s.delimiter??="/#?",s.prefixes??="./";let a=`[^${Me(s.delimiter)}]+?`,r=[],o=0,d=0,i=new Set,l=Y(j=>{if(d<n.length&&n[d].type===j)return n[d++].value},"tryConsume"),m=Y(()=>l("OTHER_MODIFIER")??l("ASTERISK"),"tryConsumeModifier"),u=Y(j=>{let N=l(j);if(N!==void 0)return N;let{type:b,index:S}=n[d];throw new TypeError(`Unexpected ${b} at ${S}, expected ${j}`)},"mustConsume"),f=Y(()=>{let j="",N;for(;N=l("CHAR")??l("ESCAPED_CHAR");)j+=N;return j},"consumeText"),h=Y(j=>j,"DefaultEncodePart"),x=s.encodePart||h,y="",p=Y(j=>{y+=j},"appendToPendingFixedValue"),g=Y(()=>{y.length&&(r.push(new ps(3,"","",x(y),"",3)),y="")},"maybeAddPartFromPendingFixedValue"),v=Y((j,N,b,S,k)=>{let P=3;switch(k){case"?":P=1;break;case"*":P=0;break;case"+":P=2;break}if(!N&&!b&&P===3){p(j);return}if(g(),!N&&!b){if(!j)return;r.push(new ps(3,"","",x(j),"",P));return}let _;b?b==="*"?_=Ia:_=b:_=a;let A=2;_===a?(A=1,_=""):_===Ia&&(A=0,_="");let T;if(N?T=N:b&&(T=o++),i.has(T))throw new TypeError(`Duplicate name '${T}'.`);i.add(T),r.push(new ps(A,T,x(j),_,x(S),P))},"addPart");for(;d<n.length;){let j=l("CHAR"),N=l("NAME"),b=l("REGEX");if(!N&&!b&&(b=l("ASTERISK")),N||b){let k=j??"";s.prefixes.indexOf(k)===-1&&(p(k),k=""),g();let P=m();v(k,N,b,"",P);continue}let S=j??l("ESCAPED_CHAR");if(S){p(S);continue}if(l("OPEN")){let k=f(),P=l("NAME"),_=l("REGEX");!P&&!_&&(_=l("ASTERISK"));let A=f();u("CLOSE");let T=m();v(k,P,_,A,T);continue}g(),u("END")}return r}Y(vr,"parse");function Me(t){return t.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}Y(Me,"escapeString");function Ta(t){return t&&t.ignoreCase?"ui":"u"}Y(Ta,"flags");function Fc(t,s,n){return yr(vr(t,n),s,n)}Y(Fc,"stringToRegexp");function qt(t){switch(t){case 0:return"*";case 1:return"?";case 2:return"+";case 3:return""}}Y(qt,"modifierToString");function yr(t,s,n={}){n.delimiter??="/#?",n.prefixes??="./",n.sensitive??=!1,n.strict??=!1,n.end??=!0,n.start??=!0,n.endsWith="";let a=n.start?"^":"";for(let i of t){if(i.type===3){i.modifier===3?a+=Me(i.value):a+=`(?:${Me(i.value)})${qt(i.modifier)}`;continue}s&&s.push(i.name);let l=`[^${Me(n.delimiter)}]+?`,m=i.value;if(i.type===1?m=l:i.type===0&&(m=Ia),!i.prefix.length&&!i.suffix.length){i.modifier===3||i.modifier===1?a+=`(${m})${qt(i.modifier)}`:a+=`((?:${m})${qt(i.modifier)})`;continue}if(i.modifier===3||i.modifier===1){a+=`(?:${Me(i.prefix)}(${m})${Me(i.suffix)})`,a+=qt(i.modifier);continue}a+=`(?:${Me(i.prefix)}`,a+=`((?:${m})(?:`,a+=Me(i.suffix),a+=Me(i.prefix),a+=`(?:${m}))*)${Me(i.suffix)})`,i.modifier===0&&(a+="?")}let r=`[${Me(n.endsWith)}]|$`,o=`[${Me(n.delimiter)}]`;if(n.end)return n.strict||(a+=`${o}?`),n.endsWith.length?a+=`(?=${r})`:a+="$",new RegExp(a,Ta(n));n.strict||(a+=`(?:${o}(?=${r}))?`);let d=!1;if(t.length){let i=t[t.length-1];i.type===3&&i.modifier===3&&(d=n.delimiter.indexOf(i)>-1)}return d||(a+=`(?=${o}|${r})`),new RegExp(a,Ta(n))}Y(yr,"partsToRegexp");var bt={delimiter:"",prefixes:"",sensitive:!0,strict:!0},yg={delimiter:".",prefixes:"",sensitive:!0,strict:!0},bg={delimiter:"/",prefixes:"/",sensitive:!0,strict:!0};function Wc(t,s){return t.length?t[0]==="/"?!0:!s||t.length<2?!1:(t[0]=="\\"||t[0]=="{")&&t[1]=="/":!1}Y(Wc,"isAbsolutePathname");function br(t,s){return t.startsWith(s)?t.substring(s.length,t.length):t}Y(br,"maybeStripPrefix");function $c(t,s){return t.endsWith(s)?t.substr(0,t.length-s.length):t}Y($c,"maybeStripSuffix");function jr(t){return!t||t.length<2?!1:t[0]==="["||(t[0]==="\\"||t[0]==="{")&&t[1]==="["}Y(jr,"treatAsIPv6Hostname");var qc=["ftp","file","http","https","ws","wss"];function Nr(t){if(!t)return!0;for(let s of qc)if(t.test(s))return!0;return!1}Y(Nr,"isSpecialScheme");function Hc(t,s){if(t=br(t,"#"),s||t==="")return t;let n=new URL("https://example.com");return n.hash=t,n.hash?n.hash.substring(1,n.hash.length):""}Y(Hc,"canonicalizeHash");function Uc(t,s){if(t=br(t,"?"),s||t==="")return t;let n=new URL("https://example.com");return n.search=t,n.search?n.search.substring(1,n.search.length):""}Y(Uc,"canonicalizeSearch");function Vc(t,s){return s||t===""?t:jr(t)?kr(t):Cr(t)}Y(Vc,"canonicalizeHostname");function Jc(t,s){if(s||t==="")return t;let n=new URL("https://example.com");return n.password=t,n.password}Y(Jc,"canonicalizePassword");function Kc(t,s){if(s||t==="")return t;let n=new URL("https://example.com");return n.username=t,n.username}Y(Kc,"canonicalizeUsername");function Gc(t,s,n){if(n||t==="")return t;if(s&&!qc.includes(s))return new URL(`${s}:${t}`).pathname;let a=t[0]=="/";return t=new URL(a?t:"/-"+t,"https://example.com").pathname,a||(t=t.substring(2,t.length)),t}Y(Gc,"canonicalizePathname");function Qc(t,s,n){return wr(s)===t&&(t=""),n||t===""?t:Sr(t)}Y(Qc,"canonicalizePort");function Yc(t,s){return t=$c(t,":"),s||t===""?t:Gn(t)}Y(Yc,"canonicalizeProtocol");function wr(t){switch(t){case"ws":case"http":return"80";case"wws":case"https":return"443";case"ftp":return"21";default:return""}}Y(wr,"defaultPortForProtocol");function Gn(t){if(t==="")return t;if(/^[-+.A-Za-z0-9]*$/.test(t))return t.toLowerCase();throw new TypeError(`Invalid protocol '${t}'.`)}Y(Gn,"protocolEncodeCallback");function Xc(t){if(t==="")return t;let s=new URL("https://example.com");return s.username=t,s.username}Y(Xc,"usernameEncodeCallback");function Zc(t){if(t==="")return t;let s=new URL("https://example.com");return s.password=t,s.password}Y(Zc,"passwordEncodeCallback");function Cr(t){if(t==="")return t;if(/[\t\n\r #%/:<>?@[\]^\\|]/g.test(t))throw new TypeError(`Invalid hostname '${t}'`);let s=new URL("https://example.com");return s.hostname=t,s.hostname}Y(Cr,"hostnameEncodeCallback");function kr(t){if(t==="")return t;if(/[^0-9a-fA-F[\]:]/g.test(t))throw new TypeError(`Invalid IPv6 hostname '${t}'`);return t.toLowerCase()}Y(kr,"ipv6HostnameEncodeCallback");function Sr(t){if(t===""||/^[0-9]*$/.test(t)&&parseInt(t)<=65535)return t;throw new TypeError(`Invalid port '${t}'.`)}Y(Sr,"portEncodeCallback");function el(t){if(t==="")return t;let s=new URL("https://example.com");return s.pathname=t[0]!=="/"?"/-"+t:t,t[0]!=="/"?s.pathname.substring(2,s.pathname.length):s.pathname}Y(el,"standardURLPathnameEncodeCallback");function tl(t){return t===""?t:new URL(`data:${t}`).pathname}Y(tl,"pathURLPathnameEncodeCallback");function sl(t){if(t==="")return t;let s=new URL("https://example.com");return s.search=t,s.search.substring(1,s.search.length)}Y(sl,"searchEncodeCallback");function nl(t){if(t==="")return t;let s=new URL("https://example.com");return s.hash=t,s.hash.substring(1,s.hash.length)}Y(nl,"hashEncodeCallback");var al=class{#r;#n=[];#t={};#e=0;#a=1;#l=0;#o=0;#f=0;#p=0;#h=!1;constructor(t){this.#r=t}get result(){return this.#t}parse(){for(this.#n=gr(this.#r,!0);this.#e<this.#n.length;this.#e+=this.#a){if(this.#a=1,this.#n[this.#e].type==="END"){if(this.#o===0){this.#y(),this.#d()?this.#s(9,1):this.#u()?this.#s(8,1):this.#s(7,0);continue}else if(this.#o===2){this.#m(5);continue}this.#s(10,0);break}if(this.#f>0)if(this.#S())this.#f-=1;else continue;if(this.#k()){this.#f+=1;continue}switch(this.#o){case 0:this.#b()&&this.#m(1);break;case 1:if(this.#b()){this.#T();let t=7,s=1;this.#N()?(t=2,s=3):this.#h&&(t=2),this.#s(t,s)}break;case 2:this.#g()?this.#m(3):(this.#v()||this.#u()||this.#d())&&this.#m(5);break;case 3:this.#w()?this.#s(4,1):this.#g()&&this.#s(5,1);break;case 4:this.#g()&&this.#s(5,1);break;case 5:this.#A()?this.#p+=1:this.#I()&&(this.#p-=1),this.#C()&&!this.#p?this.#s(6,1):this.#v()?this.#s(7,0):this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 6:this.#v()?this.#s(7,0):this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 7:this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 8:this.#d()&&this.#s(9,1);break}}this.#t.hostname!==void 0&&this.#t.port===void 0&&(this.#t.port="")}#s(t,s){switch(this.#o){case 0:break;case 1:this.#t.protocol=this.#c();break;case 2:break;case 3:this.#t.username=this.#c();break;case 4:this.#t.password=this.#c();break;case 5:this.#t.hostname=this.#c();break;case 6:this.#t.port=this.#c();break;case 7:this.#t.pathname=this.#c();break;case 8:this.#t.search=this.#c();break;case 9:this.#t.hash=this.#c();break}this.#o!==0&&t!==10&&([1,2,3,4].includes(this.#o)&&[6,7,8,9].includes(t)&&(this.#t.hostname??=""),[1,2,3,4,5,6].includes(this.#o)&&[8,9].includes(t)&&(this.#t.pathname??=this.#h?"/":""),[1,2,3,4,5,6,7].includes(this.#o)&&t===9&&(this.#t.search??="")),this.#j(t,s)}#j(t,s){this.#o=t,this.#l=this.#e+s,this.#e+=s,this.#a=0}#y(){this.#e=this.#l,this.#a=0}#m(t){this.#y(),this.#o=t}#x(t){return t<0&&(t=this.#n.length-t),t<this.#n.length?this.#n[t]:this.#n[this.#n.length-1]}#i(t,s){let n=this.#x(t);return n.value===s&&(n.type==="CHAR"||n.type==="ESCAPED_CHAR"||n.type==="INVALID_CHAR")}#b(){return this.#i(this.#e,":")}#N(){return this.#i(this.#e+1,"/")&&this.#i(this.#e+2,"/")}#g(){return this.#i(this.#e,"@")}#w(){return this.#i(this.#e,":")}#C(){return this.#i(this.#e,":")}#v(){return this.#i(this.#e,"/")}#u(){if(this.#i(this.#e,"?"))return!0;if(this.#n[this.#e].value!=="?")return!1;let t=this.#x(this.#e-1);return t.type!=="NAME"&&t.type!=="REGEX"&&t.type!=="CLOSE"&&t.type!=="ASTERISK"}#d(){return this.#i(this.#e,"#")}#k(){return this.#n[this.#e].type=="OPEN"}#S(){return this.#n[this.#e].type=="CLOSE"}#A(){return this.#i(this.#e,"[")}#I(){return this.#i(this.#e,"]")}#c(){let t=this.#n[this.#e],s=this.#x(this.#l).index;return this.#r.substring(s,t.index)}#T(){let t={};Object.assign(t,bt),t.encodePart=Gn;let s=Fc(this.#c(),void 0,t);this.#h=Nr(s)}};Y(al,"Parser");var ma=["protocol","username","password","hostname","port","pathname","search","hash"],vt="*";function Pa(t,s){if(typeof t!="string")throw new TypeError("parameter 1 is not of type 'string'.");let n=new URL(t,s);return{protocol:n.protocol.substring(0,n.protocol.length-1),username:n.username,password:n.password,hostname:n.hostname,port:n.port,pathname:n.pathname,search:n.search!==""?n.search.substring(1,n.search.length):void 0,hash:n.hash!==""?n.hash.substring(1,n.hash.length):void 0}}Y(Pa,"extractValues");function Qe(t,s){return s?ms(t):t}Y(Qe,"processBaseURLString");function ds(t,s,n){let a;if(typeof s.baseURL=="string")try{a=new URL(s.baseURL),s.protocol===void 0&&(t.protocol=Qe(a.protocol.substring(0,a.protocol.length-1),n)),!n&&s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.username===void 0&&(t.username=Qe(a.username,n)),!n&&s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.username===void 0&&s.password===void 0&&(t.password=Qe(a.password,n)),s.protocol===void 0&&s.hostname===void 0&&(t.hostname=Qe(a.hostname,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&(t.port=Qe(a.port,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&(t.pathname=Qe(a.pathname,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&s.search===void 0&&(t.search=Qe(a.search.substring(1,a.search.length),n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&s.search===void 0&&s.hash===void 0&&(t.hash=Qe(a.hash.substring(1,a.hash.length),n))}catch{throw new TypeError(`invalid baseURL '${s.baseURL}'.`)}if(typeof s.protocol=="string"&&(t.protocol=Yc(s.protocol,n)),typeof s.username=="string"&&(t.username=Kc(s.username,n)),typeof s.password=="string"&&(t.password=Jc(s.password,n)),typeof s.hostname=="string"&&(t.hostname=Vc(s.hostname,n)),typeof s.port=="string"&&(t.port=Qc(s.port,t.protocol,n)),typeof s.pathname=="string"){if(t.pathname=s.pathname,a&&!Wc(t.pathname,n)){let r=a.pathname.lastIndexOf("/");r>=0&&(t.pathname=Qe(a.pathname.substring(0,r+1),n)+t.pathname)}t.pathname=Gc(t.pathname,t.protocol,n)}return typeof s.search=="string"&&(t.search=Uc(s.search,n)),typeof s.hash=="string"&&(t.hash=Hc(s.hash,n)),t}Y(ds,"applyInit");function ms(t){return t.replace(/([+*?:{}()\\])/g,"\\$1")}Y(ms,"escapePatternString");function rl(t){return t.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}Y(rl,"escapeRegexpString");function il(t,s){s.delimiter??="/#?",s.prefixes??="./",s.sensitive??=!1,s.strict??=!1,s.end??=!0,s.start??=!0,s.endsWith="";let n=".*",a=`[^${rl(s.delimiter)}]+?`,r=/[$_\u200C\u200D\p{ID_Continue}]/u,o="";for(let d=0;d<t.length;++d){let i=t[d];if(i.type===3){if(i.modifier===3){o+=ms(i.value);continue}o+=`{${ms(i.value)}}${qt(i.modifier)}`;continue}let l=i.hasCustomName(),m=!!i.suffix.length||!!i.prefix.length&&(i.prefix.length!==1||!s.prefixes.includes(i.prefix)),u=d>0?t[d-1]:null,f=d<t.length-1?t[d+1]:null;if(!m&&l&&i.type===1&&i.modifier===3&&f&&!f.prefix.length&&!f.suffix.length)if(f.type===3){let h=f.value.length>0?f.value[0]:"";m=r.test(h)}else m=!f.hasCustomName();if(!m&&!i.prefix.length&&u&&u.type===3){let h=u.value[u.value.length-1];m=s.prefixes.includes(h)}m&&(o+="{"),o+=ms(i.prefix),l&&(o+=`:${i.name}`),i.type===2?o+=`(${i.value})`:i.type===1?l||(o+=`(${a})`):i.type===0&&(!l&&(!u||u.type===3||u.modifier!==3||m||i.prefix!=="")?o+="*":o+=`(${n})`),i.type===1&&l&&i.suffix.length&&r.test(i.suffix[0])&&(o+="\\"),o+=ms(i.suffix),m&&(o+="}"),i.modifier!==3&&(o+=qt(i.modifier))}return o}Y(il,"partsToPattern");var ol=class{#r;#n={};#t={};#e={};#a={};#l=!1;constructor(t={},s,n){try{let a;if(typeof s=="string"?a=s:n=s,typeof t=="string"){let i=new al(t);if(i.parse(),t=i.result,a===void 0&&typeof t.protocol!="string")throw new TypeError("A base URL must be provided for a relative constructor string.");t.baseURL=a}else{if(!t||typeof t!="object")throw new TypeError("parameter 1 is not of type 'string' and cannot convert to dictionary.");if(a)throw new TypeError("parameter 1 is not of type 'string'.")}typeof n>"u"&&(n={ignoreCase:!1});let r={ignoreCase:n.ignoreCase===!0},o={pathname:vt,protocol:vt,username:vt,password:vt,hostname:vt,port:vt,search:vt,hash:vt};this.#r=ds(o,t,!0),wr(this.#r.protocol)===this.#r.port&&(this.#r.port="");let d;for(d of ma){if(!(d in this.#r))continue;let i={},l=this.#r[d];switch(this.#t[d]=[],d){case"protocol":Object.assign(i,bt),i.encodePart=Gn;break;case"username":Object.assign(i,bt),i.encodePart=Xc;break;case"password":Object.assign(i,bt),i.encodePart=Zc;break;case"hostname":Object.assign(i,yg),jr(l)?i.encodePart=kr:i.encodePart=Cr;break;case"port":Object.assign(i,bt),i.encodePart=Sr;break;case"pathname":Nr(this.#n.protocol)?(Object.assign(i,bg,r),i.encodePart=el):(Object.assign(i,bt,r),i.encodePart=tl);break;case"search":Object.assign(i,bt,r),i.encodePart=sl;break;case"hash":Object.assign(i,bt,r),i.encodePart=nl;break}try{this.#a[d]=vr(l,i),this.#n[d]=yr(this.#a[d],this.#t[d],i),this.#e[d]=il(this.#a[d],i),this.#l=this.#l||this.#a[d].some(m=>m.type===2)}catch{throw new TypeError(`invalid ${d} pattern '${this.#r[d]}'.`)}}}catch(a){throw new TypeError(`Failed to construct 'URLPattern': ${a.message}`)}}get[Symbol.toStringTag](){return"URLPattern"}test(t={},s){let n={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof t!="string"&&s)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof t>"u")return!1;try{typeof t=="object"?n=ds(n,t,!1):n=ds(n,Pa(t,s),!1)}catch{return!1}let a;for(a of ma)if(!this.#n[a].exec(n[a]))return!1;return!0}exec(t={},s){let n={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof t!="string"&&s)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof t>"u")return;try{typeof t=="object"?n=ds(n,t,!1):n=ds(n,Pa(t,s),!1)}catch{return null}let a={};s?a.inputs=[t,s]:a.inputs=[t];let r;for(r of ma){let o=this.#n[r].exec(n[r]);if(!o)return null;let d={};for(let[i,l]of this.#t[r].entries())if(typeof l=="string"||typeof l=="number"){let m=o[i+1];d[l]=m}a[r]={input:n[r]??"",groups:d}}return a}static compareComponent(t,s,n){let a=Y((i,l)=>{for(let m of["type","modifier","prefix","value","suffix"]){if(i[m]<l[m])return-1;if(i[m]!==l[m])return 1}return 0},"comparePart"),r=new ps(3,"","","","",3),o=new ps(0,"","","","",3),d=Y((i,l)=>{let m=0;for(;m<Math.min(i.length,l.length);++m){let u=a(i[m],l[m]);if(u)return u}return i.length===l.length?0:a(i[m]??r,l[m]??r)},"comparePartList");return!s.#e[t]&&!n.#e[t]?0:s.#e[t]&&!n.#e[t]?d(s.#a[t],[o]):!s.#e[t]&&n.#e[t]?d([o],n.#a[t]):d(s.#a[t],n.#a[t])}get protocol(){return this.#e.protocol}get username(){return this.#e.username}get password(){return this.#e.password}get hostname(){return this.#e.hostname}get port(){return this.#e.port}get pathname(){return this.#e.pathname}get search(){return this.#e.search}get hash(){return this.#e.hash}get hasRegExpGroups(){return this.#l}};Y(ol,"URLPattern");globalThis.URLPattern||(globalThis.URLPattern=ol);const jg=c.createContext({requestHistoryTick:()=>{}}),cl=({children:t,requestHistoryTick:s})=>{const n=c.useMemo(()=>({requestHistoryTick:s}),[s]);return e.jsx(jg.Provider,{value:n,children:t})};cl.__docgenInfo={description:"",methods:[],displayName:"HistoryQueueProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},requestHistoryTick:{required:!0,tsType:{name:"signature",type:"function",raw:"(cb: (resolve: () => void) => void) => void",signature:{arguments:[{type:{name:"signature",type:"function",raw:"(resolve: () => void) => void",signature:{arguments:[{type:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},name:"resolve"}],return:{name:"void"}}},name:"cb"}],return:{name:"void"}}},description:""}}};function vs(){return vs=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},vs.apply(null,arguments)}var Ze;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ze||(Ze={}));var En=function(t){return t},Di="beforeunload",Ng="popstate";function wg(t){t===void 0&&(t={});var s=t,n=s.window,a=n===void 0?document.defaultView:n,r=a.history;function o(){var P=a.location,_=P.pathname,A=P.search,T=P.hash,C=r.state||{};return[C.idx,En({pathname:_,search:A,hash:T,state:C.usr||null,key:C.key||"default"})]}var d=null;function i(){if(d)x.call(d),d=null;else{var P=Ze.Pop,_=o(),A=_[0],T=_[1];if(x.length){if(A!=null){var C=u-A;C&&(d={action:P,location:T,retry:function(){S(C*-1)}},S(C))}}else j(P)}}a.addEventListener(Ng,i);var l=Ze.Pop,m=o(),u=m[0],f=m[1],h=Mn(),x=Mn();u==null&&(u=0,r.replaceState(vs({},r.state,{idx:u}),""));function y(P){return typeof P=="string"?P:ll(P)}function p(P,_){return _===void 0&&(_=null),En(vs({pathname:f.pathname,hash:"",search:""},typeof P=="string"?Ea(P):P,{state:_,key:_a()}))}function g(P,_){return[{usr:P.state,key:P.key,idx:_},y(P)]}function v(P,_,A){return!x.length||(x.call({action:P,location:_,retry:A}),!1)}function j(P){l=P;var _=o();u=_[0],f=_[1],h.call({action:l,location:f})}function N(P,_){var A=Ze.Push,T=p(P,_);function C(){N(P,_)}if(v(A,T,C)){var I=g(T,u+1),w=I[0],E=I[1];try{r.pushState(w,"",E)}catch{a.location.assign(E)}j(A)}}function b(P,_){var A=Ze.Replace,T=p(P,_);function C(){b(P,_)}if(v(A,T,C)){var I=g(T,u),w=I[0],E=I[1];r.replaceState(w,"",E),j(A)}}function S(P){r.go(P)}var k={get action(){return l},get location(){return f},createHref:y,push:N,replace:b,go:S,back:function(){S(-1)},forward:function(){S(1)},listen:function(_){return h.push(_)},block:function(_){var A=x.push(_);return x.length===1&&a.addEventListener(Di,Oi),function(){A(),x.length||a.removeEventListener(Di,Oi)}}};return k}function Cg(t){t===void 0&&(t={});var s=t,n=s.initialEntries,a=n===void 0?["/"]:n,r=s.initialIndex,o=a.map(function(N){var b=En(vs({pathname:"/",search:"",hash:"",state:null,key:_a()},typeof N=="string"?Ea(N):N));return b}),d=zi(r??o.length-1,0,o.length-1),i=Ze.Pop,l=o[d],m=Mn(),u=Mn();function f(N){return typeof N=="string"?N:ll(N)}function h(N,b){return b===void 0&&(b=null),En(vs({pathname:l.pathname,search:"",hash:""},typeof N=="string"?Ea(N):N,{state:b,key:_a()}))}function x(N,b,S){return!u.length||(u.call({action:N,location:b,retry:S}),!1)}function y(N,b){i=N,l=b,m.call({action:i,location:l})}function p(N,b){var S=Ze.Push,k=h(N,b);function P(){p(N,b)}x(S,k,P)&&(d+=1,o.splice(d,o.length,k),y(S,k))}function g(N,b){var S=Ze.Replace,k=h(N,b);function P(){g(N,b)}x(S,k,P)&&(o[d]=k,y(S,k))}function v(N){var b=zi(d+N,0,o.length-1),S=Ze.Pop,k=o[b];function P(){v(N)}x(S,k,P)&&(d=b,y(S,k))}var j={get index(){return d},get action(){return i},get location(){return l},createHref:f,push:p,replace:g,go:v,back:function(){v(-1)},forward:function(){v(1)},listen:function(b){return m.push(b)},block:function(b){return u.push(b)}};return j}function zi(t,s,n){return Math.min(Math.max(t,s),n)}function Oi(t){t.preventDefault(),t.returnValue=""}function Mn(){var t=[];return{get length(){return t.length},push:function(n){return t.push(n),function(){t=t.filter(function(a){return a!==n})}},call:function(n){t.forEach(function(a){return a&&a(n)})}}}function _a(){return Math.random().toString(36).substr(2,8)}function ll(t){var s=t.pathname,n=s===void 0?"/":s,a=t.search,r=a===void 0?"":a,o=t.hash,d=o===void 0?"":o;return r&&r!=="?"&&(n+=r.charAt(0)==="?"?r:"?"+r),d&&d!=="#"&&(n+=d.charAt(0)==="#"?d:"#"+d),n}function Ea(t){var s={};if(t){var n=t.indexOf("#");n>=0&&(s.hash=t.substr(n),t=t.substr(0,n));var a=t.indexOf("?");a>=0&&(s.search=t.substr(a),t=t.substr(0,a)),t&&(s.pathname=t)}return s}const kg=c.createContext([]);function dl(t){return t.name==="Pushed"||t.name==="Popped"||t.name==="Replaced"}function Sg(t){return t.name==="StepPushed"||t.name==="StepPopped"||t.name==="StepReplaced"}function Ag(t){return dl(t)||Sg(t)}const Wt={IDLE:"idle",PROGRESS:"progress",SUCCEEDED:"succeeded",FAILED:"failed"};function ul(t){return t===Wt.SUCCEEDED||t===Wt.FAILED}class Ig{targetId;initialSetupProcess;focusCount;previousActivationTrigger;constructor(s,n){this.targetId=s,this.initialSetupProcess=n,this.focusCount=0,this.previousActivationTrigger=null}captureStackChange(s){const n=this.initialSetupProcess.getStatus();if(!ul(n))return;const a=s.activities.find(o=>o.id===this.targetId);if(!a||!a.isActive)return;const r=s.events.findLast(dl);!r||this.previousActivationTrigger&&r.eventDate<=this.previousActivationTrigger.eventDate||(this.focusCount++,this.previousActivationTrigger=r)}getActivationCount(){return this.focusCount}getTargetId(){return this.targetId}}const{parse:Tg,stringify:Pg}=JSON,{keys:_g}=Object,Us=String,ml="string",Bi={},Ar="object",fl=(t,s)=>s,Eg=t=>t instanceof Us?Us(t):t,Mg=(t,s)=>typeof s===ml?new Us(s):s,pl=(t,s,n,a)=>{const r=[];for(let o=_g(n),{length:d}=o,i=0;i<d;i++){const l=o[i],m=n[l];if(m instanceof Us){const u=t[m];typeof u===Ar&&!s.has(u)?(s.add(u),n[l]=Bi,r.push({k:l,a:[t,s,u,a]})):n[l]=a.call(n,l,u)}else n[l]!==Bi&&(n[l]=a.call(n,l,m))}for(let{length:o}=r,d=0;d<o;d++){const{k:i,a:l}=r[d];n[i]=a.call(n,i,pl.apply(null,l))}return n},Fi=(t,s,n)=>{const a=Us(s.push(n)-1);return t.set(n,a),a},Rg=(t,s)=>{const n=Tg(t,Mg).map(Eg),a=n[0],r=s||fl,o=typeof a===Ar&&a?pl(n,new Set,a,r):a;return r.call({"":o},"",o)},Lg=(t,s,n)=>{const a=fl,r=new Map,o=[],d=[];let i=+Fi(r,o,a.call({"":t},"",t)),l=!i;for(;i<o.length;)l=!0,d[i]=Pg(o[i++],m,n);return"["+d.join(",")+"]";function m(u,f){if(l)return l=!l,f;const h=a.call(this,u,f);switch(typeof h){case Ar:if(h===null)return h;case ml:return r.get(h)||Fi(r,o,h)}return h}},hl="@biochain/plugin-navigation-sync";function xl(t){return{_TAG:hl,flattedState:Lg({activity:t.activity,step:t.step})}}function Dg(t){return typeof t=="object"&&t!==null&&"_TAG"in t&&"flattedState"in t&&typeof t._TAG=="string"&&t._TAG===hl&&typeof t.flattedState=="string"}function pn(t){try{return Dg(t)?Rg(t.flattedState):null}catch{return null}}function Wi({history:t,pathname:s,state:n,useHash:a}){const r=a?`${t.location.pathname}#${s}`:s;t.push(r,xl(n))}function fa({history:t,pathname:s,state:n,useHash:a}){const r=a?`${t.location.pathname}#${s}`:s;t.replace(r,xl(n))}function $i(t){return t.length===0?void 0:t[t.length-1]}const zg=t=>{let s=Promise.resolve();return{requestHistoryTick:a=>{s=s.then(()=>new Promise(r=>{const o=t.listen(()=>{o(),r()});a(()=>{o(),r()})}))}}};function gl(t){return new URL(t,"file://")}function Ma(t){const s={};return t.forEach((n,a)=>{s[a]=n}),s}function hn(t){return t.endsWith("/")?t:`${t}/`}function qi(t){return t.toString().length>0?`?${t}`:t}function We({path:t,decode:s},n){const a=t==="*"||t==="/*",r=a?[]:Array.from(t.matchAll(/:([A-Za-z0-9_]+)/g)).map(m=>m[1]).filter(Boolean),o=Array.from(new Set(r)),d=a?Number.POSITIVE_INFINITY:o.length,i=a?"*":hn(t),l=a?null:new URLPattern({pathname:i});return{fill(m){if(a){const x=new URLSearchParams(Object.entries(m).reduce((y,[p,g])=>g?{...y,[p]:g}:y,{}));return hn("/")+qi(x)}let u=t;for(const x of o){const y=m[x];if(y===void 0)throw new Error(`Missing route param: ${x}`);u=u.replace(`:${x}`,encodeURIComponent(y))}u=hn(u);const f={...m};o.forEach(x=>{delete f[x]});const h=new URLSearchParams(Object.entries(f).reduce((x,[y,p])=>({...x,...p?{[y]:p}:null}),{}));return u+qi(h)},parse(m){const u=gl(m);if(a){const v={...Ma(u.searchParams)};return s?s(v):v}if(!l)return null;const f=hn(u.pathname),h=l.exec({pathname:f}),x=Ma(u.searchParams);if(!h)return null;const y=h.pathname.groups,p={...x};for(const[g,v]of Object.entries(y))v!==void 0&&(p[g]=v);return s?s(p):p},variableCount:d}}class Og{status;pendingNavigations;dispatchedEvents;baseNavigationEvents;constructor(s,n=[]){this.status=s.length>0?Wt.IDLE:Wt.SUCCEEDED,this.pendingNavigations=s.slice(),this.dispatchedEvents=[],this.baseNavigationEvents=n}captureNavigationOpportunity(s){if(ul(this.status))return[];if(s&&s.globalTransitionState!=="idle")return[];if(this.pendingNavigations.length===0)return this.status=Wt.SUCCEEDED,[];const n=s?s.events.filter(Ag):[];if(!(this.verifyAllDispatchedEventsAreInNavigationHistory(n)&&this.verifyNoUnknownNavigationEvents(n)))return this.pendingNavigations=[],this.status=Wt.FAILED,[];const a=this.pendingNavigations.shift();if(!a)return[];const r=a();return this.dispatchedEvents.push(...r),this.status=Wt.PROGRESS,r}getStatus(){return this.status}verifyAllDispatchedEventsAreInNavigationHistory(s){const n=new Set(s.map(a=>a.id));return this.dispatchedEvents.every(a=>n.has(a.id))}verifyNoUnknownNavigationEvents(s){const n=new Set([...this.baseNavigationEvents,...this.dispatchedEvents].map(a=>a.id));return s.every(a=>n.has(a.id))}}function Bg(t){return typeof t=="string"?{path:t}:t}function Fg(t){return(Array.isArray(t)?t:[t]).map(Bg)}function Wg(t){return Object.keys(t).flatMap(n=>{const a=t[n];return a?Fg(a).map(r=>({activityName:n,...r})):[]})}class $g{latestlyBookedSession=Promise.resolve();acquire(){return new Promise(s=>{this.latestlyBookedSession=this.latestlyBookedSession.then(()=>new Promise(n=>s({release:()=>n()})))})}async runExclusively(s){const{release:n}=await this.acquire();try{return await s()}finally{n()}}}class qg{subscribers=[];publishLock=new $g;subscribe(s){return this.subscribers.push(s),()=>{this.subscribers=this.subscribers.filter(n=>n!==s)}}publish(s){const n=this.subscribers.slice();return this.publishLock.runExclusively(()=>Promise.allSettled(n.map(a=>a(s))))}}const Hg=c.createContext([]),Ir=t=>e.jsx(Hg.Provider,{value:t.routes,children:t.children});Ir.displayName="RoutesProvider";Ir.__docgenInfo={description:"",methods:[],displayName:"RoutesProvider",props:{routes:{required:!0,tsType:{name:"Array",elements:[{name:"ActivityRoute",elements:[{name:"T"}],raw:"ActivityRoute<T>"}],raw:"ActivityRoute<T>[]"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const Ug=/^:[\w-]+$/,Vg=3,Jg=1,Kg=10,Gg=-2,Hi=t=>t==="*";function Ui(t){const s=t.split("/");let n=s.length;return s.some(Hi)&&(n+=Gg),s.filter(a=>!Hi(a)).reduce((a,r)=>a+(Ug.test(r)?Vg:r===""?Jg:Kg),n)}function Qg(t){return[...t].toSorted((s,n)=>Ui(n.path)-Ui(s.path))}const Yg=1e3,Xg=60*Yg;function Zg(t){"config"in t&&t.config.decorate("historySync",{makeTemplate:We,urlPatternOptions:t.urlPatternOptions});const s=t.history??(typeof window>"u"?Cg({}):wg({window})),{location:n}=s,a="routes"in t?t.routes:t.config.activities.reduce((o,d)=>({...o,[d.name]:d.route}),{}),r=Qg(Wg(a));return()=>{let o=0,d=!1,i=null;const l=[],m=new qg,{requestHistoryTick:u}=zg(s),f=p=>m.subscribe(async()=>p());let h=null;const x=()=>{const p=l.map(g=>({activityId:g.getTargetId(),activationCount:g.getActivationCount()}));return(!h||h.length!==p.length||h.some(({activityId:g,activationCount:v})=>p.some(({activityId:j,activationCount:N})=>j===g&&N!==v)))&&(h=p),h},y=p=>{let g=!1;for(const v of l){const j=v.getActivationCount();v.captureStackChange(p),j!==v.getActivationCount()&&(g=!0)}g&&m.publish()};return{key:"plugin-history-sync",wrapStack({stack:p}){const g=c.useSyncExternalStore(f,x,x);return e.jsx(cl,{requestHistoryTick:u,children:e.jsx(Ir,{routes:r,children:e.jsx(kg.Provider,{value:g,children:p.render()})})})},overrideInitialEvents({initialContext:p}){const g=pn(s.location.state);if(g)return[{...g.activity.enteredBy,name:"Pushed"},...g.step?.enteredBy.name==="StepPushed"||g.step?.enteredBy.name==="StepReplaced"?[{...g.step.enteredBy,name:"StepPushed"}]:[]];function v(){return p?.req?.path&&typeof p.req.path=="string"?p.req.path:t.useHash?n.hash.split("#")[1]??"/":n.pathname+n.search}const j=v(),N=t.fallbackActivity({initialContext:p}),b=r.find(A=>We(A,t.urlPatternOptions).parse(j)!==null)??r.find(A=>A.activityName===N),k=We(b,t.urlPatternOptions).parse(j)??{},P=Object.entries(k).reduce((A,[T,C])=>(typeof C=="string"&&(A[T]=C),A),{}),_=b.defaultHistory?.(P)??[];return i=new Og([..._.map(({activityName:A,activityParams:T,additionalSteps:C=[]})=>()=>{const I=[{name:"Pushed",id:rt(),activityId:rt(),activityName:A,activityParams:{...T},activityContext:{path:j,lazyActivityComponentRenderContext:{shouldRenderImmediately:!0}}},...C.map(({stepParams:w,hasZIndex:E})=>({name:"StepPushed",id:rt(),stepId:rt(),stepParams:w,hasZIndex:E}))];for(const w of I)w.name==="Pushed"&&l.push(new Ig(w.activityId,i));return I}),()=>[{name:"Pushed",id:rt(),activityId:rt(),activityName:b.activityName,activityParams:We(b,t.urlPatternOptions).parse(j)??Ma(gl(j).searchParams),activityContext:{path:j,lazyActivityComponentRenderContext:{shouldRenderImmediately:!0}}}]]),i.captureNavigationOpportunity(null).map(A=>({...A,eventDate:Date.now()-Xg}))},onInit({actions:{getStack:p,dispatchEvent:g,push:v,stepPush:j}}){const N=p(),b=N.activities[0],S=r.find(A=>A.activityName===b.name),k=We(S,t.urlPatternOptions),P=$i(b.steps);u(()=>{d=!0,fa({history:s,pathname:k.fill(b.params),state:{activity:b,step:P},useHash:t.useHash})});const _=A=>{if(d){d=!1;return}const T=pn(A.location.state);if(!T)return;const C=T.activity,I=T.activity.id,w=T.step,{activities:E}=p(),D=E.find($=>$.isActive);if(!D)return;const z=$i(D.steps),L=E.find($=>$.id===I),q=D.steps.find($=>$.id===w?.id),M=()=>D.id>I,F=()=>D.id<I,G=()=>D.id===I,Z=()=>G()?!!(!w||z&&z.id>w.id):!1,B=()=>G()?!!(!z||w&&z.id<w.id):!1;if(M()&&(g("Popped",{}),!L&&(o+=1,v({...C.enteredBy}),w?.enteredBy.name==="StepPushed"||w?.enteredBy.name==="StepReplaced"))){const{enteredBy:$}=w;o+=1,j({...$})}if(Z()){if(!q&&w&&(w?.enteredBy.name==="StepPushed"||w?.enteredBy.name==="StepReplaced")){const{enteredBy:$}=w;o+=1,j({...$})}g("StepPopped",{})}if(F()&&(o+=1,v({activityId:C.id,activityName:C.name,activityParams:C.params})),B()){if(!w)return;o+=1,j({stepId:w.id,stepParams:w.params})}};s.listen(_),i?.captureNavigationOpportunity(N).forEach(A=>A.name==="Pushed"?v(A):j(A)),y(N)},onPushed({effect:{activity:p}}){if(o){o-=1;return}const g=r.find(j=>j.activityName===p.name),v=We(g,t.urlPatternOptions);u(()=>{d=!0,Wi({history:s,pathname:v.fill(p.params),state:{activity:p},useHash:t.useHash})})},onStepPushed({effect:{activity:p,step:g}}){if(o){o-=1;return}const v=r.find(N=>N.activityName===p.name),j=We(v,t.urlPatternOptions);u(()=>{d=!0,Wi({history:s,pathname:j.fill(p.params),state:{activity:p,step:g},useHash:t.useHash})})},onReplaced({effect:{activity:p}}){if(!p.isActive)return;const g=r.find(j=>j.activityName===p.name),v=We(g,t.urlPatternOptions);u(()=>{d=!0,fa({history:s,pathname:v.fill(p.params),state:{activity:p},useHash:t.useHash})})},onStepReplaced({effect:{activity:p,step:g}}){if(!p.isActive)return;const v=r.find(N=>N.activityName===p.name),j=We(v,t.urlPatternOptions);u(()=>{d=!0,fa({history:s,pathname:j.fill(p.params),state:{activity:p,step:g},useHash:t.useHash})})},onBeforePush({actionParams:p,actions:{overrideActionParams:g}}){if(!p.activityContext||!("path"in p.activityContext)){const v=r.find(b=>b.activityName===p.activityName),N=We(v,t.urlPatternOptions).fill(p.activityParams);g({...p,activityContext:{...p.activityContext,path:N}})}},onBeforeReplace({actionParams:p,actions:{overrideActionParams:g,getStack:v}}){if(!p.activityContext||!("path"in p.activityContext)){const S=r.find(_=>_.activityName===p.activityName),P=We(S,t.urlPatternOptions).fill(p.activityParams);g({...p,activityContext:{...p.activityContext,path:P}})}const{activities:j}=v(),N=j.filter(S=>S.transitionState==="enter-active"||S.transitionState==="enter-done"),b=N.length>0?N[N.length-1]:null;if(b)for(let S=0;S<b.steps.length-1;S+=1)u(k=>{pn(s.location.state)?k():(d=!0,s.back())}),u(()=>{d=!0,s.back()})},onBeforeStepPop({actions:{getStack:p}}){const{activities:g}=p();(g.find(j=>j.isActive)?.steps.length??0)>1&&u(()=>{d=!0,s.back()})},onBeforePop({actions:{getStack:p}}){const{activities:g}=p(),v=g.find(j=>j.isActive);if(v){const{isRoot:j,steps:N}=v,b=j?0:N.length;for(let S=0;S<b;S+=1)u(k=>{pn(s.location.state)?k():(d=!0,s.back())}),u(()=>{d=!0,s.back()})}},onChanged({actions:{getStack:p,push:g,stepPush:v}}){const j=p();i?.captureNavigationOpportunity(j).forEach(N=>N.name==="Pushed"?g(N):v(N)),y(j)}}}}function vl(){const{t}=O(["settings","common"]),[s,n]=c.useState(!1),a=()=>{n(!0);const r="./";window.location.href=`${r}clear.html`};return e.jsx("div",{className:"bg-background flex min-h-screen flex-col items-center justify-center p-6",children:e.jsxs("div",{className:"flex max-w-sm flex-col items-center gap-6 text-center",children:[e.jsx("div",{className:"bg-destructive/10 flex size-20 items-center justify-center rounded-full",children:e.jsx(Oe,{className:"text-destructive size-10"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-xl font-bold",children:t("settings:storage.migrationRequired")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:t("settings:storage.migrationDesc")})]}),e.jsx("div",{className:"bg-destructive/5 w-full rounded-lg p-4",children:e.jsxs("ul",{className:"text-destructive space-y-2 text-left text-sm",children:[e.jsxs("li",{children:[" ",t("settings:clearData.item1")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item2")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item3")]})]})}),e.jsxs(J,{variant:"destructive",onClick:a,className:"w-full gap-2",disabled:s,children:[e.jsx(es,{className:"size-4"}),t("settings:clearData.confirm")]})]})})}vl.__docgenInfo={description:`


 Stackflow context  useFlow()`,methods:[],displayName:"MigrationRequiredView"};function ev(t){switch(t){case"confirmed":return"confirmed";case"failed":return"failed";default:return"pending"}}function yl(t,s){const n=t.meta?.displayAmount??"0",a=t.meta?.displaySymbol??"",r=re.fromFormatted(n,s,a);return{id:`${t.chainId}--${t.txHash}`,type:t.meta?.type??"other",status:ev(t.status),amount:r,symbol:a,address:t.meta?.displayToAddress??t.fromAddress,timestamp:new Date(t.createdAt),hash:t.txHash,chain:t.chainId}}const bl=c.createContext(null);function Lt({chainId:t,children:s,fallback:n=null}){const a=c.useMemo(()=>t?Pe(t):null,[t]);return a?e.jsx(bl.Provider,{value:a,children:s},t):e.jsx(e.Fragment,{children:n})}function ns(){const t=c.useContext(bl);if(!t)throw new Error("useChainProvider must be used within ChainProviderGate. Make sure to wrap your component with <ChainProviderGate chainId={...}>.");return t}Lt.__docgenInfo={description:`ChainProvider 

 ChainProvider 
 chainId  fallback  null

@example
\`\`\`tsx
<ChainProviderGate chainId={selectedChain} fallback={<ChainNotSupported />}>
  <WalletContent />
</ChainProviderGate>
\`\`\``,methods:[],displayName:"ChainProviderGate",props:{chainId:{required:!0,tsType:{name:"union",raw:"string | null | undefined",elements:[{name:"string"},{name:"null"},{name:"undefined"}]},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},fallback:{required:!1,tsType:{name:"ReactNode"},description:" provider ",defaultValue:{value:"null",computed:!1}}}};function Ra(t,s){return c.useMemo(()=>t?t instanceof To?{supported:!1,limited:!1,type:"notSupported",reason:s("common:service.notSupported")}:t instanceof km?{supported:!0,limited:!0,type:"limited",reason:s("common:service.limited")}:{supported:!0,limited:!1,type:"error",error:t,reason:t.message}:{supported:!0,limited:!1,type:"ok"},[t,s])}function tv(t,s){return t==="transfer"?s==="in"?"receive":"send":{swap:"swap",exchange:"exchange",approve:"approve",stake:"stake",unstake:"unstake",mint:"mint",burn:"destroy",gift:"gift",grab:"grab",trust:"trust",signFor:"signFor",emigrate:"emigrate",immigrate:"immigrate",issueAsset:"issueAsset",increaseAsset:"increaseAsset",destroyAsset:"destroy",issueEntity:"issueEntity",destroyEntity:"destroyEntity",locationName:"locationName",dapp:"dapp",certificate:"certificate",mark:"mark",signature:"signature"}[t]??"other"}function sv(t,s){const n=l=>l?s?`${s}--${l}`:l:"unknown";if(!t||!t.hash||!t.assets||t.assets.length===0)return{id:n(t?.hash),type:"other",status:"pending",amount:re.fromRaw("0",8,""),symbol:"",address:t?.from??t?.to??"",timestamp:new Date,hash:t?.hash,chain:s};const a=t.assets[0],r=t.direction==="in"?t.from:t.to;let o=8,d="0",i="";return(a.assetType==="native"||a.assetType==="token")&&(o=a.decimals??8,d=a.value??"0",i=a.symbol??""),{id:n(t.hash),type:tv(t.action,t.direction),status:t.status,amount:re.fromRaw(d,o,i),symbol:i,address:r,timestamp:new Date(t.timestamp),hash:t.hash,chain:s}}function jl(t,s){return!t||!Array.isArray(t)?[]:t.filter(n=>n!=null).map(n=>{try{return sv(n,s)}catch(a){return console.warn("[toTransactionInfoList] Failed to convert transaction:",n,a),{id:s?`${s}--${n?.hash??"error"}`:n?.hash??"error",type:"other",status:"pending",amount:re.fromRaw("0",8,""),symbol:"",address:"",timestamp:new Date,chain:s}}})}function nv({address:t,selectedChain:s,selectedChainName:n,mainAssetSymbol:a,wallets:r,currentWalletId:o,chainPreferences:d,onWalletChange:i,onCopyAddress:l,onOpenChainSelector:m,onOpenSettings:u,onOpenWalletList:f,onAddWallet:h,onOpenAddressBalance:x,onOpenAddressTransactions:y}){const{push:p}=X(),g=sn(),{t:v}=O(["home","wallet","common","transaction"]),j=dt(),N=j.snapshot?He.getChainById(j,s):void 0,b=ns(),{data:S=[],isLoading:k,isFetching:P,error:_}=b.allBalances.useState({address:t},{enabled:!!t}),{data:A,isLoading:T,isFetching:C,error:I}=b.transactionHistory.useState({address:t,limit:50},{enabled:!!t}),w=k||P&&S.length===0,E=Ra(_,v),D=Ra(I,v),{transactions:z,deleteTransaction:L,retryTransaction:q}=ko(o??void 0,s,t,A),M=c.useMemo(()=>A?jl(A,s):[],[A,s]),F=T||C&&M.length===0,G=c.useCallback(B=>{if(B.id){const $=A?.find(se=>se.hash===B.hash),ye=$?Kt.stringify($):void 0;p("TransactionDetailActivity",{txId:B.id,txData:ye})}},[p,A]),Z=c.useCallback((B,$)=>[{label:v("home:wallet.transfer"),icon:e.jsx(tc,{className:"size-4"}),onClick:()=>{g.impact("light"),p("SendActivity",{assetType:B.symbol})}},{label:v("home:wallet.destroy"),icon:e.jsx(Cn,{className:"size-4"}),onClick:()=>{g.impact("light"),p("DestroyActivity",{assetType:B.symbol,assetLocked:"true"})},variant:"destructive",show:$.canDestroy}],[g,p,v]);return e.jsxs("div",{"data-testid":"wallet-home",className:"flex h-full flex-col overflow-y-auto bg-background",children:[e.jsxs("div",{className:"pt-2 pb-1",children:[e.jsx(Qu,{wallets:r,currentWalletId:o,selectedChain:s,chainPreferences:d,onWalletChange:i,onCopyAddress:l,onOpenChainSelector:m,onOpenSettings:u,onOpenWalletList:f,onAddWallet:h,onOpenAddressBalance:x,onOpenAddressTransactions:y}),e.jsxs("div",{className:"mt-2 flex justify-center gap-8 px-6",children:[e.jsxs("button",{onClick:()=>p("SendActivity",{}),"data-testid":"wallet-home-send-button",className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:e.jsx(oc,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:v("home:wallet.send")})]}),e.jsxs("button",{onClick:()=>p("ReceiveActivity",{}),"data-testid":"wallet-home-receive-button",className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:e.jsx(Mp,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:v("home:wallet.receive")})]}),e.jsxs("button",{onClick:()=>p("ScannerActivity",{}),"data-testid":"wallet-home-scan-button",className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:e.jsx(_m,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:v("common:a11y.scan")})]})]})]}),z.length>0&&e.jsxs("div",{className:"px-4 pt-2 space-y-2",children:[e.jsx("h3",{className:"text-muted-foreground text-xs font-medium uppercase tracking-wider px-1",children:v("transaction:pendingTx.title")}),e.jsx("div",{className:"space-y-1",children:z.slice(0,3).map(B=>{const $=yl(B,N?.decimals??8);return e.jsx(Po,{transaction:$,onClick:()=>p("TransactionDetailActivity",{txId:$.id}),onRetry:B.status==="failed"?()=>q(B):void 0,onDelete:()=>L(B)},B.id)})}),z.length>3&&e.jsx("button",{onClick:()=>p("HistoryActivity",{chain:s}),className:"mt-2 w-full rounded-lg bg-muted/60 py-2 text-xs font-medium text-muted-foreground transition-colors hover:bg-muted",children:v("transaction:pendingTx.viewAll",{count:z.length})})]}),e.jsx("div",{className:"flex-1 pt-3",children:e.jsx(ym,{chainId:s,chainName:n,tokens:S.map(B=>({symbol:B.symbol,name:B.name,chain:s,balance:B.amount.toFormatted(),decimals:B.decimals,fiatValue:void 0,change24h:0,icon:B.icon})),transactions:M.slice(0,5),tokensLoading:w,tokensRefreshing:P&&S.length>0,transactionsLoading:F,transactionsRefreshing:C&&M.length>0,tokensSupported:E.type!=="notSupported",tokensFallbackReason:E.type!=="ok"?E.reason:void 0,transactionsSupported:D.type!=="notSupported"&&D.type!=="limited",transactionsFallbackReason:D.type!=="ok"?D.reason:void 0,onTokenClick:B=>{},onTransactionClick:G,mainAssetSymbol:a,tokenMenuItems:Z,renderTransactionFooter:()=>e.jsx("button",{onClick:()=>p("HistoryActivity",{chain:M.length>0?s:"all"}),className:"mt-3 w-full rounded-lg bg-muted/60 py-2.5 text-sm font-medium text-muted-foreground transition-colors hover:bg-muted",children:M.length>0?v("transaction:history.viewAll",{count:M.length}):v("transaction:history.viewAllChains")}),testId:"wallet-home"})}),e.jsx("div",{className:"shrink-0 h-[var(--tab-bar-height)]"})]})}function Nl(){const{push:t}=X(),s=dr(),n=st(),a=sn(),{t:r}=O(["home","wallet","common","transaction"]),o=em(),d=im(),i=om(),l=Et(),m=Fe(),u=Un(),f=m?.id??null,h=Je(),x=Ka(),y=r(`common:chains.${h}`,{defaultValue:h}),p=dt(),v=(p.snapshot?He.getChainById(p,h):null)?.symbol;No();const j=u?.address??"",N=c.useCallback(async C=>{await s.write({text:C}),await a.impact("light"),n.show(r("home:wallet.addressCopied"))},[s,a,n,r]),b=c.useCallback(C=>{C!==f&&ge.setCurrentWallet(C),t("ChainSelectorJob",{})},[t,f]),S=c.useCallback(C=>{const I=l.find(w=>w.id===C);I&&t("WalletConfigActivity",{walletId:C,walletName:I.name})},[t,l]),k=c.useCallback(C=>{ge.setCurrentWallet(C)},[]),P=c.useCallback(()=>{t("WalletAddJob",{})},[t]),_=c.useCallback(()=>{t("WalletListJob",{})},[t]),A=c.useCallback(()=>{t("AddressBalanceActivity",{})},[t]),T=c.useCallback(()=>{t("AddressTransactionsActivity",{})},[t]);return o?e.jsx(vl,{}):d?!i||!m?e.jsx(av,{}):e.jsx(Lt,{chainId:h,fallback:e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:r("common:ecosystem.chainNotSupported")})}),children:e.jsx(nv,{address:j,selectedChain:h,selectedChainName:y,mainAssetSymbol:v,wallets:l,currentWalletId:f,chainPreferences:x,onWalletChange:k,onCopyAddress:N,onOpenChainSelector:b,onOpenSettings:S,onOpenWalletList:_,onAddWallet:P,onOpenAddressBalance:A,onOpenAddressTransactions:T})}):e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(Te,{size:"lg"})})}function av(){const{push:t}=X(),{t:s}=O("home");return e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-6 p-6 text-center",children:[e.jsx("div",{className:"bg-primary/10 rounded-full p-6",children:e.jsx(ut,{className:"text-primary size-12"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:s("welcome.title")}),e.jsx("p",{className:"text-muted-foreground mt-2",children:s("welcome.subtitle")})]}),e.jsxs("div",{className:"flex w-full max-w-xs flex-col gap-3",children:[e.jsx(Ue,{variant:"mint",className:"w-full","data-testid":"create-wallet-button",onClick:()=>t("WalletCreateActivity",{}),children:s("welcome.createWallet")}),e.jsx(J,{variant:"outline",className:"w-full","data-testid":"import-wallet-button",onClick:()=>t("OnboardingRecoverActivity",{}),children:s("welcome.importWallet")})]})]})}Nl.__docgenInfo={description:"",methods:[],displayName:"WalletTab"};function wl(){const{push:t}=X(),s=c.useRef(null),[n,a]=c.useState([]),[r,o]=c.useState(!0),d=Ae(Xa,y=>y.myApps);c.useEffect(()=>{let y=!1;const p=zm(g=>{a(g),y||(y=!0,o(!1))});return Mo({refresh:!0}).then(()=>{y||(a(Om()),o(!1))}),()=>p()},[]),Bm();const i=c.useCallback(y=>{t("MiniappDetailActivity",{appId:encodeURIComponent(y.id)})},[t]),l=c.useCallback(y=>{Re.installApp(y.id),Re.updateAppLastUsed(y.id),Re.setActiveSubPage("mine"),s.current?.slideTo("mine"),requestAnimationFrame(()=>{Ro(y.id,{...y,targetDesktop:"mine"})})},[]),m=c.useCallback(y=>{Re.uninstallApp(y)},[]),u=c.useMemo(()=>d.map(y=>({...y,app:n.find(p=>p.id===y.appId)})).filter(y=>!!y.app).map(({app:y,lastUsedAt:p})=>({app:y,lastUsed:p})),[d,n]),f=c.useMemo(()=>n.length===0?[]:[...n].toSorted((y,p)=>si(p)-si(y)).slice(0,2),[n]),h=c.useMemo(()=>{const y=new Set(f.map(p=>p.id));return[...n].filter(p=>!y.has(p.id)).toSorted((p,g)=>(g.officialScore??0)-(p.officialScore??0)).slice(0,6)},[n,f]),x=c.useMemo(()=>[...n].toSorted((y,p)=>(p.communityScore??0)-(y.communityScore??0)).slice(0,10),[n]);return r?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(Te,{size:"lg"})}):e.jsx(Ym,{ref:s,showDiscoverPage:!0,showStackPage:"auto",apps:n,myApps:u,featuredApps:f,recommendedApps:h,hotApps:x,onAppOpen:l,onAppDetail:i,onAppRemove:m})}wl.__docgenInfo={description:"",methods:[],displayName:"EcosystemTab"};const rv=/^(\d+)\.(\d+)\.(\d+)(?:-([0-9A-Za-z.-]+))?$/;function Vi(t){const s=t.match(rv);if(!s)return null;const[,n,a,r,o]=s,d=o&&/^\d+$/.test(o)?Number(o):void 0;return{major:Number(n),minor:Number(a),patch:Number(r),suffix:o??void 0,suffixNumber:d}}function iv(t,s){const n=Vi(t),a=Vi(s);if(!n||!a)return null;if(n.major!==a.major)return n.major-a.major;if(n.minor!==a.minor)return n.minor-a.minor;if(n.patch!==a.patch)return n.patch-a.patch;const r=n.suffixNumber??(n.suffix?Number.NaN:0),o=a.suffixNumber??(a.suffix?Number.NaN:0);return!Number.isNaN(r)&&!Number.isNaN(o)?r-o:n.suffix&&!a.suffix?1:!n.suffix&&a.suffix?-1:n.suffix&&a.suffix?n.suffix.localeCompare(a.suffix):0}function pa(t){return t.endsWith("/")?t:`${t}/`}function ov(t){return t.endsWith("/")?t:`${t}/`}function cv(){const t=pa("https://BioforestChain.github.io");try{const a=new URL(t).pathname;if(a&&a!=="/")return pa(t)}catch{return t}const s=ov("/KeyApp/");return pa(new URL(s,t).toString())}function lv(){const t=cv(),s="dweb-dev/metadata.json";return new URL(s,t).toString()}function dv(t){return`dweb://install?url=${encodeURIComponent(t)}`}async function uv(t){const s=await fetch(t,{cache:"no-store"});if(!s.ok)throw new Error(`metadata fetch failed: ${s.status}`);const n=await s.json(),a=typeof n.version=="string"?n.version:"",r=typeof n.change_log=="string"?n.change_log:n.changeLog;return{version:a,changeLog:r}}async function mv(){const t="0.10.10-021308",s=jm();let n="",a="";try{n=lv(),a=dv(n)}catch(r){const o=r instanceof Error?r.message:"invalid site origin";return{status:"error",currentVersion:t,metadataUrl:n,installUrl:a,error:o}}try{const r=await uv(n);if(!r.version)return{status:"error",currentVersion:t,metadataUrl:n,installUrl:a,error:"metadata version missing"};const o=iv(r.version,t);return o===null?{status:"error",currentVersion:t,metadataUrl:n,installUrl:a,error:"version parse failed"}:s?o>0?{status:"update-available",currentVersion:t,latestVersion:r.version,metadataUrl:n,installUrl:a,changeLog:r.changeLog}:{status:"up-to-date",currentVersion:t,latestVersion:r.version,metadataUrl:n,installUrl:a,changeLog:r.changeLog}:{status:"not-dweb",currentVersion:t,latestVersion:r.version,metadataUrl:n,installUrl:a,changeLog:r.changeLog}}catch(r){const o=r instanceof Error?r.message:"unknown error";return{status:"error",currentVersion:t,metadataUrl:n,installUrl:a,error:o}}}const fv={status:"idle",currentVersion:"0.10.10-021308",dialogOpen:!1},Bt=new Ju(fv),pv={openDialog:()=>{Bt.setState(t=>({...t,dialogOpen:!0}))},closeDialog:()=>{Bt.setState(t=>({...t,dialogOpen:!1}))},check:async t=>{const{status:s}=Bt.state;if(s==="checking")return{status:"error",currentVersion:"0.10.10-021308",metadataUrl:"",installUrl:"",error:"already checking"};Bt.setState(a=>({...a,status:"checking"}));const n=await mv();return Bt.setState(a=>({...a,status:n.status,currentVersion:n.currentVersion,latestVersion:n.latestVersion,changeLog:n.changeLog,metadataUrl:n.metadataUrl,installUrl:n.installUrl,error:n.error,lastCheckedAt:Date.now(),dialogOpen:n.status==="update-available"?!0:a.dialogOpen})),t==="auto"&&n.status!=="update-available"&&Bt.setState(a=>({...a,dialogOpen:!1})),n}};function hv(){return Ae(Bt)}function Se({icon:t,label:s,value:n,showChevron:a=!0,disabled:r=!1,onClick:o,trailing:d,className:i,testId:l}){const m=o?"button":"div";return e.jsxs(m,{type:o?"button":void 0,onClick:r?void 0:o,disabled:r,"data-testid":l,className:R("bg-background flex w-full items-center gap-3 rounded-xl px-4 py-3.5","transition-colors",o&&!r&&"hover:bg-muted/50 active:bg-muted",r&&"cursor-not-allowed",i),children:[t&&e.jsx("span",{className:"bg-muted text-foreground flex size-8 shrink-0 items-center justify-center rounded-lg",children:t}),e.jsx("span",{className:R("flex-1 text-left text-sm font-medium",r&&"text-muted-foreground"),children:s}),d??e.jsxs(e.Fragment,{children:[n&&e.jsx("span",{className:"text-muted-foreground text-sm",children:n}),a&&o&&e.jsx(De,{className:"text-muted-foreground/50 size-5"})]})]})}Se.__docgenInfo={description:"",methods:[],displayName:"SettingsItem",props:{icon:{required:!1,tsType:{name:"union",raw:"ReactNode | undefined",elements:[{name:"ReactNode"},{name:"undefined"}]},description:""},label:{required:!0,tsType:{name:"string"},description:""},value:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},showChevron:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"",defaultValue:{value:"true",computed:!1}},disabled:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"",defaultValue:{value:"false",computed:!1}},onClick:{required:!1,tsType:{name:"union",raw:"(() => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},trailing:{required:!1,tsType:{name:"union",raw:"ReactNode | undefined",elements:[{name:"ReactNode"},{name:"undefined"}]},description:""},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:" className"},testId:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:" ID"}}};function Ts({title:t,children:s,className:n,allowContextMenu:a}){return e.jsxs("section",{className:R("space-y-1",n),"data-allow-context-menu":a?"true":void 0,children:[t&&e.jsx("h3",{className:"mb-2 px-1 text-xs font-medium uppercase text-muted-foreground",children:t}),e.jsx("div",{className:"overflow-hidden rounded-xl bg-card shadow-sm",children:s})]})}Ts.__docgenInfo={description:"",methods:[],displayName:"SettingsSection",props:{title:{required:!1,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},className:{required:!1,tsType:{name:"string"},description:" className"},allowContextMenu:{required:!1,tsType:{name:"boolean"},description:"DWEB "}}};const xv=[{value:"system",icon:fp},{value:"light",icon:Bp},{value:"dark",icon:kp}];function Cl({open:t,onOpenChange:s}){const{t:n}=O("settings"),a=bo(),r=o=>{qn.setTheme(o),s(!1)};return e.jsx(Ct,{open:t,onOpenChange:s,children:e.jsxs(kt,{side:"bottom",className:"rounded-t-2xl",children:[e.jsx(St,{children:e.jsx(At,{children:n("appearance.title")})}),e.jsx("div",{className:"mt-4 space-y-2",children:xv.map(({value:o,icon:d})=>e.jsxs("button",{onClick:()=>r(o),className:R("flex w-full items-center gap-3 rounded-xl p-4 transition-colors",a===o?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx(d,{size:24}),e.jsx("span",{className:"flex-1 text-left font-medium",children:n(`appearance.${o}`)}),a===o&&e.jsx(je,{size:20})]},o))})]})})}Cl.__docgenInfo={description:"",methods:[],displayName:"AppearanceSheet",props:{open:{required:!0,tsType:{name:"boolean"},description:""},onOpenChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(open: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"open"}],return:{name:"void"}}},description:""}}};const qe=Ce.t.bind(Ce);async function gv(t,s){const n=Pe(t.id);if(!n.estimateFee||!n.buildTransaction){const r=lt.getBiowalletApi(t.id);if(!r)throw new Error(qe("error:transaction.feeEstimateFailed"));const o=await Br(r,t.id,s,"1");return{amount:re.fromRaw(o,t.decimals,t.symbol),symbol:t.symbol}}const a=await n.buildTransaction({type:"transfer",from:s,to:s,amount:re.fromRaw("1",t.decimals,t.symbol)});try{return{amount:(await n.estimateFee(a)).standard.amount,symbol:t.symbol}}catch{const r=lt.getBiowalletApi(t.id);if(!r)throw new Error(qe("error:transaction.feeEstimateFailed"));const o=await Br(r,t.id,s,"1");return{amount:re.fromRaw(o,t.decimals,t.symbol),symbol:t.symbol}}}async function Ji({chainConfig:t,walletId:s,password:n,fromAddress:a,toAddress:r,amount:o,assetType:d,fee:i,twoStepSecret:l}){let m;try{m=await hs.getMnemonic(s,n)}catch(f){return f instanceof Js&&f.code===xs.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:f instanceof Error?f.message:qe("error:unknown")}}if(!o.isPositive())return{status:"error",message:qe("error:validation.enterValidAmount")};const u=Pe(t.id);if(!u.supportsFullTransaction)return{status:"error",message:qe("error:transaction.chainNotSupported")};try{let f=null;if(u.bioGetAccountInfo){if(f=(await u.bioGetAccountInfo(a)).secondPublicKey,f&&!l)return{status:"password_required",secondPublicKey:f};if(l&&f&&u.bioVerifyPayPassword&&!await u.bioVerifyPayPassword({mainSecret:m,paySecret:l,publicKey:f}))return{status:"error",message:qe("error:transaction.securityPasswordFailed")}}const h=await u.buildTransaction({type:"transfer",from:a,to:r,amount:o,fee:i,bioAssetType:d}),x=await u.signTransaction(h,{privateKey:new TextEncoder().encode(m),bioSecret:m,bioPaySecret:l}),y=await Nt.create({walletId:Io(t.id,a),chainId:t.id,fromAddress:a,rawTx:x,meta:{type:"send",displayAmount:o.toFormatted(),displaySymbol:d,displayToAddress:r}});await Nt.updateStatus({id:y.id,status:"broadcasting"});try{const p=await u.broadcastTransaction(x);return await Nt.updateStatus({id:y.id,status:"broadcasted",txHash:p}),{status:"ok",txHash:p,pendingTxId:y.id}}catch(p){const g=p;return await Nt.updateStatus({id:y.id,status:"failed",errorCode:"BROADCAST_FAILED",errorMessage:g.message}),{status:"error",message:g.message,pendingTxId:y.id}}}catch(f){return{status:"error",message:(f instanceof Error?f.message:String(f))||qe("error:transaction.failed")}}}async function vv({chainConfig:t,walletId:s,password:n,fromAddress:a,newTwoStepSecret:r}){let o;try{o=await hs.getMnemonic(s,n)}catch(i){return i instanceof Js&&i.code===xs.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:i instanceof Error?i.message:qe("error:unknown")}}const d=Pe(t.id);if(!d.supportsFullTransaction)return{status:"error",message:qe("error:transaction.chainNotSupported")};try{if(d.bioGetAccountInfo&&(await d.bioGetAccountInfo(a)).secondPublicKey)return{status:"already_set"};const i=await d.buildTransaction({type:"setPayPassword",from:a}),l=await d.signTransaction(i,{privateKey:new TextEncoder().encode(o),bioSecret:o,bioNewPaySecret:r});return{status:"ok",txHash:await d.broadcastTransaction(l)}}catch(i){const l=i instanceof Error?i.message:String(i);return l.includes("fee")||l.includes("")?{status:"error",message:qe("error:insufficientFunds")}:{status:"error",message:l||qe("error:transaction.failed")}}}async function yv(t){const s=Pe(t.id);if(!s.buildTransaction||!s.estimateFee)return null;try{const n=await s.buildTransaction({type:"setPayPassword",from:"0x0000000000000000000000000000000000000000"});return{amount:(await s.estimateFee(n)).standard.amount,symbol:t.symbol}}catch{return null}}async function bv(t,s){const n=Pe(t.id);if(!n.bioGetAccountInfo)return!1;try{return!!(await n.bioGetAccountInfo(s)).secondPublicKey}catch{return!1}}function fe({cancelable:t,onCancel:s,onOutsideClick:n,...a}){const r=t??!!s,o=d=>{if(!r){d.preventDefault();return}if(s){s(),d.preventDefault();return}n?.(d)};return e.jsx(ug,{onOutsideClick:o,...a})}const kl=hg;function Rn({title:t,children:s,className:n}){return e.jsxs("div",{className:R("bg-background rounded-t-2xl",n),children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),t&&e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t})}),s,e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}fe.__docgenInfo={description:"Re-export Stackflow BottomSheet",methods:[],displayName:"BottomSheet",props:{cancelable:{required:!1,tsType:{name:"boolean"},description:`Whether the sheet supports cancel (outside click).
Defaults to true to preserve existing behavior.`},onCancel:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:`Cancel handler invoked when outside click happens.
If provided, it is responsible for closing the sheet (call pop).`}}};Rn.__docgenInfo={description:"Standard sheet content wrapper with handle, title, and safe area",methods:[],displayName:"SheetContent",props:{title:{required:!1,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};function jv(t,s=10,n=8){return t.length<=s+n+3?t:`${t.slice(0,s)}...${t.slice(-n)}`}const Sl=()=>{const{t}=O(["home","common"]),{pop:s}=X(),n=Fe(),a=Je(),r=Zt(),o=c.useMemo(()=>n?n.chainAddresses.map(l=>l.chain):[],[n]),d=l=>{ge.setSelectedChain(l),s()},i=()=>{s()};return e.jsx(fe,{onCancel:i,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("home:wallet.selectNetwork")})}),e.jsx("div",{"data-testid":"chain-sheet",className:"max-h-[60vh] space-y-2 overflow-y-auto p-4",children:o.map(l=>{const m=n?.chainAddresses.find(u=>u.chain===l);return e.jsxs("button",{"data-testid":`chain-option-${l}`,onClick:()=>d(l),className:`flex w-full items-center gap-3 rounded-xl p-4 transition-colors ${l===a?"bg-primary/10 ring-1 ring-primary":"bg-muted/50 hover:bg-muted"}`,children:[e.jsx(Pt,{chain:l,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:r[l]??l}),e.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:m?.address?jv(m.address):"---"})]}),l===a&&e.jsx(je,{className:"size-5 text-primary"})]},l)})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};Sl.__docgenInfo={description:"",methods:[],displayName:"ChainSelectorJob"};const Ki={"/":"MainTabsActivity","/wallet/list":"WalletListActivity","/wallet/create":"WalletCreateActivity","/send":"SendActivity","/receive":"ReceiveActivity","/settings":"SettingsActivity","/settings/language":"SettingsLanguageActivity","/settings/currency":"SettingsCurrencyActivity","/settings/chains":"SettingsChainsActivity","/settings/mnemonic":"SettingsMnemonicActivity","/settings/wallet-lock":"SettingsWalletLockActivity","/settings/wallet-chains":"SettingsWalletChainsActivity","/settings/storage":"SettingsStorageActivity","/settings/sources":"SettingsSourcesActivity","/history":"HistoryActivity","/scanner":"ScannerActivity","/onboarding/recover":"OnboardingRecoverActivity","/address-book":"AddressBookActivity","/my-card":"MyCardActivity","/notifications":"NotificationsActivity","/staking":"StakingActivity","/welcome":"WelcomeActivity"},Nv=[{pattern:/^\/wallet\/([^/]+)$/,activity:"WalletConfigActivity",paramExtractor:t=>({walletId:t[1]??""})},{pattern:/^\/transaction\/([^/]+)$/,activity:"TransactionDetailActivity",paramExtractor:t=>({txId:t[1]??""})},{pattern:/^\/authorize\/address\/([^/]+)$/,activity:"AuthorizeAddressActivity",paramExtractor:t=>({id:t[1]??""})},{pattern:/^\/authorize\/signature\/([^/]+)$/,activity:"AuthorizeSignatureActivity",paramExtractor:t=>({id:t[1]??""})},{pattern:/^\/token\/([^/]+)$/,activity:"TokenDetailActivity",paramExtractor:t=>({tokenId:t[1]??""})}];function wv(t){if(Ki[t])return{activity:Ki[t],params:{}};for(const{pattern:s,activity:n,paramExtractor:a}of Nv){const r=t.match(s);if(r)return{activity:n,params:a(r)}}return null}function ce(){const t=X();return{navigate:a=>{const r=typeof a=="string"?{to:a}:a,o=wv(r.to);if(!o)return;const d={...o.params,...r.search};r.replace?t.replace(o.activity,d,{animate:!0}):t.push(o.activity,d,{animate:!0})},goBack:()=>{t.pop()}}}const Al=c.createContext({});function me({params:t,children:s}){return e.jsx(Al.Provider,{value:t,children:s})}function pe(){return c.useContext(Al)}me.__docgenInfo={description:"",methods:[],displayName:"ActivityParamsProvider",props:{params:{required:!0,tsType:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""}}};function Cv(){const{t}=O("wallet"),{pop:s}=X(),{walletId:n}=pe(),r=Et().find(u=>u.id===n),[o,d]=c.useState(r?.name??"");c.useEffect(()=>{r&&d(r.name)},[r]);const i=c.useCallback(()=>{if(!r)return;const u=o.trim();u&&(ge.updateWalletName(r.id,u),s())},[r,o,s]),l=()=>{s()};if(!r)return null;const m=o.trim().length>0&&o.trim()!==r.name;return e.jsx(fe,{onCancel:l,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("editSheet.renameTitle")})}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"wallet-name",className:"text-sm font-medium",children:t("editSheet.walletName")}),e.jsx("input",{id:"wallet-name",type:"text",value:o,onChange:u=>d(u.target.value),placeholder:t("editSheet.walletNamePlaceholder"),maxLength:20,className:R("w-full rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")}),e.jsxs("p",{className:"text-right text-xs text-muted-foreground",children:[o.length,"/20"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:i,disabled:!m,className:R("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t("editSheet.save")}),e.jsx("button",{onClick:l,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("editSheet.cancel")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Il=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Cv,{})});Il.__docgenInfo={description:"",methods:[],displayName:"WalletRenameJob"};function kv(){const{t}=O("wallet"),{pop:s}=X(),{navigate:n}=ce(),{walletId:a}=pe(),o=Et().find(y=>y.id===a),[d,i]=c.useState([]),[l,m]=c.useState(!1),[u,f]=c.useState(!1),h=()=>{s()},x=c.useCallback(async y=>{if(!(!o||y.length<4)){if(!o.encryptedMnemonic){ge.deleteWallet(o.id),n({to:"/"});return}f(!0),m(!1);try{const p=Be(y);if(!await Ht(o.encryptedMnemonic,p)){m(!0),i([]);return}ge.deleteWallet(o.id),n({to:"/"})}catch{m(!0),i([])}finally{f(!1)}}},[o,n]);return o?e.jsx(fe,{onCancel:h,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("editSheet.deleteTitle")})}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsx("p",{className:"text-center text-muted-foreground",children:t("editSheet.deleteWarning",{name:o.name})}),e.jsx(mt,{value:d,onChange:i,onComplete:x,minPoints:4,error:l,disabled:u}),e.jsx("div",{className:"space-y-3",children:e.jsx("button",{onClick:h,disabled:u,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("editSheet.cancel")})})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}):null}const Tl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(kv,{})});Tl.__docgenInfo={description:"",methods:[],displayName:"WalletDeleteJob"};let Ln=null,Tr=null;function Ns(t,s){Ln=t,Tr=null}function Sv(){Ln=null,Tr=null}function Av(){const{t}=O("security"),{pop:s}=X(),{title:n,description:a,biometricAvailable:r,miniappName:o,miniappIcon:d,walletName:i,walletAddress:l,walletChainId:m}=pe(),[u,f]=c.useState([]),[h,x]=c.useState(!1),[y,p]=c.useState(null),[g,v]=c.useState(!1),j=c.useRef(null),N=c.useRef(null),b=c.useRef(null),S=c.useRef(!1);!S.current&&Ln&&(N.current=Ln,b.current=Tr,Sv(),S.current=!0);const k=n??t("patternLock.unlockTitle"),P=r==="true"&&b.current,_=!!(i&&l&&m),A=!!(o||d||_||m),T=c.useCallback(()=>{j.current&&(clearTimeout(j.current),j.current=null),x(!1),p(null)},[]),C=c.useCallback(D=>{h&&D.length>0&&T(),f(D)},[h,T]),I=c.useCallback(async D=>{const z=N.current;if(!(D.length<4||!z)){v(!0),T();try{const L=Be(D);await z(L)?s():(x(!0),p(t("walletLock.error")),f([]),j.current=setTimeout(()=>{x(!1),p(null)},1500))}catch(L){x(!0),p(L instanceof Error?L.message:t("walletLock.error")),f([]),j.current=setTimeout(()=>{x(!1),p(null)},1500)}finally{v(!1)}}},[s,T,t]),w=c.useCallback(async()=>{const D=b.current;if(D){v(!0),T();try{await D()?s():(x(!0),j.current=setTimeout(()=>{x(!1)},1500))}catch{x(!0),j.current=setTimeout(()=>{x(!1)},1500)}finally{v(!1)}}},[s,T]),E=()=>{s()};return e.jsx(fe,{"data-testid":"wallet-lock-dialog",onCancel:E,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),A?e.jsx(Mt,{title:k,description:a,appName:o,appIcon:d,chainId:_?void 0:m,walletInfo:_?{name:i,address:l,chainId:m}:void 0}):e.jsxs("div",{className:"px-4 pb-4 text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:k}),a&&e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:a})]}),e.jsx("div",{className:"px-4 pb-4",children:e.jsx(mt,{value:u,onChange:C,onComplete:I,minPoints:4,error:h,errorText:y??void 0,disabled:g,"data-testid":"wallet-lock-pattern"})}),e.jsxs("div",{className:"space-y-3 px-4 pb-4",children:[P&&e.jsxs("button",{type:"button",onClick:w,disabled:g,className:R("flex w-full items-center justify-center gap-2 rounded-full border border-border py-3 font-medium transition-colors","hover:bg-muted","disabled:cursor-not-allowed disabled:opacity-50"),children:[e.jsx(vp,{className:"size-5"}),e.jsx("span",{children:t("walletLock.biometric")})]}),e.jsx("button",{type:"button",onClick:E,disabled:g,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("walletLock.cancel")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Pl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Av,{})});Pl.__docgenInfo={description:"",methods:[],displayName:"WalletLockConfirmJob"};let Iv=null;function Tv(){const{t}=O(["security","transaction","common"]),{pop:s}=X(),{title:n,description:a}=pe(),[r,o]=c.useState(""),[d,i]=c.useState(),[l,m]=c.useState(!1),u=c.useRef(null);c.useRef(!1).current;const h=n??t("security:twoStepSecret.confirmTitle"),x=a??t("security:twoStepSecret.confirmDesc"),y=c.useCallback(async v=>{v.preventDefault();const j=u.current;if(!(!r.trim()||!j)){m(!0),i(void 0);try{await j(r)?s():i(t("security:twoStepSecret.notMatch"))}catch{i(t("security:twoStepSecret.notMatch"))}finally{m(!1)}}},[r,s,t]),p=r.trim().length>0&&!l,g=()=>{s()};return e.jsx(fe,{"data-testid":"two-step-secret-dialog",onCancel:g,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(Xs,{className:"size-5 text-primary"}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:h})]})}),e.jsxs("form",{onSubmit:y,className:"space-y-6 p-4",children:[e.jsx("p",{className:"text-center text-muted-foreground text-sm",children:x}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(gs,{value:r,onChange:v=>o(v.target.value),placeholder:t("security:twoStepSecret.inputPlaceholder"),disabled:l,"aria-describedby":d?"two-step-secret-error":void 0,"data-testid":"two-step-secret-input"}),d&&e.jsxs("div",{id:"two-step-secret-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(_t,{className:"size-4"}),e.jsx("span",{children:d})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{type:"submit",disabled:!p,"data-testid":"two-step-secret-confirm-button",className:R("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(l?"security:walletLock.verifying":"common:confirm")}),e.jsx("button",{type:"button",onClick:g,disabled:l,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("security:walletLock.cancel")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const _l=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Tv,{})});_l.__docgenInfo={description:"",methods:[],displayName:"TwoStepSecretConfirmJob"};let Es=null,Dn=null;function El(t,s){Es=t,Dn=s}function Gi(){Es=null,Dn=null}function Pv(){const{t}=O(["transaction","common"]),{pop:s}=X();pe();const n=c.useRef(Es),a=c.useRef(Dn),r=c.useRef(!1);!r.current&&Es&&(n.current=Es,a.current=Dn,Gi(),r.current=!0);const o=n.current,[d,i]=c.useState(o?.currentFee??""),[l,m]=c.useState();c.useEffect(()=>()=>{Gi()},[]);const u=c.useCallback(v=>{if(!o)return;const j=parseFloat(v),N=parseFloat(o.minFee);if(isNaN(j)||j<=0)return t("transaction:feeEdit.invalidFee");if(j<N)return t("transaction:feeEdit.belowMinFee",{minFee:o.minFee,symbol:o.symbol})},[o,t]),f=c.useCallback(v=>{const j=v.target.value;(j===""||/^\d*\.?\d*$/.test(j))&&(i(j),m(void 0))},[]),h=c.useCallback(v=>{i(v),m(void 0)},[]),x=c.useCallback(v=>{v.preventDefault();const j=u(d);if(j){m(j);return}a.current?.({fee:d}),s()},[d,u,s]),y=c.useCallback(()=>{s()},[s]);if(!o)return null;const p=[{label:t("transaction:feeEdit.presetMin"),value:o.minFee}],g=o.presets??p;return e.jsx(kl,{children:e.jsxs("div",{className:"bg-background rounded-2xl p-4","data-testid":"fee-edit-modal",children:[e.jsx("h2",{className:"mb-4 text-center text-lg font-semibold",children:t("transaction:feeEdit.title")}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 text-sm text-muted-foreground",children:[e.jsxs("p",{children:[t("transaction:feeEdit.currentFee"),": ",o.currentFee," ",o.symbol]}),e.jsxs("p",{children:[t("transaction:feeEdit.minFee"),": ",o.minFee," ",o.symbol]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:g.map(v=>e.jsx("button",{type:"button",onClick:()=>h(v.value),className:R("rounded-full px-3 py-1 text-sm transition-colors",d===v.value?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:v.label},v.value))}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("transaction:feeEdit.customFee")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{type:"text",inputMode:"decimal",value:d,onChange:f,placeholder:o.minFee,className:R(l&&"border-destructive"),"data-testid":"fee-input"}),e.jsx("span",{className:"shrink-0 text-sm text-muted-foreground",children:o.symbol})]}),l&&e.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(_t,{className:"size-4"}),e.jsx("span",{children:l})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(J,{type:"button",variant:"outline",onClick:y,className:"flex-1",children:t("common:cancel")}),e.jsx(J,{type:"submit",className:"flex-1",disabled:!d,children:t("common:confirm")})]})]})]})})}const Ml=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Pv,{})});Ml.__docgenInfo={description:"",methods:[],displayName:"FeeEditJob"};let Ms=null,zn=null,On=null,Bn="";function _v(t,s,n){Ms=t,zn=n??null,s&&(On=s.amount,Bn=s.symbol)}function Ev(){Ms=null,zn=null,On=null,Bn=""}function Mv(){const{t}=O(["security","transaction","common"]),{pop:s,push:n}=X(),{chainId:a,chainIcon:r,chainSymbol:o,address:d,chainName:i}=pe(),[l,m]=c.useState(""),[u,f]=c.useState(""),[h,x]=c.useState([]),[y,p]=c.useState(!1),[g,v]=c.useState("input"),[j,N]=c.useState(),[b,S]=c.useState(!1),[k,P]=c.useState("idle"),[_,A]=c.useState(),[T,C]=c.useState(null),I=c.useRef(Ms),w=c.useRef(zn),E=c.useRef({amount:On,symbol:Bn}),D=T??E.current.amount?.toDisplayString()??"0";c.useEffect(()=>(Ms&&!I.current&&(I.current=Ms,w.current=zn,E.current={amount:On,symbol:Bn}),()=>{Ev()}),[]);const z=c.useCallback(()=>{const F=E.current.amount?.toDisplayString()??"0";El({currentFee:D,minFee:F,symbol:E.current.symbol},G=>{C(G.fee)}),n("FeeEditJob",{})},[D,n]),L=c.useCallback(()=>{if(N(void 0),g==="input"){if(!l.trim())return;v("confirm")}else if(g==="confirm"){if(l!==u){N(t("security:twoStepSecret.notMatch"));return}v("walletLock")}},[g,l,u,t]),q=c.useCallback(()=>{g==="input"?s():g==="confirm"?(v("input"),N(void 0)):(v("confirm"),N(void 0),p(!1),x([]))},[g,s]),M=c.useCallback(async F=>{const G=I.current;if(F.length<4||!G)return;S(!0),P("broadcasting"),N(void 0),p(!1);const Z=Be(F);try{const B=await G(l,Z);B.success?(A(B.txHash),P("broadcasted")):(P("idle"),p(!0),x([]),N(B.error??t("security:twoStepSecret.setFailed")))}catch{P("idle"),p(!0),x([]),N(t("security:twoStepSecret.setFailed"))}finally{S(!1)}},[l,t]);return k!=="idle"?e.jsx(fe,{onCancel:q,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx(zo,{status:k,txHash:_,title:{confirmed:t("security:twoStepSecret.txConfirmed")},description:{confirmed:t("security:twoStepSecret.setSuccessDesc")},checkConfirmed:w.current??void 0,onStatusChange:P,onDone:()=>s()}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}):e.jsx(fe,{onCancel:q,children:e.jsxs("div",{className:"bg-background rounded-t-2xl","data-testid":"set-two-step-secret-dialog",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsxs("div",{className:"border-b border-border px-4 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(Xs,{className:"size-5 text-primary"}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("security:twoStepSecret.setTitle")})]}),a&&d?e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(Ga,{chainId:a,chainIcon:r,chainSymbol:o,address:d,size:"sm"})}):i?e.jsx("p",{className:"mt-1 text-center text-sm text-muted-foreground",children:i}):null]}),e.jsxs("div",{className:"space-y-6 p-4",children:[E.current.amount&&e.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-muted/50 p-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:t("security:twoStepSecret.feeInfo")}),e.jsx(Za,{amount:D,symbol:E.current.symbol,editable:!0,onEdit:z})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:R("size-2 rounded-full",g==="input"?"bg-primary":"bg-muted")}),e.jsx("div",{className:R("size-2 rounded-full",g==="confirm"?"bg-primary":"bg-muted")}),e.jsx("div",{className:R("size-2 rounded-full",g==="walletLock"?"bg-primary":"bg-muted")})]}),g==="input"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:t("security:twoStepSecret.inputDesc")}),e.jsx(gs,{value:l,onChange:F=>m(F.target.value),placeholder:t("security:twoStepSecret.inputPlaceholder"),"aria-describedby":j?"two-step-secret-error":void 0,"data-testid":"new-two-step-secret-input"})]}),g==="confirm"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:t("security:twoStepSecret.confirmDesc")}),e.jsx(gs,{value:u,onChange:F=>f(F.target.value),placeholder:t("security:twoStepSecret.confirmPlaceholder"),"aria-describedby":j?"two-step-secret-error":void 0,"data-testid":"confirm-two-step-secret-input"})]}),g==="walletLock"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:t("security:twoStepSecret.walletLockDesc")}),e.jsx(mt,{value:h,onChange:x,onComplete:M,minPoints:4,error:y,disabled:b,"data-testid":"wallet-lock-pattern"})]}),j&&e.jsxs("div",{id:"two-step-secret-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(_t,{className:"size-4"}),e.jsx("span",{children:j})]}),e.jsxs("div",{className:"space-y-3",children:[g!=="walletLock"&&e.jsx("button",{type:"button",onClick:L,"data-testid":"set-two-step-secret-next-button",className:R("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90"),children:t("common:next")}),e.jsx("button",{type:"button",onClick:q,disabled:b,"data-testid":"set-two-step-secret-cancel-button",className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t(g==="input"?"common:cancel":"common:back")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Rl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Mv,{})});Rl.__docgenInfo={description:"",methods:[],displayName:"SetTwoStepSecretJob"};let La=null;function Rv(){La=null}const Lv=[{value:"english",label:"English"},{value:"zh-Hans",label:""},{value:"zh-Hant",label:""}],Dv=[12,15,18,21,24,36];function zv(){const{t}=O("onboarding"),{pop:s}=X(),{language:n,length:a}=pe(),[r,o]=c.useState({language:n||"english",length:Number(a)||12}),d=u=>{o(f=>({...f,language:u}))},i=u=>{o(f=>({...f,length:u}))},l=()=>{La&&La(r),Rv(),s()},m=()=>{s()};return e.jsx(fe,{onCancel:m,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx("div",{className:"border-border border-b px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("create.mnemonicOptions.title")})}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:t("create.mnemonicOptions.language")}),e.jsx("div",{className:"space-y-1",role:"radiogroup",children:Lv.map(u=>e.jsxs("button",{type:"button",role:"radio","aria-checked":r.language===u.value,onClick:()=>d(u.value),className:R("flex w-full items-center justify-between rounded-lg px-4 py-3","hover:bg-muted/50 transition-colors",r.language===u.value&&"bg-muted"),children:[e.jsx("span",{className:"text-sm",children:u.label}),r.language===u.value&&e.jsx(je,{className:"text-primary size-5"})]},u.value))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:t("create.mnemonicOptions.wordCount")}),e.jsx("div",{className:"grid grid-cols-3 gap-2",role:"radiogroup",children:Dv.map(u=>e.jsxs("button",{type:"button",role:"radio","aria-checked":r.length===u,onClick:()=>i(u),className:R("flex items-center justify-center rounded-lg py-3 text-sm font-medium","transition-colors",r.length===u?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:[u," ",t("create.mnemonicOptions.words")]},u))})]}),e.jsx("button",{type:"button",onClick:l,className:R("text-primary-foreground w-full rounded-full py-3 font-medium transition-colors","bg-primary hover:bg-primary/90"),children:t("create.mnemonicOptions.confirm")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Ll=({params:t})=>e.jsx(me,{params:t,children:e.jsx(zv,{})});Ll.__docgenInfo={description:"",methods:[],displayName:"MnemonicOptionsJob"};const ha=3,Ov=10;function Bv(){const{t}=O("common"),{pop:s}=X(),{contactId:n}=pe(),a=Ae(Ls,C=>C.contacts),r=n?a.find(C=>C.id===n):null,[o,d]=c.useState(""),[i,l]=c.useState([{id:crypto.randomUUID(),label:"",address:""}]),[m,u]=c.useState(""),[f,h]=c.useState(()=>Math.floor(Math.random()*1e4)),[x,y]=c.useState(!1),p=!!r;c.useEffect(()=>{r&&(d(r.name),l(r.addresses.length>0?r.addresses.map(C=>({id:C.id,label:C.label||"",address:C.address})):[{id:crypto.randomUUID(),label:"",address:""}]),u(r.memo??""),y(!1))},[r]);const g=c.useCallback(()=>{h(Math.floor(Math.random()*1e4)),y(!0)},[]),v=i.find(C=>C.address.trim())?.address.trim(),j=!p||x?v?Ut(v,f):void 0:r?.avatar||(v?Ut(v,f):void 0),N=c.useCallback(()=>{i.length>=ha||l(C=>[...C,{id:crypto.randomUUID(),label:"",address:""}])},[i.length]),b=c.useCallback(C=>{l(I=>I.length<=1?I:I.filter(w=>w.id!==C))},[]),S=c.useCallback((C,I,w)=>{l(E=>E.map(D=>D.id===C?{...D,[I]:w}:D))},[]),k=c.useCallback(()=>{const C=o.trim(),I=m.trim(),w=i.filter(D=>D.address.trim()).map((D,z)=>({id:D.id,address:D.address.trim(),label:D.label.trim()||void 0,isDefault:z===0}));if(!C||w.length===0)return;const E=!p||x?w[0]?Ut(w[0].address,f):void 0:r?.avatar;p&&r?Ds.updateContact(r.id,{name:C,avatar:E,addresses:w,memo:I||void 0}):Ds.addContact({name:C,addresses:w,avatar:E,memo:I||void 0}),s()},[o,i,m,f,p,r,s]),P=i.some(C=>C.address.trim()),_=o.trim().length>0&&P,A=i.length<ha,T=()=>{s()};return e.jsx(fe,{onCancel:T,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t(p?"contact.editTitle":"contact.addTitle")})}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:g,disabled:!v,className:"group relative shrink-0",title:t("addressBook.changeAvatar"),children:[e.jsx(ys,{src:j,size:56}),v&&e.jsx("div",{className:"bg-background/80 absolute inset-0 flex items-center justify-center rounded-full opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx(ts,{className:"text-primary size-5"})})]}),e.jsx("input",{id:"contact-name",type:"text",value:o,onChange:C=>d(C.target.value),placeholder:t("contact.namePlaceholder"),maxLength:20,className:R("flex-1 rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:t("contact.addresses")}),e.jsx("span",{className:"text-muted-foreground text-xs",children:t("contact.addressCount",{count:i.length,max:ha})})]}),i.map((C,I)=>e.jsxs("div",{className:"space-y-2 rounded-xl border border-border p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:C.label,onChange:w=>S(C.id,"label",w.target.value),placeholder:t("contact.addressLabelPlaceholder"),maxLength:Ov,className:R("w-24 shrink-0 rounded-lg border border-border bg-muted/50 px-3 py-2 text-sm","focus:outline-none focus:ring-2 focus:ring-primary")}),i.length>1&&e.jsx("button",{type:"button",onClick:()=>b(C.id),className:"text-muted-foreground hover:text-destructive shrink-0 p-1",children:e.jsx(es,{className:"size-4"})}),I===0&&e.jsx("span",{className:"bg-primary/10 text-primary rounded px-1.5 py-0.5 text-xs",children:t("contact.defaultLabel")})]}),e.jsx("input",{type:"text",value:C.address,onChange:w=>S(C.id,"address",w.target.value),placeholder:t("contact.addressPlaceholder"),className:R("w-full rounded-lg border border-border bg-background px-3 py-2 font-mono text-sm","focus:outline-none focus:ring-2 focus:ring-primary")})]},C.id)),A&&e.jsxs("button",{type:"button",onClick:N,className:"flex w-full items-center justify-center gap-2 rounded-xl border border-dashed border-border py-3 text-sm text-muted-foreground hover:border-primary hover:text-primary",children:[e.jsx(ut,{className:"size-4"}),t("contact.addAddress")]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"contact-memo",className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(_o,{className:"size-4"}),t("contact.memoOptional")]}),e.jsx("textarea",{id:"contact-memo",value:m,onChange:C=>u(C.target.value),placeholder:t("contact.memoPlaceholder"),maxLength:100,rows:2,className:R("w-full resize-none rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")})]}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsx("button",{onClick:k,disabled:!_,className:R("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(p?"contact.save":"contact.add")}),e.jsx("button",{onClick:T,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("contact.cancel")})]})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Dl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Bv,{})});Dl.__docgenInfo={description:"",methods:[],displayName:"ContactEditJob"};function Fv(t,s=8,n=6){return t.length<=s+n+3?t:`${t.slice(0,s)}...${t.slice(-n)}`}function Wv(){const{t}=O("common"),{pop:s}=X(),{chainType:n}=pe(),a=n,[r,o]=c.useState(""),d=Ae(Ls),i=c.useMemo(()=>{let u=d.contacts;return r&&(u=Ua.searchContacts(d,r)),u=[...u].toSorted((f,h)=>h.updatedAt-f.updatedAt),u.map(f=>{const h=f.addresses.map(y=>({...y,isValidForCurrentChain:a?mf(y.address,a):!0})),x=h.some(y=>y.isValidForCurrentChain);return{contact:f,addresses:h,hasValidAddress:x}})},[d,r,a]),l=(u,f)=>{const h=new CustomEvent("contact-picker-select",{detail:{contact:u,address:f}});window.dispatchEvent(h),s()},m=()=>{s()};return e.jsx(fe,{onCancel:m,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx("div",{className:"border-border border-b px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("contact.selectAddress")})}),e.jsx("div",{className:"border-border border-b p-4",children:e.jsxs("div",{className:"bg-muted/50 flex items-center gap-2 rounded-xl px-3 py-2",children:[e.jsx(Zs,{className:"text-muted-foreground size-4"}),e.jsx("input",{type:"text",value:r,onChange:u=>o(u.target.value),placeholder:t("addressBook.searchPlaceholder"),className:"placeholder:text-muted-foreground min-w-0 flex-1 bg-transparent text-sm outline-none"})]})}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto",children:i.length===0?e.jsx("div",{className:"text-muted-foreground py-12 text-center text-sm",children:t(r?"addressBook.noResults":"contact.noContacts")}):e.jsx("div",{className:"divide-border divide-y",children:i.map(({contact:u,addresses:f,hasValidAddress:h})=>e.jsxs("div",{className:R(!h&&"opacity-50"),children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 pt-3 pb-2",children:[e.jsx(ys,{src:u.avatar||(f[0]?.address?Ut(f[0].address):void 0),size:40,className:"shrink-0"}),e.jsx("p",{className:"min-w-0 flex-1 truncate font-medium",children:u.name})]}),e.jsx("div",{className:"space-y-1 pb-3 pl-[56px] pr-4",children:f.map(x=>{const y=!x.isValidForCurrentChain,p=x.label;return e.jsxs("button",{onClick:()=>!y&&l(u,x),disabled:y,className:R("flex min-h-[44px] w-full items-center gap-3 rounded-xl px-3 py-2.5 transition-colors",y?"cursor-not-allowed opacity-50":"hover:bg-muted/50 active:bg-muted"),children:[e.jsx("p",{className:R("min-w-0 flex-1 truncate text-left font-mono text-sm",y?"text-muted-foreground/50":"text-foreground"),children:Fv(x.address)}),e.jsxs("div",{className:"flex shrink-0 items-center gap-2",children:[p&&e.jsx("span",{className:R("max-w-[5rem] truncate rounded-md bg-muted px-2 py-0.5 text-xs",y?"text-muted-foreground/50":"text-muted-foreground"),children:p}),x.isDefault&&e.jsx("span",{className:"bg-primary/10 text-primary rounded-md px-2 py-0.5 text-xs",children:t("contact.defaultLabel")})]})]},x.id)})})]},u.id))})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const zl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Wv,{})});zl.__docgenInfo={description:"",methods:[],displayName:"ContactPickerJob"};const Ol=()=>{const{t}=O(["wallet","home"]),{pop:s}=X(),{navigate:n}=ce(),a=()=>{s(),n({to:"/wallet/create"})},r=()=>{s(),n({to:"/onboarding/recover"})},o=()=>{s()};return e.jsx(fe,{onCancel:o,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("wallet:add")})}),e.jsxs("div",{className:"space-y-3 p-4",children:[e.jsxs("button",{onClick:a,className:R("flex w-full items-center gap-4 rounded-xl p-4 transition-colors","bg-muted/50 hover:bg-muted active:bg-muted/80"),children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10",children:e.jsx(ut,{className:"size-6 text-primary"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-semibold",children:t("home:welcome.createWallet")}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t("wallet:createDesc")})]})]}),e.jsxs("button",{onClick:r,className:R("flex w-full items-center gap-4 rounded-xl p-4 transition-colors","bg-muted/50 hover:bg-muted active:bg-muted/80"),children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10",children:e.jsx(en,{className:"size-6 text-primary"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-semibold",children:t("home:welcome.importWallet")}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t("wallet:importDesc")})]})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};Ol.__docgenInfo={description:"",methods:[],displayName:"WalletAddJob"};const Bl=()=>{const{t}=O(["wallet","common"]),{pop:s,push:n}=X(),a=Et(),o=Fe()?.id,{getWalletTheme:d}=No(),i=wo(),l=f=>{ge.setCurrentWallet(f),s()},m=()=>{s(),n("WalletAddJob",{})},u=()=>{s()};return e.jsx(fe,{onCancel:u,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("common:a11y.tabWallet")})}),e.jsx("div",{className:"max-h-[50vh] space-y-2 overflow-y-auto p-4",children:a.map(f=>{const h=f.id===o,x=f.chainAddresses[0]?.address,y=x?`${x.slice(0,6)}...${x.slice(-4)}`:"---",p=d(f.id);return e.jsxs("button",{onClick:()=>l(f.id),className:R("flex w-full items-center gap-3 rounded-xl p-4 transition-all","active:scale-[0.98]",h?"bg-primary/10 ring-2 ring-primary":"bg-muted/50 hover:bg-muted"),children:[e.jsx(pf,{themeHue:p,size:"md",watermarkIconUrl:i[f.chain]}),e.jsxs("div",{className:"min-w-0 flex-1 text-left",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate font-medium",children:f.name}),h&&e.jsx(xf,{className:"size-4 shrink-0 text-primary"})]}),e.jsx("p",{className:"truncate font-mono text-xs text-muted-foreground",children:y})]})]},f.id)})}),e.jsx("div",{className:"border-t border-border p-4",children:e.jsxs("button",{onClick:m,className:R("flex w-full items-center justify-center gap-2 rounded-xl p-4","bg-muted/50 hover:bg-muted active:bg-muted/80 transition-colors"),children:[e.jsx(ut,{className:"size-5"}),e.jsx("span",{className:"font-medium",children:t("wallet:add")})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};Bl.__docgenInfo={description:"",methods:[],displayName:"WalletListJob"};let Da=null;function $v(t){Da=t}const Fl=()=>{const{t}=O(["onboarding","common"]),{pop:s}=X(),[n,a]=c.useState(!1),r=()=>{s()},o=()=>{n&&(s(),Da?.(),Da=null)};return e.jsx(kl,{children:e.jsxs("div",{className:"bg-background mx-4 max-w-sm rounded-2xl p-5",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"rounded-full bg-amber-500/15 p-2",children:e.jsx(Oe,{className:"size-5 text-amber-600","aria-hidden":"true"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h2",{className:"text-base font-semibold",children:t("onboarding:securityWarning.title")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:t("onboarding:securityWarning.message")})]})]}),e.jsxs("label",{className:"mt-4 flex cursor-pointer items-center gap-2 text-sm",children:[e.jsx(Oo,{checked:n,onCheckedChange:a}),e.jsx("span",{children:t("onboarding:securityWarning.acknowledge")})]}),e.jsxs("div",{className:"mt-5 flex gap-2",children:[e.jsx(J,{type:"button",variant:"outline",className:"flex-1",onClick:r,children:t("common:cancel")}),e.jsx(J,{type:"button",className:"flex-1",onClick:o,disabled:!n,children:t("common:confirm")})]})]})})};Fl.__docgenInfo={description:"",methods:[],displayName:"SecurityWarningJob"};let Rs=null;function Wl(t,s){Rs={onConfirm:t,minFee:s?.minFee,onFeeChange:s?.onFeeChange}}function Qi(){Rs=null}function qv(t){return t.length<=16?t:`${t.slice(0,10)}...${t.slice(-6)}`}function Hv(){const{t}=O("transaction"),{pop:s,push:n}=X(),a=pe(),[r,o]=c.useState(!1),[d,i]=c.useState(!1),[l,m]=c.useState(!1),[u,f]=c.useState(null),h=c.useRef(Rs),x=c.useRef(!1);!x.current&&Rs&&(h.current=Rs,Qi(),x.current=!0),c.useEffect(()=>()=>{Qi()},[]);const y=a.feeLoading==="true",p=a.feeFiatValue?parseFloat(a.feeFiatValue):void 0,g=u??a.feeAmount,v=!!h.current?.onFeeChange,j=c.useCallback(async()=>{try{await Qa.write({text:a.toAddress}),i(!0),setTimeout(()=>i(!1),2e3)}catch{}},[a.toAddress]),N=c.useCallback(()=>{o(P=>!P)},[]),b=c.useCallback(()=>{const P=h.current;P?.onFeeChange&&(El({currentFee:g,minFee:P.minFee??a.feeAmount,symbol:a.feeSymbol},_=>{f(_.fee),P.onFeeChange?.(_.fee)}),n("FeeEditJob",{}))},[g,a.feeAmount,a.feeSymbol,n]),S=c.useCallback(async()=>{const P=h.current;if(!(!P?.onConfirm||l)){m(!0);try{s(),await P.onConfirm()}finally{m(!1)}}},[l,s]),k=c.useCallback(()=>{s()},[s]);return e.jsx(fe,{"data-testid":"transfer-confirm-sheet",onCancel:k,children:e.jsx(Rn,{title:t("confirmSheet.title"),children:e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-3xl font-bold",children:[a.amount," ",a.symbol]}),a.fiatValue&&e.jsxs("p",{className:"text-muted-foreground mt-1",children:[" $",a.fiatValue]})]}),e.jsxs("div",{className:"bg-muted/30 space-y-4 rounded-xl p-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:t("confirmSheet.toAddress")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:N,className:"hover:text-primary flex min-w-0 flex-1 items-center gap-1 text-left font-mono text-sm",children:[e.jsx("span",{className:R("min-w-0",r?"break-all":"truncate"),children:r?a.toAddress:qv(a.toAddress)}),r?e.jsx(Bo,{className:"size-4 shrink-0"}):e.jsx(Wo,{className:"size-4 shrink-0"})]}),e.jsx("button",{type:"button",onClick:j,className:"text-muted-foreground hover:text-foreground shrink-0 p-1","aria-label":t(d?"confirmSheet.copied":"confirmSheet.copyAddress"),children:d?e.jsx(je,{className:"size-4 text-green-500"}):e.jsx(Ao,{className:"size-4"})})]})]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:t("confirmSheet.networkFee")}),e.jsx(Za,{amount:g,symbol:a.feeSymbol,...p!==void 0&&{fiatValue:p},isLoading:y,editable:v,onEdit:b})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button","data-testid":"cancel-transfer-button",onClick:k,className:"border-border hover:bg-muted flex-1 rounded-full border py-3 font-medium transition-colors",disabled:l,children:t("confirmSheet.cancel")}),e.jsx("button",{type:"button","data-testid":"confirm-transfer-button",onClick:S,disabled:l||y,className:R("flex-1 rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(l?"confirmSheet.confirming":"confirmSheet.confirm")})]})]})})})}const $l=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Hv,{})});$l.__docgenInfo={description:"",methods:[],displayName:"TransferConfirmJob"};let Fn=null;function ql(t){Fn=t}function Uv(){Fn=null}function Vv(){const{t}=O(["security","transaction","common"]),{pop:s,push:n}=X(),{title:a}=pe(),r=dr(),o=st(),d=Je(),i=dt(),l=Fe(),[m,u]=c.useState("wallet_lock"),[f,h]=c.useState([]),[x,y]=c.useState(""),[p,g]=c.useState("idle"),[v,j]=c.useState(),[N,b]=c.useState(),[S,k]=c.useState(!1),[P,_]=c.useState(!1),[A,T]=c.useState(),[C,I]=c.useState(null),w=c.useRef(null),E=c.useRef(""),D=c.useRef(!1);!D.current&&Fn&&(w.current=Fn,Uv(),D.current=!0),c.useEffect(()=>{if(!v||!d||!l?.address)return;const se=Pe(d);return se?.transaction?se.transaction.subscribe({txHash:v,senderId:l.address},H=>{H&&(H.status==="confirmed"?g("confirmed"):H.status==="failed"?g("failed"):H.status==="pending"&&g("broadcasted"))}):void 0},[v,d,l?.address]),c.useEffect(()=>{if(p!=="confirmed"){I(null);return}I(5);const se=setInterval(()=>{I(U=>U===null||U<=1?(clearInterval(se),s(),null):U-1)},1e3);return()=>clearInterval(se)},[p,s]);const z=c.useMemo(()=>He.getChainById(i,d),[i,d]),L=c.useMemo(()=>{const se=z?.explorer?.queryTx;return!se||!v?null:se.replace(":hash",v).replace(":signature",v)},[z?.explorer?.queryTx,v]),q=c.useCallback(()=>{L&&window.open(L,"_blank","noopener,noreferrer")},[L]),M=m==="wallet_lock"?a??t("security:walletLock.verifyTitle"):t("transaction:sendPage.twoStepSecretTitle"),F=c.useCallback(async se=>{const U=w.current;if(se.length<4||!U)return;_(!0),b(void 0),k(!1),g("broadcasting");const H=Be(se);E.current=H;try{const Q=await U(H);if(Q.status==="ok"){Q.txHash&&j(Q.txHash),Q.pendingTxId&&T(Q.pendingTxId),g("broadcasted");return}if(Q.status==="wallet_lock_invalid"){k(!0),h([]),g("idle");return}if(Q.status==="two_step_secret_required"){u("two_step_secret"),b(void 0),g("idle");return}if(Q.status==="error"){b(Q.message??t("transaction:broadcast.unknown")),g("failed"),Q.pendingTxId&&T(Q.pendingTxId);return}}catch{b(t("transaction:broadcast.unknown")),g("failed")}finally{_(!1)}},[t]),G=c.useCallback(async()=>{const se=w.current;if(!(!x.trim()||!se)){_(!0),b(void 0);try{const U=await se(E.current,x);if(U.status==="ok"){U.txHash&&j(U.txHash),U.pendingTxId&&T(U.pendingTxId),g("broadcasted");return}(U.status==="two_step_secret_invalid"||U.status==="error")&&(b(U.message??t("transaction:sendPage.twoStepSecretError")),U.pendingTxId&&(T(U.pendingTxId),g("failed")))}catch{b(t("transaction:sendPage.twoStepSecretError"))}finally{_(!1)}}},[x,t]),Z=c.useCallback(se=>{se.preventDefault(),m==="two_step_secret"&&G()},[m,G]),B=x.trim().length>0&&!P,$=c.useCallback(async()=>{if(A){_(!0),b(void 0);try{await cm.retryBroadcast(A,i),g("broadcasted")}catch(se){b(se instanceof Error?se.message:t("transaction:broadcast.unknown"))}finally{_(!1)}}},[A,i,t]),ye=c.useCallback(()=>{s()},[s]);if(p!=="idle"){const se=p==="failed",U=p==="confirmed";return e.jsx(fe,{onCancel:ye,children:e.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx(zo,{status:p,txHash:v,title:{broadcasted:t("transaction:txStatus.broadcasted"),confirmed:t("transaction:sendResult.success"),failed:t("transaction:broadcast.failed")},description:{broadcasted:t("transaction:txStatus.broadcastedDesc"),confirmed:C!==null?t("transaction:txStatus.autoCloseIn",{seconds:C}):t("transaction:txStatus.confirmedDesc"),failed:N},onStatusChange:g,onDone:()=>s(),onViewDetails:()=>{s(),v&&n("TransactionDetailActivity",{txId:v})},onViewExplorer:L?q:void 0,onShare:async()=>{v&&(await r.write({text:v}),o.show(t("common:copied")))}}),e.jsxs("div",{className:"px-4 pb-4 space-y-2",children:[se&&e.jsxs("button",{type:"button",onClick:$,disabled:P,className:R("w-full flex items-center justify-center gap-2 rounded-full py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:[e.jsx(ts,{className:"size-4"}),t(P?"common:retrying":"transaction:pendingTx.retry")]}),e.jsx("button",{type:"button",onClick:ye,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:U&&C!==null?t("transaction:txStatus.closeIn",{seconds:C}):t("common:close")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})})}return m==="wallet_lock"?e.jsx(fe,{onCancel:ye,children:e.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:e.jsx(Rn,{title:M,children:e.jsxs("div",{className:"p-4",children:[e.jsx(mt,{value:f,onChange:h,onComplete:F,minPoints:4,error:S,disabled:P,"data-testid":"transfer-wallet-lock-pattern"}),N&&e.jsxs("div",{className:"flex items-start justify-center gap-1.5 text-sm text-destructive mt-3",children:[e.jsx(_t,{className:"size-4 shrink-0 mt-0.5"}),e.jsx("pre",{className:"overflow-auto whitespace-break-spaces",children:N})]}),e.jsx("button",{type:"button",onClick:ye,disabled:P,className:"mt-4 w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("common:cancel")})]})})})}):e.jsx(fe,{onCancel:ye,children:e.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:e.jsx(Rn,{title:M,children:e.jsxs("form",{onSubmit:Z,className:"space-y-6 p-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-primary mb-2",children:[e.jsx(Xs,{className:"size-5"}),e.jsx("span",{className:"text-sm",children:t("transaction:sendPage.twoStepSecretDescription")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(gs,{value:x,onChange:se=>y(se.target.value),placeholder:t("transaction:sendPage.twoStepSecretPlaceholder"),disabled:P,"aria-describedby":N?"two-step-error":void 0,"data-testid":"two-step-secret-input"}),x.length>0&&x.length<6&&e.jsx("div",{className:"absolute right-10 top-1/2 -translate-y-1/2",children:e.jsx("span",{className:"text-xs text-amber-500",children:t("security:twoStepSecret.lengthHint",{count:x.length})})})]}),N&&e.jsxs("div",{id:"two-step-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(_t,{className:"size-4"}),e.jsx("span",{children:N})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{type:"submit","data-testid":"two-step-confirm-button",disabled:!B,className:R("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(P?"common:verifying":"common:confirm")}),e.jsx("button",{type:"button",onClick:()=>s(),disabled:P,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("common:cancel")})]})]})})})})}const Hl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Vv,{})});Hl.__docgenInfo={description:"",methods:[],displayName:"TransferWalletLockJob"};const Jv=150;function Kv(){const{t}=O("scanner"),{pop:s}=X(),n=lc(),{chainType:a,title:r,hint:o}=pe(),d=c.useRef(null),i=c.useRef(null),l=c.useRef(null),m=c.useRef(null),u=c.useRef(!1),f=c.useRef(!1),h=c.useRef(!1),[x,y]=c.useState(!1),[p,g]=c.useState(!1),[v,j]=c.useState(null),[N,b]=c.useState(null),S=vf(a),k=c.useCallback(w=>{if(w===N)return;b(w);const E=$o(w),D=S(w,E);if(D===!0){j({type:"success",text:t("scanSuccess")}),"vibrate"in navigator&&navigator.vibrate(100),u.current=!1;const z=yf();setTimeout(()=>{s(),setTimeout(()=>{z?.({content:w,parsed:E})},100)},300)}else j({type:"error",text:t(D,{defaultValue:D})}),setTimeout(()=>{j(null),b(null)},3e3)},[N,S,t,s]),P=c.useCallback(()=>{if(u.current)return;u.current=!0,i.current||(i.current=document.createElement("canvas"));const w=async()=>{if(!(!u.current||!d.current||!m.current)){try{const E=await m.current.scanFromVideo(d.current,i.current??void 0);E&&k(E.content)}catch{}u.current&&setTimeout(w,Jv)}};w()},[k]),_=c.useCallback(()=>{u.current=!1,l.current&&(l.current.getTracks().forEach(w=>w.stop()),l.current=null),y(!1)},[]),A=c.useCallback(async()=>{if(!h.current){if(h.current=!0,!navigator.mediaDevices?.getUserMedia){j({type:"error",text:t("error")}),h.current=!1;return}try{try{if(!await n.checkPermission()&&!await n.requestPermission()){j({type:"error",text:t("permissionDenied")}),h.current=!1;return}}catch{}if(!f.current){h.current=!1;return}const w=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});if(!f.current){w.getTracks().forEach(E=>E.stop()),h.current=!1;return}if(l.current=w,d.current){d.current.srcObject=w;try{await d.current.play(),f.current&&(y(!0),P())}catch(E){if(!(E instanceof DOMException&&E.name==="AbortError"))throw E}}}catch(w){if(!f.current){h.current=!1;return}w instanceof DOMException?w.name==="NotAllowedError"?j({type:"error",text:t("permissionDenied")}):w.name==="NotFoundError"?j({type:"error",text:t("noCameraFound",{defaultValue:t("error")})}):w.name==="AbortError"||j({type:"error",text:t("error")}):j({type:"error",text:t("error")})}finally{h.current=!1}}},[n,P,t]);c.useEffect(()=>(f.current=!0,m.current=qo({useWorker:!0}),A(),()=>{f.current=!1,_(),m.current?.destroy(),m.current=null}),[]);const T=c.useCallback(()=>{const w=document.createElement("input");w.type="file",w.accept="image/*",w.onchange=async E=>{const D=E.target.files?.[0];if(!(!D||!m.current))try{const z=new Image,L=URL.createObjectURL(D);z.onload=async()=>{URL.revokeObjectURL(L);const q=document.createElement("canvas");q.width=z.width,q.height=z.height;const M=q.getContext("2d");if(!M||!m.current){j({type:"error",text:t("noQrFound")});return}M.drawImage(z,0,0);const F=await m.current.scanFromCanvas(q);F?k(F.content):j({type:"error",text:t("noQrFound")})},z.onerror=()=>{URL.revokeObjectURL(L),j({type:"error",text:t("noQrFound")})},z.src=L}catch{j({type:"error",text:t("noQrFound")})}},w.click()},[k,t]),C=c.useCallback(async()=>{if(l.current){const w=l.current.getVideoTracks()[0];if(w)try{await w.applyConstraints({advanced:[{torch:!p}]}),g(!p)}catch{}}},[p]),I=c.useCallback(()=>{_(),s()},[_,s]);return e.jsx(fe,{onCancel:I,children:e.jsxs("div",{className:"flex h-[80vh] flex-col overflow-hidden rounded-t-2xl bg-black",children:[e.jsx("div",{className:"flex justify-center py-2",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-white/30"})}),e.jsxs("div",{className:"flex items-center justify-between px-4 pb-2",children:[e.jsx(J,{variant:"ghost",size:"icon",onClick:I,className:"text-white hover:bg-white/20","data-testid":"scanner-close-button",children:e.jsx(tn,{className:"size-6"})}),e.jsx("h2",{className:"text-lg font-medium text-white","data-testid":"scanner-title",children:r??t("title")}),e.jsx(J,{variant:"ghost",size:"icon",onClick:C,className:R("text-white hover:bg-white/20",p&&"text-yellow-400"),"data-testid":"scanner-flash-button",children:e.jsx(nc,{className:"size-6"})})]}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("video",{ref:d,className:R("absolute inset-0 size-full object-cover",!x&&"hidden"),playsInline:!0,muted:!0,"data-testid":"scanner-video"}),!x&&!v&&e.jsx("div",{className:"flex size-full items-center justify-center",children:e.jsx("p",{className:"text-white/60",children:t("initializing")})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"relative size-64","data-testid":"scanner-viewfinder",children:[e.jsx("div",{className:R("absolute top-0 left-0 size-8 border-t-4 border-l-4",v?.type==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:R("absolute top-0 right-0 size-8 border-t-4 border-r-4",v?.type==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:R("absolute bottom-0 left-0 size-8 border-b-4 border-l-4",v?.type==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:R("absolute right-0 bottom-0 size-8 border-r-4 border-b-4",v?.type==="success"?"border-green-500":"border-primary")}),x&&!v&&e.jsx("div",{className:"animate-scan bg-primary absolute right-2 left-2 h-0.5"})]})}),e.jsx("div",{className:"absolute inset-x-0 bottom-24 px-4 text-center",children:v?e.jsx("div",{className:R("inline-block rounded-lg px-4 py-2",v.type==="error"&&"bg-red-500/80 text-white",v.type==="success"&&"bg-green-500/80 text-white",v.type==="info"&&"bg-black/50 text-white"),"data-testid":"scanner-message",children:v.text}):x?e.jsx("p",{className:"text-white/80","data-testid":"scanner-hint",children:o??(a?t("scanPromptChain",{chain:a}):t("scanPrompt"))}):null})]}),e.jsx("div",{className:"flex justify-center gap-8 bg-black/50 py-6",children:e.jsxs(J,{variant:"ghost",size:"lg",onClick:T,className:"flex flex-col items-center text-white hover:bg-white/20","data-testid":"scanner-gallery-button",children:[e.jsx(ec,{className:"mb-1 size-6"}),e.jsx("span",{className:"text-xs",children:t("gallery")})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)] bg-black"})]})})}const Ul=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Kv,{})});Ul.__docgenInfo={description:"",methods:[],displayName:"ScannerJob"};function Gv(){const{t}=O("common"),{pop:s}=X(),n=pe(),[a,r]=c.useState(n.name||""),[o,d]=c.useState(n.memo||""),[i,l]=c.useState(0),[m,u]=c.useState(!1),[f,h]=c.useState(!1),x=(()=>{try{return JSON.parse(n.addresses||"[]")}catch{return[]}})(),y=c.useCallback(()=>{l(v=>v+1)},[]),p=c.useCallback(async()=>{if(!(!a.trim()||x.length===0)){u(!0);try{const v=n.avatar||(x[0]?.address?Ut(x[0].address,i):void 0);Ds.addContact({name:a.trim(),addresses:x.map((j,N)=>({id:`addr-${N}`,address:j.address,label:j.label,isDefault:N===0})),memo:o.trim()||void 0,avatar:v}),h(!0),setTimeout(()=>s(),500)}catch{}finally{u(!1)}}},[a,o,x,n.avatar,i,s]),g=c.useCallback(()=>{s()},[s]);return e.jsx(fe,{onCancel:g,children:e.jsxs("div",{className:"bg-background rounded-t-2xl pb-[env(safe-area-inset-bottom)]",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx("div",{className:"border-border border-b px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("addressBook.addContact")})}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:y,className:"group relative",title:t("addressBook.changeAvatar"),children:[e.jsx(ys,{src:n.avatar||(x[0]?.address?Ut(x[0].address,i):void 0),size:48}),!n.avatar&&e.jsx("div",{className:"bg-background/80 absolute inset-0 flex items-center justify-center rounded-full opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx(ts,{className:"text-primary size-5"})})]}),e.jsx(Ve,{value:a,onChange:v=>r(v.target.value),placeholder:t("addressBook.namePlaceholder"),className:"flex-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm",children:t("addressBook.addresses")}),e.jsx("div",{className:"space-y-2",children:x.map((v,j)=>{const N=ff(v.address),b=v.label||N.chainType?.toUpperCase()||"";return e.jsxs("div",{className:"bg-muted/50 flex items-center gap-3 rounded-lg p-3",children:[e.jsx(tr,{className:"text-muted-foreground size-5 shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[b&&e.jsx("div",{className:"text-muted-foreground text-xs",children:b}),e.jsx("div",{className:"truncate font-mono text-sm",children:v.address})]})]},j)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm",children:t("addressBook.memo")}),e.jsx(Ve,{value:o,onChange:v=>d(v.target.value),placeholder:t("addressBook.memoPlaceholder")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx(J,{variant:"outline",onClick:g,disabled:m||f,className:"flex-1",children:t("cancel")}),e.jsx(J,{onClick:p,disabled:!a.trim()||x.length===0||m||f,className:R("flex-1",f&&"bg-green-500"),children:f?e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"mr-1 size-4"}),t("saved")]}):t(m?"saving":"save")})]})]})})}const Vl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Gv,{})});Vl.__docgenInfo={description:"",methods:[],displayName:"ContactAddConfirmJob"};function Qv(){const{t}=O("common"),{pop:s}=X(),n=pe(),a=c.useRef(null),[r,o]=c.useState(!1),d=c.useMemo(()=>{try{return JSON.parse(n.addresses||"[]")}catch{return[]}},[n.addresses]),i=c.useMemo(()=>er({name:n.name,addresses:d,avatar:n.avatar}),[n.name,d,n.avatar]),l=c.useCallback(async()=>{const f=a.current;if(!(!f||r)){o(!0);try{const{snapdom:h}=await Tt(async()=>{const{snapdom:x}=await import("./snapdom-CO8q8LPW.js").then(y=>y.s);return{snapdom:x}},__vite__mapDeps([0,1]),import.meta.url);await h.download(f,{type:"png",filename:`contact-${n.name}.png`,scale:2,quality:1})}catch{}finally{o(!1)}}},[n.name,r]),m=c.useCallback(async()=>{const f=a.current;if(!(!f||!navigator.share)){o(!0);try{const{snapdom:h}=await Tt(async()=>{const{snapdom:g}=await import("./snapdom-CO8q8LPW.js").then(v=>v.s);return{snapdom:g}},__vite__mapDeps([0,1]),import.meta.url),y=await(await h(f,{scale:2})).toBlob(),p=new File([y],`contact-${n.name}.png`,{type:"image/png"});await navigator.share({title:t("addressBook.shareContact"),text:`${n.name} - ${d.map(g=>`${g.label||""}: ${g.address}`).join(", ")}`,files:[p]})}catch{}finally{o(!1)}}},[n.name,d,t,r]),u=()=>{s()};return e.jsx(fe,{onCancel:u,children:e.jsxs("div",{className:"bg-background rounded-t-2xl pb-[env(safe-area-inset-bottom)]",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"flex items-center justify-between border-b px-4 pb-4",children:[e.jsx(J,{variant:"ghost",size:"icon",onClick:u,children:e.jsx(tn,{className:"size-5"})}),e.jsx("h2",{className:"text-lg font-semibold",children:t("addressBook.shareContact")}),e.jsx("div",{className:"w-10"})]}),e.jsxs("div",{className:"flex flex-col items-center p-6",children:[e.jsx("div",{ref:a,children:e.jsx(sr,{name:n.name,avatar:n.avatar,addresses:d,qrContent:i})}),e.jsx("p",{className:"text-muted-foreground mt-4 text-center text-sm",children:t("addressBook.scanToAdd")})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsxs(J,{variant:"outline",onClick:l,disabled:r,className:"flex-1",children:[r?e.jsx(ve,{className:"mr-2 size-4 animate-spin"}):e.jsx(en,{className:"mr-2 size-4"}),t("download")]}),"share"in navigator&&e.jsxs(J,{onClick:m,disabled:r,className:"flex-1",children:[r?e.jsx(ve,{className:"mr-2 size-4 animate-spin"}):e.jsx($s,{className:"mr-2 size-4"}),t("share")]})]})]})})}const Jl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Qv,{})});Jl.__docgenInfo={description:"",methods:[],displayName:"ContactShareJob"};function Yv(){const{t}=O(["settings","common"]),{pop:s}=X(),[n,a]=c.useState(!1),r=c.useCallback(()=>{a(!0);const d="./";window.location.href=`${d}clear.html`},[]),o=()=>{s()};return e.jsx(fe,{onCancel:o,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-destructive/10 flex size-16 items-center justify-center rounded-full",children:e.jsx(Oe,{className:"text-destructive size-8"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:t("settings:clearData.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("settings:clearData.warning")})]}),e.jsx("div",{className:"bg-destructive/5 rounded-lg p-4",children:e.jsxs("ul",{className:"text-destructive space-y-2 text-sm",children:[e.jsxs("li",{children:[" ",t("settings:clearData.item1")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item2")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item3")]})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(J,{variant:"outline",className:"flex-1",onClick:o,disabled:n,children:t("common:cancel")}),e.jsx(J,{variant:"destructive",className:"flex-1",onClick:r,disabled:n,children:t("settings:clearData.confirm")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Kl=()=>e.jsx(Yv,{});Kl.__docgenInfo={description:"",methods:[],displayName:"ClearDataConfirmJob"};function Xv(t){if(!t)return;if(t.startsWith("0x")){const n=Vn(t);if(n)return n}const s=jf(t);return lt.getConfig(s),s}function Zv(){const{t}=O("common"),{pop:s}=X(),{chain:n,exclude:a,appName:r,appIcon:o}=pe(),d=Gs(),i=c.useMemo(()=>Xv(n),[n]),l=c.useMemo(()=>i?d.find(g=>g.id===i):null,[i,d]),m=i?lt.getName(i):void 0,u=Ae(Le),f=Ks.getCurrentWallet(u),h=c.useMemo(()=>{const g=a?.toLowerCase(),v=[];for(const j of u.wallets){const N=i?j.chainAddresses.find(b=>b.chain===i):j.chainAddresses[0];N&&(g&&N.address.toLowerCase()===g||v.push({id:j.id,name:j.name,address:N.address,themeHue:j.themeHue,chainIconUrl:l?.icon}))}return v},[u.wallets,i,a]),x=c.useMemo(()=>{const g=new Map;return u.wallets.forEach(v=>{const j=i?v.chainAddresses.find(N=>N.chain===i):v.chainAddresses[0];j&&g.set(v.id,{wallet:v,chainAddress:j})}),g},[u.wallets,i]),y=g=>{const v=x.get(g);if(!v)return;const j=new CustomEvent("wallet-picker-select",{detail:{address:v.chainAddress.address,chain:v.chainAddress.chain,name:v.wallet.name,publicKey:v.chainAddress.publicKey}});window.dispatchEvent(j),s()},p=g=>{g?.preventDefault?.();const v=new CustomEvent("wallet-picker-cancel");window.dispatchEvent(v),s()};return e.jsx(fe,{onCancel:p,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Mt,{title:i?t("selectChainWallet",{chain:m}):t("selectWallet"),description:`${r||t("unknownDApp")} ${t("requestsAccess")}`,appName:r,appIcon:o,chainId:i}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto p-4",children:h.length===0?e.jsx("div",{className:"text-muted-foreground py-12 text-center text-sm",children:i?t("noWalletsForChain",{chain:i}):t("noWallets")}):e.jsx(gf,{wallets:h,currentWalletId:f?.id,onSelect:y,showAddButton:!1})}),e.jsx("div",{className:"border-border border-t p-4",children:e.jsx("button",{onClick:p,className:"bg-muted hover:bg-muted/80 w-full rounded-xl py-3 font-medium transition-colors",children:t("cancel")})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Gl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Zv,{})});Gl.__docgenInfo={description:"",methods:[],displayName:"WalletPickerJob"};const ey={"bfmeta-v2":"bfmetav2",bfmeta_v2:"bfmetav2"};function za(t){return t.trim().toLowerCase()}function Yi(t){return t.trim()}function Xi(t){return t.startsWith("0x")}function ty(t,s){return za(t)===za(s)}function sy(t,s){const n=Yi(t),a=Yi(s);return Xi(n)||Xi(a)?n.toLowerCase()===a.toLowerCase():n===a}function on(t){const s=za(t);if(s.length===0)return s;const n=Na.state,a=He.getChainById(n,s);return a?a.id:ey[s]??s}function Pr(t,s){const n=on(t);for(const a of Le.state.wallets){const r=a.chainAddresses.find(o=>ty(o.chain,n)&&sy(o.address,s));if(r)return{wallet:a,chainAddress:r}}return null}function Ql(t,s){return Pr(t,s)?.wallet.id??null}function ny(){const{t}=O("common"),{pop:s,push:n}=X(),{message:a,address:r,appName:o,appIcon:d,chainName:i}=pe(),[l,m]=c.useState(!1),u=c.useMemo(()=>on(i),[i]),f=c.useMemo(()=>Pr(u,r),[u,r]),h=f?.wallet,x=f?.chainAddress.chain,y=!!(h?.encryptedMnemonic&&x),p=h?.name||t("unknownWallet"),g=x??u,v=c.useCallback(()=>{l||!y||(Ns(async b=>{m(!0);try{if(!h||!h.encryptedMnemonic||!x)throw new Error(t("signingAddressNotFound"));const S=`miniapp_sign_${Date.now()}`,P=await new dc(qs,S).handleMessageSign({chainName:x,senderAddress:r,message:a},h.encryptedMnemonic,b),_=new CustomEvent("signing-confirm",{detail:{confirmed:!0,signature:P.signature,publicKey:P.publicKey}});return window.dispatchEvent(_),s(),!0}catch(S){throw S instanceof Error?S:new Error(t("walletLock.error"))}finally{m(!1)}}),n("WalletLockConfirmJob",{title:t("signMessage"),description:o||t("unknownDApp"),miniappName:o,miniappIcon:d,walletName:p,walletAddress:r,walletChainId:g}))},[l,y,r,a,s,n,x,t,h,o,d,p,g]),j=c.useCallback(()=>{const b=new CustomEvent("signing-confirm",{detail:{confirmed:!1}});window.dispatchEvent(b),s()},[s]),N=a.startsWith("0x")&&/^0x[0-9a-fA-F]+$/.test(a);return e.jsx(fe,{onCancel:j,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Mt,{title:t("signMessage"),description:o||t("unknownDApp"),appName:o,appIcon:d,walletInfo:{name:p,address:r,chainId:g}}),e.jsxs("div",{className:"space-y-4 p-4",children:[!y&&e.jsx("div",{className:"rounded-xl bg-amber-50 p-3 text-sm text-amber-800 dark:bg-amber-950/30 dark:text-amber-200",children:t("signingAddressNotFound")}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsxs("p",{className:"text-muted-foreground mb-1 text-xs",children:[" ",t("message")]}),e.jsx("div",{className:"max-h-40 overflow-y-auto",children:e.jsx("pre",{className:"font-mono text-sm break-all whitespace-pre-wrap",children:a})})]}),N&&e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[e.jsx(Oe,{className:"size-5 shrink-0 text-amber-600"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:t("hexDataWarning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:j,disabled:l,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("cancel")}),e.jsx("button",{onClick:v,disabled:l||!y,className:R("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","flex items-center justify-center gap-2 disabled:opacity-50"),children:l?e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"size-4 animate-spin"}),t("signing")]}):t("sign")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Yl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(ny,{})});Yl.__docgenInfo={description:"",methods:[],displayName:"SigningConfirmJob"};const ay={bio_requestAccounts:tr,bio_createTransaction:_o,bio_signMessage:ta,bio_signTypedData:ta,bio_signTransaction:ta,bio_sendTransaction:cp};function ry(){const{t}=O("permission"),{pop:s}=X(),{appName:n,appIcon:a,permissions:r}=pe(),o=(()=>{try{return JSON.parse(r)}catch{return[]}})(),d=()=>{const u=new CustomEvent("permission-request",{detail:{approved:!0,permissions:o}});window.dispatchEvent(u),s()},i=()=>{const u=new CustomEvent("permission-request",{detail:{approved:!1}});window.dispatchEvent(u),s()},l=u=>{const f=`${u}.label`;return String(t(f))},m=u=>{const f=`${u}.description`;return String(t(f))};return e.jsx(fe,{onCancel:i,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"border-border border-b px-4 pb-4",children:[e.jsx("div",{className:"bg-primary/10 mx-auto mb-3 flex size-14 items-center justify-center rounded-2xl",children:a?e.jsx("img",{src:a,alt:n,className:"size-10 rounded-xl"}):e.jsx(kf,{className:"text-primary size-8"})}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:n}),e.jsx("p",{className:"text-muted-foreground mt-1 text-center text-sm",children:String(t("requestsPermissions"))})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"space-y-3",children:o.map(u=>{const f=ay[u];return f?e.jsxs("div",{className:"bg-muted/50 flex items-center gap-3 rounded-xl p-3",children:[e.jsx("div",{className:"bg-primary/10 flex size-10 shrink-0 items-center justify-center rounded-full",children:e.jsx(f,{className:"text-primary size-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium",children:l(u)}),e.jsx("p",{className:"text-muted-foreground text-sm",children:m(u)})]})]},u):null})}),e.jsxs("div",{className:"text-muted-foreground mt-4 flex items-center gap-2 text-sm",children:[e.jsx(nr,{className:"size-4"}),e.jsx("span",{children:String(t("permissionNote"))})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:i,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("reject")}),e.jsx("button",{onClick:d,className:R("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90"),children:t("approve")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Xl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(ry,{})});Xl.__docgenInfo={description:"",methods:[],displayName:"PermissionRequestJob"};const Oa="MINIAPP_TRANSFER_UNSUPPORTED_PIPELINE";function iy(t){return/timeout|timed out|etimedout|aborterror|aborted/i.test(t)}function oy(t){return/failed to broadcast transaction|broadcast failed|tx_broadcast_failed/i.test(t)}function Zl(t){const s=[],n=new Set;let a=t;for(;a instanceof Error&&!n.has(a);)n.add(a),a.message&&s.push(a.message),a=a.cause;return s}function xa(t){return Zl(t).some(s=>iy(s))}function Zi(t){return Zl(t).some(s=>oy(s))}function cy(t){return new Ya(us.NOT_SUPPORTED,Oa,{scope:"miniapp-transfer",chainId:t})}function ly(t,s,n){if(s instanceof Ya){if(s.code===us.NOT_SUPPORTED&&s.message===Oa)return t("common:miniappTransferUnsupportedPipeline",{chainId:n});if(s.code===us.TRANSACTION_TIMEOUT)return t("transaction:broadcast.timeout");if(s.code===us.TX_BROADCAST_FAILED)return xa(s)?t("transaction:broadcast.timeout"):t("transaction:broadcast.failed");if(s.code===us.NETWORK_ERROR){if(xa(s))return t("transaction:broadcast.timeout");if(Zi(s))return t("transaction:broadcast.failed")}}if(s instanceof Error){if(s.message===Oa)return t("common:miniappTransferUnsupportedPipeline",{chainId:n});if(xa(s))return t("transaction:broadcast.timeout");if(Zi(s))return t("transaction:broadcast.failed")}return t("transaction:broadcast.unknown")}const dy=/^\d+$/;function uy(t,s,n){const a=t.trim();if(!dy.test(a))throw new Error("Invalid miniapp transfer amount");return re.fromRaw(a,s,n)}const eo=/pay password|pay secret|second secret|security password/i;function Ba(t){return t instanceof Js?t.code===xs.DECRYPTION_FAILED||t.code===xs.INVALID_PASSWORD:t instanceof Error?/wrong password|decrypt mnemonic|invalid walletlock|wallet lock/i.test(t.message):!1}function Fa(t){return t instanceof Ya&&t.code===us.SIGNATURE_FAILED&&eo.test(t.message)?!0:t instanceof Error?eo.test(t.message):!1}async function ed(t,s){const n=Pe(t);if(!n.bioGetAccountInfo)return!1;try{return!!(await n.bioGetAccountInfo(s)).secondPublicKey}catch{return!1}}const to=new Map;function my(t,s){const n=JSON.stringify({locale:t,options:s}),a=to.get(n);if(a)return a;const r=new Intl.NumberFormat(t,s);return to.set(n,r),r}function so(t,s,n){return t==null?"":my(s,n).format(t)}const td=c.createContext(void 0);function sd(){const t=c.useContext(td);if(t===void 0)throw new Error(Af(51));return t}let ga=(function(t){return t.complete="data-complete",t.indeterminate="data-indeterminate",t.progressing="data-progressing",t})({});const _r={status(t){return t==="progressing"?{[ga.progressing]:""}:t==="complete"?{[ga.complete]:""}:t==="indeterminate"?{[ga.indeterminate]:""}:null}};function fy(t,s,n){return t==null?"":n?so(t,s,n):so(t/100,s,{style:"percent"})}function py(t,s){return s==null?"indeterminate progress":t||`${s}%`}const hy=c.forwardRef(function(s,n){const{format:a,getAriaValueText:r=py,locale:o,max:d=100,min:i=0,value:l,render:m,className:u,...f}=s,[h,x]=c.useState(),y=Sf(a);let p="indeterminate";Number.isFinite(l)&&(p=l===d?"complete":"progressing");const g=fy(l,o,y.current),v=c.useMemo(()=>({status:p}),[p]),j={"aria-labelledby":h,"aria-valuemax":d,"aria-valuemin":i,"aria-valuenow":l??void 0,"aria-valuetext":r(g,l),role:"progressbar"},N=c.useMemo(()=>({formattedValue:g,max:d,min:i,setLabelId:x,state:v,status:p,value:l}),[g,d,i,x,v,p,l]),b=ar("div",s,{state:v,ref:n,props:[j,f],stateAttributesMapping:_r});return e.jsx(td.Provider,{value:N,children:b})}),xy=c.forwardRef(function(s,n){const{render:a,className:r,...o}=s,{state:d}=sd();return ar("div",s,{state:d,ref:n,props:o,stateAttributesMapping:_r})});function gy(t,s,n){return(t-s)*100/(n-s)}const vy=c.forwardRef(function(s,n){const{render:a,className:r,...o}=s,{max:d,min:i,value:l,state:m}=sd(),u=Number.isFinite(l)&&l!==null?gy(l,i,d):null,f=c.useCallback(()=>u==null?{}:{insetInlineStart:0,height:"inherit",width:`${u}%`},[u]);return ar("div",s,{state:m,ref:n,props:[{style:f()},o],stateAttributesMapping:_r})});function nd({className:t,children:s,value:n,...a}){return e.jsxs(hy,{value:n,"data-slot":"progress",className:R("flex flex-wrap gap-3",t),...a,children:[s,e.jsx(ad,{children:e.jsx(rd,{})})]})}function ad({className:t,...s}){return e.jsx(xy,{className:R("bg-muted h-1 rounded-full relative flex w-full items-center overflow-x-hidden",t),"data-slot":"progress-track",...s})}function rd({className:t,...s}){return e.jsx(vy,{"data-slot":"progress-indicator",className:R("bg-primary h-full transition-all",t),...s})}nd.__docgenInfo={description:"",methods:[],displayName:"Progress"};ad.__docgenInfo={description:"",methods:[],displayName:"ProgressTrack"};rd.__docgenInfo={description:"",methods:[],displayName:"ProgressIndicator"};function Er({currentStep:t,totalSteps:s,percent:n,className:a}){const{t:r}=O("common");return e.jsxs("div",{className:a,"data-testid":"miniapp-step-progress",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:r("stepProgress")}),e.jsx("span",{className:"text-muted-foreground text-xs tabular-nums",children:r("stepFraction",{current:t,total:s})})]}),e.jsx(nd,{value:n,className:"w-full","aria-label":r("stepProgressAriaLabel")})]})}Er.__docgenInfo={description:"",methods:[],displayName:"MiniappStepProgress",props:{currentStep:{required:!0,tsType:{name:"number"},description:""},totalSteps:{required:!0,tsType:{name:"number"},description:""},percent:{required:!0,tsType:{name:"number"},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const yy=["review","wallet_lock","broadcasting"],by=["review","wallet_lock","two_step_secret","broadcasting"],jy=["review","wallet_lock","signing"],Ny=["review","wallet_lock","two_step_secret","signing"];function no(t,s){const n=Math.max(1,t),a=Math.min(Math.max(s,1),n);return{currentStep:a,totalSteps:n,percent:Math.round(a/n*100)}}function wy(t){return t?by:yy}function Cy(t){return t?Ny:jy}function id(t,s){const n=t.indexOf(s);return n<0?no(t.length,1):no(t.length,n+1)}function Wn(t){return typeof t=="object"&&t!==null}function ao(t){if(typeof structuredClone=="function")try{const s=structuredClone(t);if(Wn(s))return s}catch{}try{const s=JSON.parse(JSON.stringify(t));if(Wn(s))return s}catch{}return{...t}}const ky=3,xn=new Map;function Sy(){const{t}=O(["common","transaction"]),{pop:s}=X(),n=st(),a=pe(),{requestId:r,appName:o,appIcon:d,from:i,to:l,amount:m,chain:u,asset:f}=a,x=c.useRef(r??`legacy-transfer-${Date.now()}-${Math.random().toString(36).slice(2,8)}`).current,[y,p]=c.useState("review"),[g,v]=c.useState([]),[j,N]=c.useState(""),[b,S]=c.useState(!1),[k,P]=c.useState(!1),[_,A]=c.useState(null),[T,C]=c.useState("idle"),[I,w]=c.useState(null),[E,D]=c.useState(!1),[z,L]=c.useState(!0),q=c.useRef(!0),M=c.useRef(!1),F=c.useRef(!1),G=c.useRef(!1),Z=c.useRef(!1),B=c.useMemo(()=>on(u),[u]),$=c.useMemo(()=>Ql(B,i),[B,i]),se=Le.state.wallets.find(ne=>ne.id===$)?.name||t("unknownWallet"),U=`${o||t("unknownDApp")} ${t("requestsTransfer")}`,H=c.useMemo(()=>wy(E),[E]),Q=c.useMemo(()=>id(H,y),[H,y]),te=c.useMemo(()=>f||lt.getSymbol(B)||B.toUpperCase(),[f,B]),W=c.useMemo(()=>lt.getDecimals(B),[B]),ee=c.useMemo(()=>{try{return uy(m,W,te)}catch{return null}},[m,W,te]),le=c.useMemo(()=>ee?.toFormatted({trimTrailingZeros:!1})??m,[ee,m]),be=c.useMemo(()=>ee?null:t("transaction:broadcast.invalidParams"),[ee,t]),he=c.useMemo(()=>t("transaction:miniappTransfer.shortTitle",{amount:le,asset:te}),[t,le,te]),_e=T==="building",Dt=T==="broadcasting",ft=T==="success",Ne=T==="building"||T==="broadcasting",de=c.useCallback((ne,ae={})=>{console.log("[miniapp-transfer-sheet]",ne,{requestId:x,appName:o,chain:B,...ae})},[o,x,B]),cn=c.useCallback(()=>{v([]),S(!1),N(""),P(!1),A(null)},[]);c.useEffect(()=>{if(q.current=!0,typeof window<"u"){const ne=xn.get(x);ne!==void 0&&(window.clearTimeout(ne),xn.delete(x),de("sheet.unmount-settle.cancelled"))}return de("sheet.mount",{from:i,to:l,amount:m,asset:f??"native"}),r||de("sheet.request-id.fallback",{fallbackRequestId:x}),()=>{if(q.current=!1,de("sheet.unmount"),typeof window>"u"||!r)return;const ne=window.setTimeout(()=>{if(xn.delete(x),!F.current){F.current=!0;const ae={requestId:x,confirmed:!1};de("sheet.emit.on-unmount",{confirmed:!1,hasTxHash:!1,hasTransaction:!1}),window.dispatchEvent(new CustomEvent("miniapp-transfer-confirm",{detail:ae}))}if(!G.current){G.current=!0;const ae={requestId:x,reason:"cancel"};de("sheet.closed.on-unmount",ae),window.dispatchEvent(new CustomEvent("miniapp-transfer-sheet-closed",{detail:ae}))}},0);xn.set(x,ne)}},[m,f,x,i,de,r,l]),c.useEffect(()=>{let ne=!0;return L(!0),ed(B,i).then(ae=>{ne&&D(ae)}).finally(()=>{ne&&L(!1)}),()=>{ne=!1}},[B,i]);const as=c.useCallback(ne=>{if(F.current||(F.current=!0,typeof window>"u"))return;const ae={requestId:x,...ne};de("sheet.emit",{confirmed:ae.confirmed,hasTxHash:!!ae.txHash,hasTransaction:!!ae.transaction,txId:ae.txId}),window.dispatchEvent(new CustomEvent("miniapp-transfer-confirm",{detail:ae}))},[x,de]),pt=c.useCallback(ne=>{if(G.current||(G.current=!0,typeof window>"u"))return;const ae={requestId:x,reason:ne};de("sheet.closed",ae),window.dispatchEvent(new CustomEvent("miniapp-transfer-sheet-closed",{detail:ae}))},[x,de]);c.useEffect(()=>{if(!ft||I===null)return;if(I<=0){de("sheet.success.auto-close"),pt("confirmed"),s();return}const ne=window.setTimeout(()=>{w(ae=>ae===null?null:ae-1)},1e3);return()=>{window.clearTimeout(ne)}},[pt,ft,de,s,I]);const Yn=c.useCallback(()=>{!Dt||M.current||(M.current=!0,de("sheet.background-broadcast"),pt("background"),n.show(t("transaction:miniappTransfer.toast.background",{title:he})),s())},[pt,Dt,de,s,t,n,he]),Bu=c.useCallback(()=>{Ne||!$||(cn(),p("wallet_lock"))},[Ne,$,cn]),Rr=c.useCallback(()=>{Ne||(cn(),p("review"))},[Ne,cn]),Fu=c.useCallback(ne=>{(b||_||k)&&(S(!1),P(!1),A(null)),v(ne)},[b,_,k]),Wu=c.useCallback(ne=>{(k||_)&&(P(!1),A(null)),N(ne)},[k,_]),Lr=c.useCallback(async(ne,ae)=>{if(!$)throw new Error("missing walletId");const Ee=Pe(B);if(!Ee.supportsFullTransaction||!Ee.buildTransaction||!Ee.signTransaction||!Ee.broadcastTransaction)throw cy(B);if(!ee)throw new Error("Invalid miniapp transfer amount");const dn=await Ee.buildTransaction({type:"transfer",from:i,to:l,amount:ee,...f?{bioAssetType:f}:{}}),Ie=await Lo({walletId:$,password:ne,from:i,chainId:B,unsignedTx:dn,...ae?{paySecret:ae}:{}}),ht=Wn(Ie.data)?{...Ie,data:ao(Ie.data)}:Ie;q.current&&(p("broadcasting"),C("broadcasting"));const Hu=await Ee.broadcastTransaction(ht),Uu=Wn(ht.data)?ao(ht.data):{data:ht.data};return{txHash:Hu,transaction:Uu}},[B,ee,f,i,l,$]),Dr=c.useCallback((ne,ae)=>{const Ee=ly(t,ne,B);if(M.current){q.current&&(p(ae),C("idle")),as({confirmed:!1}),n.show(t("transaction:miniappTransfer.toast.failed",{title:he,reason:Ee}));return}if(!q.current){de("transfer.failed.after-unmount",{inputStep:ae,message:Ee});return}if(C("idle"),Ba(ne)){S(!0),P(!1),A(t("walletLock.error")),p("wallet_lock"),v([]);return}if(Fa(ne)){S(!1),P(!0),A(t("transaction:sendPage.twoStepSecretError")),p("two_step_secret");return}S(!1),P(!1),A(Ee),p(ae),ae==="wallet_lock"&&v([])},[as,de,B,t,n,he]),ln=c.useCallback(async(ne,ae,Ee)=>{if(Z.current){de("transfer.skip.in-flight",{inputStep:ae});return}let dn=!1;Z.current=!0,de("transfer.start",{inputStep:ae,hasPaySecret:!!Ee}),C("building"),S(!1),P(!1),A(null);try{const{txHash:Ie,transaction:ht}=await Lr(ne,Ee);dn=!0,de("transfer.broadcast.success",{txHash:Ie}),(M.current||!q.current)&&n.show(t("transaction:miniappTransfer.toast.success",{title:he})),as({confirmed:!0,txHash:Ie,txId:Ie,transaction:ht}),!M.current&&q.current&&(p("broadcasting"),C("success"),w(ky))}catch(Ie){const ht=Ie instanceof Error?Ie.message:String(Ie);de("transfer.failed",{inputStep:ae,message:ht}),console.error(ae==="two_step_secret"?"[miniapp-transfer][two-step-secret]":"[miniapp-transfer]",Ie),Dr(Ie,ae)}finally{de("transfer.finally",{inputStep:ae,backgrounded:M.current}),Z.current=!1,q.current&&!M.current&&!dn&&C("idle")}},[as,Dr,de,Lr,t,n,he]),$u=c.useCallback(async ne=>{if(ne.length<4||Ne||Z.current||!$)return;const ae=Be(ne);await ln(ae,"wallet_lock")},[Ne,$,ln]),zr=c.useCallback(async()=>{if(!$||!g.length||!j.trim()||Ne||Z.current)return;const ne=Be(g);await ln(ne,"two_step_secret",j.trim())},[$,g,j,Ne,ln]),qu=c.useCallback(()=>{zr()},[zr]),Xn=c.useCallback(()=>{de("sheet.success.manual-close",{countdown:I}),pt("confirmed"),s()},[pt,de,s,I]),Zn=c.useCallback(()=>{if(ft){Xn();return}if(Dt){de("sheet.cancel.broadcasting"),Yn();return}if(_e){de("sheet.cancel.blocked-building");return}de("sheet.cancel.idle"),as({confirmed:!1}),pt("cancel"),s()},[pt,as,Xn,Dt,_e,ft,de,Yn,s]);return e.jsx(fe,{onCancel:Zn,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Mt,{title:t("confirmTransfer"),description:_e?t("buildingTransaction"):y==="review"?U:t(y==="wallet_lock"?"drawPatternToConfirm":y==="two_step_secret"?"transaction:sendPage.twoStepSecretDescription":ft?"transaction:txStatus.broadcastedDesc":"transaction:txStatus.broadcasting"),appName:o,appIcon:d,walletInfo:{name:se,address:i,chainId:B}}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(Er,{currentStep:Q.currentStep,totalSteps:Q.totalSteps,percent:Q.percent})}),y==="review"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx("div",{className:"bg-muted/50 rounded-xl p-4 text-center",children:e.jsx(jt,{value:le,symbol:te,size:"xl",weight:"bold",decimals:W,fixedDecimals:!0})}),e.jsxs("div",{className:"bg-muted/50 space-y-3 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-10 shrink-0 text-xs",children:[" ",t("from")]}),e.jsx(it,{address:i,copyable:!0,className:"flex-1 text-sm"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(zs,{className:"text-muted-foreground size-4"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-10 shrink-0 text-xs",children:[" ",t("to")]}),e.jsx(it,{address:l,copyable:!0,className:"flex-1 text-sm"})]})]}),!$&&e.jsx("div",{className:"rounded-xl bg-amber-50 p-3 text-sm text-amber-800 dark:bg-amber-950/30 dark:text-amber-200",children:t("signingAddressNotFound")}),be&&e.jsx("div",{className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:be}),e.jsxs("div",{className:"bg-muted/50 flex items-center justify-between rounded-xl p-3",children:[e.jsxs("span",{className:"text-muted-foreground text-sm",children:[" ",t("network")]}),e.jsx(kn,{chainId:B})]}),e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[e.jsx(Oe,{className:"mt-0.5 size-5 shrink-0 text-amber-600"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:t("transferWarning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:Zn,disabled:Ne,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("cancel")}),e.jsx("button",{"data-testid":"miniapp-transfer-review-confirm",onClick:Bu,disabled:Ne||!$||z||!ee,className:R("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","flex items-center justify-center gap-2 disabled:opacity-50"),children:t("confirm")})]})]}):y==="wallet_lock"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 p-4",children:[!$&&e.jsx("div",{className:"rounded-xl bg-amber-50 p-3 text-sm text-amber-800 dark:bg-amber-950/30 dark:text-amber-200",children:t("signingAddressNotFound")}),e.jsx(mt,{value:g,onChange:Fu,onComplete:$u,minPoints:4,disabled:Ne||!$,error:b,errorText:b?t("walletLock.error"):void 0}),_&&!b&&e.jsx("div",{"data-testid":"miniapp-transfer-error",className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:_}),_e&&e.jsxs("div",{"data-testid":"miniapp-transfer-building-status",className:"bg-muted text-muted-foreground flex items-center justify-center gap-2 rounded-xl p-3 text-sm",children:[e.jsx(ve,{className:"size-4 animate-spin"}),t("buildingTransaction")]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:Rr,disabled:Ne,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("back")}),e.jsx("button",{onClick:Zn,disabled:Ne,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("cancel")})]})]}):y==="two_step_secret"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx(gs,{value:j,onChange:ne=>Wu(ne.target.value),placeholder:t("transaction:sendPage.twoStepSecretPlaceholder"),disabled:Ne,"aria-describedby":_?"miniapp-two-step-secret-error":void 0,"data-testid":"miniapp-two-step-secret-input"}),_&&e.jsx("div",{id:"miniapp-two-step-secret-error","data-testid":"miniapp-transfer-error",className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:_}),_e&&e.jsxs("div",{"data-testid":"miniapp-transfer-building-status",className:"bg-muted text-muted-foreground flex items-center justify-center gap-2 rounded-xl p-3 text-sm",children:[e.jsx(ve,{className:"size-4 animate-spin"}),t("buildingTransaction")]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:Rr,disabled:Ne,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("back")}),e.jsx("button",{onClick:qu,disabled:Ne||j.trim().length===0,className:R("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","disabled:opacity-50"),children:t("confirm")})]})]}):e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx("div",{className:"bg-muted/50 rounded-xl p-4 text-center",children:e.jsx(jt,{value:le,symbol:te,size:"xl",weight:"bold",decimals:W,fixedDecimals:!0})}),e.jsxs("div",{className:"bg-muted/50 space-y-3 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-10 shrink-0 text-xs",children:[" ",t("from")]}),e.jsx(it,{address:i,copyable:!0,className:"flex-1 text-sm"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(zs,{className:"text-muted-foreground size-4"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-10 shrink-0 text-xs",children:[" ",t("to")]}),e.jsx(it,{address:l,copyable:!0,className:"flex-1 text-sm"})]})]}),e.jsxs("div",{className:"bg-muted/50 flex items-center justify-between rounded-xl p-3",children:[e.jsxs("span",{className:"text-muted-foreground text-sm",children:[" ",t("network")]}),e.jsx(kn,{chainId:B})]}),ft?e.jsxs(e.Fragment,{children:[e.jsx("div",{"data-testid":"miniapp-transfer-broadcast-success-status",className:"bg-muted text-muted-foreground flex items-center justify-center gap-2 rounded-xl p-3 text-sm",children:t("transaction:txStatus.broadcasted")}),e.jsx("button",{type:"button","data-testid":"miniapp-transfer-success-close",onClick:Xn,className:R("w-full rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90"),children:t("transaction:txStatus.closeIn",{seconds:I??0})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{"data-testid":"miniapp-transfer-broadcasting-status",className:"bg-muted text-muted-foreground flex items-center justify-center gap-2 rounded-xl p-3 text-sm",children:[e.jsx(ve,{className:"size-4 animate-spin"}),t("transaction:txStatus.broadcasting")]}),e.jsx("button",{type:"button","data-testid":"miniapp-transfer-background-broadcast",onClick:Yn,disabled:!Dt,className:R("w-full rounded-xl py-3 font-medium transition-colors","bg-muted hover:bg-muted/80 text-foreground","disabled:opacity-50"),children:t("transaction:miniappTransfer.backgroundBroadcast")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const od=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Sy,{})});od.__docgenInfo={description:"",methods:[],displayName:"MiniappTransferConfirmJob"};const Ss=Ce.t.bind(Ce);async function cd(t,s,n){const a=Pe(t.id);return a.bioGetAssetDetail?(await a.bioGetAssetDetail(s,n))?.applyAddress??null:null}async function ld(t,s,n){const a=Pe(t.id);if(!a.buildTransaction||!a.estimateFee)return{amount:re.fromRaw("1000",t.decimals,t.symbol),symbol:t.symbol};try{const r=await a.buildTransaction({type:"destroy",from:"0x0000000000000000000000000000000000000000",recipientId:"0x0000000000000000000000000000000000000000",bioAssetType:s,amount:re.fromRaw(n,t.decimals,t.symbol)});return{amount:(await a.estimateFee(r)).standard.amount,symbol:t.symbol}}catch{return{amount:re.fromRaw("1000",t.decimals,t.symbol),symbol:t.symbol}}}async function $n({chainConfig:t,walletId:s,password:n,fromAddress:a,recipientAddress:r,assetType:o,amount:d,fee:i,twoStepSecret:l}){let m;try{m=await hs.getMnemonic(s,n)}catch(f){return f instanceof Js&&f.code===xs.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:f instanceof Error?f.message:Ss("error:unknown")}}if(!d.isPositive())return{status:"error",message:Ss("error:validation.enterValidAmount")};const u=Pe(t.id);if(!u.supportsFullTransaction)return{status:"error",message:Ss("error:transaction.chainNotSupported")};try{let f=null;if(u.bioGetAccountInfo){if(f=(await u.bioGetAccountInfo(a)).secondPublicKey,f&&!l)return{status:"password_required",secondPublicKey:f};if(l&&f&&u.bioVerifyPayPassword&&!await u.bioVerifyPayPassword({mainSecret:m,paySecret:l,publicKey:f}))return{status:"error",message:Ss("error:transaction.securityPasswordFailed")}}const h=await u.buildTransaction({type:"destroy",from:a,recipientId:r,amount:d,bioAssetType:o}),x=await u.signTransaction(h,{privateKey:new TextEncoder().encode(m),bioSecret:m,bioPaySecret:l}),y=await Nt.create({walletId:Io(t.id,a),chainId:t.id,fromAddress:a,rawTx:x,meta:{type:"destroy",displayAmount:d.toFormatted(),displaySymbol:o,displayToAddress:r}});await Nt.updateStatus({id:y.id,status:"broadcasting"});try{const p=await u.broadcastTransaction(x);return await Nt.updateStatus({id:y.id,status:"broadcasted",txHash:p}),{status:"ok",txHash:p,pendingTxId:y.id}}catch(p){const g=p;return await Nt.updateStatus({id:y.id,status:"failed",errorCode:"BROADCAST_FAILED",errorMessage:g.message}),{status:"error",message:g.message,pendingTxId:y.id}}}catch(f){return{status:"error",message:(f instanceof Error?f.message:String(f))||Ss("error:transaction.burnFailed")}}}const Ay=Object.freeze(Object.defineProperty({__proto__:null,fetchAssetApplyAddress:cd,fetchBioforestBurnFee:ld,submitBioforestBurn:$n},Symbol.toStringTag,{value:"Module"}));function Iy(){const{t}=O(["common","transaction"]),{pop:s,push:n}=X(),a=pe(),{appName:r,appIcon:o,from:d,amount:i,chain:l,asset:m}=a,u=dt(),f=c.useMemo(()=>on(l),[l]),x=c.useMemo(()=>Pr(f,d),[f,d])?.wallet,y=u.snapshot?He.getChainById(u,f):null,[p,g]=c.useState(!1),v=x?.name||t("common:unknownWallet"),j=`${r||t("common:unknownDApp")} ${t("common:requestsDestroy")}`,N=c.useMemo(()=>{if(!y)return null;try{return re.fromRaw(i,y.decimals,m)}catch{return null}},[i,m,y]),b=c.useMemo(()=>N?.toFormatted({trimTrailingZeros:!1})??i,[i,N]),S=y?.decimals??8,k=c.useMemo(()=>y?N?null:t("transaction:broadcast.invalidParams"):null,[y,N,t]),P=c.useCallback(()=>{p||(Ns(async A=>{g(!0);try{if(!x?.id||!y)throw new Error(t("common:signingAddressNotFound"));const{fetchAssetApplyAddress:T}=await Tt(async()=>{const{fetchAssetApplyAddress:D}=await Promise.resolve().then(()=>Ay);return{fetchAssetApplyAddress:D}},void 0,import.meta.url),C=await T(y,m,d);if(!C)return!1;if(!N)throw new Error("Invalid miniapp destroy amount");const I=N,w=await $n({chainConfig:y,walletId:x.id,password:A,fromAddress:d,recipientAddress:C,assetType:m,amount:I});if(w.status==="password"||w.status==="error")return!1;const E=new CustomEvent("miniapp-destroy-confirm",{detail:{confirmed:!0,txHash:w.status==="ok"?w.txHash:void 0}});return window.dispatchEvent(E),s(),!0}catch{return!1}finally{g(!1)}}),n("WalletLockConfirmJob",{title:t("transaction:destroyPage.title"),description:j,miniappName:r,miniappIcon:o,walletName:v,walletAddress:d,walletChainId:f}))},[p,x,y,m,d,i,N,s,n,t,j,r,o,v,f]),_=c.useCallback(()=>{const A=new CustomEvent("miniapp-destroy-confirm",{detail:{confirmed:!1}});window.dispatchEvent(A),s()},[s]);return e.jsx(fe,{onCancel:_,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Mt,{title:t("transaction:destroyPage.title"),description:j,appName:r,appIcon:o,walletInfo:{name:v,address:d,chainId:f}}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx("div",{className:"bg-destructive/5 rounded-xl p-4 text-center",children:e.jsx(jt,{value:b,symbol:m,size:"xl",weight:"bold",decimals:S,fixedDecimals:!0})}),e.jsx("div",{className:"bg-muted/50 space-y-3 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-10 shrink-0 text-xs",children:[" ",t("common:from")]}),e.jsx(Ga,{chainId:f,address:d,copyable:!0,size:"sm"})]})}),k&&e.jsx("div",{className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:k}),e.jsxs("div",{className:"bg-muted/50 flex items-center justify-between rounded-xl p-3",children:[e.jsxs("span",{className:"text-muted-foreground text-sm",children:[" ",t("common:network")]}),e.jsx(kn,{chainId:f})]}),e.jsxs("div",{className:"bg-destructive/10 flex items-start gap-2 rounded-xl p-3",children:[e.jsx(Oe,{className:"text-destructive mt-0.5 size-5 shrink-0"}),e.jsx("p",{className:"text-destructive text-sm",children:t("transaction:destroyPage.warning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:_,disabled:p,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("common:cancel")}),e.jsx("button",{onClick:P,disabled:p||!x?.id||!y||!N,className:R("flex-1 rounded-xl py-3 font-medium transition-colors","bg-destructive text-destructive-foreground hover:bg-destructive/90","flex items-center justify-center gap-2 disabled:opacity-50"),children:p?e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"size-4 animate-spin"}),t("common:confirming")]}):e.jsxs(e.Fragment,{children:[e.jsx(Cn,{className:"size-4"}),t("transaction:destroyPage.confirm")]})})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const dd=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Iy,{})});dd.__docgenInfo={description:"",methods:[],displayName:"MiniappDestroyConfirmJob"};function Ty(){const{t}=O("common"),{pop:s}=X(),n=pe(),{appName:a,appIcon:r,from:o,chain:d,unsignedTx:i}=n,[l,m]=c.useState("review"),[u,f]=c.useState([]),[h,x]=c.useState(""),[y,p]=c.useState(!1),[g,v]=c.useState(!1),[j,N]=c.useState(null),[b,S]=c.useState(!1),[k,P]=c.useState(!1),[_,A]=c.useState(!0),T=c.useMemo(()=>{try{return Kt.parse(i)}catch{return null}},[i]),C=c.useMemo(()=>on(d),[d]),I=c.useMemo(()=>Ql(C,o),[C,o]),E=Le.state.wallets.find(H=>H.id===I)?.name||t("unknownWallet"),D=c.useMemo(()=>Cy(k),[k]),z=c.useMemo(()=>id(D,l),[D,l]),L=c.useCallback(()=>{f([]),p(!1),x(""),v(!1),N(null)},[]);c.useEffect(()=>{let H=!0;return A(!0),ed(C,o).then(Q=>{H&&P(Q)}).finally(()=>{H&&A(!1)}),()=>{H=!1}},[C,o]);const q=c.useCallback(()=>{b||!T||!I||(L(),m("wallet_lock"))},[b,T,I,L]),M=c.useCallback(()=>{b||(L(),m("review"))},[b,L]),F=c.useCallback(H=>{(y||j||g)&&(p(!1),v(!1),N(null)),f(H)},[y,j,g]),G=c.useCallback(H=>{(g||j)&&(v(!1),N(null)),x(H)},[g,j]),Z=c.useCallback(async(H,Q)=>{if(!I||!T)return;const te=await Lo({walletId:I,password:H,from:o,chainId:C,unsignedTx:T,...Q?{paySecret:Q}:{}}),W=new CustomEvent("miniapp-sign-transaction-confirm",{detail:{confirmed:!0,signedTx:te}});window.dispatchEvent(W),s()},[I,T,o,C,s]),B=c.useCallback(async H=>{if(H.length<4||b||!T||!I)return;const Q=Be(H);S(!0),p(!1),v(!1),N(null);try{m("signing"),await Z(Q)}catch(te){console.error("[miniapp-sign-transaction]",te),Ba(te)?(p(!0),N(t("walletLock.error"))):Fa(te)?(p(!1),v(!0),N(t("transaction:sendPage.twoStepSecretError")),m("two_step_secret")):(p(!1),v(!1),N(t("signingFailed"))),f([])}finally{S(!1)}},[b,T,I,Z,t]),$=c.useCallback(async()=>{if(!I||!T||!u.length||!h.trim()||b)return;const H=Be(u);S(!0),v(!1),N(null);try{m("signing"),await Z(H,h.trim())}catch(Q){console.error("[miniapp-sign-transaction][two-step-secret]",Q),Fa(Q)?(v(!0),N(t("transaction:sendPage.twoStepSecretError")),m("two_step_secret")):Ba(Q)?(p(!0),N(t("walletLock.error")),m("wallet_lock")):(v(!1),N(t("signingFailed")),m("two_step_secret"))}finally{S(!1)}},[I,T,u,h,b,Z,t]),ye=c.useCallback(()=>{$()},[$]),se=c.useCallback(()=>{const H=new CustomEvent("miniapp-sign-transaction-confirm",{detail:{confirmed:!1}});window.dispatchEvent(H),s()},[s]),U=c.useMemo(()=>{if(!T)return"";try{return JSON.stringify(T.data,null,2)}catch{return String(T.data)}},[T]);return e.jsx(fe,{onCancel:se,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Mt,{title:t("signTransaction"),description:l==="review"?a||t("unknownDApp"):t(l==="wallet_lock"?"drawPatternToConfirm":l==="two_step_secret"?"transaction:sendPage.twoStepSecretDescription":"signing"),appName:a,appIcon:r,walletInfo:{name:E,address:o,chainId:C}}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(Er,{currentStep:z.currentStep,totalSteps:z.totalSteps,percent:z.percent})}),l==="review"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 p-4",children:[!T&&e.jsx("div",{className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:t("invalidTransaction")}),T&&!I&&e.jsx("div",{className:"rounded-xl bg-amber-50 p-3 text-sm text-amber-800 dark:bg-amber-950/30 dark:text-amber-200",children:t("signingAddressNotFound")}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("network")}),e.jsx(kn,{chainId:C})]}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("signingAddress")}),e.jsx(Ga,{chainId:C,address:o,copyable:!1,size:"sm"})]}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("transaction")}),e.jsx("div",{className:"max-h-44 overflow-y-auto",children:e.jsx("pre",{className:"font-mono text-xs break-all whitespace-pre-wrap",children:U})})]}),e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[e.jsx(Oe,{className:"mt-0.5 size-5 shrink-0 text-amber-600"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:t("signTxWarning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:se,disabled:b,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("cancel")}),e.jsx("button",{onClick:q,disabled:b||!T||!I||_,className:R("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","flex items-center justify-center gap-2 disabled:opacity-50"),children:t("sign")})]})]}):l==="wallet_lock"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 p-4",children:[!I&&e.jsx("div",{className:"rounded-xl bg-amber-50 p-3 text-sm text-amber-800 dark:bg-amber-950/30 dark:text-amber-200",children:t("signingAddressNotFound")}),e.jsx(mt,{value:u,onChange:F,onComplete:B,minPoints:4,disabled:b||!I,error:y,errorText:y?t("walletLock.error"):void 0}),j&&!y&&e.jsx("div",{className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:j}),b&&e.jsxs("div",{className:"bg-muted text-muted-foreground flex items-center justify-center gap-2 rounded-xl p-3 text-sm",children:[e.jsx(ve,{className:"size-4 animate-spin"}),t("signing")]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:M,disabled:b,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("back")}),e.jsx("button",{onClick:se,disabled:b,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("cancel")})]})]}):l==="two_step_secret"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx(gs,{value:h,onChange:H=>G(H.target.value),placeholder:t("transaction:sendPage.twoStepSecretPlaceholder"),disabled:b,"aria-describedby":j?"miniapp-sign-two-step-secret-error":void 0,"data-testid":"miniapp-sign-two-step-secret-input"}),j&&e.jsx("div",{id:"miniapp-sign-two-step-secret-error",className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:j}),b&&e.jsxs("div",{className:"bg-muted text-muted-foreground flex items-center justify-center gap-2 rounded-xl p-3 text-sm",children:[e.jsx(ve,{className:"size-4 animate-spin"}),t("signing")]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:M,disabled:b,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("back")}),e.jsx("button",{onClick:ye,disabled:b||h.trim().length===0,className:R("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","disabled:opacity-50"),children:t("confirm")})]})]}):e.jsx("div",{className:"space-y-4 p-4",children:e.jsxs("div",{className:"bg-muted text-muted-foreground flex items-center justify-center gap-2 rounded-xl p-3 text-sm",children:[e.jsx(ve,{className:"size-4 animate-spin"}),t("signing")]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const ud=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Ty,{})});ud.__docgenInfo={description:"",methods:[],displayName:"MiniappSignTransactionJob"};function ro(t){const s=Vn(t);if(s)return lt.getName(s);try{return`Chain ${Nf(t)}`}catch{return t}}function io(t){return Vn(t)}function Py(){const{t}=O("common"),{pop:s}=X(),{fromChainId:n,toChainId:a,appName:r,appIcon:o}=pe(),d=ro(n),i=ro(a),l=io(n),m=io(a),u=()=>{const h=new CustomEvent("chain-switch-confirm",{detail:{approved:!0,toChainId:a}});window.dispatchEvent(h),s()},f=()=>{const h=new CustomEvent("chain-switch-confirm",{detail:{approved:!1}});window.dispatchEvent(h),s()};return e.jsx(fe,{onCancel:f,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Mt,{title:t("switchNetwork"),description:`${r||t("unknownDApp")} ${t("requestsNetworkSwitch")}`,appName:r,appIcon:o}),e.jsxs("div",{className:"flex items-center justify-center gap-4 px-6 py-8",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[l?e.jsx(Pt,{chain:l,size:"lg"}):e.jsx("div",{className:"bg-muted flex size-12 items-center justify-center rounded-full",children:e.jsx(Oe,{className:"text-muted-foreground size-6"})}),e.jsx("span",{className:"text-muted-foreground text-sm",children:d})]}),e.jsx(tc,{className:"text-primary size-8"}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[m?e.jsx(Pt,{chain:m,size:"lg"}):e.jsx("div",{className:"bg-muted flex size-12 items-center justify-center rounded-full",children:e.jsx(Oe,{className:"text-muted-foreground size-6"})}),e.jsx("span",{className:"font-medium",children:i})]})]}),e.jsx("div",{className:"bg-warning/10 border-warning/20 mx-4 mb-4 rounded-lg border p-3",children:e.jsx("p",{className:"text-warning text-sm",children:t("chainSwitchWarning")})}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:f,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("cancel")}),e.jsx("button",{onClick:u,className:"bg-primary hover:bg-primary/90 text-primary-foreground flex-1 rounded-xl py-3 font-medium transition-colors",children:t("confirm")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const md=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Py,{})});md.__docgenInfo={description:"",methods:[],displayName:"ChainSwitchConfirmJob"};function _y(){const{t}=O("common"),{pop:s}=X(),n=pe(),a=Kt.parse(n.actions),r=n.duration,{address:o,chainId:d,appName:i,appIcon:l}=n,m=Le.state.wallets.find(k=>k.chainAddresses.some(P=>P.address===o)),u=m?.name,f=m?.id,[h,x]=c.useState([]),[y,p]=c.useState(!1),[g,v]=c.useState(!1),[j,N]=c.useState(r),b=c.useCallback(async k=>{v(!0),p(!1);try{const P=Be(k),_=await hs.getAllWallets();if(_.length===0){p(!0),x([]),v(!1);return}let A=!1;for(const T of _)try{await hs.getMnemonic(T.id,P),A=!0;break}catch{}if(A&&f){const T=new CustomEvent("crypto-authorize-confirm",{detail:{approved:!0,patternKey:P,walletId:f,selectedDuration:j}});window.dispatchEvent(T),s()}else p(!0),x([])}catch{p(!0),x([])}finally{v(!1)}},[s,j]),S=c.useCallback(()=>{const k=new CustomEvent("crypto-authorize-confirm",{detail:{approved:!1}});window.dispatchEvent(k),s()},[s]);return e.jsx(fe,{onCancel:S,children:e.jsxs("div",{className:"bg-background flex max-h-[85vh] flex-col rounded-t-2xl",children:[e.jsx("div",{className:"flex flex-shrink-0 justify-center py-2",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Mt,{title:t("cryptoAuthorize"),description:i||t("unknownDApp"),appName:i,appIcon:l,walletInfo:{name:u||t("unknownWallet"),address:o,chainId:d||"bfmeta"}}),e.jsx("div",{className:"min-h-0 flex-1 space-y-3 overflow-y-auto px-4 py-3",children:e.jsxs("div",{className:"bg-muted/50 space-y-2 rounded-xl p-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xs,{className:"text-primary size-4 flex-shrink-0"}),e.jsxs("span",{className:"text-muted-foreground",children:[t("permissions"),""]}),e.jsx("span",{className:"truncate font-medium",children:a.map(k=>Fm[k]?.name||k).join("")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-muted-foreground ml-6",children:[t("duration"),""]}),e.jsxs(Os,{value:j,onValueChange:k=>N(k),children:[e.jsx(Bs,{className:"h-7 w-24 text-xs",children:e.jsx(Fs,{})}),e.jsx(Ws,{children:Wm.map(k=>e.jsx(Gt,{value:k,children:$m[k]},k))})]})]})]})}),e.jsxs("div",{className:"flex-shrink-0 px-4 pb-2",children:[e.jsx("p",{className:"text-muted-foreground mb-2 text-center text-xs",children:t("drawPatternToConfirm")}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-[280px]",children:e.jsx(mt,{value:h,onChange:x,onComplete:b,error:y,disabled:g})})}),e.jsx("div",{className:"flex h-6 items-center justify-center",children:g&&e.jsxs("div",{className:"text-muted-foreground flex items-center gap-2",children:[e.jsx(ve,{className:"size-4 animate-spin"}),e.jsx("span",{className:"text-xs",children:t("verifying")})]})})]}),e.jsx("div",{className:"flex-shrink-0 px-4 pb-2",children:e.jsx("button",{onClick:S,disabled:g,className:"bg-muted hover:bg-muted/80 w-full rounded-xl py-2.5 text-sm font-medium transition-colors disabled:opacity-50",children:t("cancel")})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)] flex-shrink-0"})]})})}const fd=({params:t})=>e.jsx(me,{params:t,children:e.jsx(_y,{})});fd.__docgenInfo={description:"",methods:[],displayName:"CryptoAuthorizeJob"};const Ey={"zh-CN":"","zh-TW":"",en:"English",ja:"",ko:"",ar:""},My={USD:"USD ($)",CNY:"CNY ()",EUR:"EUR ()",JPY:"JPY ()",KRW:"KRW ()"};function Mr(){const{navigate:t}=ce(),{push:s}=X(),{t:n}=O(["settings","common","security","error"]),a=Fe(),r=Va(),o=Xt(),d=jo(),i=bo(),l=st(),m=hv(),[u,f]=c.useState(!1),[h,x]=c.useState("loading");c.useEffect(()=>{async function N(){if(!a){x("unavailable");return}const b=a.chainAddresses.find(S=>S.chain==="bfmeta"||S.chain==="bfm");if(!b){x("unavailable");return}try{const S=He.getChainById(Na.state,"bfmeta");if(!S){x("unavailable");return}const k=await bv(S,b.address);x(k?"set":"not_set")}catch{x("unavailable")}}N()},[a]);const y=()=>n(`settings:appearance.${i}`),p=()=>{switch(m.status){case"checking":return n("settings:update.checking");case"update-available":return n("settings:update.available");case"up-to-date":return n("settings:update.upToDate");case"error":return n("settings:update.failed");case"not-dweb":return n("settings:update.dwebRequired");default:return n("settings:update.notChecked")}},g=async()=>{const N=await pv.check("manual");if(N.status==="not-dweb"){l.show(n("error:crypto.dwebEnvironmentRequired"));return}if(N.status==="error"){l.show(n("settings:update.failed"));return}N.status==="up-to-date"&&l.show(n("settings:update.upToDate"))},v=()=>{switch(h){case"loading":return"...";case"set":return n("security:twoStepSecret.alreadySet");case"not_set":return n("security:twoStepSecret.notSet");default:return n("settings:notSupported")}},j=async()=>{if(h!=="not_set"||!a)return;const N=a.chainAddresses.find(k=>k.chain==="bfmeta"||k.chain==="bfm");if(!N)return;const b=He.getChainById(Na.state,"bfmeta");if(!b)return;const S=await yv(b);_v(async(k,P)=>{const _=await vv({chainConfig:b,walletId:a.id,password:P,fromAddress:N.address,newTwoStepSecret:k});return _.status==="ok"?(x("set"),{success:!0,txHash:_.txHash}):_.status==="password"?{success:!1,error:n("security:passwordConfirm.verifying")}:_.status==="already_set"?(x("set"),{success:!1,error:n("security:twoStepSecret.alreadySet")}):{success:!1,error:_.message}},S??void 0,async()=>{const{getChainProvider:k}=await Tt(async()=>{const{getChainProvider:_}=await import("./index-DdArusCF.js").then(A=>A.x);return{getChainProvider:_}},__vite__mapDeps([2,3,1,4,5,6,7,8,9,10]),import.meta.url),P=k(b.id);if(!P.bioGetAccountInfo)return!1;try{return!!(await P.bioGetAccountInfo(N.address)).secondPublicKey}catch{return!1}}),s("SetTwoStepSecretJob",{chainName:"BioForest Chain"})};return e.jsxs("div",{className:"bg-muted/30 flex h-full flex-col overflow-y-auto",children:[e.jsx(K,{title:n("common:a11y.tabSettings")}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("button",{type:"button",onClick:()=>t({to:"/my-card"}),className:"bg-card hover:bg-accent flex w-full items-center gap-4 rounded-xl p-4 shadow-sm transition-colors","data-testid":"my-card-button",children:[e.jsx(ys,{src:r.avatar,size:56}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("h2",{className:"font-semibold",children:r.username||n("common:myCard.defaultName")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:n("settings:items.myCard")})]}),e.jsx(bp,{size:20,className:"text-muted-foreground"})]}),e.jsxs(Ts,{title:n("settings:sections.walletManagement"),children:[e.jsx(Se,{icon:e.jsx(tr,{size:20}),label:n("settings:items.walletManagement"),onClick:()=>t({to:`/wallet/${a?.id??""}`})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(ic,{size:20}),label:n("settings:items.walletChains"),onClick:()=>t({to:"/settings/wallet-chains"}),testId:"wallet-chains-button"}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(Jf,{size:20}),label:n("settings:items.addressBook"),onClick:()=>t({to:"/address-book"}),testId:"address-book-button"})]}),e.jsxs(Ts,{title:n("settings:sections.security"),children:[e.jsx(Se,{icon:e.jsx(Xs,{size:20}),label:n("settings:items.appLock"),value:n("settings:notSupported"),disabled:!0}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(rr,{size:20}),label:n("settings:items.viewMnemonic"),onClick:()=>t({to:"/settings/mnemonic"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(lr,{size:20}),label:n("settings:items.changeWalletLock"),onClick:()=>t({to:"/settings/wallet-lock"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(Am,{size:20}),label:n("security:twoStepSecret.setup"),value:v(),onClick:j,disabled:h==="set"||h==="unavailable",testId:"set-pay-password-button"})]}),e.jsxs(Ts,{title:n("settings:sections.preferences"),children:[e.jsx(Se,{icon:e.jsx(Np,{size:20}),label:n("settings:items.language"),value:Ey[o],onClick:()=>t({to:"/settings/language"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(ip,{size:20}),label:n("settings:items.currency"),value:My[d],onClick:()=>t({to:"/settings/currency"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(Tp,{size:20}),label:n("settings:items.appearance"),value:y(),onClick:()=>f(!0)}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(Ap,{size:20}),label:n("settings:items.chainConfig"),onClick:()=>t({to:"/settings/chains"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(cc,{size:20}),label:n("settings:items.miniappSources"),onClick:()=>t({to:"/settings/sources"})})]}),e.jsxs(Ts,{title:n("settings:sections.about"),allowContextMenu:!0,children:[e.jsx(Se,{icon:e.jsx(Gm,{size:20}),label:n("settings:items.aboutApp"),value:"v0.10.10-021308",onClick:()=>{}}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(ts,{size:20}),label:n("settings:update.check"),value:p(),onClick:g}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(ac,{size:20}),label:n("settings:items.storage"),onClick:()=>t({to:"/settings/storage"}),testId:"storage-button"})]}),e.jsx("div",{className:"h-[var(--tab-bar-height)]"})]}),e.jsx(Cl,{open:u,onOpenChange:f})]})}Mr.__docgenInfo={description:"",methods:[],displayName:"SettingsPage"};function pd(){return e.jsx(Mr,{})}pd.__docgenInfo={description:`SettingsTab - 

 SettingsPage `,methods:[],displayName:"SettingsTab"};const hd=({params:t})=>{const{push:s}=X(),[n,a]=c.useState(t.tab||"wallet"),r=c.useRef(Promise.resolve()),o=c.useRef(0);return c.useEffect(()=>{qm(),Wr().setPermissionRequestCallback(async(l,m,u)=>{const f=Hm.state.apps.get(l)?.manifest.icon;return new Promise(h=>{const x=window.setTimeout(()=>h(!1),3e4),y=p=>{window.clearTimeout(x);const g=p.detail;h(g?.approved===!0)};window.addEventListener("permission-request",y,{once:!0}),s("PermissionRequestJob",{appName:m,appIcon:f,permissions:JSON.stringify(u)})})}),$r(async l=>{const m=l?.app?.name,u=l?.app?.icon;return new Promise(f=>{const h=window.setTimeout(()=>f(null),3e4),x=()=>{window.clearTimeout(h),window.removeEventListener("wallet-picker-select",y),window.removeEventListener("wallet-picker-cancel",p)},y=g=>{x();const v=g.detail;f({address:v.address,chain:v.chain,name:v.name})},p=()=>{x(),f(null)};window.addEventListener("wallet-picker-select",y),window.addEventListener("wallet-picker-cancel",p),s("WalletPickerJob",{chain:l?.chain,exclude:l?.exclude,...m?{appName:m}:{},...u?{appIcon:u}:{}})})}),qr(()=>{const l=Le.state,m=Ks.getCurrentWallet(l);return m?m.chainAddresses.map(u=>({address:u.address,chain:u.chain,name:m.name})):[]}),Hr(async l=>new Promise(m=>{const u=window.setTimeout(()=>m(null),6e4),f=h=>{window.clearTimeout(u);const x=h.detail;if(x?.confirmed&&x.signature&&x.publicKey){m({signature:x.signature,publicKey:x.publicKey});return}m(null)};window.addEventListener("signing-confirm",f,{once:!0}),s("SigningConfirmJob",{message:l.message,address:l.address,appName:l.app.name,appIcon:l.app.icon??"",chainName:l.chainName})}));const d=(l,m)=>{console.log("[miniapp-transfer-sheet]",l,m)},i=(l,m)=>{d("queue.enqueue",m);const u=r.current.catch(()=>{}).then(async()=>(d("queue.start",m),l()));return r.current=u.then(()=>{d("queue.done",m)},f=>{const h=f instanceof Error?f.message:String(f);d("queue.error",{...m,message:h})}),u};return Ur(async l=>{const m=`transfer-${Date.now()}-${++o.current}`;return new Promise(u=>{i(()=>new Promise(f=>{let h=!1,x=!1;const y=()=>{window.removeEventListener("miniapp-transfer-confirm",v),window.removeEventListener("miniapp-transfer-sheet-closed",j)},p=N=>{h||(h=!0,u(N),x&&y())},g=N=>{x||(x=!0,d("queue.release",{requestId:m,source:"bio",reason:N,resultSettled:h}),f(),h&&y())},v=N=>{const b=N.detail;if(b?.requestId!==m){d("dialog.ignore",{requestId:m,source:"bio",incomingRequestId:b?.requestId??"unknown"});return}if(d("dialog.receive",{requestId:m,source:"bio",confirmed:b?.confirmed===!0}),b?.confirmed&&b.txHash){p({txHash:b.txHash,txId:b.txId,transaction:b.transaction});return}p(null)},j=N=>{const b=N.detail;b?.requestId===m&&(d("dialog.sheet-closed",{requestId:m,source:"bio",reason:b?.reason??"unknown"}),h||p(null),g(b?.reason??"sheet-closed"))};window.addEventListener("miniapp-transfer-confirm",v),window.addEventListener("miniapp-transfer-sheet-closed",j),d("dialog.push",{requestId:m,source:"bio",from:l.from,to:l.to,chain:l.chain}),s("MiniappTransferConfirmJob",{requestId:m,appName:l.app.name,appIcon:l.app.icon??"",from:l.from,to:l.to,amount:l.amount,chain:l.chain,...l.asset?{asset:l.asset}:{}})}),{requestId:m,source:"bio"})})}),Vr(async l=>new Promise(m=>{const u=window.setTimeout(()=>m(null),6e4),f=h=>{window.clearTimeout(u);const x=h.detail;if(x?.confirmed&&x.signedTx){m(x.signedTx);return}m(null)};window.addEventListener("miniapp-sign-transaction-confirm",f,{once:!0}),s("MiniappSignTransactionJob",{appName:l.app.name,appIcon:l.app.icon??"",from:l.from,chain:l.chain,unsignedTx:Kt.stringify(l.unsignedTx)})})),Jr(async l=>{const m=l.app?.name,u=l.app?.icon;return new Promise(f=>{const h=window.setTimeout(()=>f(null),3e4),x=()=>{window.clearTimeout(h),window.removeEventListener("wallet-picker-select",y),window.removeEventListener("wallet-picker-cancel",p)},y=g=>{x();const v=g.detail;f({address:v.address,chain:v.chain,name:v.name})},p=()=>{x(),f(null)};window.addEventListener("wallet-picker-select",y),window.addEventListener("wallet-picker-cancel",p),s("WalletPickerJob",{chain:l.chainId,...m?{appName:m}:{},...u?{appIcon:u}:{}})})}),Yr(async l=>new Promise(m=>{const u=window.setTimeout(()=>m(!1),3e4),f=h=>{window.clearTimeout(u);const x=h.detail;m(x?.approved===!0)};window.addEventListener("chain-switch-confirm",f,{once:!0}),s("ChainSwitchConfirmJob",{fromChainId:l.fromChainId,toChainId:l.toChainId,appName:l.appName,appIcon:l.appIcon})})),Kr(async l=>new Promise(m=>{const u=window.setTimeout(()=>m(null),6e4),f=h=>{window.clearTimeout(u);const x=h.detail;if(x?.confirmed&&x.signature){m({signature:x.signature});return}m(null)};window.addEventListener("signing-confirm",f,{once:!0}),s("SigningConfirmJob",{message:l.message,address:l.address,appName:l.appName,chainName:"ethereum"})})),Gr(async l=>{const{from:m,to:u,value:f,chainId:h}=l.tx;if(!m||!u)return null;const y=BigInt(f??"0x0").toString(),p=h?Vn(h):null,g=`transfer-${Date.now()}-${++o.current}`;return new Promise(v=>{i(()=>new Promise(j=>{let N=!1,b=!1;const S=()=>{window.removeEventListener("miniapp-transfer-confirm",_),window.removeEventListener("miniapp-transfer-sheet-closed",A)},k=T=>{N||(N=!0,v(T),b&&S())},P=T=>{b||(b=!0,d("queue.release",{requestId:g,source:"evm",reason:T,resultSettled:N}),j(),N&&S())},_=T=>{const C=T.detail;if(C?.requestId!==g){d("dialog.ignore",{requestId:g,source:"evm",incomingRequestId:C?.requestId??"unknown"});return}if(d("dialog.receive",{requestId:g,source:"evm",confirmed:C?.confirmed===!0}),C?.confirmed&&C.txHash){k({txHash:C.txHash});return}k(null)},A=T=>{const C=T.detail;C?.requestId===g&&(d("dialog.sheet-closed",{requestId:g,source:"evm",reason:C?.reason??"unknown"}),N||k(null),P(C?.reason??"sheet-closed"))};window.addEventListener("miniapp-transfer-confirm",_),window.addEventListener("miniapp-transfer-sheet-closed",A),d("dialog.push",{requestId:g,source:"evm",from:m,to:u,chain:p??"ethereum"}),s("MiniappTransferConfirmJob",{requestId:g,appName:l.appName,from:m,to:u,amount:y,chain:p??"ethereum"})}),{requestId:g,source:"evm"})})}),Qr(async l=>{const m=l?.app?.name,u=l?.app?.icon;return new Promise(f=>{const h=window.setTimeout(()=>f(null),3e4),x=()=>{window.clearTimeout(h),window.removeEventListener("wallet-picker-select",y),window.removeEventListener("wallet-picker-cancel",p)},y=g=>{x();const v=g.detail;f({address:v.address,chain:v.chain,name:v.name})},p=()=>{x(),f(null)};window.addEventListener("wallet-picker-select",y),window.addEventListener("wallet-picker-cancel",p),s("WalletPickerJob",{chain:"tron",...m?{appName:m}:{},...u?{appIcon:u}:{}})})}),Xr(l=>async m=>new Promise(u=>{const f=window.setTimeout(()=>u({approved:!1}),6e4),h=x=>{window.clearTimeout(f);const y=x.detail;if(y?.approved&&y.patternKey&&y.walletId){u({approved:!0,patternKey:y.patternKey,walletId:y.walletId,selectedDuration:y.selectedDuration});return}u({approved:!1})};window.addEventListener("crypto-authorize-confirm",h,{once:!0}),s("CryptoAuthorizeJob",{actions:Kt.stringify(m.actions),duration:m.duration,address:m.address,chainId:m.chainId,appName:m.app.name,appIcon:m.app.icon})})),()=>{Wr().setPermissionRequestCallback(null),$r(null),Jr(null),Yr(null),Kr(null),Gr(null),Qr(null),Xr(null),qr(null),Hr(null),Ur(null),Vr(null)}},[s]),e.jsx(oe,{children:e.jsx(xm,{children:e.jsxs("div",{className:"bg-background relative h-dvh",children:[e.jsx(c.Activity,{mode:n==="wallet"?"visible":"hidden",children:e.jsx(Nl,{})}),e.jsx("div",{style:{display:n==="ecosystem"?"contents":"none"},children:e.jsx(wl,{})}),e.jsx(c.Activity,{mode:n==="settings"?"visible":"hidden",children:e.jsx(pd,{})}),e.jsx(lm,{activeTab:n,onTabChange:a})]})})})};hd.__docgenInfo={description:"",methods:[],displayName:"MainTabsActivity"};function xd(){const{t}=O("wallet"),{navigate:s,goBack:n}=ce(),{push:a}=X(),r=Ae(Le,u=>u.wallets),o=Ae(Le,u=>u.currentWalletId),d=c.useCallback(u=>{ge.setCurrentWallet(u)},[]),i=c.useCallback(u=>{s({to:`/wallet/${u}`})},[s]),l=c.useCallback(()=>{a("WalletAddJob",{})},[a]),m=c.useCallback(()=>{n()},[n]);return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(K,{title:t("list.title"),onBack:m,rightAction:e.jsx("button",{onClick:l,className:R("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":t("add"),children:e.jsx(ut,{className:"size-5"})})}),e.jsx("div",{className:"flex-1 p-4",children:r.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[e.jsx("p",{className:"text-muted-foreground",children:t("list.empty")}),e.jsx("button",{onClick:l,className:R("bg-primary rounded-full px-6 py-2.5 text-sm font-medium text-primary-foreground","hover:bg-primary/90 active:bg-primary/80"),children:t("add")})]}):e.jsx("div",{className:"space-y-3",children:r.map(u=>e.jsx(Ry,{wallet:u,isActive:u.id===o,onSelect:()=>d(u.id),onDetail:()=>i(u.id),t},u.id))})})]})}function Ry({wallet:t,isActive:s,onSelect:n,onDetail:a,t:r}){return e.jsxs("div",{className:R("bg-card rounded-xl p-4 shadow-sm transition-colors",s&&"ring-primary ring-2"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:n,className:R("flex size-12 items-center justify-center rounded-full text-lg font-semibold",s?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),children:t.name.slice(0,1)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"truncate font-semibold",children:t.name}),s&&e.jsxs("span",{className:"text-primary flex items-center gap-1 text-xs",children:[e.jsx(je,{className:"size-3"}),r("list.current")]})]}),e.jsx("p",{className:"text-muted-foreground text-sm",children:r("list.chainAddresses",{count:t.chainAddresses.length})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-semibold",children:["$",0 .toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})}),e.jsx("button",{onClick:a,className:R("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":r("list.viewDetail"),children:e.jsx(De,{className:"text-muted-foreground size-5"})})]})]}),e.jsx("p",{className:"text-muted-foreground mt-2 truncate font-mono text-xs",children:t.address})]})}xd.__docgenInfo={description:"",methods:[],displayName:"WalletListPage"};const gd=()=>e.jsx(oe,{children:e.jsx(xd,{})});gd.__docgenInfo={description:"",methods:[],displayName:"WalletListActivity"};function Ly(){const{t}=O("wallet"),{walletId:s,mode:n="default"}=pe(),{goBack:a,navigate:r}=ce(),d=Et().find(m=>m.id===s),i=()=>{r({to:"/",replace:!0})};if(!d)return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:t("detail.title"),onBack:a}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(Jt,{variant:"error",children:t("detail.notFound")})})]});const l=t(n==="edit-only"?"detail.editTitle":"detail.title");return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:l,...n!=="edit-only"&&{onBack:a}}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsx(Qn,{mode:n,walletId:s,onEditOnlyComplete:i}),n==="default"&&e.jsx("div",{className:"mt-6",children:e.jsx(Jt,{variant:"warning",children:t("detail.securityWarning")})})]})]})}const vd=({params:t})=>e.jsx(oe,{children:e.jsx(me,{params:t,children:e.jsx(Ly,{})})});vd.__docgenInfo={description:"",methods:[],displayName:"WalletConfigActivity"};const Dy=["pattern","mnemonic","verify","chains","theme"];function yd(){const{goBack:t,navigate:s}=ce(),{t:n}=O("onboarding"),a=Gs(),r=Xt(),[o,d]=c.useState("pattern"),[i,l]=c.useState(""),[m]=c.useState(()=>{if(typeof window<"u"){const w=window.__E2E_MNEMONIC__;if(typeof w=="string"&&w.trim())return w.trim().split(/\s+/);if(Array.isArray(w)&&w.every(E=>typeof E=="string"))return w}return dm()}),[u,f]=c.useState(!0),[h,x]=c.useState(!1),[y,p]=c.useState([]),[g,v]=c.useState(!1),[j,N]=c.useState(!1),[b,S]=c.useState(null),k=Dy.indexOf(o)+1;c.useEffect(()=>{!g&&a.length>0&&(p(Uo(a)),v(!0))},[a,g]);const P=()=>{o==="mnemonic"?(d("pattern"),l("")):o==="verify"?d("mnemonic"):o==="chains"?d("verify"):o==="theme"||t()},_=w=>{l(w),d("mnemonic")},A=()=>{(h||!u)&&d("verify")},T=()=>{d("chains")},C=async()=>{if(!j){N(!0);try{const w=m.join(" "),D=(await Vo({mnemonic:w,selectedChainIds:y,chainConfigs:a})).map(({chainId:M,address:F,publicKey:G})=>({chain:M,address:F,publicKey:G??"",tokens:[]})),z=D[0];if(!z)throw new Error("No chain addresses derived");const L=ja(z.address),q=await ge.createWallet({name:n("create.generatedNamePattern",{word:An(r),suffix:n("create.walletSuffix")}),keyType:"mnemonic",address:z.address,chain:z.chain,chainAddresses:D,themeHue:L},w,i,L);S(q.id),d("theme")}catch{}finally{N(!1)}}},I=()=>{s({to:"/",replace:!0})};return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:n("create.title"),onBack:P}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(yt,{total:5,current:k})}),e.jsxs("div",{className:"flex-1 p-4",children:[o==="pattern"&&e.jsx("div",{"data-testid":"pattern-step",children:e.jsx(ir,{onComplete:_,minPoints:4})}),o==="mnemonic"&&e.jsx("div",{"data-testid":"mnemonic-step",children:e.jsx(zy,{mnemonic:m,hidden:u,copied:h,onToggleHidden:()=>f(!u),onCopy:()=>x(!0),onContinue:A})}),o==="verify"&&e.jsx("div",{"data-testid":"verify-step",children:e.jsx(Oy,{mnemonic:m,onContinue:T})}),o==="chains"&&e.jsx("div",{"data-testid":"chain-selector-step",children:e.jsx(By,{chains:a,selectedChains:y,selectionCount:y.length,onSelectionChange:p,onComplete:C,completeLabel:n("create.nextStep"),isSubmitting:j})}),o==="theme"&&b&&e.jsx("div",{"data-testid":"theme-step",children:e.jsx(Qn,{mode:"edit-only",walletId:b,onEditOnlyComplete:I})})]})]})}function zy({mnemonic:t,hidden:s,copied:n,onToggleHidden:a,onCopy:r,onContinue:o}){const{t:d}=O("onboarding"),i=n||!s;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Ys,{icon:e.jsx(lr,{className:"size-full"}),variant:"warning",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:d("create.backupMnemonic")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:d("create.backupHint")})]}),e.jsx(Jt,{variant:"warning",children:d("create.mnemonicWarning")}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:d("create.mnemonicTitle")}),e.jsxs("button",{type:"button","data-testid":"toggle-mnemonic-button",onClick:a,className:"text-primary flex items-center gap-1 text-sm",children:[s?e.jsx(rr,{className:"size-4"}):e.jsx(Jo,{className:"size-4"}),d(s?"create.mnemonicShow":"create.mnemonicHide")]})]}),e.jsx(Ho,{words:t,hidden:s,onCopy:r})]}),e.jsxs(Ue,{variant:"mint",className:"w-full","data-testid":"mnemonic-backed-up-button",disabled:!i,onClick:o,children:[d(i?"create.mnemonicBackedUp":"create.mnemonicViewFirst"),i&&e.jsx(De,{className:"ml-2 size-4"})]})]})}function Oy({mnemonic:t,onContinue:s}){const{t:n}=O(["onboarding","common"]),[a]=c.useState(()=>Array.from({length:t.length},(f,h)=>h).toSorted(()=>Math.random()-.5).slice(0,3).toSorted((f,h)=>f-h)),[r,o]=c.useState({}),d=a.every(m=>{const u=t[m],f=r[m];return u&&f&&f.toLowerCase()===u.toLowerCase()}),i=(m,u)=>{o(f=>({...f,[m]:u}))},l=m=>{const u=t[m],f=r[m];if(f&&u&&f.toLowerCase()!==u.toLowerCase())return n("create.wordIncorrect")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Ys,{icon:e.jsx(bs,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:n("create.verifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("create.verifyDesc")})]}),e.jsx("div",{className:"space-y-4",children:a.map(m=>e.jsx(Lm,{label:n("create.wordN",{n:m+1}),error:l(m),children:e.jsx(Ve,{"data-testid":`verify-word-input-${m}`,"data-verify-index":m,value:r[m]||"",onChange:u=>i(m,u.target.value),className:R(l(m)&&"border-destructive focus-visible:ring-destructive"),placeholder:n("create.wordNPlaceholder",{n:m+1}),autoCapitalize:"off",autoCorrect:"off"})},m))}),e.jsx(Ue,{variant:"mint",className:"w-full","data-testid":"verify-next-button",disabled:!d,onClick:s,children:n("common:next")})]})}function By({chains:t,selectedChains:s,selectionCount:n,isSubmitting:a,completeLabel:r,onSelectionChange:o,onComplete:d}){const{t:i}=O(["onboarding","common"]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Ys,{icon:e.jsx(bs,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:i("chainSelector.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:i("chainSelector.subtitle")})]}),t.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(Te,{})}):e.jsx(or,{"data-testid":"chain-selector",chains:t,selectedChains:s,onSelectionChange:o}),e.jsx(Ue,{variant:"mint",className:"w-full","data-testid":"chain-selector-complete-button",disabled:n===0||a,onClick:d,children:r})]})}yd.__docgenInfo={description:"",methods:[],displayName:"WalletCreatePage"};const bd=()=>e.jsx(oe,{children:e.jsx(yd,{})});bd.__docgenInfo={description:"",methods:[],displayName:"WalletCreateActivity"};function Fy(t,s){return{symbol:t.symbol,name:t.name,balance:t.amount.toFormatted(),decimals:t.decimals,fiatValue:void 0,chain:s,icon:t.icon,change24h:0,contractAddress:t.contractAddress}}function jd(t,s){return t.map(n=>Fy(n,s))}const Wy={ETH:{amount:"0.002",symbol:"ETH"},USDT:{amount:"0.003",symbol:"ETH"},USDC:{amount:"0.003",symbol:"ETH"},BTC:{amount:"0.0001",symbol:"BTC"},TRX:{amount:"1",symbol:"TRX"},BFM:{amount:"0.1",symbol:"BFM"}},oo={step:"input",asset:null,toAddress:"",amount:null,addressError:null,amountError:null,feeAmount:null,feeMinAmount:null,feeSymbol:"",feeLoading:!1,isSubmitting:!1,resultStatus:null,txHash:null,errorMessage:null},ze=Ce.t.bind(Ce);async function $y(t,s){const n=Pe(t.id);if(!n.supportsFeeEstimate||!n.supportsBuildTransaction)throw new Error(`Chain ${t.id} does not support fee estimation`);const a=await n.buildTransaction({type:"transfer",from:s,to:s,amount:re.fromRaw("1",t.decimals,t.symbol)});return{amount:(await n.estimateFee(a)).standard.amount,symbol:t.symbol}}async function qy({chainConfig:t,walletId:s,password:n,fromAddress:a,toAddress:r,amount:o}){let d;try{d=await hs.getMnemonic(s,n)}catch(i){return i instanceof Js&&i.code===xs.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:i instanceof Error?i.message:ze("error:transaction.unknownError")}}if(!o.isPositive())return{status:"error",message:ze("error:validation.enterValidAmount")};try{const i=Pe(t.id);if(!i.supportsFullTransaction)return{status:"error",message:ze("error:transaction.chainNotSupported",{chainId:t.id})};const l=Nm(d),m=await i.buildTransaction({type:"transfer",from:a,to:r,amount:o}),u=await i.signTransaction(m,{privateKey:l});return{status:"ok",txHash:await i.broadcastTransaction(u)}}catch(i){const l=i instanceof Error?i.message:String(i);return l.includes("insufficient")||l.includes("balance")?{status:"error",message:ze("error:insufficientFunds")}:l.includes("fee")||l.includes("gas")?{status:"error",message:ze("error:transaction.insufficientGas")}:l.includes("not yet implemented")||l.includes("not supported")?{status:"error",message:ze("error:chain.transferNotImplemented")}:{status:"error",message:l||ze("error:transaction.failed")}}}function Hy(t,s){const n=Pe(t.id);return n.supportsAddressValidation?!s||s.trim()===""?ze("error:validation.enterRecipientAddress"):n.isValidAddress(s)?!s||s.trim()===""?ze("error:validation.enterReceiverAddress"):n.isValidAddress(s)?null:ze("error:validation.invalidAddress"):ze("error:validation.invalidAddressFormat"):ze("error:validation.unsupportedChainType")}const et=Ce.t.bind(Ce);function Nd(t,s){return t.trim()?s?Cf(t):Em(t):!1}function Uy(t,s,n){return t.trim()?Nd(t,s)?s&&n&&t.trim()===n.trim()?et("error:validation.cannotTransferToSelf"):null:et("error:validation.invalidAddressFormat"):et("error:validation.enterRecipientAddress")}function Vy(t,s){return t?s?t.isPositive()?t.gt(s.amount)?et("error:insufficientFunds"):null:et("error:validation.enterValidAmount"):null:et("error:validation.enterAmount")}function Jy(t){const{toAddress:s,amount:n,asset:a,isBioforestChain:r,feeAmount:o,feeLoading:d}=t;return!a||!n||d||!o?!1:s.trim()!==""&&Nd(s,r)&&n.isPositive()&&n.lte(a.amount)}function wd(t,s,n){if(!t)return{status:"error",message:et("error:validation.enterValidAmount")};const a=s.amount;if(s.assetType===n.symbol){if(t.add(n).lte(a))return{status:"ok"};if(!t.eq(a))return{status:"error",message:et("error:insufficientFunds")};const o=a.sub(n);return o.isPositive()?{status:"ok",adjustedAmount:o}:{status:"error",message:et("error:insufficientFunds")}}else return t.lte(a)?{status:"ok"}:{status:"error",message:et("error:insufficientFunds")}}const co=Ce.t.bind(Ce);async function Ky(t){t(s=>({...s,step:"sending",isSubmitting:!0}));try{if(await new Promise(n=>setTimeout(n,2e3)),Math.random()>.2)return t(n=>({...n,step:"result",isSubmitting:!1,resultStatus:"success",txHash:`0x${Math.random().toString(16).slice(2)}${Math.random().toString(16).slice(2)}`,errorMessage:null})),{status:"ok"};throw new Error(co("error:transaction.transactionFailed"))}catch(s){return t(n=>({...n,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:s instanceof Error?s.message:co("error:transaction.unknownError")})),{status:"error"}}}const Ge=Ce.t.bind(Ce);function Gy(t={}){const{initialAsset:s,useMock:n=!0,walletId:a,fromAddress:r,chainConfig:o,getBalance:d}=t,[i,l]=c.useState({...oo,asset:s??null}),m=c.useRef(null),u=o?.chainKind==="bioforest",f=o?.chainKind==="evm"||o?.chainKind==="tron"||o?.chainKind==="bitcoin",h=c.useCallback(T=>f&&o?Hy(o,T):Uy(T,u,r),[u,f,o,r]),x=c.useCallback((T,C)=>Vy(T,C),[]),y=c.useCallback(T=>{l(C=>({...C,toAddress:T,addressError:null}))},[]),p=c.useCallback(T=>{l(C=>({...C,amount:T,amountError:null}))},[]),g=c.useCallback(T=>{l(C=>{if(!C.feeAmount)return C;const I=re.fromFormatted(T,C.feeAmount.decimals,C.feeAmount.symbol);return{...C,feeAmount:I}})},[]),v=c.useCallback(T=>{if(l(I=>({...I,asset:T,feeLoading:!0})),n||!u&&!f||!o||!r){setTimeout(()=>{const I=Wy[T.assetType]??{amount:"0.001",symbol:T.assetType},w=re.fromFormatted(I.amount,T.decimals,I.symbol);l(E=>({...E,feeAmount:w,feeMinAmount:w,feeSymbol:I.symbol,feeLoading:!1}))},300);return}(async()=>{try{const I=f?await $y(o,r):await gv(o,r);l(w=>({...w,feeAmount:I.amount,feeMinAmount:I.amount,feeSymbol:I.symbol,feeLoading:!1}))}catch(I){l(w=>({...w,feeLoading:!1,errorMessage:I instanceof Error?I.message:Ge("error:transaction.feeEstimateFailed")}))}})()},[o,r,u,f,n]);c.useEffect(()=>{if(!i.asset||i.feeLoading)return;const T=`${o?.id??"unknown"}:${r??""}:${i.asset.assetType}`,C=m.current!==T;C&&(m.current=T),!(!C&&i.feeAmount)&&(!C&&!i.feeAmount||v(i.asset))},[o?.id,r,v,i.asset,i.feeAmount,i.feeLoading]);const j=c.useMemo(()=>!i.asset?.assetType||!d?i.asset?.amount??null:d(i.asset.assetType)??i.asset?.amount??null,[i.asset?.assetType,i.asset?.amount,d]),N=c.useMemo(()=>!i.asset||!j?i.asset:j.decimals===i.asset.decimals?{...i.asset,amount:j}:{...i.asset,amount:j,decimals:j.decimals},[i.asset,j]),b=c.useMemo(()=>Jy({toAddress:i.toAddress,amount:i.amount,asset:N,isBioforestChain:u,feeAmount:i.feeAmount,feeLoading:i.feeLoading}),[u,i.amount,N,i.toAddress,i.feeAmount,i.feeLoading]),S=c.useCallback(()=>{const T=h(i.toAddress),C=N?x(i.amount,N):Ge("error:validation.selectAsset");if(T||C)return l(I=>({...I,addressError:T,amountError:C})),!1;if(N&&i.feeAmount&&i.amount){const I=wd(i.amount,N,i.feeAmount);if(I.status==="error")return l(w=>({...w,amountError:I.message})),!1;I.adjustedAmount&&l(w=>({...w,amount:I.adjustedAmount??w.amount}))}return l(I=>({...I,step:"confirm",addressError:null,amountError:null})),!0},[i.toAddress,i.amount,N,i.feeAmount,h,x]),k=c.useCallback(()=>{l(T=>({...T,step:"input"}))},[]),P=c.useCallback(async T=>{if(n)return(await Ky(l)).status==="ok"?{status:"ok"}:{status:"error",message:Ge("transaction:broadcast.unknown")};if(!o)return l(E=>({...E,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:Ge("error:transaction.chainConfigMissing")})),{status:"error"};if(o.chainKind==="evm"||o.chainKind==="tron"||o.chainKind==="bitcoin"){if(!a||!r||!i.asset||!i.amount)return l(D=>({...D,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:Ge("error:transaction.walletInfoIncomplete")})),{status:"error"};l(D=>({...D,step:"sending",isSubmitting:!0,errorMessage:null}));const E=await qy({chainConfig:o,walletId:a,password:T,fromAddress:r,toAddress:i.toAddress,amount:i.amount});return E.status==="password"?(l(D=>({...D,step:"confirm",isSubmitting:!1})),{status:"password"}):E.status==="error"?(l(D=>({...D,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:E.message})),{status:"error"}):(l(D=>({...D,step:"result",isSubmitting:!1,resultStatus:"success",txHash:E.txHash,errorMessage:null})),{status:"ok",txHash:E.txHash})}if(o.chainKind!=="bioforest")return l(E=>({...E,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:Ge("error:transaction.unsupportedChainType",{chainType:o.chainKind})})),{status:"error"};if(!a||!r||!i.asset)return l(E=>({...E,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:Ge("error:wallet.incompleteInfo")})),{status:"error"};const C=h(i.toAddress),I=x(i.amount,i.asset);if(C||I)return l(E=>({...E,addressError:C,amountError:I})),{status:"error"};if(l(E=>({...E,step:"sending",isSubmitting:!0,errorMessage:null})),!i.amount)return l(E=>({...E,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:Ge("error:transaction.invalidAmount")})),{status:"error"};const w=await Ji({chainConfig:o,walletId:a,password:T,fromAddress:r,toAddress:i.toAddress,amount:i.amount,assetType:i.asset.assetType,fee:i.feeAmount??void 0});return w.status==="password"?(l(E=>({...E,step:"confirm",isSubmitting:!1})),{status:"password"}):w.status==="password_required"?(l(E=>({...E,step:"confirm",isSubmitting:!1})),{status:"two_step_secret_required",secondPublicKey:w.secondPublicKey}):w.status==="error"?(l(E=>({...E,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:w.message})),{status:"error",message:w.message,pendingTxId:w.pendingTxId}):(l(E=>({...E,step:"result",isSubmitting:!1,resultStatus:"success",txHash:w.txHash,errorMessage:null})),{status:"ok",txHash:w.txHash,pendingTxId:w.pendingTxId})},[o,r,i.amount,i.asset,i.toAddress,n,h,x,a]),_=c.useCallback(async(T,C)=>{if(!o||!a||!r)return{status:"error"};if(l(w=>({...w,step:"sending",isSubmitting:!0,resultStatus:null,txHash:null,errorMessage:null})),!i.amount||!i.asset)return l(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:Ge("error:transaction.invalidAmount")})),{status:"error"};const I=await Ji({chainConfig:o,walletId:a,password:T,fromAddress:r,toAddress:i.toAddress,amount:i.amount,assetType:i.asset.assetType,fee:i.feeAmount??void 0,twoStepSecret:C});return I.status==="password"?(l(w=>({...w,step:"confirm",isSubmitting:!1})),{status:"password"}):I.status==="error"?(l(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:I.message})),{status:"error",message:I.message,pendingTxId:I.pendingTxId}):I.status==="password_required"?(l(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:Ge("error:transaction.securityPasswordFailed")})),{status:"error"}):(l(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"success",txHash:I.txHash,errorMessage:null})),{status:"ok",txHash:I.txHash,pendingTxId:I.pendingTxId})},[o,r,i.amount,i.toAddress,a]),A=c.useCallback(()=>{l({...oo,asset:s??null})},[s]);return{state:i,setToAddress:y,setAmount:p,setAsset:v,setFee:g,goToConfirm:S,goBack:k,submit:P,submitWithTwoStepSecret:_,reset:A,canProceed:b}}function Qy(){const{t}=O(["transaction","common","security"]),{goBack:s}=ce(),{push:n}=X(),a=st(),r=sn(),o=c.useRef(!1),{address:d,amount:i,assetType:l,assetLocked:m}=pe(),u=m==="true",f=Je(),h=Fe(),x=Un(),y=dt(),p=y.snapshot?He.getChainById(y,f):null,g=Ja(f),j=ns().tokenBalances.useState({address:x?.address??""},{enabled:!!x?.address}),N=c.useMemo(()=>j?.data?jd(j.data,f):[],[j?.data,f]),b=c.useMemo(()=>{if(!p)return null;if(l){const Q=N.find(te=>te.symbol.toUpperCase()===l.toUpperCase());return Q?{assetType:Q.symbol,name:Q.name,amount:re.fromFormatted(Q.balance,Q.decimals??p.decimals,Q.symbol),decimals:Q.decimals??p.decimals,logoUrl:Q.icon}:null}const H=N.find(Q=>Q.symbol===p.symbol)?.balance??"0";return{assetType:p.symbol,name:p.name,amount:re.fromFormatted(H,p.decimals,p.symbol),decimals:p.decimals}},[p,N,l]),S=c.useCallback(U=>{const H=N.find(Q=>Q.symbol===U);return H?re.fromFormatted(H.balance,H.decimals??p?.decimals??8,H.symbol):null},[N,p?.decimals]),{state:k,setToAddress:P,setAmount:_,setAsset:A,setFee:T,goToConfirm:C,submit:I,submitWithTwoStepSecret:w,canProceed:E}=Gy({initialAsset:b??void 0,useMock:!1,walletId:h?.id,fromAddress:x?.address,chainConfig:p,getBalance:S}),D=c.useMemo(()=>{if(!k.asset)return null;const U=S(k.asset.assetType);return{symbol:k.asset.assetType,name:k.asset.name??k.asset.assetType,balance:U?.toFormatted()??k.asset.amount.toFormatted(),decimals:k.asset.decimals,chain:f,icon:k.asset.logoUrl}},[k.asset,f,S]),z=c.useCallback(U=>{const H={assetType:U.symbol,name:U.name,amount:re.fromFormatted(U.balance,U.decimals??p?.decimals??8,U.symbol),decimals:U.decimals??p?.decimals??8,logoUrl:U.icon};A(H)},[p?.decimals,A]),L=c.useRef(!1);c.useEffect(()=>{b&&!L.current&&!k.asset&&(A(b),L.current=!0)},[b,A,k.asset]),c.useEffect(()=>{if(d&&!k.toAddress&&P(d),i&&!k.amount&&k.asset){const U=re.tryFromFormatted(i,k.asset.decimals,k.asset.assetType);U&&_(U)}},[d,i,k.toAddress,k.amount,k.asset,P,_]),c.useEffect(()=>{const U=H=>{P(H.detail.address.address)};return window.addEventListener("contact-picker-select",U),()=>window.removeEventListener("contact-picker-select",U)},[P]),c.useEffect(()=>{if(k.resultStatus==="success"&&k.toAddress){const U=Ua.getContactByAddress(Ls.state,k.toAddress);U&&qn.trackRecentContact(U.contact.id)}},[k.resultStatus,k.toAddress]);const q=c.useCallback(()=>{n("ContactPickerJob",{chainType:f})},[n,f]),M=c.useMemo(()=>k.asset?S(k.asset.assetType):null,[S,k.asset]),F=k.asset?.assetType??"TOKEN",G=k.feeSymbol||p?.symbol,Z=!!G&&G===F,B=c.useMemo(()=>{if(!k.asset||!M)return;if(!k.feeAmount)return M;const U={...k.asset,amount:M,decimals:M.decimals},H=wd(M,U,k.feeAmount);return H.status==="ok"?H.adjustedAmount??M:re.zero(M.decimals,U.assetType)},[M,k.asset,k.feeAmount]),$=Z&&(!k.feeAmount||k.feeLoading),ye=c.useCallback(()=>{bf(({content:U,parsed:H})=>{let Q=U;H.type==="address"||H.type==="payment"?Q=H.address:H.type==="contact"&&H.addresses.length>0&&(Q=H.addresses[0].address),P(Q),r.impact("success"),a.show(t("sendPage.scanSuccess"))}),n("ScannerJob",{chainType:g??f})},[n,f,g,P,r,a,t]),se=()=>{C()&&(r.impact("light"),Wl(async()=>{o.current||(o.current=!0,await r.impact("medium"),ql(async(U,H)=>{if(!H){const te=await I(U);return te.status==="password"?{status:"wallet_lock_invalid"}:te.status==="two_step_secret_required"?{status:"two_step_secret_required"}:te.status==="ok"?(o.current=!1,{status:"ok",txHash:te.txHash,pendingTxId:te.pendingTxId}):te.status==="error"?{status:"error",message:te.message??t("transaction:broadcast.unknown"),pendingTxId:te.pendingTxId}:{status:"error",message:t("transaction:broadcast.unknown")}}const Q=await w(U,H);return Q.status==="ok"?(o.current=!1,{status:"ok",txHash:Q.txHash,pendingTxId:Q.pendingTxId}):Q.status==="password"?{status:"two_step_secret_invalid",message:t("error:transaction.securityPasswordWrong")}:Q.status==="error"?{status:"error",message:Q.message??t("transaction:broadcast.unknown"),pendingTxId:Q.pendingTxId}:{status:"error",message:t("transaction:broadcast.unknown")}}),n("TransferWalletLockJob",{title:t("security:walletLock.verifyTitle")}))},{minFee:k.feeMinAmount?.toFormatted()??k.feeAmount?.toFormatted()??"0",onFeeChange:T}),n("TransferConfirmJob",{amount:k.amount?.toFormatted()??"0",symbol:F,toAddress:k.toAddress,feeAmount:k.feeAmount?.toFormatted()??"0",feeSymbol:k.feeSymbol,feeLoading:k.feeLoading?"true":"false"}))};return!h||!x?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:t("sendPage.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("history.noWallet")})})]}):e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:t("sendPage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"bg-muted/50 space-y-2 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(Pt,{chain:f,size:"sm"}),e.jsx("span",{className:"text-sm font-medium",children:g})]}),x?.address&&e.jsxs("div",{className:"text-muted-foreground flex items-center justify-center gap-1 text-xs",children:[e.jsxs("span",{children:[t("sendPage.from"),":"]}),e.jsxs("span",{className:"font-mono",children:[x.address.slice(0,8),"...",x.address.slice(-6)]})]})]}),N.length>1&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("sendPage.assetLabel")}),e.jsx(Fo,{selectedAsset:D,assets:N,onSelect:z,disabled:u,testId:"send-asset-selector"})]}),e.jsx(Mm,{label:t("sendPage.toAddressLabel"),value:k.toAddress,onChange:P,placeholder:t("sendPage.toAddressPlaceholder",{chain:g}),onScan:ye,onContactPicker:q,chainType:f,error:k.addressError??void 0}),e.jsx(Ko,{label:t("sendPage.amountLabel"),value:k.amount??void 0,onChange:_,balance:M??void 0,max:B,maxDisabled:$,symbol:F,error:k.amountError??void 0,fiatValue:k.amount?k.amount.toNumber().toFixed(2):void 0}),e.jsxs("div",{className:"text-muted-foreground flex items-center justify-between text-xs",children:[e.jsx("span",{children:t("sendPage.fee")}),e.jsx("span",{children:k.feeLoading?t("sendPage.feeEstimating"):k.feeAmount?`${k.feeAmount.toFormatted()} ${k.feeSymbol||F}`:t("sendPage.feeUnavailable")})]}),e.jsx(Jt,{variant:"info",children:t("sendPage.networkWarning",{chain:g})}),e.jsx("div",{className:"pt-4",children:e.jsxs(Ue,{variant:"mint",className:"w-full","data-testid":"send-continue-button",disabled:!E,onClick:se,children:[t("sendPage.continue"),e.jsx(De,{className:"-mr-4 ml-2 size-4"})]})})]})]})}function Cd(){const{goBack:t}=ce(),s=Je(),{t:n}=O(["transaction","common"]);return e.jsx(Lt,{chainId:s,fallback:e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:n("sendPage.title"),onBack:t}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Chain not supported"})})]}),children:e.jsx(Qy,{})})}Cd.__docgenInfo={description:"",methods:[],displayName:"SendPage"};const kd=({params:t})=>e.jsx(oe,{children:e.jsx(me,{params:t,children:e.jsx(Eo,{children:e.jsx(Cd,{})})})});kd.__docgenInfo={description:"",methods:[],displayName:"SendActivity"};const Ye=Ce.t.bind(Ce),lo={step:"input",asset:null,amount:null,amountError:null,recipientAddress:null,feeAmount:null,feeMinAmount:null,feeSymbol:"",feeLoading:!1,isSubmitting:!1,resultStatus:null,txHash:null,errorMessage:null},As={amount:"0.001",symbol:"BFM"};function Yy(t,s){if(!t||!s)return null;if(!t.isPositive())return Ye("error:validation.enterValidAmount");const n=s.amount;return t.gt(n)?Ye("error:validation.exceedsBalance"):null}function Xy(t={}){const{initialAsset:s,assetLocked:n=!1,useMock:a=!0,walletId:r,fromAddress:o,chainConfig:d}=t,[i,l]=c.useState({...lo,asset:s??null}),m=d?.chainKind==="bioforest",u=c.useCallback((N,b)=>Yy(N,b),[]),f=c.useCallback(N=>{l(b=>({...b,amount:N,amountError:null}))},[]),h=c.useCallback(N=>{if(l(S=>({...S,asset:N,amount:null,amountError:null,feeLoading:!0,recipientAddress:null})),a||!m||!d||!o){setTimeout(()=>{l(S=>({...S,recipientAddress:"mock_apply_address",feeAmount:re.fromFormatted(As.amount,N.decimals,As.symbol),feeMinAmount:re.fromFormatted(As.amount,N.decimals,As.symbol),feeSymbol:d?.symbol??As.symbol,feeLoading:!1}))},300);return}(async()=>{try{const S=await cd(d,N.assetType,o);if(!S){l(P=>({...P,feeLoading:!1,errorMessage:Ye("error:transaction.issuerAddressNotFound")}));return}const k=await ld(d,N.assetType,"1");l(P=>({...P,recipientAddress:S,feeAmount:k.amount,feeMinAmount:k.amount,feeSymbol:k.symbol,feeLoading:!1}))}catch(S){l(k=>({...k,feeLoading:!1,errorMessage:S instanceof Error?S.message:Ye("error:transaction.feeEstimateFailed")}))}})()},[d,o,m,a]);c.useEffect(()=>{s&&!i.recipientAddress&&h(s)},[s,h,i.recipientAddress]);const x=c.useMemo(()=>!!(i.asset&&i.amount&&i.amount.isPositive()&&i.recipientAddress&&!i.feeLoading),[i.amount,i.asset,i.recipientAddress,i.feeLoading]),y=c.useCallback(()=>{const N=u(i.amount,i.asset);return N?(l(b=>({...b,amountError:N})),!1):i.recipientAddress?(l(b=>({...b,step:"confirm",amountError:null})),!0):(l(b=>({...b,errorMessage:Ye("error:transaction.issuerAddressNotReady")})),!1)},[i.amount,i.asset,i.recipientAddress,u]),p=c.useCallback(()=>{l(N=>({...N,step:"input"}))},[]),g=c.useCallback(async N=>{if(a)return l(S=>({...S,step:"burning",isSubmitting:!0})),await new Promise(S=>setTimeout(S,1500)),l(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"success",txHash:`mock_burn_tx_${Date.now()}`})),{status:"ok",txHash:`mock_burn_tx_${Date.now()}`};if(!d||d.chainKind!=="bioforest")return l(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:Ye("error:burn.bioforestOnly")})),{status:"error",message:Ye("error:burn.bioforestOnly")};if(!r||!o||!i.asset||!i.amount||!i.recipientAddress)return l(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:Ye("error:transaction.paramsIncomplete")})),{status:"error",message:Ye("error:transaction.paramsIncomplete")};l(S=>({...S,step:"burning",isSubmitting:!0,errorMessage:null}));const b=await $n({chainConfig:d,walletId:r,password:N,fromAddress:o,recipientAddress:i.recipientAddress,assetType:i.asset.assetType,amount:i.amount,fee:i.feeAmount??void 0});return b.status==="password"?(l(S=>({...S,step:"confirm",isSubmitting:!1})),{status:"password"}):b.status==="password_required"?(l(S=>({...S,step:"confirm",isSubmitting:!1})),{status:"two_step_secret_required",secondPublicKey:b.secondPublicKey}):b.status==="error"?(l(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:b.message})),{status:"error",message:b.message}):(l(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"success",txHash:b.txHash})),{status:"ok",txHash:b.txHash})},[d,o,i.amount,i.asset,i.feeAmount,i.recipientAddress,a,r]),v=c.useCallback(async(N,b)=>{if(!d||!r||!o||!i.asset||!i.amount||!i.recipientAddress)return{status:"error",message:Ye("error:transaction.paramsIncomplete")};l(k=>({...k,step:"burning",isSubmitting:!0,errorMessage:null}));const S=await $n({chainConfig:d,walletId:r,password:N,fromAddress:o,recipientAddress:i.recipientAddress,assetType:i.asset.assetType,amount:i.amount,fee:i.feeAmount??void 0,twoStepSecret:b});return S.status==="password"?(l(k=>({...k,step:"confirm",isSubmitting:!1})),{status:"password"}):S.status==="error"?(l(k=>({...k,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:S.message})),{status:"error",message:S.message}):S.status==="password_required"?(l(k=>({...k,step:"confirm",isSubmitting:!1})),{status:"two_step_secret_required",secondPublicKey:S.secondPublicKey}):(l(k=>({...k,step:"result",isSubmitting:!1,resultStatus:"success",txHash:S.txHash})),{status:"ok",txHash:S.txHash})},[d,o,i.amount,i.asset,i.feeAmount,i.recipientAddress,r]),j=c.useCallback(()=>{l({...lo,asset:s??null})},[s]);return{state:i,setAmount:f,setAsset:h,goToConfirm:y,goBack:p,submit:g,submitWithTwoStepSecret:v,reset:j,canProceed:x,assetLocked:n}}function uo(t){return{assetType:t.symbol,name:t.name,amount:re.fromFormatted(t.balance,t.decimals??8,t.symbol),decimals:t.decimals??8,logoUrl:t.icon}}function Zy(t,s){return{symbol:t.assetType,name:t.name??t.assetType,balance:t.amount.toFormatted(),decimals:t.decimals,chain:s,icon:t.logoUrl}}function eb(){const{t}=O(["transaction","common","security"]),{goBack:s}=ce(),{push:n}=X(),a=st(),r=sn(),o=c.useRef(!1),{assetType:d,assetLocked:i}=pe(),l=Je(),m=Fe(),u=Un(),f=dt(),h=f.snapshot?He.getChainById(f,l):null,x=Ja(l),p=ns().tokenBalances.useState({address:u?.address??""},{enabled:!!u?.address}),g=c.useMemo(()=>p?.data?jd(p.data,l):[],[p?.data,l]),v=c.useMemo(()=>h?g.filter(G=>G.symbol.toUpperCase()!==h.symbol.toUpperCase()):[],[g,h]),j=c.useMemo(()=>{if(!d||v.length===0)return null;const G=v.find(Z=>Z.symbol.toUpperCase()===d.toUpperCase());return G?uo(G):null},[d,v]),N=i==="true",{state:b,setAmount:S,setAsset:k,goToConfirm:P,submit:_,submitWithTwoStepSecret:A,reset:T,canProceed:C}=Xy({initialAsset:j??void 0,assetLocked:N,useMock:!1,walletId:m?.id,fromAddress:u?.address,chainConfig:h}),I=c.useCallback(G=>{k(uo(G))},[k]),w=c.useMemo(()=>b.asset?Zy(b.asset,l):null,[b.asset,l]),E=b.asset?.amount??null,D=b.asset?.assetType??"TOKEN",z=()=>{P()&&(r.impact("light"),Wl(async()=>{o.current||(o.current=!0,await r.impact("medium"),ql(async(G,Z)=>{if(!Z){const $=await _(G);return $.status==="password"?{status:"wallet_lock_invalid"}:$.status==="two_step_secret_required"?{status:"two_step_secret_required"}:$.status==="ok"?(o.current=!1,{status:"ok",txHash:$.txHash,pendingTxId:$.pendingTxId}):$.status==="error"?{status:"error",message:$.message,pendingTxId:$.pendingTxId}:{status:"error",message:t("error:destroy.failed")}}const B=await A(G,Z);return B.status==="ok"?(o.current=!1,{status:"ok",txHash:B.txHash,pendingTxId:B.pendingTxId}):B.status==="password"?{status:"two_step_secret_invalid",message:t("error:security.passwordInvalid")}:B.status==="error"?{status:"error",message:B.message,pendingTxId:B.pendingTxId}:{status:"error",message:t("error:unknown")}}),n("TransferWalletLockJob",{title:t("security:walletLock.verifyTitle")}))},{minFee:b.feeMinAmount?.toFormatted()??b.feeAmount?.toFormatted()??"0"}),n("TransferConfirmJob",{amount:b.amount?.toFormatted()??"0",symbol:D,toAddress:b.recipientAddress??"",feeAmount:b.feeAmount?.toFormatted()??"0",feeSymbol:b.feeSymbol,feeLoading:b.feeLoading?"true":"false"}))},L=()=>{b.resultStatus==="success"&&r.impact("success"),s()},q=()=>{T()},M=c.useCallback(()=>{if(!b.txHash)return;const G=h?.explorer?.queryTx;if(!G){a.show(t("sendPage.explorerNotImplemented"));return}const Z=G.replace(":hash",b.txHash).replace(":signature",b.txHash);window.open(Z,"_blank","noopener,noreferrer")},[b.txHash,h?.explorer?.queryTx,a,t]),F=h?.chainKind==="bioforest";return!m||!u?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:t("destroyPage.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("history.noWallet")})})]}):F?b.step==="result"||b.step==="burning"?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:t("destroyPage.resultTitle")}),e.jsx(_f,{status:b.step==="burning"?"pending":b.resultStatus??"pending",amount:b.amount?.toFormatted()??"0",symbol:D,toAddress:b.recipientAddress??"",txHash:b.txHash??void 0,errorMessage:b.errorMessage??void 0,onDone:L,onRetry:b.resultStatus==="failed"?q:void 0,onViewExplorer:b.resultStatus==="success"&&h?.explorer?.queryTx?M:void 0})]}):e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:t("destroyPage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"bg-muted/50 space-y-2 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(Pt,{chain:l,size:"sm"}),e.jsx("span",{className:"text-sm font-medium",children:x})]}),u?.address&&e.jsxs("div",{className:"text-muted-foreground flex items-center justify-center gap-1 text-xs",children:[e.jsxs("span",{children:[t("sendPage.from"),":"]}),e.jsxs("span",{className:"font-mono",children:[u.address.slice(0,8),"...",u.address.slice(-6)]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("destroyPage.assetLabel")}),e.jsx(Fo,{selectedAsset:w,assets:v,onSelect:I,disabled:N,excludeAssets:h?[h.symbol]:[],testId:"destroy-asset-selector"}),v.length===0&&e.jsx("p",{className:"text-muted-foreground text-xs",children:t("destroyPage.noDestroyableAssets")})]}),b.asset&&e.jsx(Ko,{label:t("destroyPage.amountLabel"),value:b.amount??void 0,onChange:S,balance:E??void 0,symbol:D,error:b.amountError??void 0}),e.jsx(Jt,{variant:"warning",children:t("destroyPage.warning")}),b.feeAmount&&e.jsx("div",{className:"bg-muted/50 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:t("sendPage.fee")}),e.jsxs("span",{className:"font-medium",children:[b.feeAmount.toFormatted()," ",b.feeSymbol]})]})}),e.jsx("div",{className:"pt-4",children:e.jsxs(Ue,{variant:"mint",className:"w-full","data-testid":"destroy-confirm-button",disabled:!C,onClick:z,children:[e.jsx(Cn,{className:"mr-2 -ml-4 size-4"}),t("destroyPage.confirm")]})})]})]}):e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:t("destroyPage.title"),onBack:s}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx(Cn,{className:"text-muted-foreground size-16"}),e.jsx("p",{className:"text-muted-foreground text-center",children:t("destroyPage.notSupported")})]})]})}function Sd(){const{goBack:t}=ce(),s=Je(),{t:n}=O(["transaction","common"]);return e.jsx(Lt,{chainId:s,fallback:e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:n("destroyPage.title"),onBack:t}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Chain not supported"})})]}),children:e.jsx(eb,{})})}Sd.__docgenInfo={description:"",methods:[],displayName:"DestroyPage"};const Ad=({params:t})=>e.jsx(oe,{children:e.jsx(me,{params:t,children:e.jsx(Eo,{children:e.jsx(Sd,{})})})});Ad.__docgenInfo={description:"",methods:[],displayName:"DestroyActivity"};function Id(){const{t}=O(["transaction","common"]),{goBack:s}=ce(),n=dr(),a=st(),r=sn(),o=Un(),d=Je(),i=Ja(d),l=Va(),[m,u]=c.useState(!1),[f,h]=c.useState(!1),x=c.useRef(null),y=o?.address||"",p=l.username||t("common:myCard.defaultName"),g=c.useMemo(()=>y?er({name:p,addresses:[{address:y,label:i}],avatar:l.avatar}):"",[p,y,i,l.avatar]),v=async()=>{y&&(await n.write({text:y}),await r.impact("light"),u(!0),a.show(t("receivePage.addressCopied")),setTimeout(()=>u(!1),2e3))},j=c.useCallback(async()=>{const b=x.current;if(!(!b||f)){h(!0);try{const{snapdom:S}=await Tt(async()=>{const{snapdom:k}=await import("./snapdom-CO8q8LPW.js").then(P=>P.s);return{snapdom:k}},__vite__mapDeps([0,1]),import.meta.url);await S.download(b,{type:"png",filename:`receive-${d}-${y.slice(0,8)}.png`,scale:2,quality:1}),await r.impact("success"),a.show(t("receivePage.imageSaved"))}catch{}finally{h(!1)}}},[y,d,f,r,a,t]),N=c.useCallback(async()=>{const b=x.current;if(!(!b||f)){h(!0);try{if(navigator.share){const{snapdom:S}=await Tt(async()=>{const{snapdom:A}=await import("./snapdom-CO8q8LPW.js").then(T=>T.s);return{snapdom:A}},__vite__mapDeps([0,1]),import.meta.url),P=await(await S(b,{scale:2})).toBlob(),_=new File([P],`receive-${d}.png`,{type:"image/png"});await navigator.share({title:t("receivePage.shareTitle"),text:y,files:[_]}),await r.impact("success")}}catch{}finally{h(!1)}}},[y,d,f,r,t]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("receivePage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"text-muted-foreground flex items-center justify-center gap-2",children:[e.jsx(Pt,{chain:d,size:"sm"}),e.jsx("span",{className:"text-sm",children:i})]}),e.jsx("div",{ref:x,className:"flex justify-center",children:e.jsx(sr,{name:p,avatar:l.avatar,addresses:[{address:y,label:i}],qrContent:g,caption:t("common:contactCard.transferToMe")})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm font-medium",children:t("receivePage.receiveAddress")}),e.jsx("div",{className:"border-border bg-card rounded-xl border p-4",children:e.jsx(it,{address:y,copyable:!0})})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(J,{variant:"outline",className:"flex-1",onClick:v,children:m?e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"mr-2 size-4"}),t("receivePage.copied")]}):e.jsxs(e.Fragment,{children:[e.jsx(Ao,{className:"mr-2 size-4"}),t("receivePage.copyAddress")]})}),e.jsxs(J,{variant:"outline",className:"flex-1",onClick:j,disabled:f,children:[f?e.jsx(ve,{className:"mr-2 size-4 animate-spin"}):e.jsx(en,{className:"mr-2 size-4"}),t("receivePage.saveImage")]})]}),e.jsxs(Ue,{variant:"mint",className:"w-full",onClick:N,disabled:f,children:[f?e.jsx(ve,{className:"mr-2 size-4 animate-spin"}):e.jsx(Dp,{className:"mr-2 size-4"}),t("receivePage.share")]}),e.jsx(Jt,{variant:"info",children:t("receivePage.networkWarning",{chain:i})})]})]})}Id.__docgenInfo={description:"",methods:[],displayName:"ReceivePage"};const Td=()=>e.jsx(oe,{children:e.jsx(Id,{})});Td.__docgenInfo={description:"",methods:[],displayName:"ReceiveActivity"};const Pd=()=>e.jsx(oe,{children:e.jsx(Mr,{})});Pd.__docgenInfo={description:"",methods:[],displayName:"SettingsActivity"};const tb={"zh-CN":"","zh-TW":"",en:"English",ar:""};function _d(){const{goBack:t}=ce(),{t:s}=O("settings"),n=Xt(),a=r=>{qn.setLanguage(r),t()};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:s("languagePage.title"),onBack:t}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:Object.keys(Ku).map((r,o)=>e.jsxs("div",{children:[o>0&&e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsxs("button",{onClick:()=>a(r),className:R("flex w-full items-center justify-between px-4 py-3.5","hover:bg-muted/50 active:bg-muted transition-colors",r===n&&"bg-primary/5"),children:[e.jsx("span",{className:"text-sm font-medium",children:tb[r]}),r===n&&e.jsx(je,{className:"text-primary size-5"})]})]},r))}),e.jsx("p",{className:"text-muted-foreground mt-4 px-1 text-xs",children:s("languagePage.hint")})]})]})}_d.__docgenInfo={description:"",methods:[],displayName:"LanguagePage"};const Ed=()=>e.jsx(oe,{children:e.jsx(_d,{})});Ed.__docgenInfo={description:"",methods:[],displayName:"SettingsLanguageActivity"};function Md(){const{t}=O("settings"),{goBack:s}=ce(),n=jo(),a=r=>{qn.setCurrency(r),s()};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("currency.title"),onBack:s}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:Object.keys(Or).map((r,o)=>e.jsxs("div",{children:[o>0&&e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsxs("button",{onClick:()=>a(r),className:R("flex w-full items-center justify-between px-4 py-3.5","hover:bg-muted/50 active:bg-muted transition-colors",r===n&&"bg-primary/5"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-muted-foreground text-base font-semibold",children:Or[r].symbol}),e.jsx("span",{className:"text-sm font-medium",children:t(`currency.names.${r}`)})]}),r===n&&e.jsx(je,{className:"text-primary size-5"})]})]},r))}),e.jsx("p",{className:"text-muted-foreground mt-4 px-1 text-xs",children:t("currency.hint")})]})]})}Md.__docgenInfo={description:"",methods:[],displayName:"CurrencyPage"};const Rd=()=>e.jsx(oe,{children:e.jsx(Md,{})});Rd.__docgenInfo={description:"",methods:[],displayName:"SettingsCurrencyActivity"};function sb(t){const{children:s,open:n,defaultOpen:a=!1,onOpenChange:r,onOpenChangeComplete:o,actionsRef:d,handle:i,triggerId:l,defaultTriggerId:m=null}=t,u=ef(),f=!!u,h=If(()=>i?.store??new nf({open:n??a,activeTriggerId:l!==void 0?l:m,modal:!0,disablePointerDismissal:!0,nested:f,role:"alertdialog"})).current;h.useControlledProp("open",n,a),h.useControlledProp("activeTriggerId",l,m),h.useSyncedValue("nested",f),h.useContextCallback("onOpenChange",r),h.useContextCallback("onOpenChangeComplete",o);const x=h.useState("payload");tf({store:h,actionsRef:d,parentContext:u?.store.context});const y=c.useMemo(()=>({store:h}),[h]);return e.jsx(sf.Provider,{value:y,children:typeof s=="function"?s({payload:x}):s})}function Ld({...t}){return e.jsx(sb,{"data-slot":"alert-dialog",...t})}function Dd({...t}){return e.jsx(lf,{"data-slot":"alert-dialog-portal",...t})}function zd({className:t,...s}){return e.jsx(df,{"data-slot":"alert-dialog-overlay",className:R("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 bg-black/10 duration-100 supports-backdrop-filter:backdrop-blur-xs fixed inset-0 isolate z-50",t),...s})}function Od({className:t,size:s="default",...n}){return e.jsxs(Dd,{children:[e.jsx(zd,{}),e.jsx(af,{"data-slot":"alert-dialog-content","data-size":s,className:R("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 data-closed:zoom-out-95 data-open:zoom-in-95 bg-background ring-foreground/10 gap-4 rounded-xl p-4 ring-1 duration-100 data-[size=default]:max-w-xs data-[size=sm]:max-w-xs data-[size=default]:sm:max-w-sm group/alert-dialog-content fixed top-1/2 left-1/2 z-50 grid w-full -translate-x-1/2 -translate-y-1/2 outline-none",t),...n})]})}function Bd({className:t,...s}){return e.jsx("div",{"data-slot":"alert-dialog-header",className:R("grid grid-rows-[auto_1fr] place-items-center gap-1.5 text-center has-data-[slot=alert-dialog-media]:grid-rows-[auto_auto_1fr] has-data-[slot=alert-dialog-media]:gap-x-4 sm:group-data-[size=default]/alert-dialog-content:place-items-start sm:group-data-[size=default]/alert-dialog-content:text-left sm:group-data-[size=default]/alert-dialog-content:has-data-[slot=alert-dialog-media]:grid-rows-[auto_1fr]",t),...s})}function Fd({className:t,...s}){return e.jsx("div",{"data-slot":"alert-dialog-footer",className:R("bg-muted/50 -mx-4 -mb-4 rounded-b-xl border-t p-4 flex flex-col-reverse gap-2 group-data-[size=sm]/alert-dialog-content:grid group-data-[size=sm]/alert-dialog-content:grid-cols-2 sm:flex-row sm:justify-end",t),...s})}function Wd({className:t,...s}){return e.jsx(rf,{"data-slot":"alert-dialog-title",className:R("text-sm font-medium sm:group-data-[size=default]/alert-dialog-content:group-has-data-[slot=alert-dialog-media]/alert-dialog-content:col-start-2",t),...s})}function $d({className:t,...s}){return e.jsx(of,{"data-slot":"alert-dialog-description",className:R("text-muted-foreground *:[a]:hover:text-foreground text-sm text-balance md:text-pretty *:[a]:underline *:[a]:underline-offset-3",t),...s})}function qd({className:t,...s}){return e.jsx(J,{"data-slot":"alert-dialog-action",className:R(t),...s})}function Hd({className:t,variant:s="outline",size:n="default",...a}){return e.jsx(cf,{"data-slot":"alert-dialog-cancel",className:R(t),render:e.jsx(J,{variant:s,size:n}),...a})}Ld.__docgenInfo={description:"",methods:[],displayName:"AlertDialog"};qd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogAction"};Hd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogCancel",props:{variant:{defaultValue:{value:'"outline"',computed:!1},required:!1},size:{defaultValue:{value:'"default"',computed:!1},required:!1}}};Od.__docgenInfo={description:"",methods:[],displayName:"AlertDialogContent",props:{size:{required:!1,tsType:{name:"union",raw:'"default" | "sm"',elements:[{name:"literal",value:'"default"'},{name:"literal",value:'"sm"'}]},description:"",defaultValue:{value:'"default"',computed:!1}}}};$d.__docgenInfo={description:"",methods:[],displayName:"AlertDialogDescription"};Fd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogFooter"};Bd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogHeader"};zd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogOverlay"};Dd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogPortal"};Wd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogTitle"};function mo(t){if(typeof t!="object"||t===null||Array.isArray(t))return null;const s=t.id;return typeof s=="string"&&s.trim()!==""?s:null}function nb(t){try{const s=JSON.parse(t),n=Array.isArray(s)?s.map(mo):[mo(s)];return Array.from(new Set(n.filter(a=>typeof a=="string")))}catch{return[]}}function ab(t,s){switch(s){case"default":return t("chainConfig.source.default");case"subscription":return t("chainConfig.source.subscription");case"manual":return t("chainConfig.source.manual")}}function rb(t){switch(t){case"default":return"bg-muted text-muted-foreground";case"subscription":return"bg-blue-500/10 text-blue-600";case"manual":return"bg-amber-500/10 text-amber-700"}}function ib(t){const s=new Map;for(const n of t)s.set(n.id,n);return s}function Ud(){const{goBack:t}=ce(),{t:s}=O("settings"),n=st(),a=Gs(),r=tm(),o=sm(),d=nm(),i=am(),l=c.useMemo(()=>ib(o),[o]),[m,u]=c.useState("default"),[f,h]=c.useState(""),[x,y]=c.useState(!1),[p,g]=c.useState([]),v=c.useRef(null),j=c.useRef(null),N=c.useRef(!1);c.useEffect(()=>{rs.initialize()},[]),c.useEffect(()=>{r?.url&&u(r.url)},[r?.url]),c.useEffect(()=>{const A=N.current;if(N.current=d,!A||d)return;const T=v.current;if(T){if(v.current=null,i){n.show(i);return}n.show(s(`chainConfig.toast.${T}`)),T==="manualAdded"&&h("")}},[i,d,s,n]);const b=async()=>{v.current="subscriptionSaved",await rs.setSubscriptionUrl(m)},S=async()=>{v.current="subscriptionRefreshed",await rs.refreshSubscription()},k=async()=>{const A=nb(f),T=new Set(a.map(I=>I.id)),C=A.filter(I=>T.has(I));if(C.length>0){j.current=f,g(C),y(!0);return}v.current="manualAdded",await rs.addManualConfig(f)},P=()=>{j.current=null,g([]),y(!1)},_=async()=>{const A=j.current;j.current=null,g([]),y(!1),A&&(v.current="manualAdded",await rs.addManualConfig(A))};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:s("chainConfig.title"),onBack:t}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx(Ld,{open:x,onOpenChange:A=>{A?y(A):P()},children:e.jsxs(Od,{children:[e.jsxs(Bd,{children:[e.jsx(Wd,{children:s("chainConfig.manual.duplicate.title")}),e.jsx($d,{children:s("chainConfig.manual.duplicate.description")})]}),e.jsx("div",{className:"bg-muted/50 text-muted-foreground rounded-lg px-3 py-2 text-xs font-mono break-all",children:p.join(", ")}),e.jsxs(Fd,{children:[e.jsx(Hd,{onClick:P,children:s("chainConfig.manual.duplicate.cancel")}),e.jsx(qd,{onClick:_,disabled:d,children:s("chainConfig.manual.duplicate.replace")})]})]})}),i&&e.jsx("div",{className:"border-destructive/20 bg-destructive/5 text-destructive rounded-xl border px-4 py-3 text-sm",children:i}),e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:e.jsxs("div",{className:"space-y-3 px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.subscription.title")}),e.jsx("div",{className:"text-muted-foreground text-xs",children:e.jsx(Qo,{ns:"settings",i18nKey:"chainConfig.subscription.description",components:{code:e.jsx("code",{className:"font-mono"})}})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{type:"button",variant:"outline",size:"icon","data-testid":"refresh-subscription-button",onClick:S,disabled:d,"aria-label":s("chainConfig.subscription.refreshAriaLabel"),children:e.jsx(ts,{className:R("size-4",d&&"animate-spin")})}),e.jsx(J,{type:"button","data-testid":"save-subscription-button",onClick:b,disabled:d,children:s("chainConfig.subscription.save")})]})]}),e.jsx(Ve,{"data-testid":"subscription-url-input",value:m,onChange:A=>u(A.target.value),placeholder:s("chainConfig.subscription.placeholder"),disabled:d,autoCapitalize:"off",autoCorrect:"off",spellCheck:!1}),r?.lastUpdated&&e.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.subscription.lastUpdated",{value:r.lastUpdated})})]})}),e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm","data-testid":"manual-add-section",children:e.jsxs("div",{className:"space-y-3 px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.manual.title")}),e.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.manual.description")})]}),e.jsxs(J,{type:"button",variant:"outline","data-testid":"add-chain-button",onClick:k,disabled:d||f.trim()==="",children:[e.jsx(ut,{className:"size-4"}),s("chainConfig.manual.add")]})]}),e.jsx("textarea",{"data-testid":"manual-config-textarea",value:f,onChange:A=>h(A.target.value),placeholder:s("chainConfig.manual.placeholder"),rows:5,disabled:d,className:R("bg-background w-full resize-none rounded-lg border px-3 py-3 text-sm","placeholder:text-muted-foreground","focus:ring-ring focus:ring-2 focus:ring-offset-2 focus:outline-none","disabled:cursor-not-allowed disabled:opacity-50"),autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})]})}),e.jsxs("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:[e.jsxs("div",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.list.title")}),e.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.list.description")})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{children:[a.map((A,T)=>{const C=l.get(A.id),I=C?.kind==="incompatible_major",w=ab(s,A.source);return e.jsxs("div",{"data-testid":`chain-item-${A.id}`,children:[T>0&&e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate text-sm font-medium",children:A.name}),e.jsx("span",{className:R("rounded px-2 py-0.5 text-xs",rb(A.source)),children:w})]}),e.jsxs("div",{className:"text-muted-foreground mt-1 flex flex-wrap gap-x-3 gap-y-1 text-xs",children:[e.jsx("span",{className:"font-mono",children:A.id}),e.jsxs("span",{children:["v",A.version]}),e.jsx("span",{children:A.chainKind}),e.jsx("span",{children:A.symbol})]}),C?.kind==="incompatible_major"&&e.jsxs("div",{className:"mt-2 flex items-start gap-2 rounded-lg bg-amber-500/10 px-3 py-2 text-xs text-amber-800",children:[e.jsx(Oe,{className:"mt-0.5 size-4 shrink-0"}),e.jsx("div",{children:s("chainConfig.warning.incompatibleMajor",{version:C.version,supportedMajor:C.supportedMajor})})]})]}),e.jsx(Oo,{checked:A.enabled,onCheckedChange:E=>{rs.setChainEnabled(A.id,E)},disabled:d||I,className:R(I&&"cursor-not-allowed opacity-60")})]})})]},A.id)}),a.length===0&&e.jsx("div",{className:"text-muted-foreground px-4 py-8 text-center text-sm",children:s("chainConfig.list.empty")})]})]}),e.jsx("div",{className:"text-muted-foreground px-1 text-xs",children:s("chainConfig.hint")})]})]})}Ud.__docgenInfo={description:"",methods:[],displayName:"ChainConfigPage"};const Vd=()=>e.jsx(oe,{children:e.jsx(Ud,{})});Vd.__docgenInfo={description:"",methods:[],displayName:"SettingsChainsActivity"};const ob=3e4;function Jd(){const{t}=O("settings"),{goBack:s}=ce(),{push:n}=X(),a=Fe(),o=(a?.keyType??"mnemonic")==="arbitrary",[d,i]=c.useState(""),[l,m]=c.useState(!0),u=c.useRef(!1);c.useEffect(()=>{if(d.length>0&&!l){const x=setTimeout(()=>{m(!0)},ob);return()=>clearTimeout(x)}},[d.length,l]),c.useEffect(()=>{const x=()=>{document.hidden&&d.length>0&&m(!0)};return document.addEventListener("visibilitychange",x),()=>{document.removeEventListener("visibilitychange",x)}},[d.length]),c.useEffect(()=>{u.current||!a?.encryptedMnemonic||(u.current=!0,Ns(async x=>{try{const y=await fs(a.encryptedMnemonic,x);return i(y),m(!1),!0}catch{return!1}}),n("WalletLockConfirmJob",{title:t("viewMnemonic.verifyTitle"),description:t(o?"viewMnemonic.verifyDescKey":"viewMnemonic.verifyDescMnemonic")}))},[a,n,t,o]);const f=()=>{m(x=>!x)};if(!a)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t(o?"viewMnemonic.titleKey":"viewMnemonic.titleMnemonic"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("viewMnemonic.noWallet")})})]});const h=o?[]:d.trim().split(/\s+/).filter(Boolean);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t(o?"viewMnemonic.titleKey":"viewMnemonic.titleMnemonic"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"flex gap-3 rounded-xl bg-amber-500/10 p-4",children:[e.jsx(Oe,{className:"size-5 shrink-0 text-amber-500"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("p",{className:"font-medium text-amber-700 dark:text-amber-400",children:t("viewMnemonic.securityTip")}),e.jsx("p",{className:"text-muted-foreground",children:t(o?"viewMnemonic.securityWarningKey":"viewMnemonic.securityWarningMnemonic")})]})]}),d.length>0&&e.jsxs("div",{className:"bg-card space-y-4 rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:o?t("viewMnemonic.charCount",{count:d.length}):t("viewMnemonic.wordCount",{count:h.length})}),e.jsx("button",{onClick:f,className:R("flex items-center gap-1.5 rounded-full px-3 py-1.5 text-xs font-medium","bg-muted hover:bg-muted/80 transition-colors"),children:l?e.jsxs(e.Fragment,{children:[e.jsx(rr,{className:"size-3.5"}),t("viewMnemonic.show")]}):e.jsxs(e.Fragment,{children:[e.jsx(Jo,{className:"size-3.5"}),t("viewMnemonic.hide")]})})]}),o?e.jsx("textarea",{value:d,readOnly:!0,rows:4,"data-testid":"secret-textarea",className:R("bg-background w-full resize-none rounded-lg border px-3 py-3 font-mono text-sm","focus:outline-none",l?"[-webkit-text-security:disc]":"[-webkit-text-security:none]")}):e.jsx(Ho,{words:h,hidden:l}),!l&&e.jsx("p",{className:"text-muted-foreground text-center text-xs",children:t("viewMnemonic.autoHideNote")})]})]})]})}Jd.__docgenInfo={description:"",methods:[],displayName:"ViewMnemonicPage"};const Kd=()=>e.jsx(oe,{children:e.jsx(Jd,{})});Kd.__docgenInfo={description:"",methods:[],displayName:"SettingsMnemonicActivity"};function Gd(){const{t}=O("settings"),{goBack:s}=ce(),n=Fe(),[a,r]=c.useState("verify"),[o,d]=c.useState("pattern"),[i,l]=c.useState([]),[m,u]=c.useState(!1),[f,h]=c.useState(!1),x=c.useRef(null),[y,p]=c.useState([]),[g,v]=c.useState(!1),[j,N]=c.useState(null),[b,S]=c.useState(null),k=c.useCallback(()=>{x.current&&(clearTimeout(x.current),x.current=null),u(!1)},[]),P=c.useCallback(I=>{m&&I.length>0&&k(),l(I)},[m,k]),_=c.useCallback(async I=>{if(n?.encryptedMnemonic){h(!0),k();try{const w=Be(I);await Ht(n.encryptedMnemonic,w)?(l(I),r("setup")):(u(!0),l([]),x.current=setTimeout(()=>{u(!1)},1500))}catch{u(!0),l([]),x.current=setTimeout(()=>{u(!1)},1500)}finally{h(!1)}}},[n,k]),A=c.useCallback((I,w)=>{p(I),v(w),N(null)},[]),T=c.useCallback(async()=>{if(n?.encryptedWalletLock){h(!0),N(null);try{if(!So(y)){N(t("changeWalletLock.invalidMnemonic")),h(!1);return}const I=y.join(" ");await ge.verifyMnemonic(n.id,I)?(S(I),r("setup")):N(t("changeWalletLock.mnemonicVerifyFailed"))}catch{N(t("changeWalletLock.mnemonicVerifyFailed"))}finally{h(!1)}}},[n,y,t]),C=c.useCallback(async I=>{if(n)try{if(o==="mnemonic"&&b)await ge.resetWalletLockByMnemonic(n.id,b,I);else{const w=Be(i);await ge.updateWalletLock(n.id,w,I)}r("success"),setTimeout(()=>{s()},2e3)}catch{r("verify"),l([]),S(null)}},[n,o,b,i,s]);return n?a==="success"?e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("changeWalletLock.title")}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx("div",{className:"bg-green-500/10 flex size-16 items-center justify-center rounded-full",children:e.jsx(je,{className:"text-green-500 size-8"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:t("changeWalletLock.success")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:t("changeWalletLock.returning")})]})]})]}):a==="verify"?e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("changeWalletLock.title"),onBack:s}),e.jsx("div",{className:"flex-1 p-4",children:o==="pattern"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:t("changeWalletLock.verifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("changeWalletLock.verifyDesc")})]}),e.jsx(mt,{value:i,onChange:P,onComplete:_,minPoints:4,error:m,disabled:f,"data-testid":"verify-pattern-lock"}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx("button",{type:"button",onClick:()=>d("mnemonic"),className:"text-primary hover:text-primary/80 text-sm underline","data-testid":"switch-to-mnemonic",children:t("changeWalletLock.forgotPattern")})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:t("changeWalletLock.mnemonicVerifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("changeWalletLock.mnemonicVerifyDesc")})]}),e.jsx(Ef,{wordCount:12,onChange:A}),j&&e.jsx("p",{className:"text-destructive mt-4 text-center text-sm",children:j}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx(J,{onClick:T,disabled:!g||f,className:"w-full","data-testid":"verify-mnemonic-button",children:t(f?"changeWalletLock.verifying":"changeWalletLock.verifyMnemonic")}),e.jsx("button",{type:"button",onClick:()=>{d("pattern"),p([]),N(null)},className:"text-muted-foreground hover:text-foreground w-full text-center text-sm","data-testid":"switch-to-pattern",children:t("changeWalletLock.usePattern")})]})]})})]}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("changeWalletLock.title"),onBack:()=>{r("verify"),l([])}}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(ir,{onComplete:C,minPoints:4})})]}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("changeWalletLock.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("changeWalletLock.noWallet")})})]})}Gd.__docgenInfo={description:"",methods:[],displayName:"ChangeWalletLockPage"};const Qd=()=>e.jsx(oe,{children:e.jsx(Gd,{})});Qd.__docgenInfo={description:"",methods:[],displayName:"SettingsWalletLockActivity"};function cb({targetChain:t,address:s,filter:n,setFilter:a,walletId:r,decimals:o}){const{navigate:d,goBack:i}=ce(),l=Qs(),{t:m}=O(["transaction","common"]),u=ns(),{data:f,isLoading:h,isFetching:x,error:y,refetch:p}=u.transactionHistory.useState({address:s,limit:50},{enabled:!!s}),g=Ra(y,m),{transactions:v,deleteTransaction:j,retryTransaction:N}=ko(r,t,s,f),b=c.useMemo(()=>{if(!f)return[];const C=n.period;if(!C||C==="all")return f;const I=C==="7d"?7:C==="30d"?30:90,w=Date.now()-I*24*60*60*1e3;return f.filter(E=>E.timestamp>=w)},[f,n.period]),S=c.useMemo(()=>[{value:"all",label:m("history.filter.allTime")},{value:"7d",label:m("history.filter.days7")},{value:"30d",label:m("history.filter.days30")},{value:"90d",label:m("history.filter.days90")}],[m]),k=c.useMemo(()=>[{value:"all",label:m("history.filter.allChains")},...l.map(C=>({value:C.id,label:C.name}))],[m,l]),P=c.useCallback(C=>{if(!C.id)return;const I=f?.find(E=>E.hash===C.hash),w=I?Kt.stringify(I):void 0;d({to:`/transaction/${C.id}`,search:{txData:w}})},[d,f]),_=c.useCallback(C=>{a(I=>({...I,chain:C}))},[a]),A=c.useCallback(C=>{a(I=>({...I,period:C}))},[a]),T=c.useCallback(async()=>{await p?.()},[p]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:m("transaction:history.title"),onBack:i,rightAction:e.jsx("button",{onClick:T,disabled:x,className:R("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80",x&&"animate-spin"),"aria-label":m("common:a11y.refresh"),children:e.jsx(ts,{className:"size-5"})})}),e.jsxs("div",{className:"bg-card border-b px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(rc,{className:"text-muted-foreground size-4"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:m("history.filter.chainLabel")}),e.jsxs(Os,{value:n.chain||"all",onValueChange:C=>_(C),children:[e.jsx(Bs,{size:"sm","aria-label":m("common:a11y.selectChain"),children:e.jsx(Fs,{children:k.find(C=>C.value===(n.chain||"all"))?.label})}),e.jsx(Ws,{children:k.map(C=>e.jsx(Gt,{value:C.value,children:C.label},C.value))})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:m("history.filter.periodLabel")}),e.jsxs(Os,{value:n.period||"all",onValueChange:C=>A(C),children:[e.jsx(Bs,{size:"sm","aria-label":m("common:a11y.selectPeriod"),children:e.jsx(Fs,{children:S.find(C=>C.value===(n.period||"all"))?.label})}),e.jsx(Ws,{children:S.map(C=>e.jsx(Gt,{value:C.value,children:C.label},C.value))})]})]})]}),e.jsx("p",{className:"text-muted-foreground mt-2 text-xs",children:m("transaction:history.totalRecords",{count:b.length})})]}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[v.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-muted-foreground text-xs font-medium uppercase tracking-wider px-1",children:m("pendingTx.title")}),e.jsx("div",{className:"space-y-1",children:v.map(C=>{const I=yl(C,o);return e.jsx(Po,{transaction:I,onClick:()=>d({to:`/pending-tx/${C.id}`}),onRetry:C.status==="failed"?()=>N(C):void 0,onDelete:()=>j(C)},C.id)})})]}),(g.limited||!g.supported)&&!h&&e.jsx(Dm,{type:g.limited?"limited":"notSupported",feature:m("home:wallet.transactionHistory"),reason:g.reason,className:"mb-4"}),e.jsx(Yo,{transactions:jl(b??[],t),loading:h,onTransactionClick:P,emptyTitle:m("transaction:history.emptyTitle"),emptyDescription:m("transaction:history.emptyDesc"),showChainIcon:!0})]})]})}function Yd({initialChain:t}){const{goBack:s}=ce(),n=Fe(),a=Je(),{t:r}=O(["transaction","common"]),o=dt(),[d,i]=c.useState({chain:t??a,period:"all"}),l=d.chain==="all"?a:d.chain,m=o.snapshot?He.getChainById(o,l??""):void 0,f=n?.chainAddresses?.find(h=>h.chain===l)?.address??"";return n?e.jsx(Lt,{chainId:l,fallback:e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:r("transaction:history.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Chain not supported"})})]}),children:e.jsx(cb,{targetChain:l,address:f,filter:d,setFilter:i,walletId:n.id,decimals:m?.decimals??8})}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:r("transaction:history.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:r("transaction:history.noWallet")})})]})}Yd.__docgenInfo={description:"",methods:[],displayName:"TransactionHistoryPage",props:{initialChain:{required:!1,tsType:{name:"union",raw:"ChainType | 'all' | undefined",elements:[{name:"ChainType"},{name:"literal",value:"'all'"},{name:"undefined"}]},description:""}}};const Xd=()=>{const t=eh();return e.jsx(oe,{children:e.jsx(Yd,{initialChain:t.chain})})};Xd.__docgenInfo={description:"",methods:[],displayName:"HistoryActivity"};const lb={transfer:"send",swap:"swap",exchange:"exchange",approve:"approve",signature:"signature",stake:"stake",unstake:"unstake",mint:"mint",burn:"destroy",gift:"gift",grab:"grab",trust:"trust",signFor:"signFor",emigrate:"emigrate",immigrate:"immigrate",issueAsset:"issueAsset",increaseAsset:"increaseAsset",destroyAsset:"destroy",issueEntity:"issueEntity",destroyEntity:"destroyEntity",locationName:"locationName",dapp:"dapp",certificate:"certificate",mark:"mark",contract:"interaction",unknown:"other",revoke:"approve",claim:"receive"};function db(t,s){const n=t.action,a=t.direction,r=n==="transfer"?a==="in"?"receive":"send":lb[n]??"other",o=t.assets[0],d=o.assetType==="nft"?"1":o.value,i=o.assetType==="nft"?0:o.decimals,l=o.assetType==="nft"?"NFT":o.symbol,m=a==="in"?t.from:t.to;return{hash:t.hash,from:t.from,to:t.to,address:m,timestamp:t.timestamp,status:t.status,type:r,direction:a,amount:re.fromRaw(d,i,l),symbol:l,chain:s,assets:t.assets,fee:t.fee?re.fromRaw(t.fee.value,t.fee.decimals,t.fee.symbol):void 0,contract:t.contract,blockNumber:t.blockNumber}}function fo(t){return!t||t.assetType==="nft"?null:{value:t.value,decimals:t.decimals,symbol:t.symbol}}function ub(t){if(!t)return null;const[s,n]=t.split("--");return!s||!n?null:{chainId:s,hash:n}}function mb({hash:t,chainId:s,txData:n,onBack:a}){const{t:r}=O(["transaction","common"]),o=dt(),d=ns(),i=c.useMemo(()=>n?Kt.parse(n):null,[n]),{data:l,isLoading:m,error:u}=d.transaction.useState({txHash:t},{enabled:!!t}),f=l??i,h=c.useMemo(()=>f?db(f,s):null,[f,s]),x=c.useMemo(()=>{const z=h?.chain??s;return z?He.getChainById(o,z):null},[o,s,h?.chain]),y=c.useMemo(()=>{const z=x?.explorer?.queryTx;return!z||!t?null:z.replace(":signature",t)},[x?.explorer?.queryTx,t]),p=c.useCallback(()=>{y&&window.open(y,"_blank","noopener,noreferrer")},[y]),[g,v]=c.useState(!1),j=c.useCallback(async()=>{y&&(await Qa.write({text:y}),v(!0),setTimeout(()=>v(!1),2e3))},[y]);if(m&&!i)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:r("detail.title"),onBack:a}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx(ea,{className:"h-48"}),e.jsx(ea,{className:"h-64"}),e.jsx(ea,{className:"h-32"})]})]});if(u instanceof Sm)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:r("detail.title"),onBack:a}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx("div",{className:"bg-card flex items-center justify-center rounded-xl p-6 shadow-sm",children:e.jsx("p",{className:"text-muted-foreground",children:r("detail.invalidData")})}),t&&e.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:r("detail.hash")}),e.jsx(Fr,{text:t,className:"text-muted-foreground text-xs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:p,disabled:!y,className:R("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:[e.jsx(wa,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.openInExplorer")})]}),e.jsx("button",{onClick:j,disabled:!y,className:R("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:g?e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"text-green-500 size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.copied")})]}):e.jsxs(e.Fragment,{children:[e.jsx($s,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.share")})]})})]})]})]})]});if(!h)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:r("detail.title"),onBack:a}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:r("detail.notFound")})})]});const N=h.type,b=Im(N),S=b.Icon,k=h.type==="swap"?h.assets?.[0]:void 0,P=h.type==="swap"?h.assets?.[1]:void 0,_=fo(k),A=fo(P),T=h.contract?.address||h.to,C=h.contract?.method,I=h.contract?.methodId,w=C?r(`method.${C}`,{defaultValue:C}):null,E=_?re.fromRaw(_.value,_.decimals,_.symbol):null,D=A?re.fromRaw(A.value,A.decimals,A.symbol):null;return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:r("detail.title"),onBack:a}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"bg-card flex flex-col items-center gap-3 rounded-xl p-6 shadow-sm",children:[e.jsx("div",{className:R("flex size-16 items-center justify-center rounded-full",b.bg),children:e.jsx(S,{className:R("size-8",b.color)})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:r(`type.${h.type}`,{defaultValue:h.type})}),h.type==="swap"&&E&&D?e.jsxs("div",{className:R("flex items-center justify-center gap-2",b.color),children:[e.jsx(jt,{value:E.toNumber(),symbol:E.symbol,decimals:E.decimals,sign:"never",color:"default",weight:"normal",size:"lg"}),e.jsx("span",{className:"text-lg",children:""}),e.jsx(jt,{value:D.toNumber(),symbol:D.symbol,decimals:D.decimals,sign:"never",color:"default",weight:"normal",size:"lg"})]}):e.jsx(jt,{value:h.type==="send"?-Math.abs(h.amount.toNumber()):h.amount.toNumber(),symbol:h.symbol,sign:b.amountSign,color:"default",weight:"normal",size:"xl",className:b.color})]}),e.jsx(Mf,{status:Tm(h.status).badgeStatus,label:r(`transaction:status.${h.status}`)})]}),e.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:r("detail.info")}),h.from&&h.to?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.fromAddress")}),e.jsx(it,{address:h.from,copyable:!0,className:"text-sm"})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.toAddress")}),e.jsx(it,{address:h.to,copyable:!0,className:"text-sm"})]})]}):e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:h.type==="send"?r("detail.toAddress"):r("detail.fromAddress")}),e.jsx(it,{address:h.address,copyable:!0,className:"text-sm"})]}),e.jsx("div",{className:"bg-border h-px"}),h.type==="swap"&&(_||A)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.swapFrom")}),e.jsx("span",{className:"text-sm font-medium",children:_?e.jsx(jt,{value:re.fromRaw(_.value,_.decimals,_.symbol).toNumber(),symbol:_.symbol,decimals:_.decimals,sign:"never",color:"default",size:"sm"}):"-"})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.swapTo")}),e.jsx("span",{className:"text-sm font-medium",children:A?e.jsx(jt,{value:re.fromRaw(A.value,A.decimals,A.symbol).toNumber(),symbol:A.symbol,decimals:A.decimals,sign:"never",color:"default",size:"sm"}):"-"})]}),e.jsx("div",{className:"bg-border h-px"})]}),(h.type==="approve"||h.type==="interaction"||h.type==="swap")&&T&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.contractAddress")}),e.jsx(it,{address:T,copyable:!0,className:"text-sm"})]}),(h.type==="approve"||h.type==="interaction")&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.method")}),e.jsx("span",{className:"text-sm font-medium font-mono",children:w||I||r("common:unknown")})]}),h.type==="approve"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.spender")}),e.jsx("span",{className:"text-sm font-medium",children:r("common:unknown")})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.allowance")}),e.jsx("span",{className:"text-sm font-medium",children:r("common:unknown")})]})]})]}),e.jsx("div",{className:"bg-border h-px"})]}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.time")}),e.jsx(Rm,{value:h.timestamp,format:"datetime",className:"text-sm"})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.network")}),e.jsx("span",{className:"text-sm font-medium capitalize",children:h.chain})]}),h.fee&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.fee")}),e.jsx(Za,{amount:h.fee?.toNumber?.()??0,symbol:h.fee?.symbol??"",className:"text-sm"})]})]}),h.blockNumber&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.blockHeight")}),e.jsx("span",{className:"text-sm font-medium",children:h.blockNumber.toLocaleString()})]})]}),h.confirmations!==void 0&&h.confirmations>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.confirmations")}),e.jsx("span",{className:"text-sm font-medium",children:h.confirmations})]})]})]}),t&&e.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:r("detail.hash")}),e.jsx(Fr,{text:t,className:"text-muted-foreground text-xs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:p,disabled:!y,className:R("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:[e.jsx(wa,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.openInExplorer")})]}),e.jsx("button",{onClick:j,disabled:!y,className:R("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:g?e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"text-green-500 size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.copied")})]}):e.jsxs(e.Fragment,{children:[e.jsx($s,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.share")})]})})]})]})]})]})}function Zd(){const{t}=O(["transaction","common"]),{goBack:s}=ce(),{txId:n,txData:a}=pe(),r=Fe(),o=c.useMemo(()=>ub(n),[n]),d=c.useCallback(()=>{s()},[s]);return r?o?e.jsx(Lt,{chainId:o.chainId,fallback:e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("detail.title"),onBack:d}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Chain not supported"})})]}),children:e.jsx(mb,{hash:o.hash,chainId:o.chainId,txData:a,onBack:d})}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("detail.title"),onBack:d}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("detail.notFound")})})]}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("detail.title"),onBack:d}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("history.noWallet")})})]})}Zd.__docgenInfo={description:"",methods:[],displayName:"TransactionDetailPage"};const eu=({params:t})=>e.jsx(oe,{children:e.jsx(me,{params:t,children:e.jsx(Zd,{})})});eu.__docgenInfo={description:"",methods:[],displayName:"TransactionDetailActivity"};const fb=150;function tu({onScan:t,className:s}){const{t:n}=O("scanner"),{t:a}=O("common"),{navigate:r,goBack:o}=ce(),{push:d}=X(),i=lc(),l=c.useRef(null),m=c.useRef(null),u=c.useRef(null),f=c.useRef(null),h=c.useRef(!1),x=c.useRef(null),y=c.useRef(t),[p,g]=c.useState("idle"),[v,j]=c.useState(null),[N,b]=c.useState(!1);c.useEffect(()=>{y.current=t},[t]);const S=c.useCallback(I=>{if(I===x.current)return;x.current=I,g("success"),h.current=!1,"vibrate"in navigator&&navigator.vibrate(100);const w=$o(I);if(y.current)y.current(I,w);else switch(w.type){case"address":case"payment":r({to:"/send",search:{address:w.address,chain:w.chain,amount:w.type==="payment"?w.amount:void 0}});break;case"deeplink":r({to:w.path,search:w.params});break;case"contact":d("ContactAddConfirmJob",{name:w.name,addresses:JSON.stringify(w.addresses),memo:w.memo,avatar:w.avatar});break;case"unknown":r({to:"/send",search:{address:w.content}});break}},[r,d]),k=c.useCallback(()=>{if(h.current)return;h.current=!0,m.current||(m.current=document.createElement("canvas"));const I=async()=>{if(!(!h.current||!l.current||!f.current)){try{const w=await f.current.scanFromVideo(l.current,m.current??void 0);if(w){S(w.content);return}}catch{}h.current&&setTimeout(I,fb)}};I()},[S]),P=c.useCallback(()=>{h.current=!1,u.current&&(u.current.getTracks().forEach(I=>I.stop()),u.current=null)},[]),_=c.useCallback(async()=>{P(),g("requesting"),x.current=null;try{if(!await i.checkPermission()&&!await i.requestPermission()){g("denied");return}const w=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});u.current=w,l.current&&(l.current.srcObject=w,await l.current.play(),k()),g("scanning")}catch(I){g("error"),j(I instanceof Error?I.message:"Camera initialization failed")}},[i,k,P]);c.useEffect(()=>(f.current=qo({useWorker:!0}),_(),()=>{P(),f.current?.destroy(),f.current=null}),[]);const A=c.useCallback(()=>{P(),o()},[P,o]),T=c.useCallback(()=>{const I=document.createElement("input");I.type="file",I.accept="image/*",I.onchange=async w=>{const E=w.target.files?.[0];if(E)try{const D=new Image,z=URL.createObjectURL(E);D.onload=async()=>{URL.revokeObjectURL(z);const L=document.createElement("canvas");L.width=D.width,L.height=D.height;const q=L.getContext("2d");if(!q||!f.current){j(n("noQrFound")),g("error");return}q.drawImage(D,0,0);const M=await f.current.scanFromCanvas(L);M?S(M.content):(j(n("noQrFound")),g("error"))},D.onerror=()=>{URL.revokeObjectURL(z),j(n("noQrFound")),g("error")},D.src=z}catch{j(n("noQrFound")),g("error")}},I.click()},[S,n]),C=c.useCallback(async()=>{if(u.current){const I=u.current.getVideoTracks()[0];if(I)try{await I.applyConstraints({advanced:[{torch:!N}]}),b(!N)}catch{}}},[N]);return e.jsxs("div",{className:R("relative flex h-screen flex-col bg-black",s),children:[e.jsxs("div",{className:"absolute top-0 right-0 left-0 z-10 flex items-center justify-between p-4",children:[e.jsx(J,{variant:"ghost",size:"icon","data-testid":"back-button",onClick:A,className:"text-white","aria-label":a("a11y.back"),children:e.jsx(tn,{className:"size-6"})}),e.jsx("h1",{"data-testid":"page-title",className:"text-lg font-medium text-white",children:n("title")}),e.jsx(J,{variant:"ghost",size:"icon",onClick:C,className:R("text-white",N&&"text-yellow-400"),"aria-label":n(N?"flashOff":"flashOn"),children:e.jsx(nc,{className:"size-6"})})]}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("video",{ref:l,className:R("absolute inset-0 size-full object-cover",p!=="scanning"&&p!=="success"&&"invisible"),playsInline:!0,muted:!0}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"relative size-64",children:[e.jsx("div",{className:R("absolute top-0 left-0 size-8 border-t-4 border-l-4",p==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:R("absolute top-0 right-0 size-8 border-t-4 border-r-4",p==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:R("absolute bottom-0 left-0 size-8 border-b-4 border-l-4",p==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:R("absolute right-0 bottom-0 size-8 border-r-4 border-b-4",p==="success"?"border-green-500":"border-primary")}),p==="scanning"&&e.jsx("div",{className:"animate-scan bg-primary absolute right-2 left-2 h-0.5"})]})}),e.jsxs("div",{className:"absolute inset-x-0 bottom-32 text-center",children:[p==="idle"&&e.jsx("p",{className:"text-white/80",children:n("initializing")}),p==="requesting"&&e.jsx("p",{className:"text-white/80",children:n("requestingPermission")}),p==="scanning"&&e.jsx("p",{className:"text-white/80",children:n("scanPrompt")}),p==="success"&&e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-green-400",children:n("scanSuccess")})}),p==="denied"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-red-400",children:n("permissionDenied")}),e.jsx(J,{variant:"outline","data-testid":"retry-button",onClick:_,children:n("retry")})]}),p==="error"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-red-400",children:v||n("error")}),e.jsx(J,{variant:"outline","data-testid":"retry-button",onClick:_,children:n("retry")})]})]})]}),e.jsxs("div",{className:"absolute inset-x-0 bottom-0 flex justify-center gap-8 pb-8",children:[e.jsxs(J,{variant:"ghost",size:"lg","data-testid":"gallery-button",onClick:T,className:"flex flex-col items-center text-white",children:[e.jsx(ec,{className:"mb-1 size-6"}),e.jsx("span",{className:"text-xs",children:n("gallery")})]}),e.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-white/20",children:e.jsx(np,{className:"size-8 text-white"})}),e.jsx("div",{className:"w-16"})," "]})]})}tu.__docgenInfo={description:"",methods:[],displayName:"ScannerPage",props:{onScan:{required:!1,tsType:{name:"union",raw:"((content: string, parsed: ParsedQRContent) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:"Callback when QR code is scanned"},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"Custom class name"}}};const su=()=>e.jsx(oe,{children:e.jsx(tu,{})});su.__docgenInfo={description:"",methods:[],displayName:"ScannerActivity"};const pb=300*1e3;function nu(t){if(t)return t}function hb(t){return t.map(s=>({id:s.id,name:s.name,address:s.address,balance:""}))}function xb(t,s,n){const a=new Map;for(const r of t)for(const o of r.chainAddresses){const d=nu(o.chain);if(!d)continue;const i=a.get(d)??[];i.push({address:o.address,isDefault:r.id===s}),a.set(d,i)}return Array.from(a.entries()).map(([r,o])=>({chain:r,name:n[r]??r,addresses:o.map(d=>({address:d.address,isDefault:d.isDefault}))}))}function po(t){const s=t?.trim().toLowerCase();return s==="true"||s==="1"}function au(){const{t}=O("authorize"),{t:s}=O("common"),{navigate:n,goBack:a}=ce(),{push:r}=X(),o=st(),{id:d,type:i,chainName:l,signMessage:m,getMain:u}=pe(),f=Ae(Le,W=>W.currentWalletId),h=Ae(Le,W=>W.wallets),x=Ae(Le,Ks.getCurrentWallet),y=Zt(),[p,g]=c.useState(null),[v,j]=c.useState(null),[N,b]=c.useState(!1),S=c.useMemo(()=>hb(h),[h]),k=x?.id??h[0]?.id,[P,_]=c.useState(k),A=c.useMemo(()=>nu(l),[l]),[T,C]=c.useState(A);c.useEffect(()=>C(A),[A]);const[I,w]=c.useState(void 0),[E,D]=c.useState(()=>new Set(h.map(W=>W.id))),[z,L]=c.useState(!1);c.useEffect(()=>{_(k)},[k]),c.useEffect(()=>{D(new Set(h.map(W=>W.id)))},[h]);const q=c.useMemo(()=>{const W=["viewAddress","viewPublicKey"];return m?.trim()&&W.push("signMessage"),po(u)&&W.push("getMain"),W},[u,m]),M=c.useMemo(()=>new Up(qs,d),[d]),F=c.useMemo(()=>!!m?.trim(),[m]),G=c.useMemo(()=>po(u),[u]),Z=F||G;c.useEffect(()=>{let W=!1;async function ee(){j(null);try{const le=await qs.getCallerAppInfo(d);if(W)return;g(le)}catch{if(W)return;j(t("error.authFailed"))}}return ee(),()=>{W=!0}},[d,t]),c.useEffect(()=>{const W=window.setTimeout(()=>{(async()=>(await M.reject("timeout"),o.show({message:t("error.timeout"),position:"center"}),n({to:"/"})))()},pb);return()=>{window.clearTimeout(W)}},[M,n,t,o]);const B=c.useMemo(()=>P?h.find(W=>W.id===P)??null:null,[P,h]),$=c.useMemo(()=>xb(h,f,y),[y,f,h]),ye=c.useMemo(()=>x?x.chainAddresses.map(W=>W.chain):[],[x]),se=c.useMemo(()=>{if(!(!x||!T))return x.chainAddresses.find(W=>W.chain===T)?.address},[x,T]);c.useEffect(()=>{i==="network"&&(T||C($[0]?.chain))},[$,T,i]);const U=c.useMemo(()=>h.length===0?!1:i==="main"?!!B:i==="network"?T?($.find(W=>W.chain===T)?.addresses.length??0)>0:!1:E.size>0,[$,T,B,E.size,i,h.length]),H=c.useCallback(()=>{a()},[a]),Q=c.useCallback(async()=>{if(!N){b(!0);try{await M.reject("rejected"),n({to:"/"})}finally{b(!1)}}},[M,N,n]),te=c.useCallback(async()=>{if(!(!U||N)){if(Z){Ns(async W=>{b(!0);try{const ee=m?.trim()??"";let le=[],be=[];if(i==="main"){if(!B)return!1;le=M.handleMainAddresses(B),be=[B]}else if(i==="network"){if(!T)return!1;le=M.handleNetworkAddresses(h,T),be=h}else{const he=h.filter(_e=>E.has(_e.id));le=M.handleAllAddresses(he),be=he}return le=await M.applySensitiveOptions(le,be,{password:W,signMessage:ee,getMain:G}),await M.approve(le),n({to:"/"}),!0}catch{return!1}finally{b(!1)}}),r("WalletLockConfirmJob",{title:t("passwordConfirm.title")});return}b(!0);try{let W=[];if(i==="main"){if(!B)return;W=M.handleMainAddresses(B)}else if(i==="network"){if(!T)return;W=M.handleNetworkAddresses(h,T)}else{const ee=h.filter(le=>E.has(le.id));W=M.handleAllAddresses(ee)}await M.approve(W),n({to:"/"})}finally{b(!1)}}},[M,U,N,n,Z,G,r,T,B,E,m,t,i,h]);return i==="network"&&l&&!A?e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(K,{title:t("title.address"),onBack:H}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-destructive",children:t("error.unknownChain")}),e.jsx("div",{className:"mt-4",children:e.jsx(J,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]}):v?e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(K,{title:t("title.address"),onBack:H}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-destructive",children:v}),e.jsx("div",{className:"mt-4",children:e.jsx(J,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]}):e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(K,{title:t("title.address"),onBack:H}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[p&&e.jsx(Xo,{appInfo:p}),e.jsx("div",{className:"px-1 text-sm text-foreground",children:t("address.shareWith")}),e.jsx(Rf,{permissions:q}),e.jsx("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:[i==="main"&&t("address.scope.main"),i==="network"&&t("address.scope.network",{chainName:(T?y[T]:void 0)??T??""}),i==="all"&&t("address.scope.all")]})}),e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[i==="main"&&e.jsx(Lf,{wallets:S,...P?{selectedId:P}:{},onSelect:W=>_(W.id)}),i==="network"&&x&&T&&e.jsx("div",{className:"flex w-full aspect-[1.6/1] items-stretch",children:e.jsx(Co,{wallet:x,chain:T,chainName:y[T]??T,address:se,priority:"low",onOpenChainSelector:A?void 0:()=>L(!0)})}),i==="all"&&e.jsxs("div",{className:"space-y-2",children:[h.length===0&&e.jsx("div",{className:"py-6 text-center text-sm text-muted-foreground",children:t("address.noWallets")}),h.map(W=>{const ee=E.has(W.id);return e.jsxs("button",{type:"button",onClick:()=>{D(le=>{const be=new Set(le);return be.has(W.id)?be.delete(W.id):be.add(W.id),be})},className:R("flex w-full items-center justify-between rounded-lg border px-3 py-2 text-left transition-colors","hover:bg-muted/50",ee?"border-primary bg-primary/5":"border-border bg-background"),"aria-pressed":ee,children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-medium",children:W.name}),e.jsx("div",{className:"truncate font-mono text-xs text-muted-foreground",children:W.address})]}),e.jsx("div",{className:R("flex size-5 items-center justify-center rounded border",ee?"border-primary bg-primary text-primary-foreground":"border-border bg-background"),"aria-hidden":"true",children:ee?"":""})]},W.id)})]})]})]}),e.jsx("div",{className:"sticky bottom-0 border-t border-border bg-background p-4 safe-area-inset-bottom",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(J,{type:"button",variant:"outline",className:"flex-1",onClick:Q,disabled:N,children:t("button.reject")}),e.jsx(J,{type:"button",className:"flex-1",onClick:te,disabled:!U||N,children:t("button.approve")})]})}),z&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/50",onClick:()=>L(!1),children:e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-background rounded-t-2xl",onClick:W=>W.stopPropagation(),children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("address.selectNetwork")})}),e.jsx("div",{className:"max-h-[60vh] space-y-2 overflow-y-auto p-4",children:ye.map(W=>{const ee=x?.chainAddresses.find(le=>le.chain===W);return e.jsxs("button",{onClick:()=>{C(W),L(!1)},className:R("flex w-full items-center gap-3 rounded-xl p-4 transition-colors",W===T?"bg-primary/10 ring-1 ring-primary":"bg-muted/50 hover:bg-muted"),children:[e.jsx(Pt,{chain:W,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:y[W]??W}),e.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:ee?.address?gb(ee.address):"---"})]}),W===T&&e.jsx(je,{className:"size-5 text-primary"})]},W)})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})]})}function gb(t,s=10,n=8){return t.length<=s+n+3?t:`${t.slice(0,s)}...${t.slice(-n)}`}au.__docgenInfo={description:"",methods:[],displayName:"AddressAuthPage"};const ru=({params:t})=>e.jsx(oe,{children:e.jsx(me,{params:t,children:e.jsx(au,{})})});ru.__docgenInfo={description:"",methods:[],displayName:"AuthorizeAddressActivity"};const vb=300*1e3;function ho(t){return typeof t=="object"&&t!==null}function Xe(t,s){const n=t[s];if(typeof n=="string")return n;if(typeof n=="number"&&Number.isFinite(n))return String(n)}function yb(t,s,n){const a=Xe(t,s)?.trim();return a?{ok:!0,value:a}:{ok:!1,error:`signaturedata missing field: ${n}`}}function Ot(t,s){for(const n of s){const a=Xe(t,n.key)?.trim();if(a)return{ok:!0,value:a}}return{ok:!1,error:`signaturedata missing field: ${s.map(n=>n.label).join(" / ")}`}}function bb(t){if(typeof t=="string"){const s=t.trim().toLowerCase();return s==="message"?{ok:!0,value:"message"}:s==="transfer"?{ok:!0,value:"transfer"}:s==="destroy"||s==="destory"?{ok:!0,value:"destory"}:{ok:!1,error:`Unsupported signature type: ${t}`}}return typeof t=="number"&&Number.isInteger(t)?t===0?{ok:!0,value:"message"}:t===1?{ok:!0,value:"transfer"}:t===7?{ok:!0,value:"destory"}:{ok:!1,error:`Unsupported signature type: ${t}`}:{ok:!1,error:"signaturedata.type must be string or number"}}function jb(t){if(t===void 0||t.trim()==="")return{ok:!1,error:"Missing signaturedata parameter"};let s;try{s=JSON.parse(t)}catch{return{ok:!1,error:"signaturedata is not valid JSON"}}if(!Array.isArray(s))return{ok:!1,error:"signaturedata must be a JSON array"};if(s.length===0)return{ok:!1,error:"signaturedata cannot be an empty array"};const n=s[0];if(!ho(n))return{ok:!1,error:"signaturedata[0] must be an object"};const a=bb(n.type);if(!a.ok)return a;const r=Ot(n,[{key:"chainName",label:"chainName"},{key:"chain",label:"chain"}]);if(!r.ok)return r;const o=r.value;if(a.value==="message"){const d=Ot(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!d.ok)return d;const i=yb(n,"message","message");return i.ok?{ok:!0,item:{type:"message",payload:{chainName:o,senderAddress:d.value,message:i.value}}}:i}if(a.value==="transfer"){const d=Ot(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!d.ok)return d;const i=Ot(n,[{key:"receiveAddress",label:"receiveAddress"},{key:"to",label:"to"}]);if(!i.ok)return i;const l=Ot(n,[{key:"balance",label:"balance"},{key:"amount",label:"amount"}]);if(!l.ok)return l;const m=Xe(n,"fee")?.trim(),u=Xe(n,"assetType")?.trim();let f;const h=n.contractInfo;if(ho(h)){const x=Xe(h,"assetType")?.trim(),y=h.decimals,p=Xe(h,"contractAddress")?.trim(),g=typeof y=="number"&&Number.isFinite(y)?y:typeof y=="string"&&y.trim()!==""?Number(y):void 0;x&&p&&typeof g=="number"&&Number.isFinite(g)&&(f={assetType:x,contractAddress:p,decimals:g})}return{ok:!0,item:{type:"transfer",payload:{chainName:o,senderAddress:d.value,receiveAddress:i.value,balance:l.value,...m?{fee:m}:{},...u?{assetType:u}:{},...f?{contractInfo:f}:{}}}}}{const d=Ot(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!d.ok)return d;const i=Ot(n,[{key:"destoryAmount",label:"destoryAmount"},{key:"amount",label:"amount"}]);if(!i.ok)return i;const l=Xe(n,"destoryAddress")?.trim()??Xe(n,"to")?.trim()??d.value,m=Xe(n,"fee")?.trim(),u=Xe(n,"assetType")?.trim();return{ok:!0,item:{type:"destory",payload:{chainName:o,senderAddress:d.value,destoryAddress:l,destoryAmount:i.value,...m?{fee:m}:{},...u?{assetType:u}:{}}}}}}function Nb(t){return typeof t=="object"&&t!==null&&"senderAddress"in t&&"receiveAddress"in t&&"balance"in t}function wb(t){return typeof t=="object"&&t!==null&&"senderAddress"in t&&"message"in t&&!("receiveAddress"in t)}function Cb(t){return typeof t=="object"&&t!==null&&"senderAddress"in t&&"destoryAddress"in t&&"destoryAmount"in t}function xo(t){return t.contractInfo?.assetType?t.contractInfo.assetType.toUpperCase():t.assetType?t.assetType.toUpperCase():{ethereum:"ETH",bitcoin:"BTC",tron:"TRX",binance:"BNB",bsc:"BNB"}[t.chainName?.toLowerCase()??""]??"TOKEN"}function kb(t,s,n){const a=parseFloat(t)||0,r=parseFloat(s)||0,o=parseFloat(n??"0")||0,d=r+o;return{sufficient:a>=d,required:d.toString()}}function iu(){const{t}=O("authorize"),{t:s}=O("common"),{navigate:n,goBack:a}=ce(),{push:r}=X(),o=st(),{id:d,signaturedata:i}=pe(),l=Ae(Le,Ks.getCurrentWallet),[m,u]=c.useState(null),[f,h]=c.useState(null),[x,y]=c.useState(null),[p,g]=c.useState(!1),v=c.useMemo(()=>new dc(qs,d),[d]);c.useEffect(()=>{let C=!1;async function I(){y(null);try{const w=jb(i);if(!w.ok){y(w.error);return}const E=await qs.getCallerAppInfo(d);if(C)return;u(E);const D={eventId:d,type:w.item.type,payload:w.item.payload,appName:E.appName,appHome:E.origin,appLogo:E.appIcon};h(D)}catch{if(C)return;y(t("error.authFailed"))}}return I(),()=>{C=!0}},[d,i,t]),c.useEffect(()=>{const C=window.setTimeout(()=>{(async()=>(await v.reject("timeout"),o.show({message:t("error.timeout"),position:"center"}),n({to:"/"})))()},vb);return()=>{window.clearTimeout(C)}},[v,n,t,o]);const j=c.useMemo(()=>!f||!Nb(f.payload)?null:f.payload,[f]),N=c.useMemo(()=>!f||!wb(f.payload)?null:f.payload,[f]),b=c.useMemo(()=>!f||!Cb(f.payload)?null:f.payload,[f]),S=c.useMemo(()=>{if(!l)return{sufficient:!0,required:"0",walletBalance:"0"};const C=j?{chainName:j.chainName,amount:j.balance,fee:j.fee}:b?{chainName:b.chainName,amount:b.destoryAmount,fee:b.fee}:null;if(!C)return{sufficient:!0,required:"0",walletBalance:"0"};const w=l.chainAddresses.find(D=>D.chain.toLowerCase()===C.chainName?.toLowerCase())?"1.0":"0";return{...kb(w,C.amount,C.fee),walletBalance:w}},[l,b,j]),k=c.useMemo(()=>j?xo(j):b?xo(b):"TOKEN",[b,j]),P=c.useCallback(()=>{a()},[a]),_=c.useCallback(async()=>{if(!p){g(!0);try{await v.reject(S.sufficient?"rejected":"insufficient_balance"),n({to:"/"})}finally{g(!1)}}},[v,S.sufficient,p,n]),A=c.useCallback(()=>{S.sufficient&&(p||(Ns(async C=>{g(!0);try{const I=l?.encryptedMnemonic;if(!I||!f)return!1;let w="";if(f.type==="message"){if(!N)return!1;const E=await v.handleMessageSign(N,I,C);w=typeof E=="string"?E:E.signature??""}else if(f.type==="transfer"){if(!j)return!1;const E=await v.handleTransferSign(j,I,C);w=typeof E=="string"?E:E.signature??""}else if(f.type==="destory"){if(!b)return!1;const E=await v.handleDestroySign(b,I,C);w=typeof E=="string"?E:E.signature??""}else return!1;return await v.approve(w),n({to:"/"}),!0}catch{return!1}finally{g(!1)}}),r("WalletLockConfirmJob",{title:t("button.confirm")})))},[v,S.sufficient,l?.encryptedMnemonic,b,p,N,n,r,f,t,j]);if(x)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("title.signature"),onBack:P}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsx("p",{className:"text-destructive text-sm",children:x}),e.jsx("div",{className:"mt-4",children:e.jsx(J,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]});const T=f?.type==="message"?t("signature.type.message"):f?.type==="destory"?t("signature.type.destroy"):t("title.signature");return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:T,onBack:P}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[m&&e.jsx(Xo,{appInfo:m}),e.jsx("div",{className:"text-foreground px-1 text-sm",children:t("signature.reviewTransaction")}),j&&e.jsxs(e.Fragment,{children:[e.jsx(ei,{from:j.senderAddress,to:j.receiveAddress,amount:`${j.balance} ${k}`,...j.fee?{fee:`${j.fee} ${k}`}:{},chainId:j.chainName}),!S.sufficient&&e.jsx(ti,{balance:S.walletBalance,required:S.required,symbol:k})]}),N&&e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-sm",children:t("signature.messageToSign")}),e.jsx("div",{className:R("bg-muted/50 rounded-lg p-3","font-mono text-sm break-all whitespace-pre-wrap","max-h-48 overflow-y-auto"),children:N.message})]}),b&&e.jsxs(e.Fragment,{children:[e.jsx(ei,{from:b.senderAddress,to:b.destoryAddress,amount:`${b.destoryAmount} ${k}`,...b.fee?{fee:`${b.fee} ${k}`}:{},chainId:b.chainName}),!S.sufficient&&e.jsx(ti,{balance:S.walletBalance,required:S.required,symbol:k})]}),f&&e.jsx("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:e.jsxs("div",{className:"text-muted-foreground text-sm",children:[f.type==="transfer"&&t("signature.type.transfer"),f.type==="message"&&t("signature.type.message"),f.type==="destory"&&t("signature.type.destroy")]})})]}),e.jsx("div",{className:"border-border bg-background safe-area-inset-bottom sticky bottom-0 border-t p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(J,{type:"button",variant:"outline",className:"flex-1",onClick:_,disabled:p,children:t("button.reject")}),e.jsx(J,{type:"button",className:"flex-1",onClick:A,disabled:p||!S.sufficient,children:t("button.confirm")})]})})]})}iu.__docgenInfo={description:"",methods:[],displayName:"SignatureAuthPage"};const ou=({params:t})=>e.jsx(oe,{children:e.jsx(me,{params:t,children:e.jsx(iu,{})})});ou.__docgenInfo={description:"",methods:[],displayName:"AuthorizeSignatureActivity"};function cu({walletName:t,onEnterWallet:s,className:n}){const{t:a}=O("onboarding");return e.jsxs("div",{"data-testid":"import-success-step",className:R("flex min-h-screen flex-col items-center justify-center px-6 py-8",n),children:[e.jsx("div",{className:"mb-6 flex size-20 items-center justify-center rounded-full bg-green-100 dark:bg-green-900/30",children:e.jsx(bs,{className:"size-10 text-green-600 dark:text-green-400"})}),e.jsx("h1",{"data-testid":"success-message",className:"mb-2 text-2xl font-bold",children:a("import.success.title")}),e.jsx("p",{className:"text-muted-foreground mb-8 text-center",children:e.jsx(Qo,{i18nKey:"import.success.description",ns:"onboarding",values:{name:t},components:{bold:e.jsx("span",{className:"text-foreground font-medium"})}})}),e.jsx("div",{className:"w-full max-w-xs",children:e.jsxs("button",{type:"button","data-testid":"enter-wallet-button",onClick:s,className:R("flex w-full items-center justify-center gap-2 rounded-full py-3 font-medium transition-colors","bg-primary hover:bg-primary/90 text-primary-foreground"),children:[e.jsx("span",{children:a("import.success.enterWallet")}),e.jsx(De,{className:"size-5"})]})})]})}cu.__docgenInfo={description:"Success screen shown after wallet import",methods:[],displayName:"ImportWalletSuccess",props:{walletName:{required:!0,tsType:{name:"string"},description:"Wallet name"},onEnterWallet:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback when user chooses to enter wallet"},className:{required:!1,tsType:{name:"string"},description:"Additional class name"}}};Ce.t.bind(Ce);function Sb(t){if(!So(t))throw new Error("Invalid mnemonic");return wm(t.join(" "))}function Ab(t){return new Set(t.map(s=>s.address.toLowerCase()))}const Ib=Ce.t.bind(Ce),va={isDuplicate:!1,type:"none"};function Tb(t){const[s,n]=c.useState(va),[a,r]=c.useState(!1),[o,d]=c.useState(null),i=c.useCallback(async m=>{r(!0),d(null);try{const u=Sb(m),f=Ab(u),h=await t.getAllAddresses();for(const g of h)if(f.has(g.address.toLowerCase())){const v={isDuplicate:!0,type:"address",matchedWallet:{id:g.walletId,name:g.walletName,importType:"mnemonic",matchedAddress:g.address}};return n(v),v}const y=(await t.getAllMainWallets()).filter(g=>g.importType==="privateKey");for(const g of y)for(const v of g.addresses)if(f.has(v.address.toLowerCase())){const j={isDuplicate:!0,type:"privateKey",matchedWallet:{id:g.id,name:g.name,importType:"privateKey",matchedAddress:v.address}};return n(j),j}const p={isDuplicate:!1,type:"none"};return n(p),p}catch(u){const f=u instanceof Error?u.message:Ib("error:duplicate.detectionFailed");return d(f),va}finally{r(!1)}},[t]),l=c.useCallback(()=>{n(va),d(null)},[]);return{result:s,isChecking:a,error:o,check:i,reset:l}}const Pb={getAllAddresses:async()=>[],getAllMainWallets:async()=>[],findWalletByAddress:async()=>null};function lu(){const{navigate:t,goBack:s}=ce(),{push:n}=X(),{t:a}=O(["onboarding","common","wallet"]),r=Gs(),o=dt().snapshot,d=rm(),i=Xt(),[l,m]=c.useState("keyType"),[u,f]=c.useState("mnemonic"),[h,x]=c.useState(!1),[y,p]=c.useState([]),[g,v]=c.useState(""),[j,N]=c.useState(null),[b,S]=c.useState([]),[k,P]=c.useState(!1),[_,A]=c.useState(""),[T,C]=c.useState(null),[I,w]=c.useState([]),[E,D]=c.useState(!1);c.useEffect(()=>{!E&&r.length>0&&(w(Uo(r)),D(!0))},[r,E]);const z=Tb(Pb),L=(()=>{switch(l){case"keyType":return 1;case"mnemonic":case"arbitrary":return 2;case"collision":return 2;case"pattern":return 3;case"chains":return 4;case"theme":return 5;case"success":return 5;default:return 1}})(),q=c.useCallback(()=>{switch(l){case"keyType":s();break;case"mnemonic":case"arbitrary":m("keyType"),z.reset();break;case"collision":m("mnemonic"),z.reset();break;case"pattern":m(u==="arbitrary"?"arbitrary":"mnemonic");break;case"chains":m("pattern");break;case"theme":m("chains");break}},[l,s,z,u]),M=c.useCallback(()=>{m("pattern")},[]),F=c.useCallback(te=>{A(te),m("chains")},[]),G=c.useCallback(()=>{if(u==="mnemonic"){m("mnemonic");return}if(h){m("arbitrary");return}$v(()=>{x(!0),m("arbitrary")}),n("SecurityWarningJob",{})},[u,h,n]),Z=c.useCallback(async te=>{p(te.mnemonic);const W=await z.check(te.mnemonic);if(W.isDuplicate){if(W.type==="address")return;if(W.type==="privateKey"){m("collision");return}}M()},[z,M]),B=c.useCallback(async()=>{M()},[M]),$=c.useCallback(()=>{m("mnemonic"),z.reset()},[z]),ye=c.useCallback(async(te,W)=>{P(!0);try{const ee=te.join(" "),be=(await Vo({mnemonic:ee,selectedChainIds:I,chainConfigs:r})).map(({chainId:ft,address:Ne,publicKey:de})=>({chain:ft,address:Ne,publicKey:de??"",tokens:[]})),he=be[0];if(!he)throw new Error("No chain addresses derived");const _e=ja(he.address),Dt=await ge.createWallet({name:a("onboarding:create.generatedNamePattern",{word:An(i),suffix:a("onboarding:create.walletSuffix")}),keyType:"mnemonic",address:he.address,chain:he.chain,chainAddresses:be,themeHue:_e},ee,W,_e);C(Dt.id),m("theme")}catch{}finally{P(!1)}},[r,I,a]),se=c.useCallback(async te=>{const W=g.trim();if(W&&b.length!==0){P(!0);try{const ee=b[0];if(!ee)throw new Error("No enabled bioforest chains");const le=ja(ee.address),be=b.map(_e=>({chain:_e.chainId,address:_e.address,publicKey:"",tokens:[]})),he=await ge.createWallet({name:a("onboarding:create.generatedNamePattern",{word:An(i),suffix:a("onboarding:create.walletSuffix")}),keyType:"arbitrary",address:ee.address,chain:ee.chainId,chainAddresses:be,themeHue:le},W,te,le);C(he.id),m("theme")}catch{}finally{P(!1)}}},[b,g,a]),U=c.useCallback(()=>{t({to:"/",replace:!0})},[t]),H=c.useCallback(async()=>{if(!k){if(u==="arbitrary"){await se(_);return}y.length!==0&&await ye(y,_)}},[se,ye,k,u,y,_]),Q=c.useCallback(()=>{t({to:"/"})},[t]);return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[l==="keyType"&&e.jsxs(e.Fragment,{children:[e.jsx(K,{title:a("onboarding:keyType.title"),onBack:q}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(yt,{total:5,current:L})}),e.jsxs("div",{"data-testid":"key-type-step",className:"flex-1 space-y-6 p-4",children:[e.jsx(Df,{value:u,onChange:te=>{f(te),te==="mnemonic"&&(v(""),S([]))}}),e.jsx(J,{type:"button","data-testid":"continue-button",onClick:G,className:"w-full",children:a("common:continue")})]})]}),l==="mnemonic"&&e.jsxs(e.Fragment,{children:[e.jsx(K,{title:a("onboarding:recover.title"),onBack:q}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(yt,{total:5,current:L})}),e.jsx("div",{"data-testid":"mnemonic-step",className:"flex-1 p-4",children:e.jsx(um,{onSubmit:Z,isSubmitting:z.isChecking})})]}),l==="arbitrary"&&e.jsxs(e.Fragment,{children:[e.jsx(K,{title:a("onboarding:keyType.arbitrary"),onBack:q}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(yt,{total:5,current:L})}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx(zf,{value:g,onChange:te=>{N(null),v(te)},disabled:k}),j&&e.jsxs("div",{className:"bg-destructive/10 text-destructive flex items-start gap-2 rounded-lg px-3 py-2 text-sm",children:[e.jsx(_t,{className:"mt-0.5 size-4 shrink-0"}),e.jsx("span",{children:j})]}),e.jsx(Of,{secret:g,enabledBioforestChainConfigs:o?d:void 0,onDerived:S}),e.jsxs(J,{type:"button",className:"w-full",disabled:k||g.trim()!==""&&b.length===0,onClick:()=>{if(!g.trim()){N(a("onboarding:arbitraryKey.required"));return}M()},children:[k&&e.jsx(ve,{className:"size-4 animate-spin"}),a("common:continue")]})]})]}),l==="collision"&&e.jsxs(e.Fragment,{children:[e.jsx(K,{title:a("onboarding:recover.addressConflict"),onBack:q}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(yt,{total:5,current:L})}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(Bf,{result:z.result,onConfirm:B,onCancel:$,isLoading:k})})]}),l==="pattern"&&e.jsxs(e.Fragment,{children:[e.jsx(K,{title:a("onboarding:recover.setWalletLock"),onBack:q}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(yt,{total:5,current:L})}),e.jsx("div",{"data-testid":"pattern-step",className:"flex-1 p-4",children:e.jsx(ir,{onComplete:F,minPoints:4})})]}),l==="chains"&&e.jsxs(e.Fragment,{children:[e.jsx(K,{title:a("onboarding:chainSelector.title"),onBack:q}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(yt,{total:5,current:L})}),e.jsx("div",{"data-testid":"chains-step",className:"flex-1 p-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Ys,{icon:e.jsx(bs,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:a("onboarding:chainSelector.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:a("onboarding:chainSelector.subtitle")})]}),r.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(Te,{})}):e.jsx(or,{"data-testid":"chain-selector",chains:r,selectedChains:I,onSelectionChange:w}),e.jsx(Ue,{variant:"mint",className:"w-full","data-testid":"chains-continue-button",disabled:I.length===0,onClick:H,children:a("common:next")})]})})]}),l==="theme"&&T&&e.jsxs(e.Fragment,{children:[e.jsx(K,{title:a("onboarding:create.themeTitle")}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(yt,{total:5,current:L})}),e.jsx("div",{"data-testid":"theme-step",className:"flex-1 p-4",children:e.jsx(Qn,{mode:"edit-only",walletId:T,onEditOnlyComplete:U})})]}),l==="success"&&e.jsx(cu,{walletName:a("wallet:defaultName"),onEnterWallet:Q})]})}lu.__docgenInfo={description:`Onboarding recover wallet page
Implements wallet recovery with duplicate detection per openspec/changes/add-wallet-recover-duplicate-guards`,methods:[],displayName:"OnboardingRecoverPage"};const du=()=>e.jsx(oe,{children:e.jsx(lu,{})});du.__docgenInfo={description:"",methods:[],displayName:"OnboardingRecoverActivity"};const gn={symbol:"USDT",balance:1234.56,fiatValue:"1234.56"},_b=[{id:"1",type:"send",status:"confirmed",amount:re.fromFormatted("100",6,"USDT"),symbol:"USDT",address:"0xabcd...1234",timestamp:new Date(Date.now()-36e5)},{id:"2",type:"receive",status:"confirmed",amount:re.fromFormatted("500",6,"USDT"),symbol:"USDT",address:"0x1234...abcd",timestamp:new Date(Date.now()-864e5)}];function uu(){const{t}=O("token"),{navigate:s,goBack:n}=ce();return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:gn.symbol,onBack:n}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsx("div",{className:"text-center",children:e.jsx(Pf,{value:gn.balance,symbol:gn.symbol,fiatValue:gn.fiatValue,size:"lg"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(Ue,{variant:"mint",className:"flex-1",onClick:()=>s({to:"/send",search:{address:void 0,chain:void 0,amount:void 0}}),children:[e.jsx(Pm,{className:"mr-2 size-4"}),t("detail.send")]}),e.jsxs(Ue,{variant:"blue",className:"flex-1",onClick:()=>s({to:"/receive"}),children:[e.jsx(zs,{className:"mr-2 size-4"}),t("detail.receive")]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold",children:t("detail.transactionHistory")}),e.jsx(Yo,{transactions:_b,emptyTitle:t("detail.noTransactions"),emptyDescription:t("detail.noTransactionsDesc")})]})]})]})}uu.__docgenInfo={description:"",methods:[],displayName:"TokenDetailPage"};const mu=({params:t})=>e.jsx(oe,{children:e.jsx(me,{params:t,children:e.jsx(uu,{})})});mu.__docgenInfo={description:"",methods:[],displayName:"TokenDetailActivity"};function fu(){const{t}=O("common"),{goBack:s}=ce(),{push:n}=X(),r=Ae(Ls).contacts,o=Ae(Le,Ks.getCurrentWallet),[d,i]=c.useState(""),l=c.useRef(null),m=c.useMemo(()=>d.trim()?Ua.searchContacts(Ls.state,d.trim()):r,[r,d]),u=c.useCallback(()=>{s()},[s]),f=c.useCallback(()=>{n("ContactEditJob",{})},[n]),h=c.useCallback(p=>{n("ContactEditJob",{contactId:p.id})},[n]),x=c.useCallback(p=>{n("ContactShareJob",{name:p.name,addresses:JSON.stringify(p.addresses.map(g=>({address:g.address,label:g.label}))),memo:p.memo,avatar:p.avatar})},[n]),y=c.useCallback(p=>{l.current=p,o?.encryptedMnemonic?(Ns(async g=>{try{return await Ht(o.encryptedMnemonic,g)?(Ds.deleteContact(p.id),l.current=null,!0):!1}catch{return!1}}),n("WalletLockConfirmJob",{title:t("addressBook.deleteTitle"),description:t("addressBook.deleteConfirm",{name:p.name})})):(Ds.deleteContact(p.id),l.current=null)},[o?.encryptedMnemonic,n,t]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("addressBook.title"),onBack:u,rightAction:e.jsx("button",{onClick:f,className:R("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":t("a11y.addContact"),"data-testid":"address-book-add-button",children:e.jsx(ut,{className:"size-5"})})}),e.jsx("div",{className:"px-4 py-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(Zs,{className:"text-muted-foreground absolute top-1/2 left-3 size-4 -translate-y-1/2"}),e.jsx("input",{type:"text",value:d,onChange:p=>i(p.target.value),placeholder:t("addressBook.searchPlaceholder"),className:R("border-border bg-background w-full rounded-xl border py-2.5 pr-4 pl-10","focus:ring-primary focus:ring-2 focus:outline-none")})]})}),e.jsx("div",{className:"flex-1 p-4",children:m.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[e.jsx(Zm,{className:"text-muted-foreground/50 size-12"}),e.jsx("p",{className:"text-muted-foreground",children:t(d?"addressBook.noResults":"addressBook.noContacts")}),!d&&e.jsx("button",{onClick:f,className:R("bg-primary rounded-full px-6 py-2.5 text-sm font-medium text-primary-foreground","hover:bg-primary/90 active:bg-primary/80"),children:t("contact.addTitle")})]}):e.jsx("div",{className:"space-y-2",children:m.map(p=>e.jsx(Eb,{contact:p,onShare:()=>x(p),onEdit:()=>h(p),onDelete:()=>y(p)},p.id))})})]})}function Eb({contact:t,onEdit:s,onDelete:n,onShare:a}){const{t:r}=O("common"),[o,d]=c.useState(!1);return e.jsx("div",{className:R("bg-card rounded-xl p-4 shadow-sm","transition-colors"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ys,{src:t.avatar||(t.addresses[0]?.address?Ut(t.addresses[0].address):void 0),size:40}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"truncate font-medium",children:t.name}),t.addresses.length>0&&e.jsxs("p",{className:"text-muted-foreground truncate font-mono text-xs",children:[t.addresses[0]?.address,t.addresses.length>1&&` (+${t.addresses.length-1})`]}),t.memo&&e.jsx("p",{className:"text-muted-foreground mt-1 truncate text-xs",children:t.memo})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>d(!o),className:R("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":r("a11y.moreActions"),children:e.jsx(Ff,{className:"text-muted-foreground size-4"})}),o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>d(!1)}),e.jsxs("div",{className:"bg-popover border-border absolute top-full right-0 z-20 mt-1 w-32 rounded-lg border py-1 shadow-lg",children:[e.jsx("button",{onClick:()=>{d(!1),a()},className:"hover:bg-muted w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.shareContact")}),e.jsx("button",{onClick:()=>{d(!1),s()},className:"hover:bg-muted w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.edit")}),e.jsx("button",{onClick:()=>{d(!1),n()},className:"text-destructive hover:bg-destructive/10 w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.delete")})]})]})]})]})})}fu.__docgenInfo={description:"",methods:[],displayName:"AddressBookPage"};const pu=()=>e.jsx(oe,{children:e.jsx(fu,{})});pu.__docgenInfo={description:"",methods:[],displayName:"AddressBookActivity"};function hu({open:t,onOpenChange:s}){const{t:n}=O("common"),a=Et(),r=Ka(),o=Xu(),d=Zu(),i=Zt(),l=c.useCallback(m=>{!o.includes(m)&&!d||cs.toggleWalletSelection(m)},[o,d]);return e.jsx(Ct,{open:t,onOpenChange:s,children:e.jsxs(kt,{side:"bottom",className:"rounded-t-2xl",children:[e.jsx(St,{className:"pb-4",children:e.jsx(At,{children:n("myCard.selectWallets")})}),e.jsxs("div",{className:"max-h-[50vh] overflow-y-auto pb-[env(safe-area-inset-bottom)]",children:[a.map(m=>{const u=r[m.id]||m.chain,f=m.chainAddresses.find(y=>y.chain===u),h=o.includes(m.id),x=!h&&!d;return e.jsxs("button",{type:"button",onClick:()=>l(m.id),disabled:x,className:R("flex w-full items-center gap-3 rounded-lg p-3 text-left transition-colors",h&&"bg-primary/10",!x&&"hover:bg-muted",x&&"cursor-not-allowed opacity-50"),children:[e.jsx(Pt,{chain:u,size:"md"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium",children:m.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{children:i[u]||u}),e.jsxs("span",{className:"truncate font-mono text-xs",children:[f?.address.slice(0,8),"...",f?.address.slice(-6)]})]})]}),h&&e.jsx("div",{className:"flex size-6 items-center justify-center rounded-full bg-primary",children:e.jsx(je,{className:"size-4 text-primary-foreground"})})]},m.id)}),a.length===0&&e.jsx("div",{className:"py-8 text-center text-muted-foreground",children:n("noAssets")})]}),e.jsx("p",{className:"py-4 text-center text-xs text-muted-foreground",children:n("myCard.maxWallets",{max:3})})]})})}hu.__docgenInfo={description:"",methods:[],displayName:"WalletPickerSheet",props:{open:{required:!0,tsType:{name:"boolean"},description:""},onOpenChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(open: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"open"}],return:{name:"void"}}},description:""}}};function Mb(t,s){const[n,a]=c.useState(!1),{filename:r,shareTitle:o,shareText:d}=s,i=c.useCallback(async()=>{const m=t.current;if(!(!m||n)){a(!0);try{const{snapdom:u}=await Tt(async()=>{const{snapdom:f}=await import("./snapdom-CO8q8LPW.js").then(h=>h.s);return{snapdom:f}},__vite__mapDeps([0,1]),import.meta.url);await u.download(m,{type:"png",filename:`${r}.png`,scale:2,quality:1})}catch(u){console.error("Download failed:",u)}finally{a(!1)}}},[t,r,n]),l=c.useCallback(async()=>{const m=t.current;if(!(!m||!navigator.share||n)){a(!0);try{const{snapdom:u}=await Tt(async()=>{const{snapdom:y}=await import("./snapdom-CO8q8LPW.js").then(p=>p.s);return{snapdom:y}},__vite__mapDeps([0,1]),import.meta.url),h=await(await u(m,{scale:2})).toBlob(),x=new File([h],`${r}.png`,{type:"image/png"});await navigator.share({title:o,text:d,files:[x]})}catch{}finally{a(!1)}}},[t,r,o,d,n]);return{isProcessing:n,download:i,share:l,canShare:typeof navigator<"u"&&"share"in navigator}}function xu(){const{t}=O(["common","settings"]),{goBack:s}=ce(),n=c.useRef(null),a=c.useRef(null),r=Va(),o=Et(),d=Ka(),i=Zt(),[l,m]=c.useState(!1),[u,f]=c.useState(r.username),[h,x]=c.useState(!1);c.useEffect(()=>{if(!r.avatar&&o.length>0){const A=o[0]?.chainAddresses[0]?.address;A&&cs.initializeDefaultAvatar(A)}},[r.avatar,o]),c.useEffect(()=>{if(r.selectedWalletIds.length===0&&o.length>0){const A=o[0];A&&cs.toggleWalletSelection(A.id)}},[r.selectedWalletIds,o]);const y=c.useMemo(()=>r.selectedWalletIds.map(A=>o.find(T=>T.id===A)).filter(A=>!!A).map(A=>{const T=d[A.id]||A.chain,C=A.chainAddresses.find(I=>I.chain===T);return{wallet:A,chain:T,address:C?.address}}).filter(A=>A.address),[r.selectedWalletIds,o,d]),p=c.useMemo(()=>y.filter(A=>!!A.address).map(({wallet:A,address:T})=>({address:T,label:A.name})),[y]),g=c.useMemo(()=>p.length===0?"":er({name:r.username||t("myCard.defaultName"),addresses:p,avatar:r.avatar}),[r.username,r.avatar,p,t]),v=c.useCallback(()=>{cs.randomizeAvatar()},[]),j=c.useCallback(()=>{f(r.username),m(!0)},[r.username]),N=c.useCallback(()=>{cs.setUsername(u),m(!1)},[u]),b=c.useCallback(A=>{A.key==="Enter"?N():A.key==="Escape"&&m(!1)},[N]);c.useEffect(()=>{l&&n.current?.focus()},[l]);const{isProcessing:S,download:k,share:P}=Mb(a,{filename:`my-card-${Date.now()}`,shareTitle:t("myCard.title"),shareText:r.username||t("myCard.defaultName")}),_=r.username||t("myCard.defaultName");return e.jsxs("div",{className:"flex min-h-screen flex-col bg-background",children:[e.jsx(K,{title:t("myCard.title"),onBack:s}),e.jsxs("div",{className:"flex flex-1 flex-col items-center p-6",children:[e.jsxs("button",{type:"button",onClick:v,className:"group relative mb-4 cursor-pointer transition-transform hover:scale-105","aria-label":t("myCard.changeAvatar"),children:[e.jsx(ys,{src:r.avatar,size:80}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center rounded-full bg-black/50 opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx("span",{className:"text-xs text-white",children:t("myCard.changeAvatar")})})]}),l?e.jsx("div",{className:"mb-6 flex items-center gap-2",children:e.jsx(Ve,{ref:n,value:u,onChange:A=>f(A.target.value),onBlur:N,onKeyDown:b,placeholder:t("myCard.usernamePlaceholder"),className:"w-48 text-center"})}):e.jsxs("button",{type:"button",onClick:j,className:"group mb-6 flex items-center gap-2 text-xl font-semibold",children:[e.jsx("span",{children:_}),e.jsx(Wf,{className:"size-4 text-muted-foreground opacity-50 group-hover:opacity-100"})]}),p.length>0?e.jsx("div",{ref:a,className:"mb-6",children:e.jsx(sr,{name:_,avatar:r.avatar,addresses:p,qrContent:g})}):e.jsx("div",{className:"mb-6 flex h-[300px] w-[320px] items-center justify-center rounded-3xl bg-muted",children:e.jsx("p",{className:"text-muted-foreground",children:t("myCard.noWalletsSelected")})}),e.jsxs("div",{className:"mb-6 w-full max-w-[320px]",children:[e.jsx("h3",{className:"mb-2 text-sm font-medium text-muted-foreground",children:t("myCard.selectWallets")}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[y.map(({wallet:A,chain:T})=>{const{c0:C}=hf(A.themeHue);return e.jsxs("div",{className:"flex items-center gap-1.5 rounded-full px-3 py-1.5 text-sm font-medium",style:{backgroundColor:C,color:"#FFFFFF"},children:[e.jsx("span",{children:A.name}),e.jsx("span",{style:{opacity:.8},children:t("myCard.chainLabel",{chain:i[T]||T})}),e.jsx("button",{type:"button",onClick:()=>cs.toggleWalletSelection(A.id),className:"ml-0.5 rounded-full p-0.5 transition-colors hover:bg-white/20","aria-label":t("myCard.removeWallet",{name:A.name}),children:e.jsx(tn,{className:"size-3"})})]},A.id)}),r.selectedWalletIds.length<3&&e.jsxs("button",{type:"button",onClick:()=>x(!0),className:"flex items-center gap-1 rounded-full border border-dashed border-muted-foreground/50 px-3 py-1 text-sm text-muted-foreground hover:border-primary hover:text-primary",children:[e.jsx(ut,{className:"size-3"}),t("myCard.addWallet")]})]}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:t("myCard.maxWallets",{max:3})})]}),e.jsxs("div",{className:"flex w-full max-w-[320px] gap-3",children:[e.jsxs(J,{variant:"outline",onClick:k,disabled:S||p.length===0,className:"flex-1",children:[S?e.jsx(ve,{className:"mr-2 size-4 animate-spin"}):e.jsx(en,{className:"mr-2 size-4"}),t("download")]}),"share"in navigator&&e.jsxs(J,{onClick:P,disabled:S||p.length===0,className:"flex-1",children:[S?e.jsx(ve,{className:"mr-2 size-4 animate-spin"}):e.jsx($s,{className:"mr-2 size-4"}),t("share")]})]}),e.jsx("p",{className:"mt-6 text-center text-sm text-muted-foreground",children:t("myCard.scanToAdd")})]}),e.jsx(hu,{open:h,onOpenChange:x})]})}xu.__docgenInfo={description:"",methods:[],displayName:"MyCardPage"};const gu=()=>e.jsx(oe,{children:e.jsx(xu,{})});gu.__docgenInfo={description:"",methods:[],displayName:"MyCardActivity"};const Rb={transaction:{icon:"",bg:"bg-blue-100 dark:bg-blue-900/30"},security:{icon:"",bg:"bg-red-100 dark:bg-red-900/30"},system:{icon:"",bg:"bg-gray-100 dark:bg-gray-800/30"}};function Lb(){const{t}=O("notification"),s=Xt();return c.useCallback(n=>{const r=Date.now()-n,o=Math.floor(r/6e4),d=Math.floor(r/36e5),i=Math.floor(r/864e5);return o<1?t("time.justNow"):o<60?t("time.minutesAgo",{count:o}):d<24?t("time.hoursAgo",{count:d}):i<7?t("time.daysAgo",{count:i}):new Date(n).toLocaleDateString(s)},[t,s])}function Db({notification:t,onRead:s,onRemove:n,onNavigate:a,formatRelativeTime:r,t:o}){const d=Rb[t.type],i=t.type==="transaction"&&!!t.data?.pendingTxId,l=c.useCallback(()=>{t.read||s(t.id),i&&a&&a(t)},[t,s,a,i]);return e.jsxs("div",{onClick:l,className:R("flex cursor-pointer items-start gap-3 rounded-xl p-4 transition-colors",t.read?"bg-muted/30":"bg-card shadow-sm"),children:[e.jsx("div",{className:R("flex size-10 shrink-0 items-center justify-center rounded-full",d.bg),children:e.jsx("span",{className:"text-lg",children:d.icon})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h4",{className:R("font-medium",t.read&&"text-muted-foreground"),children:t.title}),e.jsx("span",{className:"text-muted-foreground shrink-0 text-xs",children:r(t.timestamp)})]}),e.jsx("p",{className:R("mt-1 text-sm",t.read?"text-muted-foreground":"text-foreground/80"),children:t.message}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[!t.read&&e.jsx("div",{className:"bg-primary flex size-2 rounded-full","aria-label":o("unread")}),i&&e.jsxs("span",{className:"text-primary flex items-center gap-0.5 text-xs",children:[o("viewDetails"),e.jsx(De,{className:"size-3"})]})]})]}),e.jsx("button",{onClick:m=>{m.stopPropagation(),n(t.id)},className:"text-muted-foreground hover:text-destructive shrink-0 p-1","aria-label":o("delete"),children:e.jsx(es,{className:"size-4"})})]})}function zb({notifications:t,onRead:s,onRemove:n,onNavigate:a,formatRelativeTime:r,t:o,language:d}){const i=c.useMemo(()=>{const l=new Map,m=new Date().toLocaleDateString(d),u=new Date(Date.now()-864e5).toLocaleDateString(d);for(const f of t){const h=new Date(f.timestamp).toLocaleDateString(d);let x=h;h===m?x=o("time.today"):h===u&&(x=o("time.yesterday"));const y=l.get(x)||[];l.set(x,[...y,f])}return l},[t,d,o]);return t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx("div",{className:"bg-muted mb-4 flex size-16 items-center justify-center rounded-full",children:e.jsx($f,{className:"text-muted-foreground size-8"})}),e.jsx("h3",{className:"text-lg font-medium",children:o("empty.title")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:o("empty.desc")})]}):e.jsx("div",{className:"space-y-6",children:Array.from(i.entries()).map(([l,m])=>e.jsxs("div",{children:[e.jsx("h3",{className:"text-muted-foreground mb-2 text-sm font-medium",children:l}),e.jsx("div",{className:"space-y-2",children:m.map(u=>e.jsx(Db,{notification:u,onRead:s,onRemove:n,onNavigate:a,formatRelativeTime:r,t:o},u.id))})]},l))})}function vu(){const{t}=O("notification"),s=Xt(),n=Lb(),{goBack:a,navigate:r}=ce(),o=Ae(Cm);c.useEffect(()=>{o.isInitialized||ws.initialize()},[o.isInitialized]);const d=c.useCallback(f=>{ws.markRead(f)},[]),i=c.useCallback(f=>{ws.remove(f)},[]),l=c.useCallback(()=>{ws.markAllRead()},[]),m=c.useCallback(()=>{ws.clearAll()},[]),u=c.useCallback(f=>{f.type==="transaction"&&f.data?.pendingTxId&&r({to:`/pending-tx/${f.data.pendingTxId}`})},[r]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("title"),onBack:a,rightAction:o.unreadCount>0?e.jsxs("button",{onClick:l,className:"text-primary hover:bg-primary/10 flex items-center gap-1 rounded-full px-3 py-1.5 text-sm","aria-label":t("markAllRead"),children:[e.jsx(je,{className:"size-4"}),t("markAllRead")]}):void 0}),e.jsx("div",{className:"bg-card border-b px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:o.unreadCount>0?t("unreadCount",{count:o.unreadCount}):t("noUnread")}),o.notifications.length>0&&e.jsxs(J,{variant:"ghost",size:"sm",onClick:m,className:"text-destructive",children:[e.jsx(es,{className:"mr-1 size-4"}),t("clear")]})]})}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(zb,{notifications:o.notifications,onRead:d,onRemove:i,onNavigate:u,formatRelativeTime:n,t,language:s})})]})}vu.__docgenInfo={description:"",methods:[],displayName:"NotificationCenterPage"};const yu=()=>e.jsx(oe,{children:e.jsx(vu,{})});yu.__docgenInfo={description:"",methods:[],displayName:"NotificationsActivity"};function Ob(t){const s=t.toNumber();return s>=1e9?`${(s/1e9).toFixed(2)}B`:s>=1e6?`${(s/1e6).toFixed(2)}M`:s>=1e3?`${(s/1e3).toFixed(2)}K`:s.toFixed(Math.min(5,8))}function bu({item:t,onMint:s,className:n}){const{t:a}=O("staking"),r=[{label:a("totalMinted",{asset:t.assetType}),value:t.totalMinted},{label:a("totalCirculation",{asset:t.assetType}),value:t.totalCirculation},{label:a("totalBurned",{asset:t.assetType}),value:t.totalBurned},{label:a("totalStaked",{asset:t.externalAssetType}),value:t.totalStaked}];return e.jsxs("div",{className:R("overflow-hidden rounded-xl shadow-md","bg-gradient-to-b from-primary/90 to-primary",n),children:[e.jsxs("div",{className:"relative grid grid-cols-2 gap-3 p-4",children:[r.map((o,d)=>e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("span",{className:"text-lg font-semibold text-amber-300",children:Ob(o.value)}),e.jsx("span",{className:"text-xs text-primary-foreground/70",children:o.label})]},d)),e.jsx("div",{className:"pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 opacity-20",children:e.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-white/20 text-2xl font-bold text-white",children:t.chain.charAt(0)})})]}),e.jsxs("div",{className:"flex items-center justify-between bg-card px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ot,{symbol:t.externalAssetType,size:"sm"}),e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"font-medium text-foreground",children:t.externalAssetType}),e.jsx("div",{className:"text-muted-foreground",children:t.externalChain})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ot,{symbol:t.assetType,size:"sm"}),e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"font-medium text-foreground",children:t.assetType}),e.jsx("div",{className:"text-muted-foreground",children:t.chain})]})]}),e.jsx(J,{size:"sm",variant:"default",className:"rounded-full px-4",onClick:()=>s?.(t),children:a("mint")})]})]})]})}bu.__docgenInfo={description:"Staking pool card component",methods:[],displayName:"StakingPoolCard",props:{item:{required:!0,tsType:{name:"StakingOverviewItem"},description:""},onMint:{required:!1,tsType:{name:"union",raw:"((item: StakingOverviewItem) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Bb=[{value:"all",label:"allNetworks"},{value:"ETH",label:"Ethereum"},{value:"BSC",label:"BNB Chain"},{value:"TRON",label:"Tron"},{value:"BFMeta",label:"BFMeta"},{value:"BFChain",label:"BFChain"}];function ju({onMint:t,className:s}){const{t:n}=O("staking"),[a,r]=c.useState(""),[o,d]=c.useState("all"),[i,l]=c.useState(!1),[m,u]=c.useState([]),[f,h]=c.useState(!0);c.useEffect(()=>{let p=!0;return h(!0),Vt.getOverview().then(g=>{p&&(u(g),h(!1))}),()=>{p=!1}},[]);const x=c.useMemo(()=>{let p=m;if(a.trim()){const g=a.toLowerCase();p=p.filter(v=>v.assetType.toLowerCase().includes(g)||v.externalAssetType.toLowerCase().includes(g)||v.chain.toLowerCase().includes(g)||v.externalChain.toLowerCase().includes(g))}return o!=="all"&&(p=p.filter(g=>g.chain===o||g.externalChain===o)),p},[m,a,o]),y=p=>{d(p),l(!1)};return f?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[e.jsx(Te,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):e.jsxs("div",{className:R("space-y-4",s),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Zs,{className:"text-muted-foreground absolute top-1/2 left-3 size-4 -translate-y-1/2"}),e.jsx(Ve,{type:"text",placeholder:n("searchPlaceholder"),value:a,onChange:p=>r(p.target.value),className:"pl-9"})]}),e.jsxs(Ct,{open:i,onOpenChange:l,children:[e.jsx(uf,{render:e.jsxs(J,{variant:"outline",size:"icon",className:"relative",children:[e.jsx(rc,{className:"size-4"}),o!=="all"&&e.jsx("span",{className:"bg-primary absolute -top-1 -right-1 size-2 rounded-full"})]})}),e.jsxs(kt,{side:"bottom",className:"h-[60vh]",children:[e.jsx(St,{children:e.jsx(At,{children:n("selectNetwork")})}),e.jsx("div",{className:"mt-4 space-y-2",children:Bb.map(p=>e.jsxs("button",{onClick:()=>y(p.value),className:R("flex w-full items-center justify-between rounded-lg px-4 py-3 text-left transition-colors",o===p.value?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("span",{children:p.value==="all"?n("allNetworks"):p.label}),o===p.value&&e.jsx("span",{className:"text-primary",children:""})]},p.value))})]})]})]}),x.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-20",children:e.jsx("p",{className:"text-muted-foreground",children:n("noResults")})}):e.jsx("div",{className:"space-y-4",children:x.map((p,g)=>e.jsx(bu,{item:p,onMint:t},`${p.chain}-${p.assetType}-${g}`))})]})}ju.__docgenInfo={description:"Staking overview panel with search and filter",methods:[],displayName:"StakingOverviewPanel",props:{onMint:{required:!1,tsType:{name:"signature",type:"function",raw:"(item: StakingOverviewItem) => void",signature:{arguments:[{type:{name:"StakingOverviewItem"},name:"item"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Fb=["ETH","BSC","TRON"],Wb={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron"},go={ETH:{BFM:"1000.00",USDT:"5000.00"},BSC:{BFM:"2500.00",USDT:"10000.00",BFC:"500.00"},TRON:{USDT:"8000.00"}};function $b(t,s){if(!t)return[];const n=[];for(const[a,r]of Object.entries(t))for(const[o,d]of Object.entries(r)){const i=d.supportChain[s];i&&n.push({asset:i.assetType,targetChain:a,targetAsset:o})}return n}function Nu({onSuccess:t,className:s}){const{t:n}=O("staking"),a=Zt(),[r,o]=c.useState("BSC"),[d,i]=c.useState(""),[l,m]=c.useState(""),[u,f]=c.useState(""),[h,x]=c.useState(""),[y,p]=c.useState(!1),[g,v]=c.useState(!1),[j,N]=c.useState(!0),[b,S]=c.useState(!1),[k,P]=c.useState(null);c.useEffect(()=>{let L=!0;return Vt.getRechargeConfig().then(q=>{L&&(P(q),N(!1))}),()=>{L=!1}},[]);const _=c.useMemo(()=>$b(k,r),[k,r]),A=c.useCallback(L=>{const q=Wb[L];if(q)return q;const M=L.toLowerCase();return a[M]??a[L]??L},[a]);c.useEffect(()=>{const L=_[0];L&&!d&&(i(L.asset),m(L.targetChain),f(L.targetAsset))},[_,d]);const T=c.useCallback(L=>{o(L),i(""),m(""),f(""),x(""),p(!1)},[]),C=c.useCallback(L=>{i(L.asset),m(L.targetChain),f(L.targetAsset),v(!1)},[]),I=c.useMemo(()=>go[r]?.[d]??"0.00",[r,d]),w=c.useCallback(()=>{x(I.replace(/,/g,""))},[I]),E=c.useMemo(()=>{if(!h)return null;const L=parseFloat(h);if(isNaN(L)||L<=0)return n("invalidAmount");const q=parseFloat(I.replace(/,/g,""));return L>q?n("insufficientBalance"):null},[h,I,n]),D=c.useMemo(()=>r&&d&&l&&u&&h&&!E&&!b,[r,d,l,u,h,E,b]),z=c.useCallback(async()=>{if(D){S(!0);try{const L=h.replace(/,/g,""),q={sourceChain:r,sourceAsset:d,amount:re.fromFormatted(L,18,d),targetChain:l,targetAsset:u},M=await Vt.submitMint(q);t?.(M.id)}finally{S(!1)}}},[D,r,d,h,l,u,t]);return j?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Te,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):e.jsxs("div",{className:R("space-y-4",s),children:[e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("sourceChain")}),e.jsxs("button",{type:"button",onClick:()=>p(!0),className:"bg-background mb-3 flex w-full items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-muted flex size-6 items-center justify-center rounded-full text-xs font-bold",children:r.charAt(0)}),e.jsx("span",{className:"font-medium",children:A(r)})]}),e.jsx(De,{className:"text-muted-foreground size-4"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>v(!0),className:"bg-background flex shrink-0 items-center gap-2 rounded-lg px-3 py-2",children:[e.jsx(ot,{symbol:d||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:d||n("selectToken")}),e.jsx(De,{className:"text-muted-foreground size-4"})]}),e.jsx("div",{className:"flex-1",children:e.jsx(Ve,{type:"text",inputMode:"decimal",placeholder:"0.00",value:h,onChange:L=>x(L.target.value),className:"border-0 bg-transparent text-right text-lg font-semibold"})})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-muted-foreground",children:[n("availableBalance"),": ",I]}),e.jsx(J,{type:"button",variant:"ghost",size:"sm",className:"text-primary h-auto px-2 py-1 text-xs",onClick:w,children:n("max")})]}),E&&e.jsx("div",{className:"text-destructive mt-2 text-xs",children:E})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-muted rounded-full p-2",children:e.jsx(zs,{className:"text-muted-foreground size-4"})})}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("targetChain")}),e.jsxs("div",{className:"bg-background flex items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-primary/20 text-primary flex size-6 items-center justify-center rounded-full text-xs font-bold",children:l.charAt(0)||"?"}),e.jsx("span",{className:"font-medium",children:l?A(l):n("selectToken")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ot,{symbol:u||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:u||"-"})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:n("amount")}),e.jsxs("span",{className:"font-semibold",children:[h||"0.00"," ",u]})]})]}),e.jsx(J,{type:"button",size:"lg",className:"w-full",disabled:!D,onClick:z,children:b?e.jsxs(e.Fragment,{children:[e.jsx(Te,{size:"sm"}),e.jsx("span",{className:"ml-2",children:n("confirm")})]}):n("confirm")}),e.jsx(Ct,{open:y,onOpenChange:p,children:e.jsxs(kt,{side:"bottom",className:"h-[50vh]",children:[e.jsx(St,{children:e.jsx(At,{children:n("selectChain")})}),e.jsx("div",{className:"mt-4 space-y-2",children:Fb.map(L=>e.jsxs("button",{onClick:()=>T(L),className:R("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",r===L?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("div",{className:"bg-muted flex size-8 items-center justify-center rounded-full text-sm font-bold",children:L.charAt(0)}),e.jsx("span",{className:"font-medium",children:A(L)}),r===L&&e.jsx("span",{className:"text-primary ml-auto",children:""})]},L))})]})}),e.jsx(Ct,{open:g,onOpenChange:v,children:e.jsxs(kt,{side:"bottom",className:"h-[60vh]",children:[e.jsx(St,{children:e.jsx(At,{children:n("selectToken")})}),e.jsx("div",{className:"mt-4 space-y-2",children:_.length===0?e.jsx("p",{className:"text-muted-foreground py-8 text-center",children:n("noResults")}):_.map(L=>e.jsxs("button",{onClick:()=>C(L),className:R("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",d===L.asset?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx(ot,{symbol:L.asset,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:L.asset}),e.jsx("div",{className:"text-muted-foreground text-xs",children:n("targetChainLabel",{chain:A(L.targetChain),asset:L.targetAsset})})]}),e.jsx("div",{className:"text-muted-foreground text-right text-sm",children:go[r]?.[L.asset]??"0.00"}),d===L.asset&&e.jsx("span",{className:"text-primary",children:""})]},`${L.targetChain}-${L.asset}`))})]})})]})}Nu.__docgenInfo={description:"Mint form component",methods:[],displayName:"MintForm",props:{onSuccess:{required:!1,tsType:{name:"signature",type:"function",raw:"(txId: string) => void",signature:{arguments:[{type:{name:"string"},name:"txId"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const qb=["BFMeta","BFChain","CCChain","PMChain"],Hb={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron"},vo={BFMeta:{BFM:"5000.00",USDT:"2500.00"},BFChain:{BFC:"1000.00"},CCChain:{},PMChain:{}};function Ub(t,s){if(!t)return[];const n=s.toLowerCase(),a=t[n];if(!a)return[];const r=[];for(const[o,d]of Object.entries(a)){const i=[];d.supportChain.ETH&&i.push("ETH"),d.supportChain.BSC&&i.push("BSC"),d.supportChain.TRON&&i.push("TRON"),i.length>0&&r.push({asset:o,targetChains:i})}return r}function wu({onSuccess:t,className:s}){const{t:n}=O("staking"),a=Zt(),[r,o]=c.useState("BFMeta"),[d,i]=c.useState(""),[l,m]=c.useState(""),[u,f]=c.useState(""),[h,x]=c.useState(!1),[y,p]=c.useState(!1),[g,v]=c.useState(!1),[j,N]=c.useState(!0),[b,S]=c.useState(!1),[k,P]=c.useState(null);c.useEffect(()=>{let M=!0;return Vt.getRechargeConfig().then(F=>{M&&(P(F),N(!1))}),()=>{M=!1}},[]);const _=c.useMemo(()=>Ub(k,r),[k,r]),A=c.useCallback(M=>{const F=Hb[M];if(F)return F;const G=M.toLowerCase();return a[G]??a[M]??M},[a]),T=c.useMemo(()=>d?_.find(F=>F.asset===d)?.targetChains??[]:[],[_,d]);c.useEffect(()=>{const M=_[0];if(M&&!d){i(M.asset);const F=M.targetChains[0];F&&m(F)}},[_,d]);const C=c.useCallback(M=>{o(M),i(""),m(""),f(""),x(!1)},[]),I=c.useCallback(M=>{i(M.asset);const F=M.targetChains[0];F&&m(F),p(!1)},[]),w=c.useCallback(M=>{m(M),v(!1)},[]),E=c.useMemo(()=>vo[r]?.[d]??"0.00",[r,d]),D=c.useCallback(()=>{f(E.replace(/,/g,""))},[E]),z=c.useMemo(()=>{if(!u)return null;const M=parseFloat(u);if(isNaN(M)||M<=0)return n("invalidAmount");const F=parseFloat(E.replace(/,/g,""));return M>F?n("insufficientBalance"):null},[u,E,n]),L=c.useMemo(()=>r&&d&&l&&u&&!z&&!b,[r,d,l,u,z,b]),q=c.useCallback(async()=>{if(!(!L||!l)){S(!0);try{const M=u.replace(/,/g,""),F={sourceChain:r,sourceAsset:d,amount:re.fromFormatted(M,8,d),targetChain:l,targetAsset:d},G=await Vt.submitBurn(F);t?.(G.id)}finally{S(!1)}}},[L,r,d,u,l,t]);return j?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Te,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):e.jsxs("div",{className:R("space-y-4",s),children:[e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("sourceChain")}),e.jsxs("button",{type:"button",onClick:()=>x(!0),className:"bg-background mb-3 flex w-full items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-primary/20 text-primary flex size-6 items-center justify-center rounded-full text-xs font-bold",children:r.charAt(0)}),e.jsx("span",{className:"font-medium",children:A(r)})]}),e.jsx(De,{className:"text-muted-foreground size-4"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>p(!0),className:"bg-background flex shrink-0 items-center gap-2 rounded-lg px-3 py-2",children:[e.jsx(ot,{symbol:d||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:d||n("selectToken")}),e.jsx(De,{className:"text-muted-foreground size-4"})]}),e.jsx("div",{className:"flex-1",children:e.jsx(Ve,{type:"text",inputMode:"decimal",placeholder:"0.00",value:u,onChange:M=>f(M.target.value),className:"border-0 bg-transparent text-right text-lg font-semibold"})})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-muted-foreground",children:[n("availableBalance"),": ",E]}),e.jsx(J,{type:"button",variant:"ghost",size:"sm",className:"text-primary h-auto px-2 py-1 text-xs",onClick:D,children:n("max")})]}),z&&e.jsx("div",{className:"text-destructive mt-2 text-xs",children:z})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-muted rounded-full p-2",children:e.jsx(zs,{className:"text-muted-foreground size-4"})})}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("targetChain")}),e.jsxs("button",{type:"button",onClick:()=>v(!0),disabled:T.length===0,className:"bg-background flex w-full items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-muted flex size-6 items-center justify-center rounded-full text-xs font-bold",children:l?l.charAt(0):"?"}),e.jsx("span",{className:"font-medium",children:l?A(l):n("selectChain")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ot,{symbol:d||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:d||"-"}),e.jsx(De,{className:"text-muted-foreground size-4"})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:n("amount")}),e.jsxs("span",{className:"font-semibold",children:[u||"0.00"," ",d]})]})]}),e.jsx(J,{type:"button",size:"lg",className:"w-full",disabled:!L,onClick:q,children:b?e.jsxs(e.Fragment,{children:[e.jsx(Te,{size:"sm"}),e.jsx("span",{className:"ml-2",children:n("confirm")})]}):n("confirm")}),e.jsx(Ct,{open:h,onOpenChange:x,children:e.jsxs(kt,{side:"bottom",className:"h-[50vh]",children:[e.jsx(St,{children:e.jsx(At,{children:n("selectChain")})}),e.jsx("div",{className:"mt-4 space-y-2",children:qb.map(M=>e.jsxs("button",{onClick:()=>C(M),className:R("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",r===M?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("div",{className:"bg-primary/20 text-primary flex size-8 items-center justify-center rounded-full text-sm font-bold",children:M.charAt(0)}),e.jsx("span",{className:"font-medium",children:A(M)}),r===M&&e.jsx("span",{className:"text-primary ml-auto",children:""})]},M))})]})}),e.jsx(Ct,{open:y,onOpenChange:p,children:e.jsxs(kt,{side:"bottom",className:"h-[60vh]",children:[e.jsx(St,{children:e.jsx(At,{children:n("selectToken")})}),e.jsx("div",{className:"mt-4 space-y-2",children:_.length===0?e.jsx("p",{className:"text-muted-foreground py-8 text-center",children:n("noResults")}):_.map(M=>e.jsxs("button",{onClick:()=>I(M),className:R("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",d===M.asset?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx(ot,{symbol:M.asset,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:M.asset}),e.jsxs("div",{className:"text-muted-foreground text-xs",children:[" ",M.targetChains.join(", ")]})]}),e.jsx("div",{className:"text-muted-foreground text-right text-sm",children:vo[r]?.[M.asset]??"0.00"}),d===M.asset&&e.jsx("span",{className:"text-primary",children:""})]},M.asset))})]})}),e.jsx(Ct,{open:g,onOpenChange:v,children:e.jsxs(kt,{side:"bottom",className:"h-[50vh]",children:[e.jsx(St,{children:e.jsx(At,{children:n("selectChain")})}),e.jsx("div",{className:"mt-4 space-y-2",children:T.map(M=>e.jsxs("button",{onClick:()=>w(M),className:R("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",l===M?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("div",{className:"bg-muted flex size-8 items-center justify-center rounded-full text-sm font-bold",children:M.charAt(0)}),e.jsx("span",{className:"font-medium",children:A(M)}),l===M&&e.jsx("span",{className:"text-primary ml-auto",children:""})]},M))})]})})]})}wu.__docgenInfo={description:"Burn form component",methods:[],displayName:"BurnForm",props:{onSuccess:{required:!1,tsType:{name:"signature",type:"function",raw:"(txId: string) => void",signature:{arguments:[{type:{name:"string"},name:"txId"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Vb={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron"};function Jb({status:t}){switch(t){case"pending":return e.jsx(Hf,{className:"size-4 text-yellow-500"});case"confirming":return e.jsx(ve,{className:"size-4 animate-spin text-blue-500"});case"confirmed":return e.jsx(bs,{className:"size-4 text-green-500"});case"failed":return e.jsx(qf,{className:"text-destructive size-4"})}}function Kb(t){const n=Date.now()-t;return n<6e4?"Just now":n<36e5?`${Math.floor(n/6e4)}m ago`:n<864e5?`${Math.floor(n/36e5)}h ago`:new Date(t).toLocaleDateString()}function Gb(t){const s=t.toNumber();return s>=1e6?`${(s/1e6).toFixed(2)}M`:s>=1e3?`${(s/1e3).toFixed(2)}K`:s.toFixed(4)}function yo(t,s){const n=Vb[t];if(n)return n;const a=t.toLowerCase();return s[a]??s[t]??t}function Qb({record:t,onClick:s}){const{t:n}=O("staking"),a=Zt(),r=yo(t.sourceChain,a),o=yo(t.targetChain,a),d=t.type==="mint",i=d?Xf:sc;return e.jsxs("button",{type:"button",onClick:s,className:"bg-card hover:bg-muted/50 flex w-full items-center gap-3 rounded-lg p-3 text-left transition-colors",children:[e.jsx("div",{className:R("flex size-10 items-center justify-center rounded-full",d?"bg-green-500/10":"bg-orange-500/10"),children:e.jsx(i,{className:R("size-5",d?"text-green-500":"text-orange-500")})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:n(d?"mint":"burn")}),e.jsx(Jb,{status:t.status})]}),e.jsxs("div",{className:"text-muted-foreground flex items-center gap-1 text-xs",children:[e.jsx("span",{children:r}),e.jsx("span",{children:""}),e.jsx("span",{children:o})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(ot,{symbol:t.sourceAsset,size:"sm"}),e.jsx("span",{className:"font-medium",children:Gb(t.sourceAmount)})]}),e.jsx("div",{className:"text-muted-foreground text-xs",children:Kb(t.createdAt)})]})]})}function Cu({filterType:t="all",onRecordClick:s,className:n}){const{t:a}=O("staking"),[r,o]=c.useState([]),[d,i]=c.useState(!0),[l,m]=c.useState(t==="all"?"all":t);c.useEffect(()=>{let x=!0;return i(!0),Vt.getTransactions().then(y=>{x&&(o(y),i(!1))}),()=>{x=!1}},[]);const u=c.useMemo(()=>l==="all"?r:r.filter(x=>x.type===l),[r,l]),f=[{id:"all",label:a("history")},{id:"mint",label:a("mint")},{id:"burn",label:a("burn")}],h=c.useCallback(()=>{i(!0),Vt.getTransactions().then(x=>{o(x),i(!1)})},[]);return d?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Te,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:a("loading")})]}):e.jsxs("div",{className:R("space-y-4",n),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[f.map(x=>e.jsx(J,{type:"button",variant:l===x.id?"default":"outline",size:"sm",onClick:()=>m(x.id),children:x.label},x.id)),e.jsx(J,{type:"button",variant:"ghost",size:"sm",className:"ml-auto",onClick:h,children:a("refresh")})]}),u.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:a("noTransactions")})}):e.jsx("div",{className:"space-y-2",children:u.map(x=>e.jsx(Qb,{record:x,onClick:()=>s?.(x)},x.id))})]})}Cu.__docgenInfo={description:"Staking record list component",methods:[],displayName:"StakingRecordList",props:{filterType:{required:!1,tsType:{name:"union",raw:"StakingTxType | 'all'",elements:[{name:"StakingTxType"},{name:"literal",value:"'all'"}]},description:"Filter by transaction type",defaultValue:{value:"'all'",computed:!1}},onRecordClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(record: StakingTransaction) => void",signature:{arguments:[{type:{name:"StakingTransaction"},name:"record"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};function ku(){const{t}=O("staking"),{goBack:s}=ce(),[n,a]=c.useState("overview"),r=[{id:"overview",label:t("overview")},{id:"mint",label:t("mint")},{id:"burn",label:t("burn")},{id:"history",label:t("history")}],o=d=>{a("mint")};return e.jsxs("div",{className:"flex min-h-screen flex-col bg-background",children:[e.jsx(K,{title:t("title"),onBack:s}),e.jsx("div",{className:"flex border-b border-border px-4",children:r.map(d=>e.jsx("button",{onClick:()=>a(d.id),className:R("flex-1 py-3 text-sm font-medium transition-colors",n===d.id?"border-b-2 border-primary text-primary":"text-muted-foreground hover:text-foreground"),children:d.label},d.id))}),e.jsxs("div",{className:"flex-1 p-4",children:[n==="overview"&&e.jsx(ju,{onMint:o}),n==="mint"&&e.jsx(Yb,{}),n==="burn"&&e.jsx(Xb,{}),n==="history"&&e.jsx(Cu,{})]})]})}function Yb(){const{t}=O("staking"),s=n=>{};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:t("mintDescription")}),e.jsx(Nu,{onSuccess:s})]})}function Xb(){const{t}=O("staking"),s=n=>{};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:t("burnDescription")}),e.jsx(wu,{onSuccess:s})]})}ku.__docgenInfo={description:"Staking page with tab navigation",methods:[],displayName:"StakingPage"};const Su=()=>e.jsx(oe,{children:e.jsx(ku,{})});Su.__docgenInfo={description:"",methods:[],displayName:"StakingActivity"};const Zb=js({assetType:ie(),decimals:Jn(),amount:ie().optional(),useDefaultDecimals:It().optional(),logoUrl:ie().optional(),contractAddress:ie().optional()}),ej=js({address:ie(),symbol:ie(),addressKey:ie(),mainWalletId:ie(),chain:ie(),mnemonic:ie().optional(),privateKey:ie(),publicKey:ie().optional(),isCustomAssets:It().optional(),isFreezed:It().optional(),assets:cr(Zb),name:ie(),prohibitChangeName:It().optional(),index:Jn().optional(),purpose:Zo([wt(44),wt(49),wt(84),wt(86)]).optional()}),tj=js({chainName:ie(),addressKey:ie(),address:ie(),symbol:ie(),mainWalletId:ie(),index:Jn().optional(),purpose:Zo([wt(44),wt(49),wt(84),wt(86)]).optional()});js({name:ie(),skipBackup:It().optional(),importPhrase:ie(),importType:ie(),addressKeyList:cr(tj),mainWalletId:ie(),headSculpture:ie(),createTimestamp:Jn(),lastBitcoinAddressKey:ie().optional()});js({addressBookId:ie(),name:ie(),address:ie(),chainList:cr(ie()).optional(),remarks:ie().optional(),iconName:ie().optional(),symbol:ie().optional()});js({password:ie(),passwordTips:ie().optional(),lastWalletActivate:ej.optional(),walletLock:It().optional(),fingerprintLock:It().optional(),fingerprintPay:It().optional()});const sj=c.createContext(null);function nj(){return c.useContext(sj)}const aj="keyapp_welcome_shown";function vn(){localStorage.setItem(aj,"1")}function Au(){const{t}=O("guide"),{navigate:s}=ce(),[n,a]=c.useState(0),r=nj(),o=c.useMemo(()=>[{icon:e.jsx(oc,{className:"text-primary size-16"}),title:t("welcome.slides.transfer.title"),description:t("welcome.slides.transfer.description")},{icon:e.jsx(ic,{className:"text-primary size-16"}),title:t("welcome.slides.multichain.title"),description:t("welcome.slides.multichain.description")},{icon:e.jsx(Uf,{className:"text-primary size-16"}),title:t("welcome.slides.security.title"),description:t("welcome.slides.security.description")}],[t]),d=o[n];if(!d)return null;const i=c.useCallback(()=>{vn(),s({to:"/wallet/create"})},[s]),l=c.useCallback(()=>{vn(),s({to:"/onboarding/recover"})},[s]),m=c.useCallback(()=>{vn(),s({to:"/onboarding/migrate"})},[s]),u=c.useCallback(()=>{vn(),s({to:"/"})},[s]),f=c.useCallback(()=>{n<o.length-1&&a(y=>y+1)},[n,o.length]),h=n===o.length-1,x=r?.shouldPromptMigration;return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx("div",{className:"flex justify-end p-4",children:e.jsx(J,{variant:"ghost",size:"sm","data-testid":"skip-button",onClick:u,children:t("welcome.skip")})}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center px-8",children:[e.jsx("div",{className:"bg-primary/10 mb-8 flex size-32 items-center justify-center rounded-full",children:d.icon}),e.jsx("h1",{className:"mb-4 text-center text-2xl font-bold",children:d.title}),e.jsx("p",{className:"text-muted-foreground mb-8 max-w-sm text-center",children:d.description}),e.jsx("div",{className:"mb-8 flex gap-2",children:o.map((y,p)=>e.jsx("button",{"data-testid":`slide-dot-${p}`,onClick:()=>a(p),className:R("size-2 rounded-full transition-colors",p===n?"bg-primary":"bg-muted-foreground/30"),"aria-label":t("welcome.goToSlide",{number:p+1})},p))})]}),e.jsx("div",{className:"p-6",children:h?e.jsxs("div",{className:"flex flex-col gap-3",children:[x&&e.jsxs(J,{"data-testid":"migrate-button",onClick:m,className:"w-full",size:"lg",variant:"default",children:[e.jsx(en,{className:"mr-2 size-4"}),t("welcome.migrateFromMpay")]}),e.jsx(J,{"data-testid":"get-started-button",onClick:i,className:"w-full",size:"lg",variant:x?"outline":"default",children:t("welcome.getStarted")}),e.jsx(J,{"data-testid":"have-wallet-button",onClick:l,variant:"outline",className:"w-full",size:"lg",children:t("welcome.haveWallet")})]}):e.jsxs(J,{"data-testid":"next-button",onClick:f,className:"w-full",size:"lg",children:[t("welcome.next"),e.jsx(De,{className:"ml-2 size-4"})]})})]})}Au.__docgenInfo={description:"",methods:[],displayName:"WelcomeScreen"};const Iu=()=>e.jsx(oe,{children:e.jsx(Au,{})});Iu.__docgenInfo={description:"",methods:[],displayName:"WelcomeActivity"};function Tu(){const{t}=O(["wallet","onboarding","security","common"]),{goBack:s}=ce(),n=Fe(),a=Gs(),r=Je(),[o,d]=c.useState("select"),[i,l]=c.useState([]),[m,u]=c.useState([]),[f,h]=c.useState(!1),x=c.useRef(!1);c.useEffect(()=>{!x.current&&n&&(l(n.chainAddresses.map(v=>v.chain)),x.current=!0)},[n]);const y=c.useCallback(()=>{if(!n)return!1;const v=new Set(n.chainAddresses.map(j=>j.chain));return v.size!==i.length?!0:i.some(j=>!v.has(j))},[n,i]),p=c.useCallback(()=>{if(!y()){s();return}d("verify")},[y,s]),g=c.useCallback(async v=>{if(!(!n||v.length<4)){h(!1),d("saving");try{const j=Be(v);await ge.updateWalletChainAddresses(n.id,i,j,a),!i.includes(r)&&i.length>0&&ge.setSelectedChain(i[0]),d("success"),setTimeout(()=>{s()},1500)}catch(j){j instanceof Error&&j.message.includes("decrypt")?(h(!0),u([]),d("verify"),setTimeout(()=>{h(!1)},1500)):d("select")}}},[n,i,a,s]);return n?o==="saving"?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(K,{title:t("wallet:chains.title")}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx(Te,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground",children:t("wallet:chains.saving")})]})]}):o==="success"?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(K,{title:t("wallet:chains.title")}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-green-500/10",children:e.jsx(je,{className:"size-8 text-green-500"})}),e.jsx("p",{className:"font-medium",children:t("wallet:chains.success")})]})]}):o==="verify"?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(K,{title:t("wallet:chains.verifyTitle"),onBack:()=>{d("select"),u([])}}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:t("wallet:chains.verifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("wallet:chains.verifyDesc")})]}),e.jsx(mt,{value:m,onChange:u,onComplete:g,minPoints:4,error:f,"data-testid":"wallet-chains-pattern"})]})]}):e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(K,{title:t("wallet:chains.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Ys,{icon:e.jsx(bs,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:t("onboarding:chainSelector.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("onboarding:chainSelector.subtitle")})]}),a.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(Te,{})}):e.jsx(or,{"data-testid":"wallet-chains-selector",chains:a,selectedChains:i,onSelectionChange:l}),e.jsx(Ue,{variant:"mint",className:"w-full","data-testid":"wallet-chains-save",disabled:i.length===0,onClick:p,children:y()?t("common:save"):t("common:done")})]})]}):e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(K,{title:t("wallet:chains.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx(Jt,{variant:"warning",children:t("wallet:chains.noWallet")})})]})}Tu.__docgenInfo={description:"",methods:[],displayName:"WalletChainsPage"};const Pu=()=>e.jsx(oe,{children:e.jsx(Tu,{})});Pu.__docgenInfo={description:"",methods:[],displayName:"SettingsWalletChainsActivity"};function ya(t){if(t===0)return"0 B";const s=1024,n=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(s));return`${parseFloat((t/Math.pow(s,a)).toFixed(2))} ${n[a]}`}function _u(){const{t}=O(["settings","common"]),{goBack:s}=ce(),{push:n}=X(),[a,r]=c.useState(null),[o,d]=c.useState(!0),i=c.useCallback(async()=>{d(!0);try{if(navigator.storage&&navigator.storage.estimate){const m=await navigator.storage.estimate();r({usage:m.usage??0,quota:m.quota??0})}}catch{}finally{d(!1)}},[]);c.useEffect(()=>{i()},[i]);const l=a?a.usage/a.quota*100:0;return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("settings:storage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"bg-primary/10 flex size-10 items-center justify-center rounded-full",children:e.jsx(ac,{className:"text-primary size-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:t("settings:storage.usage")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:t("settings:storage.basedOn")})]})]}),o?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(ve,{className:"text-muted-foreground size-6 animate-spin"})}):a?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"bg-muted h-3 w-full overflow-hidden rounded-full",children:e.jsx("div",{className:"bg-primary h-full rounded-full transition-all",style:{width:`${Math.min(l,100)}%`}})}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[t("settings:storage.used"),": ",ya(a.usage)]}),e.jsxs("span",{className:"text-muted-foreground",children:[t("settings:storage.total"),": ",ya(a.quota)]})]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:t("settings:storage.usagePercent")}),e.jsxs("span",{className:"font-medium",children:[l.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:t("settings:storage.available")}),e.jsx("span",{className:"font-medium",children:ya(a.quota-a.usage)})]})]})]}):e.jsx("p",{className:"text-muted-foreground text-center py-4",children:t("settings:storage.unavailable")})]}),e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"font-medium mb-2",children:t("settings:storage.clearTitle")}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:t("settings:storage.clearDesc")}),e.jsxs(J,{variant:"destructive",className:"w-full",onClick:()=>n("ClearDataConfirmJob",{}),children:[e.jsx(es,{className:"size-4 mr-2"}),t("settings:items.clearData")]})]})]})]})}_u.__docgenInfo={description:"",methods:[],displayName:"SettingsStoragePage"};const Eu=()=>e.jsx(oe,{children:e.jsx(_u,{})});Eu.__docgenInfo={description:"",methods:[],displayName:"SettingsStorageActivity"};const Mu=()=>{const{t}=O("common"),{pop:s}=X(),n=Ae(Xa),[a,r]=c.useState(!1),[o,d]=c.useState(null),[i,l]=c.useState(""),[m,u]=c.useState(""),[f,h]=c.useState(null),[x,y]=c.useState(!1),[p,g]=c.useState(!1),[v,j]=c.useState(null),N=c.useCallback(async w=>{y(!0),h(null);try{const E=new URL(w).toString(),D=await fetch(E);if(D.ok){const z=await D.json();z.name&&typeof z.name=="string"&&h(z.name)}}catch{}finally{y(!1)}},[]);c.useEffect(()=>{if(!i.trim()){h(null);return}try{new URL(i)}catch{return}const w=setTimeout(()=>{N(i)},500);return()=>clearTimeout(w)},[i,N]);const b=()=>{r(!0),d(null),l(""),u(""),h(null),j(null)},S=w=>{r(!0),d(w.url),l(w.url),u(w.name),h(null),j(null)},k=()=>{r(!1),d(null),l(""),u(""),h(null),j(null)},P=async()=>{if(!i.trim()){j(t("sources.enterUrl"));return}let w;try{w=new URL(i).toString()}catch{j(t("sources.invalidUrl"));return}const E=m.trim()||f||t("sources.customSource");if(o)if(o!==w){if(n.sources.some(D=>D.url===w)){j(t("sources.alreadyExists"));return}Re.removeSource(o),Re.addSource(w,E)}else Re.updateSourceName(o,E);else{if(n.sources.some(D=>D.url===w)){j(t("sources.alreadyExists"));return}Re.addSource(w,E)}k(),Um(w)},_=w=>{Re.removeSource(w)},A=w=>{Re.toggleSource(w)},T=async()=>{g(!0);try{await Do()}catch{}g(!1)},C=o===null,I=f?t("sources.nameWithDefault",{name:f}):t("sources.namePlaceholder");return e.jsx(oe,{children:e.jsxs("div",{className:"bg-background flex h-full flex-col",children:[e.jsx("div",{className:"bg-background sticky top-0 z-10 border-b",children:e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[e.jsx("button",{onClick:()=>s(),className:"hover:bg-muted rounded-full p-1.5 transition-colors","aria-label":t("back"),children:e.jsx(Go,{className:"size-5",stroke:1.5})}),e.jsx("h1",{className:"flex-1 text-lg font-semibold",children:t("sources.title")}),e.jsx("button",{onClick:T,disabled:p,className:"hover:bg-muted rounded-full p-1.5 transition-colors","aria-label":t("refresh"),children:e.jsx(ts,{className:R("size-5",p&&"animate-spin"),stroke:1.5})})]})}),e.jsxs("div",{className:"flex-1 space-y-3 overflow-y-auto p-4",children:[n.sources.map(w=>e.jsx(rj,{source:w,onToggle:()=>A(w.url),onRemove:()=>_(w.url),onEdit:()=>S(w),isSelected:o===w.url},w.url)),n.sources.length===0&&e.jsx("div",{className:"text-muted-foreground py-12 text-center",children:t("sources.noSources")})]}),a?e.jsxs("div",{className:"bg-background space-y-3 border-t p-4",children:[e.jsx("textarea",{value:i,onChange:w=>{l(w.target.value),j(null)},placeholder:t("sources.urlPlaceholder"),rows:1,spellCheck:!1,className:"bg-background focus:ring-primary [field-sizing:content] w-full resize-none rounded-lg border px-3 py-2 focus:ring-2 focus:outline-none"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:m,onChange:w=>u(w.target.value),placeholder:I,className:"bg-background focus:ring-primary w-full rounded-lg border px-3 py-2 pr-8 focus:ring-2 focus:outline-none"}),x&&e.jsx(ve,{className:"text-muted-foreground absolute top-1/2 right-3 size-4 -translate-y-1/2 animate-spin"})]}),v&&e.jsx("p",{className:"text-destructive text-sm",children:v}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:k,className:"bg-muted hover:bg-muted/80 flex-1 rounded-lg py-2 font-medium",children:t("cancel")}),e.jsx("button",{onClick:P,className:"bg-primary text-primary-foreground hover:bg-primary/90 flex-1 rounded-lg py-2 font-medium",children:t(C?"add":"save")})]})]}):e.jsx("div",{className:"border-t p-4",children:e.jsxs("button",{onClick:b,className:"border-muted-foreground/30 hover:border-primary hover:bg-primary/5 text-muted-foreground hover:text-primary flex w-full items-center justify-center gap-2 rounded-xl border-2 border-dashed py-3 transition-colors",children:[e.jsx(ut,{className:"size-5",stroke:1.5}),e.jsx("span",{children:t("sources.addSource")})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};function rj({source:t,onToggle:s,onRemove:n,onEdit:a,isSelected:r}){const{t:o}=O("common"),d=t.url.includes("ecosystem.json"),i=t.status==="error"||t.status!=="loading"&&!!t.errorMessage;let l=null;return i?l=e.jsx(_t,{className:"size-3 text-red-500"}):t.status==="loading"?l=e.jsx(ve,{className:"text-muted-foreground size-3 animate-spin"}):t.status==="success"&&(l=e.jsx(je,{className:"size-3 text-green-500"})),e.jsx("div",{className:R("cursor-pointer rounded-xl border p-4 transition-colors",t.enabled?"bg-card":"bg-muted/30 opacity-60",r&&"ring-primary ring-2"),onClick:a,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/10 shrink-0 rounded-full p-2",children:e.jsx(cc,{className:"text-primary size-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"truncate font-medium",children:t.name}),d&&e.jsx("span",{className:"bg-primary/10 text-primary rounded px-1.5 py-0.5 text-xs",children:o("sources.official")}),l]}),e.jsx("p",{className:"text-muted-foreground mt-0.5 truncate text-sm",children:t.url}),e.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:o("sources.updatedAt",{date:new Date(t.lastUpdated).toLocaleString()})}),i&&e.jsx("p",{className:"truncate text-xs text-red-500",children:t.errorMessage??o("service.queryFailed")})]})]}),e.jsxs("div",{className:"flex shrink-0 items-center gap-1",onClick:m=>m.stopPropagation(),children:[e.jsx("button",{onClick:s,className:R("rounded-full p-2 transition-colors",t.enabled?"bg-green-100 text-green-600 hover:bg-green-200":"bg-muted text-muted-foreground hover:bg-muted/80"),"aria-label":t.enabled?o("disable"):o("enable"),children:t.enabled?e.jsx(je,{className:"size-4",stroke:2}):e.jsx(tn,{className:"size-4",stroke:2})}),!d&&e.jsx("button",{onClick:n,className:"text-muted-foreground hover:text-destructive hover:bg-destructive/10 rounded-full p-2 transition-colors","aria-label":o("delete"),children:e.jsx(es,{className:"size-4",stroke:1.5})})]})]})})}Mu.__docgenInfo={description:"",methods:[],displayName:"SettingsSourcesActivity"};function Qt({className:t,size:s="default",...n}){return e.jsx("div",{"data-slot":"card","data-size":s,className:R("ring-foreground/10 bg-card text-card-foreground gap-4 overflow-hidden rounded-xl py-4 text-sm ring-1 has-data-[slot=card-footer]:pb-0 has-[>img:first-child]:pt-0 data-[size=sm]:gap-3 data-[size=sm]:py-3 data-[size=sm]:has-data-[slot=card-footer]:pb-0 *:[img:first-child]:rounded-t-xl *:[img:last-child]:rounded-b-xl group/card flex flex-col",t),...n})}function Wa({className:t,...s}){return e.jsx("div",{"data-slot":"card-header",className:R("gap-1 rounded-t-xl px-4 group-data-[size=sm]/card:px-3 [.border-b]:pb-4 group-data-[size=sm]/card:[.border-b]:pb-3 group/card-header @container/card-header grid auto-rows-min items-start has-data-[slot=card-action]:grid-cols-[1fr_auto] has-data-[slot=card-description]:grid-rows-[auto_auto]",t),...s})}function $a({className:t,...s}){return e.jsx("div",{"data-slot":"card-title",className:R("text-base leading-snug font-medium group-data-[size=sm]/card:text-sm",t),...s})}function qa({className:t,...s}){return e.jsx("div",{"data-slot":"card-description",className:R("text-muted-foreground text-sm",t),...s})}function Yt({className:t,...s}){return e.jsx("div",{"data-slot":"card-content",className:R("px-4 group-data-[size=sm]/card:px-3",t),...s})}Qt.__docgenInfo={description:"",methods:[],displayName:"Card",props:{size:{required:!1,tsType:{name:"union",raw:'"default" | "sm"',elements:[{name:"literal",value:'"default"'},{name:"literal",value:'"sm"'}]},description:"",defaultValue:{value:'"default"',computed:!1}}}};Wa.__docgenInfo={description:"",methods:[],displayName:"CardHeader"};$a.__docgenInfo={description:"",methods:[],displayName:"CardTitle"};qa.__docgenInfo={description:"",methods:[],displayName:"CardDescription"};Yt.__docgenInfo={description:"",methods:[],displayName:"CardContent"};const ij=Yu("h-5 gap-1 rounded-4xl border border-transparent px-2 py-0.5 text-xs font-medium transition-all has-data-[icon=inline-end]:pr-1.5 has-data-[icon=inline-start]:pl-1.5 [&>svg]:size-3! inline-flex items-center justify-center w-fit whitespace-nowrap shrink-0 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-colors overflow-hidden group/badge",{variants:{variant:{default:"bg-primary text-primary-foreground [a]:hover:bg-primary/80",secondary:"bg-secondary text-secondary-foreground [a]:hover:bg-secondary/80",destructive:"bg-destructive/10 [a]:hover:bg-destructive/20 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 text-destructive dark:bg-destructive/20",outline:"border-border text-foreground [a]:hover:bg-muted [a]:hover:text-muted-foreground",ghost:"hover:bg-muted hover:text-muted-foreground dark:hover:bg-muted/50",link:"text-primary underline-offset-4 hover:underline"}},defaultVariants:{variant:"default"}});function ba({className:t,variant:s="default",render:n,...a}){return Xm({defaultTagName:"span",props:Tf({className:R(ij({className:t,variant:s}))},a),...n!==void 0?{render:n}:{},state:{slot:"badge",variant:s}})}function oj({permission:t}){const n=Jm[t]?.risk??"medium",a=Km(t),r=n==="high"?Oe:nr,o=n==="high"?"text-red-500":n==="medium"?"text-amber-500":"text-green-500";return e.jsxs("div",{className:"flex items-start gap-3 py-3",children:[e.jsx(r,{className:R("mt-0.5 size-5 shrink-0",o),stroke:1.5}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:a.label}),e.jsx("p",{className:"text-muted-foreground mt-0.5 text-xs",children:a.description})]})]})}function cj({directive:t}){const{t:s}=O("ecosystem"),n=s(`permissionsPolicy.${t}.name`,{defaultValue:t}),a=s(`permissionsPolicy.${t}.description`,{defaultValue:s("permissionsPolicy.defaultDescription")});return e.jsxs("div",{className:"flex items-start gap-3 py-3",children:[e.jsx(nr,{className:"text-sky-500 mt-0.5 size-5 shrink-0",stroke:1.5}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:n}),e.jsx("p",{className:"text-muted-foreground mt-0.5 text-xs",children:a})]})]})}function os({label:t,value:s,isLink:n=!1,href:a}){const r=e.jsxs("div",{className:"border-border/50 flex items-center justify-between border-b py-3 last:border-0",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t}),e.jsxs("span",{className:R("text-sm font-medium",n&&"text-primary flex items-center gap-1"),children:[s,n&&e.jsx(De,{className:"size-4"})]})]});return n&&a?e.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",children:r}):r}const Ru=({params:t})=>{const{pop:s}=X(),{t:n}=O("ecosystem"),[a,r]=c.useState(null),[o,d]=c.useState(!0),[i,l]=c.useState(!1),m=Ae(Xa,v=>Vm.isAppInstalled(v,t.appId));c.useEffect(()=>{let v=!1;return(async()=>{d(!0),await Mo();let N=Zr(t.appId);N||(await Do({force:!1}),N=Zr(t.appId)),!v&&(r(N??null),d(!1))})(),()=>{v=!0}},[t.appId]);const u=c.useCallback(()=>{a&&Re.installApp(a.id)},[a]),f=c.useCallback(()=>{a&&(Re.updateAppLastUsed(a.id),Re.setActiveSubPage("mine"),Ro(a.id,{...a,targetDesktop:"mine"}),s())},[a,s]);if(o)return e.jsx(oe,{children:e.jsx("div",{className:"bg-background flex min-h-screen items-center justify-center",children:e.jsx(Te,{size:"lg"})})});if(!a)return e.jsx(oe,{children:e.jsxs("div",{className:"bg-background flex min-h-screen flex-col items-center justify-center gap-4",children:[e.jsx("p",{className:"text-muted-foreground",children:n("detail.notFound")}),e.jsx("button",{onClick:()=>s(),className:"bg-primary text-primary-foreground rounded-full px-4 py-2 text-sm font-medium",children:n("detail.back")})]})});const h=a.longDescription??a.description,x=h.length>150,y=i||!x?h:h.slice(0,150)+"...",p=a.permissions??[],g=a.permissionsPolicy??[];return e.jsx(oe,{children:e.jsxs("div",{className:"bg-background detail-scroll-container flex min-h-screen flex-col",children:[e.jsx("div",{className:"bg-background/80 border-border/50 sticky top-0 z-20 border-b backdrop-blur-xl",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[e.jsx("button",{onClick:()=>s(),className:"hover:bg-muted -ml-1.5 rounded-full p-1.5 transition-colors",children:e.jsx(Go,{className:"size-5",stroke:1.5})}),e.jsx("span",{className:"detail-header-title max-w-[200px] truncate font-semibold",children:a.name}),e.jsx("button",{className:"hover:bg-muted -mr-1.5 rounded-full p-1.5 transition-colors",children:e.jsx($s,{className:"size-5",stroke:1.5})})]})}),e.jsxs("div",{className:"detail-scroller flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"px-5 pt-4 pb-5",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(Qm,{src:a.icon,name:a.name,size:"2xl",shadow:"lg",className:"shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1 pt-1",children:[e.jsx("h1",{className:"truncate text-xl font-bold",children:a.name}),e.jsx("p",{className:"text-muted-foreground mt-0.5 truncate text-sm",children:a.author??n("detail.unknownDeveloper")}),m?e.jsx("button",{onClick:f,className:"bg-primary text-primary-foreground mt-4 rounded-full px-8 py-2 text-sm font-semibold",children:n("detail.open")}):e.jsx("button",{onClick:u,className:"bg-primary text-primary-foreground mt-4 rounded-full px-8 py-2 text-sm font-semibold",children:n("detail.get")})]})]}),e.jsxs("div",{className:"text-muted-foreground mt-5 flex items-center gap-4 text-xs",children:[a.category&&e.jsx("span",{className:"text-foreground font-medium",children:n(`detail.categories.${a.category}`,{defaultValue:a.category})}),a.beta&&e.jsx("span",{className:"rounded-full bg-amber-100 px-2 py-0.5 font-medium text-amber-700 dark:bg-amber-900/30 dark:text-amber-400",children:n("detail.beta")}),e.jsxs("span",{children:["v",a.version]})]})]}),a.screenshots&&a.screenshots.length>0&&e.jsx("div",{className:"border-border/50 border-t",children:e.jsxs("div",{className:"px-5 py-4",children:[e.jsx("h2",{className:"mb-4 text-lg font-bold",children:n("detail.preview")}),e.jsx("div",{className:"-mx-5 flex snap-x snap-mandatory gap-3 overflow-x-auto px-5 pb-2",style:{scrollbarWidth:"none"},children:a.screenshots.map((v,j)=>e.jsx("div",{className:"bg-muted aspect-[9/19.5] w-[220px] shrink-0 snap-center overflow-hidden rounded-2xl shadow-lg ring-1 ring-black/5",children:e.jsx("img",{src:v,alt:`${a.name} screenshot ${j+1}`,className:"h-full w-full object-cover",loading:"lazy",onError:N=>{const b=N.currentTarget.parentElement;b&&(b.style.display="none")}})},v))})]})}),e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:y}),x&&e.jsxs("button",{onClick:()=>l(!i),className:"text-primary mt-2 flex items-center gap-1 text-sm font-medium",children:[n(i?"detail.collapse":"detail.more"),i?e.jsx(Bo,{className:"size-4"}):e.jsx(Wo,{className:"size-4"})]})]}),a.chains&&a.chains.length>0&&e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("h2",{className:"mb-3 text-lg font-bold",children:n("detail.supportedChains")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.chains.map(v=>e.jsx("span",{className:"bg-muted rounded-full px-3 py-1.5 text-sm font-medium",children:v},v))})]}),(p.length>0||g.length>0)&&e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-bold",children:n("detail.privacy")}),e.jsx(ba,{variant:"outline",children:p.length+g.length})]}),e.jsxs("div",{className:"space-y-3",children:[p.length>0&&e.jsxs(Qt,{size:"sm",children:[e.jsxs(Wa,{className:"border-b",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx($a,{children:n("detail.permissions")}),e.jsx(ba,{variant:"secondary",children:p.length})]}),e.jsx(qa,{children:n("detail.privacyHint")})]}),e.jsx(Yt,{className:"divide-y divide-border/50",children:p.map(v=>e.jsx(oj,{permission:v},v))})]}),g.length>0&&e.jsxs(Qt,{size:"sm",children:[e.jsxs(Wa,{className:"border-b",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx($a,{children:n("permissionsPolicy.title")}),e.jsx(ba,{variant:"secondary",children:g.length})]}),e.jsx(qa,{children:n("permissionsPolicy.hint")})]}),e.jsx(Yt,{className:"divide-y divide-border/50",children:g.map(v=>e.jsx(cj,{directive:v},v))})]})]})]}),a.tags&&a.tags.length>0&&e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("h2",{className:"mb-3 text-lg font-bold",children:n("detail.tags")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.tags.map(v=>e.jsx("span",{className:"bg-primary/10 text-primary rounded-full px-3 py-1.5 text-sm font-medium",children:n("detail.tagLabel",{tag:v})},v))})]}),e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("h2",{className:"mb-2 text-lg font-bold",children:n("detail.info")}),e.jsxs("div",{className:"bg-muted/50 rounded-2xl px-4",children:[a.author&&e.jsx(os,{label:n("detail.developer"),value:a.author}),e.jsx(os,{label:n("detail.version"),value:a.version}),a.category&&e.jsx(os,{label:n("detail.category"),value:n(`detail.categories.${a.category}`,{defaultValue:a.category})}),a.publishedAt&&e.jsx(os,{label:n("detail.publishedAt"),value:a.publishedAt}),a.updatedAt&&e.jsx(os,{label:n("detail.updatedAt"),value:a.updatedAt}),a.website&&e.jsx(os,{label:n("detail.website"),value:n("detail.visit"),isLink:!0,href:a.website})]})]}),e.jsx("div",{className:"h-8"})]})]})})};Ru.__docgenInfo={description:"",methods:[],displayName:"MiniappDetailActivity"};function Vs({className:t,...s}){return e.jsx("label",{"data-slot":"label",className:R("gap-2 text-sm leading-none font-medium group-data-[disabled=true]:opacity-50 peer-disabled:opacity-50 flex items-center select-none group-data-[disabled=true]:pointer-events-none peer-disabled:cursor-not-allowed",t),...s})}Vs.__docgenInfo={description:"",methods:[],displayName:"Label"};function lj({queryAddress:t,queryChain:s}){const{t:n}=O(["common"]),a=Qs(),r=ns(),{data:o,isLoading:d,error:i}=r.nativeBalance.useState({address:t},{enabled:!!t});return e.jsx(Qt,{className:R("transition-all",d&&"opacity-50"),children:e.jsx(Yt,{className:"pt-6",children:i?e.jsxs("div",{className:"flex items-center gap-3 text-destructive",children:[e.jsx(_t,{className:"size-5 shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:n("common:addressLookup.error")}),e.jsx("div",{className:"text-sm opacity-80",children:i.message})]})]}):o?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-primary/10 flex size-12 items-center justify-center rounded-full",children:e.jsx(dp,{className:"text-primary size-6"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[o.amount.toFormatted()," ",o.symbol]}),e.jsx("div",{className:"text-muted-foreground text-sm",children:n("common:addressLookup.onChain",{chain:a.find(l=>l.id===s)?.name??s})})]})]}):d?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx(Te,{size:"lg"})}):null})})}function Lu(){const{t}=O(["common","wallet"]),{goBack:s}=ce(),n=Qs(),[a,r]=c.useState("ethereum"),[o,d]=c.useState(""),[i,l]=c.useState(""),[m,u]=c.useState(""),[f,h]=c.useState(!1),x=c.useCallback(()=>{o.trim()&&(h(!0),l(o.trim()),u(a),setTimeout(()=>h(!1),100))},[o,a]),y=c.useCallback(v=>{v.key==="Enter"&&x()},[x]),p=n.filter(v=>v.chainKind==="evm"),g=n.filter(v=>v.chainKind!=="evm");return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(K,{title:t("common:addressLookup.balanceTitle"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Vs,{children:t("common:addressLookup.chain")}),e.jsxs(Os,{value:a,onValueChange:v=>v&&r(v),children:[e.jsx(Bs,{children:e.jsx(Fs,{})}),e.jsxs(Ws,{children:[p.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:"EVM"}),p.map(v=>e.jsx(Gt,{value:v.id,children:v.name},v.id))]}),g.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:t("common:addressLookup.otherChains")}),g.map(v=>e.jsx(Gt,{value:v.id,children:v.name},v.id))]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Vs,{children:t("common:addressLookup.address")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ve,{placeholder:t("common:addressLookup.addressPlaceholder"),value:o,onChange:v=>d(v.target.value),onKeyDown:y,className:"flex-1 font-mono text-sm"}),e.jsx(J,{onClick:x,disabled:!o.trim()||f,children:f?e.jsx(Te,{size:"sm"}):e.jsx(Zs,{className:"size-4"})})]})]}),i&&m&&e.jsx(Lt,{chainId:m,fallback:e.jsx(Qt,{children:e.jsx(Yt,{className:"pt-6",children:e.jsx("p",{className:"text-muted-foreground text-center",children:"Chain not supported"})})}),children:e.jsx(lj,{queryAddress:i,queryChain:m})}),!1]})]})}Lu.__docgenInfo={description:"",methods:[],displayName:"AddressBalancePage"};const Du=()=>e.jsx(oe,{children:e.jsx(Lu,{})});Du.__docgenInfo={description:"",methods:[],displayName:"AddressBalanceActivity"};function dj(t,s){return(parseFloat(t)/Math.pow(10,s)).toLocaleString(void 0,{maximumFractionDigits:6})}function uj(t){return new Date(t).toLocaleString()}function mj({tx:t,address:s}){const{t:n}=O("common"),a=t.direction==="out"||t.from.toLowerCase()===s.toLowerCase(),r=t.assets.find(u=>u.assetType==="native"||u.assetType==="token"),o=r?r.value:"0",d=r?r.symbol:"",i=r?r.decimals:0,l=n(a?"signSymbol.minus":"signSymbol.plus"),m=n(a?"addressLookup.toLabel":"addressLookup.fromLabel");return e.jsxs("div",{className:"flex items-center gap-3 py-3 border-b last:border-b-0",children:[e.jsx("div",{className:`p-2 rounded-full ${a?"bg-red-100 text-red-600":"bg-green-100 text-green-600"}`,children:a?e.jsx(sc,{className:"size-4"}):e.jsx(Qf,{className:"size-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"text-sm font-medium truncate",children:[m," ",a?t.to:t.from]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:uj(t.timestamp)})]}),e.jsxs("div",{className:`text-sm font-medium ${a?"text-red-600":"text-green-600"}`,children:[l,dj(o,i)," ",d]})]})}function fj({searchAddress:t,selectedChain:s,explorerUrl:n,onOpenExplorer:a}){const{t:r}=O(["common"]),o=Qs(),d=c.useMemo(()=>o.find(h=>h.id===s),[o,s]),i=ns(),{data:l,isLoading:m,error:u}=i.transactionHistory.useState({address:t,limit:50},{enabled:!!t}),f=!(u instanceof To);return e.jsx(Qt,{children:e.jsxs(Yt,{className:"pt-6",children:[m?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ve,{className:"size-6 animate-spin text-muted-foreground"})}):u?e.jsx("div",{className:"text-center py-8 text-destructive",children:r("common:addressLookup.queryError")}):l&&l.length>0?e.jsx("div",{className:"divide-y",children:l.map(h=>e.jsx(mj,{tx:h,address:t},h.hash))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:f?e.jsx("p",{children:r("common:addressLookup.noTransactions")}):e.jsx("p",{children:r("common:addressLookup.useExplorerHint")})}),n&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs(J,{variant:f?"outline":"default",size:"sm",className:"w-full gap-2",onClick:a,children:[e.jsx(wa,{className:"size-4"}),r("common:addressLookup.viewOnExplorer",{name:d?.name??s})]})})]})})}function zu(){const{t}=O(["common","wallet"]),{goBack:s}=ce(),n=Qs(),[a,r]=c.useState("bfmeta"),[o,d]=c.useState(""),[i,l]=c.useState(""),[m,u]=c.useState(""),f=c.useMemo(()=>n.find(j=>j.id===m),[n,m]),h=c.useMemo(()=>{if(!f?.explorer||!i.trim())return null;const{queryAddress:j,url:N}=f.explorer;return j?j.replace(":address",i.trim()):`${N}/address/${i.trim()}`},[f,i]),x=c.useCallback(()=>{o.trim()&&(l(o.trim()),u(a))},[o,a]),y=c.useCallback(j=>{j.key==="Enter"&&x()},[x]),p=c.useCallback(()=>{h&&window.open(h,"_blank","noopener,noreferrer")},[h]),g=n.filter(j=>j.chainKind==="evm"),v=n.filter(j=>j.chainKind!=="evm");return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(K,{title:t("common:addressLookup.transactionsTitle"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Vs,{children:t("common:addressLookup.chain")}),e.jsxs(Os,{value:a,onValueChange:j=>j&&r(j),children:[e.jsx(Bs,{children:e.jsx(Fs,{})}),e.jsxs(Ws,{children:[g.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:"EVM"}),g.map(j=>e.jsx(Gt,{value:j.id,children:j.name},j.id))]}),v.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:t("common:addressLookup.otherChains")}),v.map(j=>e.jsx(Gt,{value:j.id,children:j.name},j.id))]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Vs,{children:t("common:addressLookup.address")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ve,{placeholder:t("common:addressLookup.addressPlaceholder"),value:o,onChange:j=>d(j.target.value),onKeyDown:y,className:"flex-1 font-mono text-sm"}),e.jsx(J,{onClick:x,disabled:!o.trim(),children:e.jsx(Zs,{className:"size-4"})})]})]}),i&&m&&e.jsx(Lt,{chainId:m,fallback:e.jsx(Qt,{children:e.jsx(Yt,{className:"pt-6",children:e.jsx("p",{className:"text-muted-foreground text-center",children:"Chain not supported"})})}),children:e.jsx(fj,{searchAddress:i,selectedChain:m,explorerUrl:h,onOpenExplorer:p})})]})]})}zu.__docgenInfo={description:"",methods:[],displayName:"AddressTransactionsPage"};const Ou=()=>e.jsx(oe,{children:e.jsx(zu,{})});Ou.__docgenInfo={description:"",methods:[],displayName:"AddressTransactionsActivity"};const{useFlow:X}=ux({transitionDuration:350,plugins:[mx(),Ox({theme:"cupertino"}),Zg({routes:{MainTabsActivity:"/",WalletListActivity:"/wallet/list",WalletConfigActivity:"/wallet/:walletId",WalletCreateActivity:"/wallet/create",SendActivity:"/send",DestroyActivity:"/destroy",ReceiveActivity:"/receive",SettingsActivity:"/settings",SettingsLanguageActivity:"/settings/language",SettingsCurrencyActivity:"/settings/currency",SettingsChainsActivity:"/settings/chains",SettingsMnemonicActivity:"/settings/mnemonic",SettingsWalletLockActivity:"/settings/wallet-lock",SettingsWalletChainsActivity:"/settings/wallet-chains",SettingsStorageActivity:"/settings/storage",HistoryActivity:"/history",TransactionDetailActivity:"/transaction/:txId",ScannerActivity:"/scanner",AuthorizeAddressActivity:"/authorize/address/:id",AuthorizeSignatureActivity:"/authorize/signature/:id",OnboardingRecoverActivity:"/onboarding/recover",TokenDetailActivity:"/token/:tokenId",AddressBookActivity:"/address-book",MyCardActivity:"/my-card",NotificationsActivity:"/notifications",StakingActivity:"/staking",WelcomeActivity:"/welcome",SettingsSourcesActivity:"/settings/sources",MiniappDetailActivity:"/miniapp/:appId/detail",AddressBalanceActivity:"/address-balance",AddressTransactionsActivity:"/address-transactions",ChainSelectorJob:"/job/chain-selector",WalletRenameJob:"/job/wallet-rename/:walletId",WalletDeleteJob:"/job/wallet-delete/:walletId",WalletLockConfirmJob:"/job/wallet-lock-confirm",TwoStepSecretConfirmJob:"/job/two-step-secret-confirm",SetTwoStepSecretJob:"/job/set-two-step-secret",MnemonicOptionsJob:"/job/mnemonic-options",ContactEditJob:"/job/contact-edit",ContactPickerJob:"/job/contact-picker",WalletAddJob:"/job/wallet-add",WalletListJob:"/job/wallet-list",SecurityWarningJob:"/job/security-warning",TransferConfirmJob:"/job/transfer-confirm",TransferWalletLockJob:"/job/transfer-wallet-lock",FeeEditJob:"/job/fee-edit",ScannerJob:"/job/scanner",ContactAddConfirmJob:"/job/contact-add-confirm",ContactShareJob:"/job/contact-share",ClearDataConfirmJob:"/job/clear-data-confirm",WalletPickerJob:"/job/wallet-picker",SigningConfirmJob:"/job/signing-confirm",PermissionRequestJob:"/job/permission-request",MiniappTransferConfirmJob:"/job/miniapp-transfer-confirm",MiniappDestroyConfirmJob:"/job/miniapp-destroy-confirm",MiniappSignTransactionJob:"/job/miniapp-sign-transaction",ChainSwitchConfirmJob:"/job/chain-switch-confirm",CryptoAuthorizeJob:"/job/crypto-authorize"},fallbackActivity:()=>"MainTabsActivity",useHash:!0,urlPatternOptions:{segmentValueCharset:"a-zA-Z0-9-._~ %"}})],activities:{MainTabsActivity:hd,WalletListActivity:gd,WalletConfigActivity:vd,WalletCreateActivity:bd,SendActivity:kd,DestroyActivity:Ad,ReceiveActivity:Td,SettingsActivity:Pd,SettingsLanguageActivity:Ed,SettingsCurrencyActivity:Rd,SettingsChainsActivity:Vd,SettingsMnemonicActivity:Kd,SettingsWalletLockActivity:Qd,SettingsWalletChainsActivity:Pu,SettingsStorageActivity:Eu,HistoryActivity:Xd,TransactionDetailActivity:eu,ScannerActivity:su,AuthorizeAddressActivity:ru,AuthorizeSignatureActivity:ou,OnboardingRecoverActivity:du,TokenDetailActivity:mu,AddressBookActivity:pu,MyCardActivity:gu,NotificationsActivity:yu,StakingActivity:Su,WelcomeActivity:Iu,SettingsSourcesActivity:Mu,MiniappDetailActivity:Ru,AddressBalanceActivity:Du,AddressTransactionsActivity:Ou,ChainSelectorJob:Sl,WalletRenameJob:Il,WalletDeleteJob:Tl,WalletLockConfirmJob:Pl,TwoStepSecretConfirmJob:_l,SetTwoStepSecretJob:Rl,MnemonicOptionsJob:Ll,ContactEditJob:Dl,ContactPickerJob:zl,WalletAddJob:Ol,WalletListJob:Bl,SecurityWarningJob:Fl,TransferConfirmJob:$l,TransferWalletLockJob:Hl,FeeEditJob:Ml,ScannerJob:Ul,ContactAddConfirmJob:Vl,ContactShareJob:Jl,ClearDataConfirmJob:Kl,WalletPickerJob:Gl,SigningConfirmJob:Yl,PermissionRequestJob:Xl,MiniappTransferConfirmJob:od,MiniappDestroyConfirmJob:dd,MiniappSignTransactionJob:ud,ChainSwitchConfirmJob:md,CryptoAuthorizeJob:fd}});function pj(t,s){const n=Math.abs(t-s);return Math.min(n,360-n)}function hj(t,s,n=30){if(s.length===0)return 1;let a=180;for(const r of s){const o=pj(t,r);o<a&&(a=o)}return a<n?a/n:1}function xj(t){return Gu.map(s=>({...s,weight:hj(s.hue,t)}))}const gj="wallet-config-preview-name";function Qn({mode:t,walletId:s,onEditOnlyComplete:n,className:a}){const{t:r}=O(["wallet","onboarding","common"]),{push:o}=X(),d=Et(),i=d.find(M=>M.id===s),l=Je(),m=wo(),u=Xt(),[f,h]=c.useState(t==="edit-only"?"edit":t),[x,y]=c.useState(""),[p,g]=c.useState(0),v=c.useRef(null),[j,N]=c.useState(!1),b=c.useMemo(()=>d.filter(M=>M.id!==s).map(M=>M.themeHue),[d,s]),S=c.useMemo(()=>xj(b),[b]);c.useEffect(()=>{i&&(y(i.name),g(i.themeHue))},[i]);const k=c.useMemo(()=>i?.chainAddresses.find(M=>M.chain===l)??i?.chainAddresses[0],[i,l]),P=c.useCallback(M=>{if(!v.current)return;const F=v.current.getBoundingClientRect(),Z=Math.max(0,Math.min(M-F.left,F.width))/F.width,B=Math.round(Z*3600)/10;g(B)},[]),_=M=>{M.stopPropagation(),N(!0),P(M.clientX)},A=M=>{M.stopPropagation(),N(!0),M.touches[0]&&P(M.touches[0].clientX)};c.useEffect(()=>{if(!j)return;const M=Z=>P(Z.clientX),F=Z=>{Z.touches[0]&&P(Z.touches[0].clientX)},G=()=>N(!1);return document.addEventListener("mousemove",M),document.addEventListener("mouseup",G),document.addEventListener("touchmove",F),document.addEventListener("touchend",G),()=>{document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",G),document.removeEventListener("touchmove",F),document.removeEventListener("touchend",G)}},[j,P]);const T=c.useCallback(()=>{o("ChainSelectorJob",{})},[o]),C=c.useCallback(()=>{i&&(y(i.name),g(i.themeHue)),h("edit")},[i]),I=c.useCallback(async()=>{if(!i)return;const M=x.trim();M&&M!==i.name&&await ge.updateWalletName(i.id,M),p!==i.themeHue&&await ge.updateWalletThemeHue(i.id,p),h("default")},[i,x,p]),w=c.useCallback(()=>{i&&(y(i.name),g(i.themeHue)),h("default")},[i]),E=c.useCallback(async()=>{if(!i)return;const M=x.trim();M&&M!==i.name&&await ge.updateWalletName(i.id,M),p!==i.themeHue&&await ge.updateWalletThemeHue(i.id,p),n?.()},[i,x,p,n]),D=c.useCallback(async()=>{i&&(await ge.setCurrentWallet(i.id),o("SettingsMnemonicActivity",{}))},[i,o]),z=c.useCallback(()=>{i&&o("WalletDeleteJob",{walletId:i.id})},[i,o]);if(!i)return e.jsx("div",{className:R("text-muted-foreground p-4 text-center",a),children:r("wallet:detail.notFound")});const L=f==="edit"||t==="edit-only"?p:i.themeHue,q=f==="edit"||t==="edit-only";return e.jsxs("div",{className:R("space-y-6",a),children:[e.jsx("div",{className:"flex justify-center px-4",children:e.jsx("div",{className:"flex w-full max-w-[360px] aspect-[1.6/1] items-stretch",children:e.jsx(Co,{wallet:{...i,name:q?x:i.name,themeHue:L},themeHue:L,walletNameTestId:gj,chain:k?.chain,chainName:k?.chain||"",address:k?.address||i.address,chainIconUrl:m[k?.chain??""],onOpenChainSelector:T})})}),q?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm",children:r("onboarding:theme.walletName")}),e.jsxs(mm,{children:[e.jsx(fm,{value:x,onChange:M=>y(M.target.value),placeholder:r("wallet:defaultName"),maxLength:20,className:"text-center"}),e.jsx(pm,{align:"inline-end",children:e.jsx(hm,{size:"icon-xs",variant:"ghost",onClick:()=>y(r("onboarding:create.generatedNamePattern",{word:An(u),suffix:r("onboarding:create.walletSuffix")})),title:r("wallet:randomName"),children:e.jsx(hp,{className:"size-4"})})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:r("onboarding:theme.customColor")}),e.jsxs("span",{className:"text-muted-foreground font-mono",children:[p.toFixed(1),""]})]}),e.jsxs("div",{ref:v,className:"relative h-8 cursor-pointer touch-none rounded-full",style:{background:"linear-gradient(to right, oklch(0.6 0.25 0), oklch(0.6 0.25 60), oklch(0.6 0.25 120), oklch(0.6 0.25 180), oklch(0.6 0.25 240), oklch(0.6 0.25 300), oklch(0.6 0.25 360))"},onMouseDown:_,onTouchStart:A,children:[b.map((M,F)=>e.jsx("div",{className:"absolute top-0 h-full w-0.5 bg-black/30",style:{left:`${M/360*100}%`},title:r("onboarding:theme.usedColor")},F)),e.jsx("div",{className:"absolute top-1/2 -translate-x-1/2 -translate-y-1/2",style:{left:`${p/360*100}%`},children:e.jsx("div",{className:"size-6 rounded-full border-2 border-white shadow-md",style:{backgroundColor:`oklch(0.6 0.25 ${p})`}})})]})]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-3",children:S.map(M=>{const F=Math.abs(p-M.hue)<.5,G=M.weight<.5;return e.jsx("button",{type:"button",onClick:()=>g(M.hue),className:R("relative size-10 rounded-full transition-all","ring-offset-background focus-visible:ring-ring focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:outline-none",F&&"ring-primary ring-2 ring-offset-2",G&&"opacity-50"),style:{backgroundColor:M.color},title:r(M.nameKey),children:F&&e.jsx(je,{className:"absolute inset-0 m-auto size-5 text-white drop-shadow-md"})},M.hue)})})]}),t==="edit-only"?e.jsx(J,{className:"w-full",onClick:E,disabled:!x.trim(),"data-testid":"theme-complete-button",style:{"--primary-hue":p,"--primary":`oklch(var(--primary-lightness) var(--primary-saturation) ${p})`},children:r("common:confirm")}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx(J,{variant:"outline",className:"flex-1",onClick:w,children:r("common:cancel")}),e.jsx(J,{className:"flex-1",onClick:I,disabled:!x.trim(),style:{"--primary-hue":p,"--primary":`oklch(var(--primary-lightness) var(--primary-saturation) ${p})`},children:r("common:save")})]})]}):e.jsxs("div",{className:"flex justify-center gap-8",children:[e.jsxs("button",{onClick:C,className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"bg-primary/10 text-primary group-hover:bg-primary/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:e.jsx(_p,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:r("wallet:detail.editName")})]}),e.jsxs("button",{onClick:D,className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"bg-primary/10 text-primary group-hover:bg-primary/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:e.jsx(lr,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:r("wallet:detail.exportMnemonic")})]}),e.jsxs("button",{onClick:z,className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"bg-destructive/10 text-destructive group-hover:bg-destructive/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:e.jsx(es,{className:"size-5"})}),e.jsx("span",{className:"text-destructive text-xs font-medium",children:r("wallet:detail.deleteWallet")})]})]})]})}Qn.__docgenInfo={description:`
- default: + edit
- edit:  default  default
- edit-only: / onEditOnlyComplete`,methods:[],displayName:"WalletConfig",props:{mode:{required:!0,tsType:{name:"union",raw:"'edit-only' | 'default' | 'edit'",elements:[{name:"literal",value:"'edit-only'"},{name:"literal",value:"'default'"},{name:"literal",value:"'edit'"}]},description:""},walletId:{required:!0,tsType:{name:"string"},description:""},onEditOnlyComplete:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};export{fu as A,Ud as C,Sd as D,Np as I,_d as L,xu as M,vu as N,Id as R,Se as S,Zd as T,Jd as V,Qn as W,zu as a,Yd as b,Gd as c,Md as d,Ts as e,Mr as f,xd as g};
