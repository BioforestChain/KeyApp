const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./snapdom-CO8q8LPW.js","./preload-helper-PPVm8Dsz.js","./index-B2mNTGNA.js","./schemas-jh0dXz-I.js","./address-book-DI0wc2JF.js","./iframe-CHpnNFF-.js","./iframe-Bh1ogEJ1.css","./index-D0E7N0oa.js","./bioforest-D91I-84E.js","./address-format-Bt4Tl7ZW.js","./amount-BQsqQYGO.js"])))=>i.map(i=>d[i]);
import{A as _e,w as me,B as de,J as Lt,K as ht,I as ki,u as st,g as Ge,k as fn,x as pn,y as hn,f as Ft,a as Wt,e as xn,d as Gn,b as ms,L as Vd,E as Ai,F as Ti,G as Ii,H as Pi,c as lt,C as gn,M as Kd,D as Ei}from"./address-book-DI0wc2JF.js";import{u as le,r as l,N as Gd,g as Qd,j as e,R as fa,aJ as pa,aH as fs,aI as ps,O as ha,aK as _i,P as Qn,S as Yd,t as Xd}from"./iframe-CHpnNFF-.js";import{a as vn,c as M}from"./utils-CDN07tui.js";import{u as Mi,d as Yn,W as Zd}from"./useWalletTheme-C9gYOoKA.js";import{W as eu,u as Ri}from"./wallet-card-carousel-CK7n_hc7.js";import{W as Di}from"./wallet-card-BK2FJuPy.js";import{I as Pe}from"./input-B1QwEWtC.js";import{B as q}from"./button-DoYcZF2P.js";import{S as tu}from"./swiper-sync-context-BVgHL61L.js";import{T as su}from"./TabBar-Cj99bsul.js";import{u as hs,t as zi,h as nu,c as au,W as ru,C as iu,s as Nt}from"./token-item-BPygPByH.js";import{L as ye,G as Ee,A as wt,P as et,I as xs,b as ou,c as _n}from"./index-CfBoVE1b.js";import{u as L}from"./useTranslation-Cn35rriq.js";import{I as Se}from"./IconAlertTriangle-DhfsXtjK.js";import{b as Tt,I as yn,a as cu}from"./IconTrash-DhVV1Rgj.js";import{c as xa,I as Bi}from"./web-BxSWUboP.js";import{t as lu}from"./web-DIbESPGX.js";import"./index-D0E7N0oa.js";import"./breakpoint-BtpSOnE_.js";import{_ as cs}from"./preload-helper-PPVm8Dsz.js";import{A as ce}from"./amount-BQsqQYGO.js";import{b as gs,i as Li,n as bn,o as du,s as uu,v as Oi,p as mu,q as Fi,r as $s,t as qs,u as fu,w as pu,x as hu,I as xu}from"./index-B2mNTGNA.js";import{c as ne}from"./createReactComponent-BBuOTQib.js";import{I as Hs,a as Wi,b as Mn,c as jn,d as gu,g as vu,e as yu,f as bu}from"./transaction-item-GvXR-Bs6.js";import{I as ju,i as Nu,A as wu}from"./address-input-CkxwDe4R.js";import{I as nt}from"./IconPlus-DTIkeNUq.js";import{A as dt}from"./amount-display-Dupymd1I.js";import"./animated-number-BVlrSyMW.js";import{T as Cu}from"./time-display-qNg-b0Ae.js";import{F as Su,E as $i,C as tr}from"./copyable-text-C2GCixg7.js";import{e as Ct,I as ga,H as Ie,u as ku,l as qi,J as Au,K as Tu,L as sr,d as Iu,M as nr,N as ar,O as rr,P as ir,Q as or,R as cr,S as lr,T as dr,U as ur,V as mr,W as Pu}from"./index-DKgzbvrF.js";import{b as va,j as ya,l as qe,o as $t,n as St,s as $,c as Je,a as He,i as Vt}from"./schemas-jh0dXz-I.js";import{I as Eu,a as _u}from"./my-apps-page-rIAl1gr5.js";import{E as Mu,c as Kt}from"./ecosystem-desktop-BIv-jvBj.js";import"./miniapp-splash-screen-eXRdELgi.js";import"./swiper-DK5F_JhY.js";/* empty css                     */import{P as U}from"./page-header-BTg10QGk.js";import{I as Ce}from"./IconChevronRight-DVW_5A8z.js";import{S as xt,a as gt,b as vt,c as yt,u as Ru,f as Du,D as zu,g as Bu,h as Lu,i as Ou,j as Fu,k as Wu,l as $u,m as qu,n as Hu}from"./sheet-BQ_OqEVR.js";import{I as fe}from"./IconCheck-Cw9WdQrc.js";import{createBioforestAdapter as Uu,deriveWalletChainAddresses as Hi}from"./index-B0RUVa8g.js";import{C as kt}from"./chain-icon-BBgimTiY.js";import{p as At,P as Gt}from"./pattern-lock-D23t_kxx.js";import{P as Us}from"./password-input-5eRt5ug6.js";import{I as It,g as Ju,v as Ui,R as Vu}from"./recover-wallet-form-DZYuUBWB.js";import{F as ba}from"./fee-display-BI0Ti4fI.js";import{I as ke}from"./IconLoader2-Cbqry8dL.js";import{b as bt,C as Nn,I as Ku}from"./contact-avatar-BdIevfXV.js";import{I as vs,P as ja}from"./pattern-lock-setup-DS-3hEjS.js";import{i as Gu,d as Qu}from"./address-format-Bt4Tl7ZW.js";import{I as ys}from"./IconSearch-ux8xJoWX.js";import{I as Na}from"./IconDownload-DeZw0wnN.js";import{W as Yu}from"./wallet-mini-card-CD1oWC8i.js";import{I as Xu,W as Zu}from"./wallet-list-DnGMSs3f.js";import{C as Ji}from"./checkbox-wolq4BcK.js";import{I as Vi,A as Ki,S as Js,a as Vs,b as Ks,c as Gs,d as qt}from"./asset-selector-D1leZfPo.js";import{I as Gi}from"./IconChevronDown-DIFDulqw.js";import{p as Qi,g as em}from"./qr-parser-Coa12ljn.js";import{c as Yi}from"./index-BGZoHUYm.js";import{g as tm,a as sm,b as nm}from"./scanner-validators-YRGmuXyx.js";import{I as wn}from"./IconX-5q83HnUG.js";import{I as wa}from"./IconWallet-DtaLI9AW.js";import{C as am}from"./contact-card-BY4ZaKcc.js";import{g as Cn,n as rm,C as Xn,p as im}from"./index-Cx7hNgYy.js";import{i as Ds,c as zs,X as Bs,o as Te,G as We,a as om}from"./bioforest-D91I-84E.js";import{A as Ue}from"./address-display-B-hUTRw6.js";import{I as Xi}from"./IconShieldCheck-C9IWrqIs.js";import{I as Ca}from"./IconEye-Cep3-VOC.js";import{M as Zi}from"./mnemonic-display-Bn4svqRw.js";import{g as eo,C as Sa}from"./chain-selector-BcKG2QS8.js";import{I as to}from"./IconEyeOff-Hb4Cps0H.js";import{I as Qt}from"./IconCircleCheck-BxHGPdCH.js";import"./asset-item-CCqtwcbI.js";import"./asset-list-CjwHjm6s.js";import{A as so}from"./amount-input-BC_h_60l.js";import{S as no,I as Zn,a as ao}from"./send-result-CTYXxB1w.js";import{d as cm}from"./useRenderElement-KLX3fYL1.js";import{T as ro}from"./Trans-CdRQ0HPP.js";import{M as lm}from"./mnemonic-input-zHJKyd0R.js";import{T as io}from"./transaction-list-B5snKF-E.js";import{T as dm,I as um}from"./transaction-status-Dh561cXz.js";import{A as oo}from"./AppInfoCard-MOfetRPK.js";import{P as mm}from"./PermissionList-BGlAJRej.js";import{W as fm}from"./wallet-selector-BXomQ79Q.js";import{T as Ve}from"./token-icon-_bohwj3i.js";import{T as fr}from"./TransactionDetails-BnIT_lZR.js";import{B as pr}from"./BalanceWarning-YoRNUzO6.js";import{K as pm}from"./key-type-selector-CxsDUTXl.js";import{A as hm}from"./arbitrary-key-input-BkmGazmK.js";import{C as xm}from"./chain-address-preview-CnyWIkQG.js";import{C as gm}from"./collision-confirm-dialog-BZtl3R5t.js";import{B as vm}from"./balance-display-BLz2Lq8d.js";import{I as ym}from"./dropdown-menu-lMELI0LT.js";import{I as bm}from"./IconBell-BD5TZLa2.js";import{I as jm}from"./IconCircleX-CAmtn8qi.js";import{I as Nm}from"./IconShield-B8oqIARB.js";const wm=[["path",{d:"M20 6v12a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2z",key:"svg-0"}],["path",{d:"M10 16h6",key:"svg-1"}],["path",{d:"M13 11m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-2"}],["path",{d:"M4 8h3",key:"svg-3"}],["path",{d:"M4 12h3",key:"svg-4"}],["path",{d:"M4 16h3",key:"svg-5"}]],Cm=ne("outline","address-book","AddressBook",wm);const Sm=[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 15h10.55",key:"svg-1"}],["path",{d:"M6.551 4.938l3.26 10.034",key:"svg-2"}],["path",{d:"M17.032 4.636l-8.535 6.201",key:"svg-3"}],["path",{d:"M20.559 14.51l-8.535 -6.201",key:"svg-4"}],["path",{d:"M12.257 20.916l3.261 -10.034",key:"svg-5"}]],co=ne("outline","aperture","Aperture",Sm);const km=[["path",{d:"M17 7l-10 10",key:"svg-0"}],["path",{d:"M16 17l-9 0l0 -9",key:"svg-1"}]],Am=ne("outline","arrow-down-left","ArrowDownLeft",km);const Tm=[["path",{d:"M7 7l10 10",key:"svg-0"}],["path",{d:"M17 8l0 9l-9 0",key:"svg-1"}]],Im=ne("outline","arrow-down-right","ArrowDownRight",Tm);const Pm=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M13 18l6 -6",key:"svg-1"}],["path",{d:"M13 6l6 6",key:"svg-2"}]],lo=ne("outline","arrow-right","ArrowRight",Pm);const Em=[["path",{d:"M17 7l-10 10",key:"svg-0"}],["path",{d:"M8 7l9 0l0 9",key:"svg-1"}]],uo=ne("outline","arrow-up-right","ArrowUpRight",Em);const _m=[["path",{d:"M3 12h1m8 -9v1m8 8h1m-15.4 -6.4l.7 .7m12.1 -.7l-.7 .7",key:"svg-0"}],["path",{d:"M9 16a5 5 0 1 1 6 0a3.5 3.5 0 0 0 -1 3a2 2 0 0 1 -4 0a3.5 3.5 0 0 0 -1 -3",key:"svg-1"}],["path",{d:"M9.7 17l4.6 0",key:"svg-2"}]],mo=ne("outline","bulb","Bulb",_m);const Mm=[["path",{d:"M5 7h1a2 2 0 0 0 2 -2a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1a2 2 0 0 0 2 2h1a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-9a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M9 13a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-1"}]],Rm=ne("outline","camera","Camera",Mm);const Dm=[["path",{d:"M14 10m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-0"}],["path",{d:"M21 12a9 9 0 1 1 -18 0a9 9 0 0 1 18 0z",key:"svg-1"}],["path",{d:"M12.5 11.5l-4 4l1.5 1.5",key:"svg-2"}],["path",{d:"M12 15l-1.5 -1.5",key:"svg-3"}]],ka=ne("outline","circle-key","CircleKey",Dm);const zm=[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M14.8 9a2 2 0 0 0 -1.8 -1h-2a2 2 0 1 0 0 4h2a2 2 0 1 1 0 4h-2a2 2 0 0 1 -1.8 -1",key:"svg-1"}],["path",{d:"M12 7v10",key:"svg-2"}]],Bm=ne("outline","coin","Coin",zm);const Lm=[["path",{d:"M16.7 8a3 3 0 0 0 -2.7 -2h-4a3 3 0 0 0 0 6h4a3 3 0 0 1 0 6h-4a3 3 0 0 1 -2.7 -2",key:"svg-0"}],["path",{d:"M12 3v3m0 12v3",key:"svg-1"}]],Om=ne("outline","currency-dollar","CurrencyDollar",Lm);const Fm=[["path",{d:"M6 12l6 -9l6 9l-6 9z",key:"svg-0"}],["path",{d:"M6 12l6 -3l6 3l-6 2z",key:"svg-1"}]],Wm=ne("outline","currency-ethereum","CurrencyEthereum",Fm);const $m=[["path",{d:"M12 6m-8 0a8 3 0 1 0 16 0a8 3 0 1 0 -16 0",key:"svg-0"}],["path",{d:"M4 6v6a8 3 0 0 0 16 0v-6",key:"svg-1"}],["path",{d:"M4 12v6a8 3 0 0 0 16 0v-6",key:"svg-2"}]],fo=ne("outline","database","Database",$m);const qm=[["path",{d:"M3 5a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v10a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1v-10z",key:"svg-0"}],["path",{d:"M7 20h10",key:"svg-1"}],["path",{d:"M9 16v4",key:"svg-2"}],["path",{d:"M15 16v4",key:"svg-3"}]],Hm=ne("outline","device-desktop","DeviceDesktop",qm);const Um=[["path",{d:"M4 4h16v2.172a2 2 0 0 1 -.586 1.414l-4.414 4.414v7l-6 2v-8.5l-4.48 -4.928a2 2 0 0 1 -.52 -1.345v-2.227z",key:"svg-0"}]],po=ne("outline","filter","Filter",Um);const Jm=[["path",{d:"M18.9 7a8 8 0 0 1 1.1 5v1a6 6 0 0 0 .8 3",key:"svg-0"}],["path",{d:"M8 11a4 4 0 0 1 8 0v1a10 10 0 0 0 2 6",key:"svg-1"}],["path",{d:"M12 11v2a14 14 0 0 0 2.5 8",key:"svg-2"}],["path",{d:"M8 15a18 18 0 0 0 1.8 6",key:"svg-3"}],["path",{d:"M4.9 19a22 22 0 0 1 -.9 -7v-1a8 8 0 0 1 12 -6.95",key:"svg-4"}]],Vm=ne("outline","fingerprint","Fingerprint",Jm);const Km=[["path",{d:"M9 6.371c0 4.418 -2.239 6.629 -5 6.629",key:"svg-0"}],["path",{d:"M4 6.371h7",key:"svg-1"}],["path",{d:"M5 9c0 2.144 2.252 3.908 6 4",key:"svg-2"}],["path",{d:"M12 20l4 -9l4 9",key:"svg-3"}],["path",{d:"M19.1 18h-6.2",key:"svg-4"}],["path",{d:"M6.694 3l.793 .582",key:"svg-5"}]],Gm=ne("outline","language","Language",Km);const Qm=[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]],ho=ne("outline","link","Link",Qm);const Ym=[["path",{d:"M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z",key:"svg-0"}]],Xm=ne("outline","moon","Moon",Ym);const Zm=[["path",{d:"M6 9a6 6 0 1 0 12 0a6 6 0 0 0 -12 0",key:"svg-0"}],["path",{d:"M12 3c1.333 .333 2 2.333 2 6s-.667 5.667 -2 6",key:"svg-1"}],["path",{d:"M12 3c-1.333 .333 -2 2.333 -2 6s.667 5.667 2 6",key:"svg-2"}],["path",{d:"M6 9h12",key:"svg-3"}],["path",{d:"M3 20h7",key:"svg-4"}],["path",{d:"M14 20h7",key:"svg-5"}],["path",{d:"M10 20a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-6"}],["path",{d:"M12 15v3",key:"svg-7"}]],ef=ne("outline","network","Network",Zm);const tf=[["path",{d:"M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25",key:"svg-0"}],["path",{d:"M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}],["path",{d:"M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-3"}]],sf=ne("outline","palette","Palette",tf);const nf=[["path",{d:"M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4",key:"svg-0"}],["path",{d:"M13.5 6.5l4 4",key:"svg-1"}],["path",{d:"M16 19h6",key:"svg-2"}]],af=ne("outline","pencil-minus","PencilMinus",nf);const rf=[["path",{d:"M4 4m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M7 17l0 .01",key:"svg-1"}],["path",{d:"M14 4m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M7 7l0 .01",key:"svg-3"}],["path",{d:"M4 14m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-4"}],["path",{d:"M17 7l0 .01",key:"svg-5"}],["path",{d:"M14 14l3 0",key:"svg-6"}],["path",{d:"M20 14l0 .01",key:"svg-7"}],["path",{d:"M14 14l0 3",key:"svg-8"}],["path",{d:"M14 20l3 0",key:"svg-9"}],["path",{d:"M17 17l3 0",key:"svg-10"}],["path",{d:"M20 17l0 3",key:"svg-11"}]],of=ne("outline","qrcode","Qrcode",rf);const cf=[["path",{d:"M10 14l11 -11",key:"svg-0"}],["path",{d:"M21 3l-6.5 18a.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a.55 .55 0 0 1 0 -1l18 -6.5",key:"svg-1"}]],xo=ne("outline","send","Send",cf);const lf=[["path",{d:"M8 9h-1a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-8a2 2 0 0 0 -2 -2h-1",key:"svg-0"}],["path",{d:"M12 14v-11",key:"svg-1"}],["path",{d:"M9 6l3 -3l3 3",key:"svg-2"}]],df=ne("outline","share-2","Share2",lf);const uf=[["path",{d:"M6 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-0"}],["path",{d:"M18 6m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-1"}],["path",{d:"M18 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-2"}],["path",{d:"M8.7 10.7l6.6 -3.4",key:"svg-3"}],["path",{d:"M8.7 13.3l6.6 3.4",key:"svg-4"}]],Qs=ne("outline","share","Share",uf);const mf=[["path",{d:"M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7",key:"svg-1"}]],ff=ne("outline","sun","Sun",mf);const pf=[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 9h16.8",key:"svg-1"}],["path",{d:"M3.6 15h16.8",key:"svg-2"}],["path",{d:"M11.5 3a17 17 0 0 0 0 18",key:"svg-3"}],["path",{d:"M12.5 3a17 17 0 0 1 0 18",key:"svg-4"}]],go=ne("outline","world","World",pf);function Pt(){return le(me,t=>t.wallets)}function be(){return le(me,t=>_e.getCurrentWallet(t))}function Le(){return le(me,t=>t.selectedChain)}function vo(){return le(me,t=>t.chainPreferences)}function Sn(){return le(me,t=>_e.getCurrentChainAddress(t))}function kn(){return le(me,t=>_e.getCurrentChainTokens(t))}function yo(){return le(me,t=>_e.getAvailableChains(t))}function bo(){return le(me,t=>_e.hasWallet(t))}function jo(){return le(me,t=>t.isInitialized)}const hf=Object.freeze(Object.defineProperty({__proto__:null,addressBookActions:Wt,addressBookSelectors:xn,addressBookStore:Ft,chainConfigActions:lt,chainConfigSelectors:Ge,chainConfigStore:Gn,currencies:Qn,languages:_i,preferencesActions:fs,preferencesStore:Xd,useAvailableChains:yo,useChainConfigError:Pi,useChainConfigLoading:Ii,useChainConfigMigrationRequired:ki,useChainConfigState:st,useChainConfigSubscription:Ai,useChainConfigWarnings:Ti,useChainConfigs:ms,useChainPreferences:vo,useCurrency:ha,useCurrentChainAddress:Sn,useCurrentChainTokens:kn,useCurrentWallet:be,useEnabledBioforestChainConfigs:Ei,useEnabledChains:gn,useHasWallet:bo,useLanguage:ps,useSelectedChain:Le,useTheme:pa,useWalletInitialized:jo,useWallets:Pt,walletActions:de,walletSelectors:_e,walletStore:me},Symbol.toStringTag,{value:"Module"})),xf={all:["balance"],wallet:t=>["balance",t],chain:(t,s)=>["balance",t,s]};function gf(t,s){return hs({queryKey:xf.chain(t??"",s??""),queryFn:async()=>{if(!t||!s)return{tokens:[],supported:!1,fallbackReason:"Missing walletId or chain"};const n=await de.refreshBalance(t,s);return{tokens:(await cs(async()=>{const{walletStore:c}=await Promise.resolve().then(()=>hf);return{walletStore:c}},void 0,import.meta.url)).walletStore.state.wallets.find(c=>c.id===t)?.chainAddresses.find(c=>c.chain===s)?.tokens??[],supported:n?.supported??!0,fallbackReason:n?.fallbackReason}},enabled:!!t&&!!s,staleTime:30*1e3,gcTime:300*1e3,refetchInterval:60*1e3,refetchIntervalInBackground:!1,refetchOnWindowFocus:!0})}const hr={all:["transactionHistory"],wallet:t=>["transactionHistory",t],filtered:(t,s)=>["transactionHistory",t,s]};function vf(t){return{id:t.id,type:t.type,status:t.status,amount:t.amount,symbol:t.symbol,address:t.address,timestamp:t.timestamp,hash:t.hash,chain:t.chain,fee:t.fee,feeSymbol:t.feeSymbol,feeDecimals:t.feeDecimals,blockNumber:t.blockNumber,confirmations:t.confirmations,from:t.from,to:t.to,action:t.action,direction:t.direction,assets:t.assets,contract:t.contract}}function Aa(t){const[s,n]=l.useState({chain:"all",period:"all"}),a=Gd(),r=hs({queryKey:hr.filtered(t??"",s),queryFn:async()=>{if(!t)return[];const c={chain:s.chain??"all",period:s.period??"all",type:void 0,status:void 0};return(await zi.getHistory({walletId:t,filter:c})).map(vf)},enabled:!!t,staleTime:30*1e3,gcTime:300*1e3,refetchOnWindowFocus:!0}),o=async()=>{await a.invalidateQueries({queryKey:hr.wallet(t??"")})};return{transactions:r.data??[],isLoading:r.isLoading,isFetching:r.isFetching,error:r.error?.message,filter:s,setFilter:n,refresh:o}}function Ta(){return xa}function at(){return lu}function An(){return nu}function No(){return au}const Ys={authorizeAddress:"/wallet/authorize/address",authorizeSignature:"/wallet/authorize/signature"};class yf{constructor(s,n){this.adapter=s,this.eventId=n}hasResponded=!1;handleNetworkAddresses(s,n){const a=n.trim().toLowerCase();if(!a)return[];const r=[];for(const o of s)for(const c of o.chainAddresses)String(c.chain).toLowerCase()===a&&r.push({name:o.name,address:c.address,chainName:c.chain,publicKey:"",magic:`${o.id}:${c.chain}`,signMessage:""});return r}handleMainAddresses(s){return s.chainAddresses.map(n=>({name:s.name,address:n.address,chainName:n.chain,publicKey:"",magic:`${s.id}:${n.chain}`,signMessage:""}))}async handleMainAddressesSigned(s,n){const a=this.handleMainAddresses(s);return await this.applySensitiveOptions(a,[s],{password:n.password,signMessage:n.signMessage,getMain:!1})}handleAllAddresses(s){const n=[];for(const a of s)n.push(...this.handleMainAddresses(a));return n}async handleAllAddressesSigned(s,n){const a=this.handleAllAddresses(s);return await this.applySensitiveOptions(a,s,{password:n.password,signMessage:n.signMessage,getMain:!1})}async handleNetworkAddressesSigned(s,n,a){const r=this.handleNetworkAddresses(s,n);return await this.applySensitiveOptions(r,s,{password:a.password,signMessage:a.signMessage,getMain:!1})}async applySensitiveOptions(s,n,a){return await this.applyPasswordProtectedFields(s,n,a)}async approve(s){await this.respondOnce(Ys.authorizeAddress,s)}async reject(s){await this.respondOnce(Ys.authorizeAddress,null)}async respondOnce(s,n){if(!this.hasResponded){this.hasResponded=!0;try{await this.adapter.respondWith(this.eventId,s,n)}finally{await this.adapter.removeEventId(this.eventId)}}}async applyPasswordProtectedFields(s,n,a){const r=a.signMessage?.trim()??"",o=!!r,c=!!a.getMain;if(!o&&!c)return s;const i=new Map;for(const m of n)i.set(m.id,m);const d=new Map,u=new Set;for(const m of s){const f=this.getWalletIdFromMagic(m.magic),h=i.get(f),v=h?.encryptedMnemonic;if(!h||!v)throw new Error("Missing secret");const y=m.chainName.trim().toLowerCase();if(c){let p=d.get(f);if(!p){try{p=await Lt(v,a.password)}catch{throw new Error("Invalid password")}d.set(f,p)}m.main=p}if(o){if(Ds(y)){let p=d.get(f);if(!p){try{p=await Lt(v,a.password)}catch{throw new Error("Invalid password")}d.set(f,p)}const g=zs(p),b=Bs(r,g.secretKey);m.signMessage=`0x${Te(b)}`,m.publicKey=Te(g.publicKey);continue}if(!u.has(f))if(d.has(f))u.add(f);else{if(!await ht(v,a.password))throw new Error("Invalid password");u.add(f)}m.signMessage=this.createDeterministicMockSignature({message:r,address:m.address,chainName:m.chainName})}}return s}getWalletIdFromMagic(s){const n=s.indexOf(":");return n===-1?s:s.slice(0,n)}createDeterministicMockSignature({message:s,address:n,chainName:a}){const r=new TextEncoder,o=We(r.encode(`address:${n}|chain:${a}|message:${s}`)),c=We(r.encode(`event:${this.eventId}`)),i=new Uint8Array(64);return i.set(o,0),i.set(c,32),`0x${Te(i)}`}}class Ia{constructor(s,n){this.adapter=s,this.eventId=n}hasResponded=!1;async approve(s){await this.respondOnce(Ys.authorizeSignature,s)}async reject(s){await this.respondOnce(Ys.authorizeSignature,null)}async handleMessageSign(s,n,a){const r=s.chainName.trim().toLowerCase();if(Ds(r)){let c;try{c=await Lt(n,a)}catch{throw new Error("Invalid password")}const i=zs(c),d=Bs(s.message,i.secretKey);return{signature:`0x${Te(d)}`,publicKey:Te(i.publicKey)}}if(!await ht(n,a))throw new Error("Invalid password");{const c=new TextEncoder,i=We(c.encode(`message:${s.message}`)),d=We(c.encode(`event:${this.eventId}`)),u=new Uint8Array(64);u.set(i,0),u.set(d,32);const m=We(c.encode(`pubkey:${s.senderAddress}`));return{signature:`0x${Te(u)}`,publicKey:Te(m)}}}async handleTransferSign(s,n,a){const r=s.chainName.trim().toLowerCase(),o=["transfer",r,s.senderAddress,s.receiveAddress,s.balance,s.fee??"",s.contractInfo?.assetType??s.assetType??"",s.contractInfo?.contractAddress??"",s.contractInfo?.decimals?.toString()??""].join("|");if(Ds(r)){let f;try{f=await Lt(n,a)}catch{throw new Error("Invalid password")}const h=zs(f),v=Bs(o,h.secretKey);return`0x${Te(v)}`}if(!await ht(n,a))throw new Error("Invalid password");const i=new TextEncoder,d=We(i.encode(o)),u=We(i.encode(`event:${this.eventId}`)),m=new Uint8Array(64);return m.set(d,0),m.set(u,32),`0x${Te(m)}`}async handleDestroySign(s,n,a){const r=s.chainName.trim().toLowerCase(),o=["destory",r,s.senderAddress,s.destoryAddress,s.destoryAmount,s.fee??"",s.assetType??""].join("|");if(Ds(r)){let f;try{f=await Lt(n,a)}catch{throw new Error("Invalid password")}const h=zs(f),v=Bs(o,h.secretKey);return`0x${Te(v)}`}if(!await ht(n,a))throw new Error("Invalid password");const i=new TextEncoder,d=We(i.encode(o)),u=We(i.encode(`event:${this.eventId}`)),m=new Uint8Array(64);return m.set(d,0),m.set(u,32),`0x${Te(m)}`}async respondOnce(s,n){if(!this.hasResponded){this.hasResponded=!0;try{await this.adapter.respondWith(this.eventId,s,n)}finally{await this.adapter.removeEventId(this.eventId)}}}}class bf{async getCallerAppInfo(s){throw new Error("DWEB runtime not available in web environment")}async respondWith(s,n,a){throw new Error("DWEB runtime not available in web environment")}async removeEventId(s){}isAvailable(){return!1}}const Ht=new bf,jf={all:["addressBalance"],query:(t,s)=>["addressBalance",t,s]};function Nf(t,s,n=!0){return hs({queryKey:jf.query(t,s),queryFn:async()=>{if(!t||!s)return{balance:null,error:"Missing chain or address",supported:!1};const r=await gs(t).getNativeBalance(s);return Li(r)?{balance:r.data,error:null,supported:!0}:{balance:r.data,error:r.reason,supported:!1}},enabled:n&&!!t&&!!s,staleTime:30*1e3,gcTime:300*1e3})}const wf={all:["addressTransactions"],address:(t,s)=>["addressTransactions",t,s]};function Cf({chainId:t,address:s,limit:n=20,enabled:a=!0}){return hs({queryKey:wf.address(t,s),queryFn:async()=>{if(!t||!s)return{transactions:[],supported:!1,fallbackReason:"Missing chain or address"};const o=await gs(t).getTransactionHistory(s,n);return Li(o)?{transactions:o.data,supported:!0}:{transactions:o.data,supported:!1,fallbackReason:o.reason}},enabled:a&&!!t&&!!s.trim(),staleTime:30*1e3,gcTime:300*1e3})}function Sf(){return typeof window>"u"}function ws(){return!Sf()}function kf(){const t={value:null};function s(){return t.value}function n(a){t.value=a}return[s,n]}var Rn,xr;function Af(){if(xr)return Rn;xr=1;var t=typeof Element<"u",s=typeof Map=="function",n=typeof Set=="function",a=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function r(o,c){if(o===c)return!0;if(o&&c&&typeof o=="object"&&typeof c=="object"){if(o.constructor!==c.constructor)return!1;var i,d,u;if(Array.isArray(o)){if(i=o.length,i!=c.length)return!1;for(d=i;d--!==0;)if(!r(o[d],c[d]))return!1;return!0}var m;if(s&&o instanceof Map&&c instanceof Map){if(o.size!==c.size)return!1;for(m=o.entries();!(d=m.next()).done;)if(!c.has(d.value[0]))return!1;for(m=o.entries();!(d=m.next()).done;)if(!r(d.value[1],c.get(d.value[0])))return!1;return!0}if(n&&o instanceof Set&&c instanceof Set){if(o.size!==c.size)return!1;for(m=o.entries();!(d=m.next()).done;)if(!c.has(d.value[0]))return!1;return!0}if(a&&ArrayBuffer.isView(o)&&ArrayBuffer.isView(c)){if(i=o.length,i!=c.length)return!1;for(d=i;d--!==0;)if(o[d]!==c[d])return!1;return!0}if(o.constructor===RegExp)return o.source===c.source&&o.flags===c.flags;if(o.valueOf!==Object.prototype.valueOf&&typeof o.valueOf=="function"&&typeof c.valueOf=="function")return o.valueOf()===c.valueOf();if(o.toString!==Object.prototype.toString&&typeof o.toString=="function"&&typeof c.toString=="function")return o.toString()===c.toString();if(u=Object.keys(o),i=u.length,i!==Object.keys(c).length)return!1;for(d=i;d--!==0;)if(!Object.prototype.hasOwnProperty.call(c,u[d]))return!1;if(t&&o instanceof Element)return!1;for(d=i;d--!==0;)if(!((u[d]==="_owner"||u[d]==="__v"||u[d]==="__o")&&o.$$typeof)&&!r(o[u[d]],c[u[d]]))return!1;return!0}return o!==o&&c!==c}return Rn=function(c,i){try{return r(c,i)}catch(d){if((d.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw d}},Rn}var Tf=Af();const ns=Qd(Tf);function wo(t){const s=l.useRef(t),n=s.current,a=ns(n,t);return l.useEffect(()=>{a||(s.current=t)},[t]),a?n:t}var Pa=l.createContext(null),Co=({children:t,value:s})=>e.jsx(Pa.Provider,{value:wo(s),children:t});Co.displayName="ActivityProvider";var If=()=>l.useContext(Pa);function Pf(){return l.useContext(Pa).params}var So=l.createContext(null),ko=({children:t,value:s})=>e.jsx(So.Provider,{value:wo(s),children:t});ko.displayName="StackProvider";var Ef=()=>l.useContext(So),_f=Object.defineProperty,Mf=Object.defineProperties,Rf=Object.getOwnPropertyDescriptors,Xs=Object.getOwnPropertySymbols,Ao=Object.prototype.hasOwnProperty,To=Object.prototype.propertyIsEnumerable,gr=(t,s,n)=>s in t?_f(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,oe=(t,s)=>{for(var n in s||(s={}))Ao.call(s,n)&&gr(t,n,s[n]);if(Xs)for(var n of Xs(s))To.call(s,n)&&gr(t,n,s[n]);return t},pe=(t,s)=>Mf(t,Rf(s)),Df=(t,s)=>{var n={};for(var a in t)Ao.call(t,a)&&s.indexOf(a)<0&&(n[a]=t[a]);if(t!=null&&Xs)for(var a of Xs(t))s.indexOf(a)<0&&To.call(t,a)&&(n[a]=t[a]);return n};function zf(t,s,n){const a=n(t),r=n(s);return a<r?-1:a===r?0:1}var Bf=(t,s)=>{const n=[],a=[];return t.forEach(r=>{s(r)?n.push(r):a.push(r)}),[n,a]};function Io(t,s){return t.map((n,a)=>s(n)?a:void 0).filter(n=>typeof n=="number")}var Dn=0,vr=0,Po=()=>{const t=new Date().getTime();return vr===t?Dn+=1:(vr=t,Dn=0),(t*1e3+Dn)/1e3};function $e(){return(Po()*1e3).toString(16)}function Tn(t){return t.length===0?void 0:t[t.length-1]}function yr(t,s){const n=oe({},t);return s.forEach(a=>{delete n[a]}),n}function Lf(t){let s=!1;return()=>{s||(s=!0,t())}}function Of(t,s){const n=new Map;return[...t].reverse().filter(a=>{const r=s(a);if(r===null)return!0;const o=!!n.get(r);return n.set(r,!0),!o}).reverse()}function ea(t){return!t.exitedBy}function ta(t,s){return s.enteredBy.eventDate-t.enteredBy.eventDate}function br(t){return t.filter(ea).sort(ta)[0]}function Ff(t,s,n){const a=[];switch(s.name){case"Replaced":{if(Tn(Io(t,d=>d.id===s.activityId))!==void 0)break;const o=t.slice().sort(ta).filter(ea),c=n.now-s.eventDate>=n.transitionDuration;if((s.skipEnterActiveState||c?"enter-done":"enter-active")==="enter-done"){const d=o.findIndex(u=>!(s.skipEnterActiveState&&u.enteredBy.name==="Replaced"&&u.transitionState==="enter-active"));return o.slice(0,d+1).map(u=>t.indexOf(u))}break}case"Popped":{const r=t.filter(ea).sort(ta),o=r.slice(0,r.length-1)[0];o&&a.push(t.indexOf(o));break}case"StepPushed":case"StepReplaced":{const r=br(t);if(r){if(s.targetActivityId&&s.targetActivityId!==r.id)break;a.push(t.indexOf(r))}break}case"StepPopped":{const r=br(t);if(r&&r.steps.length>1){if(s.targetActivityId&&s.targetActivityId!==r.id)break;a.push(t.indexOf(r))}break}}return a}function jr(t,s){switch(s.name){case"Pushed":case"Replaced":{const n=Tn(Io(t,a=>a.id===s.activityId));return n??t.length}default:return-1}}function Nr(t,s){return{id:t.activityId,name:t.activityName,transitionState:s,params:t.activityParams,context:t.activityContext,steps:[{id:t.activityId,params:t.activityParams,enteredBy:t,zIndex:-1}],enteredBy:t,isTop:!1,isActive:!1,isRoot:!1,zIndex:-1}}function Ea(t){return(s,n)=>{const a=t[n.name].bind(t);if(a)return a(s,n);throw new Error(`No reducer for event ${JSON.stringify(n)}`)}}function Ye(t){return t}function Wf({transitionDuration:t,now:s,resumedAt:n}){return Ea({Pushed(a,r){const o=s-(n??r.eventDate)>=t,c=r.skipEnterActiveState||o?"enter-done":"enter-active",i=jr(a,r);return[...a.slice(0,i),Nr(r,c),...a.slice(i+1)]},Replaced(a,r){var o,c;const i=s-(n??r.eventDate)>=t,d=jr(a,r),u=(c=(o=a[d])==null?void 0:o.transitionState)!=null?c:r.skipEnterActiveState||i?"enter-done":"enter-active";return[...a.slice(0,d),Nr(r,u),...a.slice(d+1)]},Initialized:Ye,ActivityRegistered:Ye,Popped:Ye,StepPushed:Ye,StepReplaced:Ye,StepPopped:Ye,Paused:Ye,Resumed:Ye})}function Yt(t){return t}function $f(t){return Ea({Replaced:(s,n)=>pe(oe({},s),{exitedBy:n,transitionState:"exit-done"}),Popped:(s,n)=>{var a;const r=t.now-((a=t.resumedAt)!=null?a:n.eventDate)>=t.transitionDuration,o=n.skipExitActiveState||r?"exit-done":"exit-active";return pe(oe({},s),{exitedBy:n,transitionState:o,params:o==="exit-done"?s.steps[0].params:s.params,steps:o==="exit-done"?[s.steps[0]]:s.steps})},StepPushed:(s,n)=>{var a;const r={id:n.stepId,params:n.stepParams,enteredBy:n,zIndex:s.zIndex,hasZIndex:(a=n.hasZIndex)!=null?a:!1};return pe(oe({},s),{params:n.stepParams,steps:[...s.steps,r]})},StepReplaced:(s,n)=>{var a;const r={id:n.stepId,params:n.stepParams,enteredBy:n,zIndex:s.zIndex,hasZIndex:(a=n.hasZIndex)!=null?a:!1};return pe(oe({},s),{params:n.stepParams,steps:[...s.steps.slice(0,s.steps.length-1),r]})},StepPopped:(s,n)=>{var a;s.steps.pop();const r=(a=Tn(s.steps))==null?void 0:a.params;return pe(oe({},s),{params:r??s.params})},Initialized:Yt,ActivityRegistered:Yt,Pushed:Yt,Paused:Yt,Resumed:Yt})}function Oe(t){return(s,n)=>s.globalTransitionState==="paused"?pe(oe({},s),{pausedEvents:s.pausedEvents?[...s.pausedEvents,n]:[n]}):t(s,n)}function Me(t,s){return(n,a)=>{const r=Wf({transitionDuration:n.transitionDuration,now:s.now,resumedAt:s.resumedAt}),o=$f({transitionDuration:n.transitionDuration,now:s.now,resumedAt:s.resumedAt}),c=r(n.activities,a),i=Ff(n.activities,a,{transitionDuration:n.transitionDuration,now:s.now});for(const m of i)c[m]=o(c[m],a);const d=c.find(m=>m.transitionState==="enter-active"||m.transitionState==="exit-active"),u=n.globalTransitionState==="paused"?"paused":d?"loading":"idle";return t(pe(oe({},n),{activities:c,globalTransitionState:u}),a)}}function Mt(t,s){return pe(oe({},t),{events:[...t.events,s]})}function Eo(t){return Ea({Initialized:Oe(Me((s,n)=>pe(oe({},s),{transitionDuration:n.transitionDuration,events:[...s.events,n]}),t)),ActivityRegistered:Oe(Me((s,n)=>pe(oe({},s),{registeredActivities:[...s.registeredActivities,oe({name:n.activityName},n.activityParamsSchema?{paramsSchema:n.activityParamsSchema}:null)],events:[...s.events,n]}),t)),Paused:Oe(Me((s,n)=>pe(oe({},s),{globalTransitionState:"paused",events:[...s.events,n]}),t)),Resumed:Me((s,n)=>{if(s.globalTransitionState!=="paused"||!s.pausedEvents)return pe(oe({},s),{events:[...s.events,n]});const a=Eo({now:t.now,resumedAt:n.eventDate}),r=s,{pausedEvents:o}=r,c=Df(r,["pausedEvents"]),i=o.reduce(a,pe(oe({},c),{globalTransitionState:"idle"}));return pe(oe({},i),{events:[...i.events,n]})},t),Pushed:Oe(Me(Mt,t)),Replaced:Oe(Me(Mt,t)),Popped:Oe(Me(Mt,t)),StepPushed:Oe(Me(Mt,t)),StepReplaced:Oe(Me(Mt,t)),StepPopped:Oe(Me(Mt,t))})}function zn(t,s){return t.filter(n=>n.name===s)}function Ls(t,s){return pe(oe({id:$e(),eventDate:Po()},s),{name:t})}function qf(t){if(t.length===0)throw new Error("events parameter is empty");if(zn(t,"Initialized").length>1)throw new Error("InitializedEvent can only exist once");const n=zn(t,"ActivityRegistered"),a=new Set(n.map(o=>o.activityName));if(zn(t,"Pushed").some(o=>!a.has(o.activityName)))throw new Error("the corresponding activity does not exist")}function Bn(t,s){const n=Of([...t].sort((m,f)=>m.eventDate-f.eventDate),m=>m.id);qf(n);const a=Eo({now:s}),r=n.reduce(a,{activities:[],globalTransitionState:"idle",registeredActivities:[],transitionDuration:0,events:[]}),o=r.activities.filter(m=>m.transitionState==="enter-active"||m.transitionState==="enter-done"||m.transitionState==="exit-active"),c=o.filter(m=>m.transitionState==="enter-active"||m.transitionState==="enter-done"),i=o[o.length-1],d=c[c.length-1];return pe(oe({},r),{activities:r.activities.map(m=>{let f=o.findIndex(({id:y})=>y===m.id);const h=o.slice(0,f);for(const y of h)for(const p of y.steps)p.hasZIndex&&(f+=1);const v=m.steps.reduce((y,p)=>{var g;const b=Tn(y),x=(g=b?.zIndex)!=null?g:f;return[...y,pe(oe({},p),{zIndex:x+(p.hasZIndex?1:0)})]},[]);return oe(oe({id:m.id,name:m.name,transitionState:m.transitionState,params:m.params,steps:v,enteredBy:m.enteredBy,zIndex:f,isTop:i?.id===m.id,isActive:d?.id===m.id,isRoot:f===0||f===1&&m.transitionState==="enter-active"&&m.enteredBy.name==="Replaced"},m.exitedBy?{exitedBy:m.exitedBy}:null),m.context?{context:m.context}:null)}).sort((m,f)=>zf(m,f,h=>h.id))})}function Hf(t,s){var n,a,r,o,c,i,d,u;const m=[];!ns(t,s)&&m.push({_TAG:"%SOMETHING_CHANGED%"});const h=t.globalTransitionState!=="paused"&&s.globalTransitionState==="paused",v=t.globalTransitionState==="paused"&&s.globalTransitionState!=="paused";h&&m.push({_TAG:"PAUSED"}),v&&m.push({_TAG:"RESUMED"});for(let y=0;y<Math.max(t.activities.length,s.activities.length);y+=1){const p=t.activities[y],g=s.activities[y],b=p?.transitionState==="exit-done"||p?.transitionState==="exit-active",x=g?.transitionState==="enter-active"||g?.transitionState==="enter-done";if(p&&g&&p.id===g.id)for(let j=0;j<Math.max(((n=p.steps)!=null?n:[]).length,((a=g.steps)!=null?a:[]).length);j+=1){const N=p.steps[j],w=g.steps[j];!N&&w?m.push({_TAG:"STEP_PUSHED",activity:g,step:w}):N&&!w?m.push({_TAG:"STEP_POPPED",activity:g}):p.steps.length===g.steps.length&&N.id!==w.id&&m.push({_TAG:"STEP_REPLACED",activity:g,step:w})}!p&&g?m.push({_TAG:g.enteredBy.name==="Pushed"?"PUSHED":"REPLACED",activity:g}):b&&x?m.push({_TAG:g.enteredBy.name==="Pushed"?"PUSHED":"REPLACED",activity:g}):p&&g&&p.id===g.id&&!ns(yr(p,["isActive","isTop","isRoot","transitionState","zIndex"]),yr(g,["isActive","isTop","isRoot","transitionState","zIndex"]))&&g.enteredBy.name==="Replaced"&&!ns(p.enteredBy,g.enteredBy)&&m.push({_TAG:"REPLACED",activity:g})}for(let y=Math.max(t.activities.length,s.activities.length)-1;y>=0;y-=1){const p=((r=t.activities[y])==null?void 0:r.transitionState)==="enter-done"||((o=t.activities[y])==null?void 0:o.transitionState)==="enter-active",g=((c=s.activities[y])==null?void 0:c.transitionState)==="exit-active"||((i=s.activities[y])==null?void 0:i.transitionState)==="exit-done",b=((d=s.activities[y+1])==null?void 0:d.enteredBy.name)==="Replaced"&&((u=s.activities[y+1])==null?void 0:u.transitionState)==="enter-done";p&&g&&!b&&m.push({_TAG:"POPPED",activity:s.activities[y]})}return m}var Uf={Pushed:"onBeforePush",Replaced:"onBeforeReplace",Popped:"onBeforePop",StepPushed:"onBeforeStepPush",StepReplaced:"onBeforeStepReplace",StepPopped:"onBeforeStepPop",Paused:"onBeforePause",Resumed:"onBeforeResume"};function Xe(t,s,n,a){let r=!1,o=oe({},s);for(const c of n){const i=c[Uf[t]];i&&i({actionParams:oe({},o),actions:pe(oe({},a),{preventDefault:()=>{r=!0},overrideActionParams:d=>{o=oe(oe({},o),d)}})})}return{isPrevented:r,nextActionParams:o}}function Jf({dispatchEvent:t,pluginInstances:s,actions:n}){return{push(a){const{isPrevented:r,nextActionParams:o}=Xe("Pushed",a,s,n);r||t("Pushed",o)},replace(a){const{isPrevented:r,nextActionParams:o}=Xe("Replaced",a,s,n);r||t("Replaced",o)},pop(a={}){const{isPrevented:r,nextActionParams:o}=Xe("Popped",a,s,n);r||t("Popped",o)},stepPush(a){const{isPrevented:r,nextActionParams:o}=Xe("StepPushed",a,s,n);r||t("StepPushed",o)},stepReplace(a){const{isPrevented:r,nextActionParams:o}=Xe("StepReplaced",a,s,n);r||t("StepReplaced",o)},stepPop(a={}){const{isPrevented:r,nextActionParams:o}=Xe("StepPopped",a,s,n);r||t("StepPopped",o)},pause(a={}){const{isPrevented:r,nextActionParams:o}=Xe("Paused",a,s,n);r||t("Paused",o)},resume(a={}){const{isPrevented:r,nextActionParams:o}=Xe("Resumed",a,s,n);r||t("Resumed",o)}}}function Vf(t,s,n){t.forEach(a=>{s.forEach(r=>{var o,c,i,d,u,m,f,h,v;switch(a._TAG){case"PUSHED":(o=r.onPushed)==null||o.call(r,{actions:n,effect:a});break;case"REPLACED":(c=r.onReplaced)==null||c.call(r,{actions:n,effect:a});break;case"POPPED":(i=r.onPopped)==null||i.call(r,{actions:n,effect:a});break;case"STEP_PUSHED":(d=r.onStepPushed)==null||d.call(r,{actions:n,effect:a});break;case"STEP_REPLACED":(u=r.onStepReplaced)==null||u.call(r,{actions:n,effect:a});break;case"STEP_POPPED":(m=r.onStepPopped)==null||m.call(r,{actions:n,effect:a});break;case"PAUSED":(f=r.onPaused)==null||f.call(r,{actions:n,effect:a});break;case"RESUMED":(h=r.onResumed)==null||h.call(r,{actions:n,effect:a});break;case"%SOMETHING_CHANGED%":(v=r.onChanged)==null||v.call(r,{actions:n,effect:a});break}})})}var Kf=1e3,Gf=Kf/60;function wr(t){var s,n,a,r;const o=[],i=[{key:"@stackflow/core",onChanged(){o.forEach(g=>g())}},...t.plugins.map(g=>g())],[d,u]=Bf(t.initialEvents,g=>g.name==="Pushed"||g.name==="StepPushed"),m=i.reduce((g,b)=>{var x,j,N;return(N=(j=b.overrideInitialEvents)==null?void 0:j.call(b,{initialEvents:g,initialContext:(x=t.initialContext)!=null?x:{}}))!=null?N:g},d);m.length>0&&d.length>0&&m!==d&&((n=(s=t.handlers)==null?void 0:s.onInitialActivityIgnored)==null||n.call(s,m)),m.length===0&&((r=(a=t.handlers)==null?void 0:a.onInitialActivityNotFound)==null||r.call(a));const h={value:[...u,...m]},v={value:Bn(h.value,new Date().getTime())},y={getStack(){return v.value},dispatchEvent(g,b){const x=Ls(g,b),j=Bn([...h.value,x],new Date().getTime());h.value.push(x),p(j);const N=setInterval(()=>{const w=Bn(h.value,new Date().getTime());ns(v.value,w)||p(w),w.globalTransitionState==="idle"&&clearInterval(N)},Gf)},push:()=>{},replace:()=>{},pop:()=>{},stepPush:()=>{},stepReplace:()=>{},stepPop:()=>{},pause:()=>{},resume:()=>{}},p=g=>{const b=Hf(v.value,g);v.value=g,Vf(b,i,y)};return Object.assign(y,Jf({dispatchEvent:y.dispatchEvent,pluginInstances:i,actions:y})),{actions:y,init:Lf(()=>{i.forEach(g=>{var b;(b=g.onInit)==null||b.call(g,{actions:y})})}),pullEvents:()=>h.value,subscribe(g){return o.push(g),function(){const x=o.findIndex(j=>j===g);x>-1&&o.splice(x,1)}},pluginInstances:i}}var _o=l.createContext(null);function Qf(){const t=l.useContext(_o);if(t===null)throw new Error("useActivityComponentMap must be used within ActivityComponentMapProvider");return t}function Yf({children:t,value:s}){return e.jsx(_o.Provider,{value:s,children:t})}var Zs=t=>s=>s.find(({id:n})=>n===t);function Xf(t){return!t.exitedBy}function Zf(t,s){return s.enteredBy.eventDate-t.enteredBy.eventDate}function en(t){return t.filter(Xf).sort(Zf)[0]}function ft(){return $e()}function tn(){return $e()}var Cr,ep=(Cr=fa.useDeferredValue)!=null?Cr:t=>t,Sr,tp=(Sr=fa.useSyncExternalStore)!=null?Sr:(t,s)=>{const[n,a]=l.useState(()=>s());return l.useEffect(()=>t(()=>{a(()=>s())})),n},kr,Mo=(kr=fa.useTransition)!=null?kr:()=>[!1,t=>t()],Ro=l.createContext(null),Do=l.createContext(null),zo=({coreStore:t,children:s})=>{const n=tp(t.subscribe,t.actions.getStack,t.actions.getStack),a=ep(n);return e.jsx(Do.Provider,{value:a,children:e.jsx(Ro.Provider,{value:t.actions,children:s})})};zo.displayName="CoreProvider";var Bo=()=>l.useContext(Ro),Lo=()=>l.useContext(Do),Oo=l.createContext(null),Fo=({children:t,value:s})=>e.jsx(Oo.Provider,{value:s,children:t});Fo.displayName="PluginsProvider";function Wo(){return l.useContext(Oo)}function sp(t){return typeof t=="object"&&t!==null&&"then"in t&&typeof t.then=="function"}var ge={PENDING:"pending",FULFILLED:"fulfilled",REJECTED:"rejected"};function _a(t){if(t.status===ge.PENDING)return{status:ge.PENDING};if(t.status===ge.FULFILLED&&"value"in t)return{status:ge.FULFILLED,value:t.value};if(t.status===ge.REJECTED&&"reason"in t)return{status:ge.REJECTED,reason:t.reason};throw new Error("Invalid promise state")}function np(t){if("status"in t&&Object.values(ge).some(n=>n===t.status))return t;const s=Object.assign(t,{status:ge.PENDING});return s.then(n=>{s.status=ge.FULFILLED,s.value=n},n=>{s.status=ge.REJECTED,s.reason=n}),s}function Os(t){return sp(t)?np(t instanceof Promise?t:Promise.resolve(t)):Object.assign(Promise.resolve(t),{status:ge.FULFILLED,value:t})}function ap(t){return Object.assign(Promise.reject(t),{status:ge.REJECTED,reason:t})}function rp(t){const s=Os(t),n=_a(s);if(n.status===ge.FULFILLED)return n.value;throw n.status===ge.REJECTED?n.reason:s}var ip=Object.defineProperty,Ar=Object.getOwnPropertySymbols,op=Object.prototype.hasOwnProperty,cp=Object.prototype.propertyIsEnumerable,Tr=(t,s,n)=>s in t?ip(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,lp=(t,s)=>{for(var n in s||(s={}))op.call(s,n)&&Tr(t,n,s[n]);if(Ar)for(var n of Ar(s))cp.call(s,n)&&Tr(t,n,s[n]);return t},dp=(t,s,n)=>new Promise((a,r)=>{var o=d=>{try{i(n.next(d))}catch(u){r(u)}},c=d=>{try{i(n.throw(d))}catch(u){r(u)}},i=d=>d.done?a(d.value):Promise.resolve(d.value).then(o,c);i((n=n.apply(t,s)).next())});function up(t){let s=null;const n=()=>((!s||_a(s).status===ge.REJECTED)&&(s=t()),s);return{Component:r=>{const{default:o}=rp(n());return e.jsx(o,lp({},r))},preload:()=>dp(this,null,function*(){yield n()})}}var mp=Symbol("STRUCTURED_ACTIVITY_COMPONENT_TYPE");function fp(t){return t!==null&&typeof t=="object"&&mp in t}var Ln=new WeakMap;function pp(t){if(Ln.has(t))return Ln.get(t);const{Component:s}=up(()=>{const n=t.content,a=Os(typeof n=="function"?n():{default:n}),r=_a(a);return r.status===ge.FULFILLED?Os({default:r.value.default.component}):r.status===ge.REJECTED?ap(r.reason):Os(a.then(o=>({default:o.default.component})))});return Ln.set(t,s),s}var hp=Object.defineProperty,xp=Object.defineProperties,gp=Object.getOwnPropertyDescriptors,Ir=Object.getOwnPropertySymbols,vp=Object.prototype.hasOwnProperty,yp=Object.prototype.propertyIsEnumerable,sa=(t,s,n)=>s in t?hp(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,ot=(t,s)=>{for(var n in s||(s={}))vp.call(s,n)&&sa(t,n,s[n]);if(Ir)for(var n of Ir(s))yp.call(s,n)&&sa(t,n,s[n]);return t},On=(t,s)=>xp(t,gp(s)),Pr=(t,s,n)=>sa(t,typeof s!="symbol"?s+"":s,n),$o=({plugin:t,initialContext:s})=>{const n=Qf(),a=Lo(),r=Wo();return t.render({stack:On(ot({},a),{render(o){return{activities:ot(ot({},a),o).activities.map(i=>On(ot({},i),{key:i.id,render(d){const u=n[i.name];let m=fp(u)?jp(u,i.params):e.jsx(u,{params:i.params});return r.forEach(f=>{var h,v;m=(v=(h=f.wrapActivity)==null?void 0:h.call(f,{activity:On(ot({},i),{render:()=>m}),initialContext:s}))!=null?v:m}),e.jsx(Co,{value:ot(ot({},i),d),children:m},i.id)}}))}}}),initialContext:s})};$o.displayName="PluginRenderer";var bp=$o;function jp(t,s){const{layout:n,loading:a,errorHandler:r}=t,o=pp(t);return[i=>a?.component?e.jsx(l.Suspense,{fallback:e.jsx(a.component,{params:s}),children:i}):i,i=>{var d;if(!r)return i;const u=(d=r.boundary)!=null?d:Np;return e.jsx(u,{renderFallback:(m,f)=>e.jsx(r.component,{params:s,error:m,reset:f}),children:i})},i=>n?.component?e.jsx(n.component,{params:s,children:i}):i].reduce((i,d)=>d(i),e.jsx(o,{params:s}))}var Np=class extends l.Component{constructor(){super(...arguments),Pr(this,"state",{hasError:!1,error:null}),Pr(this,"reset",()=>this.setState({hasError:!1,error:null}))}render(){return this.state.hasError?this.props.renderFallback(this.state.error,this.reset):this.props.children}static getDerivedStateFromError(t){return{hasError:!0,error:t}}},wp=Object.defineProperty,Cp=Object.defineProperties,Sp=Object.getOwnPropertyDescriptors,Er=Object.getOwnPropertySymbols,kp=Object.prototype.hasOwnProperty,Ap=Object.prototype.propertyIsEnumerable,_r=(t,s,n)=>s in t?wp(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Tp=(t,s)=>{for(var n in s||(s={}))kp.call(s,n)&&_r(t,n,s[n]);if(Er)for(var n of Er(s))Ap.call(s,n)&&_r(t,n,s[n]);return t},Ip=(t,s)=>Cp(t,Sp(s)),qo=({initialContext:t})=>{const s=Lo(),n=Wo(),a=n.filter(o=>!!o.render);l.useEffect(()=>{a.length===0&&console.warn(`Stackflow - There is no rendering plugin, so "<Stack />" doesn't render anything. If you want to render some UI, use "@stackflow/plugin-renderer-basic" or add another rendering plugin.`)},[a]);let r=e.jsx(e.Fragment,{children:a.map(o=>e.jsx(bp,{plugin:o,initialContext:t},o.key))});return n.forEach(o=>{var c,i;r=(i=(c=o.wrapStack)==null?void 0:c.call(o,{stack:Ip(Tp({},s),{render(){return r}}),initialContext:t}))!=null?i:r}),e.jsx(ko,{value:s,children:r})};qo.displayName="MainRenderer";var Pp=qo,Ep=Object.defineProperty,Mr=Object.getOwnPropertySymbols,_p=Object.prototype.hasOwnProperty,Mp=Object.prototype.propertyIsEnumerable,Rr=(t,s,n)=>s in t?Ep(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Dr=(t,s)=>{for(var n in s||(s={}))_p.call(s,n)&&Rr(t,n,s[n]);if(Mr)for(var n of Mr(s))Mp.call(s,n)&&Rr(t,n,s[n]);return t};function Fn(t){return t?t.animate==null?{skipActiveState:!1}:{skipActiveState:!t.animate}:{skipActiveState:!1}}function bs(){const t=Bo(),[s]=Mo();return l.useMemo(()=>({pending:s,push(n,a,r){const o=ft();return t?.push({activityId:o,activityName:n,activityParams:a,skipEnterActiveState:Fn(r).skipActiveState}),{activityId:o}},replace(n,a,r){var o;const c=ft();return t?.replace({activityId:(o=r?.activityId)!=null?o:ft(),activityName:n,activityParams:a,skipEnterActiveState:Fn(r).skipActiveState}),{activityId:c}},pop(n,a){let r=1,o={};typeof n=="object"&&(o=Dr({},n)),typeof n=="number"&&(r=n),a&&(o=Dr({},a));for(let c=0;c<r;c+=1)t?.pop({skipExitActiveState:c===0?Fn(o).skipActiveState:!0})}}),[t?.push,t?.replace,t?.pop,s])}var Rp=()=>{const t=Bo(),[s]=Mo();return l.useMemo(()=>({pending:s,stepPush(n,a){const r=t?.getStack().activities,o=a?.targetActivityId?Zs(a.targetActivityId):en,c=r&&o(r);if(!c)throw new Error("The target activity is not found.");const i=typeof n=="function"?n(c.params):n,d=tn();t?.stepPush({stepId:d,stepParams:i,targetActivityId:a?.targetActivityId})},stepReplace(n,a){const r=t?.getStack().activities,o=a?.targetActivityId?Zs(a.targetActivityId):en,c=r&&o(r);if(!c)throw new Error("The target activity is not found.");const i=typeof n=="function"?n(c.params):n,d=tn();t?.stepReplace({stepId:d,stepParams:i,targetActivityId:a?.targetActivityId})},stepPop(n){t?.stepPop({targetActivityId:n?.targetActivityId})}}),[t?.stepPush,t?.stepReplace,t?.stepPop,t?.getStack,s])},Dp=Object.defineProperty,zp=Object.defineProperties,Bp=Object.getOwnPropertyDescriptors,zr=Object.getOwnPropertySymbols,Lp=Object.prototype.hasOwnProperty,Op=Object.prototype.propertyIsEnumerable,Br=(t,s,n)=>s in t?Dp(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Cs=(t,s)=>{for(var n in s||(s={}))Lp.call(s,n)&&Br(t,n,s[n]);if(zr)for(var n of zr(s))Op.call(s,n)&&Br(t,n,s[n]);return t},Fp=(t,s)=>zp(t,Bp(s));function Wn(t){return t?t.animate==null?{skipActiveState:!1}:{skipActiveState:!t.animate}:{skipActiveState:!1}}function Wp(t){var s;const n=((s=t.plugins)!=null?s:[]).flat(Number.POSITIVE_INFINITY).map(u=>u),a=Object.entries(t.activities).reduce((u,[m,f])=>Fp(Cs({},u),{[m]:"component"in f?f.component:f}),{}),r=()=>new Date().getTime()-t.transitionDuration*2,o=wr({initialEvents:[Ls("Initialized",{transitionDuration:t.transitionDuration,eventDate:r()}),...Object.entries(t.activities).map(([u,m])=>Ls("ActivityRegistered",Cs({activityName:u,eventDate:r()},"component"in m?{activityParamsSchema:m.paramsSchema}:null)))],plugins:[]}),[c,i]=kf(),d=l.memo(u=>{const m=l.useMemo(()=>{const f=c();if(ws()&&f)return f;const h=t.initialActivity?[Ls("Pushed",{activityId:ft(),activityName:t.initialActivity(),activityParams:{},eventDate:r(),skipEnterActiveState:!1})]:[],v=wr({initialEvents:[...o.pullEvents(),...h],initialContext:u.initialContext,plugins:n,handlers:{onInitialActivityIgnored:y=>{ws()&&console.warn(`Stackflow - Some plugin overrides an "initialActivity" option. The "initialActivity" option you set to "${y[0].activityName}" in the "stackflow" is ignored.`)},onInitialActivityNotFound:()=>{ws()&&console.warn("Stackflow - There is no initial activity. If you want to set the initial activity, add the `initialActivity` option of the `stackflow()` function or add a plugin that sets the initial activity. (e.g. `@stackflow/plugin-history-sync`)")}}});return ws()&&(v.init(),i(v)),v},[]);return e.jsx(Fo,{value:m.pluginInstances,children:e.jsx(zo,{coreStore:m,children:e.jsx(Yf,{value:a,children:e.jsx(Pp,{initialContext:u.initialContext})})})})});return d.displayName="Stack",{activities:t.activities,Stack:d,useFlow:bs,useStepFlow:Rp,addActivity(u){if(c()){console.warn("Stackflow - `addActivity()` API cannot be called after a `<Stack />` component has been rendered");return}a[u.name]=l.memo(u.component),o.actions.dispatchEvent("ActivityRegistered",{activityName:u.name,activityParamsSchema:u.paramsSchema,eventDate:r()})},addPlugin(u){if(c()){console.warn("Stackflow - `addPlugin()` API cannot be called after a `<Stack />` component has been rendered");return}[u].flat(Number.POSITIVE_INFINITY).map(m=>m).forEach(m=>{n.push(m)})},actions:{getStack(){var u,m;return(m=(u=c())==null?void 0:u.actions.getStack())!=null?m:o.actions.getStack()},dispatchEvent(u,m){var f;return(f=c())==null?void 0:f.actions.dispatchEvent(u,m)},push(u,m,f){var h;const v=ft();return(h=c())==null||h.actions.push({activityId:v,activityName:u,activityParams:m,skipEnterActiveState:Wn(f).skipActiveState}),{activityId:v}},replace(u,m,f){var h,v,y;const p=(h=f?.activityId)!=null?h:ft();return(y=c())==null||y.actions.replace({activityId:(v=f?.activityId)!=null?v:ft(),activityName:u,activityParams:m,skipEnterActiveState:Wn(f).skipActiveState}),{activityId:p}},pop(u,m){var f;let h=1,v={};typeof u=="object"&&(v=Cs({},u)),typeof u=="number"&&(h=u),m&&(v=Cs({},m));for(let y=0;y<h;y+=1)(f=c())==null||f.actions.pop({skipExitActiveState:y===0?Wn(v).skipActiveState:!0})},stepPush(u,m){var f,h;const v=(f=c())==null?void 0:f.actions.getStack().activities,y=m?.targetActivityId?Zs(m.targetActivityId):en,p=v&&y(v);if(!p)throw new Error("The target activity is not found.");const g=typeof u=="function"?u(p.params):u,b=tn();return(h=c())==null?void 0:h.actions.stepPush({stepId:b,stepParams:g,targetActivityId:m?.targetActivityId})},stepReplace(u,m){var f,h;const v=(f=c())==null?void 0:f.actions.getStack().activities,y=m?.targetActivityId?Zs(m.targetActivityId):en,p=v&&y(v);if(!p)throw new Error("The target activity is not found.");const g=typeof u=="function"?u(p.params):u,b=tn();return(h=c())==null?void 0:h.actions.stepReplace({stepId:b,stepParams:g,targetActivityId:m?.targetActivityId})},stepPop(u){var m;return(m=c())==null?void 0:m.actions.stepPop({targetActivityId:u?.targetActivityId})}}}}function $p(){return()=>({key:"plugin-renderer-basic",render({stack:t}){return e.jsx(e.Fragment,{children:t.render().activities.filter(s=>s.transitionState!=="exit-done").map(s=>e.jsx(l.Fragment,{children:s.render()},s.key))})}})}function qp(t){var s=t.match(/^var\((.*)\)$/);return s?s[1]:t}function js(t,s){var n={};{var a=t;for(var r in a){var o=a[r];o!=null&&(n[qp(r)]=o)}}return Object.defineProperty(n,"toString",{value:function(){return Object.keys(this).map(i=>"".concat(i,":").concat(this[i])).join(";")},writable:!1}),n}function Hp(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function Up(t){var s=Hp(t,"string");return typeof s=="symbol"?s:String(s)}function Jp(t,s,n){return s=Up(s),s in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function Lr(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,a)}return n}function Or(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?Lr(Object(n),!0).forEach(function(a){Jp(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Lr(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function Fr(t,s){var n={};for(var a in t)n[a]=s(t[a],a);return n}var Vp=(t,s,n)=>{for(var a of Object.keys(t)){var r;if(t[a]!==((r=s[a])!==null&&r!==void 0?r:n[a]))return!1}return!0},rt=t=>{var s=n=>{var a=t.defaultClassName,r=Or(Or({},t.defaultVariants),n);for(var o in r){var c,i=(c=r[o])!==null&&c!==void 0?c:t.defaultVariants[o];if(i!=null){var d=i;typeof d=="boolean"&&(d=d===!0?"true":"false");var u=t.variantClassNames[o][d];u&&(a+=" "+u)}}for(var[m,f]of t.compoundVariants)Vp(m,r,t.defaultVariants)&&(a+=" "+f);return a};return s.variants=()=>Object.keys(t.variantClassNames),s.classNames={get base(){return t.defaultClassName.split(" ")[0]},get variants(){return Fr(t.variantClassNames,n=>Fr(n,a=>a.split(" ")[0]))}},s},Kp=Object.defineProperty,Wr=Object.getOwnPropertySymbols,Gp=Object.prototype.hasOwnProperty,Qp=Object.prototype.propertyIsEnumerable,$r=(t,s,n)=>s in t?Kp(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Yp=(t,s)=>{for(var n in s||(s={}))Gp.call(s,n)&&$r(t,n,s[n]);if(Wr)for(var n of Wr(s))Qp.call(s,n)&&$r(t,n,s[n]);return t};function Ma(){const[t,s]=l.useReducer(()=>!0,!1);return l.useEffect(()=>{s()},[]),t}function Et(){return If()}function Ho(){const t=Et(),s=Ma();return Yp({},s?{"data-stackflow-activity-id":t?.id,"data-stackflow-activity-is-active":t?.isActive,"data-stackflow-activity-transition-state":t?.transitionState}:null)}function Uo(t,s,n){const a=()=>{s.forEach(r=>{t.removeEventListener(r,a)}),n()};s.forEach(r=>{t.addEventListener(r,a)})}var Xp=t=>(t(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}),Be=()=>{};function na(t){requestAnimationFrame(()=>{requestAnimationFrame(()=>{t()})})}function Zp({outerRef:t,innerRef:s,enable:n}){const[a,r]=l.useState(void 0);return l.useEffect(()=>{const o=t&&"current"in t&&t.current,c=s.current;return!n||!o||!c?Be:Xp(()=>{const d=o.clientWidth,u=c.offsetLeft,m=c.clientWidth,f=d-u-m,h=Math.max(u,f);r(d-2*h)})}),{maxWidth:a}}function Ra(t){const[s,n]=l.useState(void 0);return l.useEffect(()=>{na(()=>{n(t)})},[t]),s}function eh(){return Ef()}function Da({ref:t}){const s=eh();l.useEffect(()=>{if(!s)return;const n=t.current;if(!n||s.globalTransitionState==="idle")return;const a=r=>{r.preventDefault(),r.stopPropagation()};return n.addEventListener("touchstart",a,{capture:!0}),n.addEventListener("touchmove",a,{capture:!0}),n.addEventListener("touchend",a,{capture:!0}),n.addEventListener("touchcancel",a,{capture:!0}),()=>{n.removeEventListener("touchstart",a,{capture:!0}),n.removeEventListener("touchmove",a,{capture:!0}),n.removeEventListener("touchend",a,{capture:!0}),n.removeEventListener("touchcancel",a,{capture:!0})}},[s?.globalTransitionState])}var Xt={};function Ke({styleName:t,refs:s,effect:n,effectDeps:a}){const r=Et();l.useEffect(()=>r?(Xt[t]||(Xt[t]=new Map),Xt[t].set(r.zIndex,{refs:s,hasEffect:!!n}),()=>{Xt[t].delete(r.zIndex)}):Be,[r?.id,s,n]),l.useEffect(()=>{if(!r||!n)return Be;const o=(()=>{let i=[];for(let d=1;d<=r.zIndex;d+=1){const u=Xt[t].get(r.zIndex-d);if(u?.refs&&(i=[...i,...u.refs]),u?.hasEffect)break}return i})(),c=n({activityTransitionState:r.transitionState,refs:o});return()=>{c?.()}},[r?.transitionState,...a??[]])}function th({refs:t}){Ke({styleName:"hide",refs:t,effect:({activityTransitionState:s,refs:n})=>{const a=()=>{n.forEach(r=>{if(!r.current)return;const o=r.current;o.style.display=""})};return s==="enter-done"?(n.forEach(r=>{if(!r.current)return;const o=r.current;o.style.display="none"}),()=>{a()}):(a(),Be)}})}function sh({refs:t,transitionDuration:s,offsetStyles:n,hasEffect:a=!1}){Ke({styleName:"offset",refs:t,effect:a?({activityTransitionState:r,refs:o})=>{const c=()=>{na(()=>{o.forEach(i=>{if(!i.current)return;const d=i.current;d.style.transform="",d.style.opacity="",Uo(d,["transitionend","transitioncancel"],()=>{d.style.transition=""})})})};switch(r){case"enter-active":case"enter-done":return o.forEach(i=>{i.current&&(i.current.style.transition=s,i.current.style.transform=n.transform,i.current.style.opacity=n.opacity)}),r==="enter-done"?()=>{c()}:Be;case"exit-active":case"exit-done":return na(()=>{c()}),Be;default:return Be}}:void 0})}var Ss="--stackflow-swipe-back-ratio";function nh({dimRef:t,edgeRef:s,paperRef:n,appBarRef:a,offset:r,transitionDuration:o,preventSwipeBack:c,moveAppBarTogether:i,getActivityTransitionState:d,onSwipeStart:u,onSwipeMove:m,onSwipeEnd:f,onTransitionEnd:h}){Ke({styleName:"swipe-back",refs:i&&a?[n,a]:[n],effect:({refs:v})=>{if(c||!t.current||!s.current||!n.current)return Be;const y=t.current,p=s.current,g=n.current,b=a?.current;let x=null,j=null,N=null,w=[];const S=()=>{x=null,j=null,N=null,w=[]};let C=!1;function T({dx:A,ratio:D}){C||(C=!0,requestAnimationFrame(()=>{y.style.opacity=`${1-D}`,y.style.transition="0s",g.style.overflowY="hidden",g.style.transform=`translate3d(${A}px, 0, 0)`,g.style.transition="0s",i&&b&&(b.style.overflowY="hidden",b.style.transform=`translate3d(${A}px, 0, 0)`,b.style.transition="0s"),b?.style.setProperty(Ss,String(D)),v.forEach(_=>{var B,E;_.current&&(_.current.style.transform=`translate3d(${-1*(1-D)*r}px, 0, 0)`,_.current.style.transition="0s",((B=_.current.parentElement)==null?void 0:B.style.display)==="none"&&(_.current.parentElement.style.display="block"),(E=_.current.parentElement)==null||E.style.setProperty(Ss,String(D)))}),C=!1}))}function k({swiped:A}){return new Promise(D=>{requestAnimationFrame(()=>{y.style.opacity=`${A?0:1}`,y.style.transition=o,g.style.overflowY="hidden",g.style.transform=`translateX(${A?"100%":"0"})`,g.style.transition=o,i&&b&&(b.style.overflowY="hidden",b.style.transform=`translateX(${A?"100%":"0"})`,b.style.transition=o),v.forEach(B=>{B.current&&(B.current.style.transition=o,B.current.style.transform=`translate3d(${A?"0":`-${r/16}rem`}, 0, 0)`)});const _=[...w];D(),Uo(g,["transitionend","transitioncancel"],()=>{const B=A||d()==="exit-active"||d()==="exit-done";y.style.opacity="",g.style.overflowY="",g.style.transform="",i&&b&&(b.style.overflowY="",b.style.transform="",b.style.removeProperty("transition")),b?.style.removeProperty(Ss),v.forEach((E,z)=>{var O;if(!E.current)return;const H=_[z];B?(E.current.style.transition="",E.current.style.transform="",E.current.parentElement&&(E.current.parentElement.style.display="")):H&&(E.current.style.transition=H.style.transition,E.current.style.transform=H.style.transform,E.current.parentElement&&H.parentElement&&(E.current.parentElement.style.display=H.parentElement.style.display)),(O=E.current.parentElement)==null||O.style.removeProperty(Ss)}),h?.({swiped:A})})})})}const I=A=>{var D;const{activeElement:_}=document;(D=_?.blur)==null||D.call(_),x=N=A.touches[0].clientX,j=Date.now(),w=v.map(B=>B.current?{style:{transform:B.current.style.transform,transition:B.current.style.transition},parentElement:B.current.parentElement?{style:{display:B.current.parentElement.style.display}}:void 0}:{style:{transform:"",transition:""}}),u?.()},R=A=>{if(!x){S();return}N=A.touches[0].clientX;const D=N-x,_=D/g.clientWidth;T({dx:D,ratio:_}),m?.({dx:D,ratio:_})},P=()=>{if(!x||!j||!N){S();return}const A=Date.now(),_=(N-x)/(A-j)>1||N/g.clientWidth>.4;f?.({swiped:_}),Promise.resolve().then(()=>k({swiped:_})).then(()=>S())};return p.addEventListener("touchstart",I,{passive:!0}),p.addEventListener("touchmove",R,{passive:!0}),p.addEventListener("touchend",P,{passive:!0}),p.addEventListener("touchcancel",P,{passive:!0}),()=>{p.removeEventListener("touchstart",I),p.removeEventListener("touchmove",R),p.removeEventListener("touchend",P),p.removeEventListener("touchcancel",P)}},effectDeps:[c]})}function ls(){var t;const s=Et();return((t=s?.zIndex)!=null?t:0)*5}var ah=Object.defineProperty,rh=Object.defineProperties,ih=Object.getOwnPropertyDescriptors,qr=Object.getOwnPropertySymbols,oh=Object.prototype.hasOwnProperty,ch=Object.prototype.propertyIsEnumerable,Hr=(t,s,n)=>s in t?ah(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,ut=(t,s)=>{for(var n in s||(s={}))oh.call(s,n)&&Hr(t,n,s[n]);if(qr)for(var n of qr(s))ch.call(s,n)&&Hr(t,n,s[n]);return t},as=(t,s)=>rh(t,ih(s)),lh=t=>e.jsx("svg",{className:t.className,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.7241 2.76052C17.105 3.16043 17.0896 3.79341 16.6897 4.17431L8.45 12.0222L16.6896 19.8689C17.0896 20.2498 17.105 20.8827 16.7242 21.2827C16.3433 21.6826 15.7103 21.6981 15.3104 21.3172L6.31037 12.7464C6.11218 12.5576 6.00001 12.2959 6 12.0222C5.99999 11.7486 6.11215 11.4868 6.31032 11.2981L15.3103 2.72608C15.7102 2.34518 16.3432 2.3606 16.7241 2.76052Z",fill:"currentColor"})}),Ur=lh,dh=t=>e.jsx("svg",{className:t.className,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M20.7071 4.70711C21.0976 4.31658 21.0976 3.68342 20.7071 3.29289C20.3166 2.90237 19.6834 2.90237 19.2929 3.29289L12 10.5858L4.70711 3.29289C4.31658 2.90237 3.68342 2.90237 3.29289 3.29289C2.90237 3.68342 2.90237 4.31658 3.29289 4.70711L10.5858 12L3.29289 19.2929C2.90237 19.6834 2.90237 20.3166 3.29289 20.7071C3.68342 21.0976 4.31658 21.0976 4.70711 20.7071L12 13.4142L19.2929 20.7071C19.6834 21.0976 20.3166 21.0976 20.7071 20.7071C21.0976 20.3166 21.0976 19.6834 20.7071 19.2929L13.4142 12L20.7071 4.70711Z",fill:"currentColor"})}),Jr=dh,W={backgroundColor:"var(--stackflow-plugin-basic-ui-background-color)",backgroundImage:"var(--stackflow-plugin-basic-ui-background-image)",dimBackgroundColor:"var(--stackflow-plugin-basic-ui-dim-background-color)",dimHeight:"var(--stackflow-plugin-basic-ui-dim-height)",transitionDuration:"var(--stackflow-plugin-basic-ui-transition-duration)",computedTransitionDuration:"var(--stackflow-plugin-basic-ui-computed-transition-duration)",defaultTransitionOffSet:"var(--stackflow-plugin-basic-ui-default-transition-off-set)",appBar:{borderColor:"var(--stackflow-plugin-basic-ui-app-bar-border-color)",borderColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-border-color-transition-duration)",borderSize:"var(--stackflow-plugin-basic-ui-app-bar-border-size)",height:"var(--stackflow-plugin-basic-ui-app-bar-height)",heightTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-height-transition-duration)",minHeight:"var(--stackflow-plugin-basic-ui-app-bar-min-height)",iconColor:"var(--stackflow-plugin-basic-ui-app-bar-icon-color)",iconColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-icon-color-transition-duration)",textColor:"var(--stackflow-plugin-basic-ui-app-bar-text-color)",textColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-text-color-transition-duration)",backgroundColor:"var(--stackflow-plugin-basic-ui-app-bar-background-color)",backgroundColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-background-color-transition-duration)",backgroundImage:"var(--stackflow-plugin-basic-ui-app-bar-background-image)",backgroundImageTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-background-image-transition-duration)",overflow:"var(--stackflow-plugin-basic-ui-app-bar-overflow)",minSafeAreaInsetTop:"var(--stackflow-plugin-basic-ui-app-bar-min-safe-area-inset-top)",containerPadding:"var(--stackflow-plugin-basic-ui-app-bar-container-padding)",itemGap:"var(--stackflow-plugin-basic-ui-app-bar-item-gap)",fontSize:"var(--stackflow-plugin-basic-ui-app-bar-font-size)",lineHeight:"var(--stackflow-plugin-basic-ui-app-bar-line-height)",hitSlop:"var(--stackflow-plugin-basic-ui-app-bar-hit-slop)"},bottomSheet:{borderRadius:"var(--stackflow-plugin-basic-ui-bottom-sheet-border-radius)"},modal:{borderRadius:"var(--stackflow-plugin-basic-ui-modal-border-radius)",maxWidth:"var(--stackflow-plugin-basic-ui-modal-max-width)"},edge:{width:"var(--stackflow-plugin-basic-ui-edge-width)"}},uh=rt({defaultClassName:"_1q6dj2j2",variantClassNames:{theme:{android:"_1q6dj2j0",cupertino:"_1q6dj2j1"}},defaultVariants:{},compoundVariants:[]});function mh(t){return t.filter(s=>s!=null)}function Ns(t){return Object.entries(t).reduce((s,[n,a])=>(a!=null&&(s[n]=a),s),{})}var Jo=l.createContext({theme:"android"}),fh=Jo.Provider;function Vo(){return l.useContext(Jo)}var ph=t=>()=>({key:"basic-ui",wrapStack({stack:s,initialContext:n}){var a,r,o,c,i,d,u,m,f,h,v,y,p,g,b,x,j;const N=typeof t=="function"?t({initialContext:n}):t;return e.jsx(fh,{value:as(ut({},N),{theme:(a=n?.theme)!=null?a:N.theme}),children:e.jsx("div",{className:mh([uh({theme:(r=n?.theme)!=null?r:N.theme}),N.rootClassName]).join(" "),style:js(Ns({[W.backgroundColor]:N.backgroundColor,[W.backgroundImage]:N.backgroundImage,[W.dimBackgroundColor]:N.dimBackgroundColor,[W.dimHeight]:N.dimHeight,[W.transitionDuration]:`${s.transitionDuration}ms`,[W.computedTransitionDuration]:s.globalTransitionState==="loading"?`${s.transitionDuration}ms`:"0ms",[W.defaultTransitionOffSet]:N.defaultTransitionOffSet,[W.appBar.borderColor]:(o=N.appBar)==null?void 0:o.borderColor,[W.appBar.borderSize]:(c=N.appBar)==null?void 0:c.borderSize,[W.appBar.height]:(i=N.appBar)==null?void 0:i.height,[W.appBar.minHeight]:(d=N.appBar)==null?void 0:d.minHeight,[W.appBar.iconColor]:(u=N.appBar)==null?void 0:u.iconColor,[W.appBar.textColor]:(m=N.appBar)==null?void 0:m.textColor,[W.appBar.minSafeAreaInsetTop]:(f=N.appBar)==null?void 0:f.minSafeAreaInsetTop,[W.bottomSheet.borderRadius]:(h=N.bottomSheet)==null?void 0:h.borderRadius,[W.modal.borderRadius]:(v=N.modal)==null?void 0:v.borderRadius,[W.appBar.containerPadding]:(y=N.appBar)==null?void 0:y.containerPadding,[W.appBar.fontSize]:(p=N.appBar)==null?void 0:p.fontSize,[W.appBar.lineHeight]:(g=N.appBar)==null?void 0:g.lineHeight,[W.appBar.hitSlop]:(b=N.appBar)==null?void 0:b.hitSlop,[W.appBar.itemGap]:(x=N.appBar)==null?void 0:x.itemGap,[W.edge.width]:(j=N.edge)==null?void 0:j.width})),children:s.render()})})}}),hh=rt({defaultClassName:"_1yk3a452 dhthxq4 dhthxq0 dhthxqh _1yk3a451",variantClassNames:{activityEnterStyle:{slideInLeft:"_1yk3a453"},enterStyle:{cover:"_1yk3a454"},border:{true:"_1yk3a455"},modalPresentationStyle:{fullScreen:"_1yk3a456"}},defaultVariants:{},compoundVariants:[[{activityEnterStyle:"slideInLeft",enterStyle:"cover"},"_1yk3a457"]]}),Vr="_1yk3a45b dhthxq9 dhthxq7 dhthxqb dhthxqf dhthxqi",xh="dhthxq9 dhthxq7 dhthxq8 _1yk3a450",gh="_1yk3a45e",vh="_1yk3a45f dhthxqi dhthxq4 dhthxq2 dhthxqf",yh="_1yk3a45g dhthxqc dhthxqd dhthxq0",bh="_1yk3a45b dhthxq9 dhthxq7 dhthxqb dhthxqf dhthxqi",jh="_1yk3a459 dhthxqa dhthxq7 _1yk3a451",Nh="_1yk3a45a dhthxq9 dhthxq7 dhthxq1 _1yk3a450",wh="_1yk3a45h dhthxq9 dhthxq7 dhthxq1 dhthxq5 _1yk3a450",Ch="_1yk3a458",Sh=rt({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_1dlf434a","enter-done":"_1dlf434b","exit-active":"_1dlf434c","exit-done":"_1dlf434d"},hasAppBar:{true:"_1dlf434j"}},defaultVariants:{},compoundVariants:[]}),kh="_1dlf434k dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 _1dlf4347 _1dlf4349",Ah=rt({defaultClassName:"_1dlf434r dhthxq4 dhthxq2 dhthxq3 dhthxq1",variantClassNames:{hasAppBar:{true:"_1dlf434s"}},defaultVariants:{},compoundVariants:[]}),Th="_1dlf434a",Ih="_1dlf434b",Ph="_1dlf434c",Eh="_1dlf434d",_h=rt({defaultClassName:"_1dlf434l dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 _1dlf4348 _1dlf4349",variantClassNames:{hasAppBar:{true:"_1dlf434m dhthxqg"},modalPresentationStyle:{fullScreen:"_1dlf434n"},activityEnterStyle:{slideInLeft:"_1dlf434o"}},defaultVariants:{},compoundVariants:[]}),Mh=rt({defaultClassName:"_1dlf434p dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3",variantClassNames:{hasAppBar:{true:"_1dlf434q"}},defaultVariants:{},compoundVariants:[]}),Dt={transitionDuration:"var(--_1dlf4340)",zIndexes:{dim:"var(--_1dlf4341)",paper:"var(--_1dlf4342)",edge:"var(--_1dlf4343)",appBar:"var(--_1dlf4344)"},appBar:{center:{mainWidth:"var(--_1dlf4346)"}}},Ko=l.forwardRef(({title:t,renderLeft:s,renderRight:n,backButton:a,closeButton:r,closeButtonLocation:o="left",border:c=!0,modalPresentationStyle:i,activityEnterStyle:d,iconColor:u,iconColorTransitionDuration:m,textColor:f,textColorTransitionDuration:h,borderColor:v,borderColorTransitionDuration:y,borderSize:p,height:g,heightTransitionDuration:b,overflow:x,backgroundColor:j,backgroundColorTransitionDuration:N,backgroundImage:w,backgroundImageTransitionDuration:S,onTopClick:C,enterStyle:T,className:k,minHeight:I,fontSize:R,lineHeight:P,hitSlop:A,containerPadding:D,itemGap:_},B)=>{var E,z;const O=bs(),H=Et(),te=Ho();Ma();const Q=Vo(),V=(E=Q.appBar)==null?void 0:E.closeButton,G=(z=Q.appBar)==null?void 0:z.backButton,ie=l.useRef(null),{maxWidth:je}=Zp({outerRef:B,innerRef:ie,enable:Q.theme==="cupertino"}),Qe=(Q.theme==="cupertino"&&i!=="fullScreen"||d==="slideInLeft")&&T!=="cover",_t=X=>{a&&"onClick"in a&&a.onClick&&a.onClick(X),X.defaultPrevented||O.pop()},he=()=>{var X,ue;return!H||H.isRoot?null:!a&&!G?e.jsx("button",{type:"button","aria-label":"Go Back",className:Vr,onClick:_t,children:e.jsx(Ur,{})}):a&&"render"in a&&a.render?(X=a.render)==null?void 0:X.call(a):G&&"render"in G&&G.render?(ue=G.render)==null?void 0:ue.call(G):e.jsx("button",{type:"button",className:Vr,"aria-label":a&&"ariaLabel"in a?a.ariaLabel:G&&"ariaLabel"in G?G.ariaLabel:void 0,onClick:_t,children:a&&"renderIcon"in a&&a.renderIcon?a.renderIcon():G&&"renderIcon"in G&&G.renderIcon?G.renderIcon():i==="fullScreen"?e.jsx(Jr,{}):e.jsx(Ur,{})})},F=X=>{var ue;r&&"onClick"in r&&r.onClick&&r.onClick(X),!X.defaultPrevented&&V&&"onClick"in V&&((ue=V.onClick)==null||ue.call(V,X))},se=()=>{var X;const ue=!H||H.isRoot,we=xe=>xe&&"render"in xe&&xe.render||xe&&"renderIcon"in xe&&xe.renderIcon||xe&&"onClick"in xe&&xe.onClick;return!(we(r)||we((X=Q.appBar)==null?void 0:X.closeButton))||!ue?null:r&&"render"in r&&r.render?r.render():V&&"render"in V&&V.render?V.render():e.jsx("button",{type:"button",className:bh,"aria-label":r&&"ariaLabel"in r?r.ariaLabel:V&&"ariaLabel"in V?V.ariaLabel:void 0,onClick:F,children:r&&"renderIcon"in r&&r.renderIcon?r.renderIcon():V&&"renderIcon"in V&&V.renderIcon?V.renderIcon():e.jsx(Jr,{})})};return e.jsxs("div",as(ut({ref:B,className:vn(hh({border:c,modalPresentationStyle:i,activityEnterStyle:d,enterStyle:T}),k),style:js(Ns({[W.appBar.iconColor]:u,[W.appBar.iconColorTransitionDuration]:m,[W.appBar.textColor]:f,[W.appBar.textColorTransitionDuration]:h,[W.appBar.borderColor]:v,[W.appBar.borderColorTransitionDuration]:y,[W.appBar.borderSize]:p,[W.appBar.height]:g,[W.appBar.heightTransitionDuration]:b,[W.appBar.overflow]:x,[W.appBar.backgroundColor]:j??(Qe?W.backgroundColor:"transparent"),[W.appBar.backgroundColorTransitionDuration]:N,[W.appBar.backgroundImage]:w??(Qe?W.appBar.backgroundImage:"none"),[W.appBar.backgroundImageTransitionDuration]:S,[Dt.appBar.center.mainWidth]:`${je}px`,[W.appBar.minHeight]:I,[W.appBar.containerPadding]:D,[W.appBar.fontSize]:R,[W.appBar.hitSlop]:A,[W.appBar.lineHeight]:P,[W.appBar.itemGap]:_})),"data-part":"appBar"},te),{children:[e.jsx("div",{className:Ch}),e.jsxs("div",{className:jh,children:[e.jsxs("div",{className:Nh,children:[o==="left"&&se(),he(),s?.()]}),e.jsx("div",{ref:ie,className:xh,children:e.jsxs("div",{className:gh,children:[typeof t=="string"?e.jsx("div",{className:yh,children:t}):t,e.jsx("button",{className:vh,type:"button",onClick:C})]})}),e.jsxs("div",{className:wh,children:[n?.(),o==="right"&&se()]})]})]}))});Ko.displayName="AppBar";var Rh=Ko,Dh=32,Kr=80,zh=l.createContext(null),Bh=({backgroundColor:t,backgroundImage:s,dimBackgroundColor:n,appBar:a,preventSwipeBack:r,CUPERTINO_ONLY_modalPresentationStyle:o,ANDROID_ONLY_activityEnterStyle:c,className:i,children:d})=>{var u;const m=Vo(),f=Et(),h=Ho();Ma();const{pop:v}=bs(),y=l.useRef(null),p=l.useRef(null),g=l.useRef(null),b=l.useRef(null),x=l.useRef(null),j=l.useRef(null),N=m.theme==="cupertino"?o:void 0,w=m.theme==="android"?c:void 0,S=r||N==="fullScreen",C=!!a,T=ls();let k,I,R,P;m.theme==="cupertino"?(k=T+(N==="fullScreen"?2:0),I=T+(C&&N!=="fullScreen"?a.enterStyle==="cover"?2:1:3),R=T+4,P=T+7):(k=T,I=T+(w==="slideInLeft"&&a?.enterStyle!=="cover"?0:2),R=T+4,P=T+(w==="slideInLeft"?6:4));const A=(u=f?.transitionState)!=null?u:"enter-done",D=Ra(A);th({refs:[y]}),sh({refs:(m.theme==="cupertino"||w==="slideInLeft")&&a?.enterStyle!=="cover"?[g]:[g,x],offsetStyles:m.theme==="cupertino"?{transform:`translate3d(-${Kr/16}rem, 0, 0)`,opacity:"1"}:w==="slideInLeft"?{transform:"translate3d(-50%, 0, 0)",opacity:"0"}:{transform:`translate3d(0, -${Dh/16}rem, 0)`,opacity:"1"},transitionDuration:W.computedTransitionDuration,hasEffect:N!=="fullScreen"}),nh({dimRef:p,edgeRef:b,paperRef:g,appBarRef:x,offset:Kr,transitionDuration:W.transitionDuration,moveAppBarTogether:a?.enterStyle==="cover",preventSwipeBack:S||m.theme!=="cupertino",getActivityTransitionState(){const B=g.current,E=B?.parentElement;return E?E.classList.contains(Th)?"enter-active":E.classList.contains(Ih)?"enter-done":E.classList.contains(Ph)?"exit-active":E.classList.contains(Eh)?"exit-done":null:null},onSwipeEnd({swiped:B}){B&&v()}});const _=B=>{var E,z;(E=a?.onTopClick)==null||E.call(a,B),B.defaultPrevented||(z=j.current)==null||z.scroll({top:0,behavior:"smooth"})};return Da({ref:y}),e.jsx(zh.Provider,{value:l.useMemo(()=>({scroll({top:B}){var E;(E=j?.current)==null||E.scroll({top:B,behavior:"smooth"})},zIndices:{dim:k,paper:I,edge:R,appBar:P}}),[j,k,I,R,P]),children:e.jsxs("div",as(ut({ref:y,className:vn(Sh({hasAppBar:C,transitionState:A==="enter-done"||A==="exit-done"?A:D}),i),style:js(Ns({[W.backgroundColor]:t,[W.backgroundImage]:s,[W.dimBackgroundColor]:n,[W.appBar.height]:a?.height,[W.appBar.heightTransitionDuration]:a?.heightTransitionDuration,[Dt.zIndexes.dim]:`${k}`,[Dt.zIndexes.paper]:`${I}`,[Dt.zIndexes.edge]:`${R}`,[Dt.zIndexes.appBar]:`${P}`,[Dt.transitionDuration]:A==="enter-active"||A==="exit-active"?W.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"AppScreen"},h),{children:[w!=="slideInLeft"&&e.jsx("div",ut({ref:p,className:kh,"data-part":"dim"},h)),a&&e.jsx(Rh,as(ut({},a),{ref:x,modalPresentationStyle:N,activityEnterStyle:w,onTopClick:_})),e.jsx("div",as(ut({ref:g,className:_h({hasAppBar:C,modalPresentationStyle:N,activityEnterStyle:w}),"data-part":"paper"},h),{children:e.jsx("div",{ref:j,className:Mh({hasAppBar:C}),children:d})}),f?.id),!f?.isRoot&&m.theme==="cupertino"&&!S&&e.jsx("div",ut({ref:b,className:Ah({hasAppBar:C}),"data-part":"edge"},h))]}))})},Y=Bh,Lh=rt({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_1ht38h04","enter-done":"_1ht38h05","exit-active":"_1ht38h06","exit-done":"_1ht38h07"}},defaultVariants:{},compoundVariants:[]}),Oh="_1ht38h0d dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc dhthxqa dhthxq7 _1ht38h03",Fh="_1ht38h0e dhthxqc _1ht38h03",$n={transitionDuration:"var(--_1ht38h00)",zIndexes:{dim:"var(--_1ht38h01)",paper:"var(--_1ht38h02)"}},Go=({borderRadius:t="1rem",backgroundColor:s,backgroundImage:n,dimBackgroundColor:a,paperRef:r,onOutsideClick:o,children:c,className:i})=>{var d;const u=Et(),{pop:m}=bs(),f=l.useRef(null),h=l.useRef(null);Ke({styleName:"hide",refs:[f]}),Ke({styleName:"offset",refs:[h]}),Ke({styleName:"swipe-back",refs:[h]});const v=l.useRef(!1),y=j=>{o?.(j),!j.defaultPrevented&&(v.current||(v.current=!0,m()))},p=j=>{j.stopPropagation()},g=ls()+3,b=ls()+4,x=(d=u?.transitionState)!=null?d:"enter-done";return Da({ref:f}),e.jsx("div",{className:vn(Lh({transitionState:Ra(x)}),i),ref:f,style:js(Ns({[W.bottomSheet.borderRadius]:t,[W.backgroundColor]:s,[W.backgroundImage]:n,[W.dimBackgroundColor]:a,[$n.zIndexes.dim]:`${g}`,[$n.zIndexes.paper]:`${b}`,[$n.transitionDuration]:x==="enter-active"||x==="exit-active"?W.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"BottomSheet","data-stackflow-activity-id":u?.id,"data-stackflow-activity-is-active":u?.isActive,children:e.jsx("div",{className:Oh,ref:h,onClick:y,children:e.jsx("div",{className:Fh,ref:r,onClick:p,children:c})})})};Go.displayName="BottomSheet";var Wh=Go,$h=rt({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_5ozg8c4","enter-done":"_5ozg8c5","exit-active":"_5ozg8c6","exit-done":"_5ozg8c7"}},defaultVariants:{},compoundVariants:[]}),qh="_5ozg8cd dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc dhthxq9 dhthxq7 dhthxqb _5ozg8c3",Hh="_5ozg8ce dhthxqc _5ozg8c3",qn={transitionDuration:"var(--_5ozg8c0)",zIndexes:{dim:"var(--_5ozg8c1)",paper:"var(--_5ozg8c2)"}},Qo=({backgroundColor:t,backgroundImage:s,dimBackgroundColor:n,borderRadius:a="1rem",maxWidth:r,onOutsideClick:o,children:c,className:i})=>{var d;const u=Et(),{pop:m}=bs(),f=l.useRef(null),h=l.useRef(null);Ke({styleName:"hide",refs:[f]}),Ke({styleName:"offset",refs:[h]}),Ke({styleName:"swipe-back",refs:[h]});const v=l.useRef(!1),y=j=>{o?.(j),!j.defaultPrevented&&(v.current||(v.current=!0,m()))},p=j=>{j.stopPropagation()},g=ls()+3,b=ls()+4,x=(d=u?.transitionState)!=null?d:"enter-done";return Da({ref:f}),e.jsx("div",{className:vn($h({transitionState:Ra(x)}),i),ref:f,style:js(Ns({[W.backgroundColor]:t,[W.backgroundImage]:s,[W.dimBackgroundColor]:n,[W.modal.borderRadius]:a,[W.modal.maxWidth]:r,[qn.zIndexes.dim]:`${g}`,[qn.zIndexes.paper]:`${b}`,[qn.transitionDuration]:x==="enter-active"||x==="exit-active"?W.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"Modal","data-stackflow-activity-id":u?.id,"data-stackflow-activity-is-active":u?.isActive,children:e.jsx("div",{className:qh,ref:h,onClick:y,children:e.jsx("div",{className:Hh,onClick:p,children:c})})})};Qo.displayName="Modal";var Uh=Qo,Jh=Object.defineProperty,J=(t,s)=>Jh(t,"name",{value:s,configurable:!0}),Ot=class{type=3;name="";prefix="";value="";suffix="";modifier=3;constructor(t,s,n,a,r,o){this.type=t,this.name=s,this.prefix=n,this.value=a,this.suffix=r,this.modifier=o}hasCustomName(){return this.name!==""&&typeof this.name!="number"}};J(Ot,"Part");var Vh=/[$_\p{ID_Start}]/u,Kh=/[$_\u200C\u200D\p{ID_Continue}]/u,aa=".*";function Yo(t,s){return(s?/^[\x00-\xFF]*$/:/^[\x00-\x7F]*$/).test(t)}J(Yo,"isASCII");function za(t,s=!1){let n=[],a=0;for(;a<t.length;){let r=t[a],o=J(function(c){if(!s)throw new TypeError(c);n.push({type:"INVALID_CHAR",index:a,value:t[a++]})},"ErrorOrInvalid");if(r==="*"){n.push({type:"ASTERISK",index:a,value:t[a++]});continue}if(r==="+"||r==="?"){n.push({type:"OTHER_MODIFIER",index:a,value:t[a++]});continue}if(r==="\\"){n.push({type:"ESCAPED_CHAR",index:a++,value:t[a++]});continue}if(r==="{"){n.push({type:"OPEN",index:a,value:t[a++]});continue}if(r==="}"){n.push({type:"CLOSE",index:a,value:t[a++]});continue}if(r===":"){let c="",i=a+1;for(;i<t.length;){let d=t.substr(i,1);if(i===a+1&&Vh.test(d)||i!==a+1&&Kh.test(d)){c+=t[i++];continue}break}if(!c){o(`Missing parameter name at ${a}`);continue}n.push({type:"NAME",index:a,value:c}),a=i;continue}if(r==="("){let c=1,i="",d=a+1,u=!1;if(t[d]==="?"){o(`Pattern cannot start with "?" at ${d}`);continue}for(;d<t.length;){if(!Yo(t[d],!1)){o(`Invalid character '${t[d]}' at ${d}.`),u=!0;break}if(t[d]==="\\"){i+=t[d++]+t[d++];continue}if(t[d]===")"){if(c--,c===0){d++;break}}else if(t[d]==="("&&(c++,t[d+1]!=="?")){o(`Capturing groups are not allowed at ${d}`),u=!0;break}i+=t[d++]}if(u)continue;if(c){o(`Unbalanced pattern at ${a}`);continue}if(!i){o(`Missing pattern at ${a}`);continue}n.push({type:"REGEX",index:a,value:i}),a=d;continue}n.push({type:"CHAR",index:a,value:t[a++]})}return n.push({type:"END",index:a,value:""}),n}J(za,"lexer");function Ba(t,s={}){let n=za(t);s.delimiter??="/#?",s.prefixes??="./";let a=`[^${Ne(s.delimiter)}]+?`,r=[],o=0,c=0,i=new Set,d=J(x=>{if(c<n.length&&n[c].type===x)return n[c++].value},"tryConsume"),u=J(()=>d("OTHER_MODIFIER")??d("ASTERISK"),"tryConsumeModifier"),m=J(x=>{let j=d(x);if(j!==void 0)return j;let{type:N,index:w}=n[c];throw new TypeError(`Unexpected ${N} at ${w}, expected ${x}`)},"mustConsume"),f=J(()=>{let x="",j;for(;j=d("CHAR")??d("ESCAPED_CHAR");)x+=j;return x},"consumeText"),h=J(x=>x,"DefaultEncodePart"),v=s.encodePart||h,y="",p=J(x=>{y+=x},"appendToPendingFixedValue"),g=J(()=>{y.length&&(r.push(new Ot(3,"","",v(y),"",3)),y="")},"maybeAddPartFromPendingFixedValue"),b=J((x,j,N,w,S)=>{let C=3;switch(S){case"?":C=1;break;case"*":C=0;break;case"+":C=2;break}if(!j&&!N&&C===3){p(x);return}if(g(),!j&&!N){if(!x)return;r.push(new Ot(3,"","",v(x),"",C));return}let T;N?N==="*"?T=aa:T=N:T=a;let k=2;T===a?(k=1,T=""):T===aa&&(k=0,T="");let I;if(j?I=j:N&&(I=o++),i.has(I))throw new TypeError(`Duplicate name '${I}'.`);i.add(I),r.push(new Ot(k,I,v(x),T,v(w),C))},"addPart");for(;c<n.length;){let x=d("CHAR"),j=d("NAME"),N=d("REGEX");if(!j&&!N&&(N=d("ASTERISK")),j||N){let S=x??"";s.prefixes.indexOf(S)===-1&&(p(S),S=""),g();let C=u();b(S,j,N,"",C);continue}let w=x??d("ESCAPED_CHAR");if(w){p(w);continue}if(d("OPEN")){let S=f(),C=d("NAME"),T=d("REGEX");!C&&!T&&(T=d("ASTERISK"));let k=f();m("CLOSE");let I=u();b(S,C,T,k,I);continue}g(),m("END")}return r}J(Ba,"parse");function Ne(t){return t.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}J(Ne,"escapeString");function ra(t){return t&&t.ignoreCase?"ui":"u"}J(ra,"flags");function Xo(t,s,n){return La(Ba(t,n),s,n)}J(Xo,"stringToRegexp");function pt(t){switch(t){case 0:return"*";case 1:return"?";case 2:return"+";case 3:return""}}J(pt,"modifierToString");function La(t,s,n={}){n.delimiter??="/#?",n.prefixes??="./",n.sensitive??=!1,n.strict??=!1,n.end??=!0,n.start??=!0,n.endsWith="";let a=n.start?"^":"";for(let i of t){if(i.type===3){i.modifier===3?a+=Ne(i.value):a+=`(?:${Ne(i.value)})${pt(i.modifier)}`;continue}s&&s.push(i.name);let d=`[^${Ne(n.delimiter)}]+?`,u=i.value;if(i.type===1?u=d:i.type===0&&(u=aa),!i.prefix.length&&!i.suffix.length){i.modifier===3||i.modifier===1?a+=`(${u})${pt(i.modifier)}`:a+=`((?:${u})${pt(i.modifier)})`;continue}if(i.modifier===3||i.modifier===1){a+=`(?:${Ne(i.prefix)}(${u})${Ne(i.suffix)})`,a+=pt(i.modifier);continue}a+=`(?:${Ne(i.prefix)}`,a+=`((?:${u})(?:`,a+=Ne(i.suffix),a+=Ne(i.prefix),a+=`(?:${u}))*)${Ne(i.suffix)})`,i.modifier===0&&(a+="?")}let r=`[${Ne(n.endsWith)}]|$`,o=`[${Ne(n.delimiter)}]`;if(n.end)return n.strict||(a+=`${o}?`),n.endsWith.length?a+=`(?=${r})`:a+="$",new RegExp(a,ra(n));n.strict||(a+=`(?:${o}(?=${r}))?`);let c=!1;if(t.length){let i=t[t.length-1];i.type===3&&i.modifier===3&&(c=n.delimiter.indexOf(i)>-1)}return c||(a+=`(?=${o}|${r})`),new RegExp(a,ra(n))}J(La,"partsToRegexp");var tt={delimiter:"",prefixes:"",sensitive:!0,strict:!0},Gh={delimiter:".",prefixes:"",sensitive:!0,strict:!0},Qh={delimiter:"/",prefixes:"/",sensitive:!0,strict:!0};function Zo(t,s){return t.length?t[0]==="/"?!0:!s||t.length<2?!1:(t[0]=="\\"||t[0]=="{")&&t[1]=="/":!1}J(Zo,"isAbsolutePathname");function Oa(t,s){return t.startsWith(s)?t.substring(s.length,t.length):t}J(Oa,"maybeStripPrefix");function ec(t,s){return t.endsWith(s)?t.substr(0,t.length-s.length):t}J(ec,"maybeStripSuffix");function Fa(t){return!t||t.length<2?!1:t[0]==="["||(t[0]==="\\"||t[0]==="{")&&t[1]==="["}J(Fa,"treatAsIPv6Hostname");var tc=["ftp","file","http","https","ws","wss"];function Wa(t){if(!t)return!0;for(let s of tc)if(t.test(s))return!0;return!1}J(Wa,"isSpecialScheme");function sc(t,s){if(t=Oa(t,"#"),s||t==="")return t;let n=new URL("https://example.com");return n.hash=t,n.hash?n.hash.substring(1,n.hash.length):""}J(sc,"canonicalizeHash");function nc(t,s){if(t=Oa(t,"?"),s||t==="")return t;let n=new URL("https://example.com");return n.search=t,n.search?n.search.substring(1,n.search.length):""}J(nc,"canonicalizeSearch");function ac(t,s){return s||t===""?t:Fa(t)?Ha(t):qa(t)}J(ac,"canonicalizeHostname");function rc(t,s){if(s||t==="")return t;let n=new URL("https://example.com");return n.password=t,n.password}J(rc,"canonicalizePassword");function ic(t,s){if(s||t==="")return t;let n=new URL("https://example.com");return n.username=t,n.username}J(ic,"canonicalizeUsername");function oc(t,s,n){if(n||t==="")return t;if(s&&!tc.includes(s))return new URL(`${s}:${t}`).pathname;let a=t[0]=="/";return t=new URL(a?t:"/-"+t,"https://example.com").pathname,a||(t=t.substring(2,t.length)),t}J(oc,"canonicalizePathname");function cc(t,s,n){return $a(s)===t&&(t=""),n||t===""?t:Ua(t)}J(cc,"canonicalizePort");function lc(t,s){return t=ec(t,":"),s||t===""?t:In(t)}J(lc,"canonicalizeProtocol");function $a(t){switch(t){case"ws":case"http":return"80";case"wws":case"https":return"443";case"ftp":return"21";default:return""}}J($a,"defaultPortForProtocol");function In(t){if(t==="")return t;if(/^[-+.A-Za-z0-9]*$/.test(t))return t.toLowerCase();throw new TypeError(`Invalid protocol '${t}'.`)}J(In,"protocolEncodeCallback");function dc(t){if(t==="")return t;let s=new URL("https://example.com");return s.username=t,s.username}J(dc,"usernameEncodeCallback");function uc(t){if(t==="")return t;let s=new URL("https://example.com");return s.password=t,s.password}J(uc,"passwordEncodeCallback");function qa(t){if(t==="")return t;if(/[\t\n\r #%/:<>?@[\]^\\|]/g.test(t))throw new TypeError(`Invalid hostname '${t}'`);let s=new URL("https://example.com");return s.hostname=t,s.hostname}J(qa,"hostnameEncodeCallback");function Ha(t){if(t==="")return t;if(/[^0-9a-fA-F[\]:]/g.test(t))throw new TypeError(`Invalid IPv6 hostname '${t}'`);return t.toLowerCase()}J(Ha,"ipv6HostnameEncodeCallback");function Ua(t){if(t===""||/^[0-9]*$/.test(t)&&parseInt(t)<=65535)return t;throw new TypeError(`Invalid port '${t}'.`)}J(Ua,"portEncodeCallback");function mc(t){if(t==="")return t;let s=new URL("https://example.com");return s.pathname=t[0]!=="/"?"/-"+t:t,t[0]!=="/"?s.pathname.substring(2,s.pathname.length):s.pathname}J(mc,"standardURLPathnameEncodeCallback");function fc(t){return t===""?t:new URL(`data:${t}`).pathname}J(fc,"pathURLPathnameEncodeCallback");function pc(t){if(t==="")return t;let s=new URL("https://example.com");return s.search=t,s.search.substring(1,s.search.length)}J(pc,"searchEncodeCallback");function hc(t){if(t==="")return t;let s=new URL("https://example.com");return s.hash=t,s.hash.substring(1,s.hash.length)}J(hc,"hashEncodeCallback");var xc=class{#r;#n=[];#t={};#e=0;#a=1;#l=0;#o=0;#f=0;#p=0;#h=!1;constructor(t){this.#r=t}get result(){return this.#t}parse(){for(this.#n=za(this.#r,!0);this.#e<this.#n.length;this.#e+=this.#a){if(this.#a=1,this.#n[this.#e].type==="END"){if(this.#o===0){this.#y(),this.#d()?this.#s(9,1):this.#u()?this.#s(8,1):this.#s(7,0);continue}else if(this.#o===2){this.#m(5);continue}this.#s(10,0);break}if(this.#f>0)if(this.#k())this.#f-=1;else continue;if(this.#S()){this.#f+=1;continue}switch(this.#o){case 0:this.#b()&&this.#m(1);break;case 1:if(this.#b()){this.#I();let t=7,s=1;this.#N()?(t=2,s=3):this.#h&&(t=2),this.#s(t,s)}break;case 2:this.#g()?this.#m(3):(this.#v()||this.#u()||this.#d())&&this.#m(5);break;case 3:this.#w()?this.#s(4,1):this.#g()&&this.#s(5,1);break;case 4:this.#g()&&this.#s(5,1);break;case 5:this.#A()?this.#p+=1:this.#T()&&(this.#p-=1),this.#C()&&!this.#p?this.#s(6,1):this.#v()?this.#s(7,0):this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 6:this.#v()?this.#s(7,0):this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 7:this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 8:this.#d()&&this.#s(9,1);break}}this.#t.hostname!==void 0&&this.#t.port===void 0&&(this.#t.port="")}#s(t,s){switch(this.#o){case 0:break;case 1:this.#t.protocol=this.#c();break;case 2:break;case 3:this.#t.username=this.#c();break;case 4:this.#t.password=this.#c();break;case 5:this.#t.hostname=this.#c();break;case 6:this.#t.port=this.#c();break;case 7:this.#t.pathname=this.#c();break;case 8:this.#t.search=this.#c();break;case 9:this.#t.hash=this.#c();break}this.#o!==0&&t!==10&&([1,2,3,4].includes(this.#o)&&[6,7,8,9].includes(t)&&(this.#t.hostname??=""),[1,2,3,4,5,6].includes(this.#o)&&[8,9].includes(t)&&(this.#t.pathname??=this.#h?"/":""),[1,2,3,4,5,6,7].includes(this.#o)&&t===9&&(this.#t.search??="")),this.#j(t,s)}#j(t,s){this.#o=t,this.#l=this.#e+s,this.#e+=s,this.#a=0}#y(){this.#e=this.#l,this.#a=0}#m(t){this.#y(),this.#o=t}#x(t){return t<0&&(t=this.#n.length-t),t<this.#n.length?this.#n[t]:this.#n[this.#n.length-1]}#i(t,s){let n=this.#x(t);return n.value===s&&(n.type==="CHAR"||n.type==="ESCAPED_CHAR"||n.type==="INVALID_CHAR")}#b(){return this.#i(this.#e,":")}#N(){return this.#i(this.#e+1,"/")&&this.#i(this.#e+2,"/")}#g(){return this.#i(this.#e,"@")}#w(){return this.#i(this.#e,":")}#C(){return this.#i(this.#e,":")}#v(){return this.#i(this.#e,"/")}#u(){if(this.#i(this.#e,"?"))return!0;if(this.#n[this.#e].value!=="?")return!1;let t=this.#x(this.#e-1);return t.type!=="NAME"&&t.type!=="REGEX"&&t.type!=="CLOSE"&&t.type!=="ASTERISK"}#d(){return this.#i(this.#e,"#")}#S(){return this.#n[this.#e].type=="OPEN"}#k(){return this.#n[this.#e].type=="CLOSE"}#A(){return this.#i(this.#e,"[")}#T(){return this.#i(this.#e,"]")}#c(){let t=this.#n[this.#e],s=this.#x(this.#l).index;return this.#r.substring(s,t.index)}#I(){let t={};Object.assign(t,tt),t.encodePart=In;let s=Xo(this.#c(),void 0,t);this.#h=Wa(s)}};J(xc,"Parser");var Hn=["protocol","username","password","hostname","port","pathname","search","hash"],Ze="*";function ia(t,s){if(typeof t!="string")throw new TypeError("parameter 1 is not of type 'string'.");let n=new URL(t,s);return{protocol:n.protocol.substring(0,n.protocol.length-1),username:n.username,password:n.password,hostname:n.hostname,port:n.port,pathname:n.pathname,search:n.search!==""?n.search.substring(1,n.search.length):void 0,hash:n.hash!==""?n.hash.substring(1,n.hash.length):void 0}}J(ia,"extractValues");function Re(t,s){return s?Bt(t):t}J(Re,"processBaseURLString");function zt(t,s,n){let a;if(typeof s.baseURL=="string")try{a=new URL(s.baseURL),s.protocol===void 0&&(t.protocol=Re(a.protocol.substring(0,a.protocol.length-1),n)),!n&&s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.username===void 0&&(t.username=Re(a.username,n)),!n&&s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.username===void 0&&s.password===void 0&&(t.password=Re(a.password,n)),s.protocol===void 0&&s.hostname===void 0&&(t.hostname=Re(a.hostname,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&(t.port=Re(a.port,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&(t.pathname=Re(a.pathname,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&s.search===void 0&&(t.search=Re(a.search.substring(1,a.search.length),n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&s.search===void 0&&s.hash===void 0&&(t.hash=Re(a.hash.substring(1,a.hash.length),n))}catch{throw new TypeError(`invalid baseURL '${s.baseURL}'.`)}if(typeof s.protocol=="string"&&(t.protocol=lc(s.protocol,n)),typeof s.username=="string"&&(t.username=ic(s.username,n)),typeof s.password=="string"&&(t.password=rc(s.password,n)),typeof s.hostname=="string"&&(t.hostname=ac(s.hostname,n)),typeof s.port=="string"&&(t.port=cc(s.port,t.protocol,n)),typeof s.pathname=="string"){if(t.pathname=s.pathname,a&&!Zo(t.pathname,n)){let r=a.pathname.lastIndexOf("/");r>=0&&(t.pathname=Re(a.pathname.substring(0,r+1),n)+t.pathname)}t.pathname=oc(t.pathname,t.protocol,n)}return typeof s.search=="string"&&(t.search=nc(s.search,n)),typeof s.hash=="string"&&(t.hash=sc(s.hash,n)),t}J(zt,"applyInit");function Bt(t){return t.replace(/([+*?:{}()\\])/g,"\\$1")}J(Bt,"escapePatternString");function gc(t){return t.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}J(gc,"escapeRegexpString");function vc(t,s){s.delimiter??="/#?",s.prefixes??="./",s.sensitive??=!1,s.strict??=!1,s.end??=!0,s.start??=!0,s.endsWith="";let n=".*",a=`[^${gc(s.delimiter)}]+?`,r=/[$_\u200C\u200D\p{ID_Continue}]/u,o="";for(let c=0;c<t.length;++c){let i=t[c];if(i.type===3){if(i.modifier===3){o+=Bt(i.value);continue}o+=`{${Bt(i.value)}}${pt(i.modifier)}`;continue}let d=i.hasCustomName(),u=!!i.suffix.length||!!i.prefix.length&&(i.prefix.length!==1||!s.prefixes.includes(i.prefix)),m=c>0?t[c-1]:null,f=c<t.length-1?t[c+1]:null;if(!u&&d&&i.type===1&&i.modifier===3&&f&&!f.prefix.length&&!f.suffix.length)if(f.type===3){let h=f.value.length>0?f.value[0]:"";u=r.test(h)}else u=!f.hasCustomName();if(!u&&!i.prefix.length&&m&&m.type===3){let h=m.value[m.value.length-1];u=s.prefixes.includes(h)}u&&(o+="{"),o+=Bt(i.prefix),d&&(o+=`:${i.name}`),i.type===2?o+=`(${i.value})`:i.type===1?d||(o+=`(${a})`):i.type===0&&(!d&&(!m||m.type===3||m.modifier!==3||u||i.prefix!=="")?o+="*":o+=`(${n})`),i.type===1&&d&&i.suffix.length&&r.test(i.suffix[0])&&(o+="\\"),o+=Bt(i.suffix),u&&(o+="}"),i.modifier!==3&&(o+=pt(i.modifier))}return o}J(vc,"partsToPattern");var yc=class{#r;#n={};#t={};#e={};#a={};#l=!1;constructor(t={},s,n){try{let a;if(typeof s=="string"?a=s:n=s,typeof t=="string"){let i=new xc(t);if(i.parse(),t=i.result,a===void 0&&typeof t.protocol!="string")throw new TypeError("A base URL must be provided for a relative constructor string.");t.baseURL=a}else{if(!t||typeof t!="object")throw new TypeError("parameter 1 is not of type 'string' and cannot convert to dictionary.");if(a)throw new TypeError("parameter 1 is not of type 'string'.")}typeof n>"u"&&(n={ignoreCase:!1});let r={ignoreCase:n.ignoreCase===!0},o={pathname:Ze,protocol:Ze,username:Ze,password:Ze,hostname:Ze,port:Ze,search:Ze,hash:Ze};this.#r=zt(o,t,!0),$a(this.#r.protocol)===this.#r.port&&(this.#r.port="");let c;for(c of Hn){if(!(c in this.#r))continue;let i={},d=this.#r[c];switch(this.#t[c]=[],c){case"protocol":Object.assign(i,tt),i.encodePart=In;break;case"username":Object.assign(i,tt),i.encodePart=dc;break;case"password":Object.assign(i,tt),i.encodePart=uc;break;case"hostname":Object.assign(i,Gh),Fa(d)?i.encodePart=Ha:i.encodePart=qa;break;case"port":Object.assign(i,tt),i.encodePart=Ua;break;case"pathname":Wa(this.#n.protocol)?(Object.assign(i,Qh,r),i.encodePart=mc):(Object.assign(i,tt,r),i.encodePart=fc);break;case"search":Object.assign(i,tt,r),i.encodePart=pc;break;case"hash":Object.assign(i,tt,r),i.encodePart=hc;break}try{this.#a[c]=Ba(d,i),this.#n[c]=La(this.#a[c],this.#t[c],i),this.#e[c]=vc(this.#a[c],i),this.#l=this.#l||this.#a[c].some(u=>u.type===2)}catch{throw new TypeError(`invalid ${c} pattern '${this.#r[c]}'.`)}}}catch(a){throw new TypeError(`Failed to construct 'URLPattern': ${a.message}`)}}get[Symbol.toStringTag](){return"URLPattern"}test(t={},s){let n={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof t!="string"&&s)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof t>"u")return!1;try{typeof t=="object"?n=zt(n,t,!1):n=zt(n,ia(t,s),!1)}catch{return!1}let a;for(a of Hn)if(!this.#n[a].exec(n[a]))return!1;return!0}exec(t={},s){let n={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof t!="string"&&s)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof t>"u")return;try{typeof t=="object"?n=zt(n,t,!1):n=zt(n,ia(t,s),!1)}catch{return null}let a={};s?a.inputs=[t,s]:a.inputs=[t];let r;for(r of Hn){let o=this.#n[r].exec(n[r]);if(!o)return null;let c={};for(let[i,d]of this.#t[r].entries())if(typeof d=="string"||typeof d=="number"){let u=o[i+1];c[d]=u}a[r]={input:n[r]??"",groups:c}}return a}static compareComponent(t,s,n){let a=J((i,d)=>{for(let u of["type","modifier","prefix","value","suffix"]){if(i[u]<d[u])return-1;if(i[u]!==d[u])return 1}return 0},"comparePart"),r=new Ot(3,"","","","",3),o=new Ot(0,"","","","",3),c=J((i,d)=>{let u=0;for(;u<Math.min(i.length,d.length);++u){let m=a(i[u],d[u]);if(m)return m}return i.length===d.length?0:a(i[u]??r,d[u]??r)},"comparePartList");return!s.#e[t]&&!n.#e[t]?0:s.#e[t]&&!n.#e[t]?c(s.#a[t],[o]):!s.#e[t]&&n.#e[t]?c([o],n.#a[t]):c(s.#a[t],n.#a[t])}get protocol(){return this.#e.protocol}get username(){return this.#e.username}get password(){return this.#e.password}get hostname(){return this.#e.hostname}get port(){return this.#e.port}get pathname(){return this.#e.pathname}get search(){return this.#e.search}get hash(){return this.#e.hash}get hasRegExpGroups(){return this.#l}};J(yc,"URLPattern");globalThis.URLPattern||(globalThis.URLPattern=yc);const Yh=l.createContext({requestHistoryTick:()=>{}}),bc=({children:t,requestHistoryTick:s})=>{const n=l.useMemo(()=>({requestHistoryTick:s}),[s]);return e.jsx(Yh.Provider,{value:n,children:t})};bc.__docgenInfo={description:"",methods:[],displayName:"HistoryQueueProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},requestHistoryTick:{required:!0,tsType:{name:"signature",type:"function",raw:"(cb: (resolve: () => void) => void) => void",signature:{arguments:[{type:{name:"signature",type:"function",raw:"(resolve: () => void) => void",signature:{arguments:[{type:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},name:"resolve"}],return:{name:"void"}}},name:"cb"}],return:{name:"void"}}},description:""}}};function Ut(){return Ut=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Ut.apply(null,arguments)}var ze;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ze||(ze={}));var sn=function(t){return t},Gr="beforeunload",Xh="popstate";function Zh(t){t===void 0&&(t={});var s=t,n=s.window,a=n===void 0?document.defaultView:n,r=a.history;function o(){var C=a.location,T=C.pathname,k=C.search,I=C.hash,R=r.state||{};return[R.idx,sn({pathname:T,search:k,hash:I,state:R.usr||null,key:R.key||"default"})]}var c=null;function i(){if(c)v.call(c),c=null;else{var C=ze.Pop,T=o(),k=T[0],I=T[1];if(v.length){if(k!=null){var R=m-k;R&&(c={action:C,location:I,retry:function(){w(R*-1)}},w(R))}}else x(C)}}a.addEventListener(Xh,i);var d=ze.Pop,u=o(),m=u[0],f=u[1],h=nn(),v=nn();m==null&&(m=0,r.replaceState(Ut({},r.state,{idx:m}),""));function y(C){return typeof C=="string"?C:jc(C)}function p(C,T){return T===void 0&&(T=null),sn(Ut({pathname:f.pathname,hash:"",search:""},typeof C=="string"?ca(C):C,{state:T,key:oa()}))}function g(C,T){return[{usr:C.state,key:C.key,idx:T},y(C)]}function b(C,T,k){return!v.length||(v.call({action:C,location:T,retry:k}),!1)}function x(C){d=C;var T=o();m=T[0],f=T[1],h.call({action:d,location:f})}function j(C,T){var k=ze.Push,I=p(C,T);function R(){j(C,T)}if(b(k,I,R)){var P=g(I,m+1),A=P[0],D=P[1];try{r.pushState(A,"",D)}catch{a.location.assign(D)}x(k)}}function N(C,T){var k=ze.Replace,I=p(C,T);function R(){N(C,T)}if(b(k,I,R)){var P=g(I,m),A=P[0],D=P[1];r.replaceState(A,"",D),x(k)}}function w(C){r.go(C)}var S={get action(){return d},get location(){return f},createHref:y,push:j,replace:N,go:w,back:function(){w(-1)},forward:function(){w(1)},listen:function(T){return h.push(T)},block:function(T){var k=v.push(T);return v.length===1&&a.addEventListener(Gr,Yr),function(){k(),v.length||a.removeEventListener(Gr,Yr)}}};return S}function ex(t){t===void 0&&(t={});var s=t,n=s.initialEntries,a=n===void 0?["/"]:n,r=s.initialIndex,o=a.map(function(j){var N=sn(Ut({pathname:"/",search:"",hash:"",state:null,key:oa()},typeof j=="string"?ca(j):j));return N}),c=Qr(r??o.length-1,0,o.length-1),i=ze.Pop,d=o[c],u=nn(),m=nn();function f(j){return typeof j=="string"?j:jc(j)}function h(j,N){return N===void 0&&(N=null),sn(Ut({pathname:d.pathname,search:"",hash:""},typeof j=="string"?ca(j):j,{state:N,key:oa()}))}function v(j,N,w){return!m.length||(m.call({action:j,location:N,retry:w}),!1)}function y(j,N){i=j,d=N,u.call({action:i,location:d})}function p(j,N){var w=ze.Push,S=h(j,N);function C(){p(j,N)}v(w,S,C)&&(c+=1,o.splice(c,o.length,S),y(w,S))}function g(j,N){var w=ze.Replace,S=h(j,N);function C(){g(j,N)}v(w,S,C)&&(o[c]=S,y(w,S))}function b(j){var N=Qr(c+j,0,o.length-1),w=ze.Pop,S=o[N];function C(){b(j)}v(w,S,C)&&(c=N,y(w,S))}var x={get index(){return c},get action(){return i},get location(){return d},createHref:f,push:p,replace:g,go:b,back:function(){b(-1)},forward:function(){b(1)},listen:function(N){return u.push(N)},block:function(N){return m.push(N)}};return x}function Qr(t,s,n){return Math.min(Math.max(t,s),n)}function Yr(t){t.preventDefault(),t.returnValue=""}function nn(){var t=[];return{get length(){return t.length},push:function(n){return t.push(n),function(){t=t.filter(function(a){return a!==n})}},call:function(n){t.forEach(function(a){return a&&a(n)})}}}function oa(){return Math.random().toString(36).substr(2,8)}function jc(t){var s=t.pathname,n=s===void 0?"/":s,a=t.search,r=a===void 0?"":a,o=t.hash,c=o===void 0?"":o;return r&&r!=="?"&&(n+=r.charAt(0)==="?"?r:"?"+r),c&&c!=="#"&&(n+=c.charAt(0)==="#"?c:"#"+c),n}function ca(t){var s={};if(t){var n=t.indexOf("#");n>=0&&(s.hash=t.substr(n),t=t.substr(0,n));var a=t.indexOf("?");a>=0&&(s.search=t.substr(a),t=t.substr(0,a)),t&&(s.pathname=t)}return s}const tx=l.createContext([]);function Nc(t){return t.name==="Pushed"||t.name==="Popped"||t.name==="Replaced"}function sx(t){return t.name==="StepPushed"||t.name==="StepPopped"||t.name==="StepReplaced"}function nx(t){return Nc(t)||sx(t)}const mt={IDLE:"idle",PROGRESS:"progress",SUCCEEDED:"succeeded",FAILED:"failed"};function wc(t){return t===mt.SUCCEEDED||t===mt.FAILED}class ax{targetId;initialSetupProcess;focusCount;previousActivationTrigger;constructor(s,n){this.targetId=s,this.initialSetupProcess=n,this.focusCount=0,this.previousActivationTrigger=null}captureStackChange(s){const n=this.initialSetupProcess.getStatus();if(!wc(n))return;const a=s.activities.find(o=>o.id===this.targetId);if(!a||!a.isActive)return;const r=s.events.findLast(Nc);!r||this.previousActivationTrigger&&r.eventDate<=this.previousActivationTrigger.eventDate||(this.focusCount++,this.previousActivationTrigger=r)}getActivationCount(){return this.focusCount}getTargetId(){return this.targetId}}const{parse:rx,stringify:ix}=JSON,{keys:ox}=Object,ds=String,Cc="string",Xr={},Ja="object",Sc=(t,s)=>s,cx=t=>t instanceof ds?ds(t):t,lx=(t,s)=>typeof s===Cc?new ds(s):s,kc=(t,s,n,a)=>{const r=[];for(let o=ox(n),{length:c}=o,i=0;i<c;i++){const d=o[i],u=n[d];if(u instanceof ds){const m=t[u];typeof m===Ja&&!s.has(m)?(s.add(m),n[d]=Xr,r.push({k:d,a:[t,s,m,a]})):n[d]=a.call(n,d,m)}else n[d]!==Xr&&(n[d]=a.call(n,d,u))}for(let{length:o}=r,c=0;c<o;c++){const{k:i,a:d}=r[c];n[i]=a.call(n,i,kc.apply(null,d))}return n},Zr=(t,s,n)=>{const a=ds(s.push(n)-1);return t.set(n,a),a},dx=(t,s)=>{const n=rx(t,lx).map(cx),a=n[0],r=s||Sc,o=typeof a===Ja&&a?kc(n,new Set,a,r):a;return r.call({"":o},"",o)},ux=(t,s,n)=>{const a=Sc,r=new Map,o=[],c=[];let i=+Zr(r,o,a.call({"":t},"",t)),d=!i;for(;i<o.length;)d=!0,c[i]=ix(o[i++],u,n);return"["+c.join(",")+"]";function u(m,f){if(d)return d=!d,f;const h=a.call(this,m,f);switch(typeof h){case Ja:if(h===null)return h;case Cc:return r.get(h)||Zr(r,o,h)}return h}},Ac="@biochain/plugin-navigation-sync";function Tc(t){return{_TAG:Ac,flattedState:ux({activity:t.activity,step:t.step})}}function mx(t){return typeof t=="object"&&t!==null&&"_TAG"in t&&"flattedState"in t&&typeof t._TAG=="string"&&t._TAG===Ac&&typeof t.flattedState=="string"}function ks(t){try{return mx(t)?dx(t.flattedState):null}catch{return null}}function ei({history:t,pathname:s,state:n,useHash:a}){const r=a?`${t.location.pathname}#${s}`:s;t.push(r,Tc(n))}function Un({history:t,pathname:s,state:n,useHash:a}){const r=a?`${t.location.pathname}#${s}`:s;t.replace(r,Tc(n))}function ti(t){return t.length===0?void 0:t[t.length-1]}const fx=t=>{let s=Promise.resolve();return{requestHistoryTick:a=>{s=s.then(()=>new Promise(r=>{const o=t.listen(()=>{o(),r()});a(()=>{o(),r()})}))}}};function Ic(t){return new URL(t,"file://")}function la(t){const s={};return t.forEach((n,a)=>{s[a]=n}),s}function As(t){return t.endsWith("/")?t:`${t}/`}function si(t){return t.toString().length>0?`?${t}`:t}function Ae({path:t,decode:s},n){const a=t==="*"||t==="/*",r=a?[]:Array.from(t.matchAll(/:([A-Za-z0-9_]+)/g)).map(u=>u[1]).filter(Boolean),o=Array.from(new Set(r)),c=a?Number.POSITIVE_INFINITY:o.length,i=a?"*":As(t),d=a?null:new URLPattern({pathname:i});return{fill(u){if(a){const v=new URLSearchParams(Object.entries(u).reduce((y,[p,g])=>g?{...y,[p]:g}:y,{}));return As("/")+si(v)}let m=t;for(const v of o){const y=u[v];if(y===void 0)throw new Error(`Missing route param: ${v}`);m=m.replace(`:${v}`,encodeURIComponent(y))}m=As(m);const f={...u};o.forEach(v=>{delete f[v]});const h=new URLSearchParams(Object.entries(f).reduce((v,[y,p])=>({...v,...p?{[y]:p}:null}),{}));return m+si(h)},parse(u){const m=Ic(u);if(a){const b={...la(m.searchParams)};return s?s(b):b}if(!d)return null;const f=As(m.pathname),h=d.exec({pathname:f}),v=la(m.searchParams);if(!h)return null;const y=h.pathname.groups,p={...v};for(const[g,b]of Object.entries(y))b!==void 0&&(p[g]=b);return s?s(p):p},variableCount:c}}class px{status;pendingNavigations;dispatchedEvents;baseNavigationEvents;constructor(s,n=[]){this.status=s.length>0?mt.IDLE:mt.SUCCEEDED,this.pendingNavigations=s.slice(),this.dispatchedEvents=[],this.baseNavigationEvents=n}captureNavigationOpportunity(s){if(wc(this.status))return[];if(s&&s.globalTransitionState!=="idle")return[];if(this.pendingNavigations.length===0)return this.status=mt.SUCCEEDED,[];const n=s?s.events.filter(nx):[];if(!(this.verifyAllDispatchedEventsAreInNavigationHistory(n)&&this.verifyNoUnknownNavigationEvents(n)))return this.pendingNavigations=[],this.status=mt.FAILED,[];const a=this.pendingNavigations.shift();if(!a)return[];const r=a();return this.dispatchedEvents.push(...r),this.status=mt.PROGRESS,r}getStatus(){return this.status}verifyAllDispatchedEventsAreInNavigationHistory(s){const n=new Set(s.map(a=>a.id));return this.dispatchedEvents.every(a=>n.has(a.id))}verifyNoUnknownNavigationEvents(s){const n=new Set([...this.baseNavigationEvents,...this.dispatchedEvents].map(a=>a.id));return s.every(a=>n.has(a.id))}}function hx(t){return typeof t=="string"?{path:t}:t}function xx(t){return(Array.isArray(t)?t:[t]).map(hx)}function gx(t){return Object.keys(t).flatMap(n=>{const a=t[n];return a?xx(a).map(r=>({activityName:n,...r})):[]})}class vx{latestlyBookedSession=Promise.resolve();acquire(){return new Promise(s=>{this.latestlyBookedSession=this.latestlyBookedSession.then(()=>new Promise(n=>s({release:()=>n()})))})}async runExclusively(s){const{release:n}=await this.acquire();try{return await s()}finally{n()}}}class yx{subscribers=[];publishLock=new vx;subscribe(s){return this.subscribers.push(s),()=>{this.subscribers=this.subscribers.filter(n=>n!==s)}}publish(s){const n=this.subscribers.slice();return this.publishLock.runExclusively(()=>Promise.allSettled(n.map(a=>a(s))))}}const bx=l.createContext([]),Va=t=>e.jsx(bx.Provider,{value:t.routes,children:t.children});Va.displayName="RoutesProvider";Va.__docgenInfo={description:"",methods:[],displayName:"RoutesProvider",props:{routes:{required:!0,tsType:{name:"Array",elements:[{name:"ActivityRoute",elements:[{name:"T"}],raw:"ActivityRoute<T>"}],raw:"ActivityRoute<T>[]"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const jx=/^:[\w-]+$/,Nx=3,wx=1,Cx=10,Sx=-2,ni=t=>t==="*";function ai(t){const s=t.split("/");let n=s.length;return s.some(ni)&&(n+=Sx),s.filter(a=>!ni(a)).reduce((a,r)=>a+(jx.test(r)?Nx:r===""?wx:Cx),n)}function kx(t){return[...t].toSorted((s,n)=>ai(n.path)-ai(s.path))}const Ax=1e3,Tx=60*Ax;function Ix(t){"config"in t&&t.config.decorate("historySync",{makeTemplate:Ae,urlPatternOptions:t.urlPatternOptions});const s=t.history??(typeof window>"u"?ex({}):Zh({window})),{location:n}=s,a="routes"in t?t.routes:t.config.activities.reduce((o,c)=>({...o,[c.name]:c.route}),{}),r=kx(gx(a));return()=>{let o=0,c=!1,i=null;const d=[],u=new yx,{requestHistoryTick:m}=fx(s),f=p=>u.subscribe(async()=>p());let h=null;const v=()=>{const p=d.map(g=>({activityId:g.getTargetId(),activationCount:g.getActivationCount()}));return(!h||h.length!==p.length||h.some(({activityId:g,activationCount:b})=>p.some(({activityId:x,activationCount:j})=>x===g&&j!==b)))&&(h=p),h},y=p=>{let g=!1;for(const b of d){const x=b.getActivationCount();b.captureStackChange(p),x!==b.getActivationCount()&&(g=!0)}g&&u.publish()};return{key:"plugin-history-sync",wrapStack({stack:p}){const g=l.useSyncExternalStore(f,v,v);return e.jsx(bc,{requestHistoryTick:m,children:e.jsx(Va,{routes:r,children:e.jsx(tx.Provider,{value:g,children:p.render()})})})},overrideInitialEvents({initialContext:p}){const g=ks(s.location.state);if(g)return[{...g.activity.enteredBy,name:"Pushed"},...g.step?.enteredBy.name==="StepPushed"||g.step?.enteredBy.name==="StepReplaced"?[{...g.step.enteredBy,name:"StepPushed"}]:[]];function b(){return p?.req?.path&&typeof p.req.path=="string"?p.req.path:t.useHash?n.hash.split("#")[1]??"/":n.pathname+n.search}const x=b(),j=t.fallbackActivity({initialContext:p}),N=r.find(k=>Ae(k,t.urlPatternOptions).parse(x)!==null)??r.find(k=>k.activityName===j),S=Ae(N,t.urlPatternOptions).parse(x)??{},C=Object.entries(S).reduce((k,[I,R])=>(typeof R=="string"&&(k[I]=R),k),{}),T=N.defaultHistory?.(C)??[];return i=new px([...T.map(({activityName:k,activityParams:I,additionalSteps:R=[]})=>()=>{const P=[{name:"Pushed",id:$e(),activityId:$e(),activityName:k,activityParams:{...I},activityContext:{path:x,lazyActivityComponentRenderContext:{shouldRenderImmediately:!0}}},...R.map(({stepParams:A,hasZIndex:D})=>({name:"StepPushed",id:$e(),stepId:$e(),stepParams:A,hasZIndex:D}))];for(const A of P)A.name==="Pushed"&&d.push(new ax(A.activityId,i));return P}),()=>[{name:"Pushed",id:$e(),activityId:$e(),activityName:N.activityName,activityParams:Ae(N,t.urlPatternOptions).parse(x)??la(Ic(x).searchParams),activityContext:{path:x,lazyActivityComponentRenderContext:{shouldRenderImmediately:!0}}}]]),i.captureNavigationOpportunity(null).map(k=>({...k,eventDate:Date.now()-Tx}))},onInit({actions:{getStack:p,dispatchEvent:g,push:b,stepPush:x}}){const j=p(),N=j.activities[0],w=r.find(k=>k.activityName===N.name),S=Ae(w,t.urlPatternOptions),C=ti(N.steps);m(()=>{c=!0,Un({history:s,pathname:S.fill(N.params),state:{activity:N,step:C},useHash:t.useHash})});const T=k=>{if(c){c=!1;return}const I=ks(k.location.state);if(!I)return;const R=I.activity,P=I.activity.id,A=I.step,{activities:D}=p(),_=D.find(G=>G.isActive);if(!_)return;const B=ti(_.steps),E=D.find(G=>G.id===P),z=_.steps.find(G=>G.id===A?.id),O=()=>_.id>P,H=()=>_.id<P,te=()=>_.id===P,Q=()=>te()?!!(!A||B&&B.id>A.id):!1,V=()=>te()?!!(!B||A&&B.id<A.id):!1;if(O()&&(g("Popped",{}),!E&&(o+=1,b({...R.enteredBy}),A?.enteredBy.name==="StepPushed"||A?.enteredBy.name==="StepReplaced"))){const{enteredBy:G}=A;o+=1,x({...G})}if(Q()){if(!z&&A&&(A?.enteredBy.name==="StepPushed"||A?.enteredBy.name==="StepReplaced")){const{enteredBy:G}=A;o+=1,x({...G})}g("StepPopped",{})}if(H()&&(o+=1,b({activityId:R.id,activityName:R.name,activityParams:R.params})),V()){if(!A)return;o+=1,x({stepId:A.id,stepParams:A.params})}};s.listen(T),i?.captureNavigationOpportunity(j).forEach(k=>k.name==="Pushed"?b(k):x(k)),y(j)},onPushed({effect:{activity:p}}){if(o){o-=1;return}const g=r.find(x=>x.activityName===p.name),b=Ae(g,t.urlPatternOptions);m(()=>{c=!0,ei({history:s,pathname:b.fill(p.params),state:{activity:p},useHash:t.useHash})})},onStepPushed({effect:{activity:p,step:g}}){if(o){o-=1;return}const b=r.find(j=>j.activityName===p.name),x=Ae(b,t.urlPatternOptions);m(()=>{c=!0,ei({history:s,pathname:x.fill(p.params),state:{activity:p,step:g},useHash:t.useHash})})},onReplaced({effect:{activity:p}}){if(!p.isActive)return;const g=r.find(x=>x.activityName===p.name),b=Ae(g,t.urlPatternOptions);m(()=>{c=!0,Un({history:s,pathname:b.fill(p.params),state:{activity:p},useHash:t.useHash})})},onStepReplaced({effect:{activity:p,step:g}}){if(!p.isActive)return;const b=r.find(j=>j.activityName===p.name),x=Ae(b,t.urlPatternOptions);m(()=>{c=!0,Un({history:s,pathname:x.fill(p.params),state:{activity:p,step:g},useHash:t.useHash})})},onBeforePush({actionParams:p,actions:{overrideActionParams:g}}){if(!p.activityContext||!("path"in p.activityContext)){const b=r.find(N=>N.activityName===p.activityName),j=Ae(b,t.urlPatternOptions).fill(p.activityParams);g({...p,activityContext:{...p.activityContext,path:j}})}},onBeforeReplace({actionParams:p,actions:{overrideActionParams:g,getStack:b}}){if(!p.activityContext||!("path"in p.activityContext)){const w=r.find(T=>T.activityName===p.activityName),C=Ae(w,t.urlPatternOptions).fill(p.activityParams);g({...p,activityContext:{...p.activityContext,path:C}})}const{activities:x}=b(),j=x.filter(w=>w.transitionState==="enter-active"||w.transitionState==="enter-done"),N=j.length>0?j[j.length-1]:null;if(N)for(let w=0;w<N.steps.length-1;w+=1)m(S=>{ks(s.location.state)?S():(c=!0,s.back())}),m(()=>{c=!0,s.back()})},onBeforeStepPop({actions:{getStack:p}}){const{activities:g}=p();(g.find(x=>x.isActive)?.steps.length??0)>1&&m(()=>{c=!0,s.back()})},onBeforePop({actions:{getStack:p}}){const{activities:g}=p(),b=g.find(x=>x.isActive);if(b){const{isRoot:x,steps:j}=b,N=x?0:j.length;for(let w=0;w<N;w+=1)m(S=>{ks(s.location.state)?S():(c=!0,s.back())}),m(()=>{c=!0,s.back()})}},onChanged({actions:{getStack:p,push:g,stepPush:b}}){const x=p();i?.captureNavigationOpportunity(x).forEach(j=>j.name==="Pushed"?g(j):b(j)),y(x)}}}}function Pc(){const{t}=L(["settings","common"]),[s,n]=l.useState(!1),a=()=>{n(!0);const r="./";window.location.href=`${r}clear.html`};return e.jsx("div",{className:"flex min-h-screen flex-col items-center justify-center bg-background p-6",children:e.jsxs("div",{className:"flex flex-col items-center gap-6 text-center max-w-sm",children:[e.jsx("div",{className:"bg-destructive/10 flex size-20 items-center justify-center rounded-full",children:e.jsx(Se,{className:"text-destructive size-10"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-xl font-bold",children:t("settings:storage.migrationRequired","")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:t("settings:storage.migrationDesc","")})]}),e.jsx("div",{className:"bg-destructive/5 rounded-lg p-4 w-full",children:e.jsxs("ul",{className:"text-destructive space-y-2 text-sm text-left",children:[e.jsxs("li",{children:[" ",t("settings:clearData.item1","")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item2","")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item3","")]})]})}),e.jsxs(q,{variant:"destructive",onClick:a,className:"w-full gap-2",disabled:s,children:[e.jsx(Tt,{className:"size-4"}),t("settings:clearData.confirm","")]})]})})}Pc.__docgenInfo={description:`


 Stackflow context  useFlow()`,methods:[],displayName:"MigrationRequiredView"};const ri={ethereum:"Ethereum",bitcoin:"Bitcoin",tron:"Tron",binance:"BSC",bfmeta:"BFMeta",ccchain:"CCChain",pmchain:"PMChain",bfchainv2:"BFChain V2",btgmeta:"BTGMeta",biwmeta:"BIWMeta",ethmeta:"ETHMeta",malibu:"Malibu"};function Ec(){const{push:t}=K(),s=Ta(),n=at(),a=An(),{t:r}=L(["home","wallet","common","transaction"]),o=ki(),c=jo(),i=bo(),d=Pt(),u=be(),m=u?.id??null,f=Le(),h=vo(),v=ri[f]??f,y=kn(),p=st(),b=(p.snapshot?Ge.getChainById(p,f):null)?.symbol;Mi();const{data:x,isFetching:j}=gf(u?.id,f),{transactions:N,isLoading:w,setFilter:S}=Aa(u?.id);l.useEffect(()=>{S(E=>({...E,chain:f}))},[f,S]);const C=l.useCallback(async E=>{await s.write({text:E}),await a.impact("light"),n.show(r("home:wallet.addressCopied"))},[s,a,n,r]),T=l.useCallback(E=>{E!==m&&de.setCurrentWallet(E),t("ChainSelectorJob",{})},[t,m]),k=l.useCallback(E=>{const z=d.find(O=>O.id===E);z&&t("WalletConfigActivity",{walletId:E,walletName:z.name})},[t,d]),I=l.useCallback(E=>{de.setCurrentWallet(E)},[]),R=l.useCallback(()=>{t("WalletAddJob",{})},[t]),P=l.useCallback(()=>{t("WalletListJob",{})},[t]),A=l.useCallback(()=>{t("AddressBalanceActivity",{})},[t]),D=l.useCallback(()=>{t("AddressTransactionsActivity",{})},[t]),_=l.useCallback(E=>{E.id&&t("TransactionDetailActivity",{txId:E.id})},[t]),B=l.useCallback((E,z)=>[{label:r("home:wallet.transfer"),icon:e.jsx(lo,{className:"size-4"}),onClick:()=>{a.impact("light"),t("SendActivity",{assetType:E.symbol})}},{label:r("home:wallet.destroy"),icon:e.jsx(Hs,{className:"size-4"}),onClick:()=>{a.impact("light"),t("DestroyActivity",{assetType:E.symbol,assetLocked:"true"})},variant:"destructive",show:z.canDestroy}],[a,t,r]);return o?e.jsx(Pc,{}):c?!i||!u?e.jsx(Px,{}):e.jsxs("div",{"data-testid":"wallet-home",className:"flex h-full flex-col overflow-y-auto bg-background",children:[e.jsxs("div",{className:"pt-2 pb-1",children:[e.jsx(eu,{wallets:d,currentWalletId:m,selectedChain:f,chainPreferences:h,chainNames:ri,onWalletChange:I,onCopyAddress:C,onOpenChainSelector:T,onOpenSettings:k,onOpenWalletList:P,onAddWallet:R,onOpenAddressBalance:A,onOpenAddressTransactions:D}),e.jsxs("div",{className:"mt-2 flex justify-center gap-8 px-6",children:[e.jsxs("button",{onClick:()=>t("SendActivity",{}),"data-testid":"wallet-home-send-button",className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:e.jsx(xo,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:r("home:wallet.send")})]}),e.jsxs("button",{onClick:()=>t("ReceiveActivity",{}),"data-testid":"wallet-home-receive-button",className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:e.jsx(of,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:r("home:wallet.receive")})]}),e.jsxs("button",{onClick:()=>t("ScannerActivity",{}),"data-testid":"wallet-home-scan-button",className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:e.jsx(ju,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:r("common:a11y.scan")})]})]})]}),e.jsx("div",{className:"flex-1 pt-3",children:e.jsx(ru,{chainId:f,chainName:v,tokens:y.map(E=>({symbol:E.symbol,name:E.name,chain:f,balance:E.balance,decimals:E.decimals,fiatValue:E.fiatValue?String(E.fiatValue):void 0,change24h:E.change24h,icon:E.icon})),transactions:N.slice(0,5),tokensRefreshing:j,transactionsLoading:w,tokensSupported:x?.supported??!0,tokensFallbackReason:x?.fallbackReason,onTokenClick:E=>{console.log("Token clicked:",E.symbol)},onTransactionClick:_,mainAssetSymbol:b,tokenMenuItems:B,renderTransactionFooter:()=>e.jsx("button",{onClick:()=>t("HistoryActivity",{chain:N.length>0?f:"all"}),className:"mt-3 w-full rounded-lg bg-muted/60 py-2.5 text-sm font-medium text-muted-foreground transition-colors hover:bg-muted",children:N.length>0?r("transaction:history.viewAll",{count:N.length}):r("transaction:history.viewAllChains")}),testId:"wallet-home"})}),e.jsx("div",{className:"shrink-0 h-[var(--tab-bar-height)]"})]}):e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(ye,{size:"lg"})})}function Px(){const{push:t}=K(),{t:s}=L("home");return e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-6 p-6 text-center",children:[e.jsx("div",{className:"bg-primary/10 rounded-full p-6",children:e.jsx(nt,{className:"text-primary size-12"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:s("welcome.title")}),e.jsx("p",{className:"text-muted-foreground mt-2",children:s("welcome.subtitle")})]}),e.jsxs("div",{className:"flex w-full max-w-xs flex-col gap-3",children:[e.jsx(Ee,{variant:"mint",className:"w-full","data-testid":"create-wallet-button",onClick:()=>t("WalletCreateActivity",{}),children:s("welcome.createWallet")}),e.jsx(q,{variant:"outline",className:"w-full","data-testid":"import-wallet-button",onClick:()=>t("OnboardingRecoverActivity",{}),children:s("welcome.importWallet")})]})]})}Ec.__docgenInfo={description:"",methods:[],displayName:"WalletTab"};const Ex=va(["defi","nft","tools","games","social","exchange","other"]),_x=ya([qe(!0),$t({timeout:St().int().positive().optional()}).passthrough()]),Mx=va(["auto","dark","light"]),Rx=va(["stack","mine"]),_c=$t({id:$(),name:$(),description:$(),longDescription:$().optional(),icon:$(),url:$(),version:$(),author:$().optional(),website:$().optional(),category:Ex.optional(),tags:He($()).optional(),permissions:He($()).optional(),chains:He($()).optional(),screenshots:He($()).optional(),minWalletVersion:$().optional(),publishedAt:$().optional(),updatedAt:$().optional(),beta:Je().optional(),officialScore:St().min(0).max(100).optional(),communityScore:St().min(0).max(100).optional(),splashScreen:_x.optional(),capsuleTheme:Mx.optional(),targetDesktop:Rx.optional(),themeColor:$().optional(),themeColorFrom:$().optional(),themeColorTo:$().optional()}).passthrough(),Mc=$t({name:$(),version:$(),updated:$(),icon:$().optional(),search:$t({urlTemplate:$()}).passthrough().optional(),apps:He(_c)}).passthrough();$t({version:$(),data:He(_c)}).passthrough();const Dx="bfm_ecosystem",zx=1,Jt="ecosystem_source_payloads",Bx=$t({url:$(),etag:$().optional(),lastUpdated:$(),payload:Mc});let Ts=null,Zt=null;function Lx(){if(typeof indexedDB>"u")throw new Error("indexedDB is not available in this environment")}function Ox(t){return new Promise((s,n)=>{t.onsuccess=()=>s(t.result),t.onerror=()=>n(t.error??new Error("IndexedDB request failed"))})}function Rc(t){return new Promise((s,n)=>{t.oncomplete=()=>s(),t.onerror=()=>n(t.error??new Error("IndexedDB transaction failed")),t.onabort=()=>n(t.error??new Error("IndexedDB transaction aborted"))})}async function Dc(){if(Lx(),Ts)return Ts;if(Zt)return Zt;Zt=new Promise((t,s)=>{const n=indexedDB.open(Dx,zx);n.onupgradeneeded=()=>{const a=n.result;a.objectStoreNames.contains(Jt)||a.createObjectStore(Jt,{keyPath:"url"})},n.onsuccess=()=>t(n.result),n.onerror=()=>s(n.error??new Error("Failed to open IndexedDB"))});try{return Ts=await Zt,Ts}finally{Zt=null}}async function Fx(t){const n=(await Dc()).transaction([Jt],"readwrite");n.objectStore(Jt).put(t),await Rc(n)}async function zc(t){const n=(await Dc()).transaction([Jt],"readonly"),a=n.objectStore(Jt),r=await Ox(a.get(t));if(await Rc(n),r===void 0)return null;const o=Bx.safeParse(r);return o.success?o.data:(console.warn("[EcosystemStorage] Invalid source payload record:",o.error.issues[0]),null)}const Wx=15,$x=1440*60*1e3;function qx(t){return Math.floor(t.getTime()/$x)}function Hx(t=new Date){const s=qx(t);return Wx*(s+1)%100}function ii(t,s=new Date){const n=typeof t.officialScore=="number"?t.officialScore:0,a=typeof t.communityScore=="number"?t.communityScore:0,r=Hx(s),o=100-r;return(n*r+a*o)/100}function Ux(t){const s=typeof document<"u"?document.baseURI:"file:///",n=new URL(t,s).toString();return a=>a.startsWith("http://")||a.startsWith("https://")||a.startsWith("data:")?a:new URL(a,n).toString()}const Jx=1e4;let jt=[];const Fs=[];function Bc(){const t=[...jt];Fs.forEach(s=>s(t))}function Vx(t){return Fs.push(t),()=>{const s=Fs.indexOf(t);s>=0&&Fs.splice(s,1)}}function Kx(t){return/^[a-z0-9]+(?:\.[a-z0-9-]+)+$/i.test(t)}function Lc(t,s,n){if(!Kx(t.id))return console.warn(`[Registry] Invalid appId "${t.id}" from source "${s.url}", skipping`),null;const a=Ux(s.url);return{...t,icon:a(t.icon),url:a(t.url),screenshots:t.screenshots?.map(a),splashScreen:t.splashScreen,sourceUrl:s.url,sourceName:s.name,sourceIcon:s.icon??(n.icon?a(n.icon):void 0)}}function Gx(t,s,n=Jx){const a=new AbortController,r=setTimeout(()=>a.abort(),n);return fetch(t,{...s,signal:a.signal}).finally(()=>clearTimeout(r))}async function Qx(t,s){const n=await zc(t),a=s?void 0:n?.etag;try{const r=await Gx(t,{method:"GET",headers:{Accept:"application/json",...a!==void 0?{"If-None-Match":a}:{}}});if(r.status===304)return n?.payload??null;if(!r.ok)return console.warn(`[Registry] Failed to fetch source: ${t}`,r.status,r.statusText),n?.payload??null;const o=await r.json(),c=Mc.safeParse(o);if(!c.success)return console.warn(`[Registry] Invalid source JSON: ${t}`,c.error),n?.payload??null;const i=c.data,d=r.headers.get("ETag")??void 0;return await Fx({url:t,payload:i,...d!==void 0?{etag:d}:{},lastUpdated:new Date().toISOString()}),i}catch(r){const o=r instanceof Error&&r.name==="AbortError"?"request timeout":r instanceof Error?r.message:String(r);return console.warn(`[Registry] Error fetching source: ${t}`,o),n?.payload??null}}async function Oc(){const t=ga.getEnabledSources(Ct.state),s=await Promise.all(t.map(async r=>{const o=await zc(r.url);return{source:r,cached:o}})),n=[],a=new Set;for(const{source:r,cached:o}of s){const c=o?.payload;if(c)for(const i of c.apps??[]){const d=Lc(i,r,c);if(d){if(a.has(d.id)){console.warn(`[Registry] Duplicate appId "${d.id}" detected, skipping later entry`);continue}a.add(d.id),n.push(d)}}}jt=n,Bc()}let oi="";Ct.subscribe(()=>{const t=JSON.stringify(Ct.state.sources);t!==oi&&(oi=t,Oc())});async function Fc(t){await Oc(),t?.refresh===!0&&Ka({force:!1})}async function Ka(t){const s=t?.force===!0,n=ga.getEnabledSources(Ct.state),a=await Promise.all(n.map(async c=>{const i=await Qx(c.url,s);return i&&Ie.updateSourceTimestamp(c.url),{source:c,payload:i}})),r=[],o=new Set;for(const{source:c,payload:i}of a)if(i)for(const d of i.apps??[]){const u=Lc(d,c,i);if(u){if(o.has(u.id)){console.warn(`[Registry] Duplicate appId "${u.id}" detected, skipping later entry`);continue}o.add(u.id),r.push(u)}}return jt=r,Bc(),console.log(`[Registry] Loaded ${jt.length} apps from ${n.length} sources`),[...jt]}function Yx(){return[...jt]}function ci(t){return jt.find(s=>s.id===t)}function Wc(){const{push:t}=K(),s=l.useRef(null),[n,a]=l.useState([]),[r,o]=l.useState(!0),c=le(Ct,y=>y.myApps);l.useEffect(()=>{const y=Vx(p=>a(p));return Fc({refresh:!0}).then(()=>{a(Yx()),o(!1)}),()=>y()},[]),ku();const i=l.useCallback(y=>{t("MiniappDetailActivity",{appId:encodeURIComponent(y.id)})},[t]),d=l.useCallback(y=>{Ie.installApp(y.id),Ie.updateAppLastUsed(y.id),Ie.setActiveSubPage("mine"),s.current?.slideTo("mine"),requestAnimationFrame(()=>{qi(y.id,{...y,targetDesktop:"mine"})})},[]),u=l.useCallback(y=>{Ie.uninstallApp(y)},[]),m=l.useMemo(()=>c.map(y=>({...y,app:n.find(p=>p.id===y.appId)})).filter(y=>!!y.app).map(({app:y,lastUsedAt:p})=>({app:y,lastUsed:p})),[c,n]),f=l.useMemo(()=>n.length===0?[]:[...n].toSorted((y,p)=>ii(p)-ii(y)).slice(0,2),[n]),h=l.useMemo(()=>{const y=new Set(f.map(p=>p.id));return[...n].filter(p=>!y.has(p.id)).toSorted((p,g)=>(g.officialScore??0)-(p.officialScore??0)).slice(0,6)},[n,f]),v=l.useMemo(()=>[...n].toSorted((y,p)=>(p.communityScore??0)-(y.communityScore??0)).slice(0,10),[n]);return r?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(ye,{size:"lg"})}):e.jsx(Mu,{ref:s,showDiscoverPage:!0,showStackPage:"auto",apps:n,myApps:m,featuredApps:f,recommendedApps:h,hotApps:v,onAppOpen:d,onAppDetail:i,onAppRemove:u})}Wc.__docgenInfo={description:"",methods:[],displayName:"EcosystemTab"};function ve({icon:t,label:s,value:n,showChevron:a=!0,disabled:r=!1,onClick:o,trailing:c,className:i,testId:d}){const u=o?"button":"div";return e.jsxs(u,{type:o?"button":void 0,onClick:r?void 0:o,disabled:r,"data-testid":d,className:M("bg-background flex w-full items-center gap-3 rounded-xl px-4 py-3.5","transition-colors",o&&!r&&"hover:bg-muted/50 active:bg-muted",r&&"cursor-not-allowed",i),children:[t&&e.jsx("span",{className:"bg-muted text-foreground flex size-8 shrink-0 items-center justify-center rounded-lg",children:t}),e.jsx("span",{className:M("flex-1 text-left text-sm font-medium",r&&"text-muted-foreground"),children:s}),c??e.jsxs(e.Fragment,{children:[n&&e.jsx("span",{className:"text-muted-foreground text-sm",children:n}),a&&o&&e.jsx(Ce,{className:"text-muted-foreground/50 size-5"})]})]})}ve.__docgenInfo={description:"",methods:[],displayName:"SettingsItem",props:{icon:{required:!1,tsType:{name:"union",raw:"ReactNode | undefined",elements:[{name:"ReactNode"},{name:"undefined"}]},description:""},label:{required:!0,tsType:{name:"string"},description:""},value:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},showChevron:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"",defaultValue:{value:"true",computed:!1}},disabled:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"",defaultValue:{value:"false",computed:!1}},onClick:{required:!1,tsType:{name:"union",raw:"(() => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},trailing:{required:!1,tsType:{name:"union",raw:"ReactNode | undefined",elements:[{name:"ReactNode"},{name:"undefined"}]},description:""},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:" className"},testId:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:" ID"}}};function ss({title:t,children:s,className:n}){return e.jsxs("section",{className:M("space-y-1",n),children:[t&&e.jsx("h3",{className:"mb-2 px-1 text-xs font-medium uppercase text-muted-foreground",children:t}),e.jsx("div",{className:"overflow-hidden rounded-xl bg-card shadow-sm",children:s})]})}ss.__docgenInfo={description:"",methods:[],displayName:"SettingsSection",props:{title:{required:!1,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},className:{required:!1,tsType:{name:"string"},description:" className"}}};const Xx=[{value:"system",icon:Hm},{value:"light",icon:ff},{value:"dark",icon:Xm}];function $c({open:t,onOpenChange:s}){const{t:n}=L("settings"),a=pa(),r=o=>{fs.setTheme(o),s(!1)};return e.jsx(xt,{open:t,onOpenChange:s,children:e.jsxs(gt,{side:"bottom",className:"rounded-t-2xl",children:[e.jsx(vt,{children:e.jsx(yt,{children:n("appearance.title")})}),e.jsx("div",{className:"mt-4 space-y-2",children:Xx.map(({value:o,icon:c})=>e.jsxs("button",{onClick:()=>r(o),className:M("flex w-full items-center gap-3 rounded-xl p-4 transition-colors",a===o?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx(c,{size:24}),e.jsx("span",{className:"flex-1 text-left font-medium",children:n(`appearance.${o}`)}),a===o&&e.jsx(fe,{size:20})]},o))})]})})}$c.__docgenInfo={description:"",methods:[],displayName:"AppearanceSheet",props:{open:{required:!0,tsType:{name:"boolean"},description:""},onOpenChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(open: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"open"}],return:{name:"void"}}},description:""}}};function Pn(t){return t.apis.find(n=>n.type==="biowallet-v1")?.endpoint??null}async function Zx(t,s){return{amount:(await Uu(t.id).transaction.estimateFee({from:s,to:s,amount:ce.fromRaw("1",t.decimals,t.symbol)})).standard.amount,symbol:t.symbol}}async function li({chainConfig:t,walletId:s,password:n,fromAddress:a,toAddress:r,amount:o,assetType:c,fee:i,twoStepSecret:d}){let u;try{u=await fn.getMnemonic(s,n)}catch(f){return f instanceof pn&&f.code===hn.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:f instanceof Error?f.message:""}}if(!o.isPositive())return{status:"error",message:""};const m=Pn(t);if(!m)return{status:"error",message:"API URL "};try{console.log("[submitBioforestTransfer] Starting transfer:",{apiUrl:m,fromAddress:a,toAddress:r,amount:o.toRawString()});const f=await bn(m,a);if(console.log("[submitBioforestTransfer] Address info:",{hasSecondPubKey:!!f.secondPublicKey}),f.secondPublicKey&&!d)return console.log("[submitBioforestTransfer] Pay password required"),{status:"password_required",secondPublicKey:f.secondPublicKey};if(d&&f.secondPublicKey){console.log("[submitBioforestTransfer] Verifying pay password...");const y=await Oi(t.id,u,d,f.secondPublicKey);if(console.log("[submitBioforestTransfer] Pay password verification result:",y),!y)return{status:"error",message:""}}console.log("[submitBioforestTransfer] Creating transaction...");const h=await mu({baseUrl:m,chainId:t.id,mainSecret:u,paySecret:d,from:a,to:r,amount:o.toRawString(),assetType:c,fee:i?.toRawString()}),v=h.signature;console.log("[submitBioforestTransfer] Transaction created:",v?.slice(0,20)),console.log("[submitBioforestTransfer] Broadcasting...");try{return await Fi(m,h),console.log("[submitBioforestTransfer] SUCCESS! txHash:",v),{status:"ok",txHash:v}}catch(y){if(console.error("[submitBioforestTransfer] Broadcast failed:",y),y instanceof $s)return{status:"error",message:qs(y)};throw y}}catch(f){return console.error("[submitBioforestTransfer] FAILED:",f),f instanceof $s?{status:"error",message:qs(f)}:{status:"error",message:(f instanceof Error?f.message:String(f))||""}}}async function eg({chainConfig:t,walletId:s,password:n,fromAddress:a,newTwoStepSecret:r}){let o;try{o=await fn.getMnemonic(s,n)}catch(i){return i instanceof pn&&i.code===hn.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:i instanceof Error?i.message:""}}const c=Pn(t);if(!c)return{status:"error",message:"API URL "};try{if((await bn(c,a)).secondPublicKey)return{status:"already_set"};console.log("[submitSetTwoStepSecret] Creating signature transaction...");const d=await uu({baseUrl:c,chainId:t.id,mainSecret:o,newPaySecret:r});return console.log("[submitSetTwoStepSecret] Pay password set successfully:",d.txHash),{status:"ok",txHash:d.txHash}}catch(i){console.error("[submitSetTwoStepSecret] Failed to set pay password:",i);const d=i instanceof Error?i.message:String(i);return d.includes("fee")||d.includes("")?{status:"error",message:""}:{status:"error",message:d||""}}}async function tg(t){const s=Pn(t);if(!s)return null;try{const n=await du(s,t.id);return{amount:ce.fromRaw(n,t.decimals,t.symbol),symbol:t.symbol}}catch(n){return console.error("[getSetTwoStepSecretFee] Failed to get fee:",n),null}}async function sg(t,s){const n=Pn(t);if(!n)return!1;try{return!!(await bn(n,s)).secondPublicKey}catch{return!1}}const ae=Wh,qc=Uh;function an({title:t,children:s,className:n}){return e.jsxs("div",{className:M("bg-background rounded-t-2xl",n),children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),t&&e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t})}),s,e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}an.__docgenInfo={description:"Standard sheet content wrapper with handle, title, and safe area",methods:[],displayName:"SheetContent",props:{title:{required:!1,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const ng={ethereum:"Ethereum",bitcoin:"Bitcoin",tron:"Tron",binance:"BSC",bfmeta:"BFMeta",ccchain:"CCChain",pmchain:"PMChain",bfchainv2:"BFChain V2",btgmeta:"BTGMeta",biwmeta:"BIWMeta",ethmeta:"ETHMeta",malibu:"Malibu"};function ag(t,s=10,n=8){return t.length<=s+n+3?t:`${t.slice(0,s)}...${t.slice(-n)}`}const Hc=()=>{const{t}=L(["home","common"]),{pop:s}=K(),n=be(),a=Le(),r=yo(),o=c=>{de.setSelectedChain(c),s()};return e.jsx(ae,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("home:wallet.selectNetwork")})}),e.jsx("div",{"data-testid":"chain-sheet",className:"max-h-[60vh] space-y-2 overflow-y-auto p-4",children:r.map(c=>{const i=n?.chainAddresses.find(d=>d.chain===c);return e.jsxs("button",{"data-testid":`chain-option-${c}`,onClick:()=>o(c),className:`flex w-full items-center gap-3 rounded-xl p-4 transition-colors ${c===a?"bg-primary/10 ring-1 ring-primary":"bg-muted/50 hover:bg-muted"}`,children:[e.jsx(kt,{chain:c,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:ng[c]??c}),e.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:i?.address?ag(i.address):"---"})]}),c===a&&e.jsx(fe,{className:"size-5 text-primary"})]},c)})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};Hc.__docgenInfo={description:"",methods:[],displayName:"ChainSelectorJob"};const di={"/":"MainTabsActivity","/wallet/list":"WalletListActivity","/wallet/create":"WalletCreateActivity","/send":"SendActivity","/receive":"ReceiveActivity","/settings":"SettingsActivity","/settings/language":"SettingsLanguageActivity","/settings/currency":"SettingsCurrencyActivity","/settings/chains":"SettingsChainsActivity","/settings/mnemonic":"SettingsMnemonicActivity","/settings/wallet-lock":"SettingsWalletLockActivity","/settings/wallet-chains":"SettingsWalletChainsActivity","/settings/storage":"SettingsStorageActivity","/history":"HistoryActivity","/scanner":"ScannerActivity","/onboarding/recover":"OnboardingRecoverActivity","/address-book":"AddressBookActivity","/notifications":"NotificationsActivity","/staking":"StakingActivity","/welcome":"WelcomeActivity"},rg=[{pattern:/^\/wallet\/([^/]+)$/,activity:"WalletConfigActivity",paramExtractor:t=>({walletId:t[1]??""})},{pattern:/^\/transaction\/([^/]+)$/,activity:"TransactionDetailActivity",paramExtractor:t=>({txId:t[1]??""})},{pattern:/^\/authorize\/address\/([^/]+)$/,activity:"AuthorizeAddressActivity",paramExtractor:t=>({id:t[1]??""})},{pattern:/^\/authorize\/signature\/([^/]+)$/,activity:"AuthorizeSignatureActivity",paramExtractor:t=>({id:t[1]??""})},{pattern:/^\/token\/([^/]+)$/,activity:"TokenDetailActivity",paramExtractor:t=>({tokenId:t[1]??""})}];function ig(t){if(di[t])return{activity:di[t],params:{}};for(const{pattern:s,activity:n,paramExtractor:a}of rg){const r=t.match(s);if(r)return{activity:n,params:a(r)}}return null}function Z(){const t=K();return{navigate:a=>{const r=typeof a=="string"?{to:a}:a,o=ig(r.to);if(!o){console.warn(`[useNavigation] Unknown route: ${r.to}`);return}const c={...o.params,...r.search};r.replace?t.replace(o.activity,c,{animate:!0}):t.push(o.activity,c,{animate:!0})},goBack:()=>{t.pop()}}}const Uc=l.createContext({});function ee({params:t,children:s}){return e.jsx(Uc.Provider,{value:t,children:s})}function re(){return l.useContext(Uc)}ee.__docgenInfo={description:"",methods:[],displayName:"ActivityParamsProvider",props:{params:{required:!0,tsType:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""}}};function og(){const{t}=L("wallet"),{pop:s}=K(),{walletId:n}=re(),r=Pt().find(u=>u.id===n),[o,c]=l.useState(r?.name??"");l.useEffect(()=>{r&&c(r.name)},[r]);const i=l.useCallback(()=>{if(!r)return;const u=o.trim();u&&(de.updateWalletName(r.id,u),s())},[r,o,s]);if(!r)return null;const d=o.trim().length>0&&o.trim()!==r.name;return e.jsx(ae,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("editSheet.renameTitle")})}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"wallet-name",className:"text-sm font-medium",children:t("editSheet.walletName")}),e.jsx("input",{id:"wallet-name",type:"text",value:o,onChange:u=>c(u.target.value),placeholder:t("editSheet.walletNamePlaceholder"),maxLength:20,className:M("w-full rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")}),e.jsxs("p",{className:"text-right text-xs text-muted-foreground",children:[o.length,"/20"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:i,disabled:!d,className:M("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t("editSheet.save")}),e.jsx("button",{onClick:()=>s(),className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("editSheet.cancel")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Jc=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(og,{})});Jc.__docgenInfo={description:"",methods:[],displayName:"WalletRenameJob"};function cg(){const{t}=L("wallet"),{pop:s}=K(),{navigate:n}=Z(),{walletId:a}=re(),o=Pt().find(v=>v.id===a),[c,i]=l.useState([]),[d,u]=l.useState(!1),[m,f]=l.useState(!1),h=l.useCallback(async v=>{if(!(!o||v.length<4)){if(!o.encryptedMnemonic){de.deleteWallet(o.id),n({to:"/"});return}f(!0),u(!1);try{const y=At(v);if(!await ht(o.encryptedMnemonic,y)){u(!0),i([]);return}de.deleteWallet(o.id),n({to:"/"})}catch{u(!0),i([])}finally{f(!1)}}},[o,n]);return o?e.jsx(ae,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("editSheet.deleteTitle")})}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsx("p",{className:"text-center text-muted-foreground",children:t("editSheet.deleteWarning",{name:o.name})}),e.jsx(Gt,{value:c,onChange:i,onComplete:h,minPoints:4,error:d,disabled:m}),e.jsx("div",{className:"space-y-3",children:e.jsx("button",{onClick:()=>s(),disabled:m,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("editSheet.cancel")})})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}):null}const Vc=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(cg,{})});Vc.__docgenInfo={description:"",methods:[],displayName:"WalletDeleteJob"};let rn=null,Ga=null;function it(t,s){rn=t,Ga=null}function lg(){rn=null,Ga=null}function dg(){const{t}=L("security"),{pop:s}=K(),{title:n,description:a,biometricAvailable:r}=re(),[o,c]=l.useState([]),[i,d]=l.useState(!1),[u,m]=l.useState(!1),f=l.useRef(null),h=l.useRef(null),v=l.useRef(null),y=l.useRef(!1);!y.current&&rn&&(h.current=rn,v.current=Ga,lg(),y.current=!0);const p=n??t("patternLock.unlockTitle"),g=r==="true"&&v.current,b=l.useCallback(()=>{f.current&&(clearTimeout(f.current),f.current=null),d(!1)},[]),x=l.useCallback(w=>{i&&w.length>0&&b(),c(w)},[i,b]),j=l.useCallback(async w=>{const S=h.current;if(!(w.length<4||!S)){m(!0),b();try{const C=At(w);await S(C)?s():(d(!0),c([]),f.current=setTimeout(()=>{d(!1)},1500))}catch{d(!0),c([]),f.current=setTimeout(()=>{d(!1)},1500)}finally{m(!1)}}},[s,b]),N=l.useCallback(async()=>{const w=v.current;if(w){m(!0),b();try{await w()?s():(d(!0),f.current=setTimeout(()=>{d(!1)},1500))}catch{d(!0),f.current=setTimeout(()=>{d(!1)},1500)}finally{m(!1)}}},[s,b]);return e.jsx(ae,{"data-testid":"wallet-lock-dialog",children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsxs("div",{className:"px-4 pb-4 text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:p}),a&&e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:a})]}),e.jsx("div",{className:"px-4 pb-4",children:e.jsx(Gt,{value:o,onChange:x,onComplete:j,minPoints:4,error:i,disabled:u,"data-testid":"wallet-lock-pattern"})}),e.jsxs("div",{className:"space-y-3 px-4 pb-4",children:[g&&e.jsxs("button",{type:"button",onClick:N,disabled:u,className:M("flex w-full items-center justify-center gap-2 rounded-full border border-border py-3 font-medium transition-colors","hover:bg-muted","disabled:cursor-not-allowed disabled:opacity-50"),children:[e.jsx(Vm,{className:"size-5"}),e.jsx("span",{children:t("walletLock.biometric")})]}),e.jsx("button",{type:"button",onClick:()=>s(),disabled:u,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("walletLock.cancel")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Kc=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(dg,{})});Kc.__docgenInfo={description:"",methods:[],displayName:"WalletLockConfirmJob"};let ug=null;function mg(){const{t}=L(["security","transaction","common"]),{pop:s}=K(),{title:n,description:a}=re(),[r,o]=l.useState(""),[c,i]=l.useState(),[d,u]=l.useState(!1),m=l.useRef(null);l.useRef(!1).current;const h=n??t("security:twoStepSecret.confirmTitle"),v=a??t("security:twoStepSecret.confirmDesc"),y=l.useCallback(async g=>{g.preventDefault();const b=m.current;if(!(!r.trim()||!b)){u(!0),i(void 0);try{await b(r)?s():i(t("security:twoStepSecret.notMatch"))}catch{i(t("security:twoStepSecret.notMatch"))}finally{u(!1)}}},[r,s,t]),p=r.trim().length>0&&!d;return e.jsx(ae,{"data-testid":"two-step-secret-dialog",children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(yn,{className:"size-5 text-primary"}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:h})]})}),e.jsxs("form",{onSubmit:y,className:"space-y-6 p-4",children:[e.jsx("p",{className:"text-center text-muted-foreground text-sm",children:v}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Us,{value:r,onChange:g=>o(g.target.value),placeholder:t("security:twoStepSecret.inputPlaceholder"),disabled:d,"aria-describedby":c?"two-step-secret-error":void 0,"data-testid":"two-step-secret-input"}),c&&e.jsxs("div",{id:"two-step-secret-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(It,{className:"size-4"}),e.jsx("span",{children:c})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{type:"submit",disabled:!p,"data-testid":"two-step-secret-confirm-button",className:M("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(d?"security:walletLock.verifying":"common:confirm")}),e.jsx("button",{type:"button",onClick:()=>s(),disabled:d,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("security:walletLock.cancel")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Gc=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(mg,{})});Gc.__docgenInfo={description:"",methods:[],displayName:"TwoStepSecretConfirmJob"};function Qa({status:t,txHash:s,title:n,description:a,errorMessage:r,checkConfirmed:o,onStatusChange:c,onDone:i,onRetry:d,onViewDetails:u,onViewExplorer:m,onShare:f,pollInterval:h=1e4,maxPollAttempts:v=18,children:y}){const{t:p}=L(["transaction","common"]),[g,b]=l.useState(t);l.useEffect(()=>{b(t)},[t]),l.useEffect(()=>{if(g!=="broadcasted"||!o)return;let T=!1,k=0;const I=async()=>{if(!(T||k>=v)){k++,k===1&&(b("confirming"),c?.("confirming"));try{await o()&&!T?(b("confirmed"),c?.("confirmed")):!T&&k<v&&setTimeout(I,h)}catch{!T&&k<v&&setTimeout(I,h)}}},R=setTimeout(I,3e3);return()=>{T=!0,clearTimeout(R)}},[g,o,c,h,v]);const x=()=>{switch(g){case"broadcasting":return n?.broadcasting??p("transaction:txStatus.broadcasting");case"broadcasted":return n?.broadcasted??p("transaction:txStatus.broadcasted");case"confirming":return n?.confirming??p("transaction:txStatus.confirming");case"confirmed":return n?.confirmed??p("transaction:txStatus.confirmed");case"failed":return n?.failed??p("transaction:txStatus.failed")}},j=()=>{if(g==="failed"&&r)return r;switch(g){case"broadcasting":return a?.broadcasting??p("transaction:txStatus.broadcastingDesc");case"broadcasted":return a?.broadcasted??p("transaction:txStatus.broadcastedDesc");case"confirming":return a?.confirming??p("transaction:txStatus.confirmingDesc");case"confirmed":return a?.confirmed??p("transaction:txStatus.confirmedDesc");case"failed":return a?.failed??p("transaction:txStatus.failedDesc")}},N=()=>{switch(g){case"broadcasting":case"confirming":return e.jsx(ke,{className:"size-8 animate-spin"});case"broadcasted":return e.jsx(fe,{className:"size-8"});case"confirmed":return e.jsx(fe,{className:"size-8"});case"failed":return e.jsx(It,{className:"size-8"})}},w=()=>{switch(g){case"broadcasting":case"confirming":return"bg-blue-100 text-blue-600";case"broadcasted":return"bg-blue-100 text-blue-600";case"confirmed":return"bg-green-100 text-green-600";case"failed":return"bg-red-100 text-red-600"}},S=g==="confirmed"||g==="broadcasted"||g==="confirming",C=g==="failed"&&d;return e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 p-8",children:[e.jsx("div",{className:M("flex size-16 items-center justify-center rounded-full",w()),children:N()}),e.jsx("h2",{className:"text-lg font-semibold",children:x()}),e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:j()}),s&&e.jsxs("p",{className:"text-xs text-muted-foreground font-mono truncate max-w-full px-4",children:[s.slice(0,16),"...",s.slice(-16)]}),y,S&&e.jsxs("div",{className:"flex w-full max-w-xs flex-col gap-2",children:[i&&e.jsx("button",{type:"button",onClick:i,"data-testid":"tx-status-done-button",className:M("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90"),children:p("common:done")}),e.jsxs("div",{className:"flex gap-2",children:[u&&e.jsx("button",{type:"button",onClick:u,"data-testid":"tx-status-view-details-button",className:"flex-1 rounded-full border border-border py-2 text-sm font-medium transition-colors hover:bg-muted",children:p("transaction:txStatus.viewDetails")}),m&&e.jsx("button",{type:"button",onClick:m,"data-testid":"tx-status-view-explorer-button",className:"flex-1 rounded-full border border-border py-2 text-sm font-medium transition-colors hover:bg-muted",children:p("transaction:sendResult.viewInBrowser")}),f&&e.jsx("button",{type:"button",onClick:f,"data-testid":"tx-status-share-button",className:"flex-1 rounded-full border border-border py-2 text-sm font-medium transition-colors hover:bg-muted",children:p("common:share")})]})]}),C&&e.jsx("button",{type:"button",onClick:d,"data-testid":"tx-status-retry-button",className:M("w-full max-w-xs rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90"),children:p("common:retry")})]})}Qa.__docgenInfo={description:"",methods:[],displayName:"TxStatusDisplay",props:{status:{required:!0,tsType:{name:"union",raw:'"broadcasting" | "broadcasted" | "confirming" | "confirmed" | "failed"',elements:[{name:"literal",value:'"broadcasting"'},{name:"literal",value:'"broadcasted"'},{name:"literal",value:'"confirming"'},{name:"literal",value:'"confirmed"'},{name:"literal",value:'"failed"'}]},description:""},txHash:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},title:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  broadcasting?: string;
  broadcasted?: string;
  confirming?: string;
  confirmed?: string;
  failed?: string;
}`,signature:{properties:[{key:"broadcasting",value:{name:"string",required:!1}},{key:"broadcasted",value:{name:"string",required:!1}},{key:"confirming",value:{name:"string",required:!1}},{key:"confirmed",value:{name:"string",required:!1}},{key:"failed",value:{name:"string",required:!1}}]}},description:""},description:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  broadcasting?: string;
  broadcasted?: string;
  confirming?: string;
  confirmed?: string;
  failed?: string;
}`,signature:{properties:[{key:"broadcasting",value:{name:"string",required:!1}},{key:"broadcasted",value:{name:"string",required:!1}},{key:"confirming",value:{name:"string",required:!1}},{key:"confirmed",value:{name:"string",required:!1}},{key:"failed",value:{name:"string",required:!1}}]}},description:""},errorMessage:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},checkConfirmed:{required:!1,tsType:{name:"union",raw:"(() => Promise<boolean>) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},onStatusChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(status: TxStatus) => void",signature:{arguments:[{type:{name:"union",raw:'"broadcasting" | "broadcasted" | "confirming" | "confirmed" | "failed"',elements:[{name:"literal",value:'"broadcasting"'},{name:"literal",value:'"broadcasted"'},{name:"literal",value:'"confirming"'},{name:"literal",value:'"confirmed"'},{name:"literal",value:'"failed"'}]},name:"status"}],return:{name:"void"}}},description:""},onDone:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onRetry:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onViewDetails:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onViewExplorer:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onShare:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},pollInterval:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"10000",computed:!1}},maxPollAttempts:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"18",computed:!1}},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};let rs=null,on=null;function Qc(t,s){rs=t,on=s}function ui(){rs=null,on=null}function fg(){const{t}=L(["transaction","common"]),{pop:s}=K();re();const n=l.useRef(rs),a=l.useRef(on),r=l.useRef(!1);!r.current&&rs&&(n.current=rs,a.current=on,ui(),r.current=!0);const o=n.current,[c,i]=l.useState(o?.currentFee??""),[d,u]=l.useState();l.useEffect(()=>()=>{ui()},[]);const m=l.useCallback(b=>{if(!o)return;const x=parseFloat(b),j=parseFloat(o.minFee);if(isNaN(x)||x<=0)return t("transaction:feeEdit.invalidFee");if(x<j)return t("transaction:feeEdit.belowMinFee",{minFee:o.minFee,symbol:o.symbol})},[o,t]),f=l.useCallback(b=>{const x=b.target.value;(x===""||/^\d*\.?\d*$/.test(x))&&(i(x),u(void 0))},[]),h=l.useCallback(b=>{i(b),u(void 0)},[]),v=l.useCallback(b=>{b.preventDefault();const x=m(c);if(x){u(x);return}a.current?.({fee:c}),s()},[c,m,s]),y=l.useCallback(()=>{s()},[s]);if(!o)return null;const p=[{label:t("transaction:feeEdit.presetMin"),value:o.minFee}],g=o.presets??p;return e.jsx(qc,{children:e.jsxs("div",{className:"bg-background rounded-2xl p-4","data-testid":"fee-edit-modal",children:[e.jsx("h2",{className:"mb-4 text-center text-lg font-semibold",children:t("transaction:feeEdit.title")}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 text-sm text-muted-foreground",children:[e.jsxs("p",{children:[t("transaction:feeEdit.currentFee"),": ",o.currentFee," ",o.symbol]}),e.jsxs("p",{children:[t("transaction:feeEdit.minFee"),": ",o.minFee," ",o.symbol]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:g.map(b=>e.jsx("button",{type:"button",onClick:()=>h(b.value),className:M("rounded-full px-3 py-1 text-sm transition-colors",c===b.value?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:b.label},b.value))}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("transaction:feeEdit.customFee")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pe,{type:"text",inputMode:"decimal",value:c,onChange:f,placeholder:o.minFee,className:M(d&&"border-destructive"),"data-testid":"fee-input"}),e.jsx("span",{className:"shrink-0 text-sm text-muted-foreground",children:o.symbol})]}),d&&e.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(It,{className:"size-4"}),e.jsx("span",{children:d})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(q,{type:"button",variant:"outline",onClick:y,className:"flex-1",children:t("common:cancel")}),e.jsx(q,{type:"submit",className:"flex-1",disabled:!c,children:t("common:confirm")})]})]})]})})}const Yc=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(fg,{})});Yc.__docgenInfo={description:"",methods:[],displayName:"FeeEditJob"};let is=null,cn=null,ln=null,dn="";function pg(t,s,n){is=t,cn=n??null,s&&(ln=s.amount,dn=s.symbol)}function hg(){is=null,cn=null,ln=null,dn=""}function xg(){const{t}=L(["security","transaction","common"]),{pop:s,push:n}=K(),{chainId:a,chainIcon:r,chainSymbol:o,address:c,chainName:i}=re(),[d,u]=l.useState(""),[m,f]=l.useState(""),[h,v]=l.useState([]),[y,p]=l.useState(!1),[g,b]=l.useState("input"),[x,j]=l.useState(),[N,w]=l.useState(!1),[S,C]=l.useState("idle"),[T,k]=l.useState(),[I,R]=l.useState(null),P=l.useRef(is),A=l.useRef(cn),D=l.useRef({amount:ln,symbol:dn}),_=I??D.current.amount?.toDisplayString()??"0";l.useEffect(()=>(is&&!P.current&&(P.current=is,A.current=cn,D.current={amount:ln,symbol:dn}),()=>{hg()}),[]);const B=l.useCallback(()=>{const O=D.current.amount?.toDisplayString()??"0";Qc({currentFee:_,minFee:O,symbol:D.current.symbol},H=>{R(H.fee)}),n("FeeEditJob",{})},[_,n]),E=l.useCallback(()=>{if(j(void 0),g==="input"){if(!d.trim())return;b("confirm")}else if(g==="confirm"){if(d!==m){j(t("security:twoStepSecret.notMatch"));return}b("walletLock")}},[g,d,m,t]),z=l.useCallback(async O=>{const H=P.current;if(O.length<4||!H)return;w(!0),C("broadcasting"),j(void 0),p(!1);const te=At(O);try{const Q=await H(d,te);Q.success?(k(Q.txHash),C("broadcasted")):(C("idle"),p(!0),v([]),j(Q.error??t("security:twoStepSecret.setFailed")))}catch{C("idle"),p(!0),v([]),j(t("security:twoStepSecret.setFailed"))}finally{w(!1)}},[d,t]);return S!=="idle"?e.jsx(ae,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx(Qa,{status:S,txHash:T,title:{confirmed:t("security:twoStepSecret.txConfirmed")},description:{confirmed:t("security:twoStepSecret.setSuccessDesc")},checkConfirmed:A.current??void 0,onStatusChange:C,onDone:()=>s()}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}):e.jsx(ae,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl","data-testid":"set-two-step-secret-dialog",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsxs("div",{className:"border-b border-border px-4 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(yn,{className:"size-5 text-primary"}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("security:twoStepSecret.setTitle")})]}),a&&c?e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(iu,{chainId:a,chainIcon:r,chainSymbol:o,address:c,size:"sm"})}):i?e.jsx("p",{className:"mt-1 text-center text-sm text-muted-foreground",children:i}):null]}),e.jsxs("div",{className:"space-y-6 p-4",children:[D.current.amount&&e.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-muted/50 p-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:t("security:twoStepSecret.feeInfo")}),e.jsx(ba,{amount:_,symbol:D.current.symbol,editable:!0,onEdit:B})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:M("size-2 rounded-full",g==="input"?"bg-primary":"bg-muted")}),e.jsx("div",{className:M("size-2 rounded-full",g==="confirm"?"bg-primary":"bg-muted")}),e.jsx("div",{className:M("size-2 rounded-full",g==="walletLock"?"bg-primary":"bg-muted")})]}),g==="input"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:t("security:twoStepSecret.inputDesc")}),e.jsx(Us,{value:d,onChange:O=>u(O.target.value),placeholder:t("security:twoStepSecret.inputPlaceholder"),"aria-describedby":x?"two-step-secret-error":void 0,"data-testid":"new-two-step-secret-input"})]}),g==="confirm"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:t("security:twoStepSecret.confirmDesc")}),e.jsx(Us,{value:m,onChange:O=>f(O.target.value),placeholder:t("security:twoStepSecret.confirmPlaceholder"),"aria-describedby":x?"two-step-secret-error":void 0,"data-testid":"confirm-two-step-secret-input"})]}),g==="walletLock"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:t("security:twoStepSecret.walletLockDesc")}),e.jsx(Gt,{value:h,onChange:v,onComplete:z,minPoints:4,error:y,disabled:N,"data-testid":"wallet-lock-pattern"})]}),x&&e.jsxs("div",{id:"two-step-secret-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(It,{className:"size-4"}),e.jsx("span",{children:x})]}),e.jsxs("div",{className:"space-y-3",children:[g!=="walletLock"&&e.jsx("button",{type:"button",onClick:E,"data-testid":"set-two-step-secret-next-button",className:M("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90"),children:t("common:next")}),e.jsx("button",{type:"button",onClick:()=>{g==="input"?s():g==="confirm"?(b("input"),j(void 0)):(b("confirm"),j(void 0),p(!1),v([]))},disabled:N,"data-testid":"set-two-step-secret-cancel-button",className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t(g==="input"?"common:cancel":"common:back")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Xc=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(xg,{})});Xc.__docgenInfo={description:"",methods:[],displayName:"SetTwoStepSecretJob"};let da=null;function gg(){da=null}const vg=[{value:"english",label:"English"},{value:"zh-Hans",label:""},{value:"zh-Hant",label:""}],yg=[12,15,18,21,24,36];function bg(){const{t}=L("onboarding"),{pop:s}=K(),{language:n,length:a}=re(),[r,o]=l.useState({language:n||"english",length:Number(a)||12}),c=u=>{o(m=>({...m,language:u}))},i=u=>{o(m=>({...m,length:u}))},d=()=>{da&&da(r),gg(),s()};return e.jsx(ae,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("create.mnemonicOptions.title")})}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:t("create.mnemonicOptions.language")}),e.jsx("div",{className:"space-y-1",role:"radiogroup",children:vg.map(u=>e.jsxs("button",{type:"button",role:"radio","aria-checked":r.language===u.value,onClick:()=>c(u.value),className:M("flex w-full items-center justify-between rounded-lg px-4 py-3","transition-colors hover:bg-muted/50",r.language===u.value&&"bg-muted"),children:[e.jsx("span",{className:"text-sm",children:u.label}),r.language===u.value&&e.jsx(fe,{className:"size-5 text-primary"})]},u.value))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:t("create.mnemonicOptions.wordCount")}),e.jsx("div",{className:"grid grid-cols-3 gap-2",role:"radiogroup",children:yg.map(u=>e.jsxs("button",{type:"button",role:"radio","aria-checked":r.length===u,onClick:()=>i(u),className:M("flex items-center justify-center rounded-lg py-3 text-sm font-medium","transition-colors",r.length===u?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:[u," ",t("create.mnemonicOptions.words")]},u))})]}),e.jsx("button",{type:"button",onClick:d,className:M("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90"),children:t("create.mnemonicOptions.confirm")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Zc=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(bg,{})});Zc.__docgenInfo={description:"",methods:[],displayName:"MnemonicOptionsJob"};const Jn=3,jg=10;function Ng(){const{t}=L("common"),{pop:s}=K(),{contactId:n}=re(),a=le(Ft,I=>I.contacts),r=n?a.find(I=>I.id===n):null,[o,c]=l.useState(""),[i,d]=l.useState([{id:crypto.randomUUID(),label:"",address:""}]),[u,m]=l.useState(""),[f,h]=l.useState(()=>Math.floor(Math.random()*1e4)),[v,y]=l.useState(!1),p=!!r;l.useEffect(()=>{r&&(c(r.name),d(r.addresses.length>0?r.addresses.map(I=>({id:I.id,label:I.label||"",address:I.address})):[{id:crypto.randomUUID(),label:"",address:""}]),m(r.memo??""),y(!1))},[r]);const g=l.useCallback(()=>{h(Math.floor(Math.random()*1e4)),y(!0)},[]),b=i.find(I=>I.address.trim())?.address.trim(),x=!p||v?b?bt(b,f):void 0:r?.avatar||(b?bt(b,f):void 0),j=l.useCallback(()=>{i.length>=Jn||d(I=>[...I,{id:crypto.randomUUID(),label:"",address:""}])},[i.length]),N=l.useCallback(I=>{d(R=>R.length<=1?R:R.filter(P=>P.id!==I))},[]),w=l.useCallback((I,R,P)=>{d(A=>A.map(D=>D.id===I?{...D,[R]:P}:D))},[]),S=l.useCallback(()=>{const I=o.trim(),R=u.trim(),P=i.filter(D=>D.address.trim()).map((D,_)=>({id:D.id,address:D.address.trim(),label:D.label.trim()||void 0,isDefault:_===0}));if(!I||P.length===0)return;const A=!p||v?P[0]?bt(P[0].address,f):void 0:r?.avatar;p&&r?Wt.updateContact(r.id,{name:I,avatar:A,addresses:P,memo:R||void 0}):Wt.addContact({name:I,addresses:P,avatar:A,memo:R||void 0}),s()},[o,i,u,f,p,r,s]),C=i.some(I=>I.address.trim()),T=o.trim().length>0&&C,k=i.length<Jn;return e.jsx(ae,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t(p?"contact.editTitle":"contact.addTitle")})}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:g,disabled:!b,className:"group relative shrink-0",title:t("addressBook.changeAvatar"),children:[e.jsx(Nn,{src:x,size:56}),b&&e.jsx("div",{className:"bg-background/80 absolute inset-0 flex items-center justify-center rounded-full opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx(vs,{className:"text-primary size-5"})})]}),e.jsx("input",{id:"contact-name",type:"text",value:o,onChange:I=>c(I.target.value),placeholder:t("contact.namePlaceholder"),maxLength:20,className:M("flex-1 rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:t("contact.addresses")}),e.jsxs("span",{className:"text-muted-foreground text-xs",children:[i.length,"/",Jn]})]}),i.map((I,R)=>e.jsxs("div",{className:"space-y-2 rounded-xl border border-border p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:I.label,onChange:P=>w(I.id,"label",P.target.value),placeholder:t("contact.addressLabelPlaceholder"),maxLength:jg,className:M("w-24 shrink-0 rounded-lg border border-border bg-muted/50 px-3 py-2 text-sm","focus:outline-none focus:ring-2 focus:ring-primary")}),i.length>1&&e.jsx("button",{type:"button",onClick:()=>N(I.id),className:"text-muted-foreground hover:text-destructive shrink-0 p-1",children:e.jsx(Tt,{className:"size-4"})}),R===0&&e.jsx("span",{className:"bg-primary/10 text-primary rounded px-1.5 py-0.5 text-xs",children:"Default"})]}),e.jsx("input",{type:"text",value:I.address,onChange:P=>w(I.id,"address",P.target.value),placeholder:t("contact.addressPlaceholder"),className:M("w-full rounded-lg border border-border bg-background px-3 py-2 font-mono text-sm","focus:outline-none focus:ring-2 focus:ring-primary")})]},I.id)),k&&e.jsxs("button",{type:"button",onClick:j,className:"flex w-full items-center justify-center gap-2 rounded-xl border border-dashed border-border py-3 text-sm text-muted-foreground hover:border-primary hover:text-primary",children:[e.jsx(nt,{className:"size-4"}),t("contact.addAddress")]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"contact-memo",className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(Wi,{className:"size-4"}),t("contact.memoOptional")]}),e.jsx("textarea",{id:"contact-memo",value:u,onChange:I=>m(I.target.value),placeholder:t("contact.memoPlaceholder"),maxLength:100,rows:2,className:M("w-full resize-none rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")})]}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsx("button",{onClick:S,disabled:!T,className:M("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(p?"contact.save":"contact.add")}),e.jsx("button",{onClick:()=>s(),className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("contact.cancel")})]})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const el=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(Ng,{})});el.__docgenInfo={description:"",methods:[],displayName:"ContactEditJob"};function wg(t,s=8,n=6){return t.length<=s+n+3?t:`${t.slice(0,s)}...${t.slice(-n)}`}function Cg(){const{t}=L("common"),{pop:s}=K(),{chainType:n}=re(),a=n,[r,o]=l.useState(""),c=le(Ft),i=l.useMemo(()=>{let u=c.contacts;return r&&(u=xn.searchContacts(c,r)),u=[...u].toSorted((m,f)=>f.updatedAt-m.updatedAt),u.map(m=>{const f=m.addresses.map(v=>({...v,isValidForCurrentChain:a?Gu(v.address,a):!0})),h=f.some(v=>v.isValidForCurrentChain);return{contact:m,addresses:f,hasValidAddress:h}})},[c,r,a]),d=(u,m)=>{const f=new CustomEvent("contact-picker-select",{detail:{contact:u,address:m}});window.dispatchEvent(f),s()};return e.jsx(ae,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx("div",{className:"border-border border-b px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("contact.selectAddress")})}),e.jsx("div",{className:"border-border border-b p-4",children:e.jsxs("div",{className:"bg-muted/50 flex items-center gap-2 rounded-xl px-3 py-2",children:[e.jsx(ys,{className:"text-muted-foreground size-4"}),e.jsx("input",{type:"text",value:r,onChange:u=>o(u.target.value),placeholder:t("addressBook.searchPlaceholder"),className:"placeholder:text-muted-foreground min-w-0 flex-1 bg-transparent text-sm outline-none"})]})}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto",children:i.length===0?e.jsx("div",{className:"text-muted-foreground py-12 text-center text-sm",children:t(r?"addressBook.noResults":"contact.noContacts")}):e.jsx("div",{className:"divide-border divide-y",children:i.map(({contact:u,addresses:m,hasValidAddress:f})=>e.jsxs("div",{className:M(!f&&"opacity-50"),children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 pt-3 pb-2",children:[e.jsx(Nn,{src:u.avatar||(m[0]?.address?bt(m[0].address):void 0),size:40,className:"shrink-0"}),e.jsx("p",{className:"min-w-0 flex-1 truncate font-medium",children:u.name})]}),e.jsx("div",{className:"space-y-1 pb-3 pl-[56px] pr-4",children:m.map(h=>{const v=!h.isValidForCurrentChain,y=h.label;return e.jsxs("button",{onClick:()=>!v&&d(u,h),disabled:v,className:M("flex min-h-[44px] w-full items-center gap-3 rounded-xl px-3 py-2.5 transition-colors",v?"cursor-not-allowed opacity-50":"hover:bg-muted/50 active:bg-muted"),children:[e.jsx("p",{className:M("min-w-0 flex-1 truncate text-left font-mono text-sm",v?"text-muted-foreground/50":"text-foreground"),children:wg(h.address)}),e.jsxs("div",{className:"flex shrink-0 items-center gap-2",children:[y&&e.jsx("span",{className:M("max-w-[5rem] truncate rounded-md bg-muted px-2 py-0.5 text-xs",v?"text-muted-foreground/50":"text-muted-foreground"),children:y}),h.isDefault&&e.jsx("span",{className:"bg-primary/10 text-primary rounded-md px-2 py-0.5 text-xs",children:"Default"})]})]},h.id)})})]},u.id))})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const tl=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(Cg,{})});tl.__docgenInfo={description:"",methods:[],displayName:"ContactPickerJob"};const sl=()=>{const{t}=L(["wallet","home"]),{pop:s}=K(),{navigate:n}=Z(),a=()=>{s(),n({to:"/wallet/create"})},r=()=>{s(),n({to:"/onboarding/recover"})};return e.jsx(ae,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("wallet:add")})}),e.jsxs("div",{className:"space-y-3 p-4",children:[e.jsxs("button",{onClick:a,className:M("flex w-full items-center gap-4 rounded-xl p-4 transition-colors","bg-muted/50 hover:bg-muted active:bg-muted/80"),children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10",children:e.jsx(nt,{className:"size-6 text-primary"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-semibold",children:t("home:welcome.createWallet")}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t("wallet:createDesc")})]})]}),e.jsxs("button",{onClick:r,className:M("flex w-full items-center gap-4 rounded-xl p-4 transition-colors","bg-muted/50 hover:bg-muted active:bg-muted/80"),children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10",children:e.jsx(Na,{className:"size-6 text-primary"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-semibold",children:t("home:welcome.importWallet")}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t("wallet:importDesc")})]})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};sl.__docgenInfo={description:"",methods:[],displayName:"WalletAddJob"};const nl=()=>{const{t}=L(["wallet","common"]),{pop:s,push:n}=K(),a=Pt(),o=be()?.id,{getWalletTheme:c}=Mi(),i=Ri(),d=m=>{de.setCurrentWallet(m),s()},u=()=>{s(),n("WalletAddJob",{})};return e.jsx(ae,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("common:a11y.tabWallet")})}),e.jsx("div",{className:"max-h-[50vh] space-y-2 overflow-y-auto p-4",children:a.map(m=>{const f=m.id===o,h=m.chainAddresses[0]?.address,v=h?`${h.slice(0,6)}...${h.slice(-4)}`:"---",y=c(m.id);return e.jsxs("button",{onClick:()=>d(m.id),className:M("flex w-full items-center gap-3 rounded-xl p-4 transition-all","active:scale-[0.98]",f?"bg-primary/10 ring-2 ring-primary":"bg-muted/50 hover:bg-muted"),children:[e.jsx(Yu,{themeHue:y,size:"md",watermarkIconUrl:i[m.chain]}),e.jsxs("div",{className:"min-w-0 flex-1 text-left",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate font-medium",children:m.name}),f&&e.jsx(Xu,{className:"size-4 shrink-0 text-primary"})]}),e.jsx("p",{className:"truncate font-mono text-xs text-muted-foreground",children:v})]})]},m.id)})}),e.jsx("div",{className:"border-t border-border p-4",children:e.jsxs("button",{onClick:u,className:M("flex w-full items-center justify-center gap-2 rounded-xl p-4","bg-muted/50 hover:bg-muted active:bg-muted/80 transition-colors"),children:[e.jsx(nt,{className:"size-5"}),e.jsx("span",{className:"font-medium",children:t("wallet:add")})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};nl.__docgenInfo={description:"",methods:[],displayName:"WalletListJob"};let ua=null;function Sg(t){ua=t}const al=()=>{const{t}=L(["onboarding","common"]),{pop:s}=K(),[n,a]=l.useState(!1),r=()=>{s()},o=()=>{n&&(s(),ua?.(),ua=null)};return e.jsx(qc,{children:e.jsxs("div",{className:"bg-background mx-4 max-w-sm rounded-2xl p-5",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"rounded-full bg-amber-500/15 p-2",children:e.jsx(Se,{className:"size-5 text-amber-600","aria-hidden":"true"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h2",{className:"text-base font-semibold",children:t("onboarding:securityWarning.title")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:t("onboarding:securityWarning.message")})]})]}),e.jsxs("label",{className:"mt-4 flex cursor-pointer items-center gap-2 text-sm",children:[e.jsx(Ji,{checked:n,onCheckedChange:a}),e.jsx("span",{children:t("onboarding:securityWarning.acknowledge")})]}),e.jsxs("div",{className:"mt-5 flex gap-2",children:[e.jsx(q,{type:"button",variant:"outline",className:"flex-1",onClick:r,children:t("common:cancel")}),e.jsx(q,{type:"button",className:"flex-1",onClick:o,disabled:!n,children:t("common:confirm")})]})]})})};al.__docgenInfo={description:"",methods:[],displayName:"SecurityWarningJob"};let os=null;function rl(t,s){os={onConfirm:t,minFee:s?.minFee,onFeeChange:s?.onFeeChange}}function mi(){os=null}function kg(t){return t.length<=16?t:`${t.slice(0,10)}...${t.slice(-6)}`}function Ag(){const{t}=L("transaction"),{pop:s,push:n}=K(),a=re(),[r,o]=l.useState(!1),[c,i]=l.useState(!1),[d,u]=l.useState(!1),[m,f]=l.useState(null),h=l.useRef(os),v=l.useRef(!1);!v.current&&os&&(h.current=os,mi(),v.current=!0),l.useEffect(()=>()=>{mi()},[]);const y=a.feeLoading==="true",p=a.feeFiatValue?parseFloat(a.feeFiatValue):void 0,g=m??a.feeAmount,b=!!h.current?.onFeeChange,x=l.useCallback(async()=>{try{await xa.write({text:a.toAddress}),i(!0),setTimeout(()=>i(!1),2e3)}catch{console.error("Failed to copy address")}},[a.toAddress]),j=l.useCallback(()=>{o(C=>!C)},[]),N=l.useCallback(()=>{const C=h.current;C?.onFeeChange&&(Qc({currentFee:g,minFee:C.minFee??a.feeAmount,symbol:a.feeSymbol},T=>{f(T.fee),C.onFeeChange?.(T.fee)}),n("FeeEditJob",{}))},[g,a.feeAmount,a.feeSymbol,n]),w=l.useCallback(async()=>{const C=h.current;if(console.log("[TransferConfirmJob] handleConfirm called, hasCallback:",!!C?.onConfirm),!(!C?.onConfirm||d)){u(!0);try{s(),console.log("[TransferConfirmJob] Executing callback..."),await C.onConfirm(),console.log("[TransferConfirmJob] Callback executed")}finally{u(!1)}}},[d,s]),S=l.useCallback(()=>{s()},[s]);return e.jsx(ae,{"data-testid":"transfer-confirm-sheet",children:e.jsx(an,{title:t("confirmSheet.title"),children:e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-3xl font-bold",children:[a.amount," ",a.symbol]}),a.fiatValue&&e.jsxs("p",{className:"text-muted-foreground mt-1",children:[" $",a.fiatValue]})]}),e.jsxs("div",{className:"bg-muted/30 space-y-4 rounded-xl p-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:t("confirmSheet.toAddress")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:j,className:"hover:text-primary flex min-w-0 flex-1 items-center gap-1 text-left font-mono text-sm",children:[e.jsx("span",{className:M("min-w-0",r?"break-all":"truncate"),children:r?a.toAddress:kg(a.toAddress)}),r?e.jsx(Vi,{className:"size-4 shrink-0"}):e.jsx(Gi,{className:"size-4 shrink-0"})]}),e.jsx("button",{type:"button",onClick:x,className:"text-muted-foreground hover:text-foreground shrink-0 p-1","aria-label":t(c?"confirmSheet.copied":"confirmSheet.copyAddress"),children:c?e.jsx(fe,{className:"size-4 text-green-500"}):e.jsx(Bi,{className:"size-4"})})]})]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:t("confirmSheet.networkFee")}),e.jsx(ba,{amount:g,symbol:a.feeSymbol,...p!==void 0&&{fiatValue:p},isLoading:y,editable:b,onEdit:N})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button","data-testid":"cancel-transfer-button",onClick:S,className:"border-border hover:bg-muted flex-1 rounded-full border py-3 font-medium transition-colors",disabled:d,children:t("confirmSheet.cancel")}),e.jsx("button",{type:"button","data-testid":"confirm-transfer-button",onClick:w,disabled:d||y,className:M("flex-1 rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(d?"confirmSheet.confirming":"confirmSheet.confirm")})]})]})})})}const il=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(Ag,{})});il.__docgenInfo={description:"",methods:[],displayName:"TransferConfirmJob"};let un=null;function ol(t){un=t}function Tg(){un=null}function Ig(){const{t}=L(["security","transaction","common"]),{pop:s,push:n}=K(),{title:a}=re(),r=Ta(),o=at(),c=Le(),i=st(),[d,u]=l.useState("wallet_lock"),[m,f]=l.useState([]),[h,v]=l.useState(""),[y,p]=l.useState("idle"),[g,b]=l.useState(),[x,j]=l.useState(),[N,w]=l.useState(!1),[S,C]=l.useState(!1),T=l.useRef(null),k=l.useRef(""),I=l.useRef(!1);!I.current&&un&&(T.current=un,Tg(),I.current=!0);const R=l.useMemo(()=>Ge.getChainById(i,c),[i,c]),P=l.useMemo(()=>{const O=R?.explorer?.queryTx;return!O||!g?null:O.replace(":hash",g).replace(":signature",g)},[R?.explorer?.queryTx,g]),A=l.useCallback(()=>{P&&window.open(P,"_blank","noopener,noreferrer")},[P]),D=d==="wallet_lock"?a??t("security:walletLock.verifyTitle"):t("transaction:sendPage.twoStepSecretTitle"),_=l.useCallback(async O=>{const H=T.current;if(O.length<4||!H)return;C(!0),j(void 0),w(!1);const te=At(O);k.current=te;try{const Q=await H(te);if(Q.status==="ok"){Q.txHash&&b(Q.txHash),p("broadcasted");return}if(Q.status==="wallet_lock_invalid"){w(!0),f([]);return}if(Q.status==="two_step_secret_required"){u("two_step_secret"),j(void 0);return}Q.status==="error"&&j(Q.message??t("security:walletLock.error"))}catch{w(!0),f([])}finally{C(!1)}},[t]),B=l.useCallback(async()=>{const O=T.current;if(!(!h.trim()||!O)){C(!0),j(void 0);try{const H=await O(k.current,h);if(H.status==="ok"){H.txHash&&b(H.txHash),p("broadcasted");return}(H.status==="two_step_secret_invalid"||H.status==="error")&&j(H.message??t("transaction:sendPage.twoStepSecretError"))}catch{j(t("transaction:sendPage.twoStepSecretError"))}finally{C(!1)}}},[h,t]),E=l.useCallback(O=>{O.preventDefault(),d==="two_step_secret"&&B()},[d,B]),z=h.trim().length>0&&!S;return y!=="idle"?e.jsx(ae,{children:e.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx(Qa,{status:y,txHash:g,title:{broadcasted:t("transaction:sendResult.success"),confirmed:t("transaction:sendResult.success")},description:{broadcasted:t("transaction:txStatus.broadcastedDesc"),confirmed:t("transaction:txStatus.confirmedDesc")},onStatusChange:p,onDone:()=>s(),onViewDetails:()=>{s(),g&&n("TransactionDetailActivity",{txId:g})},onViewExplorer:P?A:void 0,onShare:async()=>{g&&(await r.write({text:g}),o.show(t("common:copied")))}}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}):d==="wallet_lock"?e.jsx(ae,{children:e.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:e.jsx(an,{title:D,children:e.jsxs("div",{className:"p-4",children:[e.jsx(Gt,{value:m,onChange:f,onComplete:_,minPoints:4,error:N,disabled:S,"data-testid":"transfer-wallet-lock-pattern"}),e.jsx("button",{type:"button",onClick:()=>s(),disabled:S,className:"mt-4 w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("common:cancel")})]})})})}):e.jsx(ae,{children:e.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:e.jsx(an,{title:D,children:e.jsxs("form",{onSubmit:E,className:"space-y-6 p-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-primary mb-2",children:[e.jsx(yn,{className:"size-5"}),e.jsx("span",{className:"text-sm",children:t("transaction:sendPage.twoStepSecretDescription")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Us,{value:h,onChange:O=>v(O.target.value),placeholder:t("transaction:sendPage.twoStepSecretPlaceholder"),disabled:S,"aria-describedby":x?"two-step-error":void 0,"data-testid":"two-step-secret-input"}),h.length>0&&h.length<6&&e.jsx("div",{className:"absolute right-10 top-1/2 -translate-y-1/2",children:e.jsx("span",{className:"text-xs text-amber-500",children:t("security:twoStepSecret.lengthHint",{count:h.length})})})]}),x&&e.jsxs("div",{id:"two-step-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(It,{className:"size-4"}),e.jsx("span",{children:x})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{type:"submit","data-testid":"two-step-confirm-button",disabled:!z,className:M("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(S?"common:verifying":"common:confirm")}),e.jsx("button",{type:"button",onClick:()=>s(),disabled:S,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("common:cancel")})]})]})})})})}const cl=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(Ig,{})});cl.__docgenInfo={description:"",methods:[],displayName:"TransferWalletLockJob"};const Pg=150;function Eg(){const{t}=L("scanner"),{pop:s}=K(),n=No(),{chainType:a,title:r,hint:o}=re(),c=l.useRef(null),i=l.useRef(null),d=l.useRef(null),u=l.useRef(null),m=l.useRef(!1),f=l.useRef(!1),h=l.useRef(!1),[v,y]=l.useState(!1),[p,g]=l.useState(!1),[b,x]=l.useState(null),[j,N]=l.useState(null),w=tm(a),S=l.useCallback(A=>{if(A===j)return;N(A);const D=Qi(A),_=w(A,D);if(_===!0){x({type:"success",text:t("scanSuccess")}),"vibrate"in navigator&&navigator.vibrate(100),m.current=!1;const B=sm();setTimeout(()=>{s(),setTimeout(()=>{B?.({content:A,parsed:D})},100)},300)}else x({type:"error",text:t(_,{defaultValue:_})}),setTimeout(()=>{x(null),N(null)},3e3)},[j,w,t,s]),C=l.useCallback(()=>{if(m.current)return;m.current=!0,i.current||(i.current=document.createElement("canvas"));const A=async()=>{if(!(!m.current||!c.current||!u.current)){try{const D=await u.current.scanFromVideo(c.current,i.current??void 0);D&&S(D.content)}catch(D){console.error("[ScannerJob] Scan error:",D)}m.current&&setTimeout(A,Pg)}};A()},[S]),T=l.useCallback(()=>{m.current=!1,d.current&&(d.current.getTracks().forEach(A=>A.stop()),d.current=null),y(!1)},[]),k=l.useCallback(async()=>{if(!h.current){if(h.current=!0,!navigator.mediaDevices?.getUserMedia){console.error("[ScannerJob] mediaDevices not available"),x({type:"error",text:t("error")}),h.current=!1;return}try{try{if(!await n.checkPermission()&&!await n.requestPermission()){x({type:"error",text:t("permissionDenied")}),h.current=!1;return}}catch(D){console.warn("[ScannerJob] Permission check failed, trying direct access:",D)}if(!f.current){h.current=!1;return}const A=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});if(!f.current){A.getTracks().forEach(D=>D.stop()),h.current=!1;return}if(d.current=A,c.current){c.current.srcObject=A;try{await c.current.play(),f.current&&(y(!0),C())}catch(D){if(D instanceof DOMException&&D.name==="AbortError")console.debug("[ScannerJob] Play interrupted, will retry on next mount");else throw D}}}catch(A){if(console.error("[ScannerJob] Camera error:",A),!f.current){h.current=!1;return}A instanceof DOMException?A.name==="NotAllowedError"?x({type:"error",text:t("permissionDenied")}):A.name==="NotFoundError"?x({type:"error",text:t("noCameraFound",{defaultValue:t("error")})}):A.name==="AbortError"||x({type:"error",text:t("error")}):x({type:"error",text:t("error")})}finally{h.current=!1}}},[n,C,t]);l.useEffect(()=>(f.current=!0,u.current=Yi({useWorker:!0}),k(),()=>{f.current=!1,T(),u.current?.destroy(),u.current=null}),[]);const I=l.useCallback(()=>{const A=document.createElement("input");A.type="file",A.accept="image/*",A.onchange=async D=>{const _=D.target.files?.[0];if(!(!_||!u.current))try{const B=new Image,E=URL.createObjectURL(_);B.onload=async()=>{URL.revokeObjectURL(E);const z=document.createElement("canvas");z.width=B.width,z.height=B.height;const O=z.getContext("2d");if(!O||!u.current){x({type:"error",text:t("noQrFound")});return}O.drawImage(B,0,0);const H=await u.current.scanFromCanvas(z);H?S(H.content):x({type:"error",text:t("noQrFound")})},B.onerror=()=>{URL.revokeObjectURL(E),x({type:"error",text:t("noQrFound")})},B.src=E}catch{x({type:"error",text:t("noQrFound")})}},A.click()},[S,t]),R=l.useCallback(async()=>{if(d.current){const A=d.current.getVideoTracks()[0];if(A)try{await A.applyConstraints({advanced:[{torch:!p}]}),g(!p)}catch{}}},[p]),P=l.useCallback(()=>{T(),s()},[T,s]);return e.jsx(ae,{children:e.jsxs("div",{className:"flex h-[80vh] flex-col overflow-hidden rounded-t-2xl bg-black",children:[e.jsx("div",{className:"flex justify-center py-2",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-white/30"})}),e.jsxs("div",{className:"flex items-center justify-between px-4 pb-2",children:[e.jsx(q,{variant:"ghost",size:"icon",onClick:P,className:"text-white hover:bg-white/20","data-testid":"scanner-close-button",children:e.jsx(wn,{className:"size-6"})}),e.jsx("h2",{className:"text-lg font-medium text-white","data-testid":"scanner-title",children:r??t("title")}),e.jsx(q,{variant:"ghost",size:"icon",onClick:R,className:M("text-white hover:bg-white/20",p&&"text-yellow-400"),"data-testid":"scanner-flash-button",children:e.jsx(mo,{className:"size-6"})})]}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("video",{ref:c,className:M("absolute inset-0 size-full object-cover",!v&&"hidden"),playsInline:!0,muted:!0,"data-testid":"scanner-video"}),!v&&!b&&e.jsx("div",{className:"flex size-full items-center justify-center",children:e.jsx("p",{className:"text-white/60",children:t("initializing")})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"relative size-64","data-testid":"scanner-viewfinder",children:[e.jsx("div",{className:M("absolute top-0 left-0 size-8 border-t-4 border-l-4",b?.type==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:M("absolute top-0 right-0 size-8 border-t-4 border-r-4",b?.type==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:M("absolute bottom-0 left-0 size-8 border-b-4 border-l-4",b?.type==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:M("absolute right-0 bottom-0 size-8 border-r-4 border-b-4",b?.type==="success"?"border-green-500":"border-primary")}),v&&!b&&e.jsx("div",{className:"animate-scan bg-primary absolute right-2 left-2 h-0.5"})]})}),e.jsx("div",{className:"absolute inset-x-0 bottom-24 px-4 text-center",children:b?e.jsx("div",{className:M("inline-block rounded-lg px-4 py-2",b.type==="error"&&"bg-red-500/80 text-white",b.type==="success"&&"bg-green-500/80 text-white",b.type==="info"&&"bg-black/50 text-white"),"data-testid":"scanner-message",children:b.text}):v?e.jsx("p",{className:"text-white/80","data-testid":"scanner-hint",children:o??(a?t("scanPromptChain",{chain:a}):t("scanPrompt"))}):null})]}),e.jsx("div",{className:"flex justify-center gap-8 bg-black/50 py-6",children:e.jsxs(q,{variant:"ghost",size:"lg",onClick:I,className:"flex flex-col items-center text-white hover:bg-white/20","data-testid":"scanner-gallery-button",children:[e.jsx(co,{className:"mb-1 size-6"}),e.jsx("span",{className:"text-xs",children:t("gallery")})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)] bg-black"})]})})}const ll=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(Eg,{})});ll.__docgenInfo={description:"",methods:[],displayName:"ScannerJob"};function _g(){const{t}=L("common"),{pop:s}=K(),n=re(),[a,r]=l.useState(n.name||""),[o,c]=l.useState(n.memo||""),[i,d]=l.useState(0),[u,m]=l.useState(!1),[f,h]=l.useState(!1),v=(()=>{try{return JSON.parse(n.addresses||"[]")}catch{return[]}})(),y=l.useCallback(()=>{d(b=>b+1)},[]),p=l.useCallback(async()=>{if(!(!a.trim()||v.length===0)){m(!0);try{const b=n.avatar||(v[0]?.address?bt(v[0].address,i):void 0);Wt.addContact({name:a.trim(),addresses:v.map((x,j)=>({id:`addr-${j}`,address:x.address,label:x.label,isDefault:j===0})),memo:o.trim()||void 0,avatar:b}),h(!0),setTimeout(()=>s(),500)}catch(b){console.error("[ContactAddConfirmJob] Save error:",b)}finally{m(!1)}}},[a,o,v,n.avatar,i,s]),g=l.useCallback(()=>{s()},[s]);return e.jsx(ae,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl pb-[env(safe-area-inset-bottom)]",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx("div",{className:"border-border border-b px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("addressBook.addContact")})}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:y,className:"group relative",title:t("addressBook.changeAvatar"),children:[e.jsx(Nn,{src:n.avatar||(v[0]?.address?bt(v[0].address,i):void 0),size:48}),!n.avatar&&e.jsx("div",{className:"bg-background/80 absolute inset-0 flex items-center justify-center rounded-full opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx(vs,{className:"text-primary size-5"})})]}),e.jsx(Pe,{value:a,onChange:b=>r(b.target.value),placeholder:t("addressBook.namePlaceholder"),className:"flex-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm",children:t("addressBook.addresses")}),e.jsx("div",{className:"space-y-2",children:v.map((b,x)=>{const j=Qu(b.address),N=b.label||j.chainType?.toUpperCase()||"";return e.jsxs("div",{className:"bg-muted/50 flex items-center gap-3 rounded-lg p-3",children:[e.jsx(wa,{className:"text-muted-foreground size-5 shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[N&&e.jsx("div",{className:"text-muted-foreground text-xs",children:N}),e.jsx("div",{className:"truncate font-mono text-sm",children:b.address})]})]},x)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm",children:t("addressBook.memo")}),e.jsx(Pe,{value:o,onChange:b=>c(b.target.value),placeholder:t("addressBook.memoPlaceholder")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx(q,{variant:"outline",onClick:g,disabled:u||f,className:"flex-1",children:t("cancel")}),e.jsx(q,{onClick:p,disabled:!a.trim()||v.length===0||u||f,className:M("flex-1",f&&"bg-green-500"),children:f?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"mr-1 size-4"}),t("saved")]}):t(u?"saving":"save")})]})]})})}const dl=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(_g,{})});dl.__docgenInfo={description:"",methods:[],displayName:"ContactAddConfirmJob"};function Mg(){const{t}=L("common"),{pop:s}=K(),n=re(),a=l.useRef(null),[r,o]=l.useState(!1),c=l.useMemo(()=>{try{return JSON.parse(n.addresses||"[]")}catch{return[]}},[n.addresses]),i=l.useMemo(()=>em({name:n.name,addresses:c,avatar:n.avatar}),[n.name,c,n.avatar]),d=l.useCallback(async()=>{const m=a.current;if(!(!m||r)){o(!0);try{const{snapdom:f}=await cs(async()=>{const{snapdom:h}=await import("./snapdom-CO8q8LPW.js").then(v=>v.s);return{snapdom:h}},__vite__mapDeps([0,1]),import.meta.url);await f.download(m,{type:"png",filename:`contact-${n.name}.png`,scale:2,quality:1})}catch(f){console.error("Download failed:",f)}finally{o(!1)}}},[n.name,r]),u=l.useCallback(async()=>{const m=a.current;if(!(!m||!navigator.share)){o(!0);try{const{snapdom:f}=await cs(async()=>{const{snapdom:p}=await import("./snapdom-CO8q8LPW.js").then(g=>g.s);return{snapdom:p}},__vite__mapDeps([0,1]),import.meta.url),v=await(await f(m,{scale:2})).toBlob(),y=new File([v],`contact-${n.name}.png`,{type:"image/png"});await navigator.share({title:t("addressBook.shareContact"),text:`${n.name} - ${c.map(p=>`${p.label||""}: ${p.address}`).join(", ")}`,files:[y]})}catch{}finally{o(!1)}}},[n.name,c,t,r]);return e.jsx(ae,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl pb-[env(safe-area-inset-bottom)]",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"flex items-center justify-between border-b px-4 pb-4",children:[e.jsx(q,{variant:"ghost",size:"icon",onClick:()=>s(),children:e.jsx(wn,{className:"size-5"})}),e.jsx("h2",{className:"text-lg font-semibold",children:t("addressBook.shareContact")}),e.jsx("div",{className:"w-10"})]}),e.jsxs("div",{className:"flex flex-col items-center p-6",children:[e.jsx("div",{ref:a,children:e.jsx(am,{name:n.name,avatar:n.avatar,addresses:c,qrContent:i})}),e.jsx("p",{className:"text-muted-foreground mt-4 text-center text-sm",children:t("addressBook.scanToAdd")})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsxs(q,{variant:"outline",onClick:d,disabled:r,className:"flex-1",children:[r?e.jsx(ke,{className:"mr-2 size-4 animate-spin"}):e.jsx(Na,{className:"mr-2 size-4"}),t("download")]}),"share"in navigator&&e.jsxs(q,{onClick:u,disabled:r,className:"flex-1",children:[r?e.jsx(ke,{className:"mr-2 size-4 animate-spin"}):e.jsx(Qs,{className:"mr-2 size-4"}),t("share")]})]})]})})}const ul=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(Mg,{})});ul.__docgenInfo={description:"",methods:[],displayName:"ContactShareJob"};function Rg(){const{t}=L(["settings","common"]),{pop:s}=K(),[n,a]=l.useState(!1),r=l.useCallback(()=>{a(!0);const o="./";window.location.href=`${o}clear.html`},[]);return e.jsx(ae,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-destructive/10 flex size-16 items-center justify-center rounded-full",children:e.jsx(Se,{className:"text-destructive size-8"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:t("settings:clearData.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("settings:clearData.warning")})]}),e.jsx("div",{className:"bg-destructive/5 rounded-lg p-4",children:e.jsxs("ul",{className:"text-destructive space-y-2 text-sm",children:[e.jsxs("li",{children:[" ",t("settings:clearData.item1")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item2")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item3")]})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(q,{variant:"outline",className:"flex-1",onClick:()=>s(),disabled:n,children:t("common:cancel")}),e.jsx(q,{variant:"destructive",className:"flex-1",onClick:r,disabled:n,children:t("settings:clearData.confirm")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const ml=()=>e.jsx(Rg,{});ml.__docgenInfo={description:"",methods:[],displayName:"ClearDataConfirmJob"};function Dg(t){if(!t)return;if(t.startsWith("0x")){const n=Cn(t);if(n)return n}const s=rm(t);return Xn[s],s}function zg(){const{t}=L("common"),{pop:s}=K(),{chain:n,exclude:a,appName:r,appIcon:o}=re(),c=l.useMemo(()=>Dg(n),[n]),i=le(me),d=_e.getCurrentWallet(i),u=l.useMemo(()=>{const v=a?.toLowerCase();return i.wallets.map(y=>{const p=c?y.chainAddresses.find(g=>g.chain===c):y.chainAddresses[0];return!p||v&&p.address.toLowerCase()===v?null:{id:y.id,name:y.name,address:p.address,themeHue:y.themeHue,chainIconUrl:void 0}}).filter(y=>y!==null)},[i.wallets,c,a]),m=l.useMemo(()=>{const v=new Map;return i.wallets.forEach(y=>{const p=c?y.chainAddresses.find(g=>g.chain===c):y.chainAddresses[0];p&&v.set(y.id,{wallet:y,chainAddress:p})}),v},[i.wallets,c]),f=v=>{const y=m.get(v);if(!y)return;const p=new CustomEvent("wallet-picker-select",{detail:{address:y.chainAddress.address,chain:y.chainAddress.chain,name:y.wallet.name,publicKey:y.chainAddress.publicKey}});window.dispatchEvent(p),s()},h=()=>{const v=new CustomEvent("wallet-picker-cancel");window.dispatchEvent(v),s()};return e.jsx(ae,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Kt,{title:t("selectWallet",""),description:`${r||t("unknownDApp"," DApp")} ${t("requestsAccess","")}`,appName:r,appIcon:o}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto p-4",children:u.length===0?e.jsx("div",{className:"text-muted-foreground py-12 text-center text-sm",children:c?t("noWalletsForChain"," {{chain}} ",{chain:c}):t("noWallets","")}):e.jsx(Zu,{wallets:u,currentWalletId:d?.id,onSelect:f,showAddButton:!1})}),e.jsx("div",{className:"border-border border-t p-4",children:e.jsx("button",{onClick:h,className:"bg-muted hover:bg-muted/80 w-full rounded-xl py-3 font-medium transition-colors",children:t("cancel","")})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const fl=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(zg,{})});fl.__docgenInfo={description:"",methods:[],displayName:"WalletPickerJob"};function Bg(){const{t}=L("common"),{pop:s,push:n}=K(),{message:a,address:r,appName:o,appIcon:c,chainName:i}=re(),d=be(),[u,m]=l.useState(!1),f=l.useCallback(()=>{u||(it(async y=>{m(!0);try{const p=d?.encryptedMnemonic;if(!p)return console.error("[SigningConfirmJob] No encrypted mnemonic found"),!1;const g=`miniapp_sign_${Date.now()}`,x=await new Ia(Ht,g).handleMessageSign({chainName:i||"bioforest",senderAddress:r,message:a},p,y),j=new CustomEvent("signing-confirm",{detail:{confirmed:!0,signature:x.signature,publicKey:x.publicKey}});return window.dispatchEvent(j),s(),!0}catch(p){return console.error("[SigningConfirmJob] Signing failed:",p),!1}finally{m(!1)}}),n("WalletLockConfirmJob",{title:t("sign","")}))},[u,d,i,r,a,s,n,t]),h=l.useCallback(()=>{const y=new CustomEvent("signing-confirm",{detail:{confirmed:!1}});window.dispatchEvent(y),s()},[s]),v=a.startsWith("0x")&&/^0x[0-9a-fA-F]+$/.test(a);return e.jsx(ae,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Kt,{title:t("signMessage",""),description:o||t("unknownDApp"," DApp"),appName:o,appIcon:c}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("signingAddress","")}),e.jsx(Ue,{address:r,copyable:!1,className:"text-sm"})]}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("message","")}),e.jsx("div",{className:"max-h-40 overflow-y-auto",children:e.jsx("pre",{className:"whitespace-pre-wrap break-all font-mono text-sm",children:a})})]}),v&&e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[e.jsx(Se,{className:"size-5 shrink-0 text-amber-600"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:t("hexDataWarning","")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:h,disabled:u,className:"bg-muted hover:bg-muted/80 disabled:opacity-50 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("cancel","")}),e.jsx("button",{onClick:f,disabled:u,className:M("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","disabled:opacity-50 flex items-center justify-center gap-2"),children:u?e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"size-4 animate-spin"}),t("signing","...")]}):t("sign","")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const pl=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(Bg,{})});pl.__docgenInfo={description:"",methods:[],displayName:"SigningConfirmJob"};const Lg={bio_requestAccounts:{icon:wa,label:"",description:""},bio_createTransaction:{icon:Wi,label:"",description:"/"},bio_signMessage:{icon:Mn,label:"",description:""},bio_signTypedData:{icon:Mn,label:"",description:""},bio_signTransaction:{icon:Mn,label:"",description:""},bio_sendTransaction:{icon:Om,label:"",description:""}};function Og(){const{t}=L("common"),{pop:s}=K(),{appName:n,appIcon:a,permissions:r}=re(),o=(()=>{try{return JSON.parse(r)}catch{return[]}})(),c=()=>{const d=new CustomEvent("permission-request",{detail:{approved:!0,permissions:o}});window.dispatchEvent(d),s()},i=()=>{const d=new CustomEvent("permission-request",{detail:{approved:!1}});window.dispatchEvent(d),s()};return e.jsx(ae,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"border-border border-b px-4 pb-4",children:[e.jsx("div",{className:"mx-auto mb-3 flex size-14 items-center justify-center rounded-2xl bg-primary/10",children:a?e.jsx("img",{src:a,alt:n,className:"size-10 rounded-xl"}):e.jsx(cu,{className:"text-primary size-8"})}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:n}),e.jsx("p",{className:"text-muted-foreground mt-1 text-center text-sm",children:t("requestsPermissions","")})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"space-y-3",children:o.map(d=>{const u=Lg[d];if(!u)return null;const m=u.icon;return e.jsxs("div",{className:"bg-muted/50 flex items-center gap-3 rounded-xl p-3",children:[e.jsx("div",{className:"bg-primary/10 flex size-10 shrink-0 items-center justify-center rounded-full",children:e.jsx(m,{className:"text-primary size-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium",children:u.label}),e.jsx("p",{className:"text-muted-foreground text-sm",children:u.description})]})]},d)})}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Xi,{className:"size-4"}),e.jsx("span",{children:t("permissionNote","")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:i,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("reject","")}),e.jsx("button",{onClick:c,className:M("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90"),children:t("approve","")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const hl=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(Og,{})});hl.__docgenInfo={description:"",methods:[],displayName:"PermissionRequestJob"};function Fg(){const{t}=L("common"),{pop:s,push:n}=K(),a=re(),{appName:r,appIcon:o,from:c,to:i,amount:d,chain:u,asset:m}=a,f=be(),[h,v]=l.useState(!1),y=l.useCallback(()=>{h||(it(async b=>{v(!0);try{const x=f?.encryptedMnemonic;if(!x)return console.error("[MiniappTransferConfirmJob] No encrypted mnemonic found"),!1;const j=`miniapp_transfer_${Date.now()}`,N=new Ia(Ht,j),w={chainName:u,senderAddress:c,receiveAddress:i,balance:d};m&&(w.assetType=m);const C=await N.handleTransferSign(w,x,b),T=new CustomEvent("miniapp-transfer-confirm",{detail:{confirmed:!0,txHash:C}});return window.dispatchEvent(T),s(),!0}catch(x){return console.error("[MiniappTransferConfirmJob] Transfer failed:",x),!1}finally{v(!1)}}),n("WalletLockConfirmJob",{title:t("confirmTransfer","")}))},[h,f,u,c,i,d,m,s,n,t]),p=l.useCallback(()=>{const b=new CustomEvent("miniapp-transfer-confirm",{detail:{confirmed:!1}});window.dispatchEvent(b),s()},[s]),g=m||u.toUpperCase();return e.jsx(ae,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Kt,{title:t("confirmTransfer",""),description:`${r||t("unknownDApp"," DApp")} ${t("requestsTransfer","")}`,appName:r,appIcon:o}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx("div",{className:"bg-muted/50 rounded-xl p-4 text-center",children:e.jsx(dt,{value:d,symbol:g,size:"xl",weight:"bold",decimals:8,fixedDecimals:!0})}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-muted-foreground text-xs w-10 shrink-0",children:t("from","")}),e.jsx(Ue,{address:c,copyable:!0,className:"flex-1 text-sm"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(jn,{className:"size-4 text-muted-foreground"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-muted-foreground text-xs w-10 shrink-0",children:t("to","")}),e.jsx(Ue,{address:i,copyable:!0,className:"flex-1 text-sm"})]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3 flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("network","")}),e.jsx("span",{className:"text-sm font-medium",children:u})]}),e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[e.jsx(Se,{className:"size-5 shrink-0 text-amber-600 mt-0.5"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:t("transferWarning","")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:p,disabled:h,className:"bg-muted hover:bg-muted/80 disabled:opacity-50 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("cancel","")}),e.jsx("button",{onClick:y,disabled:h,className:M("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","disabled:opacity-50 flex items-center justify-center gap-2"),children:h?e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"size-4 animate-spin"}),t("confirming","...")]}):t("confirm","")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const xl=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(Fg,{})});xl.__docgenInfo={description:"",methods:[],displayName:"MiniappTransferConfirmJob"};function Ya(t){return t.apis.find(n=>n.type==="biowallet-v1")?.endpoint??null}async function gl(t,s,n){const a=Ya(t);return a?(await fu(a,s,n))?.applyAddress??null:null}async function vl(t,s,n){const a=Ya(t);if(!a)return{amount:ce.fromRaw("1000",t.decimals,t.symbol),symbol:t.symbol};try{const r=await pu(a,t.id,s,n);return{amount:ce.fromRaw(r,t.decimals,t.symbol),symbol:t.symbol}}catch(r){return console.warn("[fetchBioforestBurnFee] Failed to get fee:",r),{amount:ce.fromRaw("1000",t.decimals,t.symbol),symbol:t.symbol}}}async function mn({chainConfig:t,walletId:s,password:n,fromAddress:a,recipientAddress:r,assetType:o,amount:c,fee:i,twoStepSecret:d}){let u;try{u=await fn.getMnemonic(s,n)}catch(f){return f instanceof pn&&f.code===hn.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:f instanceof Error?f.message:""}}if(!c.isPositive())return{status:"error",message:""};const m=Ya(t);if(!m)return{status:"error",message:"API URL "};try{console.log("[submitBioforestBurn] Starting destroy:",{apiUrl:m,fromAddress:a,recipientAddress:r,assetType:o,amount:c.toRawString()});const f=await bn(m,a);if(console.log("[submitBioforestBurn] Address info:",{hasSecondPubKey:!!f.secondPublicKey}),f.secondPublicKey&&!d)return console.log("[submitBioforestBurn] Pay password required"),{status:"password_required",secondPublicKey:f.secondPublicKey};if(d&&f.secondPublicKey){console.log("[submitBioforestBurn] Verifying pay password...");const y=await Oi(t.id,u,d,f.secondPublicKey);if(console.log("[submitBioforestBurn] Pay password verification result:",y),!y)return{status:"error",message:""}}console.log("[submitBioforestBurn] Creating transaction...");const h=await hu({baseUrl:m,chainId:t.id,mainSecret:u,paySecret:d,from:a,recipientId:r,assetType:o,amount:c.toRawString(),fee:i?.toRawString()}),v=h.signature;console.log("[submitBioforestBurn] Transaction created:",v?.slice(0,20)),console.log("[submitBioforestBurn] Broadcasting...");try{return await Fi(m,h),console.log("[submitBioforestBurn] SUCCESS! txHash:",v),{status:"ok",txHash:v}}catch(y){if(console.error("[submitBioforestBurn] Broadcast failed:",y),y instanceof $s)return{status:"error",message:qs(y)};throw y}}catch(f){return console.error("[submitBioforestBurn] FAILED:",f),f instanceof $s?{status:"error",message:qs(f)}:{status:"error",message:(f instanceof Error?f.message:String(f))||""}}}const Wg=Object.freeze(Object.defineProperty({__proto__:null,fetchAssetApplyAddress:gl,fetchBioforestBurnFee:vl,submitBioforestBurn:mn},Symbol.toStringTag,{value:"Module"}));function $g(){const{t}=L(["common","transaction"]),{pop:s,push:n}=K(),a=re(),{appName:r,appIcon:o,from:c,amount:i,chain:d,asset:u}=a,m=be(),f=st(),h=f.snapshot?Ge.getChainById(f,d):null,[v,y]=l.useState(!1),p=l.useCallback(()=>{v||(it(async b=>{y(!0);try{if(!m?.id||!h)return console.error("[MiniappDestroyConfirmJob] Missing wallet or chain config"),!1;const{fetchAssetApplyAddress:x}=await cs(async()=>{const{fetchAssetApplyAddress:C}=await Promise.resolve().then(()=>Wg);return{fetchAssetApplyAddress:C}},void 0,import.meta.url),j=await x(h,u,c);if(!j)return console.error("[MiniappDestroyConfirmJob] Failed to get asset apply address"),!1;const N=ce.fromFormatted(i,h.decimals,u),w=await mn({chainConfig:h,walletId:m.id,password:b,fromAddress:c,recipientAddress:j,assetType:u,amount:N});if(w.status==="password")return!1;if(w.status==="error")return console.error("[MiniappDestroyConfirmJob] Destroy failed:",w.message),!1;const S=new CustomEvent("miniapp-destroy-confirm",{detail:{confirmed:!0,txHash:w.txHash}});return window.dispatchEvent(S),s(),!0}catch(x){return console.error("[MiniappDestroyConfirmJob] Destroy failed:",x),!1}finally{y(!1)}}),n("WalletLockConfirmJob",{title:t("transaction:destroyPage.title")}))},[v,m,h,u,c,i,s,n,t]),g=l.useCallback(()=>{const b=new CustomEvent("miniapp-destroy-confirm",{detail:{confirmed:!1}});window.dispatchEvent(b),s()},[s]);return e.jsx(ae,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Kt,{title:t("transaction:destroyPage.title"),description:`${r||t("common:unknownDApp")} ${t("common:requestsDestroy","")}`,appName:r,appIcon:o}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx("div",{className:"bg-destructive/5 rounded-xl p-4 text-center",children:e.jsx(dt,{value:i,symbol:u,size:"xl",weight:"bold",decimals:8,fixedDecimals:!0})}),e.jsx("div",{className:"bg-muted/50 rounded-xl p-4 space-y-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-muted-foreground text-xs w-10 shrink-0",children:t("common:from","")}),e.jsx(Ue,{address:c,copyable:!0,className:"flex-1 text-sm"})]})}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3 flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("common:network","")}),e.jsx("span",{className:"text-sm font-medium",children:d})]}),e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-destructive/10 p-3",children:[e.jsx(Se,{className:"size-5 shrink-0 text-destructive mt-0.5"}),e.jsx("p",{className:"text-sm text-destructive",children:t("transaction:destroyPage.warning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:g,disabled:v,className:"bg-muted hover:bg-muted/80 disabled:opacity-50 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("common:cancel","")}),e.jsx("button",{onClick:p,disabled:v,className:M("flex-1 rounded-xl py-3 font-medium transition-colors","bg-destructive text-destructive-foreground hover:bg-destructive/90","disabled:opacity-50 flex items-center justify-center gap-2"),children:v?e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"size-4 animate-spin"}),t("common:confirming","...")]}):e.jsxs(e.Fragment,{children:[e.jsx(Hs,{className:"size-4"}),t("transaction:destroyPage.confirm")]})})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const yl=({params:t})=>e.jsx(ee,{params:t,children:e.jsx($g,{})});yl.__docgenInfo={description:"",methods:[],displayName:"MiniappDestroyConfirmJob"};function qg(t,s){const n=s.startsWith("0x"),a=n?s.toLowerCase():s;for(const r of me.state.wallets)if(r.chainAddresses.find(c=>c.chain!==t?!1:n||c.address.startsWith("0x")?c.address.toLowerCase()===a:c.address===a))return r.id;return null}function Hg(){const{t}=L("common"),{pop:s,push:n}=K(),a=re(),{appName:r,appIcon:o,from:c,chain:i,unsignedTx:d}=a,[u,m]=l.useState(!1),f=l.useMemo(()=>{try{return JSON.parse(d)}catch{return null}},[d]),h=l.useMemo(()=>qg(i,c),[i,c]),v=l.useCallback(()=>{u||f&&h&&(it(async g=>{m(!0);try{const b=await Au({walletId:h,password:g,from:c,chainId:i,unsignedTx:f}),x=new CustomEvent("miniapp-sign-transaction-confirm",{detail:{confirmed:!0,signedTx:b}});return window.dispatchEvent(x),s(),!0}catch(b){return console.error("[MiniappSignTransactionJob] signTransaction failed:",b),!1}finally{m(!1)}}),n("WalletLockConfirmJob",{title:t("signTransaction","")}))},[i,c,u,s,n,t,f,h]),y=l.useCallback(()=>{const g=new CustomEvent("miniapp-sign-transaction-confirm",{detail:{confirmed:!1}});window.dispatchEvent(g),s()},[s]),p=l.useMemo(()=>{if(!f)return"";try{return JSON.stringify(f.data,null,2)}catch{return String(f.data)}},[f]);return e.jsx(ae,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Kt,{title:t("signTransaction",""),description:r||t("unknownDApp"," DApp"),appName:r,appIcon:o}),e.jsxs("div",{className:"space-y-4 p-4",children:[!f&&e.jsx("div",{className:"rounded-xl bg-destructive/10 p-3 text-sm text-destructive",children:t("invalidTransaction","")}),f&&!h&&e.jsx("div",{className:"rounded-xl bg-amber-50 p-3 text-sm text-amber-800 dark:bg-amber-950/30 dark:text-amber-200",children:t("signingAddressNotFound","")}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("network","")}),e.jsx("p",{className:"text-sm font-medium",children:i})]}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("signingAddress","")}),e.jsx("p",{className:"text-sm font-mono break-all",children:c})]}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("transaction","")}),e.jsx("div",{className:"max-h-44 overflow-y-auto",children:e.jsx("pre",{className:"whitespace-pre-wrap break-all font-mono text-xs",children:p})})]}),e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[e.jsx(Se,{className:"size-5 shrink-0 text-amber-600 mt-0.5"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:t("signTxWarning","")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:y,disabled:u,className:"bg-muted hover:bg-muted/80 disabled:opacity-50 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("cancel","")}),e.jsx("button",{onClick:v,disabled:u||!f||!h,className:M("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","disabled:opacity-50 flex items-center justify-center gap-2"),children:u?e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"size-4 animate-spin"}),t("signing","...")]}):t("sign","")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const bl=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(Hg,{})});bl.__docgenInfo={description:"",methods:[],displayName:"MiniappSignTransactionJob"};function fi(t){const s=Cn(t);if(s&&Xn[s])return Xn[s];try{return`Chain ${im(t)}`}catch{return t}}function pi(t){return Cn(t)}function Ug(){const{t}=L("common"),{pop:s}=K(),{fromChainId:n,toChainId:a,appName:r,appIcon:o}=re(),c=fi(n),i=fi(a),d=pi(n),u=pi(a),m=()=>{const h=new CustomEvent("chain-switch-confirm",{detail:{approved:!0,toChainId:a}});window.dispatchEvent(h),s()},f=()=>{const h=new CustomEvent("chain-switch-confirm",{detail:{approved:!1}});window.dispatchEvent(h),s()};return e.jsx(ae,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Kt,{title:t("switchNetwork",""),description:`${r||t("unknownDApp"," DApp")} ${t("requestsNetworkSwitch","")}`,appName:r,appIcon:o}),e.jsxs("div",{className:"flex items-center justify-center gap-4 px-6 py-8",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[d?e.jsx(kt,{chain:d,size:"lg"}):e.jsx("div",{className:"bg-muted flex size-12 items-center justify-center rounded-full",children:e.jsx(Se,{className:"text-muted-foreground size-6"})}),e.jsx("span",{className:"text-muted-foreground text-sm",children:c})]}),e.jsx(lo,{className:"text-primary size-8"}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[u?e.jsx(kt,{chain:u,size:"lg"}):e.jsx("div",{className:"bg-muted flex size-12 items-center justify-center rounded-full",children:e.jsx(Se,{className:"text-muted-foreground size-6"})}),e.jsx("span",{className:"font-medium",children:i})]})]}),e.jsx("div",{className:"bg-warning/10 border-warning/20 mx-4 mb-4 rounded-lg border p-3",children:e.jsx("p",{className:"text-warning text-sm",children:t("chainSwitchWarning","")})}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:f,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("cancel","")}),e.jsx("button",{onClick:m,className:"bg-primary hover:bg-primary/90 text-primary-foreground flex-1 rounded-xl py-3 font-medium transition-colors",children:t("confirm","")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const jl=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(Ug,{})});jl.__docgenInfo={description:"",methods:[],displayName:"ChainSwitchConfirmJob"};const Jg={"zh-CN":"","zh-TW":"",en:"English",ja:"",ko:"",ar:""},Vg={USD:"USD ($)",CNY:"CNY ()",EUR:"EUR ()",JPY:"JPY ()",KRW:"KRW ()"};function Xa(){const{navigate:t}=Z(),{push:s}=K(),{t:n}=L(["settings","common","security"]),a=be(),r=ps(),o=ha(),c=pa(),[i,d]=l.useState(!1),[u,m]=l.useState("loading");l.useEffect(()=>{async function y(){if(!a){m("unavailable");return}const p=a.chainAddresses.find(g=>g.chain==="bfmeta"||g.chain==="bfm");if(!p){m("unavailable");return}try{const g=Ge.getChainById(Gn.state,"bfmeta");if(!g){m("unavailable");return}const b=await sg(g,p.address);m(b?"set":"not_set")}catch{m("unavailable")}}y()},[a]);const f=()=>n(`settings:appearance.${c}`),h=()=>{switch(u){case"loading":return"...";case"set":return n("security:twoStepSecret.alreadySet");case"not_set":return n("security:twoStepSecret.notSet");default:return n("settings:notSupported")}},v=async()=>{if(u!=="not_set"||!a)return;const y=a.chainAddresses.find(b=>b.chain==="bfmeta"||b.chain==="bfm");if(!y)return;const p=Ge.getChainById(Gn.state,"bfmeta");if(!p)return;const g=await tg(p);pg(async(b,x)=>{const j=await eg({chainConfig:p,walletId:a.id,password:x,fromAddress:y.address,newTwoStepSecret:b});return j.status==="ok"?(m("set"),{success:!0,txHash:j.txHash}):j.status==="password"?{success:!1,error:n("security:passwordConfirm.verifying")}:j.status==="already_set"?(m("set"),{success:!1,error:n("security:twoStepSecret.alreadySet")}):{success:!1,error:j.message}},g??void 0,async()=>{const{getAddressInfo:b}=await cs(async()=>{const{getAddressInfo:w}=await import("./index-B2mNTGNA.js").then(S=>S.y);return{getAddressInfo:w}},__vite__mapDeps([2,3,4,5,1,6,7,8,9,10]),import.meta.url),x=p.apis.find(w=>w.type==="biowallet-v1"),j=x?.endpoint,N=x?.config?.path??p.id;if(!j)return!1;try{return!!(await b(j,N,y.address)).secondPublicKey}catch{return!1}}),s("SetTwoStepSecretJob",{chainName:"BioForest Chain"})};return e.jsxs("div",{className:"bg-muted/30 flex h-full flex-col overflow-y-auto",children:[e.jsx(U,{title:n("common:a11y.tabSettings")}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[a&&e.jsxs("div",{className:"bg-card flex items-center gap-4 rounded-xl p-4 shadow-sm",children:[e.jsx("div",{className:"bg-primary/10 flex size-14 items-center justify-center rounded-full text-2xl",children:a.name.slice(0,1)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"font-semibold",children:a.name}),e.jsx("p",{className:"text-muted-foreground text-sm",children:n("settings:chainAddressCount",{count:a.chainAddresses.length})})]})]}),e.jsxs(ss,{title:n("settings:sections.walletManagement"),children:[e.jsx(ve,{icon:e.jsx(wa,{size:20}),label:n("settings:items.walletManagement"),onClick:()=>t({to:`/wallet/${a?.id??""}`})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(ve,{icon:e.jsx(ho,{size:20}),label:n("settings:items.walletChains"),onClick:()=>t({to:"/settings/wallet-chains"}),testId:"wallet-chains-button"}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(ve,{icon:e.jsx(Cm,{size:20}),label:n("settings:items.addressBook"),onClick:()=>t({to:"/address-book"}),testId:"address-book-button"})]}),e.jsxs(ss,{title:n("settings:sections.security"),children:[e.jsx(ve,{icon:e.jsx(yn,{size:20}),label:n("settings:items.appLock"),value:n("settings:notSupported"),disabled:!0}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(ve,{icon:e.jsx(Ca,{size:20}),label:n("settings:items.viewMnemonic"),onClick:()=>t({to:"/settings/mnemonic"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(ve,{icon:e.jsx(ka,{size:20}),label:n("settings:items.changeWalletLock"),onClick:()=>t({to:"/settings/wallet-lock"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(ve,{icon:e.jsx(gu,{size:20}),label:n("security:twoStepSecret.setup"),value:h(),onClick:v,disabled:u==="set"||u==="unavailable",testId:"set-pay-password-button"})]}),e.jsxs(ss,{title:n("settings:sections.preferences"),children:[e.jsx(ve,{icon:e.jsx(Gm,{size:20}),label:n("settings:items.language"),value:Jg[r],onClick:()=>t({to:"/settings/language"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(ve,{icon:e.jsx(Bm,{size:20}),label:n("settings:items.currency"),value:Vg[o],onClick:()=>t({to:"/settings/currency"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(ve,{icon:e.jsx(sf,{size:20}),label:n("settings:items.appearance"),value:f(),onClick:()=>d(!0)}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(ve,{icon:e.jsx(ef,{size:20}),label:n("settings:items.chainConfig"),onClick:()=>t({to:"/settings/chains"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(ve,{icon:e.jsx(go,{size:20}),label:"",onClick:()=>t({to:"/settings/sources"})})]}),e.jsxs(ss,{title:n("settings:sections.about"),children:[e.jsx(ve,{icon:e.jsx(Eu,{size:20}),label:n("settings:items.aboutApp"),value:"v1.0.0",onClick:()=>{}}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(ve,{icon:e.jsx(fo,{size:20}),label:n("settings:items.storage"),onClick:()=>t({to:"/settings/storage"}),testId:"storage-button"})]}),e.jsx("div",{className:"h-[var(--tab-bar-height)]"})]}),e.jsx($c,{open:i,onOpenChange:d})]})}Xa.__docgenInfo={description:"",methods:[],displayName:"SettingsPage"};function Nl(){return e.jsx(Xa,{})}Nl.__docgenInfo={description:`SettingsTab - 

 SettingsPage `,methods:[],displayName:"SettingsTab"};function Kg(t,s){let n=t.toString();const a=n.startsWith("-");a&&(n=n.slice(1)),n=n.padStart(s,"0");let[r,o]=[n.slice(0,n.length-s),n.slice(n.length-s)];return o=o.replace(/(0+)$/,""),`${a?"-":""}${r||"0"}${o?`.${o}`:""}`}const wl=({params:t})=>{const{push:s}=K(),[n,a]=l.useState(t.tab||"wallet");return l.useEffect(()=>(Tu(),sr().setPermissionRequestCallback(async(r,o,c)=>{const i=Iu.state.apps.get(r)?.manifest.icon;return new Promise(d=>{const u=window.setTimeout(()=>d(!1),3e4),m=f=>{window.clearTimeout(u);const h=f.detail;d(h?.approved===!0)};window.addEventListener("permission-request",m,{once:!0}),s("PermissionRequestJob",{appName:o,appIcon:i,permissions:JSON.stringify(c)})})}),nr(async r=>{const o=r?.app?.name,c=r?.app?.icon;return new Promise(i=>{const d=window.setTimeout(()=>i(null),3e4),u=()=>{window.clearTimeout(d),window.removeEventListener("wallet-picker-select",m),window.removeEventListener("wallet-picker-cancel",f)},m=h=>{u();const v=h.detail;i({address:v.address,chain:v.chain,name:v.name})},f=()=>{u(),i(null)};window.addEventListener("wallet-picker-select",m),window.addEventListener("wallet-picker-cancel",f),s("WalletPickerJob",{chain:r?.chain,exclude:r?.exclude,...o?{appName:o}:{},...c?{appIcon:c}:{}})})}),ar(()=>{const r=me.state,o=_e.getCurrentWallet(r);return o?o.chainAddresses.map(c=>({address:c.address,chain:c.chain,name:o.name})):[]}),rr(async r=>new Promise(o=>{const c=window.setTimeout(()=>o(null),6e4),i=d=>{window.clearTimeout(c);const u=d.detail;if(u?.confirmed&&u.signature&&u.publicKey){o({signature:u.signature,publicKey:u.publicKey});return}o(null)};window.addEventListener("signing-confirm",i,{once:!0}),s("SigningConfirmJob",{message:r.message,address:r.address,appName:r.app.name,appIcon:r.app.icon??"",chainName:"bioforest"})})),ir(async r=>new Promise(o=>{const c=window.setTimeout(()=>o(null),6e4),i=d=>{window.clearTimeout(c);const u=d.detail;if(u?.confirmed&&u.txHash){o({txHash:u.txHash});return}o(null)};window.addEventListener("miniapp-transfer-confirm",i,{once:!0}),s("MiniappTransferConfirmJob",{appName:r.app.name,appIcon:r.app.icon??"",from:r.from,to:r.to,amount:r.amount,chain:r.chain,...r.asset?{asset:r.asset}:{}})})),or(async r=>new Promise(o=>{const c=window.setTimeout(()=>o(null),6e4),i=d=>{window.clearTimeout(c);const u=d.detail;if(u?.confirmed&&u.signedTx){o(u.signedTx);return}o(null)};window.addEventListener("miniapp-sign-transaction-confirm",i,{once:!0}),s("MiniappSignTransactionJob",{appName:r.app.name,appIcon:r.app.icon??"",from:r.from,chain:r.chain,unsignedTx:JSON.stringify(r.unsignedTx)})})),cr(async r=>{const o=r.app?.name,c=r.app?.icon;return new Promise(i=>{const d=window.setTimeout(()=>i(null),3e4),u=()=>{window.clearTimeout(d),window.removeEventListener("wallet-picker-select",m),window.removeEventListener("wallet-picker-cancel",f)},m=h=>{u();const v=h.detail;i({address:v.address,chain:v.chain,name:v.name})},f=()=>{u(),i(null)};window.addEventListener("wallet-picker-select",m),window.addEventListener("wallet-picker-cancel",f),s("WalletPickerJob",{chain:r.chainId,...o?{appName:o}:{},...c?{appIcon:c}:{}})})}),mr(async r=>new Promise(o=>{const c=window.setTimeout(()=>o(!1),3e4),i=d=>{window.clearTimeout(c);const u=d.detail;o(u?.approved===!0)};window.addEventListener("chain-switch-confirm",i,{once:!0}),s("ChainSwitchConfirmJob",{fromChainId:r.fromChainId,toChainId:r.toChainId,appName:r.appName,appIcon:r.appIcon})})),lr(async r=>new Promise(o=>{const c=window.setTimeout(()=>o(null),6e4),i=d=>{window.clearTimeout(c);const u=d.detail;if(u?.confirmed&&u.signature){o({signature:u.signature});return}o(null)};window.addEventListener("signing-confirm",i,{once:!0}),s("SigningConfirmJob",{message:r.message,address:r.address,appName:r.appName,chainName:"ethereum"})})),dr(async r=>{const{from:o,to:c,value:i,chainId:d}=r.tx;if(!o||!c)return null;const u=BigInt(i??"0x0"),m=Kg(u,18),f=d?Cn(d):null;return new Promise(h=>{const v=window.setTimeout(()=>h(null),6e4),y=p=>{window.clearTimeout(v);const g=p.detail;if(g?.confirmed&&g.txHash){h({txHash:g.txHash});return}h(null)};window.addEventListener("miniapp-transfer-confirm",y,{once:!0}),s("MiniappTransferConfirmJob",{appName:r.appName,from:o,to:c,amount:m,chain:f??"ethereum"})})}),ur(async r=>{const o=r?.app?.name,c=r?.app?.icon;return new Promise(i=>{const d=window.setTimeout(()=>i(null),3e4),u=()=>{window.clearTimeout(d),window.removeEventListener("wallet-picker-select",m),window.removeEventListener("wallet-picker-cancel",f)},m=h=>{u();const v=h.detail;i({address:v.address,chain:v.chain,name:v.name})},f=()=>{u(),i(null)};window.addEventListener("wallet-picker-select",m),window.addEventListener("wallet-picker-cancel",f),s("WalletPickerJob",{chain:"tron",...o?{appName:o}:{},...c?{appIcon:c}:{}})})}),()=>{sr().setPermissionRequestCallback(null),nr(null),cr(null),mr(null),lr(null),dr(null),ur(null),ar(null),rr(null),ir(null),or(null)}),[s]),e.jsx(Y,{children:e.jsx(tu,{children:e.jsxs("div",{className:"bg-background relative h-dvh",children:[e.jsx(l.Activity,{mode:n==="wallet"?"visible":"hidden",children:e.jsx(Ec,{})}),e.jsx("div",{style:{display:n==="ecosystem"?"contents":"none"},children:e.jsx(Wc,{})}),e.jsx(l.Activity,{mode:n==="settings"?"visible":"hidden",children:e.jsx(Nl,{})}),e.jsx(su,{activeTab:n,onTabChange:a})]})})})};wl.__docgenInfo={description:"",methods:[],displayName:"MainTabsActivity"};function Cl(){const{t}=L("wallet"),{navigate:s,goBack:n}=Z(),{push:a}=K(),r=le(me,m=>m.wallets),o=le(me,m=>m.currentWalletId),c=l.useCallback(m=>{de.setCurrentWallet(m)},[]),i=l.useCallback(m=>{s({to:`/wallet/${m}`})},[s]),d=l.useCallback(()=>{a("WalletAddJob",{})},[a]),u=l.useCallback(()=>{n()},[n]);return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(U,{title:t("list.title"),onBack:u,rightAction:e.jsx("button",{onClick:d,className:M("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":t("add"),children:e.jsx(nt,{className:"size-5"})})}),e.jsx("div",{className:"flex-1 p-4",children:r.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[e.jsx("p",{className:"text-muted-foreground",children:t("list.empty")}),e.jsx("button",{onClick:d,className:M("bg-primary rounded-full px-6 py-2.5 text-sm font-medium text-primary-foreground","hover:bg-primary/90 active:bg-primary/80"),children:t("add")})]}):e.jsx("div",{className:"space-y-3",children:r.map(m=>e.jsx(Gg,{wallet:m,isActive:m.id===o,onSelect:()=>c(m.id),onDetail:()=>i(m.id),t},m.id))})})]})}function Gg({wallet:t,isActive:s,onSelect:n,onDetail:a,t:r}){const o=t.chainAddresses.reduce((c,i)=>c+i.tokens.reduce((d,u)=>d+u.fiatValue,0),0);return e.jsxs("div",{className:M("bg-card rounded-xl p-4 shadow-sm transition-colors",s&&"ring-primary ring-2"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:n,className:M("flex size-12 items-center justify-center rounded-full text-lg font-semibold",s?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),children:t.name.slice(0,1)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"truncate font-semibold",children:t.name}),s&&e.jsxs("span",{className:"text-primary flex items-center gap-1 text-xs",children:[e.jsx(fe,{className:"size-3"}),r("list.current")]})]}),e.jsx("p",{className:"text-muted-foreground text-sm",children:r("list.chainAddresses",{count:t.chainAddresses.length})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-semibold",children:["$",o.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})}),e.jsx("button",{onClick:a,className:M("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":r("list.viewDetail"),children:e.jsx(Ce,{className:"text-muted-foreground size-5"})})]})]}),e.jsx("p",{className:"text-muted-foreground mt-2 truncate font-mono text-xs",children:t.address})]})}Cl.__docgenInfo={description:"",methods:[],displayName:"WalletListPage"};const Sl=()=>e.jsx(Y,{children:e.jsx(Cl,{})});Sl.__docgenInfo={description:"",methods:[],displayName:"WalletListActivity"};function Qg(){const{t}=L("wallet"),{walletId:s,mode:n="default"}=re(),{goBack:a,navigate:r}=Z(),c=Pt().find(u=>u.id===s),i=()=>{r({to:"/",replace:!0})};if(!c)return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:t("detail.title"),onBack:a}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(wt,{variant:"error",children:t("detail.notFound")})})]});const d=t(n==="edit-only"?"detail.editTitle":"detail.title");return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:d,...n!=="edit-only"&&{onBack:a}}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsx(En,{mode:n,walletId:s,onEditOnlyComplete:i}),n==="default"&&e.jsx("div",{className:"mt-6",children:e.jsx(wt,{variant:"warning",children:t("detail.securityWarning")})})]})]})}const kl=({params:t})=>e.jsx(Y,{children:e.jsx(ee,{params:t,children:e.jsx(Qg,{})})});kl.__docgenInfo={description:"",methods:[],displayName:"WalletConfigActivity"};const Yg=["pattern","mnemonic","verify","chains","theme"];function Al(){const{goBack:t,navigate:s}=Z(),{t:n}=L("onboarding"),a=ms(),[r,o]=l.useState("pattern"),[c,i]=l.useState(""),[d]=l.useState(()=>{if(typeof window<"u"){const P=window.__E2E_MNEMONIC__;if(typeof P=="string"&&P.trim())return P.trim().split(/\s+/);if(Array.isArray(P)&&P.every(A=>typeof A=="string"))return P}return Ju()}),[u,m]=l.useState(!0),[f,h]=l.useState(!1),[v,y]=l.useState([]),[p,g]=l.useState(!1),[b,x]=l.useState(!1),[j,N]=l.useState(null),w=Yg.indexOf(r)+1;l.useEffect(()=>{!p&&a.length>0&&(y(eo(a)),g(!0))},[a,p]);const S=()=>{r==="mnemonic"?(o("pattern"),i("")):r==="verify"?o("mnemonic"):r==="chains"?o("verify"):r==="theme"||t()},C=P=>{i(P),o("mnemonic")},T=()=>{(f||!u)&&o("verify")},k=()=>{o("chains")},I=async()=>{if(!b){x(!0);try{const P=d.join(" "),D=(await Hi({mnemonic:P,selectedChainIds:v,chainConfigs:a})).map(({chainId:z,address:O,publicKey:H})=>({chain:z,address:O,publicKey:H??"",tokens:[]})),_=D[0];if(!_)throw new Error("No chain addresses derived");const B=Yn(_.address),E=await de.createWallet({name:n("create.defaultWalletName"),keyType:"mnemonic",address:_.address,chain:_.chain,chainAddresses:D,themeHue:B},P,c,B);N(E.id),o("theme")}catch(P){console.error(n("create.createFailed"),P)}finally{x(!1)}}},R=()=>{s({to:"/",replace:!0})};return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:n("create.title"),onBack:S}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(et,{total:5,current:w})}),e.jsxs("div",{className:"flex-1 p-4",children:[r==="pattern"&&e.jsx("div",{"data-testid":"pattern-step",children:e.jsx(ja,{onComplete:C,minPoints:4})}),r==="mnemonic"&&e.jsx("div",{"data-testid":"mnemonic-step",children:e.jsx(Xg,{mnemonic:d,hidden:u,copied:f,onToggleHidden:()=>m(!u),onCopy:()=>h(!0),onContinue:T})}),r==="verify"&&e.jsx("div",{"data-testid":"verify-step",children:e.jsx(Zg,{mnemonic:d,onContinue:k})}),r==="chains"&&e.jsx("div",{"data-testid":"chain-selector-step",children:e.jsx(ev,{chains:a,selectedChains:v,selectionCount:v.length,onSelectionChange:y,onComplete:I,completeLabel:n("create.nextStep"),isSubmitting:b})}),r==="theme"&&j&&e.jsx("div",{"data-testid":"theme-step",children:e.jsx(En,{mode:"edit-only",walletId:j,onEditOnlyComplete:R})})]})]})}function Xg({mnemonic:t,hidden:s,copied:n,onToggleHidden:a,onCopy:r,onContinue:o}){const{t:c}=L("onboarding"),i=n||!s;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(xs,{icon:e.jsx(ka,{className:"size-full"}),variant:"warning",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:c("create.backupMnemonic")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:c("create.backupHint")})]}),e.jsx(wt,{variant:"warning",children:c("create.mnemonicWarning")}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:c("create.mnemonicTitle")}),e.jsxs("button",{type:"button","data-testid":"toggle-mnemonic-button",onClick:a,className:"text-primary flex items-center gap-1 text-sm",children:[s?e.jsx(Ca,{className:"size-4"}):e.jsx(to,{className:"size-4"}),c(s?"create.mnemonicShow":"create.mnemonicHide")]})]}),e.jsx(Zi,{words:t,hidden:s,onCopy:r})]}),e.jsxs(Ee,{variant:"mint",className:"w-full","data-testid":"mnemonic-backed-up-button",disabled:!i,onClick:o,children:[c(i?"create.mnemonicBackedUp":"create.mnemonicViewFirst"),i&&e.jsx(Ce,{className:"ml-2 size-4"})]})]})}function Zg({mnemonic:t,onContinue:s}){const{t:n}=L(["onboarding","common"]),[a]=l.useState(()=>Array.from({length:t.length},(f,h)=>h).toSorted(()=>Math.random()-.5).slice(0,3).toSorted((f,h)=>f-h)),[r,o]=l.useState({}),c=a.every(u=>{const m=t[u],f=r[u];return m&&f&&f.toLowerCase()===m.toLowerCase()}),i=(u,m)=>{o(f=>({...f,[u]:m}))},d=u=>{const m=t[u],f=r[u];if(f&&m&&f.toLowerCase()!==m.toLowerCase())return n("create.wordIncorrect")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(xs,{icon:e.jsx(Qt,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:n("create.verifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("create.verifyDesc")})]}),e.jsx("div",{className:"space-y-4",children:a.map(u=>e.jsx(Su,{label:n("create.wordN",{n:u+1}),error:d(u),children:e.jsx(Pe,{"data-testid":`verify-word-input-${u}`,"data-verify-index":u,value:r[u]||"",onChange:m=>i(u,m.target.value),className:M(d(u)&&"border-destructive focus-visible:ring-destructive"),placeholder:n("create.wordNPlaceholder",{n:u+1}),autoCapitalize:"off",autoCorrect:"off"})},u))}),e.jsx(Ee,{variant:"mint",className:"w-full","data-testid":"verify-next-button",disabled:!c,onClick:s,children:n("common:next")})]})}function ev({chains:t,selectedChains:s,selectionCount:n,isSubmitting:a,completeLabel:r,onSelectionChange:o,onComplete:c}){const{t:i}=L(["onboarding","common"]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(xs,{icon:e.jsx(Qt,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:i("chainSelector.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:i("chainSelector.subtitle")})]}),t.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(ye,{})}):e.jsx(Sa,{"data-testid":"chain-selector",chains:t,selectedChains:s,onSelectionChange:o}),e.jsx(Ee,{variant:"mint",className:"w-full","data-testid":"chain-selector-complete-button",disabled:n===0||a,onClick:c,children:r})]})}Al.__docgenInfo={description:"",methods:[],displayName:"WalletCreatePage"};const Tl=()=>e.jsx(Y,{children:e.jsx(Al,{})});Tl.__docgenInfo={description:"",methods:[],displayName:"WalletCreateActivity"};const tv={ETH:{amount:"0.002",symbol:"ETH"},USDT:{amount:"0.003",symbol:"ETH"},USDC:{amount:"0.003",symbol:"ETH"},BTC:{amount:"0.0001",symbol:"BTC"},TRX:{amount:"1",symbol:"TRX"},BFM:{amount:"0.1",symbol:"BFM"}},hi={step:"input",asset:null,toAddress:"",amount:null,addressError:null,amountError:null,feeAmount:null,feeMinAmount:null,feeSymbol:"",feeLoading:!1,isSubmitting:!1,resultStatus:null,txHash:null,errorMessage:null};async function sv(t,s){const n=gs(t.id);if(!n.supportsFeeEstimate)throw new Error(`Chain ${t.id} does not support fee estimation`);return{amount:(await n.estimateFee({from:s,to:s,amount:ce.fromRaw("1",t.decimals,t.symbol)})).standard.amount,symbol:t.symbol}}async function nv({chainConfig:t,walletId:s,password:n,fromAddress:a,toAddress:r,amount:o}){let c;try{c=await fn.getMnemonic(s,n)}catch(i){return i instanceof pn&&i.code===hn.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:i instanceof Error?i.message:""}}if(!o.isPositive())return{status:"error",message:""};try{const i=gs(t.id);if(!i.supportsFullTransaction)return{status:"error",message:`: ${t.id}`};console.log("[submitWeb3Transfer] Starting transfer:",{chain:t.id,type:t.type,fromAddress:a,toAddress:r,amount:o.toRawString()});const d=Vd(c);console.log("[submitWeb3Transfer] Building transaction...");const u=await i.buildTransaction({from:a,to:r,amount:o});console.log("[submitWeb3Transfer] Signing transaction...");const m=await i.signTransaction(u,d);console.log("[submitWeb3Transfer] Broadcasting transaction...");const f=await i.broadcastTransaction(m);return console.log("[submitWeb3Transfer] SUCCESS! txHash:",f),{status:"ok",txHash:f}}catch(i){console.error("[submitWeb3Transfer] FAILED:",i);const d=i instanceof Error?i.message:String(i);return d.includes("insufficient")||d.includes("")?{status:"error",message:""}:d.includes("fee")||d.includes("")||d.includes("gas")?{status:"error",message:""}:d.includes("not yet implemented")||d.includes("not supported")?{status:"error",message:""}:{status:"error",message:d||""}}}function av(t,s){const n=gs(t.id);return n.supportsAddressValidation?!s||s.trim()===""?"":n.isValidAddress(s)?null:"":""}function Il(t,s){return t.trim()?s?om(t):Nu(t):!1}function rv(t,s){return t.trim()?Il(t,s)?null:"":""}function iv(t,s){return t?s?t.isPositive()?t.gt(s.amount)?"":null:"":null:""}function ov(t){const{toAddress:s,amount:n,asset:a,isBioforestChain:r,feeLoading:o}=t;return!a||!n||o?!1:s.trim()!==""&&Il(s,r)&&n.isPositive()&&n.lte(a.amount)}function cv(t,s,n){if(!t)return{status:"error",message:""};const a=s.amount;if(t.add(n).lte(a))return{status:"ok"};if(!t.eq(a))return{status:"error",message:""};const r=a.sub(n);return r.isPositive()?{status:"ok",adjustedAmount:r}:{status:"error",message:""}}async function lv(t){t(s=>({...s,step:"sending",isSubmitting:!0}));try{if(await new Promise(n=>setTimeout(n,2e3)),Math.random()>.2)return t(n=>({...n,step:"result",isSubmitting:!1,resultStatus:"success",txHash:`0x${Math.random().toString(16).slice(2)}${Math.random().toString(16).slice(2)}`,errorMessage:null})),{status:"ok"};throw new Error("")}catch(s){return t(n=>({...n,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:s instanceof Error?s.message:""})),{status:"error"}}}function dv(t={}){const{initialAsset:s,useMock:n=!0,walletId:a,fromAddress:r,chainConfig:o}=t,[c,i]=l.useState({...hi,asset:s??null}),d=o?.chainKind==="bioforest",u=o?.chainKind==="evm"||o?.chainKind==="tron"||o?.chainKind==="bitcoin",m=l.useCallback(S=>u&&o?av(o,S):rv(S,d),[d,u,o]),f=l.useCallback((S,C)=>iv(S,C),[]),h=l.useCallback(S=>{i(C=>({...C,toAddress:S,addressError:null}))},[]),v=l.useCallback(S=>{i(C=>({...C,amount:S,amountError:null}))},[]),y=l.useCallback(S=>{i(C=>{if(!C.feeAmount)return C;const T=ce.fromFormatted(S,C.feeAmount.decimals,C.feeAmount.symbol);return{...C,feeAmount:T}})},[]),p=l.useCallback(S=>{if(i(T=>({...T,asset:S,feeLoading:!0})),n||!d&&!u||!o||!r){setTimeout(()=>{const T=tv[S.assetType]??{amount:"0.001",symbol:S.assetType},k=ce.fromFormatted(T.amount,S.decimals,T.symbol);i(I=>({...I,feeAmount:k,feeMinAmount:k,feeSymbol:T.symbol,feeLoading:!1}))},300);return}(async()=>{try{const T=u?await sv(o,r):await Zx(o,r);i(k=>({...k,feeAmount:T.amount,feeMinAmount:T.amount,feeSymbol:T.symbol,feeLoading:!1}))}catch(T){i(k=>({...k,feeLoading:!1,errorMessage:T instanceof Error?T.message:""}))}})()},[o,r,d,u,n]),g=l.useMemo(()=>ov({toAddress:c.toAddress,amount:c.amount,asset:c.asset,isBioforestChain:d,feeLoading:c.feeLoading}),[d,c.amount,c.asset,c.toAddress,c.feeLoading]),b=l.useCallback(()=>{const S=m(c.toAddress),C=c.asset?f(c.amount,c.asset):"";if(S||C)return i(T=>({...T,addressError:S,amountError:C})),!1;if(c.asset&&c.feeAmount&&c.amount){const T=cv(c.amount,c.asset,c.feeAmount);if(T.status==="error")return i(k=>({...k,amountError:T.message})),!1;T.adjustedAmount&&i(k=>({...k,amount:T.adjustedAmount??k.amount}))}return i(T=>({...T,step:"confirm",addressError:null,amountError:null})),!0},[c.toAddress,c.amount,c.asset,c.feeAmount,m,f]),x=l.useCallback(()=>{i(S=>({...S,step:"input"}))},[]),j=l.useCallback(async S=>{if(console.log("[useSend.submit] Called with:",{useMock:n,chainKind:o?.chainKind,walletId:a,fromAddress:r}),n)return console.log("[useSend.submit] Using mock transfer"),(await lv(i)).status==="ok"?{status:"ok"}:{status:"error"};if(!o)return console.log("[useSend.submit] No chain config"),i(I=>({...I,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:""})),{status:"error"};if(o.chainKind==="evm"||o.chainKind==="tron"||o.chainKind==="bitcoin"){if(console.log("[useSend.submit] Using Web3 transfer for:",o.chainKind),!a||!r||!c.asset||!c.amount)return i(R=>({...R,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:""})),{status:"error"};i(R=>({...R,step:"sending",isSubmitting:!0,errorMessage:null}));const I=await nv({chainConfig:o,walletId:a,password:S,fromAddress:r,toAddress:c.toAddress,amount:c.amount});return I.status==="password"?(i(R=>({...R,step:"confirm",isSubmitting:!1})),{status:"password"}):I.status==="error"?(i(R=>({...R,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:I.message})),{status:"error"}):(i(R=>({...R,step:"result",isSubmitting:!1,resultStatus:"success",txHash:I.txHash,errorMessage:null})),{status:"ok",txHash:I.txHash})}if(o.chainKind!=="bioforest")return console.log("[useSend.submit] Chain type not supported:",o.chainKind),i(I=>({...I,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:`: ${o.chainKind}`})),{status:"error"};if(!a||!r||!c.asset)return i(I=>({...I,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:""})),{status:"error"};const C=m(c.toAddress),T=f(c.amount,c.asset);if(C||T)return i(I=>({...I,addressError:C,amountError:T})),{status:"error"};if(i(I=>({...I,step:"sending",isSubmitting:!0,errorMessage:null})),!c.amount)return i(I=>({...I,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:""})),{status:"error"};const k=await li({chainConfig:o,walletId:a,password:S,fromAddress:r,toAddress:c.toAddress,amount:c.amount,assetType:c.asset.assetType,fee:c.feeAmount??void 0});return k.status==="password"?(i(I=>({...I,step:"confirm",isSubmitting:!1})),{status:"password"}):k.status==="password_required"?(i(I=>({...I,step:"confirm",isSubmitting:!1})),{status:"two_step_secret_required",secondPublicKey:k.secondPublicKey}):k.status==="error"?(i(I=>({...I,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:k.message})),{status:"error"}):(i(I=>({...I,step:"result",isSubmitting:!1,resultStatus:"success",txHash:k.txHash,errorMessage:null})),{status:"ok",txHash:k.txHash})},[o,r,c.amount,c.asset,c.toAddress,n,m,f,a]),N=l.useCallback(async(S,C)=>{if(!o||!a||!r)return{status:"error"};if(i(k=>({...k,step:"sending",isSubmitting:!0,resultStatus:null,txHash:null,errorMessage:null})),!c.amount||!c.asset)return i(k=>({...k,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:""})),{status:"error"};const T=await li({chainConfig:o,walletId:a,password:S,fromAddress:r,toAddress:c.toAddress,amount:c.amount,assetType:c.asset.assetType,fee:c.feeAmount??void 0,twoStepSecret:C});return T.status==="password"?(i(k=>({...k,step:"confirm",isSubmitting:!1})),{status:"password"}):T.status==="error"?(i(k=>({...k,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:T.message})),{status:"error"}):T.status==="password_required"?(i(k=>({...k,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:""})),{status:"error"}):(i(k=>({...k,step:"result",isSubmitting:!1,resultStatus:"success",txHash:T.txHash,errorMessage:null})),{status:"ok",txHash:T.txHash})},[o,r,c.amount,c.toAddress,a]),w=l.useCallback(()=>{i({...hi,asset:s??null})},[s]);return{state:c,setToAddress:h,setAmount:v,setAsset:p,setFee:y,goToConfirm:b,goBack:x,submit:j,submitWithTwoStepSecret:N,reset:w,canProceed:g}}const uv={ethereum:"Ethereum",bitcoin:"Bitcoin",tron:"Tron",binance:"BSC",bfmeta:"BFMeta",ccchain:"CCChain",pmchain:"PMChain",bfchainv2:"BFChain V2",btgmeta:"BTGMeta",biwmeta:"BIWMeta",ethmeta:"ETHMeta",malibu:"Malibu"};function Pl(){const{t}=L(["transaction","common","security"]),{goBack:s}=Z(),{push:n}=K(),a=at(),r=An(),o=l.useRef(!1),{address:c,amount:i,assetType:d,assetLocked:u}=re(),m=u==="true",f=Le(),h=be(),v=Sn(),y=st(),p=y.snapshot?Ge.getChainById(y,f):null,g=p?.name??uv[f]??f,b=kn(),x=l.useMemo(()=>{if(!p)return null;if(d){const ie=b.find(je=>je.symbol.toUpperCase()===d.toUpperCase());return ie?{assetType:ie.symbol,name:ie.name,amount:ce.fromFormatted(ie.balance,ie.decimals??p.decimals,ie.symbol),decimals:ie.decimals??p.decimals,logoUrl:ie.icon}:null}const G=b.find(ie=>ie.symbol===p.symbol)?.balance??"0";return{assetType:p.symbol,name:p.name,amount:ce.fromFormatted(G,p.decimals,p.symbol),decimals:p.decimals}},[p,b,d]),{state:j,setToAddress:N,setAmount:w,setAsset:S,setFee:C,goToConfirm:T,submit:k,submitWithTwoStepSecret:I,reset:R,canProceed:P}=dv({initialAsset:x??void 0,useMock:!1,walletId:h?.id,fromAddress:v?.address,chainConfig:p}),A=l.useMemo(()=>j.asset?{symbol:j.asset.assetType,name:j.asset.name??j.asset.assetType,balance:j.asset.amount.toFormatted(),decimals:j.asset.decimals,chain:f,icon:j.asset.logoUrl}:null,[j.asset,f]),D=l.useCallback(V=>{const G={assetType:V.symbol,name:V.name,amount:ce.fromFormatted(V.balance,V.decimals??p?.decimals??8,V.symbol),decimals:V.decimals??p?.decimals??8,logoUrl:V.icon};S(G)},[p?.decimals,S]);l.useEffect(()=>{x&&S(x)},[x,S]),l.useEffect(()=>{if(c&&!j.toAddress&&N(c),i&&!j.amount&&j.asset){const V=ce.tryFromFormatted(i,j.asset.decimals,j.asset.assetType);V&&w(V)}},[c,i,j.toAddress,j.amount,j.asset,N,w]),l.useEffect(()=>{const V=G=>{N(G.detail.address.address)};return window.addEventListener("contact-picker-select",V),()=>window.removeEventListener("contact-picker-select",V)},[N]),l.useEffect(()=>{if(j.resultStatus==="success"&&j.toAddress){const V=xn.getContactByAddress(Ft.state,j.toAddress);V&&fs.trackRecentContact(V.contact.id)}},[j.resultStatus,j.toAddress]);const _=l.useCallback(()=>{n("ContactPickerJob",{chainType:f})},[n,f]),B=j.asset?.amount??null,E=j.asset?.assetType??"TOKEN",z=l.useCallback(()=>{nm(({content:V,parsed:G})=>{let ie=V;(G.type==="address"||G.type==="payment")&&(ie=G.address),N(ie),r.impact("success"),a.show(t("sendPage.scanSuccess"))}),n("ScannerJob",{chainType:g??f})},[n,f,g,N,r,a,t]),O=()=>{T()&&(r.impact("light"),rl(async()=>{o.current||(o.current=!0,await r.impact("medium"),ol(async(V,G)=>{if(!G){const je=await k(V);return je.status==="password"?{status:"wallet_lock_invalid"}:je.status==="two_step_secret_required"?{status:"two_step_secret_required"}:je.status==="ok"?(o.current=!1,{status:"ok",txHash:je.txHash}):{status:"error",message:""}}const ie=await I(V,G);return ie.status==="ok"?(o.current=!1,{status:"ok",txHash:ie.txHash}):ie.status==="password"?{status:"two_step_secret_invalid",message:""}:{status:"error",message:ie.status==="error"?"":""}}),n("TransferWalletLockJob",{title:t("security:walletLock.verifyTitle")}))},{minFee:j.feeMinAmount?.toFormatted()??j.feeAmount?.toFormatted()??"0",onFeeChange:C}),n("TransferConfirmJob",{amount:j.amount?.toFormatted()??"0",symbol:E,toAddress:j.toAddress,feeAmount:j.feeAmount?.toFormatted()??"0",feeSymbol:j.feeSymbol,feeLoading:j.feeLoading?"true":"false"}))},H=()=>{j.resultStatus==="success"&&r.impact("success"),s()},te=()=>{R()},Q=l.useCallback(()=>{if(!j.txHash)return;const V=p?.explorer?.queryTx;if(!V){a.show(t("sendPage.explorerNotImplemented"));return}const G=V.replace(":hash",j.txHash).replace(":signature",j.txHash);window.open(G,"_blank","noopener,noreferrer")},[j.txHash,p?.explorer?.queryTx,a,t]);return!h||!v?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:t("sendPage.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("history.noWallet")})})]}):j.step==="result"||j.step==="sending"?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:t("sendPage.resultTitle")}),e.jsx(no,{status:j.step==="sending"?"pending":j.resultStatus??"pending",amount:j.amount?.toFormatted()??"0",symbol:E,toAddress:j.toAddress,txHash:j.txHash??void 0,errorMessage:j.errorMessage??void 0,onDone:H,onRetry:j.resultStatus==="failed"?te:void 0,onViewExplorer:j.resultStatus==="success"&&p?.explorer?.queryTx?Q:void 0})]}):e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:t("sendPage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(kt,{chain:f,size:"sm"}),e.jsx("span",{className:"text-sm font-medium",children:g})]}),v?.address&&e.jsxs("div",{className:"flex items-center justify-center gap-1 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[t("sendPage.from"),":"]}),e.jsxs("span",{className:"font-mono",children:[v.address.slice(0,8),"...",v.address.slice(-6)]})]})]}),b.length>1&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("sendPage.assetLabel","")}),e.jsx(Ki,{selectedAsset:A,assets:b,onSelect:D,disabled:m,testId:"send-asset-selector"})]}),e.jsx(wu,{label:t("sendPage.toAddressLabel"),value:j.toAddress,onChange:N,placeholder:t("sendPage.toAddressPlaceholder",{chain:g}),onScan:z,onContactPicker:_,chainType:f,error:j.addressError??void 0}),e.jsx(so,{label:t("sendPage.amountLabel"),value:j.amount??void 0,onChange:w,balance:B??void 0,symbol:E,error:j.amountError??void 0,fiatValue:j.amount?j.amount.toNumber().toFixed(2):void 0}),e.jsx(wt,{variant:"info",children:t("sendPage.networkWarning",{chain:g})}),e.jsx("div",{className:"pt-4",children:e.jsxs(Ee,{variant:"mint",className:"w-full","data-testid":"send-continue-button",disabled:!P,onClick:O,children:[t("sendPage.continue"),e.jsx(Ce,{className:"-mr-4 ml-2 size-4"})]})})]})]})}Pl.__docgenInfo={description:"",methods:[],displayName:"SendPage"};const El=({params:t})=>e.jsx(Y,{children:e.jsx(ee,{params:t,children:e.jsx($i,{children:e.jsx(Pl,{})})})});El.__docgenInfo={description:"",methods:[],displayName:"SendActivity"};const xi={step:"input",asset:null,amount:null,amountError:null,recipientAddress:null,feeAmount:null,feeMinAmount:null,feeSymbol:"",feeLoading:!1,isSubmitting:!1,resultStatus:null,txHash:null,errorMessage:null},es={amount:"0.001",symbol:"BFM"};function mv(t,s){if(!t||!s)return null;if(!t.isPositive())return"";const n=s.amount;return t.gt(n)?"":null}function fv(t={}){const{initialAsset:s,assetLocked:n=!1,useMock:a=!0,walletId:r,fromAddress:o,chainConfig:c}=t,[i,d]=l.useState({...xi,asset:s??null}),u=c?.chainKind==="bioforest",m=l.useCallback((j,N)=>mv(j,N),[]),f=l.useCallback(j=>{d(N=>({...N,amount:j,amountError:null}))},[]),h=l.useCallback(j=>{if(d(w=>({...w,asset:j,amount:null,amountError:null,feeLoading:!0,recipientAddress:null})),a||!u||!c||!o){setTimeout(()=>{d(w=>({...w,recipientAddress:"mock_apply_address",feeAmount:ce.fromFormatted(es.amount,j.decimals,es.symbol),feeMinAmount:ce.fromFormatted(es.amount,j.decimals,es.symbol),feeSymbol:c?.symbol??es.symbol,feeLoading:!1}))},300);return}(async()=>{try{const w=await gl(c,j.assetType,o);if(!w){d(C=>({...C,feeLoading:!1,errorMessage:""}));return}const S=await vl(c,j.assetType,"1");d(C=>({...C,recipientAddress:w,feeAmount:S.amount,feeMinAmount:S.amount,feeSymbol:S.symbol,feeLoading:!1}))}catch(w){d(S=>({...S,feeLoading:!1,errorMessage:w instanceof Error?w.message:""}))}})()},[c,o,u,a]);l.useEffect(()=>{s&&!i.recipientAddress&&h(s)},[s,h,i.recipientAddress]);const v=l.useMemo(()=>!!(i.asset&&i.amount&&i.amount.isPositive()&&i.recipientAddress&&!i.feeLoading),[i.amount,i.asset,i.recipientAddress,i.feeLoading]),y=l.useCallback(()=>{const j=m(i.amount,i.asset);return j?(d(N=>({...N,amountError:j})),!1):i.recipientAddress?(d(N=>({...N,step:"confirm",amountError:null})),!0):(d(N=>({...N,errorMessage:""})),!1)},[i.amount,i.asset,i.recipientAddress,m]),p=l.useCallback(()=>{d(j=>({...j,step:"input"}))},[]),g=l.useCallback(async j=>{if(console.log("[useBurn.submit] Called with:",{useMock:a,chainKind:c?.chainKind,walletId:r,fromAddress:o}),a)return console.log("[useBurn.submit] Using mock burn"),d(w=>({...w,step:"burning",isSubmitting:!0})),await new Promise(w=>setTimeout(w,1500)),d(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"success",txHash:`mock_burn_tx_${Date.now()}`})),{status:"ok",txHash:`mock_burn_tx_${Date.now()}`};if(!c||c.chainKind!=="bioforest")return d(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:" BioForest "})),{status:"error",message:" BioForest "};if(!r||!o||!i.asset||!i.amount||!i.recipientAddress)return d(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:""})),{status:"error",message:""};d(w=>({...w,step:"burning",isSubmitting:!0,errorMessage:null}));const N=await mn({chainConfig:c,walletId:r,password:j,fromAddress:o,recipientAddress:i.recipientAddress,assetType:i.asset.assetType,amount:i.amount,fee:i.feeAmount??void 0});return N.status==="password"?(d(w=>({...w,step:"confirm",isSubmitting:!1})),{status:"password"}):N.status==="password_required"?(d(w=>({...w,step:"confirm",isSubmitting:!1})),{status:"two_step_secret_required",secondPublicKey:N.secondPublicKey}):N.status==="error"?(d(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:N.message})),{status:"error",message:N.message}):(d(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"success",txHash:N.txHash})),{status:"ok",txHash:N.txHash})},[c,o,i.amount,i.asset,i.feeAmount,i.recipientAddress,a,r]),b=l.useCallback(async(j,N)=>{if(!c||!r||!o||!i.asset||!i.amount||!i.recipientAddress)return{status:"error",message:""};d(S=>({...S,step:"burning",isSubmitting:!0,errorMessage:null}));const w=await mn({chainConfig:c,walletId:r,password:j,fromAddress:o,recipientAddress:i.recipientAddress,assetType:i.asset.assetType,amount:i.amount,fee:i.feeAmount??void 0,twoStepSecret:N});return w.status==="password"?(d(S=>({...S,step:"confirm",isSubmitting:!1})),{status:"password"}):w.status==="error"?(d(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:w.message})),{status:"error",message:w.message}):(d(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"success",txHash:w.txHash})),{status:"ok",txHash:w.txHash})},[c,o,i.amount,i.asset,i.feeAmount,i.recipientAddress,r]),x=l.useCallback(()=>{d({...xi,asset:s??null})},[s]);return{state:i,setAmount:f,setAsset:h,goToConfirm:y,goBack:p,submit:g,submitWithTwoStepSecret:b,reset:x,canProceed:v,assetLocked:n}}const pv={ethereum:"Ethereum",bitcoin:"Bitcoin",tron:"Tron",binance:"BSC",bfmeta:"BFMeta",ccchain:"CCChain",pmchain:"PMChain",bfchainv2:"BFChain V2",btgmeta:"BTGMeta",biwmeta:"BIWMeta",ethmeta:"ETHMeta",malibu:"Malibu"};function gi(t){return{assetType:t.symbol,name:t.name,amount:ce.fromFormatted(t.balance,t.decimals??8,t.symbol),decimals:t.decimals??8,logoUrl:t.icon}}function hv(t,s){return{symbol:t.assetType,name:t.name??t.assetType,balance:t.amount.toFormatted(),decimals:t.decimals,chain:s,icon:t.logoUrl}}function _l(){const{t}=L(["transaction","common","security"]),{goBack:s}=Z(),{push:n}=K(),a=at(),r=An(),o=l.useRef(!1),{assetType:c,assetLocked:i}=re(),d=Le(),u=be(),m=Sn(),f=st(),h=f.snapshot?Ge.getChainById(f,d):null,v=h?.name??pv[d]??d,y=kn(),p=l.useMemo(()=>h?y.filter(O=>O.symbol.toUpperCase()!==h.symbol.toUpperCase()):[],[y,h]),g=l.useMemo(()=>{if(!c||p.length===0)return null;const O=p.find(H=>H.symbol.toUpperCase()===c.toUpperCase());return O?gi(O):null},[c,p]),b=i==="true",{state:x,setAmount:j,setAsset:N,goToConfirm:w,submit:S,submitWithTwoStepSecret:C,reset:T,canProceed:k}=fv({initialAsset:g??void 0,assetLocked:b,useMock:!1,walletId:u?.id,fromAddress:m?.address,chainConfig:h}),I=l.useCallback(O=>{N(gi(O))},[N]),R=l.useMemo(()=>x.asset?hv(x.asset,d):null,[x.asset,d]),P=x.asset?.amount??null,A=x.asset?.assetType??"TOKEN",D=()=>{w()&&(r.impact("light"),rl(async()=>{o.current||(o.current=!0,await r.impact("medium"),ol(async(O,H)=>{if(!H){const Q=await S(O);return Q.status==="password"?{status:"wallet_lock_invalid"}:Q.status==="two_step_secret_required"?{status:"two_step_secret_required"}:Q.status==="ok"?(o.current=!1,{status:"ok",txHash:Q.txHash}):{status:"error",message:""}}const te=await C(O,H);return te.status==="ok"?(o.current=!1,{status:"ok",txHash:te.txHash}):te.status==="password"?{status:"two_step_secret_invalid",message:""}:{status:"error",message:te.status==="error"?"":""}}),n("TransferWalletLockJob",{title:t("security:walletLock.verifyTitle")}))},{minFee:x.feeMinAmount?.toFormatted()??x.feeAmount?.toFormatted()??"0"}),n("TransferConfirmJob",{amount:x.amount?.toFormatted()??"0",symbol:A,toAddress:x.recipientAddress??"",feeAmount:x.feeAmount?.toFormatted()??"0",feeSymbol:x.feeSymbol,feeLoading:x.feeLoading?"true":"false"}))},_=()=>{x.resultStatus==="success"&&r.impact("success"),s()},B=()=>{T()},E=l.useCallback(()=>{if(!x.txHash)return;const O=h?.explorer?.queryTx;if(!O){a.show(t("sendPage.explorerNotImplemented"));return}const H=O.replace(":hash",x.txHash).replace(":signature",x.txHash);window.open(H,"_blank","noopener,noreferrer")},[x.txHash,h?.explorer?.queryTx,a,t]),z=h?.chainKind==="bioforest";return!u||!m?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:t("destroyPage.title",""),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("history.noWallet")})})]}):z?x.step==="result"||x.step==="burning"?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:t("destroyPage.resultTitle","")}),e.jsx(no,{status:x.step==="burning"?"pending":x.resultStatus??"pending",amount:x.amount?.toFormatted()??"0",symbol:A,toAddress:x.recipientAddress??"",txHash:x.txHash??void 0,errorMessage:x.errorMessage??void 0,onDone:_,onRetry:x.resultStatus==="failed"?B:void 0,onViewExplorer:x.resultStatus==="success"&&h?.explorer?.queryTx?E:void 0})]}):e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:t("destroyPage.title",""),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(kt,{chain:d,size:"sm"}),e.jsx("span",{className:"text-sm font-medium",children:v})]}),m?.address&&e.jsxs("div",{className:"flex items-center justify-center gap-1 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[t("sendPage.from"),":"]}),e.jsxs("span",{className:"font-mono",children:[m.address.slice(0,8),"...",m.address.slice(-6)]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("destroyPage.assetLabel","")}),e.jsx(Ki,{selectedAsset:R,assets:p,onSelect:I,disabled:b,excludeAssets:h?[h.symbol]:[],testId:"destroy-asset-selector"}),p.length===0&&e.jsx("p",{className:"text-xs text-muted-foreground",children:t("destroyPage.noDestroyableAssets","")})]}),x.asset&&e.jsx(so,{label:t("destroyPage.amountLabel",""),value:x.amount??void 0,onChange:j,balance:P??void 0,symbol:A,error:x.amountError??void 0}),e.jsx(wt,{variant:"warning",children:t("destroyPage.warning","")}),x.feeAmount&&e.jsx("div",{className:"bg-muted/50 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:t("sendPage.fee","")}),e.jsxs("span",{className:"font-medium",children:[x.feeAmount.toFormatted()," ",x.feeSymbol]})]})}),e.jsx("div",{className:"pt-4",children:e.jsxs(Ee,{variant:"mint",className:"w-full","data-testid":"destroy-continue-button",disabled:!k||p.length===0,onClick:D,children:[e.jsx(Hs,{className:"-ml-4 mr-2 size-4"}),t("destroyPage.confirm","")]})})]})]}):e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:t("destroyPage.title",""),onBack:s}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx(Hs,{className:"size-16 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground text-center",children:t("destroyPage.notSupported","")})]})]})}_l.__docgenInfo={description:"",methods:[],displayName:"DestroyPage"};const Ml=({params:t})=>e.jsx(Y,{children:e.jsx(ee,{params:t,children:e.jsx($i,{children:e.jsx(_l,{})})})});Ml.__docgenInfo={description:"",methods:[],displayName:"DestroyActivity"};const xv={ethereum:"Ethereum",bitcoin:"Bitcoin",tron:"Tron",binance:"BSC",bfmeta:"BFMeta",ccchain:"CCChain",pmchain:"PMChain",bfchainv2:"BFChain V2",btgmeta:"BTGMeta",biwmeta:"BIWMeta",ethmeta:"ETHMeta",malibu:"Malibu"};function Rl(){const{t}=L("transaction"),{goBack:s}=Z(),n=Ta(),a=at(),r=An(),o=Sn(),c=Le(),i=xv[c]??c,[d,u]=l.useState(!1),m=o?.address||"",f=async()=>{m&&(await n.write({text:m}),await r.impact("light"),u(!0),a.show(t("receivePage.addressCopied")),setTimeout(()=>u(!1),2e3))},h=async()=>{if(navigator.share&&m)try{await navigator.share({title:t("receivePage.shareTitle"),text:m}),await r.impact("success")}catch{}};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("receivePage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"text-muted-foreground flex items-center justify-center gap-2",children:[e.jsx(kt,{chain:c,size:"sm"}),e.jsx("span",{className:"text-sm",children:i})]}),e.jsxs("div",{className:"bg-card flex flex-col items-center gap-4 rounded-2xl p-6 shadow-sm",children:[e.jsx(ou,{address:m,chain:c,size:200}),e.jsx("p",{className:"text-muted-foreground text-center text-sm",children:t("receivePage.scanQrCode")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm font-medium",children:t("receivePage.receiveAddress")}),e.jsx("div",{className:"border-border bg-card rounded-xl border p-4",children:e.jsx(Ue,{address:m,copyable:!0})})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(q,{variant:"outline",className:"flex-1",onClick:f,children:d?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"mr-2 size-4"}),t("receivePage.copied")]}):e.jsxs(e.Fragment,{children:[e.jsx(Bi,{className:"mr-2 size-4"}),t("receivePage.copyAddress")]})}),e.jsxs(Ee,{variant:"mint",className:"flex-1",onClick:h,children:[e.jsx(df,{className:"mr-2 size-4"}),t("receivePage.share")]})]}),e.jsx(wt,{variant:"info",children:t("receivePage.networkWarning",{chain:i})})]})]})}Rl.__docgenInfo={description:"",methods:[],displayName:"ReceivePage"};const Dl=()=>e.jsx(Y,{children:e.jsx(Rl,{})});Dl.__docgenInfo={description:"",methods:[],displayName:"ReceiveActivity"};const zl=()=>e.jsx(Y,{children:e.jsx(Xa,{})});zl.__docgenInfo={description:"",methods:[],displayName:"SettingsActivity"};const gv={"zh-CN":"","zh-TW":"",en:"English",ar:""};function Bl(){const{goBack:t}=Z(),{t:s}=L("settings"),n=ps(),a=r=>{fs.setLanguage(r),t()};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:s("languagePage.title"),onBack:t}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:Object.keys(_i).map((r,o)=>e.jsxs("div",{children:[o>0&&e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsxs("button",{onClick:()=>a(r),className:M("flex w-full items-center justify-between px-4 py-3.5","hover:bg-muted/50 active:bg-muted transition-colors",r===n&&"bg-primary/5"),children:[e.jsx("span",{className:"text-sm font-medium",children:gv[r]}),r===n&&e.jsx(fe,{className:"text-primary size-5"})]})]},r))}),e.jsx("p",{className:"text-muted-foreground mt-4 px-1 text-xs",children:s("languagePage.hint")})]})]})}Bl.__docgenInfo={description:"",methods:[],displayName:"LanguagePage"};const Ll=()=>e.jsx(Y,{children:e.jsx(Bl,{})});Ll.__docgenInfo={description:"",methods:[],displayName:"SettingsLanguageActivity"};function Ol(){const{t}=L("settings"),{goBack:s}=Z(),n=ha(),a=r=>{fs.setCurrency(r),s()};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("currency.title"),onBack:s}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:Object.keys(Qn).map((r,o)=>e.jsxs("div",{children:[o>0&&e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsxs("button",{onClick:()=>a(r),className:M("flex w-full items-center justify-between px-4 py-3.5","hover:bg-muted/50 active:bg-muted transition-colors",r===n&&"bg-primary/5"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-muted-foreground text-base font-semibold",children:Qn[r].symbol}),e.jsx("span",{className:"text-sm font-medium",children:t(`currency.names.${r}`)})]}),r===n&&e.jsx(fe,{className:"text-primary size-5"})]})]},r))}),e.jsx("p",{className:"text-muted-foreground mt-4 px-1 text-xs",children:t("currency.hint")})]})]})}Ol.__docgenInfo={description:"",methods:[],displayName:"CurrencyPage"};const Fl=()=>e.jsx(Y,{children:e.jsx(Ol,{})});Fl.__docgenInfo={description:"",methods:[],displayName:"SettingsCurrencyActivity"};function vv(t){const{children:s,open:n,defaultOpen:a=!1,onOpenChange:r,onOpenChangeComplete:o,actionsRef:c,handle:i,triggerId:d,defaultTriggerId:u=null}=t,m=Ru(),f=!!m,h=cm(()=>i?.store??new Bu({open:n??a,activeTriggerId:d!==void 0?d:u,modal:!0,disablePointerDismissal:!0,nested:f,role:"alertdialog"})).current;h.useControlledProp("open",n,a),h.useControlledProp("activeTriggerId",d,u),h.useSyncedValue("nested",f),h.useContextCallback("onOpenChange",r),h.useContextCallback("onOpenChangeComplete",o);const v=h.useState("payload");Du({store:h,actionsRef:c,parentContext:m?.store.context});const y=l.useMemo(()=>({store:h}),[h]);return e.jsx(zu.Provider,{value:y,children:typeof s=="function"?s({payload:v}):s})}function Wl({...t}){return e.jsx(vv,{"data-slot":"alert-dialog",...t})}function $l({...t}){return e.jsx($u,{"data-slot":"alert-dialog-portal",...t})}function ql({className:t,...s}){return e.jsx(qu,{"data-slot":"alert-dialog-overlay",className:M("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 bg-black/10 duration-100 supports-backdrop-filter:backdrop-blur-xs fixed inset-0 isolate z-50",t),...s})}function Hl({className:t,size:s="default",...n}){return e.jsxs($l,{children:[e.jsx(ql,{}),e.jsx(Lu,{"data-slot":"alert-dialog-content","data-size":s,className:M("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 data-closed:zoom-out-95 data-open:zoom-in-95 bg-background ring-foreground/10 gap-4 rounded-xl p-4 ring-1 duration-100 data-[size=default]:max-w-xs data-[size=sm]:max-w-xs data-[size=default]:sm:max-w-sm group/alert-dialog-content fixed top-1/2 left-1/2 z-50 grid w-full -translate-x-1/2 -translate-y-1/2 outline-none",t),...n})]})}function Ul({className:t,...s}){return e.jsx("div",{"data-slot":"alert-dialog-header",className:M("grid grid-rows-[auto_1fr] place-items-center gap-1.5 text-center has-data-[slot=alert-dialog-media]:grid-rows-[auto_auto_1fr] has-data-[slot=alert-dialog-media]:gap-x-4 sm:group-data-[size=default]/alert-dialog-content:place-items-start sm:group-data-[size=default]/alert-dialog-content:text-left sm:group-data-[size=default]/alert-dialog-content:has-data-[slot=alert-dialog-media]:grid-rows-[auto_1fr]",t),...s})}function Jl({className:t,...s}){return e.jsx("div",{"data-slot":"alert-dialog-footer",className:M("bg-muted/50 -mx-4 -mb-4 rounded-b-xl border-t p-4 flex flex-col-reverse gap-2 group-data-[size=sm]/alert-dialog-content:grid group-data-[size=sm]/alert-dialog-content:grid-cols-2 sm:flex-row sm:justify-end",t),...s})}function Vl({className:t,...s}){return e.jsx(Ou,{"data-slot":"alert-dialog-title",className:M("text-sm font-medium sm:group-data-[size=default]/alert-dialog-content:group-has-data-[slot=alert-dialog-media]/alert-dialog-content:col-start-2",t),...s})}function Kl({className:t,...s}){return e.jsx(Fu,{"data-slot":"alert-dialog-description",className:M("text-muted-foreground *:[a]:hover:text-foreground text-sm text-balance md:text-pretty *:[a]:underline *:[a]:underline-offset-3",t),...s})}function Gl({className:t,...s}){return e.jsx(q,{"data-slot":"alert-dialog-action",className:M(t),...s})}function Ql({className:t,variant:s="outline",size:n="default",...a}){return e.jsx(Wu,{"data-slot":"alert-dialog-cancel",className:M(t),render:e.jsx(q,{variant:s,size:n}),...a})}Wl.__docgenInfo={description:"",methods:[],displayName:"AlertDialog"};Gl.__docgenInfo={description:"",methods:[],displayName:"AlertDialogAction"};Ql.__docgenInfo={description:"",methods:[],displayName:"AlertDialogCancel",props:{variant:{defaultValue:{value:'"outline"',computed:!1},required:!1},size:{defaultValue:{value:'"default"',computed:!1},required:!1}}};Hl.__docgenInfo={description:"",methods:[],displayName:"AlertDialogContent",props:{size:{required:!1,tsType:{name:"union",raw:'"default" | "sm"',elements:[{name:"literal",value:'"default"'},{name:"literal",value:'"sm"'}]},description:"",defaultValue:{value:'"default"',computed:!1}}}};Kl.__docgenInfo={description:"",methods:[],displayName:"AlertDialogDescription"};Jl.__docgenInfo={description:"",methods:[],displayName:"AlertDialogFooter"};Ul.__docgenInfo={description:"",methods:[],displayName:"AlertDialogHeader"};ql.__docgenInfo={description:"",methods:[],displayName:"AlertDialogOverlay"};$l.__docgenInfo={description:"",methods:[],displayName:"AlertDialogPortal"};Vl.__docgenInfo={description:"",methods:[],displayName:"AlertDialogTitle"};function vi(t){if(typeof t!="object"||t===null||Array.isArray(t))return null;const s=t.id;return typeof s=="string"&&s.trim()!==""?s:null}function yv(t){try{const s=JSON.parse(t),n=Array.isArray(s)?s.map(vi):[vi(s)];return Array.from(new Set(n.filter(a=>typeof a=="string")))}catch{return[]}}function bv(t,s){switch(s){case"default":return t("chainConfig.source.default");case"subscription":return t("chainConfig.source.subscription");case"manual":return t("chainConfig.source.manual")}}function jv(t){switch(t){case"default":return"bg-muted text-muted-foreground";case"subscription":return"bg-blue-500/10 text-blue-600";case"manual":return"bg-amber-500/10 text-amber-700"}}function Nv(t){const s=new Map;for(const n of t)s.set(n.id,n);return s}function Yl(){const{goBack:t}=Z(),{t:s}=L("settings"),n=at(),a=ms(),r=Ai(),o=Ti(),c=Ii(),i=Pi(),d=l.useMemo(()=>Nv(o),[o]),[u,m]=l.useState("default"),[f,h]=l.useState(""),[v,y]=l.useState(!1),[p,g]=l.useState([]),b=l.useRef(null),x=l.useRef(null),j=l.useRef(!1);l.useEffect(()=>{lt.initialize()},[]),l.useEffect(()=>{r?.url&&m(r.url)},[r?.url]),l.useEffect(()=>{const k=j.current;if(j.current=c,!k||c)return;const I=b.current;if(I){if(b.current=null,i){n.show(i);return}n.show(s(`chainConfig.toast.${I}`)),I==="manualAdded"&&h("")}},[i,c,s,n]);const N=async()=>{b.current="subscriptionSaved",await lt.setSubscriptionUrl(u)},w=async()=>{b.current="subscriptionRefreshed",await lt.refreshSubscription()},S=async()=>{const k=yv(f),I=new Set(a.map(P=>P.id)),R=k.filter(P=>I.has(P));if(R.length>0){x.current=f,g(R),y(!0);return}b.current="manualAdded",await lt.addManualConfig(f)},C=()=>{x.current=null,g([]),y(!1)},T=async()=>{const k=x.current;x.current=null,g([]),y(!1),k&&(b.current="manualAdded",await lt.addManualConfig(k))};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:s("chainConfig.title"),onBack:t}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx(Wl,{open:v,onOpenChange:k=>{k?y(k):C()},children:e.jsxs(Hl,{children:[e.jsxs(Ul,{children:[e.jsx(Vl,{children:s("chainConfig.manual.duplicate.title")}),e.jsx(Kl,{children:s("chainConfig.manual.duplicate.description")})]}),e.jsx("div",{className:"bg-muted/50 text-muted-foreground rounded-lg px-3 py-2 text-xs font-mono break-all",children:p.join(", ")}),e.jsxs(Jl,{children:[e.jsx(Ql,{onClick:C,children:s("chainConfig.manual.duplicate.cancel")}),e.jsx(Gl,{onClick:T,disabled:c,children:s("chainConfig.manual.duplicate.replace")})]})]})}),i&&e.jsx("div",{className:"border-destructive/20 bg-destructive/5 text-destructive rounded-xl border px-4 py-3 text-sm",children:i}),e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:e.jsxs("div",{className:"space-y-3 px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.subscription.title")}),e.jsx("div",{className:"text-muted-foreground text-xs",children:e.jsx(ro,{ns:"settings",i18nKey:"chainConfig.subscription.description",components:{code:e.jsx("code",{className:"font-mono"})}})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{type:"button",variant:"outline",size:"icon","data-testid":"refresh-subscription-button",onClick:w,disabled:c,"aria-label":s("chainConfig.subscription.refreshAriaLabel"),children:e.jsx(vs,{className:M("size-4",c&&"animate-spin")})}),e.jsx(q,{type:"button","data-testid":"save-subscription-button",onClick:N,disabled:c,children:s("chainConfig.subscription.save")})]})]}),e.jsx(Pe,{"data-testid":"subscription-url-input",value:u,onChange:k=>m(k.target.value),placeholder:s("chainConfig.subscription.placeholder"),disabled:c,autoCapitalize:"off",autoCorrect:"off",spellCheck:!1}),r?.lastUpdated&&e.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.subscription.lastUpdated",{value:r.lastUpdated})})]})}),e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm","data-testid":"manual-add-section",children:e.jsxs("div",{className:"space-y-3 px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.manual.title")}),e.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.manual.description")})]}),e.jsxs(q,{type:"button",variant:"outline","data-testid":"add-chain-button",onClick:S,disabled:c||f.trim()==="",children:[e.jsx(nt,{className:"size-4"}),s("chainConfig.manual.add")]})]}),e.jsx("textarea",{"data-testid":"manual-config-textarea",value:f,onChange:k=>h(k.target.value),placeholder:s("chainConfig.manual.placeholder"),rows:5,disabled:c,className:M("bg-background w-full resize-none rounded-lg border px-3 py-3 text-sm","placeholder:text-muted-foreground","focus:ring-ring focus:ring-2 focus:ring-offset-2 focus:outline-none","disabled:cursor-not-allowed disabled:opacity-50"),autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})]})}),e.jsxs("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:[e.jsxs("div",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.list.title")}),e.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.list.description")})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{children:[a.map((k,I)=>{const R=d.get(k.id),P=R?.kind==="incompatible_major",A=bv(s,k.source);return e.jsxs("div",{"data-testid":`chain-item-${k.id}`,children:[I>0&&e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate text-sm font-medium",children:k.name}),e.jsx("span",{className:M("rounded px-2 py-0.5 text-xs",jv(k.source)),children:A})]}),e.jsxs("div",{className:"text-muted-foreground mt-1 flex flex-wrap gap-x-3 gap-y-1 text-xs",children:[e.jsx("span",{className:"font-mono",children:k.id}),e.jsxs("span",{children:["v",k.version]}),e.jsx("span",{children:k.chainKind}),e.jsx("span",{children:k.symbol})]}),R?.kind==="incompatible_major"&&e.jsxs("div",{className:"mt-2 flex items-start gap-2 rounded-lg bg-amber-500/10 px-3 py-2 text-xs text-amber-800",children:[e.jsx(Se,{className:"mt-0.5 size-4 shrink-0"}),e.jsx("div",{children:s("chainConfig.warning.incompatibleMajor",{version:R.version,supportedMajor:R.supportedMajor})})]})]}),e.jsx(Ji,{checked:k.enabled,onCheckedChange:D=>{lt.setChainEnabled(k.id,D)},disabled:c||P,className:M(P&&"cursor-not-allowed opacity-60")})]})})]},k.id)}),a.length===0&&e.jsx("div",{className:"text-muted-foreground px-4 py-8 text-center text-sm",children:s("chainConfig.list.empty")})]})]}),e.jsx("div",{className:"text-muted-foreground px-1 text-xs",children:s("chainConfig.hint")})]})]})}Yl.__docgenInfo={description:"",methods:[],displayName:"ChainConfigPage"};const Xl=()=>e.jsx(Y,{children:e.jsx(Yl,{})});Xl.__docgenInfo={description:"",methods:[],displayName:"SettingsChainsActivity"};const wv=3e4;function Zl(){const{t}=L("settings"),{goBack:s}=Z(),{push:n}=K(),a=be(),o=(a?.keyType??"mnemonic")==="arbitrary",[c,i]=l.useState(""),[d,u]=l.useState(!0),m=l.useRef(!1);l.useEffect(()=>{if(c.length>0&&!d){const v=setTimeout(()=>{u(!0)},wv);return()=>clearTimeout(v)}},[c.length,d]),l.useEffect(()=>{const v=()=>{document.hidden&&c.length>0&&u(!0)};return document.addEventListener("visibilitychange",v),()=>{document.removeEventListener("visibilitychange",v)}},[c.length]),l.useEffect(()=>{m.current||!a?.encryptedMnemonic||(m.current=!0,it(async v=>{try{const y=await Lt(a.encryptedMnemonic,v);return i(y),u(!1),!0}catch{return!1}}),n("WalletLockConfirmJob",{title:t("viewMnemonic.verifyTitle"),description:t(o?"viewMnemonic.verifyDescKey":"viewMnemonic.verifyDescMnemonic")}))},[a,n,t,o]);const f=()=>{u(v=>!v)};if(!a)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t(o?"viewMnemonic.titleKey":"viewMnemonic.titleMnemonic"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("viewMnemonic.noWallet")})})]});const h=o?[]:c.trim().split(/\s+/).filter(Boolean);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t(o?"viewMnemonic.titleKey":"viewMnemonic.titleMnemonic"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"flex gap-3 rounded-xl bg-amber-500/10 p-4",children:[e.jsx(Se,{className:"size-5 shrink-0 text-amber-500"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("p",{className:"font-medium text-amber-700 dark:text-amber-400",children:t("viewMnemonic.securityTip")}),e.jsx("p",{className:"text-muted-foreground",children:t(o?"viewMnemonic.securityWarningKey":"viewMnemonic.securityWarningMnemonic")})]})]}),c.length>0&&e.jsxs("div",{className:"bg-card space-y-4 rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:o?t("viewMnemonic.charCount",{count:c.length}):t("viewMnemonic.wordCount",{count:h.length})}),e.jsx("button",{onClick:f,className:M("flex items-center gap-1.5 rounded-full px-3 py-1.5 text-xs font-medium","bg-muted hover:bg-muted/80 transition-colors"),children:d?e.jsxs(e.Fragment,{children:[e.jsx(Ca,{className:"size-3.5"}),t("viewMnemonic.show")]}):e.jsxs(e.Fragment,{children:[e.jsx(to,{className:"size-3.5"}),t("viewMnemonic.hide")]})})]}),o?e.jsx("textarea",{value:c,readOnly:!0,rows:4,"data-testid":"secret-textarea",className:M("bg-background w-full resize-none rounded-lg border px-3 py-3 font-mono text-sm","focus:outline-none",d?"[-webkit-text-security:disc]":"[-webkit-text-security:none]")}):e.jsx(Zi,{words:h,hidden:d}),!d&&e.jsx("p",{className:"text-muted-foreground text-center text-xs",children:t("viewMnemonic.autoHideNote")})]})]})]})}Zl.__docgenInfo={description:"",methods:[],displayName:"ViewMnemonicPage"};const ed=()=>e.jsx(Y,{children:e.jsx(Zl,{})});ed.__docgenInfo={description:"",methods:[],displayName:"SettingsMnemonicActivity"};function td(){const{t}=L("settings"),{goBack:s}=Z(),n=be(),[a,r]=l.useState("verify"),[o,c]=l.useState("pattern"),[i,d]=l.useState([]),[u,m]=l.useState(!1),[f,h]=l.useState(!1),v=l.useRef(null),[y,p]=l.useState([]),[g,b]=l.useState(!1),[x,j]=l.useState(null),[N,w]=l.useState(null),S=l.useCallback(()=>{v.current&&(clearTimeout(v.current),v.current=null),m(!1)},[]),C=l.useCallback(P=>{u&&P.length>0&&S(),d(P)},[u,S]),T=l.useCallback(async P=>{if(n?.encryptedMnemonic){h(!0),S();try{const A=At(P);await ht(n.encryptedMnemonic,A)?(d(P),r("setup")):(m(!0),d([]),v.current=setTimeout(()=>{m(!1)},1500))}catch{m(!0),d([]),v.current=setTimeout(()=>{m(!1)},1500)}finally{h(!1)}}},[n,S]),k=l.useCallback((P,A)=>{p(P),b(A),j(null)},[]),I=l.useCallback(async()=>{if(n?.encryptedWalletLock){h(!0),j(null);try{if(!Ui(y)){j(t("changeWalletLock.invalidMnemonic")),h(!1);return}const P=y.join(" ");await de.verifyMnemonic(n.id,P)?(w(P),r("setup")):j(t("changeWalletLock.mnemonicVerifyFailed"))}catch{j(t("changeWalletLock.mnemonicVerifyFailed"))}finally{h(!1)}}},[n,y,t]),R=l.useCallback(async P=>{if(n)try{if(o==="mnemonic"&&N)await de.resetWalletLockByMnemonic(n.id,N,P);else{const A=At(i);await de.updateWalletLock(n.id,A,P)}r("success"),setTimeout(()=>{s()},2e3)}catch{r("verify"),d([]),w(null)}},[n,o,N,i,s]);return n?a==="success"?e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("changeWalletLock.title")}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx("div",{className:"bg-green-500/10 flex size-16 items-center justify-center rounded-full",children:e.jsx(fe,{className:"text-green-500 size-8"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:t("changeWalletLock.success")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:t("changeWalletLock.returning")})]})]})]}):a==="verify"?e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("changeWalletLock.title"),onBack:s}),e.jsx("div",{className:"flex-1 p-4",children:o==="pattern"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:t("changeWalletLock.verifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("changeWalletLock.verifyDesc")})]}),e.jsx(Gt,{value:i,onChange:C,onComplete:T,minPoints:4,error:u,disabled:f,"data-testid":"verify-pattern-lock"}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx("button",{type:"button",onClick:()=>c("mnemonic"),className:"text-primary hover:text-primary/80 text-sm underline","data-testid":"switch-to-mnemonic",children:t("changeWalletLock.forgotPattern")})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:t("changeWalletLock.mnemonicVerifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("changeWalletLock.mnemonicVerifyDesc")})]}),e.jsx(lm,{wordCount:12,onChange:k}),x&&e.jsx("p",{className:"text-destructive mt-4 text-center text-sm",children:x}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx(q,{onClick:I,disabled:!g||f,className:"w-full","data-testid":"verify-mnemonic-button",children:t(f?"changeWalletLock.verifying":"changeWalletLock.verifyMnemonic")}),e.jsx("button",{type:"button",onClick:()=>{c("pattern"),p([]),j(null)},className:"text-muted-foreground hover:text-foreground w-full text-center text-sm","data-testid":"switch-to-pattern",children:t("changeWalletLock.usePattern")})]})]})})]}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("changeWalletLock.title"),onBack:()=>{r("verify"),d([])}}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(ja,{onComplete:R,minPoints:4})})]}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("changeWalletLock.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("changeWalletLock.noWallet")})})]})}td.__docgenInfo={description:"",methods:[],displayName:"ChangeWalletLockPage"};const sd=()=>e.jsx(Y,{children:e.jsx(td,{})});sd.__docgenInfo={description:"",methods:[],displayName:"SettingsWalletLockActivity"};function nd({initialChain:t}){const{navigate:s,goBack:n}=Z(),a=be(),r=gn(),o=Le(),{t:c}=L(["transaction","common"]),{transactions:i,isLoading:d,isFetching:u,filter:m,setFilter:f,refresh:h}=Aa(a?.id),v=l.useMemo(()=>[{value:"all",label:c("history.filter.allTime")},{value:"7d",label:c("history.filter.days7")},{value:"30d",label:c("history.filter.days30")},{value:"90d",label:c("history.filter.days90")}],[c]),y=l.useMemo(()=>[{value:"all",label:c("history.filter.allChains")},...r.map(x=>({value:x.id,label:x.name}))],[c,r]);l.useEffect(()=>{const x=t??o;x&&m.chain!==x&&f({...m,chain:x})},[]);const p=l.useCallback(x=>{if(!x.id){console.warn("[TransactionHistory] Transaction has no id:",x);return}s({to:`/transaction/${x.id}`})},[s]),g=l.useCallback(x=>{f({...m,chain:x})},[m,f]),b=l.useCallback(x=>{f({...m,period:x})},[m,f]);return a?e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:c("transaction:history.title"),onBack:n,rightAction:e.jsx("button",{onClick:h,disabled:u,className:M("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80",u&&"animate-spin"),"aria-label":c("common:a11y.refresh"),children:e.jsx(vs,{className:"size-5"})})}),e.jsxs("div",{className:"bg-card border-b px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(po,{className:"text-muted-foreground size-4"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:c("history.filter.chainLabel")}),e.jsxs(Js,{value:m.chain||"all",onValueChange:x=>g(x),children:[e.jsx(Vs,{size:"sm","aria-label":c("common:a11y.selectChain"),children:e.jsx(Ks,{children:y.find(x=>x.value===(m.chain||"all"))?.label})}),e.jsx(Gs,{children:y.map(x=>e.jsx(qt,{value:x.value,children:x.label},x.value))})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:c("history.filter.periodLabel")}),e.jsxs(Js,{value:m.period||"all",onValueChange:x=>b(x),children:[e.jsx(Vs,{size:"sm","aria-label":c("common:a11y.selectPeriod"),children:e.jsx(Ks,{children:v.find(x=>x.value===(m.period||"all"))?.label})}),e.jsx(Gs,{children:v.map(x=>e.jsx(qt,{value:x.value,children:x.label},x.value))})]})]})]}),e.jsx("p",{className:"text-muted-foreground mt-2 text-xs",children:c("transaction:history.totalRecords",{count:i.length})})]}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(io,{transactions:i,loading:d,onTransactionClick:p,emptyTitle:c("transaction:history.emptyTitle"),emptyDescription:c("transaction:history.emptyDesc"),showChainIcon:!0})})]}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:c("transaction:history.title"),onBack:n}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:c("transaction:history.noWallet")})})]})}nd.__docgenInfo={description:"",methods:[],displayName:"TransactionHistoryPage",props:{initialChain:{required:!1,tsType:{name:"union",raw:"ChainType | 'all' | undefined",elements:[{name:"ChainType"},{name:"literal",value:"'all'"},{name:"undefined"}]},description:"'all' "}}};const ad=()=>{const t=Pf();return e.jsx(Y,{children:e.jsx(nd,{initialChain:t.chain})})};ad.__docgenInfo={description:"",methods:[],displayName:"HistoryActivity"};function Cv(t){if(!t)return null;const[s,n]=t.split("--");return!s||!n?null:{chainId:s,hash:n}}function Sv(t){if(!t)return!1;if(t.type==="swap")return(t.assets??[]).length<2;if(t.type==="approve"||t.type==="interaction"){const s=t.contract?.method,n=t.contract?.methodId;return!s&&!n}return!1}function rd(){const{t}=L(["transaction","common"]),{goBack:s}=Z(),{txId:n}=re(),a=be(),r=st(),{transactions:o,isLoading:c}=Aa(a?.id),i=l.useMemo(()=>o.find(_=>_.id===n),[o,n]),d=l.useMemo(()=>Cv(n),[n]),u=hs({queryKey:["transaction-detail",n],queryFn:async()=>zi.getTransaction({id:n}),enabled:!!a?.id&&!!n&&(!i||Sv(i)),staleTime:3e4}),f=u.data??void 0??i,h=c||u.isLoading,v=l.useMemo(()=>{const _=f?.chain??d?.chainId;return _?Ge.getChainById(r,_):null},[r,d?.chainId,f?.chain]),y=l.useMemo(()=>{const _=v?.explorer?.queryTx,B=f?.hash??d?.hash;return!_||!B?null:_.replace(":signature",B)},[v?.explorer?.queryTx,d?.hash,f?.hash]),p=l.useCallback(()=>{y&&window.open(y,"_blank","noopener,noreferrer")},[y]),[g,b]=l.useState(!1),x=l.useCallback(async()=>{y&&(await xa.write({text:y}),b(!0),setTimeout(()=>b(!1),2e3))},[y]),j=l.useCallback(()=>{s()},[s]);if(!a)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("detail.title"),onBack:j}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("history.noWallet")})})]});if(h)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("detail.title"),onBack:j}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx(_n,{className:"h-48"}),e.jsx(_n,{className:"h-64"}),e.jsx(_n,{className:"h-32"})]})]});if(u.error instanceof xu){const _=d?.hash;return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("detail.title"),onBack:j}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx("div",{className:"bg-card flex items-center justify-center rounded-xl p-6 shadow-sm",children:e.jsx("p",{className:"text-muted-foreground",children:t("detail.invalidData")})}),_&&e.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:t("detail.hash")}),e.jsx(tr,{text:_,className:"text-muted-foreground text-xs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:p,disabled:!y,className:M("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:[e.jsx(Zn,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:t("detail.openInExplorer")})]}),e.jsx("button",{onClick:x,disabled:!y,className:M("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:g?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"text-green-500 size-4"}),e.jsx("span",{className:"text-sm",children:t("detail.copied")})]}):e.jsxs(e.Fragment,{children:[e.jsx(Qs,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:t("detail.share")})]})})]})]})]})]})}if(!f)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("detail.title"),onBack:j}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("detail.notFound")})})]});const N=f.type,w=vu(N),S=w.Icon,C=f.type==="swap"?f.assets?.[0]:void 0,T=f.type==="swap"?f.assets?.[1]:void 0,k=f.contract?.address||f.to,I=f.contract?.method,R=f.contract?.methodId,P=I?t(`method.${I}`,{defaultValue:I}):null,A=C?ce.fromRaw(C.value,C.decimals,C.symbol):null,D=T?ce.fromRaw(T.value,T.decimals,T.symbol):null;return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("detail.title"),onBack:j}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"bg-card flex flex-col items-center gap-3 rounded-xl p-6 shadow-sm",children:[e.jsx("div",{className:M("flex size-16 items-center justify-center rounded-full",w.bg),children:e.jsx(S,{className:M("size-8",w.color)})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:t(`type.${f.type}`,{defaultValue:f.type})}),f.type==="swap"&&A&&D?e.jsxs("div",{className:M("flex items-center justify-center gap-2",w.color),children:[e.jsx(dt,{value:A.toNumber(),symbol:A.symbol,decimals:A.decimals,sign:"never",color:"default",weight:"normal",size:"lg"}),e.jsx("span",{className:"text-lg",children:""}),e.jsx(dt,{value:D.toNumber(),symbol:D.symbol,decimals:D.decimals,sign:"never",color:"default",weight:"normal",size:"lg"})]}):e.jsx(dt,{value:f.type==="send"?-Math.abs(f.amount.toNumber()):f.amount.toNumber(),symbol:f.symbol,sign:w.amountSign,color:"default",weight:"normal",size:"xl",className:w.color})]}),e.jsx(dm,{status:yu(f.status).badgeStatus,label:t(`transaction:status.${f.status}`)})]}),e.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:t("detail.info")}),f.from&&f.to?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.fromAddress")}),e.jsx(Ue,{address:f.from,copyable:!0,className:"text-sm"})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.toAddress")}),e.jsx(Ue,{address:f.to,copyable:!0,className:"text-sm"})]})]}):e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:f.type==="send"?t("detail.toAddress"):t("detail.fromAddress")}),e.jsx(Ue,{address:f.address,copyable:!0,className:"text-sm"})]}),e.jsx("div",{className:"bg-border h-px"}),f.type==="swap"&&(C||T)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.swapFrom")}),e.jsx("span",{className:"text-sm font-medium",children:C?e.jsx(dt,{value:ce.fromRaw(C.value,C.decimals,C.symbol).toNumber(),symbol:C.symbol,decimals:C.decimals,sign:"never",color:"default",size:"sm"}):"-"})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.swapTo")}),e.jsx("span",{className:"text-sm font-medium",children:T?e.jsx(dt,{value:ce.fromRaw(T.value,T.decimals,T.symbol).toNumber(),symbol:T.symbol,decimals:T.decimals,sign:"never",color:"default",size:"sm"}):"-"})]}),e.jsx("div",{className:"bg-border h-px"})]}),(f.type==="approve"||f.type==="interaction"||f.type==="swap")&&k&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.contractAddress")}),e.jsx(Ue,{address:k,copyable:!0,className:"text-sm"})]}),(f.type==="approve"||f.type==="interaction")&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.method")}),e.jsx("span",{className:"text-sm font-medium font-mono",children:P||R||t("common:unknown")})]}),f.type==="approve"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.spender")}),e.jsx("span",{className:"text-sm font-medium",children:t("common:unknown")})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.allowance")}),e.jsx("span",{className:"text-sm font-medium",children:t("common:unknown")})]})]})]}),e.jsx("div",{className:"bg-border h-px"})]}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.time")}),e.jsx(Cu,{value:f.timestamp,format:"datetime",className:"text-sm"})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.network")}),e.jsx("span",{className:"text-sm font-medium capitalize",children:f.chain})]}),f.fee&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.fee")}),e.jsx(ba,{amount:f.fee.toNumber(),symbol:f.feeSymbol||f.symbol,className:"text-sm"})]})]}),f.blockNumber&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.blockHeight")}),e.jsx("span",{className:"text-sm font-medium",children:f.blockNumber.toLocaleString()})]})]}),f.confirmations!==void 0&&f.confirmations>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.confirmations")}),e.jsx("span",{className:"text-sm font-medium",children:f.confirmations})]})]})]}),f.hash&&e.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:t("detail.hash")}),e.jsx(tr,{text:f.hash,className:"text-muted-foreground text-xs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:p,disabled:!y,className:M("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:[e.jsx(Zn,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:t("detail.openInExplorer")})]}),e.jsx("button",{onClick:x,disabled:!y,className:M("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:g?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"text-green-500 size-4"}),e.jsx("span",{className:"text-sm",children:t("detail.copied")})]}):e.jsxs(e.Fragment,{children:[e.jsx(Qs,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:t("detail.share")})]})})]})]})]})]})}rd.__docgenInfo={description:"",methods:[],displayName:"TransactionDetailPage"};const id=({params:t})=>e.jsx(Y,{children:e.jsx(ee,{params:t,children:e.jsx(rd,{})})});id.__docgenInfo={description:"",methods:[],displayName:"TransactionDetailActivity"};const kv=150;function od({onScan:t,className:s}){const{t:n}=L("scanner"),{t:a}=L("common"),{navigate:r,goBack:o}=Z(),{push:c}=K(),i=No(),d=l.useRef(null),u=l.useRef(null),m=l.useRef(null),f=l.useRef(null),h=l.useRef(!1),v=l.useRef(null),y=l.useRef(t),[p,g]=l.useState("idle"),[b,x]=l.useState(null),[j,N]=l.useState(!1);l.useEffect(()=>{y.current=t},[t]);const w=l.useCallback(P=>{if(P===v.current)return;v.current=P,g("success"),h.current=!1,"vibrate"in navigator&&navigator.vibrate(100);const A=Qi(P);if(y.current)y.current(P,A);else switch(A.type){case"address":case"payment":r({to:"/send",search:{address:A.address,chain:A.chain,amount:A.type==="payment"?A.amount:void 0}});break;case"deeplink":r({to:A.path,search:A.params});break;case"contact":c("ContactAddConfirmJob",{name:A.name,addresses:JSON.stringify(A.addresses),memo:A.memo,avatar:A.avatar});break;case"unknown":r({to:"/send",search:{address:A.content}});break}},[r,c]),S=l.useCallback(()=>{if(h.current)return;h.current=!0,u.current||(u.current=document.createElement("canvas"));const P=async()=>{if(!(!h.current||!d.current||!f.current)){try{const A=await f.current.scanFromVideo(d.current,u.current??void 0);if(A){w(A.content);return}}catch(A){console.error("[Scanner] Scan error:",A)}h.current&&setTimeout(P,kv)}};P()},[w]),C=l.useCallback(()=>{h.current=!1,m.current&&(m.current.getTracks().forEach(P=>P.stop()),m.current=null)},[]),T=l.useCallback(async()=>{C(),g("requesting"),v.current=null;try{if(!await i.checkPermission()&&!await i.requestPermission()){g("denied");return}const A=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});m.current=A,d.current&&(d.current.srcObject=A,await d.current.play(),S()),g("scanning")}catch(P){console.error("Camera error:",P),g("error"),x(P instanceof Error?P.message:"Camera initialization failed")}},[i,S,C]);l.useEffect(()=>(f.current=Yi({useWorker:!0}),T(),()=>{C(),f.current?.destroy(),f.current=null}),[]);const k=l.useCallback(()=>{C(),o()},[C,o]),I=l.useCallback(()=>{const P=document.createElement("input");P.type="file",P.accept="image/*",P.onchange=async A=>{const D=A.target.files?.[0];if(D)try{const _=new Image,B=URL.createObjectURL(D);_.onload=async()=>{URL.revokeObjectURL(B);const E=document.createElement("canvas");E.width=_.width,E.height=_.height;const z=E.getContext("2d");if(!z||!f.current){x(n("noQrFound")),g("error");return}z.drawImage(_,0,0);const O=await f.current.scanFromCanvas(E);O?w(O.content):(x(n("noQrFound")),g("error"))},_.onerror=()=>{URL.revokeObjectURL(B),x(n("noQrFound")),g("error")},_.src=B}catch{x(n("noQrFound")),g("error")}},P.click()},[w,n]),R=l.useCallback(async()=>{if(m.current){const P=m.current.getVideoTracks()[0];if(P)try{await P.applyConstraints({advanced:[{torch:!j}]}),N(!j)}catch{}}},[j]);return e.jsxs("div",{className:M("relative flex h-screen flex-col bg-black",s),children:[e.jsxs("div",{className:"absolute top-0 right-0 left-0 z-10 flex items-center justify-between p-4",children:[e.jsx(q,{variant:"ghost",size:"icon","data-testid":"back-button",onClick:k,className:"text-white","aria-label":a("a11y.back"),children:e.jsx(wn,{className:"size-6"})}),e.jsx("h1",{"data-testid":"page-title",className:"text-lg font-medium text-white",children:n("title")}),e.jsx(q,{variant:"ghost",size:"icon",onClick:R,className:M("text-white",j&&"text-yellow-400"),"aria-label":n(j?"flashOff":"flashOn"),children:e.jsx(mo,{className:"size-6"})})]}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("video",{ref:d,className:M("absolute inset-0 size-full object-cover",p!=="scanning"&&p!=="success"&&"invisible"),playsInline:!0,muted:!0}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"relative size-64",children:[e.jsx("div",{className:M("absolute top-0 left-0 size-8 border-t-4 border-l-4",p==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:M("absolute top-0 right-0 size-8 border-t-4 border-r-4",p==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:M("absolute bottom-0 left-0 size-8 border-b-4 border-l-4",p==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:M("absolute right-0 bottom-0 size-8 border-r-4 border-b-4",p==="success"?"border-green-500":"border-primary")}),p==="scanning"&&e.jsx("div",{className:"animate-scan bg-primary absolute right-2 left-2 h-0.5"})]})}),e.jsxs("div",{className:"absolute inset-x-0 bottom-32 text-center",children:[p==="idle"&&e.jsx("p",{className:"text-white/80",children:n("initializing")}),p==="requesting"&&e.jsx("p",{className:"text-white/80",children:n("requestingPermission")}),p==="scanning"&&e.jsx("p",{className:"text-white/80",children:n("scanPrompt")}),p==="success"&&e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-green-400",children:n("scanSuccess")})}),p==="denied"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-red-400",children:n("permissionDenied")}),e.jsx(q,{variant:"outline","data-testid":"retry-button",onClick:T,children:n("retry")})]}),p==="error"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-red-400",children:b||n("error")}),e.jsx(q,{variant:"outline","data-testid":"retry-button",onClick:T,children:n("retry")})]})]})]}),e.jsxs("div",{className:"absolute inset-x-0 bottom-0 flex justify-center gap-8 pb-8",children:[e.jsxs(q,{variant:"ghost",size:"lg","data-testid":"gallery-button",onClick:I,className:"flex flex-col items-center text-white",children:[e.jsx(co,{className:"mb-1 size-6"}),e.jsx("span",{className:"text-xs",children:n("gallery")})]}),e.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-white/20",children:e.jsx(Rm,{className:"size-8 text-white"})}),e.jsx("div",{className:"w-16"})," "]})]})}od.__docgenInfo={description:"",methods:[],displayName:"ScannerPage",props:{onScan:{required:!1,tsType:{name:"union",raw:"((content: string, parsed: ParsedQRContent) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:"Callback when QR code is scanned"},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"Custom class name"}}};const cd=()=>e.jsx(Y,{children:e.jsx(od,{})});cd.__docgenInfo={description:"",methods:[],displayName:"ScannerActivity"};const Av=300*1e3,Ws={ethereum:"Ethereum",bitcoin:"Bitcoin",tron:"Tron",binance:"BSC",bsc:"BSC",bfmeta:"BFMeta",ccchain:"CCChain",pmchain:"PMChain",bfchainv2:"BFChain V2",btgmeta:"BTGMeta",biwmeta:"BIWMeta",ethmeta:"ETHMeta",malibu:"Malibu",ccc:"CCChain"};function ld(t){if(t)return t}function Tv(t){return t.map(s=>({id:s.id,name:s.name,address:s.address,balance:""}))}function Iv(t,s){const n=new Map;for(const a of t)for(const r of a.chainAddresses){const o=ld(r.chain);if(!o)continue;const c=n.get(o)??[];c.push({address:r.address,isDefault:a.id===s}),n.set(o,c)}return Array.from(n.entries()).map(([a,r])=>({chain:a,name:Ws[a]??a,addresses:r.map(o=>({address:o.address,isDefault:o.isDefault}))}))}function yi(t){const s=t?.trim().toLowerCase();return s==="true"||s==="1"}function dd(){const{t}=L("authorize"),{t:s}=L("common"),{navigate:n,goBack:a}=Z(),{push:r}=K(),o=at(),{id:c,type:i,chainName:d,signMessage:u,getMain:m}=re(),f=le(me,F=>F.currentWalletId),h=le(me,F=>F.wallets),v=le(me,_e.getCurrentWallet),[y,p]=l.useState(null),[g,b]=l.useState(null),[x,j]=l.useState(!1),N=l.useMemo(()=>Tv(h),[h]),w=v?.id??h[0]?.id,[S,C]=l.useState(w),T=l.useMemo(()=>ld(d),[d]),[k,I]=l.useState(T);l.useEffect(()=>I(T),[T]);const[R,P]=l.useState(void 0),[A,D]=l.useState(()=>new Set(h.map(F=>F.id))),[_,B]=l.useState(!1);l.useEffect(()=>{C(w)},[w]),l.useEffect(()=>{D(new Set(h.map(F=>F.id)))},[h]);const E=l.useMemo(()=>{const F=["viewAddress","viewPublicKey"];return u?.trim()&&F.push("signMessage"),yi(m)&&F.push("getMain"),F},[m,u]),z=l.useMemo(()=>new yf(Ht,c),[c]),O=l.useMemo(()=>!!u?.trim(),[u]),H=l.useMemo(()=>yi(m),[m]),te=O||H;l.useEffect(()=>{let F=!1;async function se(){b(null);try{const X=await Ht.getCallerAppInfo(c);if(F)return;p(X)}catch{if(F)return;b(t("error.authFailed"))}}return se(),()=>{F=!0}},[c,t]),l.useEffect(()=>{const F=window.setTimeout(()=>{(async()=>(await z.reject("timeout"),o.show({message:t("error.timeout"),position:"center"}),n({to:"/"})))()},Av);return()=>{window.clearTimeout(F)}},[z,n,t,o]);const Q=l.useMemo(()=>S?h.find(F=>F.id===S)??null:null,[S,h]),V=l.useMemo(()=>Iv(h,f),[h,f]),G=l.useMemo(()=>v?v.chainAddresses.map(F=>F.chain):[],[v]),ie=l.useMemo(()=>{if(!(!v||!k))return v.chainAddresses.find(F=>F.chain===k)?.address},[v,k]);l.useEffect(()=>{i==="network"&&(k||I(V[0]?.chain))},[V,k,i]);const je=l.useMemo(()=>h.length===0?!1:i==="main"?!!Q:i==="network"?k?(V.find(F=>F.chain===k)?.addresses.length??0)>0:!1:A.size>0,[V,k,Q,A.size,i,h.length]),Qe=l.useCallback(()=>{a()},[a]),_t=l.useCallback(async()=>{if(!x){j(!0);try{await z.reject("rejected"),n({to:"/"})}finally{j(!1)}}},[z,x,n]),he=l.useCallback(async()=>{if(!(!je||x)){if(te){it(async F=>{j(!0);try{const se=u?.trim()??"";let X=[],ue=[];if(i==="main"){if(!Q)return!1;X=z.handleMainAddresses(Q),ue=[Q]}else if(i==="network"){if(!k)return!1;X=z.handleNetworkAddresses(h,k),ue=h}else{const we=h.filter(xe=>A.has(xe.id));X=z.handleAllAddresses(we),ue=we}return X=await z.applySensitiveOptions(X,ue,{password:F,signMessage:se,getMain:H}),await z.approve(X),n({to:"/"}),!0}catch{return!1}finally{j(!1)}}),r("WalletLockConfirmJob",{title:t("passwordConfirm.title")});return}j(!0);try{let F=[];if(i==="main"){if(!Q)return;F=z.handleMainAddresses(Q)}else if(i==="network"){if(!k)return;F=z.handleNetworkAddresses(h,k)}else{const se=h.filter(X=>A.has(X.id));F=z.handleAllAddresses(se)}await z.approve(F),n({to:"/"})}finally{j(!1)}}},[z,je,x,n,te,H,r,k,Q,A,u,t,i,h]);return i==="network"&&d&&!T?e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(U,{title:t("title.address"),onBack:Qe}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-destructive",children:t("error.unknownChain")}),e.jsx("div",{className:"mt-4",children:e.jsx(q,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]}):g?e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(U,{title:t("title.address"),onBack:Qe}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-destructive",children:g}),e.jsx("div",{className:"mt-4",children:e.jsx(q,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]}):e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(U,{title:t("title.address"),onBack:Qe}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[y&&e.jsx(oo,{appInfo:y}),e.jsx("div",{className:"px-1 text-sm text-foreground",children:t("address.shareWith")}),e.jsx(mm,{permissions:E}),e.jsx("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:[i==="main"&&t("address.scope.main"),i==="network"&&t("address.scope.network",{chainName:Ws[k??""]??k??""}),i==="all"&&t("address.scope.all")]})}),e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[i==="main"&&e.jsx(fm,{wallets:N,...S?{selectedId:S}:{},onSelect:F=>C(F.id)}),i==="network"&&v&&k&&e.jsx("div",{className:"aspect-[1.6/1] w-full",children:e.jsx(Di,{wallet:v,chain:k,chainName:Ws[k]??k,address:ie,priority:"low",onOpenChainSelector:T?void 0:()=>B(!0)})}),i==="all"&&e.jsxs("div",{className:"space-y-2",children:[h.length===0&&e.jsx("div",{className:"py-6 text-center text-sm text-muted-foreground",children:t("address.noWallets")}),h.map(F=>{const se=A.has(F.id);return e.jsxs("button",{type:"button",onClick:()=>{D(X=>{const ue=new Set(X);return ue.has(F.id)?ue.delete(F.id):ue.add(F.id),ue})},className:M("flex w-full items-center justify-between rounded-lg border px-3 py-2 text-left transition-colors","hover:bg-muted/50",se?"border-primary bg-primary/5":"border-border bg-background"),"aria-pressed":se,children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-medium",children:F.name}),e.jsx("div",{className:"truncate font-mono text-xs text-muted-foreground",children:F.address})]}),e.jsx("div",{className:M("flex size-5 items-center justify-center rounded border",se?"border-primary bg-primary text-primary-foreground":"border-border bg-background"),"aria-hidden":"true",children:se?"":""})]},F.id)})]})]})]}),e.jsx("div",{className:"sticky bottom-0 border-t border-border bg-background p-4 safe-area-inset-bottom",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(q,{type:"button",variant:"outline",className:"flex-1",onClick:_t,disabled:x,children:t("button.reject")}),e.jsx(q,{type:"button",className:"flex-1",onClick:he,disabled:!je||x,children:t("button.approve")})]})}),_&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/50",onClick:()=>B(!1),children:e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-background rounded-t-2xl",onClick:F=>F.stopPropagation(),children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("address.selectNetwork")})}),e.jsx("div",{className:"max-h-[60vh] space-y-2 overflow-y-auto p-4",children:G.map(F=>{const se=v?.chainAddresses.find(X=>X.chain===F);return e.jsxs("button",{onClick:()=>{I(F),B(!1)},className:M("flex w-full items-center gap-3 rounded-xl p-4 transition-colors",F===k?"bg-primary/10 ring-1 ring-primary":"bg-muted/50 hover:bg-muted"),children:[e.jsx(kt,{chain:F,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:Ws[F]??F}),e.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:se?.address?Pv(se.address):"---"})]}),F===k&&e.jsx(fe,{className:"size-5 text-primary"})]},F)})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})]})}function Pv(t,s=10,n=8){return t.length<=s+n+3?t:`${t.slice(0,s)}...${t.slice(-n)}`}dd.__docgenInfo={description:"",methods:[],displayName:"AddressAuthPage"};const ud=({params:t})=>e.jsx(Y,{children:e.jsx(ee,{params:t,children:e.jsx(dd,{})})});ud.__docgenInfo={description:"",methods:[],displayName:"AuthorizeAddressActivity"};const Ev=300*1e3;function bi(t){return typeof t=="object"&&t!==null}function De(t,s){const n=t[s];if(typeof n=="string")return n;if(typeof n=="number"&&Number.isFinite(n))return String(n)}function _v(t,s,n){const a=De(t,s)?.trim();return a?{ok:!0,value:a}:{ok:!1,error:`signaturedata ${n}`}}function ct(t,s){for(const n of s){const a=De(t,n.key)?.trim();if(a)return{ok:!0,value:a}}return{ok:!1,error:`signaturedata ${s.map(n=>n.label).join(" / ")}`}}function Mv(t){if(typeof t=="string"){const s=t.trim().toLowerCase();return s==="message"?{ok:!0,value:"message"}:s==="transfer"?{ok:!0,value:"transfer"}:s==="destroy"||s==="destory"?{ok:!0,value:"destory"}:{ok:!1,error:`${t}`}}return typeof t=="number"&&Number.isInteger(t)?t===0?{ok:!0,value:"message"}:t===1?{ok:!0,value:"transfer"}:t===7?{ok:!0,value:"destory"}:{ok:!1,error:`${t}`}:{ok:!1,error:"signaturedata.type "}}function Rv(t){if(t===void 0||t.trim()==="")return{ok:!1,error:" signaturedata "};let s;try{s=JSON.parse(t)}catch{return{ok:!1,error:"signaturedata  JSON"}}if(!Array.isArray(s))return{ok:!1,error:"signaturedata  JSON "};if(s.length===0)return{ok:!1,error:"signaturedata "};const n=s[0];if(!bi(n))return{ok:!1,error:"signaturedata[0] "};const a=Mv(n.type);if(!a.ok)return a;const r=ct(n,[{key:"chainName",label:"chainName"},{key:"chain",label:"chain"}]);if(!r.ok)return r;const o=r.value;if(a.value==="message"){const c=ct(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!c.ok)return c;const i=_v(n,"message","message");return i.ok?{ok:!0,item:{type:"message",payload:{chainName:o,senderAddress:c.value,message:i.value}}}:i}if(a.value==="transfer"){const c=ct(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!c.ok)return c;const i=ct(n,[{key:"receiveAddress",label:"receiveAddress"},{key:"to",label:"to"}]);if(!i.ok)return i;const d=ct(n,[{key:"balance",label:"balance"},{key:"amount",label:"amount"}]);if(!d.ok)return d;const u=De(n,"fee")?.trim(),m=De(n,"assetType")?.trim();let f;const h=n.contractInfo;if(bi(h)){const v=De(h,"assetType")?.trim(),y=h.decimals,p=De(h,"contractAddress")?.trim(),g=typeof y=="number"&&Number.isFinite(y)?y:typeof y=="string"&&y.trim()!==""?Number(y):void 0;v&&p&&typeof g=="number"&&Number.isFinite(g)&&(f={assetType:v,contractAddress:p,decimals:g})}return{ok:!0,item:{type:"transfer",payload:{chainName:o,senderAddress:c.value,receiveAddress:i.value,balance:d.value,...u?{fee:u}:{},...m?{assetType:m}:{},...f?{contractInfo:f}:{}}}}}{const c=ct(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!c.ok)return c;const i=ct(n,[{key:"destoryAmount",label:"destoryAmount"},{key:"amount",label:"amount"}]);if(!i.ok)return i;const d=De(n,"destoryAddress")?.trim()??De(n,"to")?.trim()??c.value,u=De(n,"fee")?.trim(),m=De(n,"assetType")?.trim();return{ok:!0,item:{type:"destory",payload:{chainName:o,senderAddress:c.value,destoryAddress:d,destoryAmount:i.value,...u?{fee:u}:{},...m?{assetType:m}:{}}}}}}function Dv(t){return typeof t=="object"&&t!==null&&"senderAddress"in t&&"receiveAddress"in t&&"balance"in t}function zv(t){return typeof t=="object"&&t!==null&&"senderAddress"in t&&"message"in t&&!("receiveAddress"in t)}function Bv(t){return typeof t=="object"&&t!==null&&"senderAddress"in t&&"destoryAddress"in t&&"destoryAmount"in t}function ji(t){return t.contractInfo?.assetType?t.contractInfo.assetType.toUpperCase():t.assetType?t.assetType.toUpperCase():{ethereum:"ETH",bitcoin:"BTC",tron:"TRX",binance:"BNB",bsc:"BNB"}[t.chainName?.toLowerCase()??""]??"TOKEN"}function Lv(t,s,n){const a=parseFloat(t)||0,r=parseFloat(s)||0,o=parseFloat(n??"0")||0,c=r+o;return{sufficient:a>=c,required:c.toString()}}function md(){const{t}=L("authorize"),{t:s}=L("common"),{navigate:n,goBack:a}=Z(),{push:r}=K(),o=at(),{id:c,signaturedata:i}=re(),d=le(me,_e.getCurrentWallet),[u,m]=l.useState(null),[f,h]=l.useState(null),[v,y]=l.useState(null),[p,g]=l.useState(!1),b=l.useMemo(()=>new Ia(Ht,c),[c]);l.useEffect(()=>{let R=!1;async function P(){y(null);try{const A=Rv(i);if(!A.ok){y(A.error);return}const D=await Ht.getCallerAppInfo(c);if(R)return;m(D);const _={eventId:c,type:A.item.type,payload:A.item.payload,appName:D.appName,appHome:D.origin,appLogo:D.appIcon};h(_)}catch{if(R)return;y(t("error.authFailed"))}}return P(),()=>{R=!0}},[c,i,t]),l.useEffect(()=>{const R=window.setTimeout(()=>{(async()=>(await b.reject("timeout"),o.show({message:t("error.timeout"),position:"center"}),n({to:"/"})))()},Ev);return()=>{window.clearTimeout(R)}},[b,n,t,o]);const x=l.useMemo(()=>!f||!Dv(f.payload)?null:f.payload,[f]),j=l.useMemo(()=>!f||!zv(f.payload)?null:f.payload,[f]),N=l.useMemo(()=>!f||!Bv(f.payload)?null:f.payload,[f]),w=l.useMemo(()=>{if(!d)return{sufficient:!0,required:"0",walletBalance:"0"};const R=x?{chainName:x.chainName,amount:x.balance,fee:x.fee}:N?{chainName:N.chainName,amount:N.destoryAmount,fee:N.fee}:null;if(!R)return{sufficient:!0,required:"0",walletBalance:"0"};const A=d.chainAddresses.find(_=>_.chain.toLowerCase()===R.chainName?.toLowerCase())?"1.0":"0";return{...Lv(A,R.amount,R.fee),walletBalance:A}},[d,N,x]),S=l.useMemo(()=>x?ji(x):N?ji(N):"TOKEN",[N,x]),C=l.useCallback(()=>{a()},[a]),T=l.useCallback(async()=>{if(!p){g(!0);try{await b.reject(w.sufficient?"rejected":"insufficient_balance"),n({to:"/"})}finally{g(!1)}}},[b,w.sufficient,p,n]),k=l.useCallback(()=>{w.sufficient&&(p||(it(async R=>{g(!0);try{const P=d?.encryptedMnemonic;if(!P||!f)return!1;let A;if(f.type==="message"){if(!j)return!1;A=await b.handleMessageSign(j,P,R)}else if(f.type==="transfer"){if(!x)return!1;A=await b.handleTransferSign(x,P,R)}else if(f.type==="destory"){if(!N)return!1;A=await b.handleDestroySign(N,P,R)}else return!1;return await b.approve(A),n({to:"/"}),!0}catch{return!1}finally{g(!1)}}),r("WalletLockConfirmJob",{title:t("button.confirm")})))},[b,w.sufficient,d?.encryptedMnemonic,N,p,j,n,r,f,t,x]);if(v)return e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(U,{title:t("title.signature"),onBack:C}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-destructive",children:v}),e.jsx("div",{className:"mt-4",children:e.jsx(q,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]});const I=f?.type==="message"?t("signature.type.message"):f?.type==="destory"?t("signature.type.destroy"):t("title.signature");return e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(U,{title:I,onBack:C}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[u&&e.jsx(oo,{appInfo:u}),e.jsx("div",{className:"px-1 text-sm text-foreground",children:t("signature.reviewTransaction")}),x&&e.jsxs(e.Fragment,{children:[e.jsx(fr,{from:x.senderAddress,to:x.receiveAddress,amount:`${x.balance} ${S}`,...x.fee?{fee:`${x.fee} ${S}`}:{},chainId:x.chainName}),!w.sufficient&&e.jsx(pr,{balance:w.walletBalance,required:w.required,symbol:S})]}),j&&e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:t("signature.messageToSign")}),e.jsx("div",{className:M("rounded-lg bg-muted/50 p-3","font-mono text-sm whitespace-pre-wrap break-all","max-h-48 overflow-y-auto"),children:j.message})]}),N&&e.jsxs(e.Fragment,{children:[e.jsx(fr,{from:N.senderAddress,to:N.destoryAddress,amount:`${N.destoryAmount} ${S}`,...N.fee?{fee:`${N.fee} ${S}`}:{},chainId:N.chainName}),!w.sufficient&&e.jsx(pr,{balance:w.walletBalance,required:w.required,symbol:S})]}),f&&e.jsx("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:[f.type==="transfer"&&t("signature.type.transfer"),f.type==="message"&&t("signature.type.message"),f.type==="destory"&&t("signature.type.destroy")]})})]}),e.jsx("div",{className:"sticky bottom-0 border-t border-border bg-background p-4 safe-area-inset-bottom",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(q,{type:"button",variant:"outline",className:"flex-1",onClick:T,disabled:p,children:t("button.reject")}),e.jsx(q,{type:"button",className:"flex-1",onClick:k,disabled:p||!w.sufficient,children:t("button.confirm")})]})})]})}md.__docgenInfo={description:"",methods:[],displayName:"SignatureAuthPage"};const fd=({params:t})=>e.jsx(Y,{children:e.jsx(ee,{params:t,children:e.jsx(md,{})})});fd.__docgenInfo={description:"",methods:[],displayName:"AuthorizeSignatureActivity"};function pd({walletName:t,onEnterWallet:s,className:n}){const{t:a}=L("onboarding");return e.jsxs("div",{"data-testid":"import-success-step",className:M("flex min-h-screen flex-col items-center justify-center px-6 py-8",n),children:[e.jsx("div",{className:"mb-6 flex size-20 items-center justify-center rounded-full bg-green-100 dark:bg-green-900/30",children:e.jsx(Qt,{className:"size-10 text-green-600 dark:text-green-400"})}),e.jsx("h1",{"data-testid":"success-message",className:"mb-2 text-2xl font-bold",children:a("import.success.title")}),e.jsx("p",{className:"text-muted-foreground mb-8 text-center",children:e.jsx(ro,{i18nKey:"import.success.description",ns:"onboarding",values:{name:t},components:{bold:e.jsx("span",{className:"text-foreground font-medium"})}})}),e.jsx("div",{className:"w-full max-w-xs",children:e.jsxs("button",{type:"button","data-testid":"enter-wallet-button",onClick:s,className:M("flex w-full items-center justify-center gap-2 rounded-full py-3 font-medium transition-colors","bg-primary hover:bg-primary/90 text-primary-foreground"),children:[e.jsx("span",{children:a("import.success.enterWallet")}),e.jsx(Ce,{className:"size-5"})]})})]})}pd.__docgenInfo={description:"Success screen shown after wallet import",methods:[],displayName:"ImportWalletSuccess",props:{walletName:{required:!0,tsType:{name:"string"},description:"Wallet name"},onEnterWallet:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback when user chooses to enter wallet"},className:{required:!1,tsType:{name:"string"},description:"Additional class name"}}};function Ov(t){if(!Ui(t))throw new Error("Invalid mnemonic");return Kd(t.join(" "))}function Fv(t){return new Set(t.map(s=>s.address.toLowerCase()))}const Vn={isDuplicate:!1,type:"none"};function Wv(t){const[s,n]=l.useState(Vn),[a,r]=l.useState(!1),[o,c]=l.useState(null),i=l.useCallback(async u=>{r(!0),c(null);try{const m=Ov(u),f=Fv(m),h=await t.getAllAddresses();for(const g of h)if(f.has(g.address.toLowerCase())){const b={isDuplicate:!0,type:"address",matchedWallet:{id:g.walletId,name:g.walletName,importType:"mnemonic",matchedAddress:g.address}};return n(b),b}const y=(await t.getAllMainWallets()).filter(g=>g.importType==="privateKey");for(const g of y)for(const b of g.addresses)if(f.has(b.address.toLowerCase())){const x={isDuplicate:!0,type:"privateKey",matchedWallet:{id:g.id,name:g.name,importType:"privateKey",matchedAddress:b.address}};return n(x),x}const p={isDuplicate:!1,type:"none"};return n(p),p}catch(m){const f=m instanceof Error?m.message:"";return c(f),Vn}finally{r(!1)}},[t]),d=l.useCallback(()=>{n(Vn),c(null)},[]);return{result:s,isChecking:a,error:o,check:i,reset:d}}const $v={getAllAddresses:async()=>[],getAllMainWallets:async()=>[],findWalletByAddress:async()=>null};function hd(){const{navigate:t,goBack:s}=Z(),{push:n}=K(),{t:a}=L(["onboarding","common","wallet"]),r=ms(),o=st().snapshot,c=Ei(),[i,d]=l.useState("keyType"),[u,m]=l.useState("mnemonic"),[f,h]=l.useState(!1),[v,y]=l.useState([]),[p,g]=l.useState(""),[b,x]=l.useState(null),[j,N]=l.useState([]),[w,S]=l.useState(!1),[C,T]=l.useState(""),[k,I]=l.useState(null),[R,P]=l.useState([]),[A,D]=l.useState(!1);l.useEffect(()=>{!A&&r.length>0&&(P(eo(r)),D(!0))},[r,A]);const _=Wv($v),B=(()=>{switch(i){case"keyType":return 1;case"mnemonic":case"arbitrary":return 2;case"collision":return 2;case"pattern":return 3;case"chains":return 4;case"theme":return 5;case"success":return 5;default:return 1}})(),E=l.useCallback(()=>{switch(i){case"keyType":s();break;case"mnemonic":case"arbitrary":d("keyType"),_.reset();break;case"collision":d("mnemonic"),_.reset();break;case"pattern":d(u==="arbitrary"?"arbitrary":"mnemonic");break;case"chains":d("pattern");break;case"theme":d("chains");break}},[i,s,_,u]),z=l.useCallback(()=>{d("pattern")},[]),O=l.useCallback(he=>{T(he),d("chains")},[]),H=l.useCallback(()=>{if(u==="mnemonic"){d("mnemonic");return}if(f){d("arbitrary");return}Sg(()=>{h(!0),d("arbitrary")}),n("SecurityWarningJob",{})},[u,f,n]),te=l.useCallback(async he=>{y(he.mnemonic);const F=await _.check(he.mnemonic);if(F.isDuplicate){if(F.type==="address"){console.log("Duplicate detected:",F.matchedWallet?.name);return}else if(F.type==="privateKey"){d("collision");return}}z()},[_,z]),Q=l.useCallback(async()=>{z()},[z]),V=l.useCallback(()=>{d("mnemonic"),_.reset()},[_]),G=l.useCallback(async(he,F)=>{S(!0);try{const se=he.join(" "),ue=(await Hi({mnemonic:se,selectedChainIds:R,chainConfigs:r})).map(({chainId:Hd,address:Ud,publicKey:Jd})=>({chain:Hd,address:Ud,publicKey:Jd??"",tokens:[]})),we=ue[0];if(!we)throw new Error("No chain addresses derived");const xe=Yn(we.address),qd=await de.createWallet({name:a("wallet:defaultName"),keyType:"mnemonic",address:we.address,chain:we.chain,chainAddresses:ue,themeHue:xe},se,F,xe);I(qd.id),d("theme")}catch(se){console.error(":",se)}finally{S(!1)}},[r,R,a]),ie=l.useCallback(async he=>{const F=p.trim();if(F&&j.length!==0){S(!0);try{const se=j[0];if(!se)throw new Error("No enabled bioforest chains");const X=Yn(se.address),ue=j.map(xe=>({chain:xe.chainId,address:xe.address,publicKey:"",tokens:[]})),we=await de.createWallet({name:a("wallet:defaultName"),keyType:"arbitrary",address:se.address,chain:se.chainId,chainAddresses:ue,themeHue:X},F,he,X);I(we.id),d("theme")}catch(se){console.error(":",se)}finally{S(!1)}}},[j,p,a]),je=l.useCallback(()=>{t({to:"/",replace:!0})},[t]),Qe=l.useCallback(async()=>{if(!w){if(u==="arbitrary"){await ie(C);return}v.length!==0&&await G(v,C)}},[ie,G,w,u,v,C]),_t=l.useCallback(()=>{t({to:"/"})},[t]);return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[i==="keyType"&&e.jsxs(e.Fragment,{children:[e.jsx(U,{title:a("onboarding:keyType.title"),onBack:E}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(et,{total:5,current:B})}),e.jsxs("div",{"data-testid":"key-type-step",className:"flex-1 space-y-6 p-4",children:[e.jsx(pm,{value:u,onChange:he=>{m(he),he==="mnemonic"&&(g(""),N([]))}}),e.jsx(q,{type:"button","data-testid":"continue-button",onClick:H,className:"w-full",children:a("common:continue")})]})]}),i==="mnemonic"&&e.jsxs(e.Fragment,{children:[e.jsx(U,{title:a("onboarding:recover.title"),onBack:E}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(et,{total:5,current:B})}),e.jsx("div",{"data-testid":"mnemonic-step",className:"flex-1 p-4",children:e.jsx(Vu,{onSubmit:te,isSubmitting:_.isChecking})})]}),i==="arbitrary"&&e.jsxs(e.Fragment,{children:[e.jsx(U,{title:a("onboarding:keyType.arbitrary"),onBack:E}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(et,{total:5,current:B})}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx(hm,{value:p,onChange:he=>{x(null),g(he)},disabled:w}),b&&e.jsxs("div",{className:"bg-destructive/10 text-destructive flex items-start gap-2 rounded-lg px-3 py-2 text-sm",children:[e.jsx(It,{className:"mt-0.5 size-4 shrink-0"}),e.jsx("span",{children:b})]}),e.jsx(xm,{secret:p,enabledBioforestChainConfigs:o?c:void 0,onDerived:N}),e.jsxs(q,{type:"button",className:"w-full",disabled:w||p.trim()!==""&&j.length===0,onClick:()=>{if(!p.trim()){x(a("onboarding:arbitraryKey.required"));return}z()},children:[w&&e.jsx(ke,{className:"size-4 animate-spin"}),a("common:continue")]})]})]}),i==="collision"&&e.jsxs(e.Fragment,{children:[e.jsx(U,{title:a("onboarding:recover.addressConflict"),onBack:E}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(et,{total:5,current:B})}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(gm,{result:_.result,onConfirm:Q,onCancel:V,isLoading:w})})]}),i==="pattern"&&e.jsxs(e.Fragment,{children:[e.jsx(U,{title:a("onboarding:recover.setWalletLock"),onBack:E}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(et,{total:5,current:B})}),e.jsx("div",{"data-testid":"pattern-step",className:"flex-1 p-4",children:e.jsx(ja,{onComplete:O,minPoints:4})})]}),i==="chains"&&e.jsxs(e.Fragment,{children:[e.jsx(U,{title:a("onboarding:chainSelector.title"),onBack:E}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(et,{total:5,current:B})}),e.jsx("div",{"data-testid":"chains-step",className:"flex-1 p-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(xs,{icon:e.jsx(Qt,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:a("onboarding:chainSelector.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:a("onboarding:chainSelector.subtitle")})]}),r.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(ye,{})}):e.jsx(Sa,{"data-testid":"chain-selector",chains:r,selectedChains:R,onSelectionChange:P}),e.jsx(Ee,{variant:"mint",className:"w-full","data-testid":"chains-continue-button",disabled:R.length===0,onClick:Qe,children:a("common:next")})]})})]}),i==="theme"&&k&&e.jsxs(e.Fragment,{children:[e.jsx(U,{title:a("onboarding:create.themeTitle")}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(et,{total:5,current:B})}),e.jsx("div",{"data-testid":"theme-step",className:"flex-1 p-4",children:e.jsx(En,{mode:"edit-only",walletId:k,onEditOnlyComplete:je})})]}),i==="success"&&e.jsx(pd,{walletName:a("wallet:defaultName"),onEnterWallet:_t})]})}hd.__docgenInfo={description:`Onboarding recover wallet page
Implements wallet recovery with duplicate detection per openspec/changes/add-wallet-recover-duplicate-guards`,methods:[],displayName:"OnboardingRecoverPage"};const xd=()=>e.jsx(Y,{children:e.jsx(hd,{})});xd.__docgenInfo={description:"",methods:[],displayName:"OnboardingRecoverActivity"};const Is={symbol:"USDT",balance:1234.56,fiatValue:"1234.56"},qv=[{id:"1",type:"send",status:"confirmed",amount:ce.fromFormatted("100",6,"USDT"),symbol:"USDT",address:"0xabcd...1234",timestamp:new Date(Date.now()-36e5)},{id:"2",type:"receive",status:"confirmed",amount:ce.fromFormatted("500",6,"USDT"),symbol:"USDT",address:"0x1234...abcd",timestamp:new Date(Date.now()-864e5)}];function gd(){const{t}=L("token"),{navigate:s,goBack:n}=Z();return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:Is.symbol,onBack:n}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsx("div",{className:"text-center",children:e.jsx(vm,{value:Is.balance,symbol:Is.symbol,fiatValue:Is.fiatValue,size:"lg"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(Ee,{variant:"mint",className:"flex-1",onClick:()=>s({to:"/send",search:{address:void 0,chain:void 0,amount:void 0}}),children:[e.jsx(bu,{className:"mr-2 size-4"}),t("detail.send")]}),e.jsxs(Ee,{variant:"blue",className:"flex-1",onClick:()=>s({to:"/receive"}),children:[e.jsx(jn,{className:"mr-2 size-4"}),t("detail.receive")]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold",children:t("detail.transactionHistory")}),e.jsx(io,{transactions:qv,emptyTitle:t("detail.noTransactions"),emptyDescription:t("detail.noTransactionsDesc")})]})]})]})}gd.__docgenInfo={description:"",methods:[],displayName:"TokenDetailPage"};const vd=({params:t})=>e.jsx(Y,{children:e.jsx(ee,{params:t,children:e.jsx(gd,{})})});vd.__docgenInfo={description:"",methods:[],displayName:"TokenDetailActivity"};function yd(){const{t}=L("common"),{goBack:s}=Z(),{push:n}=K(),r=le(Ft).contacts,o=le(me,_e.getCurrentWallet),[c,i]=l.useState(""),d=l.useRef(null),u=l.useMemo(()=>c.trim()?xn.searchContacts(Ft.state,c.trim()):r,[r,c]),m=l.useCallback(()=>{s()},[s]),f=l.useCallback(()=>{n("ContactEditJob",{})},[n]),h=l.useCallback(p=>{n("ContactEditJob",{contactId:p.id})},[n]),v=l.useCallback(p=>{n("ContactShareJob",{name:p.name,addresses:JSON.stringify(p.addresses.map(g=>({address:g.address,label:g.label}))),memo:p.memo,avatar:p.avatar})},[n]),y=l.useCallback(p=>{d.current=p,o?.encryptedMnemonic?(it(async g=>{try{return await ht(o.encryptedMnemonic,g)?(Wt.deleteContact(p.id),d.current=null,!0):!1}catch{return!1}}),n("WalletLockConfirmJob",{title:t("addressBook.deleteTitle"),description:t("addressBook.deleteConfirm",{name:p.name})})):(Wt.deleteContact(p.id),d.current=null)},[o?.encryptedMnemonic,n,t]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("addressBook.title"),onBack:m,rightAction:e.jsx("button",{onClick:f,className:M("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":t("a11y.addContact"),"data-testid":"address-book-add-button",children:e.jsx(nt,{className:"size-5"})})}),e.jsx("div",{className:"px-4 py-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(ys,{className:"text-muted-foreground absolute top-1/2 left-3 size-4 -translate-y-1/2"}),e.jsx("input",{type:"text",value:c,onChange:p=>i(p.target.value),placeholder:t("addressBook.searchPlaceholder"),className:M("border-border bg-background w-full rounded-xl border py-2.5 pr-4 pl-10","focus:ring-primary focus:ring-2 focus:outline-none")})]})}),e.jsx("div",{className:"flex-1 p-4",children:u.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[e.jsx(Ku,{className:"text-muted-foreground/50 size-12"}),e.jsx("p",{className:"text-muted-foreground",children:t(c?"addressBook.noResults":"addressBook.noContacts")}),!c&&e.jsx("button",{onClick:f,className:M("bg-primary rounded-full px-6 py-2.5 text-sm font-medium text-primary-foreground","hover:bg-primary/90 active:bg-primary/80"),children:t("contact.addTitle")})]}):e.jsx("div",{className:"space-y-2",children:u.map(p=>e.jsx(Hv,{contact:p,onShare:()=>v(p),onEdit:()=>h(p),onDelete:()=>y(p)},p.id))})})]})}function Hv({contact:t,onEdit:s,onDelete:n,onShare:a}){const{t:r}=L("common"),[o,c]=l.useState(!1);return e.jsx("div",{className:M("bg-card rounded-xl p-4 shadow-sm","transition-colors"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Nn,{src:t.avatar||(t.addresses[0]?.address?bt(t.addresses[0].address):void 0),size:40}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"truncate font-medium",children:t.name}),t.addresses.length>0&&e.jsxs("p",{className:"text-muted-foreground truncate font-mono text-xs",children:[t.addresses[0]?.address,t.addresses.length>1&&` (+${t.addresses.length-1})`]}),t.memo&&e.jsx("p",{className:"text-muted-foreground mt-1 truncate text-xs",children:t.memo})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>c(!o),className:M("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":r("a11y.moreActions"),children:e.jsx(ym,{className:"text-muted-foreground size-4"})}),o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>c(!1)}),e.jsxs("div",{className:"bg-popover border-border absolute top-full right-0 z-20 mt-1 w-32 rounded-lg border py-1 shadow-lg",children:[e.jsx("button",{onClick:()=>{c(!1),a()},className:"hover:bg-muted w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.shareContact")}),e.jsx("button",{onClick:()=>{c(!1),s()},className:"hover:bg-muted w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.edit")}),e.jsx("button",{onClick:()=>{c(!1),n()},className:"text-destructive hover:bg-destructive/10 w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.delete")})]})]})]})]})})}yd.__docgenInfo={description:"",methods:[],displayName:"AddressBookPage"};const bd=()=>e.jsx(Y,{children:e.jsx(yd,{})});bd.__docgenInfo={description:"",methods:[],displayName:"AddressBookActivity"};const jd={notifications:[],unreadCount:0,isInitialized:!1},Fe=new Yd(jd),ma="bfm_notifications";function Ps(t){try{localStorage.setItem(ma,JSON.stringify(t))}catch(s){console.error("Failed to persist notifications:",s)}}function Es(t){return t.filter(s=>!s.read).length}const ts={initialize:()=>{try{const t=localStorage.getItem(ma);if(t){const s=JSON.parse(t);Fe.setState(()=>({notifications:s,unreadCount:Es(s),isInitialized:!0}))}else Fe.setState(s=>({...s,isInitialized:!0}))}catch(t){console.error("Failed to initialize notifications:",t),Fe.setState(s=>({...s,isInitialized:!0}))}},add:t=>{const s={...t,id:crypto.randomUUID(),timestamp:Date.now(),read:!1};return Fe.setState(n=>{const a=[s,...n.notifications];return Ps(a),{...n,notifications:a,unreadCount:Es(a)}}),s},markRead:t=>{Fe.setState(s=>{const n=s.notifications.map(a=>a.id===t?{...a,read:!0}:a);return Ps(n),{...s,notifications:n,unreadCount:Es(n)}})},markAllRead:()=>{Fe.setState(t=>{const s=t.notifications.map(n=>({...n,read:!0}));return Ps(s),{...t,notifications:s,unreadCount:0}})},remove:t=>{Fe.setState(s=>{const n=s.notifications.filter(a=>a.id!==t);return Ps(n),{...s,notifications:n,unreadCount:Es(n)}})},clearAll:()=>{localStorage.removeItem(ma),Fe.setState(()=>jd)}},Uv={transaction:{icon:"",bg:"bg-blue-100 dark:bg-blue-900/30"},security:{icon:"",bg:"bg-red-100 dark:bg-red-900/30"},system:{icon:"",bg:"bg-gray-100 dark:bg-gray-800/30"}};function Jv(){const{t}=L("notification"),s=ps();return l.useCallback(n=>{const r=Date.now()-n,o=Math.floor(r/6e4),c=Math.floor(r/36e5),i=Math.floor(r/864e5);return o<1?t("time.justNow"):o<60?t("time.minutesAgo",{count:o}):c<24?t("time.hoursAgo",{count:c}):i<7?t("time.daysAgo",{count:i}):new Date(n).toLocaleDateString(s)},[t,s])}function Vv({notification:t,onRead:s,onRemove:n,formatRelativeTime:a,t:r}){const o=Uv[t.type],c=l.useCallback(()=>{t.read||s(t.id)},[t.id,t.read,s]);return e.jsxs("div",{onClick:c,className:M("flex cursor-pointer items-start gap-3 rounded-xl p-4 transition-colors",t.read?"bg-muted/30":"bg-card shadow-sm"),children:[e.jsx("div",{className:M("flex size-10 shrink-0 items-center justify-center rounded-full",o.bg),children:e.jsx("span",{className:"text-lg",children:o.icon})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h4",{className:M("font-medium",t.read&&"text-muted-foreground"),children:t.title}),e.jsx("span",{className:"text-muted-foreground shrink-0 text-xs",children:a(t.timestamp)})]}),e.jsx("p",{className:M("mt-1 text-sm",t.read?"text-muted-foreground":"text-foreground/80"),children:t.message}),!t.read&&e.jsx("div",{className:"bg-primary mt-2 flex size-2 rounded-full","aria-label":r("unread")})]}),e.jsx("button",{onClick:i=>{i.stopPropagation(),n(t.id)},className:"text-muted-foreground hover:text-destructive shrink-0 p-1","aria-label":r("delete"),children:e.jsx(Tt,{className:"size-4"})})]})}function Kv({notifications:t,onRead:s,onRemove:n,formatRelativeTime:a,t:r,language:o}){const c=l.useMemo(()=>{const i=new Map,d=new Date().toLocaleDateString(o),u=new Date(Date.now()-864e5).toLocaleDateString(o);for(const m of t){const f=new Date(m.timestamp).toLocaleDateString(o);let h=f;f===d?h=r("time.today"):f===u&&(h=r("time.yesterday"));const v=i.get(h)||[];i.set(h,[...v,m])}return i},[t,o,r]);return t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx("div",{className:"bg-muted mb-4 flex size-16 items-center justify-center rounded-full",children:e.jsx(bm,{className:"text-muted-foreground size-8"})}),e.jsx("h3",{className:"text-lg font-medium",children:r("empty.title")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:r("empty.desc")})]}):e.jsx("div",{className:"space-y-6",children:Array.from(c.entries()).map(([i,d])=>e.jsxs("div",{children:[e.jsx("h3",{className:"text-muted-foreground mb-2 text-sm font-medium",children:i}),e.jsx("div",{className:"space-y-2",children:d.map(u=>e.jsx(Vv,{notification:u,onRead:s,onRemove:n,formatRelativeTime:a,t:r},u.id))})]},i))})}function Nd(){const{t}=L("notification"),s=ps(),n=Jv(),{goBack:a}=Z(),r=le(Fe);l.useEffect(()=>{r.isInitialized||ts.initialize()},[r.isInitialized]);const o=l.useCallback(u=>{ts.markRead(u)},[]),c=l.useCallback(u=>{ts.remove(u)},[]),i=l.useCallback(()=>{ts.markAllRead()},[]),d=l.useCallback(()=>{ts.clearAll()},[]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("title"),onBack:a,rightAction:r.unreadCount>0?e.jsxs("button",{onClick:i,className:"text-primary hover:bg-primary/10 flex items-center gap-1 rounded-full px-3 py-1.5 text-sm","aria-label":t("markAllRead"),children:[e.jsx(fe,{className:"size-4"}),t("markAllRead")]}):void 0}),e.jsx("div",{className:"bg-card border-b px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:r.unreadCount>0?t("unreadCount",{count:r.unreadCount}):t("noUnread")}),r.notifications.length>0&&e.jsxs(q,{variant:"ghost",size:"sm",onClick:d,className:"text-destructive",children:[e.jsx(Tt,{className:"mr-1 size-4"}),t("clear")]})]})}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(Kv,{notifications:r.notifications,onRead:o,onRemove:c,formatRelativeTime:n,t,language:s})})]})}Nd.__docgenInfo={description:"",methods:[],displayName:"NotificationCenterPage"};const wd=()=>e.jsx(Y,{children:e.jsx(Nd,{})});wd.__docgenInfo={description:"",methods:[],displayName:"NotificationsActivity"};function Gv(t){const s=t.toNumber();return s>=1e9?`${(s/1e9).toFixed(2)}B`:s>=1e6?`${(s/1e6).toFixed(2)}M`:s>=1e3?`${(s/1e3).toFixed(2)}K`:s.toFixed(Math.min(5,8))}function Cd({item:t,onMint:s,className:n}){const{t:a}=L("staking"),r=[{label:a("totalMinted",{asset:t.assetType}),value:t.totalMinted},{label:a("totalCirculation",{asset:t.assetType}),value:t.totalCirculation},{label:a("totalBurned",{asset:t.assetType}),value:t.totalBurned},{label:a("totalStaked",{asset:t.externalAssetType}),value:t.totalStaked}];return e.jsxs("div",{className:M("overflow-hidden rounded-xl shadow-md","bg-gradient-to-b from-primary/90 to-primary",n),children:[e.jsxs("div",{className:"relative grid grid-cols-2 gap-3 p-4",children:[r.map((o,c)=>e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("span",{className:"text-lg font-semibold text-amber-300",children:Gv(o.value)}),e.jsx("span",{className:"text-xs text-primary-foreground/70",children:o.label})]},c)),e.jsx("div",{className:"pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 opacity-20",children:e.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-white/20 text-2xl font-bold text-white",children:t.chain.charAt(0)})})]}),e.jsxs("div",{className:"flex items-center justify-between bg-card px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{symbol:t.externalAssetType,size:"sm"}),e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"font-medium text-foreground",children:t.externalAssetType}),e.jsx("div",{className:"text-muted-foreground",children:t.externalChain})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{symbol:t.assetType,size:"sm"}),e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"font-medium text-foreground",children:t.assetType}),e.jsx("div",{className:"text-muted-foreground",children:t.chain})]})]}),e.jsx(q,{size:"sm",variant:"default",className:"rounded-full px-4",onClick:()=>s?.(t),children:a("mint")})]})]})]})}Cd.__docgenInfo={description:"Staking pool card component",methods:[],displayName:"StakingPoolCard",props:{item:{required:!0,tsType:{name:"StakingOverviewItem"},description:""},onMint:{required:!1,tsType:{name:"union",raw:"((item: StakingOverviewItem) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Qv=[{value:"all",label:"allNetworks"},{value:"ETH",label:"Ethereum"},{value:"BSC",label:"BNB Chain"},{value:"TRON",label:"Tron"},{value:"BFMeta",label:"BFMeta"},{value:"BFChain",label:"BFChain"}];function Sd({onMint:t,className:s}){const{t:n}=L("staking"),[a,r]=l.useState(""),[o,c]=l.useState("all"),[i,d]=l.useState(!1),[u,m]=l.useState([]),[f,h]=l.useState(!0);l.useEffect(()=>{let p=!0;return h(!0),Nt.getOverview().then(g=>{p&&(m(g),h(!1))}),()=>{p=!1}},[]);const v=l.useMemo(()=>{let p=u;if(a.trim()){const g=a.toLowerCase();p=p.filter(b=>b.assetType.toLowerCase().includes(g)||b.externalAssetType.toLowerCase().includes(g)||b.chain.toLowerCase().includes(g)||b.externalChain.toLowerCase().includes(g))}return o!=="all"&&(p=p.filter(g=>g.chain===o||g.externalChain===o)),p},[u,a,o]),y=p=>{c(p),d(!1)};return f?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[e.jsx(ye,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):e.jsxs("div",{className:M("space-y-4",s),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ys,{className:"text-muted-foreground absolute top-1/2 left-3 size-4 -translate-y-1/2"}),e.jsx(Pe,{type:"text",placeholder:n("searchPlaceholder"),value:a,onChange:p=>r(p.target.value),className:"pl-9"})]}),e.jsxs(xt,{open:i,onOpenChange:d,children:[e.jsx(Hu,{render:e.jsxs(q,{variant:"outline",size:"icon",className:"relative",children:[e.jsx(po,{className:"size-4"}),o!=="all"&&e.jsx("span",{className:"bg-primary absolute -top-1 -right-1 size-2 rounded-full"})]})}),e.jsxs(gt,{side:"bottom",className:"h-[60vh]",children:[e.jsx(vt,{children:e.jsx(yt,{children:n("selectNetwork")})}),e.jsx("div",{className:"mt-4 space-y-2",children:Qv.map(p=>e.jsxs("button",{onClick:()=>y(p.value),className:M("flex w-full items-center justify-between rounded-lg px-4 py-3 text-left transition-colors",o===p.value?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("span",{children:p.value==="all"?n("allNetworks"):p.label}),o===p.value&&e.jsx("span",{className:"text-primary",children:""})]},p.value))})]})]})]}),v.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-20",children:e.jsx("p",{className:"text-muted-foreground",children:n("noResults")})}):e.jsx("div",{className:"space-y-4",children:v.map((p,g)=>e.jsx(Cd,{item:p,onMint:t},`${p.chain}-${p.assetType}-${g}`))})]})}Sd.__docgenInfo={description:"Staking overview panel with search and filter",methods:[],displayName:"StakingOverviewPanel",props:{onMint:{required:!1,tsType:{name:"signature",type:"function",raw:"(item: StakingOverviewItem) => void",signature:{arguments:[{type:{name:"StakingOverviewItem"},name:"item"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Yv=["ETH","BSC","TRON"],_s={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron",BFMeta:"BFMeta",BFChain:"BFChain",CCChain:"CCChain",PMChain:"PMChain"},Ni={ETH:{BFM:"1000.00",USDT:"5000.00"},BSC:{BFM:"2500.00",USDT:"10000.00",BFC:"500.00"},TRON:{USDT:"8000.00"}};function Xv(t,s){if(!t)return[];const n=[];for(const[a,r]of Object.entries(t))for(const[o,c]of Object.entries(r)){const i=c.supportChain[s];i&&n.push({asset:i.assetType,targetChain:a,targetAsset:o})}return n}function kd({onSuccess:t,className:s}){const{t:n}=L("staking"),[a,r]=l.useState("BSC"),[o,c]=l.useState(""),[i,d]=l.useState(""),[u,m]=l.useState(""),[f,h]=l.useState(""),[v,y]=l.useState(!1),[p,g]=l.useState(!1),[b,x]=l.useState(!0),[j,N]=l.useState(!1),[w,S]=l.useState(null);l.useEffect(()=>{let _=!0;return Nt.getRechargeConfig().then(B=>{_&&(S(B),x(!1))}),()=>{_=!1}},[]);const C=l.useMemo(()=>Xv(w,a),[w,a]);l.useEffect(()=>{const _=C[0];_&&!o&&(c(_.asset),d(_.targetChain),m(_.targetAsset))},[C,o]);const T=l.useCallback(_=>{r(_),c(""),d(""),m(""),h(""),y(!1)},[]),k=l.useCallback(_=>{c(_.asset),d(_.targetChain),m(_.targetAsset),g(!1)},[]),I=l.useMemo(()=>Ni[a]?.[o]??"0.00",[a,o]),R=l.useCallback(()=>{h(I.replace(/,/g,""))},[I]),P=l.useMemo(()=>{if(!f)return null;const _=parseFloat(f);if(isNaN(_)||_<=0)return n("invalidAmount");const B=parseFloat(I.replace(/,/g,""));return _>B?n("insufficientBalance"):null},[f,I,n]),A=l.useMemo(()=>a&&o&&i&&u&&f&&!P&&!j,[a,o,i,u,f,P,j]),D=l.useCallback(async()=>{if(A){N(!0);try{const _=f.replace(/,/g,""),B={sourceChain:a,sourceAsset:o,amount:ce.fromFormatted(_,18,o),targetChain:i,targetAsset:u},E=await Nt.submitMint(B);t?.(E.id)}finally{N(!1)}}},[A,a,o,f,i,u,t]);return b?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(ye,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):e.jsxs("div",{className:M("space-y-4",s),children:[e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("sourceChain")}),e.jsxs("button",{type:"button",onClick:()=>y(!0),className:"bg-background mb-3 flex w-full items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-muted flex size-6 items-center justify-center rounded-full text-xs font-bold",children:a.charAt(0)}),e.jsx("span",{className:"font-medium",children:_s[a]})]}),e.jsx(Ce,{className:"text-muted-foreground size-4"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>g(!0),className:"bg-background flex shrink-0 items-center gap-2 rounded-lg px-3 py-2",children:[e.jsx(Ve,{symbol:o||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:o||n("selectToken")}),e.jsx(Ce,{className:"text-muted-foreground size-4"})]}),e.jsx("div",{className:"flex-1",children:e.jsx(Pe,{type:"text",inputMode:"decimal",placeholder:"0.00",value:f,onChange:_=>h(_.target.value),className:"border-0 bg-transparent text-right text-lg font-semibold"})})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-muted-foreground",children:[n("availableBalance"),": ",I]}),e.jsx(q,{type:"button",variant:"ghost",size:"sm",className:"text-primary h-auto px-2 py-1 text-xs",onClick:R,children:n("max")})]}),P&&e.jsx("div",{className:"text-destructive mt-2 text-xs",children:P})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-muted rounded-full p-2",children:e.jsx(jn,{className:"text-muted-foreground size-4"})})}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("targetChain")}),e.jsxs("div",{className:"bg-background flex items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-primary/20 text-primary flex size-6 items-center justify-center rounded-full text-xs font-bold",children:i.charAt(0)||"?"}),e.jsx("span",{className:"font-medium",children:_s[i]||n("selectToken")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{symbol:u||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:u||"-"})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:n("amount")}),e.jsxs("span",{className:"font-semibold",children:[f||"0.00"," ",u]})]})]}),e.jsx(q,{type:"button",size:"lg",className:"w-full",disabled:!A,onClick:D,children:j?e.jsxs(e.Fragment,{children:[e.jsx(ye,{size:"sm"}),e.jsx("span",{className:"ml-2",children:n("confirm")})]}):n("confirm")}),e.jsx(xt,{open:v,onOpenChange:y,children:e.jsxs(gt,{side:"bottom",className:"h-[50vh]",children:[e.jsx(vt,{children:e.jsx(yt,{children:n("selectChain")})}),e.jsx("div",{className:"mt-4 space-y-2",children:Yv.map(_=>e.jsxs("button",{onClick:()=>T(_),className:M("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",a===_?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("div",{className:"bg-muted flex size-8 items-center justify-center rounded-full text-sm font-bold",children:_.charAt(0)}),e.jsx("span",{className:"font-medium",children:_s[_]}),a===_&&e.jsx("span",{className:"text-primary ml-auto",children:""})]},_))})]})}),e.jsx(xt,{open:p,onOpenChange:g,children:e.jsxs(gt,{side:"bottom",className:"h-[60vh]",children:[e.jsx(vt,{children:e.jsx(yt,{children:n("selectToken")})}),e.jsx("div",{className:"mt-4 space-y-2",children:C.length===0?e.jsx("p",{className:"text-muted-foreground py-8 text-center",children:n("noResults")}):C.map(_=>e.jsxs("button",{onClick:()=>k(_),className:M("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",o===_.asset?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx(Ve,{symbol:_.asset,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:_.asset}),e.jsxs("div",{className:"text-muted-foreground text-xs",children:[" ",_s[_.targetChain]," (",_.targetAsset,")"]})]}),e.jsx("div",{className:"text-muted-foreground text-right text-sm",children:Ni[a]?.[_.asset]??"0.00"}),o===_.asset&&e.jsx("span",{className:"text-primary",children:""})]},`${_.targetChain}-${_.asset}`))})]})})]})}kd.__docgenInfo={description:"Mint form component",methods:[],displayName:"MintForm",props:{onSuccess:{required:!1,tsType:{name:"signature",type:"function",raw:"(txId: string) => void",signature:{arguments:[{type:{name:"string"},name:"txId"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Zv=["BFMeta","BFChain","CCChain","PMChain"],Ms={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron",BFMeta:"BFMeta",BFChain:"BFChain",CCChain:"CCChain",PMChain:"PMChain"},wi={BFMeta:{BFM:"5000.00",USDT:"2500.00"},BFChain:{BFC:"1000.00"},CCChain:{},PMChain:{}};function ey(t,s){if(!t)return[];const n=s.toLowerCase(),a=t[n];if(!a)return[];const r=[];for(const[o,c]of Object.entries(a)){const i=[];c.supportChain.ETH&&i.push("ETH"),c.supportChain.BSC&&i.push("BSC"),c.supportChain.TRON&&i.push("TRON"),i.length>0&&r.push({asset:o,targetChains:i})}return r}function Ad({onSuccess:t,className:s}){const{t:n}=L("staking"),[a,r]=l.useState("BFMeta"),[o,c]=l.useState(""),[i,d]=l.useState(""),[u,m]=l.useState(""),[f,h]=l.useState(!1),[v,y]=l.useState(!1),[p,g]=l.useState(!1),[b,x]=l.useState(!0),[j,N]=l.useState(!1),[w,S]=l.useState(null);l.useEffect(()=>{let E=!0;return Nt.getRechargeConfig().then(z=>{E&&(S(z),x(!1))}),()=>{E=!1}},[]);const C=l.useMemo(()=>ey(w,a),[w,a]),T=l.useMemo(()=>o?C.find(z=>z.asset===o)?.targetChains??[]:[],[C,o]);l.useEffect(()=>{const E=C[0];if(E&&!o){c(E.asset);const z=E.targetChains[0];z&&d(z)}},[C,o]);const k=l.useCallback(E=>{r(E),c(""),d(""),m(""),h(!1)},[]),I=l.useCallback(E=>{c(E.asset);const z=E.targetChains[0];z&&d(z),y(!1)},[]),R=l.useCallback(E=>{d(E),g(!1)},[]),P=l.useMemo(()=>wi[a]?.[o]??"0.00",[a,o]),A=l.useCallback(()=>{m(P.replace(/,/g,""))},[P]),D=l.useMemo(()=>{if(!u)return null;const E=parseFloat(u);if(isNaN(E)||E<=0)return n("invalidAmount");const z=parseFloat(P.replace(/,/g,""));return E>z?n("insufficientBalance"):null},[u,P,n]),_=l.useMemo(()=>a&&o&&i&&u&&!D&&!j,[a,o,i,u,D,j]),B=l.useCallback(async()=>{if(!(!_||!i)){N(!0);try{const E=u.replace(/,/g,""),z={sourceChain:a,sourceAsset:o,amount:ce.fromFormatted(E,8,o),targetChain:i,targetAsset:o},O=await Nt.submitBurn(z);t?.(O.id)}finally{N(!1)}}},[_,a,o,u,i,t]);return b?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(ye,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):e.jsxs("div",{className:M("space-y-4",s),children:[e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("sourceChain")}),e.jsxs("button",{type:"button",onClick:()=>h(!0),className:"bg-background mb-3 flex w-full items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-primary/20 text-primary flex size-6 items-center justify-center rounded-full text-xs font-bold",children:a.charAt(0)}),e.jsx("span",{className:"font-medium",children:Ms[a]})]}),e.jsx(Ce,{className:"text-muted-foreground size-4"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>y(!0),className:"bg-background flex shrink-0 items-center gap-2 rounded-lg px-3 py-2",children:[e.jsx(Ve,{symbol:o||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:o||n("selectToken")}),e.jsx(Ce,{className:"text-muted-foreground size-4"})]}),e.jsx("div",{className:"flex-1",children:e.jsx(Pe,{type:"text",inputMode:"decimal",placeholder:"0.00",value:u,onChange:E=>m(E.target.value),className:"border-0 bg-transparent text-right text-lg font-semibold"})})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-muted-foreground",children:[n("availableBalance"),": ",P]}),e.jsx(q,{type:"button",variant:"ghost",size:"sm",className:"text-primary h-auto px-2 py-1 text-xs",onClick:A,children:n("max")})]}),D&&e.jsx("div",{className:"text-destructive mt-2 text-xs",children:D})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-muted rounded-full p-2",children:e.jsx(jn,{className:"text-muted-foreground size-4"})})}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("targetChain")}),e.jsxs("button",{type:"button",onClick:()=>g(!0),disabled:T.length===0,className:"bg-background flex w-full items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-muted flex size-6 items-center justify-center rounded-full text-xs font-bold",children:i?i.charAt(0):"?"}),e.jsx("span",{className:"font-medium",children:i?Ms[i]:n("selectChain")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{symbol:o||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:o||"-"}),e.jsx(Ce,{className:"text-muted-foreground size-4"})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:n("amount")}),e.jsxs("span",{className:"font-semibold",children:[u||"0.00"," ",o]})]})]}),e.jsx(q,{type:"button",size:"lg",className:"w-full",disabled:!_,onClick:B,children:j?e.jsxs(e.Fragment,{children:[e.jsx(ye,{size:"sm"}),e.jsx("span",{className:"ml-2",children:n("confirm")})]}):n("confirm")}),e.jsx(xt,{open:f,onOpenChange:h,children:e.jsxs(gt,{side:"bottom",className:"h-[50vh]",children:[e.jsx(vt,{children:e.jsx(yt,{children:n("selectChain")})}),e.jsx("div",{className:"mt-4 space-y-2",children:Zv.map(E=>e.jsxs("button",{onClick:()=>k(E),className:M("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",a===E?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("div",{className:"bg-primary/20 text-primary flex size-8 items-center justify-center rounded-full text-sm font-bold",children:E.charAt(0)}),e.jsx("span",{className:"font-medium",children:Ms[E]}),a===E&&e.jsx("span",{className:"text-primary ml-auto",children:""})]},E))})]})}),e.jsx(xt,{open:v,onOpenChange:y,children:e.jsxs(gt,{side:"bottom",className:"h-[60vh]",children:[e.jsx(vt,{children:e.jsx(yt,{children:n("selectToken")})}),e.jsx("div",{className:"mt-4 space-y-2",children:C.length===0?e.jsx("p",{className:"text-muted-foreground py-8 text-center",children:n("noResults")}):C.map(E=>e.jsxs("button",{onClick:()=>I(E),className:M("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",o===E.asset?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx(Ve,{symbol:E.asset,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:E.asset}),e.jsxs("div",{className:"text-muted-foreground text-xs",children:[" ",E.targetChains.join(", ")]})]}),e.jsx("div",{className:"text-muted-foreground text-right text-sm",children:wi[a]?.[E.asset]??"0.00"}),o===E.asset&&e.jsx("span",{className:"text-primary",children:""})]},E.asset))})]})}),e.jsx(xt,{open:p,onOpenChange:g,children:e.jsxs(gt,{side:"bottom",className:"h-[50vh]",children:[e.jsx(vt,{children:e.jsx(yt,{children:n("selectChain")})}),e.jsx("div",{className:"mt-4 space-y-2",children:T.map(E=>e.jsxs("button",{onClick:()=>R(E),className:M("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",i===E?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("div",{className:"bg-muted flex size-8 items-center justify-center rounded-full text-sm font-bold",children:E.charAt(0)}),e.jsx("span",{className:"font-medium",children:Ms[E]}),i===E&&e.jsx("span",{className:"text-primary ml-auto",children:""})]},E))})]})})]})}Ad.__docgenInfo={description:"Burn form component",methods:[],displayName:"BurnForm",props:{onSuccess:{required:!1,tsType:{name:"signature",type:"function",raw:"(txId: string) => void",signature:{arguments:[{type:{name:"string"},name:"txId"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Ci={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron",BFMeta:"BFMeta",BFChain:"BFChain",CCChain:"CCChain",PMChain:"PMChain"};function ty({status:t}){switch(t){case"pending":return e.jsx(um,{className:"size-4 text-yellow-500"});case"confirming":return e.jsx(ke,{className:"size-4 animate-spin text-blue-500"});case"confirmed":return e.jsx(Qt,{className:"size-4 text-green-500"});case"failed":return e.jsx(jm,{className:"text-destructive size-4"})}}function sy(t){const n=Date.now()-t;return n<6e4?"Just now":n<36e5?`${Math.floor(n/6e4)}m ago`:n<864e5?`${Math.floor(n/36e5)}h ago`:new Date(t).toLocaleDateString()}function ny(t){const s=t.toNumber();return s>=1e6?`${(s/1e6).toFixed(2)}M`:s>=1e3?`${(s/1e3).toFixed(2)}K`:s.toFixed(4)}function ay({record:t,onClick:s}){const{t:n}=L("staking"),a=t.type==="mint",r=a?Im:uo;return e.jsxs("button",{type:"button",onClick:s,className:"bg-card hover:bg-muted/50 flex w-full items-center gap-3 rounded-lg p-3 text-left transition-colors",children:[e.jsx("div",{className:M("flex size-10 items-center justify-center rounded-full",a?"bg-green-500/10":"bg-orange-500/10"),children:e.jsx(r,{className:M("size-5",a?"text-green-500":"text-orange-500")})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:n(a?"mint":"burn")}),e.jsx(ty,{status:t.status})]}),e.jsxs("div",{className:"text-muted-foreground flex items-center gap-1 text-xs",children:[e.jsx("span",{children:Ci[t.sourceChain]}),e.jsx("span",{children:""}),e.jsx("span",{children:Ci[t.targetChain]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(Ve,{symbol:t.sourceAsset,size:"sm"}),e.jsx("span",{className:"font-medium",children:ny(t.sourceAmount)})]}),e.jsx("div",{className:"text-muted-foreground text-xs",children:sy(t.createdAt)})]})]})}function Td({filterType:t="all",onRecordClick:s,className:n}){const{t:a}=L("staking"),[r,o]=l.useState([]),[c,i]=l.useState(!0),[d,u]=l.useState(t==="all"?"all":t);l.useEffect(()=>{let v=!0;return i(!0),Nt.getTransactions().then(y=>{v&&(o(y),i(!1))}),()=>{v=!1}},[]);const m=l.useMemo(()=>d==="all"?r:r.filter(v=>v.type===d),[r,d]),f=[{id:"all",label:a("history")},{id:"mint",label:a("mint")},{id:"burn",label:a("burn")}],h=l.useCallback(()=>{i(!0),Nt.getTransactions().then(v=>{o(v),i(!1)})},[]);return c?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(ye,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:a("loading")})]}):e.jsxs("div",{className:M("space-y-4",n),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[f.map(v=>e.jsx(q,{type:"button",variant:d===v.id?"default":"outline",size:"sm",onClick:()=>u(v.id),children:v.label},v.id)),e.jsx(q,{type:"button",variant:"ghost",size:"sm",className:"ml-auto",onClick:h,children:a("refresh")})]}),m.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:a("noTransactions")})}):e.jsx("div",{className:"space-y-2",children:m.map(v=>e.jsx(ay,{record:v,onClick:()=>s?.(v)},v.id))})]})}Td.__docgenInfo={description:"Staking record list component",methods:[],displayName:"StakingRecordList",props:{filterType:{required:!1,tsType:{name:"union",raw:"StakingTxType | 'all'",elements:[{name:"StakingTxType"},{name:"literal",value:"'all'"}]},description:"Filter by transaction type",defaultValue:{value:"'all'",computed:!1}},onRecordClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(record: StakingTransaction) => void",signature:{arguments:[{type:{name:"StakingTransaction"},name:"record"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};function Id(){const{t}=L("staking"),{goBack:s}=Z(),[n,a]=l.useState("overview"),r=[{id:"overview",label:t("overview")},{id:"mint",label:t("mint")},{id:"burn",label:t("burn")},{id:"history",label:t("history")}],o=c=>{a("mint")};return e.jsxs("div",{className:"flex min-h-screen flex-col bg-background",children:[e.jsx(U,{title:t("title"),onBack:s}),e.jsx("div",{className:"flex border-b border-border px-4",children:r.map(c=>e.jsx("button",{onClick:()=>a(c.id),className:M("flex-1 py-3 text-sm font-medium transition-colors",n===c.id?"border-b-2 border-primary text-primary":"text-muted-foreground hover:text-foreground"),children:c.label},c.id))}),e.jsxs("div",{className:"flex-1 p-4",children:[n==="overview"&&e.jsx(Sd,{onMint:o}),n==="mint"&&e.jsx(ry,{}),n==="burn"&&e.jsx(iy,{}),n==="history"&&e.jsx(Td,{})]})]})}function ry(){const{t}=L("staking"),s=n=>{console.log("Mint transaction submitted:",n)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:t("mintDescription")}),e.jsx(kd,{onSuccess:s})]})}function iy(){const{t}=L("staking"),s=n=>{console.log("Burn transaction submitted:",n)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:t("burnDescription")}),e.jsx(Ad,{onSuccess:s})]})}Id.__docgenInfo={description:"Staking page with tab navigation",methods:[],displayName:"StakingPage"};const Pd=()=>e.jsx(Y,{children:e.jsx(Id,{})});Pd.__docgenInfo={description:"",methods:[],displayName:"StakingActivity"};const oy=Vt({assetType:$(),decimals:St(),amount:$().optional(),useDefaultDecimals:Je().optional(),logoUrl:$().optional(),contractAddress:$().optional()}),cy=Vt({address:$(),symbol:$(),addressKey:$(),mainWalletId:$(),chain:$(),mnemonic:$().optional(),privateKey:$(),publicKey:$().optional(),isCustomAssets:Je().optional(),isFreezed:Je().optional(),assets:He(oy),name:$(),prohibitChangeName:Je().optional(),index:St().optional(),purpose:ya([qe(44),qe(49),qe(84),qe(86)]).optional()}),ly=Vt({chainName:$(),addressKey:$(),address:$(),symbol:$(),mainWalletId:$(),index:St().optional(),purpose:ya([qe(44),qe(49),qe(84),qe(86)]).optional()});Vt({name:$(),skipBackup:Je().optional(),importPhrase:$(),importType:$(),addressKeyList:He(ly),mainWalletId:$(),headSculpture:$(),createTimestamp:St(),lastBitcoinAddressKey:$().optional()});Vt({addressBookId:$(),name:$(),address:$(),chainList:He($()).optional(),remarks:$().optional(),iconName:$().optional(),symbol:$().optional()});Vt({password:$(),passwordTips:$().optional(),lastWalletActivate:cy.optional(),walletLock:Je().optional(),fingerprintLock:Je().optional(),fingerprintPay:Je().optional()});const dy=l.createContext(null);function uy(){return l.useContext(dy)}const my="keyapp_welcome_shown";function Rs(){localStorage.setItem(my,"1")}function Ed(){const{t}=L("guide"),{navigate:s}=Z(),[n,a]=l.useState(0),r=uy(),o=l.useMemo(()=>[{icon:e.jsx(xo,{className:"text-primary size-16"}),title:t("welcome.slides.transfer.title"),description:t("welcome.slides.transfer.description")},{icon:e.jsx(ho,{className:"text-primary size-16"}),title:t("welcome.slides.multichain.title"),description:t("welcome.slides.multichain.description")},{icon:e.jsx(Nm,{className:"text-primary size-16"}),title:t("welcome.slides.security.title"),description:t("welcome.slides.security.description")}],[t]),c=o[n];if(!c)return null;const i=l.useCallback(()=>{Rs(),s({to:"/wallet/create"})},[s]),d=l.useCallback(()=>{Rs(),s({to:"/onboarding/recover"})},[s]),u=l.useCallback(()=>{Rs(),s({to:"/onboarding/migrate"})},[s]),m=l.useCallback(()=>{Rs(),s({to:"/"})},[s]),f=l.useCallback(()=>{n<o.length-1&&a(y=>y+1)},[n,o.length]),h=n===o.length-1,v=r?.shouldPromptMigration;return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx("div",{className:"flex justify-end p-4",children:e.jsx(q,{variant:"ghost",size:"sm","data-testid":"skip-button",onClick:m,children:t("welcome.skip")})}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center px-8",children:[e.jsx("div",{className:"bg-primary/10 mb-8 flex size-32 items-center justify-center rounded-full",children:c.icon}),e.jsx("h1",{className:"mb-4 text-center text-2xl font-bold",children:c.title}),e.jsx("p",{className:"text-muted-foreground mb-8 max-w-sm text-center",children:c.description}),e.jsx("div",{className:"mb-8 flex gap-2",children:o.map((y,p)=>e.jsx("button",{"data-testid":`slide-dot-${p}`,onClick:()=>a(p),className:M("size-2 rounded-full transition-colors",p===n?"bg-primary":"bg-muted-foreground/30"),"aria-label":t("welcome.goToSlide",{number:p+1})},p))})]}),e.jsx("div",{className:"p-6",children:h?e.jsxs("div",{className:"flex flex-col gap-3",children:[v&&e.jsxs(q,{"data-testid":"migrate-button",onClick:u,className:"w-full",size:"lg",variant:"default",children:[e.jsx(Na,{className:"mr-2 size-4"}),t("welcome.migrateFromMpay",{defaultValue:" mpay "})]}),e.jsx(q,{"data-testid":"get-started-button",onClick:i,className:"w-full",size:"lg",variant:v?"outline":"default",children:t("welcome.getStarted")}),e.jsx(q,{"data-testid":"have-wallet-button",onClick:d,variant:"outline",className:"w-full",size:"lg",children:t("welcome.haveWallet")})]}):e.jsxs(q,{"data-testid":"next-button",onClick:f,className:"w-full",size:"lg",children:[t("welcome.next"),e.jsx(Ce,{className:"ml-2 size-4"})]})})]})}Ed.__docgenInfo={description:"",methods:[],displayName:"WelcomeScreen"};const _d=()=>e.jsx(Y,{children:e.jsx(Ed,{})});_d.__docgenInfo={description:"",methods:[],displayName:"WelcomeActivity"};function Md(){const{t}=L(["wallet","onboarding","security","common"]),{goBack:s}=Z(),n=be(),a=ms(),r=Le(),[o,c]=l.useState("select"),[i,d]=l.useState([]),[u,m]=l.useState([]),[f,h]=l.useState(!1),v=l.useRef(!1);l.useEffect(()=>{!v.current&&n&&(d(n.chainAddresses.map(b=>b.chain)),v.current=!0)},[n]);const y=l.useCallback(()=>{if(!n)return!1;const b=new Set(n.chainAddresses.map(x=>x.chain));return b.size!==i.length?!0:i.some(x=>!b.has(x))},[n,i]),p=l.useCallback(()=>{if(!y()){s();return}c("verify")},[y,s]),g=l.useCallback(async b=>{if(!(!n||b.length<4)){h(!1),c("saving");try{const x=At(b);await de.updateWalletChainAddresses(n.id,i,x,a),!i.includes(r)&&i.length>0&&de.setSelectedChain(i[0]),c("success"),setTimeout(()=>{s()},1500)}catch(x){console.error("Failed to update chain addresses:",x),x instanceof Error&&x.message.includes("decrypt")?(h(!0),m([]),c("verify"),setTimeout(()=>{h(!1)},1500)):c("select")}}},[n,i,a,s]);return n?o==="saving"?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(U,{title:t("wallet:chains.title")}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx(ye,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground",children:t("wallet:chains.saving")})]})]}):o==="success"?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(U,{title:t("wallet:chains.title")}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-green-500/10",children:e.jsx(fe,{className:"size-8 text-green-500"})}),e.jsx("p",{className:"font-medium",children:t("wallet:chains.success")})]})]}):o==="verify"?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(U,{title:t("wallet:chains.verifyTitle"),onBack:()=>{c("select"),m([])}}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:t("wallet:chains.verifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("wallet:chains.verifyDesc")})]}),e.jsx(Gt,{value:u,onChange:m,onComplete:g,minPoints:4,error:f,"data-testid":"wallet-chains-pattern"})]})]}):e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(U,{title:t("wallet:chains.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(xs,{icon:e.jsx(Qt,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:t("onboarding:chainSelector.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("onboarding:chainSelector.subtitle")})]}),a.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(ye,{})}):e.jsx(Sa,{"data-testid":"wallet-chains-selector",chains:a,selectedChains:i,onSelectionChange:d}),e.jsx(Ee,{variant:"mint",className:"w-full","data-testid":"wallet-chains-save",disabled:i.length===0,onClick:p,children:y()?t("common:save"):t("common:done")})]})]}):e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(U,{title:t("wallet:chains.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx(wt,{variant:"warning",children:t("wallet:chains.noWallet")})})]})}Md.__docgenInfo={description:"",methods:[],displayName:"WalletChainsPage"};const Rd=()=>e.jsx(Y,{children:e.jsx(Md,{})});Rd.__docgenInfo={description:"",methods:[],displayName:"SettingsWalletChainsActivity"};function Kn(t){if(t===0)return"0 B";const s=1024,n=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(s));return`${parseFloat((t/Math.pow(s,a)).toFixed(2))} ${n[a]}`}function Dd(){const{t}=L(["settings","common"]),{goBack:s}=Z(),{push:n}=K(),[a,r]=l.useState(null),[o,c]=l.useState(!0),i=l.useCallback(async()=>{c(!0);try{if(navigator.storage&&navigator.storage.estimate){const u=await navigator.storage.estimate();r({usage:u.usage??0,quota:u.quota??0})}}catch(u){console.error("Failed to get storage estimate:",u)}finally{c(!1)}},[]);l.useEffect(()=>{i()},[i]);const d=a?a.usage/a.quota*100:0;return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("settings:storage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"bg-primary/10 flex size-10 items-center justify-center rounded-full",children:e.jsx(fo,{className:"text-primary size-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:t("settings:storage.usage")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:t("settings:storage.basedOn")})]})]}),o?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(ke,{className:"text-muted-foreground size-6 animate-spin"})}):a?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"bg-muted h-3 w-full overflow-hidden rounded-full",children:e.jsx("div",{className:"bg-primary h-full rounded-full transition-all",style:{width:`${Math.min(d,100)}%`}})}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[t("settings:storage.used"),": ",Kn(a.usage)]}),e.jsxs("span",{className:"text-muted-foreground",children:[t("settings:storage.total"),": ",Kn(a.quota)]})]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:t("settings:storage.usagePercent")}),e.jsxs("span",{className:"font-medium",children:[d.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:t("settings:storage.available")}),e.jsx("span",{className:"font-medium",children:Kn(a.quota-a.usage)})]})]})]}):e.jsx("p",{className:"text-muted-foreground text-center py-4",children:t("settings:storage.unavailable")})]}),e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"font-medium mb-2",children:t("settings:storage.clearTitle")}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:t("settings:storage.clearDesc")}),e.jsxs(q,{variant:"destructive",className:"w-full",onClick:()=>n("ClearDataConfirmJob",{}),children:[e.jsx(Tt,{className:"size-4 mr-2"}),t("settings:items.clearData")]})]})]})]})}Dd.__docgenInfo={description:"",methods:[],displayName:"SettingsStoragePage"};const zd=()=>e.jsx(Y,{children:e.jsx(Dd,{})});zd.__docgenInfo={description:"",methods:[],displayName:"SettingsStorageActivity"};const Bd=()=>{const{t}=L("common"),{pop:s}=K(),n=le(Ct),[a,r]=l.useState(!1),[o,c]=l.useState(""),[i,d]=l.useState(""),[u,m]=l.useState(!1),[f,h]=l.useState(null),v=async()=>{if(!o.trim()){h(" URL");return}try{new URL(o)}catch{h(" URL ");return}if(n.sources.some(b=>b.url===o)){h("");return}Ie.addSource(o,i||""),c(""),d(""),r(!1),h(null)},y=b=>{Ie.removeSource(b)},p=b=>{Ie.toggleSource(b)},g=async()=>{m(!0);try{await Ka()}catch(b){console.error("Refresh failed:",b)}m(!1)};return e.jsx(Y,{children:e.jsxs("div",{className:"flex flex-col min-h-full bg-background",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-background border-b",children:e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[e.jsx("button",{onClick:()=>s(),className:"p-1.5 rounded-full hover:bg-muted transition-colors","aria-label":t("back",""),children:e.jsx(ao,{className:"size-5",stroke:1.5})}),e.jsx("h1",{className:"flex-1 text-lg font-semibold",children:""}),e.jsx("button",{onClick:g,disabled:u,className:"p-1.5 rounded-full hover:bg-muted transition-colors","aria-label":t("refresh",""),children:e.jsx(vs,{className:M("size-5",u&&"animate-spin"),stroke:1.5})})]})}),e.jsxs("div",{className:"flex-1 p-4 space-y-3",children:[n.sources.map(b=>e.jsx(fy,{source:b,onToggle:()=>p(b.url),onRemove:()=>y(b.url)},b.url)),n.sources.length===0&&e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:""})]}),a?e.jsxs("div",{className:"border-t p-4 bg-background space-y-3",children:[e.jsx("input",{type:"url",value:o,onChange:b=>{c(b.target.value),h(null)},placeholder:" URL (https://...)",className:"w-full px-3 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary"}),e.jsx("input",{type:"text",value:i,onChange:b=>d(b.target.value),placeholder:" ()",className:"w-full px-3 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary"}),f&&e.jsx("p",{className:"text-sm text-destructive",children:f}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{r(!1),c(""),d(""),h(null)},className:"flex-1 py-2 rounded-lg bg-muted hover:bg-muted/80 font-medium",children:""}),e.jsx("button",{onClick:v,className:"flex-1 py-2 rounded-lg bg-primary text-primary-foreground hover:bg-primary/90 font-medium",children:""})]})]}):e.jsx("div",{className:"border-t p-4",children:e.jsxs("button",{onClick:()=>r(!0),className:"w-full py-3 rounded-xl border-2 border-dashed border-muted-foreground/30 hover:border-primary hover:bg-primary/5 transition-colors flex items-center justify-center gap-2 text-muted-foreground hover:text-primary",children:[e.jsx(nt,{className:"size-5",stroke:1.5}),e.jsx("span",{children:""})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};function fy({source:t,onToggle:s,onRemove:n}){const a=t.url==="/ecosystem.json";return e.jsx("div",{className:M("rounded-xl border p-4 transition-colors",t.enabled?"bg-card":"bg-muted/30 opacity-60"),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"rounded-full bg-primary/10 p-2 shrink-0",children:e.jsx(go,{className:"size-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium truncate",children:t.name}),a&&e.jsx("span",{className:"text-xs bg-primary/10 text-primary px-1.5 py-0.5 rounded",children:""})]}),e.jsx("p",{className:"text-sm text-muted-foreground truncate mt-0.5",children:t.url}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[" ",new Date(t.lastUpdated).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[e.jsx("button",{onClick:s,className:M("p-2 rounded-full transition-colors",t.enabled?"bg-green-100 text-green-600 hover:bg-green-200":"bg-muted text-muted-foreground hover:bg-muted/80"),"aria-label":t.enabled?"":"",children:t.enabled?e.jsx(fe,{className:"size-4",stroke:2}):e.jsx(wn,{className:"size-4",stroke:2})}),!a&&e.jsx("button",{onClick:n,className:"p-2 rounded-full text-muted-foreground hover:text-destructive hover:bg-destructive/10 transition-colors","aria-label":"",children:e.jsx(Tt,{className:"size-4",stroke:1.5})})]})]})})}Bd.__docgenInfo={description:"",methods:[],displayName:"SettingsSourcesActivity"};const Si={defi:"DeFi",nft:"NFT",tools:"",games:"",social:"",exchange:"",other:""};function py({permission:t,isLast:s}){const n=Pu[t],a=n?.risk??"medium",r=a==="high"?Se:Xi,o=a==="high"?"text-red-500":a==="medium"?"text-amber-500":"text-green-500";return e.jsxs("div",{className:M("flex items-start gap-3 py-3",!s&&"border-b border-border/50"),children:[e.jsx(r,{className:M("size-5 mt-0.5 shrink-0",o),stroke:1.5}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm",children:n?.name??t}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:n?.description??""})]})]})}function Rt({label:t,value:s,isLink:n=!1,href:a}){const r=e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-border/50 last:border-0",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t}),e.jsxs("span",{className:M("text-sm font-medium",n&&"text-primary flex items-center gap-1"),children:[s,n&&e.jsx(Ce,{className:"size-4"})]})]});return n&&a?e.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",children:r}):r}const Ld=({params:t})=>{const{t:s}=L("common"),{pop:n}=K(),[a,r]=l.useState(null),[o,c]=l.useState(!0),[i,d]=l.useState(!1),u=le(Ct,p=>ga.isAppInstalled(p,t.appId));l.useEffect(()=>{let p=!1;return(async()=>{c(!0),await Fc();let b=ci(t.appId);b||(await Ka({force:!1}),b=ci(t.appId)),!p&&(r(b??null),c(!1))})(),()=>{p=!0}},[t.appId]);const m=l.useCallback(()=>{a&&Ie.installApp(a.id)},[a]),f=l.useCallback(()=>{a&&(Ie.updateAppLastUsed(a.id),Ie.setActiveSubPage("mine"),qi(a.id,{...a,targetDesktop:"mine"}),n())},[a,n]);if(o)return e.jsx(Y,{children:e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-background",children:e.jsx(ye,{size:"lg"})})});if(!a)return e.jsx(Y,{children:e.jsxs("div",{className:"flex min-h-screen flex-col items-center justify-center bg-background gap-4",children:[e.jsx("p",{className:"text-muted-foreground",children:""}),e.jsx("button",{onClick:()=>n(),className:"px-4 py-2 bg-primary text-primary-foreground rounded-full text-sm font-medium",children:""})]})});const h=a.longDescription??a.description,v=h.length>150,y=i||!v?h:h.slice(0,150)+"...";return e.jsx(Y,{children:e.jsxs("div",{className:"flex min-h-screen flex-col bg-background detail-scroll-container",children:[e.jsx("div",{className:"sticky top-0 z-20 bg-background/80 backdrop-blur-xl border-b border-border/50",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[e.jsx("button",{onClick:()=>n(),className:"p-1.5 -ml-1.5 rounded-full hover:bg-muted transition-colors",children:e.jsx(ao,{className:"size-5",stroke:1.5})}),e.jsx("span",{className:"font-semibold truncate max-w-[200px] detail-header-title",children:a.name}),e.jsx("button",{className:"p-1.5 -mr-1.5 rounded-full hover:bg-muted transition-colors",children:e.jsx(Qs,{className:"size-5",stroke:1.5})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto detail-scroller",children:[e.jsxs("div",{className:"px-5 pt-4 pb-5",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(_u,{src:a.icon,name:a.name,size:"2xl",shadow:"lg",className:"shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0 pt-1",children:[e.jsx("h1",{className:"text-xl font-bold truncate",children:a.name}),e.jsx("p",{className:"text-sm text-muted-foreground mt-0.5 truncate",children:a.author??""}),u?e.jsx("button",{onClick:f,className:"mt-4 px-8 py-2 bg-primary text-primary-foreground rounded-full text-sm font-semibold",children:""}):e.jsx("button",{onClick:m,className:"mt-4 px-8 py-2 bg-primary text-primary-foreground rounded-full text-sm font-semibold",children:""})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-5 text-xs text-muted-foreground",children:[a.category&&e.jsx("span",{className:"font-medium text-foreground",children:Si[a.category]??a.category}),a.beta&&e.jsx("span",{className:"px-2 py-0.5 bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400 rounded-full font-medium",children:"Beta"}),e.jsxs("span",{children:["v",a.version]})]})]}),a.screenshots&&a.screenshots.length>0&&e.jsx("div",{className:"border-t border-border/50",children:e.jsxs("div",{className:"px-5 py-4",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:""}),e.jsx("div",{className:"flex gap-3 overflow-x-auto pb-2 -mx-5 px-5 snap-x snap-mandatory",style:{scrollbarWidth:"none"},children:a.screenshots.map((p,g)=>e.jsx("div",{className:"w-[220px] aspect-[9/19.5] rounded-2xl bg-muted overflow-hidden shrink-0 snap-center shadow-lg ring-1 ring-black/5",children:e.jsx("img",{src:p,alt:`${a.name} screenshot ${g+1}`,className:"w-full h-full object-cover",loading:"lazy",onError:b=>{b.currentTarget.parentElement.style.display="none"}})},g))})]})}),e.jsxs("div",{className:"border-t border-border/50 px-5 py-4",children:[e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:y}),v&&e.jsxs("button",{onClick:()=>d(!i),className:"text-primary text-sm font-medium mt-2 flex items-center gap-1",children:[i?"":"",i?e.jsx(Vi,{className:"size-4"}):e.jsx(Gi,{className:"size-4"})]})]}),a.chains&&a.chains.length>0&&e.jsxs("div",{className:"border-t border-border/50 px-5 py-4",children:[e.jsx("h2",{className:"text-lg font-bold mb-3",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.chains.map(p=>e.jsx("span",{className:"px-3 py-1.5 bg-muted rounded-full text-sm font-medium",children:p},p))})]}),a.permissions&&a.permissions.length>0&&e.jsxs("div",{className:"border-t border-border/50 px-5 py-4",children:[e.jsx("h2",{className:"text-lg font-bold mb-1",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:""}),e.jsx("div",{className:"bg-muted/50 rounded-2xl px-4",children:a.permissions.map((p,g)=>e.jsx(py,{permission:p,isLast:g===a.permissions.length-1},p))})]}),a.tags&&a.tags.length>0&&e.jsxs("div",{className:"border-t border-border/50 px-5 py-4",children:[e.jsx("h2",{className:"text-lg font-bold mb-3",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.tags.map(p=>e.jsxs("span",{className:"px-3 py-1.5 bg-primary/10 text-primary rounded-full text-sm font-medium",children:["#",p]},p))})]}),e.jsxs("div",{className:"border-t border-border/50 px-5 py-4",children:[e.jsx("h2",{className:"text-lg font-bold mb-2",children:""}),e.jsxs("div",{className:"bg-muted/50 rounded-2xl px-4",children:[a.author&&e.jsx(Rt,{label:"",value:a.author}),e.jsx(Rt,{label:"",value:a.version}),a.category&&e.jsx(Rt,{label:"",value:Si[a.category]??a.category}),a.publishedAt&&e.jsx(Rt,{label:"",value:a.publishedAt}),a.updatedAt&&e.jsx(Rt,{label:"",value:a.updatedAt}),a.website&&e.jsx(Rt,{label:"",value:"",isLink:!0,href:a.website})]})]}),e.jsx("div",{className:"h-8"})]})]})})};Ld.__docgenInfo={description:"",methods:[],displayName:"MiniappDetailActivity"};function us({className:t,...s}){return e.jsx("label",{"data-slot":"label",className:M("gap-2 text-sm leading-none font-medium group-data-[disabled=true]:opacity-50 peer-disabled:opacity-50 flex items-center select-none group-data-[disabled=true]:pointer-events-none peer-disabled:cursor-not-allowed",t),...s})}us.__docgenInfo={description:"",methods:[],displayName:"Label"};function Za({className:t,size:s="default",...n}){return e.jsx("div",{"data-slot":"card","data-size":s,className:M("ring-foreground/10 bg-card text-card-foreground gap-4 overflow-hidden rounded-xl py-4 text-sm ring-1 has-data-[slot=card-footer]:pb-0 has-[>img:first-child]:pt-0 data-[size=sm]:gap-3 data-[size=sm]:py-3 data-[size=sm]:has-data-[slot=card-footer]:pb-0 *:[img:first-child]:rounded-t-xl *:[img:last-child]:rounded-b-xl group/card flex flex-col",t),...n})}function er({className:t,...s}){return e.jsx("div",{"data-slot":"card-content",className:M("px-4 group-data-[size=sm]/card:px-3",t),...s})}Za.__docgenInfo={description:"",methods:[],displayName:"Card",props:{size:{required:!1,tsType:{name:"union",raw:'"default" | "sm"',elements:[{name:"literal",value:'"default"'},{name:"literal",value:'"sm"'}]},description:"",defaultValue:{value:'"default"',computed:!1}}}};er.__docgenInfo={description:"",methods:[],displayName:"CardContent"};function Od(){const{t}=L(["common","wallet"]),{goBack:s}=Z(),n=gn(),[a,r]=l.useState("ethereum"),[o,c]=l.useState(""),[i,d]=l.useState(""),[u,m]=l.useState(""),{data:f,isLoading:h,isFetching:v}=Nf(u,i,!!u&&!!i),y=l.useCallback(()=>{o.trim()&&(d(o.trim()),m(a))},[o,a]),p=l.useCallback(x=>{x.key==="Enter"&&y()},[y]),g=n.filter(x=>x.chainKind==="evm"),b=n.filter(x=>x.chainKind!=="evm");return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(U,{title:t("common:addressLookup.balanceTitle"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(us,{children:t("common:addressLookup.chain")}),e.jsxs(Js,{value:a,onValueChange:r,children:[e.jsx(Vs,{children:e.jsx(Ks,{})}),e.jsxs(Gs,{children:[g.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:"EVM"}),g.map(x=>e.jsx(qt,{value:x.id,children:x.name},x.id))]}),b.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:t("common:addressLookup.otherChains")}),b.map(x=>e.jsx(qt,{value:x.id,children:x.name},x.id))]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(us,{children:t("common:addressLookup.address")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Pe,{placeholder:t("common:addressLookup.addressPlaceholder"),value:o,onChange:x=>c(x.target.value),onKeyDown:p,className:"flex-1 font-mono text-sm"}),e.jsx(q,{onClick:y,disabled:!o.trim()||v,children:v?e.jsx(ye,{size:"sm"}):e.jsx(ys,{className:"size-4"})})]})]}),i&&e.jsx(Za,{className:M("transition-all",h&&"opacity-50"),children:e.jsx(er,{className:"pt-6",children:f?.error?e.jsxs("div",{className:"flex items-center gap-3 text-destructive",children:[e.jsx(It,{className:"size-5 shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t("common:addressLookup.error")}),e.jsx("div",{className:"text-sm opacity-80",children:f.error})]})]}):f?.balance?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-primary/10 flex size-12 items-center justify-center rounded-full",children:e.jsx(Wm,{className:"text-primary size-6"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[f.balance.amount.toFormatted()," ",f.balance.symbol]}),e.jsx("div",{className:"text-muted-foreground text-sm",children:t("common:addressLookup.onChain",{chain:n.find(x=>x.id===u)?.name??u})})]})]}):h?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx(ye,{size:"lg"})}):null})}),!1]})]})}Od.__docgenInfo={description:"",methods:[],displayName:"AddressBalancePage"};const Fd=()=>e.jsx(Y,{children:e.jsx(Od,{})});Fd.__docgenInfo={description:"",methods:[],displayName:"AddressBalanceActivity"};function hy(t,s){return(parseFloat(t)/Math.pow(10,s)).toLocaleString(void 0,{maximumFractionDigits:6})}function xy(t){return new Date(t).toLocaleString()}function gy({tx:t,address:s}){const n=t.direction==="out"||t.from.toLowerCase()===s.toLowerCase(),a=t.assets.find(i=>i.assetType==="native"||i.assetType==="token"),r=a?a.value:"0",o=a?a.symbol:"",c=a?a.decimals:0;return e.jsxs("div",{className:"flex items-center gap-3 py-3 border-b last:border-b-0",children:[e.jsx("div",{className:`p-2 rounded-full ${n?"bg-red-100 text-red-600":"bg-green-100 text-green-600"}`,children:n?e.jsx(uo,{className:"size-4"}):e.jsx(Am,{className:"size-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium truncate",children:n?`To: ${t.to}`:`From: ${t.from}`}),e.jsx("div",{className:"text-xs text-muted-foreground",children:xy(t.timestamp)})]}),e.jsxs("div",{className:`text-sm font-medium ${n?"text-red-600":"text-green-600"}`,children:[n?"-":"+",hy(r,c)," ",o]})]})}function Wd(){const{t}=L(["common","wallet"]),{goBack:s}=Z(),n=gn(),[a,r]=l.useState("bfmeta"),[o,c]=l.useState(""),[i,d]=l.useState(""),u=l.useMemo(()=>n.find(S=>S.id===a),[n,a]),{data:m,isLoading:f,isError:h,refetch:v}=Cf({chainId:a,address:i,enabled:!!i}),y=m?.transactions??[],p=m?.supported??!0,g=l.useMemo(()=>{if(!u?.explorer||!i.trim())return null;const{queryAddress:S,url:C}=u.explorer;return S?S.replace(":address",i.trim()):`${C}/address/${i.trim()}`},[u,i]),b=l.useCallback(()=>{o.trim()&&d(o.trim())},[o]),x=l.useCallback(S=>{S.key==="Enter"&&b()},[b]),j=l.useCallback(()=>{g&&window.open(g,"_blank","noopener,noreferrer")},[g]),N=n.filter(S=>S.chainKind==="evm"),w=n.filter(S=>S.chainKind!=="evm");return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(U,{title:t("common:addressLookup.transactionsTitle"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(us,{children:t("common:addressLookup.chain")}),e.jsxs(Js,{value:a,onValueChange:r,children:[e.jsx(Vs,{children:e.jsx(Ks,{})}),e.jsxs(Gs,{children:[N.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:"EVM"}),N.map(S=>e.jsx(qt,{value:S.id,children:S.name},S.id))]}),w.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:t("common:addressLookup.otherChains")}),w.map(S=>e.jsx(qt,{value:S.id,children:S.name},S.id))]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(us,{children:t("common:addressLookup.address")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Pe,{placeholder:t("common:addressLookup.addressPlaceholder"),value:o,onChange:S=>c(S.target.value),onKeyDown:x,className:"flex-1 font-mono text-sm"}),e.jsx(q,{onClick:b,disabled:!o.trim()||f,children:f?e.jsx(ke,{className:"size-4 animate-spin"}):e.jsx(ys,{className:"size-4"})})]})]}),i&&e.jsx(Za,{children:e.jsxs(er,{className:"pt-6",children:[f?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ke,{className:"size-6 animate-spin text-muted-foreground"})}):h?e.jsx("div",{className:"text-center py-8 text-destructive",children:t("common:addressLookup.queryError")}):y&&y.length>0?e.jsx("div",{className:"divide-y",children:y.map(S=>e.jsx(gy,{tx:S,address:i},S.hash))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:p?e.jsx("p",{children:t("common:addressLookup.noTransactions")}):e.jsx("p",{children:t("common:addressLookup.useExplorerHint")})}),g&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs(q,{variant:p?"outline":"default",size:"sm",className:"w-full gap-2",onClick:j,children:[e.jsx(Zn,{className:"size-4"}),t("common:addressLookup.viewOnExplorer",{name:u?.name??a})]})})]})})]})]})}Wd.__docgenInfo={description:"",methods:[],displayName:"AddressTransactionsPage"};const $d=()=>e.jsx(Y,{children:e.jsx(Wd,{})});$d.__docgenInfo={description:"",methods:[],displayName:"AddressTransactionsActivity"};const{useFlow:K}=Wp({transitionDuration:350,plugins:[$p(),ph({theme:"cupertino"}),Ix({routes:{MainTabsActivity:"/",WalletListActivity:"/wallet/list",WalletConfigActivity:"/wallet/:walletId",WalletCreateActivity:"/wallet/create",SendActivity:"/send",DestroyActivity:"/destroy",ReceiveActivity:"/receive",SettingsActivity:"/settings",SettingsLanguageActivity:"/settings/language",SettingsCurrencyActivity:"/settings/currency",SettingsChainsActivity:"/settings/chains",SettingsMnemonicActivity:"/settings/mnemonic",SettingsWalletLockActivity:"/settings/wallet-lock",SettingsWalletChainsActivity:"/settings/wallet-chains",SettingsStorageActivity:"/settings/storage",HistoryActivity:"/history",TransactionDetailActivity:"/transaction/:txId",ScannerActivity:"/scanner",AuthorizeAddressActivity:"/authorize/address/:id",AuthorizeSignatureActivity:"/authorize/signature/:id",OnboardingRecoverActivity:"/onboarding/recover",TokenDetailActivity:"/token/:tokenId",AddressBookActivity:"/address-book",NotificationsActivity:"/notifications",StakingActivity:"/staking",WelcomeActivity:"/welcome",SettingsSourcesActivity:"/settings/sources",MiniappDetailActivity:"/miniapp/:appId/detail",AddressBalanceActivity:"/address-balance",AddressTransactionsActivity:"/address-transactions",ChainSelectorJob:"/job/chain-selector",WalletRenameJob:"/job/wallet-rename/:walletId",WalletDeleteJob:"/job/wallet-delete/:walletId",WalletLockConfirmJob:"/job/wallet-lock-confirm",TwoStepSecretConfirmJob:"/job/two-step-secret-confirm",SetTwoStepSecretJob:"/job/set-two-step-secret",MnemonicOptionsJob:"/job/mnemonic-options",ContactEditJob:"/job/contact-edit",ContactPickerJob:"/job/contact-picker",WalletAddJob:"/job/wallet-add",WalletListJob:"/job/wallet-list",SecurityWarningJob:"/job/security-warning",TransferConfirmJob:"/job/transfer-confirm",TransferWalletLockJob:"/job/transfer-wallet-lock",FeeEditJob:"/job/fee-edit",ScannerJob:"/job/scanner",ContactAddConfirmJob:"/job/contact-add-confirm",ContactShareJob:"/job/contact-share",ClearDataConfirmJob:"/job/clear-data-confirm",WalletPickerJob:"/job/wallet-picker",SigningConfirmJob:"/job/signing-confirm",PermissionRequestJob:"/job/permission-request",MiniappTransferConfirmJob:"/job/miniapp-transfer-confirm",MiniappDestroyConfirmJob:"/job/miniapp-destroy-confirm",MiniappSignTransactionJob:"/job/miniapp-sign-transaction",ChainSwitchConfirmJob:"/job/chain-switch-confirm"},fallbackActivity:()=>"MainTabsActivity",useHash:!0,urlPatternOptions:{segmentValueCharset:"a-zA-Z0-9-._~ %"}})],activities:{MainTabsActivity:wl,WalletListActivity:Sl,WalletConfigActivity:kl,WalletCreateActivity:Tl,SendActivity:El,DestroyActivity:Ml,ReceiveActivity:Dl,SettingsActivity:zl,SettingsLanguageActivity:Ll,SettingsCurrencyActivity:Fl,SettingsChainsActivity:Xl,SettingsMnemonicActivity:ed,SettingsWalletLockActivity:sd,SettingsWalletChainsActivity:Rd,SettingsStorageActivity:zd,HistoryActivity:ad,TransactionDetailActivity:id,ScannerActivity:cd,AuthorizeAddressActivity:ud,AuthorizeSignatureActivity:fd,OnboardingRecoverActivity:xd,TokenDetailActivity:vd,AddressBookActivity:bd,NotificationsActivity:wd,StakingActivity:Pd,WelcomeActivity:_d,SettingsSourcesActivity:Bd,MiniappDetailActivity:Ld,AddressBalanceActivity:Fd,AddressTransactionsActivity:$d,ChainSelectorJob:Hc,WalletRenameJob:Jc,WalletDeleteJob:Vc,WalletLockConfirmJob:Kc,TwoStepSecretConfirmJob:Gc,SetTwoStepSecretJob:Xc,MnemonicOptionsJob:Zc,ContactEditJob:el,ContactPickerJob:tl,WalletAddJob:sl,WalletListJob:nl,SecurityWarningJob:al,TransferConfirmJob:il,TransferWalletLockJob:cl,FeeEditJob:Yc,ScannerJob:ll,ContactAddConfirmJob:dl,ContactShareJob:ul,ClearDataConfirmJob:ml,WalletPickerJob:fl,SigningConfirmJob:pl,PermissionRequestJob:hl,MiniappTransferConfirmJob:xl,MiniappDestroyConfirmJob:yl,MiniappSignTransactionJob:bl,ChainSwitchConfirmJob:jl}});function vy(t,s){const n=Math.abs(t-s);return Math.min(n,360-n)}function yy(t,s,n=30){if(s.length===0)return 1;let a=180;for(const r of s){const o=vy(t,r);o<a&&(a=o)}return a<n?a/n:1}function by(t){return Zd.map(s=>({...s,weight:yy(s.hue,t)}))}function En({mode:t,walletId:s,onEditOnlyComplete:n,className:a}){const{t:r}=L(["wallet","onboarding","common"]),{push:o}=K(),c=Pt(),i=c.find(z=>z.id===s),d=Le(),u=Ri(),[m,f]=l.useState(t==="edit-only"?"edit":t),[h,v]=l.useState(""),[y,p]=l.useState(0),g=l.useRef(null),[b,x]=l.useState(!1),j=l.useMemo(()=>c.filter(z=>z.id!==s).map(z=>z.themeHue),[c,s]),N=l.useMemo(()=>by(j),[j]);l.useEffect(()=>{i&&(v(i.name),p(i.themeHue))},[i]);const w=l.useMemo(()=>i?.chainAddresses.find(z=>z.chain===d)??i?.chainAddresses[0],[i,d]),S=l.useCallback(z=>{if(!g.current)return;const O=g.current.getBoundingClientRect(),te=Math.max(0,Math.min(z-O.left,O.width))/O.width,Q=Math.round(te*3600)/10;p(Q)},[]),C=z=>{z.stopPropagation(),x(!0),S(z.clientX)},T=z=>{z.stopPropagation(),x(!0),z.touches[0]&&S(z.touches[0].clientX)};l.useEffect(()=>{if(!b)return;const z=te=>S(te.clientX),O=te=>{te.touches[0]&&S(te.touches[0].clientX)},H=()=>x(!1);return document.addEventListener("mousemove",z),document.addEventListener("mouseup",H),document.addEventListener("touchmove",O),document.addEventListener("touchend",H),()=>{document.removeEventListener("mousemove",z),document.removeEventListener("mouseup",H),document.removeEventListener("touchmove",O),document.removeEventListener("touchend",H)}},[b,S]);const k=l.useCallback(()=>{o("ChainSelectorJob",{})},[o]),I=l.useCallback(()=>{i&&(v(i.name),p(i.themeHue)),f("edit")},[i]),R=l.useCallback(async()=>{if(!i)return;const z=h.trim();z&&z!==i.name&&await de.updateWalletName(i.id,z),y!==i.themeHue&&await de.updateWalletThemeHue(i.id,y),f("default")},[i,h,y]),P=l.useCallback(()=>{i&&(v(i.name),p(i.themeHue)),f("default")},[i]),A=l.useCallback(async()=>{if(!i)return;const z=h.trim();z&&z!==i.name&&await de.updateWalletName(i.id,z),y!==i.themeHue&&await de.updateWalletThemeHue(i.id,y),n?.()},[i,h,y,n]),D=l.useCallback(async()=>{i&&(await de.setCurrentWallet(i.id),o("SettingsMnemonicActivity",{}))},[i,o]),_=l.useCallback(()=>{i&&o("WalletDeleteJob",{walletId:i.id})},[i,o]);if(!i)return e.jsx("div",{className:M("text-muted-foreground p-4 text-center",a),children:r("wallet:detail.notFound")});const B=m==="edit"||t==="edit-only"?y:i.themeHue,E=m==="edit"||t==="edit-only";return e.jsxs("div",{className:M("space-y-6",a),children:[e.jsx("div",{className:"flex justify-center px-4",children:e.jsx("div",{className:"aspect-[1.6/1] w-full max-w-[360px]",children:e.jsx(Di,{wallet:{...i,name:E?h:i.name,themeHue:B},themeHue:B,walletNameTestId:"wallet-config-preview-name",chain:w?.chain,chainName:w?.chain||"",address:w?.address||i.address,chainIconUrl:u[w?.chain??""],onOpenChainSelector:k})})}),E?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm",children:r("onboarding:theme.walletName")}),e.jsx(Pe,{value:h,onChange:z=>v(z.target.value),placeholder:r("wallet:defaultName"),maxLength:20,className:"text-center"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:r("onboarding:theme.customColor")}),e.jsxs("span",{className:"text-muted-foreground font-mono",children:[y.toFixed(1),""]})]}),e.jsxs("div",{ref:g,className:"relative h-8 cursor-pointer touch-none rounded-full",style:{background:"linear-gradient(to right, oklch(0.6 0.25 0), oklch(0.6 0.25 60), oklch(0.6 0.25 120), oklch(0.6 0.25 180), oklch(0.6 0.25 240), oklch(0.6 0.25 300), oklch(0.6 0.25 360))"},onMouseDown:C,onTouchStart:T,children:[j.map((z,O)=>e.jsx("div",{className:"absolute top-0 h-full w-0.5 bg-black/30",style:{left:`${z/360*100}%`},title:r("onboarding:theme.usedColor")},O)),e.jsx("div",{className:"absolute top-1/2 -translate-x-1/2 -translate-y-1/2",style:{left:`${y/360*100}%`},children:e.jsx("div",{className:"size-6 rounded-full border-2 border-white shadow-md",style:{backgroundColor:`oklch(0.6 0.25 ${y})`}})})]})]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-3",children:N.map(z=>{const O=Math.abs(y-z.hue)<.5,H=z.weight<.5;return e.jsx("button",{type:"button",onClick:()=>p(z.hue),className:M("relative size-10 rounded-full transition-all","ring-offset-background focus-visible:ring-ring focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:outline-none",O&&"ring-primary ring-2 ring-offset-2",H&&"opacity-50"),style:{backgroundColor:z.color},title:z.name,children:O&&e.jsx(fe,{className:"absolute inset-0 m-auto size-5 text-white drop-shadow-md"})},z.hue)})})]}),t==="edit-only"?e.jsx(q,{className:"w-full",onClick:A,disabled:!h.trim(),"data-testid":"theme-complete-button",style:{"--primary-hue":y,"--primary":`oklch(var(--primary-lightness) var(--primary-saturation) ${y})`},children:r("common:confirm")}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx(q,{variant:"outline",className:"flex-1",onClick:P,children:r("common:cancel")}),e.jsx(q,{className:"flex-1",onClick:R,disabled:!h.trim(),style:{"--primary-hue":y,"--primary":`oklch(var(--primary-lightness) var(--primary-saturation) ${y})`},children:r("common:save")})]})]}):e.jsxs("div",{className:"flex justify-center gap-8",children:[e.jsxs("button",{onClick:I,className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"bg-primary/10 text-primary group-hover:bg-primary/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:e.jsx(af,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:r("wallet:detail.editName")})]}),e.jsxs("button",{onClick:D,className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"bg-primary/10 text-primary group-hover:bg-primary/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:e.jsx(ka,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:r("wallet:detail.exportMnemonic")})]}),e.jsxs("button",{onClick:_,className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"bg-destructive/10 text-destructive group-hover:bg-destructive/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:e.jsx(Tt,{className:"size-5"})}),e.jsx("span",{className:"text-destructive text-xs font-medium",children:r("wallet:detail.deleteWallet")})]})]})]})}En.__docgenInfo={description:`
- default: + edit
- edit:  default  default
- edit-only: / onEditOnlyComplete`,methods:[],displayName:"WalletConfig",props:{mode:{required:!0,tsType:{name:"union",raw:"'edit-only' | 'default' | 'edit'",elements:[{name:"literal",value:"'edit-only'"},{name:"literal",value:"'default'"},{name:"literal",value:"'edit'"}]},description:""},walletId:{required:!0,tsType:{name:"string"},description:""},onEditOnlyComplete:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};export{yd as A,Yl as C,_l as D,Gm as I,Bl as L,Nd as N,Rl as R,ve as S,rd as T,Zl as V,En as W,Wd as a,nd as b,Fe as c,td as d,Ol as e,ss as f,Xa as g,Cl as h,ts as n};
