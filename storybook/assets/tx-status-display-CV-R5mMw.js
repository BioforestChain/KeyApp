import{r as p,j as e}from"./iframe-CW0HKnfK.js";import{c as b}from"./utils-4perknFd.js";import{u as C}from"./useTranslation-cFSh0vM6.js";import{I as E}from"./IconAlertCircle-D0BIVjXq.js";import{I as T}from"./IconCheck-BlBMnhvK.js";import{I as B}from"./IconLoader2-C0F_MaH6.js";function V({status:d,txHash:c,title:n,description:a,errorMessage:x,checkConfirmed:u,onStatusChange:l,onDone:y,onRetry:v,onViewDetails:w,onViewExplorer:h,onShare:q,pollInterval:m=1e4,maxPollAttempts:o=18,children:j}){const{t}=C(["transaction","common"]),[r,f]=p.useState(d);p.useEffect(()=>{f(d)},[d]),p.useEffect(()=>{if(r!=="broadcasted"||!u)return;let s=!1,i=0;const g=async()=>{if(!(s||i>=o)){i++,i===1&&(f("confirming"),l?.("confirming"));try{await u()&&!s?(f("confirmed"),l?.("confirmed")):!s&&i<o&&setTimeout(g,m)}catch{!s&&i<o&&setTimeout(g,m)}}},z=setTimeout(g,3e3);return()=>{s=!0,clearTimeout(z)}},[r,u,l,m,o]);const N=()=>{switch(r){case"broadcasting":return n?.broadcasting??t("transaction:txStatus.broadcasting");case"broadcasted":return n?.broadcasted??t("transaction:txStatus.broadcasted");case"confirming":return n?.confirming??t("transaction:txStatus.confirming");case"confirmed":return n?.confirmed??t("transaction:txStatus.confirmed");case"failed":return n?.failed??t("transaction:txStatus.failed")}},S=()=>{if(r==="failed"&&x)return x;switch(r){case"broadcasting":return a?.broadcasting??t("transaction:txStatus.broadcastingDesc");case"broadcasted":return a?.broadcasted??t("transaction:txStatus.broadcastedDesc");case"confirming":return a?.confirming??t("transaction:txStatus.confirmingDesc");case"confirmed":return a?.confirmed??t("transaction:txStatus.confirmedDesc");case"failed":return a?.failed??t("transaction:txStatus.failedDesc")}},k=()=>{switch(r){case"broadcasting":case"confirming":return e.jsx(B,{className:"size-8 animate-spin"});case"broadcasted":return e.jsx(T,{className:"size-8"});case"confirmed":return e.jsx(T,{className:"size-8"});case"failed":return e.jsx(E,{className:"size-8"})}},D=()=>{switch(r){case"broadcasting":case"confirming":return"bg-blue-100 text-blue-600";case"broadcasted":return"bg-blue-100 text-blue-600";case"confirmed":return"bg-green-100 text-green-600";case"failed":return"bg-red-100 text-red-600"}},I=r==="confirmed"||r==="broadcasted"||r==="confirming",R=r==="failed"&&v;return e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 p-8",children:[e.jsx("div",{className:b("flex size-16 items-center justify-center rounded-full",D()),children:k()}),e.jsx("h2",{className:"text-lg font-semibold",children:N()}),e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:S()}),c&&e.jsxs("p",{className:"text-xs text-muted-foreground font-mono truncate max-w-full px-4",children:[c.slice(0,16),"...",c.slice(-16)]}),j,I&&e.jsxs("div",{className:"flex w-full max-w-xs flex-col gap-2",children:[y&&e.jsx("button",{type:"button",onClick:y,"data-testid":"tx-status-done-button",className:b("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90"),children:t("common:done")}),e.jsxs("div",{className:"flex gap-2",children:[w&&e.jsx("button",{type:"button",onClick:w,"data-testid":"tx-status-view-details-button",className:"flex-1 rounded-full border border-border py-2 text-sm font-medium transition-colors hover:bg-muted",children:t("transaction:txStatus.viewDetails")}),h&&e.jsx("button",{type:"button",onClick:h,"data-testid":"tx-status-view-explorer-button",className:"flex-1 rounded-full border border-border py-2 text-sm font-medium transition-colors hover:bg-muted",children:t("transaction:sendResult.viewInBrowser")}),q&&e.jsx("button",{type:"button",onClick:q,"data-testid":"tx-status-share-button",className:"flex-1 rounded-full border border-border py-2 text-sm font-medium transition-colors hover:bg-muted",children:t("common:share")})]})]}),R&&e.jsx("button",{type:"button",onClick:v,"data-testid":"tx-status-retry-button",className:b("w-full max-w-xs rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90"),children:t("common:retry")})]})}V.__docgenInfo={description:"",methods:[],displayName:"TxStatusDisplay",props:{status:{required:!0,tsType:{name:"union",raw:'"broadcasting" | "broadcasted" | "confirming" | "confirmed" | "failed"',elements:[{name:"literal",value:'"broadcasting"'},{name:"literal",value:'"broadcasted"'},{name:"literal",value:'"confirming"'},{name:"literal",value:'"confirmed"'},{name:"literal",value:'"failed"'}]},description:"当前状态"},txHash:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"交易哈希"},title:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  broadcasting?: string;
  broadcasted?: string;
  confirming?: string;
  confirmed?: string;
  failed?: string;
}`,signature:{properties:[{key:"broadcasting",value:{name:"string",required:!1}},{key:"broadcasted",value:{name:"string",required:!1}},{key:"confirming",value:{name:"string",required:!1}},{key:"confirmed",value:{name:"string",required:!1}},{key:"failed",value:{name:"string",required:!1}}]}},description:"自定义标题"},description:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  broadcasting?: string;
  broadcasted?: string;
  confirming?: string;
  confirmed?: string;
  failed?: string;
}`,signature:{properties:[{key:"broadcasting",value:{name:"string",required:!1}},{key:"broadcasted",value:{name:"string",required:!1}},{key:"confirming",value:{name:"string",required:!1}},{key:"confirmed",value:{name:"string",required:!1}},{key:"failed",value:{name:"string",required:!1}}]}},description:"自定义描述"},errorMessage:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"错误信息"},checkConfirmed:{required:!1,tsType:{name:"union",raw:"(() => Promise<boolean>) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:"检查上链的回调"},onStatusChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(status: TxStatus) => void",signature:{arguments:[{type:{name:"union",raw:'"broadcasting" | "broadcasted" | "confirming" | "confirmed" | "failed"',elements:[{name:"literal",value:'"broadcasting"'},{name:"literal",value:'"broadcasted"'},{name:"literal",value:'"confirming"'},{name:"literal",value:'"confirmed"'},{name:"literal",value:'"failed"'}]},name:"status"}],return:{name:"void"}}},description:"状态变化回调"},onDone:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"点击完成按钮"},onRetry:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"点击重试按钮"},onViewDetails:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"点击查看详情按钮"},onViewExplorer:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"点击在浏览器中查看按钮"},onShare:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"点击分享按钮（目前复制链接）"},pollInterval:{required:!1,tsType:{name:"number"},description:"轮询间隔（毫秒）",defaultValue:{value:"10000",computed:!1}},maxPollAttempts:{required:!1,tsType:{name:"number"},description:"最大轮询次数",defaultValue:{value:"18",computed:!1}},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"额外内容（显示在状态下方）"}}};export{V as T};
