import{v as ct,r as dt,a as L,c as lt,b as I,i as yt,d as N,e as tt,f as ht,g as et,h as nt,j as pt,w as mt,m as st,n as $,k as Bt,s as bt,l as O,p as Y,o as gt,q as F,t as wt}from"./derivation-DJ_d9UnK.js";const k=BigInt(0),x=BigInt(1),D=BigInt(2),xt=BigInt(8);function Et(t,e,s,c){const f=t.sqr(s),n=t.sqr(c),y=t.add(t.mul(e.a,f),n),Z=t.add(t.ONE,t.mul(e.d,t.mul(f,n)));return t.eql(y,Z)}function vt(t,e={}){const s=ht("edwards",t,e,e.FpFnLE),{Fp:c,Fn:f}=s;let n=s.CURVE;const{h:y}=n;ct(e,{},{uvRatio:"function"});const Z=D<<BigInt(f.BYTES*8)-x,r=E=>c.create(E),_=e.uvRatio||((E,i)=>{try{return{isValid:!0,value:c.sqrt(c.div(E,i))}}catch{return{isValid:!1,value:k}}});if(!Et(c,n,n.Gx,n.Gy))throw new Error("bad curve params: generator point");function v(E,i,d=!1){const a=d?x:k;return nt("coordinate "+E,i,a,Z),i}function S(E){if(!(E instanceof h))throw new Error("EdwardsPoint expected")}const R=st((E,i)=>{const{X:d,Y:a,Z:p}=E,w=E.is0();i==null&&(i=w?xt:c.inv(p));const T=r(d*i),K=r(a*i),o=c.mul(p,i);if(w)return{x:k,y:x};if(o!==x)throw new Error("invZ was invalid");return{x:T,y:K}}),V=st(E=>{const{a:i,d}=n;if(E.is0())throw new Error("bad point: ZERO");const{X:a,Y:p,Z:w,T}=E,K=r(a*a),o=r(p*p),u=r(w*w),l=r(u*u),m=r(K*i),b=r(u*r(m+o)),B=r(l+r(d*r(K*o)));if(b!==B)throw new Error("bad point: equation left != right (1)");const g=r(a*p),A=r(w*T);if(g!==A)throw new Error("bad point: equation left != right (2)");return!0});class h{static BASE=new h(n.Gx,n.Gy,x,r(n.Gx*n.Gy));static ZERO=new h(k,x,x,k);static Fp=c;static Fn=f;X;Y;Z;T;constructor(i,d,a,p){this.X=v("x",i),this.Y=v("y",d),this.Z=v("z",a,!0),this.T=v("t",p),Object.freeze(this)}static CURVE(){return n}static fromAffine(i){if(i instanceof h)throw new Error("extended point not allowed");const{x:d,y:a}=i||{};return v("x",d),v("y",a),new h(d,a,x,r(d*a))}static fromBytes(i,d=!1){const a=c.BYTES,{a:p,d:w}=n;i=et(I(i,a,"point")),L(d,"zip215");const T=et(i),K=i[a-1];T[a-1]=K&-129;const o=N(T),u=d?Z:c.ORDER;nt("point.y",o,k,u);const l=r(o*o),m=r(l-x),b=r(w*l-p);let{isValid:B,value:g}=_(m,b);if(!B)throw new Error("bad point: invalid y coordinate");const A=(g&x)===x,C=(K&128)!==0;if(!d&&g===k&&C)throw new Error("bad point: x=0 and x_0=1");return C!==A&&(g=r(-g)),h.fromAffine({x:g,y:o})}static fromHex(i,d=!1){return h.fromBytes(pt(i),d)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(i=8,d=!0){return U.createCache(this,i),d||this.multiply(D),this}assertValidity(){V(this)}equals(i){S(i);const{X:d,Y:a,Z:p}=this,{X:w,Y:T,Z:K}=i,o=r(d*K),u=r(w*p),l=r(a*K),m=r(T*p);return o===u&&l===m}is0(){return this.equals(h.ZERO)}negate(){return new h(r(-this.X),this.Y,this.Z,r(-this.T))}double(){const{a:i}=n,{X:d,Y:a,Z:p}=this,w=r(d*d),T=r(a*a),K=r(D*r(p*p)),o=r(i*w),u=d+a,l=r(r(u*u)-w-T),m=o+T,b=m-K,B=o-T,g=r(l*b),A=r(m*B),C=r(l*B),X=r(b*m);return new h(g,A,X,C)}add(i){S(i);const{a:d,d:a}=n,{X:p,Y:w,Z:T,T:K}=this,{X:o,Y:u,Z:l,T:m}=i,b=r(p*o),B=r(w*u),g=r(K*a*m),A=r(T*l),C=r((p+w)*(o+u)-b-B),X=A-g,M=A+g,G=r(B-d*b),j=r(C*X),z=r(M*G),J=r(C*G),P=r(X*M);return new h(j,z,P,J)}subtract(i){return this.add(i.negate())}multiply(i){if(!f.isValidNot0(i))throw new Error("invalid scalar: expected 1 <= sc < curve.n");const{p:d,f:a}=U.cached(this,i,p=>$(h,p));return $(h,[d,a])[0]}multiplyUnsafe(i,d=h.ZERO){if(!f.isValid(i))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return i===k?h.ZERO:this.is0()||i===x?this:U.unsafe(this,i,a=>$(h,a),d)}isSmallOrder(){return this.multiplyUnsafe(y).is0()}isTorsionFree(){return U.unsafe(this,n.n).is0()}toAffine(i){return R(this,i)}clearCofactor(){return y===x?this:this.multiplyUnsafe(y)}toBytes(){const{x:i,y:d}=this.toAffine(),a=c.toBytes(d);return a[a.length-1]|=i&x?128:0,a}toHex(){return Bt(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}const U=new mt(h,f.BITS);return h.BASE.precompute(8),h}function Tt(t,e,s={}){if(typeof e!="function")throw new Error('"hash" function param is required');ct(s,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:c}=s,{BASE:f,Fp:n,Fn:y}=t,Z=s.randomBytes||dt,r=s.adjustScalarBytes||(o=>o),_=s.domain||((o,u,l)=>{if(L(l,"phflag"),u.length||l)throw new Error("Contexts/pre-hash are not supported");return o});function v(o){return y.create(N(o))}function S(o){const u=a.secretKey;I(o,a.secretKey,"secretKey");const l=I(e(o),2*u,"hashedSecretKey"),m=r(l.slice(0,u)),b=l.slice(u,2*u),B=v(m);return{head:m,prefix:b,scalar:B}}function R(o){const{head:u,prefix:l,scalar:m}=S(o),b=f.multiply(m),B=b.toBytes();return{head:u,prefix:l,scalar:m,point:b,pointBytes:B}}function V(o){return R(o).pointBytes}function h(o=Uint8Array.of(),...u){const l=tt(...u);return v(e(_(l,I(o,void 0,"context"),!!c)))}function U(o,u,l={}){o=I(o,void 0,"message"),c&&(o=c(o));const{prefix:m,scalar:b,pointBytes:B}=R(u),g=h(l.context,m,o),A=f.multiply(g).toBytes(),C=h(l.context,A,B,o),X=y.create(g+C*b);if(!y.isValid(X))throw new Error("sign failed: invalid s");const M=tt(A,y.toBytes(X));return I(M,a.signature,"result")}const E={zip215:!0};function i(o,u,l,m=E){const{context:b,zip215:B}=m,g=a.signature;o=I(o,g,"signature"),u=I(u,void 0,"message"),l=I(l,a.publicKey,"publicKey"),B!==void 0&&L(B,"zip215"),c&&(u=c(u));const A=g/2,C=o.subarray(0,A),X=N(o.subarray(A,g));let M,G,j;try{M=t.fromBytes(l,B),G=t.fromBytes(C,B),j=f.multiplyUnsafe(X)}catch{return!1}if(!B&&M.isSmallOrder())return!1;const z=h(b,G.toBytes(),M.toBytes(),u);return G.add(M.multiplyUnsafe(z)).subtract(j).clearCofactor().is0()}const d=n.BYTES,a={secretKey:d,publicKey:d,signature:2*d,seed:d};function p(o=Z(a.seed)){return I(o,a.seed,"seed")}function w(o){return yt(o)&&o.length===y.BYTES}function T(o,u){try{return!!t.fromBytes(o,u)}catch{return!1}}const K={getExtendedPublicKey:R,randomSecretKey:p,isValidSecretKey:w,isValidPublicKey:T,toMontgomery(o){const{y:u}=t.fromBytes(o),l=a.publicKey,m=l===32;if(!m&&l!==57)throw new Error("only defined for 25519 and 448");const b=m?n.div(x+u,x-u):n.div(u-x,u+x);return n.toBytes(b)},toMontgomerySecret(o){const u=a.secretKey;I(o,u);const l=e(o.subarray(0,u));return r(l).subarray(0,u)}};return Object.freeze({keygen:lt(p,V),getPublicKey:V,sign:U,verify:i,utils:K,Point:t,lengths:a})}const Kt=BigInt(1),ot=BigInt(2),Zt=BigInt(5),At=BigInt(8),Q=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),Ct={p:Q,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:At,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function It(t){const e=BigInt(10),s=BigInt(20),c=BigInt(40),f=BigInt(80),n=Q,Z=t*t%n*t%n,r=Y(Z,ot,n)*Z%n,_=Y(r,Kt,n)*t%n,v=Y(_,Zt,n)*_%n,S=Y(v,e,n)*v%n,R=Y(S,s,n)*S%n,V=Y(R,c,n)*R%n,h=Y(V,f,n)*V%n,U=Y(h,f,n)*V%n,E=Y(U,e,n)*v%n;return{pow_p_5_8:Y(E,ot,n)*t%n,b2:Z}}function St(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const rt=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function Rt(t,e){const s=Q,c=O(e*e*e,s),f=O(c*c*e,s),n=It(t*f).pow_p_5_8;let y=O(t*c*n,s);const Z=O(e*y*y,s),r=y,_=O(y*rt,s),v=Z===t,S=Z===O(-t,s),R=Z===O(-t*rt,s);return v&&(y=r),(S||R)&&(y=_),gt(y,s)&&(y=O(-y,s)),{isValid:v||S,value:y}}const Yt=vt(Ct,{uvRatio:Rt});function Xt(t){return Tt(Yt,bt,Object.assign({adjustScalarBytes:St},t))}const it=Xt({});function W(t){return Array.from(t).map(e=>e.toString(16).padStart(2,"0")).join("")}function qt(t){const e=new Uint8Array(t.length/2);for(let s=0;s<e.length;s++)e[s]=parseInt(t.substr(s*2,2),16);return e}const H={bfmeta:{prefix:"b",decimals:8,symbol:"BFM",name:"BFMeta"},ccchain:{prefix:"b",decimals:8,symbol:"CCC",name:"CCChain"},pmchain:{prefix:"b",decimals:8,symbol:"PMC",name:"PMChain"},bfchainv2:{prefix:"b",decimals:8,symbol:"BFT",name:"BFChain V2"},btgmeta:{prefix:"b",decimals:8,symbol:"BTGM",name:"BTGMeta"},biwmeta:{prefix:"b",decimals:8,symbol:"BIW",name:"BIWMeta"},ethmeta:{prefix:"b",decimals:8,symbol:"ETHM",name:"ETHMeta"},malibu:{prefix:"b",decimals:8,symbol:"MLB",name:"Malibu"}};function Mt(t){return t.chainKind==="bioforest"}function _t(t,e){const s=at(t),c=W(s.publicKey);return e.filter(Mt).map(f=>({chainId:f.id,address:ut(s.publicKey,f.prefix??"b"),publicKey:c}))}function Ht(t,e){return e==null?Ft(t,Gt()).map(s=>({chainId:s.chain,address:s.address})):_t(t,e).map(({chainId:s,address:c})=>({chainId:s,address:c}))}const q="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";function Vt(t){const e=[0];for(const c of t){let f=c;for(let n=0;n<e.length;n++)f+=e[n]<<8,e[n]=f%58,f=Math.floor(f/58);for(;f>0;)e.push(f%58),f=Math.floor(f/58)}let s="";for(const c of t)if(c===0)s+=q[0];else break;for(let c=e.length-1;c>=0;c--)s+=q[e[c]];return s}function ft(t){const e=[0];for(const s of t){const c=q.indexOf(s);if(c===-1)throw new Error(`Invalid Base58 character: ${s}`);let f=c;for(let n=0;n<e.length;n++)f+=e[n]*58,e[n]=f&255,f>>=8;for(;f>0;)e.push(f&255),f>>=8}for(const s of t)if(s===q[0])e.push(0);else break;return new Uint8Array(e.toReversed())}function Ut(t){const e=F(F(t)).slice(0,4),s=new Uint8Array(t.length+e.length);return s.set(t,0),s.set(e,t.length),Vt(s)}function Ot(t){let e;try{e=ft(t)}catch{return}if(e.length<5)return;const s=e.slice(0,-4),c=e.slice(-4),f=F(F(s)).slice(0,4);for(let n=0;n<4;n++)if(c[n]!==f[n])return;return s}function at(t){const s=new TextEncoder().encode(t),c=F(s),f=c,n=it.getPublicKey(f),y=new Uint8Array(64);return y.set(c,0),y.set(n,32),{secretKey:y,publicKey:n}}function ut(t,e="b"){const s=wt(F(t));return e+Ut(s)}function zt(t,e){if(typeof t!="string"||t.length<2)return!1;const s=t[0];if(e){const n=H[e];if(s!==n.prefix)return!1}const c=t.slice(1),f=Ot(c);if(f)return f.length===20;if(s!=="c")return!1;try{return ft(c).length===20}catch{return!1}}function $t(t,e){const s=typeof t=="string"?new TextEncoder().encode(t):t,c=F(s),f=e.slice(0,32);return it.sign(c,f)}function kt(t,e){const s=H[e];if(!s)throw new Error(`Unsupported BioForest chain: ${e}`);const c=at(t),f=ut(c.publicKey,s.prefix);return{privateKey:W(c.secretKey),publicKey:W(c.publicKey),address:f,chain:e}}function Ft(t,e=["bfmeta","pmchain","ccchain"]){return e.map(s=>kt(t,s))}function Dt(t){return t in H}function Gt(){return Object.keys(H)}export{Dt as a,W as b,at as c,Ht as d,qt as h,zt as i,ut as p,$t as s};
