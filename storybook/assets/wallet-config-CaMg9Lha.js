const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./snapdom-CO8q8LPW.js","./preload-helper-PPVm8Dsz.js","./index-DwhhC-lB.js","./iframe-dO2EN605.js","./iframe-dKmOljRT.css","./service-DVw_NIqC.js","./schemas-CO8_C8zP.js","./index-D0E7N0oa.js","./derivation-C2wjCcMH.js","./amount-BQsqQYGO.js","./bioforest-DQyLkPyY.js"])))=>i.map(i=>d[i]);
import{g as rm,r as c,j as e,R as Za,u as Ie,S as im,as as Mo,at as Jn,v as ke,au as ts,x as Ro,av as om,y as Jr}from"./iframe-dO2EN605.js";import{a as Kn,c as D}from"./utils-4perknFd.js";import{u as Lo,d as Ta,W as cm}from"./useWalletTheme-yqWqQ-Hf.js";import{W as lm,u as Do}from"./wallet-card-carousel-DoIcLllA.js";import{W as zo}from"./wallet-card-DdGv_j7k.js";import{B as V,c as dm}from"./button-BBfxL8ER.js";import{f as ye,d as vs,W as Qs,g as ys,c as Os,a as Bs,b as er,w as Le,e as Xs,u as tr,h as um,i as mm,j as ms}from"./user-profile-lWX_9VNh.js";import{c as dt,h as fm,u as ut,b as He,j as ss,d as Ys,e as Pa,k as sr,l as pm,m as hm,n as xm,o as gm,f as ls,p as Zs,q as vm}from"./service-DVw_NIqC.js";import{u as ym,a as bm,b as Rt,c as Fe,d as Gn,e as Je,f as nr,g as Oo,p as jm,T as Nm}from"./TabBar-BZP7k6uZ.js";import{s as Es}from"./index-D0E7N0oa.js";import{g as wm,v as Bo,R as km,I as Cm,a as Sm,b as Am,c as Im}from"./recover-wallet-form-D9_UaBFi.js";import{S as Tm}from"./swiper-sync-context-Du4-8uVQ.js";import{h as Pm,c as Em,W as _m,C as ar,s as Gt}from"./token-item-scgVCTFk.js";import{L as Pe,G as Ue,A as Qt,P as jt,I as en,b as ra}from"./LoadingSpinner-C1kwZdQs.js";import{u as B}from"./useTranslation-Ck-b1HK6.js";import{I as Oe}from"./IconAlertTriangle-BaKNLH8d.js";import{I as ns}from"./IconTrash-BH0OyIZv.js";import{c as rr,I as Fo}from"./web-C4zgUJid.js";import{t as Mm}from"./web--YjHdHjW.js";import{B as xs,k as $e,M as Jt,q as rt,E as Rm,j as Nn,D as ia,N as Lm}from"./derivation-C2wjCcMH.js";import{p as kt,g as Wo,n as Ss,a as Dm}from"./notification-Dt0BRf6D.js";import{g as Ee,N as $o,o as zm,q as Xt,u as Kr,C as as,v as Ze,I as Om}from"./index-DwhhC-lB.js";import"./breakpoint-DQ_qwb34.js";import{T as qo}from"./transaction-item-BYC2dflm.js";import{A as oe}from"./amount-BQsqQYGO.js";import{I as mt}from"./IconPlus-uQIuSHlc.js";import{c as ue}from"./createReactComponent-Bhrjr7p9.js";import{I as In,b as Ho,c as oa,d as Fs,e as Bm,g as Fm,f as Wm,h as $m}from"./transaction-meta-CQ9eNTSu.js";import{I as qm,i as Hm,A as Um}from"./address-input-BXmF34s4.js";import{A as wt}from"./amount-display-DGCs5_tX.js";import"./animated-number-B4HvtmQC.js";import{T as Vm}from"./time-display-RnicvuRp.js";import{F as Jm,E as Uo,S as Km,C as Gr}from"./service-status-alert-Bzbg6i6w.js";import{e as ir,K as Gm,L as Vo,M as Qm,u as Xm,J as Re,l as Jo,N as Ko,O as Ym,T as Zm,P as ef,Q as tf,R as Qr,d as sf,S as Xr,U as Yr,V as Zr,W as ei,X as ti,Y as si,Z as ni,_ as ai,$ as ri,a0 as ii,a1 as oi,a2 as ci,a3 as Go,a4 as nf,a5 as af,a6 as li,a7 as rf,a8 as of}from"./index-CIU3zT8R.js";import{I as cf,a as lf}from"./my-apps-page-NLPzYRox.js";import{E as df,c as Lt}from"./ecosystem-desktop-1Yv35JZE.js";import"./miniapp-splash-screen-BHknLyzb.js";import{u as uf}from"./item-BoJEG7WG.js";import{_ as Et}from"./preload-helper-PPVm8Dsz.js";import{P as J}from"./page-header-CC8vq_m2.js";import{C as Ns,I as mf}from"./contact-avatar-DletV0bf.js";import{I as De}from"./IconChevronRight-DNFKLknG.js";import{S as St,a as At,b as It,c as Tt,u as ff,f as pf,D as hf,g as xf,h as gf,i as vf,j as yf,k as bf,l as jf,m as Nf,n as wf}from"./sheet-YeEUE0wn.js";import{I as Ne}from"./IconCheck-Cy0-eQdz.js";import{C as _t,a as Tn}from"./chain-icon-C34JGdBQ.js";import{p as Be,P as ft}from"./pattern-lock-CNfGeV46.js";import{P as bs}from"./password-input-CfTB_Y-N.js";import{I as tn}from"./IconLock-ItwlHAv0.js";import{I as Mt}from"./IconAlertCircle-D1GGLuFK.js";import{F as or}from"./fee-display-BptFK3Ce.js";import{T as Qo}from"./tx-status-display-DsaLUKzN.js";import{I as Ve}from"./input-B6Evnxq1.js";import{b as Kt,i as kf,d as Cf}from"./avatar-codec-CjjBdg2g.js";import{I as rs}from"./IconRefresh-BHVCZKea.js";import{I as sn}from"./IconSearch-Iwz3KlqX.js";import{I as nn}from"./IconDownload-B8Oq2dg1.js";import{W as Sf,r as Af}from"./wallet-mini-card-CO5g2QPb.js";import{I as If,W as Tf}from"./wallet-list-BETa3Rr9.js";import{C as Xo}from"./checkbox-Cs3szj1t.js";import{I as Yo,S as Ws,a as $s,b as qs,c as Hs,d as Yt,A as Zo}from"./asset-selector-CRcFW0-C.js";import{I as ec}from"./IconChevronDown-BgJ0OQFq.js";import{p as tc,g as cr}from"./qr-parser-CN55oPxT.js";import{c as sc}from"./index-BTM2Rv-j.js";import{g as Pf,a as Ef,b as _f}from"./scanner-validators-YRGmuXyx.js";import{I as an}from"./IconX-DNdAWDg6.js";import{I as lr}from"./IconWallet-BkQDlVLU.js";import{C as dr}from"./contact-card-WqLQzRn_.js";import{I as be}from"./IconLoader2-B6VDc7yn.js";import{g as Qn,n as Mf,p as Rf}from"./index-BkWKD4y7.js";import{a as wn,c as kn,s as Cn,p as Lf,i as Df}from"./bioforest-DQyLkPyY.js";import{I as zf}from"./IconApps-tvtKV9xX.js";import{I as ur}from"./IconShieldCheck-D-jrA03-.js";import{A as ot}from"./address-display-D_SzGijn.js";import{z as Of}from"./composite-CxFUebGo.js";import{f as Bf,u as mr,d as Ff,m as Wf}from"./useRenderElement-CrJYfdJ6.js";import{I as fr}from"./IconEye-D5DjB-ii.js";import{M as nc}from"./mnemonic-display-BfV3VxjI.js";import{P as pr}from"./pattern-lock-setup-4wqoKLuB.js";import{g as ac,C as hr}from"./chain-selector-Cslgi_TD.js";import{deriveWalletChainAddresses as rc}from"./index-BKuuU-kk.js";import{I as ic}from"./IconEyeOff-OAyNpGyb.js";import{I as ws}from"./IconCircleCheck-Dr-qn0xi.js";import"./asset-item-BvIbwudp.js";import"./asset-list-BCNuLlKc.js";import{A as oc}from"./amount-input-BlJeh8TU.js";import{B as $f}from"./balance-display-BdRJGB8K.js";import{S as qf,I as cc}from"./send-result-gzk0KBfB.js";import{T as lc}from"./Trans-DnCinIVt.js";import{M as Hf}from"./mnemonic-input-DWHiEOE5.js";import{T as dc}from"./transaction-list-B6Faf2dJ.js";import{T as Uf}from"./transaction-status-CihPgHTS.js";import{I as Ea}from"./IconExternalLink-kqQQHliB.js";import{A as uc}from"./AppInfoCard-CJlV6eX3.js";import{P as Vf}from"./PermissionList-BND-4FM1.js";import{W as Jf}from"./wallet-selector-DDqlVDlA.js";import{T as ct}from"./token-icon-D_GQBY0n.js";import{T as di}from"./TransactionDetails-BaHRAmFH.js";import{B as ui}from"./BalanceWarning-DQIIP6Ar.js";import{K as Kf}from"./key-type-selector-zfCUiqvb.js";import{A as Gf}from"./arbitrary-key-input-m-4wQxIp.js";import{C as Qf}from"./chain-address-preview-CrhUrZ58.js";import{C as Xf}from"./collision-confirm-dialog-Cbnb26vB.js";import{I as Yf}from"./dropdown-menu-xNxphSlb.js";import"./hologram-canvas-DtWNGV_U.js";import{I as Zf}from"./IconPencil-CGhpVW_g.js";import{I as ep}from"./IconBell-21QCszYK.js";import{I as tp}from"./IconCircleX-Dd7DEzr0.js";import{I as sp}from"./IconClock-BGNd2HL-.js";import{j as ks,s as ce,c as Pt,n as Xn,i as mc,l as Ct,a as xr}from"./schemas-CO8_C8zP.js";import{I as np}from"./IconShield-CPusYXHq.js";const ap=[["path",{d:"M20 6v12a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2z",key:"svg-0"}],["path",{d:"M10 16h6",key:"svg-1"}],["path",{d:"M13 11m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-2"}],["path",{d:"M4 8h3",key:"svg-3"}],["path",{d:"M4 12h3",key:"svg-4"}],["path",{d:"M4 16h3",key:"svg-5"}]],rp=ue("outline","address-book","AddressBook",ap);const ip=[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 15h10.55",key:"svg-1"}],["path",{d:"M6.551 4.938l3.26 10.034",key:"svg-2"}],["path",{d:"M17.032 4.636l-8.535 6.201",key:"svg-3"}],["path",{d:"M20.559 14.51l-8.535 -6.201",key:"svg-4"}],["path",{d:"M12.257 20.916l3.261 -10.034",key:"svg-5"}]],fc=ue("outline","aperture","Aperture",ip);const op=[["path",{d:"M17 7l-10 10",key:"svg-0"}],["path",{d:"M16 17l-9 0l0 -9",key:"svg-1"}]],cp=ue("outline","arrow-down-left","ArrowDownLeft",op);const lp=[["path",{d:"M7 7l10 10",key:"svg-0"}],["path",{d:"M17 8l0 9l-9 0",key:"svg-1"}]],dp=ue("outline","arrow-down-right","ArrowDownRight",lp);const up=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M13 18l6 -6",key:"svg-1"}],["path",{d:"M13 6l6 6",key:"svg-2"}]],pc=ue("outline","arrow-right","ArrowRight",up);const mp=[["path",{d:"M17 7l-10 10",key:"svg-0"}],["path",{d:"M8 7l9 0l0 9",key:"svg-1"}]],hc=ue("outline","arrow-up-right","ArrowUpRight",mp);const fp=[["path",{d:"M3 12h1m8 -9v1m8 8h1m-15.4 -6.4l.7 .7m12.1 -.7l-.7 .7",key:"svg-0"}],["path",{d:"M9 16a5 5 0 1 1 6 0a3.5 3.5 0 0 0 -1 3a2 2 0 0 1 -4 0a3.5 3.5 0 0 0 -1 -3",key:"svg-1"}],["path",{d:"M9.7 17l4.6 0",key:"svg-2"}]],xc=ue("outline","bulb","Bulb",fp);const pp=[["path",{d:"M5 7h1a2 2 0 0 0 2 -2a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1a2 2 0 0 0 2 2h1a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-9a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M9 13a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-1"}]],hp=ue("outline","camera","Camera",pp);const xp=[["path",{d:"M14 10m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-0"}],["path",{d:"M21 12a9 9 0 1 1 -18 0a9 9 0 0 1 18 0z",key:"svg-1"}],["path",{d:"M12.5 11.5l-4 4l1.5 1.5",key:"svg-2"}],["path",{d:"M12 15l-1.5 -1.5",key:"svg-3"}]],gr=ue("outline","circle-key","CircleKey",xp);const gp=[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M14.8 9a2 2 0 0 0 -1.8 -1h-2a2 2 0 1 0 0 4h2a2 2 0 1 1 0 4h-2a2 2 0 0 1 -1.8 -1",key:"svg-1"}],["path",{d:"M12 7v10",key:"svg-2"}]],vp=ue("outline","coin","Coin",gp);const yp=[["path",{d:"M16.7 8a3 3 0 0 0 -2.7 -2h-4a3 3 0 0 0 0 6h4a3 3 0 0 1 0 6h-4a3 3 0 0 1 -2.7 -2",key:"svg-0"}],["path",{d:"M12 3v3m0 12v3",key:"svg-1"}]],bp=ue("outline","currency-dollar","CurrencyDollar",yp);const jp=[["path",{d:"M6 12l6 -9l6 9l-6 9z",key:"svg-0"}],["path",{d:"M6 12l6 -3l6 3l-6 2z",key:"svg-1"}]],Np=ue("outline","currency-ethereum","CurrencyEthereum",jp);const wp=[["path",{d:"M12 6m-8 0a8 3 0 1 0 16 0a8 3 0 1 0 -16 0",key:"svg-0"}],["path",{d:"M4 6v6a8 3 0 0 0 16 0v-6",key:"svg-1"}],["path",{d:"M4 12v6a8 3 0 0 0 16 0v-6",key:"svg-2"}]],gc=ue("outline","database","Database",wp);const kp=[["path",{d:"M3 5a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v10a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1v-10z",key:"svg-0"}],["path",{d:"M7 20h10",key:"svg-1"}],["path",{d:"M9 16v4",key:"svg-2"}],["path",{d:"M15 16v4",key:"svg-3"}]],Cp=ue("outline","device-desktop","DeviceDesktop",kp);const Sp=[["path",{d:"M3 3m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["circle",{cx:"8.5",cy:"8.5",r:".5",fill:"currentColor",key:"svg-1"}],["circle",{cx:"15.5",cy:"8.5",r:".5",fill:"currentColor",key:"svg-2"}],["circle",{cx:"15.5",cy:"15.5",r:".5",fill:"currentColor",key:"svg-3"}],["circle",{cx:"8.5",cy:"15.5",r:".5",fill:"currentColor",key:"svg-4"}],["circle",{cx:"12",cy:"12",r:".5",fill:"currentColor",key:"svg-5"}]],Ap=ue("outline","dice-5","Dice5",Sp);const Ip=[["path",{d:"M4 4h16v2.172a2 2 0 0 1 -.586 1.414l-4.414 4.414v7l-6 2v-8.5l-4.48 -4.928a2 2 0 0 1 -.52 -1.345v-2.227z",key:"svg-0"}]],vc=ue("outline","filter","Filter",Ip);const Tp=[["path",{d:"M18.9 7a8 8 0 0 1 1.1 5v1a6 6 0 0 0 .8 3",key:"svg-0"}],["path",{d:"M8 11a4 4 0 0 1 8 0v1a10 10 0 0 0 2 6",key:"svg-1"}],["path",{d:"M12 11v2a14 14 0 0 0 2.5 8",key:"svg-2"}],["path",{d:"M8 15a18 18 0 0 0 1.8 6",key:"svg-3"}],["path",{d:"M4.9 19a22 22 0 0 1 -.9 -7v-1a8 8 0 0 1 12 -6.95",key:"svg-4"}]],Pp=ue("outline","fingerprint","Fingerprint",Tp);const Ep=[["path",{d:"M7 12h3v4h-3z",key:"svg-0"}],["path",{d:"M10 6h-6a1 1 0 0 0 -1 1v12a1 1 0 0 0 1 1h16a1 1 0 0 0 1 -1v-12a1 1 0 0 0 -1 -1h-6",key:"svg-1"}],["path",{d:"M10 3m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v3a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M14 16h2",key:"svg-3"}],["path",{d:"M14 12h4",key:"svg-4"}]],_p=ue("outline","id-badge-2","IdBadge2",Ep);const Mp=[["path",{d:"M9 6.371c0 4.418 -2.239 6.629 -5 6.629",key:"svg-0"}],["path",{d:"M4 6.371h7",key:"svg-1"}],["path",{d:"M5 9c0 2.144 2.252 3.908 6 4",key:"svg-2"}],["path",{d:"M12 20l4 -9l4 9",key:"svg-3"}],["path",{d:"M19.1 18h-6.2",key:"svg-4"}],["path",{d:"M6.694 3l.793 .582",key:"svg-5"}]],Rp=ue("outline","language","Language",Mp);const Lp=[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]],yc=ue("outline","link","Link",Lp);const Dp=[["path",{d:"M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z",key:"svg-0"}]],zp=ue("outline","moon","Moon",Dp);const Op=[["path",{d:"M6 9a6 6 0 1 0 12 0a6 6 0 0 0 -12 0",key:"svg-0"}],["path",{d:"M12 3c1.333 .333 2 2.333 2 6s-.667 5.667 -2 6",key:"svg-1"}],["path",{d:"M12 3c-1.333 .333 -2 2.333 -2 6s.667 5.667 2 6",key:"svg-2"}],["path",{d:"M6 9h12",key:"svg-3"}],["path",{d:"M3 20h7",key:"svg-4"}],["path",{d:"M14 20h7",key:"svg-5"}],["path",{d:"M10 20a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-6"}],["path",{d:"M12 15v3",key:"svg-7"}]],Bp=ue("outline","network","Network",Op);const Fp=[["path",{d:"M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25",key:"svg-0"}],["path",{d:"M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}],["path",{d:"M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-3"}]],Wp=ue("outline","palette","Palette",Fp);const $p=[["path",{d:"M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4",key:"svg-0"}],["path",{d:"M13.5 6.5l4 4",key:"svg-1"}],["path",{d:"M16 19h6",key:"svg-2"}]],qp=ue("outline","pencil-minus","PencilMinus",$p);const Hp=[["path",{d:"M4 4m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M7 17l0 .01",key:"svg-1"}],["path",{d:"M14 4m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M7 7l0 .01",key:"svg-3"}],["path",{d:"M4 14m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-4"}],["path",{d:"M17 7l0 .01",key:"svg-5"}],["path",{d:"M14 14l3 0",key:"svg-6"}],["path",{d:"M20 14l0 .01",key:"svg-7"}],["path",{d:"M14 14l0 3",key:"svg-8"}],["path",{d:"M14 20l3 0",key:"svg-9"}],["path",{d:"M17 17l3 0",key:"svg-10"}],["path",{d:"M20 17l0 3",key:"svg-11"}]],Up=ue("outline","qrcode","Qrcode",Hp);const Vp=[["path",{d:"M10 14l11 -11",key:"svg-0"}],["path",{d:"M21 3l-6.5 18a.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a.55 .55 0 0 1 0 -1l18 -6.5",key:"svg-1"}]],bc=ue("outline","send","Send",Vp);const Jp=[["path",{d:"M8 9h-1a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-8a2 2 0 0 0 -2 -2h-1",key:"svg-0"}],["path",{d:"M12 14v-11",key:"svg-1"}],["path",{d:"M9 6l3 -3l3 3",key:"svg-2"}]],Kp=ue("outline","share-2","Share2",Jp);const Gp=[["path",{d:"M6 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-0"}],["path",{d:"M18 6m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-1"}],["path",{d:"M18 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-2"}],["path",{d:"M8.7 10.7l6.6 -3.4",key:"svg-3"}],["path",{d:"M8.7 13.3l6.6 3.4",key:"svg-4"}]],Us=ue("outline","share","Share",Gp);const Qp=[["path",{d:"M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7",key:"svg-1"}]],Xp=ue("outline","sun","Sun",Qp);const Yp=[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 9h16.8",key:"svg-1"}],["path",{d:"M3.6 15h16.8",key:"svg-2"}],["path",{d:"M11.5 3a17 17 0 0 0 0 18",key:"svg-3"}],["path",{d:"M12.5 3a17 17 0 0 1 0 18",key:"svg-4"}]],jc=ue("outline","world","World",Yp),Zp=15,eh=1440*60*1e3;function th(t){return Math.floor(t.getTime()/eh)}function sh(t=new Date){const s=th(t);return Zp*(s+1)%100}function mi(t,s=new Date){const n=typeof t.officialScore=="number"?t.officialScore:0,a=typeof t.communityScore=="number"?t.communityScore:0,r=sh(s),o=100-r;return(n*r+a*o)/100}function vr(){return rr}function nt(){return Mm}function rn(){return Pm}function Nc(){return Em}const Pn={authorizeAddress:"/wallet/authorize/address",authorizeSignature:"/wallet/authorize/signature"};class nh{constructor(s,n){this.adapter=s,this.eventId=n}hasResponded=!1;handleNetworkAddresses(s,n){const a=n.trim().toLowerCase();if(!a)return[];const r=[];for(const o of s)for(const d of o.chainAddresses)String(d.chain).toLowerCase()===a&&r.push({name:o.name,address:d.address,chainName:d.chain,publicKey:"",magic:`${o.id}:${d.chain}`,signMessage:""});return r}handleMainAddresses(s){return s.chainAddresses.map(n=>({name:s.name,address:n.address,chainName:n.chain,publicKey:"",magic:`${s.id}:${n.chain}`,signMessage:""}))}async handleMainAddressesSigned(s,n){const a=this.handleMainAddresses(s);return await this.applySensitiveOptions(a,[s],{password:n.password,signMessage:n.signMessage,getMain:!1})}handleAllAddresses(s){const n=[];for(const a of s)n.push(...this.handleMainAddresses(a));return n}async handleAllAddressesSigned(s,n){const a=this.handleAllAddresses(s);return await this.applySensitiveOptions(a,s,{password:n.password,signMessage:n.signMessage,getMain:!1})}async handleNetworkAddressesSigned(s,n,a){const r=this.handleNetworkAddresses(s,n);return await this.applySensitiveOptions(r,s,{password:a.password,signMessage:a.signMessage,getMain:!1})}async applySensitiveOptions(s,n,a){return await this.applyPasswordProtectedFields(s,n,a)}async approve(s){await this.respondOnce(Pn.authorizeAddress,s)}async reject(s){await this.respondOnce(Pn.authorizeAddress,null)}async respondOnce(s,n){if(!this.hasResponded){this.hasResponded=!0;try{await this.adapter.respondWith(this.eventId,s,n)}finally{await this.adapter.removeEventId(this.eventId)}}}async applyPasswordProtectedFields(s,n,a){const r=a.signMessage?.trim()??"",o=!!r,d=!!a.getMain;if(!o&&!d)return s;const i=new Map;for(const m of n)i.set(m.id,m);const l=new Map,u=new Set;for(const m of s){const f=this.getWalletIdFromMagic(m.magic),h=i.get(f),g=h?.encryptedMnemonic;if(!h||!g)throw new Error("Missing secret");const b=m.chainName.trim().toLowerCase();if(d){let p=l.get(f);if(!p){try{p=await xs(g,a.password)}catch{throw new Error("Invalid password")}l.set(f,p)}m.main=p}if(o){if(wn(b)){let p=l.get(f);if(!p){try{p=await xs(g,a.password)}catch{throw new Error("Invalid password")}l.set(f,p)}const x=kn(p),v=Cn(r,x.secretKey);m.signMessage=`0x${$e(v)}`,m.publicKey=$e(x.publicKey);continue}if(!u.has(f))if(l.has(f))u.add(f);else{if(!await Jt(g,a.password))throw new Error("Invalid password");u.add(f)}m.signMessage=this.createDeterministicMockSignature({message:r,address:m.address,chainName:m.chainName})}}return s}getWalletIdFromMagic(s){const n=s.indexOf(":");return n===-1?s:s.slice(0,n)}createDeterministicMockSignature({message:s,address:n,chainName:a}){const r=new TextEncoder,o=rt(r.encode(`address:${n}|chain:${a}|message:${s}`)),d=rt(r.encode(`event:${this.eventId}`)),i=new Uint8Array(64);return i.set(o,0),i.set(d,32),`0x${$e(i)}`}}class wc{constructor(s,n){this.adapter=s,this.eventId=n}hasResponded=!1;async approve(s){await this.respondOnce(Pn.authorizeSignature,s)}async reject(s){await this.respondOnce(Pn.authorizeSignature,null)}async handleMessageSign(s,n,a){const r=s.chainName.trim(),o=r.toLowerCase(),d=dt.getConfig(r)??dt.getConfig(o);if(wn(o)||d?.chainKind==="bioforest"){let u;try{u=await xs(n,a)}catch{throw new Error("Invalid password")}const m=kn(u),f=d?.prefix??(s.senderAddress.slice(0,1)||"b");if(Lf(m.publicKey,f)!==s.senderAddress)throw new Error("Signing address mismatch");const g=Cn(s.message,m.secretKey);return{signature:`0x${$e(g)}`,publicKey:$e(m.publicKey)}}if(!await Jt(n,a))throw new Error("Invalid password");{const u=new TextEncoder,m=rt(u.encode(`message:${s.message}`)),f=rt(u.encode(`event:${this.eventId}`)),h=new Uint8Array(64);h.set(m,0),h.set(f,32);const g=rt(u.encode(`pubkey:${s.senderAddress}`));return{signature:`0x${$e(h)}`,publicKey:$e(g)}}}async handleTransferSign(s,n,a){const r=s.chainName.trim().toLowerCase(),o=["transfer",r,s.senderAddress,s.receiveAddress,s.balance,s.fee??"",s.contractInfo?.assetType??s.assetType??"",s.contractInfo?.contractAddress??"",s.contractInfo?.decimals?.toString()??""].join("|");if(wn(r)){let f;try{f=await xs(n,a)}catch{throw new Error("Invalid password")}const h=kn(f),g=Cn(o,h.secretKey);return`0x${$e(g)}`}if(!await Jt(n,a))throw new Error("Invalid password");const i=new TextEncoder,l=rt(i.encode(o)),u=rt(i.encode(`event:${this.eventId}`)),m=new Uint8Array(64);return m.set(l,0),m.set(u,32),`0x${$e(m)}`}async handleDestroySign(s,n,a){const r=s.chainName.trim().toLowerCase(),o=["destory",r,s.senderAddress,s.destoryAddress,s.destoryAmount,s.fee??"",s.assetType??""].join("|");if(wn(r)){let f;try{f=await xs(n,a)}catch{throw new Error("Invalid password")}const h=kn(f),g=Cn(o,h.secretKey);return`0x${$e(g)}`}if(!await Jt(n,a))throw new Error("Invalid password");const i=new TextEncoder,l=rt(i.encode(o)),u=rt(i.encode(`event:${this.eventId}`)),m=new Uint8Array(64);return m.set(l,0),m.set(u,32),`0x${$e(m)}`}async respondOnce(s,n){if(!this.hasResponded){this.hasResponded=!0;try{await this.adapter.respondWith(this.eventId,s,n)}finally{await this.adapter.removeEventId(this.eventId)}}}}class ah{async getCallerAppInfo(s){throw new Error("DWEB runtime not available in web environment")}async respondWith(s,n,a){throw new Error("DWEB runtime not available in web environment")}async removeEventId(s){}isAvailable(){return!1}}const Vs=new ah,rh={"zh-CN":Es.wordlists.chinese_simplified,"zh-TW":Es.wordlists.chinese_traditional,ja:Es.wordlists.japanese,ko:Es.wordlists.korean},ih=["zh-CN","zh-TW","ja","ko"];function En(t){const s=rh[t]??Es.wordlists.english,n=s[Math.floor(Math.random()*s.length)];return ih.includes(t)?n:n.charAt(0).toUpperCase()+n.slice(1)}function oh(){return typeof window>"u"}function pn(){return!oh()}function ch(){const t={value:null};function s(){return t.value}function n(a){t.value=a}return[s,n]}var ca,fi;function lh(){if(fi)return ca;fi=1;var t=typeof Element<"u",s=typeof Map=="function",n=typeof Set=="function",a=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function r(o,d){if(o===d)return!0;if(o&&d&&typeof o=="object"&&typeof d=="object"){if(o.constructor!==d.constructor)return!1;var i,l,u;if(Array.isArray(o)){if(i=o.length,i!=d.length)return!1;for(l=i;l--!==0;)if(!r(o[l],d[l]))return!1;return!0}var m;if(s&&o instanceof Map&&d instanceof Map){if(o.size!==d.size)return!1;for(m=o.entries();!(l=m.next()).done;)if(!d.has(l.value[0]))return!1;for(m=o.entries();!(l=m.next()).done;)if(!r(l.value[1],d.get(l.value[0])))return!1;return!0}if(n&&o instanceof Set&&d instanceof Set){if(o.size!==d.size)return!1;for(m=o.entries();!(l=m.next()).done;)if(!d.has(l.value[0]))return!1;return!0}if(a&&ArrayBuffer.isView(o)&&ArrayBuffer.isView(d)){if(i=o.length,i!=d.length)return!1;for(l=i;l--!==0;)if(o[l]!==d[l])return!1;return!0}if(o.constructor===RegExp)return o.source===d.source&&o.flags===d.flags;if(o.valueOf!==Object.prototype.valueOf&&typeof o.valueOf=="function"&&typeof d.valueOf=="function")return o.valueOf()===d.valueOf();if(o.toString!==Object.prototype.toString&&typeof o.toString=="function"&&typeof d.toString=="function")return o.toString()===d.toString();if(u=Object.keys(o),i=u.length,i!==Object.keys(d).length)return!1;for(l=i;l--!==0;)if(!Object.prototype.hasOwnProperty.call(d,u[l]))return!1;if(t&&o instanceof Element)return!1;for(l=i;l--!==0;)if(!((u[l]==="_owner"||u[l]==="__v"||u[l]==="__o")&&o.$$typeof)&&!r(o[u[l]],d[u[l]]))return!1;return!0}return o!==o&&d!==d}return ca=function(d,i){try{return r(d,i)}catch(l){if((l.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw l}},ca}var dh=lh();const Ms=rm(dh);function kc(t){const s=c.useRef(t),n=s.current,a=Ms(n,t);return c.useEffect(()=>{a||(s.current=t)},[t]),a?n:t}var yr=c.createContext(null),Cc=({children:t,value:s})=>e.jsx(yr.Provider,{value:kc(s),children:t});Cc.displayName="ActivityProvider";var uh=()=>c.useContext(yr);function mh(){return c.useContext(yr).params}var Sc=c.createContext(null),Ac=({children:t,value:s})=>e.jsx(Sc.Provider,{value:kc(s),children:t});Ac.displayName="StackProvider";var fh=()=>c.useContext(Sc),ph=Object.defineProperty,hh=Object.defineProperties,xh=Object.getOwnPropertyDescriptors,_n=Object.getOwnPropertySymbols,Ic=Object.prototype.hasOwnProperty,Tc=Object.prototype.propertyIsEnumerable,pi=(t,s,n)=>s in t?ph(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,xe=(t,s)=>{for(var n in s||(s={}))Ic.call(s,n)&&pi(t,n,s[n]);if(_n)for(var n of _n(s))Tc.call(s,n)&&pi(t,n,s[n]);return t},we=(t,s)=>hh(t,xh(s)),gh=(t,s)=>{var n={};for(var a in t)Ic.call(t,a)&&s.indexOf(a)<0&&(n[a]=t[a]);if(t!=null&&_n)for(var a of _n(t))s.indexOf(a)<0&&Tc.call(t,a)&&(n[a]=t[a]);return n};function vh(t,s,n){const a=n(t),r=n(s);return a<r?-1:a===r?0:1}var yh=(t,s)=>{const n=[],a=[];return t.forEach(r=>{s(r)?n.push(r):a.push(r)}),[n,a]};function Pc(t,s){return t.map((n,a)=>s(n)?a:void 0).filter(n=>typeof n=="number")}var la=0,hi=0,Ec=()=>{const t=new Date().getTime();return hi===t?la+=1:(hi=t,la=0),(t*1e3+la)/1e3};function it(){return(Ec()*1e3).toString(16)}function Yn(t){return t.length===0?void 0:t[t.length-1]}function xi(t,s){const n=xe({},t);return s.forEach(a=>{delete n[a]}),n}function bh(t){let s=!1;return()=>{s||(s=!0,t())}}function jh(t,s){const n=new Map;return[...t].reverse().filter(a=>{const r=s(a);if(r===null)return!0;const o=!!n.get(r);return n.set(r,!0),!o}).reverse()}function _a(t){return!t.exitedBy}function Ma(t,s){return s.enteredBy.eventDate-t.enteredBy.eventDate}function gi(t){return t.filter(_a).sort(Ma)[0]}function Nh(t,s,n){const a=[];switch(s.name){case"Replaced":{if(Yn(Pc(t,l=>l.id===s.activityId))!==void 0)break;const o=t.slice().sort(Ma).filter(_a),d=n.now-s.eventDate>=n.transitionDuration;if((s.skipEnterActiveState||d?"enter-done":"enter-active")==="enter-done"){const l=o.findIndex(u=>!(s.skipEnterActiveState&&u.enteredBy.name==="Replaced"&&u.transitionState==="enter-active"));return o.slice(0,l+1).map(u=>t.indexOf(u))}break}case"Popped":{const r=t.filter(_a).sort(Ma),o=r.slice(0,r.length-1)[0];o&&a.push(t.indexOf(o));break}case"StepPushed":case"StepReplaced":{const r=gi(t);if(r){if(s.targetActivityId&&s.targetActivityId!==r.id)break;a.push(t.indexOf(r))}break}case"StepPopped":{const r=gi(t);if(r&&r.steps.length>1){if(s.targetActivityId&&s.targetActivityId!==r.id)break;a.push(t.indexOf(r))}break}}return a}function vi(t,s){switch(s.name){case"Pushed":case"Replaced":{const n=Yn(Pc(t,a=>a.id===s.activityId));return n??t.length}default:return-1}}function yi(t,s){return{id:t.activityId,name:t.activityName,transitionState:s,params:t.activityParams,context:t.activityContext,steps:[{id:t.activityId,params:t.activityParams,enteredBy:t,zIndex:-1}],enteredBy:t,isTop:!1,isActive:!1,isRoot:!1,zIndex:-1}}function br(t){return(s,n)=>{const a=t[n.name].bind(t);if(a)return a(s,n);throw new Error(`No reducer for event ${JSON.stringify(n)}`)}}function vt(t){return t}function wh({transitionDuration:t,now:s,resumedAt:n}){return br({Pushed(a,r){const o=s-(n??r.eventDate)>=t,d=r.skipEnterActiveState||o?"enter-done":"enter-active",i=vi(a,r);return[...a.slice(0,i),yi(r,d),...a.slice(i+1)]},Replaced(a,r){var o,d;const i=s-(n??r.eventDate)>=t,l=vi(a,r),u=(d=(o=a[l])==null?void 0:o.transitionState)!=null?d:r.skipEnterActiveState||i?"enter-done":"enter-active";return[...a.slice(0,l),yi(r,u),...a.slice(l+1)]},Initialized:vt,ActivityRegistered:vt,Popped:vt,StepPushed:vt,StepReplaced:vt,StepPopped:vt,Paused:vt,Resumed:vt})}function As(t){return t}function kh(t){return br({Replaced:(s,n)=>we(xe({},s),{exitedBy:n,transitionState:"exit-done"}),Popped:(s,n)=>{var a;const r=t.now-((a=t.resumedAt)!=null?a:n.eventDate)>=t.transitionDuration,o=n.skipExitActiveState||r?"exit-done":"exit-active";return we(xe({},s),{exitedBy:n,transitionState:o,params:o==="exit-done"?s.steps[0].params:s.params,steps:o==="exit-done"?[s.steps[0]]:s.steps})},StepPushed:(s,n)=>{var a;const r={id:n.stepId,params:n.stepParams,enteredBy:n,zIndex:s.zIndex,hasZIndex:(a=n.hasZIndex)!=null?a:!1};return we(xe({},s),{params:n.stepParams,steps:[...s.steps,r]})},StepReplaced:(s,n)=>{var a;const r={id:n.stepId,params:n.stepParams,enteredBy:n,zIndex:s.zIndex,hasZIndex:(a=n.hasZIndex)!=null?a:!1};return we(xe({},s),{params:n.stepParams,steps:[...s.steps.slice(0,s.steps.length-1),r]})},StepPopped:(s,n)=>{var a;s.steps.pop();const r=(a=Yn(s.steps))==null?void 0:a.params;return we(xe({},s),{params:r??s.params})},Initialized:As,ActivityRegistered:As,Pushed:As,Paused:As,Resumed:As})}function at(t){return(s,n)=>s.globalTransitionState==="paused"?we(xe({},s),{pausedEvents:s.pausedEvents?[...s.pausedEvents,n]:[n]}):t(s,n)}function Ke(t,s){return(n,a)=>{const r=wh({transitionDuration:n.transitionDuration,now:s.now,resumedAt:s.resumedAt}),o=kh({transitionDuration:n.transitionDuration,now:s.now,resumedAt:s.resumedAt}),d=r(n.activities,a),i=Nh(n.activities,a,{transitionDuration:n.transitionDuration,now:s.now});for(const m of i)d[m]=o(d[m],a);const l=d.find(m=>m.transitionState==="enter-active"||m.transitionState==="exit-active"),u=n.globalTransitionState==="paused"?"paused":l?"loading":"idle";return t(we(xe({},n),{activities:d,globalTransitionState:u}),a)}}function ds(t,s){return we(xe({},t),{events:[...t.events,s]})}function _c(t){return br({Initialized:at(Ke((s,n)=>we(xe({},s),{transitionDuration:n.transitionDuration,events:[...s.events,n]}),t)),ActivityRegistered:at(Ke((s,n)=>we(xe({},s),{registeredActivities:[...s.registeredActivities,xe({name:n.activityName},n.activityParamsSchema?{paramsSchema:n.activityParamsSchema}:null)],events:[...s.events,n]}),t)),Paused:at(Ke((s,n)=>we(xe({},s),{globalTransitionState:"paused",events:[...s.events,n]}),t)),Resumed:Ke((s,n)=>{if(s.globalTransitionState!=="paused"||!s.pausedEvents)return we(xe({},s),{events:[...s.events,n]});const a=_c({now:t.now,resumedAt:n.eventDate}),r=s,{pausedEvents:o}=r,d=gh(r,["pausedEvents"]),i=o.reduce(a,we(xe({},d),{globalTransitionState:"idle"}));return we(xe({},i),{events:[...i.events,n]})},t),Pushed:at(Ke(ds,t)),Replaced:at(Ke(ds,t)),Popped:at(Ke(ds,t)),StepPushed:at(Ke(ds,t)),StepReplaced:at(Ke(ds,t)),StepPopped:at(Ke(ds,t))})}function da(t,s){return t.filter(n=>n.name===s)}function Sn(t,s){return we(xe({id:it(),eventDate:Ec()},s),{name:t})}function Ch(t){if(t.length===0)throw new Error("events parameter is empty");if(da(t,"Initialized").length>1)throw new Error("InitializedEvent can only exist once");const n=da(t,"ActivityRegistered"),a=new Set(n.map(o=>o.activityName));if(da(t,"Pushed").some(o=>!a.has(o.activityName)))throw new Error("the corresponding activity does not exist")}function ua(t,s){const n=jh([...t].sort((m,f)=>m.eventDate-f.eventDate),m=>m.id);Ch(n);const a=_c({now:s}),r=n.reduce(a,{activities:[],globalTransitionState:"idle",registeredActivities:[],transitionDuration:0,events:[]}),o=r.activities.filter(m=>m.transitionState==="enter-active"||m.transitionState==="enter-done"||m.transitionState==="exit-active"),d=o.filter(m=>m.transitionState==="enter-active"||m.transitionState==="enter-done"),i=o[o.length-1],l=d[d.length-1];return we(xe({},r),{activities:r.activities.map(m=>{let f=o.findIndex(({id:b})=>b===m.id);const h=o.slice(0,f);for(const b of h)for(const p of b.steps)p.hasZIndex&&(f+=1);const g=m.steps.reduce((b,p)=>{var x;const v=Yn(b),j=(x=v?.zIndex)!=null?x:f;return[...b,we(xe({},p),{zIndex:j+(p.hasZIndex?1:0)})]},[]);return xe(xe({id:m.id,name:m.name,transitionState:m.transitionState,params:m.params,steps:g,enteredBy:m.enteredBy,zIndex:f,isTop:i?.id===m.id,isActive:l?.id===m.id,isRoot:f===0||f===1&&m.transitionState==="enter-active"&&m.enteredBy.name==="Replaced"},m.exitedBy?{exitedBy:m.exitedBy}:null),m.context?{context:m.context}:null)}).sort((m,f)=>vh(m,f,h=>h.id))})}function Sh(t,s){var n,a,r,o,d,i,l,u;const m=[];!Ms(t,s)&&m.push({_TAG:"%SOMETHING_CHANGED%"});const h=t.globalTransitionState!=="paused"&&s.globalTransitionState==="paused",g=t.globalTransitionState==="paused"&&s.globalTransitionState!=="paused";h&&m.push({_TAG:"PAUSED"}),g&&m.push({_TAG:"RESUMED"});for(let b=0;b<Math.max(t.activities.length,s.activities.length);b+=1){const p=t.activities[b],x=s.activities[b],v=p?.transitionState==="exit-done"||p?.transitionState==="exit-active",j=x?.transitionState==="enter-active"||x?.transitionState==="enter-done";if(p&&x&&p.id===x.id)for(let N=0;N<Math.max(((n=p.steps)!=null?n:[]).length,((a=x.steps)!=null?a:[]).length);N+=1){const y=p.steps[N],S=x.steps[N];!y&&S?m.push({_TAG:"STEP_PUSHED",activity:x,step:S}):y&&!S?m.push({_TAG:"STEP_POPPED",activity:x}):p.steps.length===x.steps.length&&y.id!==S.id&&m.push({_TAG:"STEP_REPLACED",activity:x,step:S})}!p&&x?m.push({_TAG:x.enteredBy.name==="Pushed"?"PUSHED":"REPLACED",activity:x}):v&&j?m.push({_TAG:x.enteredBy.name==="Pushed"?"PUSHED":"REPLACED",activity:x}):p&&x&&p.id===x.id&&!Ms(xi(p,["isActive","isTop","isRoot","transitionState","zIndex"]),xi(x,["isActive","isTop","isRoot","transitionState","zIndex"]))&&x.enteredBy.name==="Replaced"&&!Ms(p.enteredBy,x.enteredBy)&&m.push({_TAG:"REPLACED",activity:x})}for(let b=Math.max(t.activities.length,s.activities.length)-1;b>=0;b-=1){const p=((r=t.activities[b])==null?void 0:r.transitionState)==="enter-done"||((o=t.activities[b])==null?void 0:o.transitionState)==="enter-active",x=((d=s.activities[b])==null?void 0:d.transitionState)==="exit-active"||((i=s.activities[b])==null?void 0:i.transitionState)==="exit-done",v=((l=s.activities[b+1])==null?void 0:l.enteredBy.name)==="Replaced"&&((u=s.activities[b+1])==null?void 0:u.transitionState)==="enter-done";p&&x&&!v&&m.push({_TAG:"POPPED",activity:s.activities[b]})}return m}var Ah={Pushed:"onBeforePush",Replaced:"onBeforeReplace",Popped:"onBeforePop",StepPushed:"onBeforeStepPush",StepReplaced:"onBeforeStepReplace",StepPopped:"onBeforeStepPop",Paused:"onBeforePause",Resumed:"onBeforeResume"};function yt(t,s,n,a){let r=!1,o=xe({},s);for(const d of n){const i=d[Ah[t]];i&&i({actionParams:xe({},o),actions:we(xe({},a),{preventDefault:()=>{r=!0},overrideActionParams:l=>{o=xe(xe({},o),l)}})})}return{isPrevented:r,nextActionParams:o}}function Ih({dispatchEvent:t,pluginInstances:s,actions:n}){return{push(a){const{isPrevented:r,nextActionParams:o}=yt("Pushed",a,s,n);r||t("Pushed",o)},replace(a){const{isPrevented:r,nextActionParams:o}=yt("Replaced",a,s,n);r||t("Replaced",o)},pop(a={}){const{isPrevented:r,nextActionParams:o}=yt("Popped",a,s,n);r||t("Popped",o)},stepPush(a){const{isPrevented:r,nextActionParams:o}=yt("StepPushed",a,s,n);r||t("StepPushed",o)},stepReplace(a){const{isPrevented:r,nextActionParams:o}=yt("StepReplaced",a,s,n);r||t("StepReplaced",o)},stepPop(a={}){const{isPrevented:r,nextActionParams:o}=yt("StepPopped",a,s,n);r||t("StepPopped",o)},pause(a={}){const{isPrevented:r,nextActionParams:o}=yt("Paused",a,s,n);r||t("Paused",o)},resume(a={}){const{isPrevented:r,nextActionParams:o}=yt("Resumed",a,s,n);r||t("Resumed",o)}}}function Th(t,s,n){t.forEach(a=>{s.forEach(r=>{var o,d,i,l,u,m,f,h,g;switch(a._TAG){case"PUSHED":(o=r.onPushed)==null||o.call(r,{actions:n,effect:a});break;case"REPLACED":(d=r.onReplaced)==null||d.call(r,{actions:n,effect:a});break;case"POPPED":(i=r.onPopped)==null||i.call(r,{actions:n,effect:a});break;case"STEP_PUSHED":(l=r.onStepPushed)==null||l.call(r,{actions:n,effect:a});break;case"STEP_REPLACED":(u=r.onStepReplaced)==null||u.call(r,{actions:n,effect:a});break;case"STEP_POPPED":(m=r.onStepPopped)==null||m.call(r,{actions:n,effect:a});break;case"PAUSED":(f=r.onPaused)==null||f.call(r,{actions:n,effect:a});break;case"RESUMED":(h=r.onResumed)==null||h.call(r,{actions:n,effect:a});break;case"%SOMETHING_CHANGED%":(g=r.onChanged)==null||g.call(r,{actions:n,effect:a});break}})})}var Ph=1e3,Eh=Ph/60;function bi(t){var s,n,a,r;const o=[],i=[{key:"@stackflow/core",onChanged(){o.forEach(x=>x())}},...t.plugins.map(x=>x())],[l,u]=yh(t.initialEvents,x=>x.name==="Pushed"||x.name==="StepPushed"),m=i.reduce((x,v)=>{var j,N,y;return(y=(N=v.overrideInitialEvents)==null?void 0:N.call(v,{initialEvents:x,initialContext:(j=t.initialContext)!=null?j:{}}))!=null?y:x},l);m.length>0&&l.length>0&&m!==l&&((n=(s=t.handlers)==null?void 0:s.onInitialActivityIgnored)==null||n.call(s,m)),m.length===0&&((r=(a=t.handlers)==null?void 0:a.onInitialActivityNotFound)==null||r.call(a));const h={value:[...u,...m]},g={value:ua(h.value,new Date().getTime())},b={getStack(){return g.value},dispatchEvent(x,v){const j=Sn(x,v),N=ua([...h.value,j],new Date().getTime());h.value.push(j),p(N);const y=setInterval(()=>{const S=ua(h.value,new Date().getTime());Ms(g.value,S)||p(S),S.globalTransitionState==="idle"&&clearInterval(y)},Eh)},push:()=>{},replace:()=>{},pop:()=>{},stepPush:()=>{},stepReplace:()=>{},stepPop:()=>{},pause:()=>{},resume:()=>{}},p=x=>{const v=Sh(g.value,x);g.value=x,Th(v,i,b)};return Object.assign(b,Ih({dispatchEvent:b.dispatchEvent,pluginInstances:i,actions:b})),{actions:b,init:bh(()=>{i.forEach(x=>{var v;(v=x.onInit)==null||v.call(x,{actions:b})})}),pullEvents:()=>h.value,subscribe(x){return o.push(x),function(){const j=o.findIndex(N=>N===x);j>-1&&o.splice(j,1)}},pluginInstances:i}}var Mc=c.createContext(null);function _h(){const t=c.useContext(Mc);if(t===null)throw new Error("useActivityComponentMap must be used within ActivityComponentMapProvider");return t}function Mh({children:t,value:s}){return e.jsx(Mc.Provider,{value:s,children:t})}var Mn=t=>s=>s.find(({id:n})=>n===t);function Rh(t){return!t.exitedBy}function Lh(t,s){return s.enteredBy.eventDate-t.enteredBy.eventDate}function Rn(t){return t.filter(Rh).sort(Lh)[0]}function Ut(){return it()}function Ln(){return it()}var ji,Dh=(ji=Za.useDeferredValue)!=null?ji:t=>t,Ni,zh=(Ni=Za.useSyncExternalStore)!=null?Ni:(t,s)=>{const[n,a]=c.useState(()=>s());return c.useEffect(()=>t(()=>{a(()=>s())})),n},wi,Rc=(wi=Za.useTransition)!=null?wi:()=>[!1,t=>t()],Lc=c.createContext(null),Dc=c.createContext(null),zc=({coreStore:t,children:s})=>{const n=zh(t.subscribe,t.actions.getStack,t.actions.getStack),a=Dh(n);return e.jsx(Dc.Provider,{value:a,children:e.jsx(Lc.Provider,{value:t.actions,children:s})})};zc.displayName="CoreProvider";var Oc=()=>c.useContext(Lc),Bc=()=>c.useContext(Dc),Fc=c.createContext(null),Wc=({children:t,value:s})=>e.jsx(Fc.Provider,{value:s,children:t});Wc.displayName="PluginsProvider";function $c(){return c.useContext(Fc)}function Oh(t){return typeof t=="object"&&t!==null&&"then"in t&&typeof t.then=="function"}var Ce={PENDING:"pending",FULFILLED:"fulfilled",REJECTED:"rejected"};function jr(t){if(t.status===Ce.PENDING)return{status:Ce.PENDING};if(t.status===Ce.FULFILLED&&"value"in t)return{status:Ce.FULFILLED,value:t.value};if(t.status===Ce.REJECTED&&"reason"in t)return{status:Ce.REJECTED,reason:t.reason};throw new Error("Invalid promise state")}function Bh(t){if("status"in t&&Object.values(Ce).some(n=>n===t.status))return t;const s=Object.assign(t,{status:Ce.PENDING});return s.then(n=>{s.status=Ce.FULFILLED,s.value=n},n=>{s.status=Ce.REJECTED,s.reason=n}),s}function An(t){return Oh(t)?Bh(t instanceof Promise?t:Promise.resolve(t)):Object.assign(Promise.resolve(t),{status:Ce.FULFILLED,value:t})}function Fh(t){return Object.assign(Promise.reject(t),{status:Ce.REJECTED,reason:t})}function Wh(t){const s=An(t),n=jr(s);if(n.status===Ce.FULFILLED)return n.value;throw n.status===Ce.REJECTED?n.reason:s}var $h=Object.defineProperty,ki=Object.getOwnPropertySymbols,qh=Object.prototype.hasOwnProperty,Hh=Object.prototype.propertyIsEnumerable,Ci=(t,s,n)=>s in t?$h(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Uh=(t,s)=>{for(var n in s||(s={}))qh.call(s,n)&&Ci(t,n,s[n]);if(ki)for(var n of ki(s))Hh.call(s,n)&&Ci(t,n,s[n]);return t},Vh=(t,s,n)=>new Promise((a,r)=>{var o=l=>{try{i(n.next(l))}catch(u){r(u)}},d=l=>{try{i(n.throw(l))}catch(u){r(u)}},i=l=>l.done?a(l.value):Promise.resolve(l.value).then(o,d);i((n=n.apply(t,s)).next())});function Jh(t){let s=null;const n=()=>((!s||jr(s).status===Ce.REJECTED)&&(s=t()),s);return{Component:r=>{const{default:o}=Wh(n());return e.jsx(o,Uh({},r))},preload:()=>Vh(this,null,function*(){yield n()})}}var Kh=Symbol("STRUCTURED_ACTIVITY_COMPONENT_TYPE");function Gh(t){return t!==null&&typeof t=="object"&&Kh in t}var ma=new WeakMap;function Qh(t){if(ma.has(t))return ma.get(t);const{Component:s}=Jh(()=>{const n=t.content,a=An(typeof n=="function"?n():{default:n}),r=jr(a);return r.status===Ce.FULFILLED?An({default:r.value.default.component}):r.status===Ce.REJECTED?Fh(r.reason):An(a.then(o=>({default:o.default.component})))});return ma.set(t,s),s}var Xh=Object.defineProperty,Yh=Object.defineProperties,Zh=Object.getOwnPropertyDescriptors,Si=Object.getOwnPropertySymbols,ex=Object.prototype.hasOwnProperty,tx=Object.prototype.propertyIsEnumerable,Ra=(t,s,n)=>s in t?Xh(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Ft=(t,s)=>{for(var n in s||(s={}))ex.call(s,n)&&Ra(t,n,s[n]);if(Si)for(var n of Si(s))tx.call(s,n)&&Ra(t,n,s[n]);return t},fa=(t,s)=>Yh(t,Zh(s)),Ai=(t,s,n)=>Ra(t,typeof s!="symbol"?s+"":s,n),qc=({plugin:t,initialContext:s})=>{const n=_h(),a=Bc(),r=$c();return t.render({stack:fa(Ft({},a),{render(o){return{activities:Ft(Ft({},a),o).activities.map(i=>fa(Ft({},i),{key:i.id,render(l){const u=n[i.name];let m=Gh(u)?nx(u,i.params):e.jsx(u,{params:i.params});return r.forEach(f=>{var h,g;m=(g=(h=f.wrapActivity)==null?void 0:h.call(f,{activity:fa(Ft({},i),{render:()=>m}),initialContext:s}))!=null?g:m}),e.jsx(Cc,{value:Ft(Ft({},i),l),children:m},i.id)}}))}}}),initialContext:s})};qc.displayName="PluginRenderer";var sx=qc;function nx(t,s){const{layout:n,loading:a,errorHandler:r}=t,o=Qh(t);return[i=>a?.component?e.jsx(c.Suspense,{fallback:e.jsx(a.component,{params:s}),children:i}):i,i=>{var l;if(!r)return i;const u=(l=r.boundary)!=null?l:ax;return e.jsx(u,{renderFallback:(m,f)=>e.jsx(r.component,{params:s,error:m,reset:f}),children:i})},i=>n?.component?e.jsx(n.component,{params:s,children:i}):i].reduce((i,l)=>l(i),e.jsx(o,{params:s}))}var ax=class extends c.Component{constructor(){super(...arguments),Ai(this,"state",{hasError:!1,error:null}),Ai(this,"reset",()=>this.setState({hasError:!1,error:null}))}render(){return this.state.hasError?this.props.renderFallback(this.state.error,this.reset):this.props.children}static getDerivedStateFromError(t){return{hasError:!0,error:t}}},rx=Object.defineProperty,ix=Object.defineProperties,ox=Object.getOwnPropertyDescriptors,Ii=Object.getOwnPropertySymbols,cx=Object.prototype.hasOwnProperty,lx=Object.prototype.propertyIsEnumerable,Ti=(t,s,n)=>s in t?rx(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,dx=(t,s)=>{for(var n in s||(s={}))cx.call(s,n)&&Ti(t,n,s[n]);if(Ii)for(var n of Ii(s))lx.call(s,n)&&Ti(t,n,s[n]);return t},ux=(t,s)=>ix(t,ox(s)),Hc=({initialContext:t})=>{const s=Bc(),n=$c(),a=n.filter(o=>!!o.render);c.useEffect(()=>{a.length===0&&console.warn(`Stackflow - There is no rendering plugin, so "<Stack />" doesn't render anything. If you want to render some UI, use "@stackflow/plugin-renderer-basic" or add another rendering plugin.`)},[a]);let r=e.jsx(e.Fragment,{children:a.map(o=>e.jsx(sx,{plugin:o,initialContext:t},o.key))});return n.forEach(o=>{var d,i;r=(i=(d=o.wrapStack)==null?void 0:d.call(o,{stack:ux(dx({},s),{render(){return r}}),initialContext:t}))!=null?i:r}),e.jsx(Ac,{value:s,children:r})};Hc.displayName="MainRenderer";var mx=Hc,fx=Object.defineProperty,Pi=Object.getOwnPropertySymbols,px=Object.prototype.hasOwnProperty,hx=Object.prototype.propertyIsEnumerable,Ei=(t,s,n)=>s in t?fx(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,_i=(t,s)=>{for(var n in s||(s={}))px.call(s,n)&&Ei(t,n,s[n]);if(Pi)for(var n of Pi(s))hx.call(s,n)&&Ei(t,n,s[n]);return t};function pa(t){return t?t.animate==null?{skipActiveState:!1}:{skipActiveState:!t.animate}:{skipActiveState:!1}}function on(){const t=Oc(),[s]=Rc();return c.useMemo(()=>({pending:s,push(n,a,r){const o=Ut();return t?.push({activityId:o,activityName:n,activityParams:a,skipEnterActiveState:pa(r).skipActiveState}),{activityId:o}},replace(n,a,r){var o;const d=Ut();return t?.replace({activityId:(o=r?.activityId)!=null?o:Ut(),activityName:n,activityParams:a,skipEnterActiveState:pa(r).skipActiveState}),{activityId:d}},pop(n,a){let r=1,o={};typeof n=="object"&&(o=_i({},n)),typeof n=="number"&&(r=n),a&&(o=_i({},a));for(let d=0;d<r;d+=1)t?.pop({skipExitActiveState:d===0?pa(o).skipActiveState:!0})}}),[t?.push,t?.replace,t?.pop,s])}var xx=()=>{const t=Oc(),[s]=Rc();return c.useMemo(()=>({pending:s,stepPush(n,a){const r=t?.getStack().activities,o=a?.targetActivityId?Mn(a.targetActivityId):Rn,d=r&&o(r);if(!d)throw new Error("The target activity is not found.");const i=typeof n=="function"?n(d.params):n,l=Ln();t?.stepPush({stepId:l,stepParams:i,targetActivityId:a?.targetActivityId})},stepReplace(n,a){const r=t?.getStack().activities,o=a?.targetActivityId?Mn(a.targetActivityId):Rn,d=r&&o(r);if(!d)throw new Error("The target activity is not found.");const i=typeof n=="function"?n(d.params):n,l=Ln();t?.stepReplace({stepId:l,stepParams:i,targetActivityId:a?.targetActivityId})},stepPop(n){t?.stepPop({targetActivityId:n?.targetActivityId})}}),[t?.stepPush,t?.stepReplace,t?.stepPop,t?.getStack,s])},gx=Object.defineProperty,vx=Object.defineProperties,yx=Object.getOwnPropertyDescriptors,Mi=Object.getOwnPropertySymbols,bx=Object.prototype.hasOwnProperty,jx=Object.prototype.propertyIsEnumerable,Ri=(t,s,n)=>s in t?gx(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,hn=(t,s)=>{for(var n in s||(s={}))bx.call(s,n)&&Ri(t,n,s[n]);if(Mi)for(var n of Mi(s))jx.call(s,n)&&Ri(t,n,s[n]);return t},Nx=(t,s)=>vx(t,yx(s));function ha(t){return t?t.animate==null?{skipActiveState:!1}:{skipActiveState:!t.animate}:{skipActiveState:!1}}function wx(t){var s;const n=((s=t.plugins)!=null?s:[]).flat(Number.POSITIVE_INFINITY).map(u=>u),a=Object.entries(t.activities).reduce((u,[m,f])=>Nx(hn({},u),{[m]:"component"in f?f.component:f}),{}),r=()=>new Date().getTime()-t.transitionDuration*2,o=bi({initialEvents:[Sn("Initialized",{transitionDuration:t.transitionDuration,eventDate:r()}),...Object.entries(t.activities).map(([u,m])=>Sn("ActivityRegistered",hn({activityName:u,eventDate:r()},"component"in m?{activityParamsSchema:m.paramsSchema}:null)))],plugins:[]}),[d,i]=ch(),l=c.memo(u=>{const m=c.useMemo(()=>{const f=d();if(pn()&&f)return f;const h=t.initialActivity?[Sn("Pushed",{activityId:Ut(),activityName:t.initialActivity(),activityParams:{},eventDate:r(),skipEnterActiveState:!1})]:[],g=bi({initialEvents:[...o.pullEvents(),...h],initialContext:u.initialContext,plugins:n,handlers:{onInitialActivityIgnored:b=>{pn()&&console.warn(`Stackflow - Some plugin overrides an "initialActivity" option. The "initialActivity" option you set to "${b[0].activityName}" in the "stackflow" is ignored.`)},onInitialActivityNotFound:()=>{pn()&&console.warn("Stackflow - There is no initial activity. If you want to set the initial activity, add the `initialActivity` option of the `stackflow()` function or add a plugin that sets the initial activity. (e.g. `@stackflow/plugin-history-sync`)")}}});return pn()&&(g.init(),i(g)),g},[]);return e.jsx(Wc,{value:m.pluginInstances,children:e.jsx(zc,{coreStore:m,children:e.jsx(Mh,{value:a,children:e.jsx(mx,{initialContext:u.initialContext})})})})});return l.displayName="Stack",{activities:t.activities,Stack:l,useFlow:on,useStepFlow:xx,addActivity(u){if(d()){console.warn("Stackflow - `addActivity()` API cannot be called after a `<Stack />` component has been rendered");return}a[u.name]=c.memo(u.component),o.actions.dispatchEvent("ActivityRegistered",{activityName:u.name,activityParamsSchema:u.paramsSchema,eventDate:r()})},addPlugin(u){if(d()){console.warn("Stackflow - `addPlugin()` API cannot be called after a `<Stack />` component has been rendered");return}[u].flat(Number.POSITIVE_INFINITY).map(m=>m).forEach(m=>{n.push(m)})},actions:{getStack(){var u,m;return(m=(u=d())==null?void 0:u.actions.getStack())!=null?m:o.actions.getStack()},dispatchEvent(u,m){var f;return(f=d())==null?void 0:f.actions.dispatchEvent(u,m)},push(u,m,f){var h;const g=Ut();return(h=d())==null||h.actions.push({activityId:g,activityName:u,activityParams:m,skipEnterActiveState:ha(f).skipActiveState}),{activityId:g}},replace(u,m,f){var h,g,b;const p=(h=f?.activityId)!=null?h:Ut();return(b=d())==null||b.actions.replace({activityId:(g=f?.activityId)!=null?g:Ut(),activityName:u,activityParams:m,skipEnterActiveState:ha(f).skipActiveState}),{activityId:p}},pop(u,m){var f;let h=1,g={};typeof u=="object"&&(g=hn({},u)),typeof u=="number"&&(h=u),m&&(g=hn({},m));for(let b=0;b<h;b+=1)(f=d())==null||f.actions.pop({skipExitActiveState:b===0?ha(g).skipActiveState:!0})},stepPush(u,m){var f,h;const g=(f=d())==null?void 0:f.actions.getStack().activities,b=m?.targetActivityId?Mn(m.targetActivityId):Rn,p=g&&b(g);if(!p)throw new Error("The target activity is not found.");const x=typeof u=="function"?u(p.params):u,v=Ln();return(h=d())==null?void 0:h.actions.stepPush({stepId:v,stepParams:x,targetActivityId:m?.targetActivityId})},stepReplace(u,m){var f,h;const g=(f=d())==null?void 0:f.actions.getStack().activities,b=m?.targetActivityId?Mn(m.targetActivityId):Rn,p=g&&b(g);if(!p)throw new Error("The target activity is not found.");const x=typeof u=="function"?u(p.params):u,v=Ln();return(h=d())==null?void 0:h.actions.stepReplace({stepId:v,stepParams:x,targetActivityId:m?.targetActivityId})},stepPop(u){var m;return(m=d())==null?void 0:m.actions.stepPop({targetActivityId:u?.targetActivityId})}}}}function kx(){return()=>({key:"plugin-renderer-basic",render({stack:t}){return e.jsx(e.Fragment,{children:t.render().activities.filter(s=>s.transitionState!=="exit-done").map(s=>e.jsx(c.Fragment,{children:s.render()},s.key))})}})}function Cx(t){var s=t.match(/^var\((.*)\)$/);return s?s[1]:t}function cn(t,s){var n={};{var a=t;for(var r in a){var o=a[r];o!=null&&(n[Cx(r)]=o)}}return Object.defineProperty(n,"toString",{value:function(){return Object.keys(this).map(i=>"".concat(i,":").concat(this[i])).join(";")},writable:!1}),n}function Sx(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function Ax(t){var s=Sx(t,"string");return typeof s=="symbol"?s:String(s)}function Ix(t,s,n){return s=Ax(s),s in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function Li(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,a)}return n}function Di(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?Li(Object(n),!0).forEach(function(a){Ix(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Li(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function zi(t,s){var n={};for(var a in t)n[a]=s(t[a],a);return n}var Tx=(t,s,n)=>{for(var a of Object.keys(t)){var r;if(t[a]!==((r=s[a])!==null&&r!==void 0?r:n[a]))return!1}return!0},Dt=t=>{var s=n=>{var a=t.defaultClassName,r=Di(Di({},t.defaultVariants),n);for(var o in r){var d,i=(d=r[o])!==null&&d!==void 0?d:t.defaultVariants[o];if(i!=null){var l=i;typeof l=="boolean"&&(l=l===!0?"true":"false");var u=t.variantClassNames[o][l];u&&(a+=" "+u)}}for(var[m,f]of t.compoundVariants)Tx(m,r,t.defaultVariants)&&(a+=" "+f);return a};return s.variants=()=>Object.keys(t.variantClassNames),s.classNames={get base(){return t.defaultClassName.split(" ")[0]},get variants(){return zi(t.variantClassNames,n=>zi(n,a=>a.split(" ")[0]))}},s},Px=Object.defineProperty,Oi=Object.getOwnPropertySymbols,Ex=Object.prototype.hasOwnProperty,_x=Object.prototype.propertyIsEnumerable,Bi=(t,s,n)=>s in t?Px(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Mx=(t,s)=>{for(var n in s||(s={}))Ex.call(s,n)&&Bi(t,n,s[n]);if(Oi)for(var n of Oi(s))_x.call(s,n)&&Bi(t,n,s[n]);return t};function Nr(){const[t,s]=c.useReducer(()=>!0,!1);return c.useEffect(()=>{s()},[]),t}function is(){return uh()}function Uc(){const t=is(),s=Nr();return Mx({},s?{"data-stackflow-activity-id":t?.id,"data-stackflow-activity-is-active":t?.isActive,"data-stackflow-activity-transition-state":t?.transitionState}:null)}function Vc(t,s,n){const a=()=>{s.forEach(r=>{t.removeEventListener(r,a)}),n()};s.forEach(r=>{t.addEventListener(r,a)})}var Rx=t=>(t(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}),st=()=>{};function La(t){requestAnimationFrame(()=>{requestAnimationFrame(()=>{t()})})}function Lx({outerRef:t,innerRef:s,enable:n}){const[a,r]=c.useState(void 0);return c.useEffect(()=>{const o=t&&"current"in t&&t.current,d=s.current;return!n||!o||!d?st:Rx(()=>{const l=o.clientWidth,u=d.offsetLeft,m=d.clientWidth,f=l-u-m,h=Math.max(u,f);r(l-2*h)})}),{maxWidth:a}}function wr(t){const[s,n]=c.useState(void 0);return c.useEffect(()=>{La(()=>{n(t)})},[t]),s}function Dx(){return fh()}function kr({ref:t}){const s=Dx();c.useEffect(()=>{if(!s)return;const n=t.current;if(!n||s.globalTransitionState==="idle")return;const a=r=>{r.preventDefault(),r.stopPropagation()};return n.addEventListener("touchstart",a,{capture:!0}),n.addEventListener("touchmove",a,{capture:!0}),n.addEventListener("touchend",a,{capture:!0}),n.addEventListener("touchcancel",a,{capture:!0}),()=>{n.removeEventListener("touchstart",a,{capture:!0}),n.removeEventListener("touchmove",a,{capture:!0}),n.removeEventListener("touchend",a,{capture:!0}),n.removeEventListener("touchcancel",a,{capture:!0})}},[s?.globalTransitionState])}var Is={};function lt({styleName:t,refs:s,effect:n,effectDeps:a}){const r=is();c.useEffect(()=>r?(Is[t]||(Is[t]=new Map),Is[t].set(r.zIndex,{refs:s,hasEffect:!!n}),()=>{Is[t].delete(r.zIndex)}):st,[r?.id,s,n]),c.useEffect(()=>{if(!r||!n)return st;const o=(()=>{let i=[];for(let l=1;l<=r.zIndex;l+=1){const u=Is[t].get(r.zIndex-l);if(u?.refs&&(i=[...i,...u.refs]),u?.hasEffect)break}return i})(),d=n({activityTransitionState:r.transitionState,refs:o});return()=>{d?.()}},[r?.transitionState,...a??[]])}function zx({refs:t}){lt({styleName:"hide",refs:t,effect:({activityTransitionState:s,refs:n})=>{const a=()=>{n.forEach(r=>{if(!r.current)return;const o=r.current;o.style.display=""})};return s==="enter-done"?(n.forEach(r=>{if(!r.current)return;const o=r.current;o.style.display="none"}),()=>{a()}):(a(),st)}})}function Ox({refs:t,transitionDuration:s,offsetStyles:n,hasEffect:a=!1}){lt({styleName:"offset",refs:t,effect:a?({activityTransitionState:r,refs:o})=>{const d=()=>{La(()=>{o.forEach(i=>{if(!i.current)return;const l=i.current;l.style.transform="",l.style.opacity="",Vc(l,["transitionend","transitioncancel"],()=>{l.style.transition=""})})})};switch(r){case"enter-active":case"enter-done":return o.forEach(i=>{i.current&&(i.current.style.transition=s,i.current.style.transform=n.transform,i.current.style.opacity=n.opacity)}),r==="enter-done"?()=>{d()}:st;case"exit-active":case"exit-done":return La(()=>{d()}),st;default:return st}}:void 0})}var xn="--stackflow-swipe-back-ratio";function Bx({dimRef:t,edgeRef:s,paperRef:n,appBarRef:a,offset:r,transitionDuration:o,preventSwipeBack:d,moveAppBarTogether:i,getActivityTransitionState:l,onSwipeStart:u,onSwipeMove:m,onSwipeEnd:f,onTransitionEnd:h}){lt({styleName:"swipe-back",refs:i&&a?[n,a]:[n],effect:({refs:g})=>{if(d||!t.current||!s.current||!n.current)return st;const b=t.current,p=s.current,x=n.current,v=a?.current;let j=null,N=null,y=null,S=[];const k=()=>{j=null,N=null,y=null,S=[]};let I=!1;function _({dx:w,ratio:P}){I||(I=!0,requestAnimationFrame(()=>{b.style.opacity=`${1-P}`,b.style.transition="0s",x.style.overflowY="hidden",x.style.transform=`translate3d(${w}px, 0, 0)`,x.style.transition="0s",i&&v&&(v.style.overflowY="hidden",v.style.transform=`translate3d(${w}px, 0, 0)`,v.style.transition="0s"),v?.style.setProperty(xn,String(P)),g.forEach(L=>{var z,R;L.current&&(L.current.style.transform=`translate3d(${-1*(1-P)*r}px, 0, 0)`,L.current.style.transition="0s",((z=L.current.parentElement)==null?void 0:z.style.display)==="none"&&(L.current.parentElement.style.display="block"),(R=L.current.parentElement)==null||R.style.setProperty(xn,String(P)))}),I=!1}))}function A({swiped:w}){return new Promise(P=>{requestAnimationFrame(()=>{b.style.opacity=`${w?0:1}`,b.style.transition=o,x.style.overflowY="hidden",x.style.transform=`translateX(${w?"100%":"0"})`,x.style.transition=o,i&&v&&(v.style.overflowY="hidden",v.style.transform=`translateX(${w?"100%":"0"})`,v.style.transition=o),g.forEach(z=>{z.current&&(z.current.style.transition=o,z.current.style.transform=`translate3d(${w?"0":`-${r/16}rem`}, 0, 0)`)});const L=[...S];P(),Vc(x,["transitionend","transitioncancel"],()=>{const z=w||l()==="exit-active"||l()==="exit-done";b.style.opacity="",x.style.overflowY="",x.style.transform="",i&&v&&(v.style.overflowY="",v.style.transform="",v.style.removeProperty("transition")),v?.style.removeProperty(xn),g.forEach((R,q)=>{var M;if(!R.current)return;const F=L[q];z?(R.current.style.transition="",R.current.style.transform="",R.current.parentElement&&(R.current.parentElement.style.display="")):F&&(R.current.style.transition=F.style.transition,R.current.style.transform=F.style.transform,R.current.parentElement&&F.parentElement&&(R.current.parentElement.style.display=F.parentElement.style.display)),(M=R.current.parentElement)==null||M.style.removeProperty(xn)}),h?.({swiped:w})})})})}const E=w=>{var P;const{activeElement:L}=document;(P=L?.blur)==null||P.call(L),j=y=w.touches[0].clientX,N=Date.now(),S=g.map(z=>z.current?{style:{transform:z.current.style.transform,transition:z.current.style.transition},parentElement:z.current.parentElement?{style:{display:z.current.parentElement.style.display}}:void 0}:{style:{transform:"",transition:""}}),u?.()},C=w=>{if(!j){k();return}y=w.touches[0].clientX;const P=y-j,L=P/x.clientWidth;_({dx:P,ratio:L}),m?.({dx:P,ratio:L})},T=()=>{if(!j||!N||!y){k();return}const w=Date.now(),L=(y-j)/(w-N)>1||y/x.clientWidth>.4;f?.({swiped:L}),Promise.resolve().then(()=>A({swiped:L})).then(()=>k())};return p.addEventListener("touchstart",E,{passive:!0}),p.addEventListener("touchmove",C,{passive:!0}),p.addEventListener("touchend",T,{passive:!0}),p.addEventListener("touchcancel",T,{passive:!0}),()=>{p.removeEventListener("touchstart",E),p.removeEventListener("touchmove",C),p.removeEventListener("touchend",T),p.removeEventListener("touchcancel",T)}},effectDeps:[d]})}function Js(){var t;const s=is();return((t=s?.zIndex)!=null?t:0)*5}var Fx=Object.defineProperty,Wx=Object.defineProperties,$x=Object.getOwnPropertyDescriptors,Fi=Object.getOwnPropertySymbols,qx=Object.prototype.hasOwnProperty,Hx=Object.prototype.propertyIsEnumerable,Wi=(t,s,n)=>s in t?Fx(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,qt=(t,s)=>{for(var n in s||(s={}))qx.call(s,n)&&Wi(t,n,s[n]);if(Fi)for(var n of Fi(s))Hx.call(s,n)&&Wi(t,n,s[n]);return t},Rs=(t,s)=>Wx(t,$x(s)),Ux=t=>e.jsx("svg",{className:t.className,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.7241 2.76052C17.105 3.16043 17.0896 3.79341 16.6897 4.17431L8.45 12.0222L16.6896 19.8689C17.0896 20.2498 17.105 20.8827 16.7242 21.2827C16.3433 21.6826 15.7103 21.6981 15.3104 21.3172L6.31037 12.7464C6.11218 12.5576 6.00001 12.2959 6 12.0222C5.99999 11.7486 6.11215 11.4868 6.31032 11.2981L15.3103 2.72608C15.7102 2.34518 16.3432 2.3606 16.7241 2.76052Z",fill:"currentColor"})}),$i=Ux,Vx=t=>e.jsx("svg",{className:t.className,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M20.7071 4.70711C21.0976 4.31658 21.0976 3.68342 20.7071 3.29289C20.3166 2.90237 19.6834 2.90237 19.2929 3.29289L12 10.5858L4.70711 3.29289C4.31658 2.90237 3.68342 2.90237 3.29289 3.29289C2.90237 3.68342 2.90237 4.31658 3.29289 4.70711L10.5858 12L3.29289 19.2929C2.90237 19.6834 2.90237 20.3166 3.29289 20.7071C3.68342 21.0976 4.31658 21.0976 4.70711 20.7071L12 13.4142L19.2929 20.7071C19.6834 21.0976 20.3166 21.0976 20.7071 20.7071C21.0976 20.3166 21.0976 19.6834 20.7071 19.2929L13.4142 12L20.7071 4.70711Z",fill:"currentColor"})}),qi=Vx,U={backgroundColor:"var(--stackflow-plugin-basic-ui-background-color)",backgroundImage:"var(--stackflow-plugin-basic-ui-background-image)",dimBackgroundColor:"var(--stackflow-plugin-basic-ui-dim-background-color)",dimHeight:"var(--stackflow-plugin-basic-ui-dim-height)",transitionDuration:"var(--stackflow-plugin-basic-ui-transition-duration)",computedTransitionDuration:"var(--stackflow-plugin-basic-ui-computed-transition-duration)",defaultTransitionOffSet:"var(--stackflow-plugin-basic-ui-default-transition-off-set)",appBar:{borderColor:"var(--stackflow-plugin-basic-ui-app-bar-border-color)",borderColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-border-color-transition-duration)",borderSize:"var(--stackflow-plugin-basic-ui-app-bar-border-size)",height:"var(--stackflow-plugin-basic-ui-app-bar-height)",heightTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-height-transition-duration)",minHeight:"var(--stackflow-plugin-basic-ui-app-bar-min-height)",iconColor:"var(--stackflow-plugin-basic-ui-app-bar-icon-color)",iconColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-icon-color-transition-duration)",textColor:"var(--stackflow-plugin-basic-ui-app-bar-text-color)",textColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-text-color-transition-duration)",backgroundColor:"var(--stackflow-plugin-basic-ui-app-bar-background-color)",backgroundColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-background-color-transition-duration)",backgroundImage:"var(--stackflow-plugin-basic-ui-app-bar-background-image)",backgroundImageTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-background-image-transition-duration)",overflow:"var(--stackflow-plugin-basic-ui-app-bar-overflow)",minSafeAreaInsetTop:"var(--stackflow-plugin-basic-ui-app-bar-min-safe-area-inset-top)",containerPadding:"var(--stackflow-plugin-basic-ui-app-bar-container-padding)",itemGap:"var(--stackflow-plugin-basic-ui-app-bar-item-gap)",fontSize:"var(--stackflow-plugin-basic-ui-app-bar-font-size)",lineHeight:"var(--stackflow-plugin-basic-ui-app-bar-line-height)",hitSlop:"var(--stackflow-plugin-basic-ui-app-bar-hit-slop)"},bottomSheet:{borderRadius:"var(--stackflow-plugin-basic-ui-bottom-sheet-border-radius)"},modal:{borderRadius:"var(--stackflow-plugin-basic-ui-modal-border-radius)",maxWidth:"var(--stackflow-plugin-basic-ui-modal-max-width)"},edge:{width:"var(--stackflow-plugin-basic-ui-edge-width)"}},Jx=Dt({defaultClassName:"_1q6dj2j2",variantClassNames:{theme:{android:"_1q6dj2j0",cupertino:"_1q6dj2j1"}},defaultVariants:{},compoundVariants:[]});function Kx(t){return t.filter(s=>s!=null)}function ln(t){return Object.entries(t).reduce((s,[n,a])=>(a!=null&&(s[n]=a),s),{})}var Jc=c.createContext({theme:"android"}),Gx=Jc.Provider;function Kc(){return c.useContext(Jc)}var Qx=t=>()=>({key:"basic-ui",wrapStack({stack:s,initialContext:n}){var a,r,o,d,i,l,u,m,f,h,g,b,p,x,v,j,N;const y=typeof t=="function"?t({initialContext:n}):t;return e.jsx(Gx,{value:Rs(qt({},y),{theme:(a=n?.theme)!=null?a:y.theme}),children:e.jsx("div",{className:Kx([Jx({theme:(r=n?.theme)!=null?r:y.theme}),y.rootClassName]).join(" "),style:cn(ln({[U.backgroundColor]:y.backgroundColor,[U.backgroundImage]:y.backgroundImage,[U.dimBackgroundColor]:y.dimBackgroundColor,[U.dimHeight]:y.dimHeight,[U.transitionDuration]:`${s.transitionDuration}ms`,[U.computedTransitionDuration]:s.globalTransitionState==="loading"?`${s.transitionDuration}ms`:"0ms",[U.defaultTransitionOffSet]:y.defaultTransitionOffSet,[U.appBar.borderColor]:(o=y.appBar)==null?void 0:o.borderColor,[U.appBar.borderSize]:(d=y.appBar)==null?void 0:d.borderSize,[U.appBar.height]:(i=y.appBar)==null?void 0:i.height,[U.appBar.minHeight]:(l=y.appBar)==null?void 0:l.minHeight,[U.appBar.iconColor]:(u=y.appBar)==null?void 0:u.iconColor,[U.appBar.textColor]:(m=y.appBar)==null?void 0:m.textColor,[U.appBar.minSafeAreaInsetTop]:(f=y.appBar)==null?void 0:f.minSafeAreaInsetTop,[U.bottomSheet.borderRadius]:(h=y.bottomSheet)==null?void 0:h.borderRadius,[U.modal.borderRadius]:(g=y.modal)==null?void 0:g.borderRadius,[U.appBar.containerPadding]:(b=y.appBar)==null?void 0:b.containerPadding,[U.appBar.fontSize]:(p=y.appBar)==null?void 0:p.fontSize,[U.appBar.lineHeight]:(x=y.appBar)==null?void 0:x.lineHeight,[U.appBar.hitSlop]:(v=y.appBar)==null?void 0:v.hitSlop,[U.appBar.itemGap]:(j=y.appBar)==null?void 0:j.itemGap,[U.edge.width]:(N=y.edge)==null?void 0:N.width})),children:s.render()})})}}),Xx=Dt({defaultClassName:"_1yk3a452 dhthxq4 dhthxq0 dhthxqh _1yk3a451",variantClassNames:{activityEnterStyle:{slideInLeft:"_1yk3a453"},enterStyle:{cover:"_1yk3a454"},border:{true:"_1yk3a455"},modalPresentationStyle:{fullScreen:"_1yk3a456"}},defaultVariants:{},compoundVariants:[[{activityEnterStyle:"slideInLeft",enterStyle:"cover"},"_1yk3a457"]]}),Hi="_1yk3a45b dhthxq9 dhthxq7 dhthxqb dhthxqf dhthxqi",Yx="dhthxq9 dhthxq7 dhthxq8 _1yk3a450",Zx="_1yk3a45e",eg="_1yk3a45f dhthxqi dhthxq4 dhthxq2 dhthxqf",tg="_1yk3a45g dhthxqc dhthxqd dhthxq0",sg="_1yk3a45b dhthxq9 dhthxq7 dhthxqb dhthxqf dhthxqi",ng="_1yk3a459 dhthxqa dhthxq7 _1yk3a451",ag="_1yk3a45a dhthxq9 dhthxq7 dhthxq1 _1yk3a450",rg="_1yk3a45h dhthxq9 dhthxq7 dhthxq1 dhthxq5 _1yk3a450",ig="_1yk3a458",og=Dt({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_1dlf434a","enter-done":"_1dlf434b","exit-active":"_1dlf434c","exit-done":"_1dlf434d"},hasAppBar:{true:"_1dlf434j"}},defaultVariants:{},compoundVariants:[]}),cg="_1dlf434k dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 _1dlf4347 _1dlf4349",lg=Dt({defaultClassName:"_1dlf434r dhthxq4 dhthxq2 dhthxq3 dhthxq1",variantClassNames:{hasAppBar:{true:"_1dlf434s"}},defaultVariants:{},compoundVariants:[]}),dg="_1dlf434a",ug="_1dlf434b",mg="_1dlf434c",fg="_1dlf434d",pg=Dt({defaultClassName:"_1dlf434l dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 _1dlf4348 _1dlf4349",variantClassNames:{hasAppBar:{true:"_1dlf434m dhthxqg"},modalPresentationStyle:{fullScreen:"_1dlf434n"},activityEnterStyle:{slideInLeft:"_1dlf434o"}},defaultVariants:{},compoundVariants:[]}),hg=Dt({defaultClassName:"_1dlf434p dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3",variantClassNames:{hasAppBar:{true:"_1dlf434q"}},defaultVariants:{},compoundVariants:[]}),fs={transitionDuration:"var(--_1dlf4340)",zIndexes:{dim:"var(--_1dlf4341)",paper:"var(--_1dlf4342)",edge:"var(--_1dlf4343)",appBar:"var(--_1dlf4344)"},appBar:{center:{mainWidth:"var(--_1dlf4346)"}}},Gc=c.forwardRef(({title:t,renderLeft:s,renderRight:n,backButton:a,closeButton:r,closeButtonLocation:o="left",border:d=!0,modalPresentationStyle:i,activityEnterStyle:l,iconColor:u,iconColorTransitionDuration:m,textColor:f,textColorTransitionDuration:h,borderColor:g,borderColorTransitionDuration:b,borderSize:p,height:x,heightTransitionDuration:v,overflow:j,backgroundColor:N,backgroundColorTransitionDuration:y,backgroundImage:S,backgroundImageTransitionDuration:k,onTopClick:I,enterStyle:_,className:A,minHeight:E,fontSize:C,lineHeight:T,hitSlop:w,containerPadding:P,itemGap:L},z)=>{var R,q;const M=on(),F=is(),K=Uc();Nr();const ee=Kc(),W=(R=ee.appBar)==null?void 0:R.closeButton,$=(q=ee.appBar)==null?void 0:q.backButton,ie=c.useRef(null),{maxWidth:ne}=Lx({outerRef:z,innerRef:ie,enable:ee.theme==="cupertino"}),ae=(ee.theme==="cupertino"&&i!=="fullScreen"||l==="slideInLeft")&&_!=="cover",se=G=>{a&&"onClick"in a&&a.onClick&&a.onClick(G),G.defaultPrevented||M.pop()},H=()=>{var G,re;return!F||F.isRoot?null:!a&&!$?e.jsx("button",{type:"button","aria-label":"Go Back",className:Hi,onClick:se,children:e.jsx($i,{})}):a&&"render"in a&&a.render?(G=a.render)==null?void 0:G.call(a):$&&"render"in $&&$.render?(re=$.render)==null?void 0:re.call($):e.jsx("button",{type:"button",className:Hi,"aria-label":a&&"ariaLabel"in a?a.ariaLabel:$&&"ariaLabel"in $?$.ariaLabel:void 0,onClick:se,children:a&&"renderIcon"in a&&a.renderIcon?a.renderIcon():$&&"renderIcon"in $&&$.renderIcon?$.renderIcon():i==="fullScreen"?e.jsx(qi,{}):e.jsx($i,{})})},X=G=>{var re;r&&"onClick"in r&&r.onClick&&r.onClick(G),!G.defaultPrevented&&W&&"onClick"in W&&((re=W.onClick)==null||re.call(W,G))},O=()=>{var G;const re=!F||F.isRoot,ge=ve=>ve&&"render"in ve&&ve.render||ve&&"renderIcon"in ve&&ve.renderIcon||ve&&"onClick"in ve&&ve.onClick;return!(ge(r)||ge((G=ee.appBar)==null?void 0:G.closeButton))||!re?null:r&&"render"in r&&r.render?r.render():W&&"render"in W&&W.render?W.render():e.jsx("button",{type:"button",className:sg,"aria-label":r&&"ariaLabel"in r?r.ariaLabel:W&&"ariaLabel"in W?W.ariaLabel:void 0,onClick:X,children:r&&"renderIcon"in r&&r.renderIcon?r.renderIcon():W&&"renderIcon"in W&&W.renderIcon?W.renderIcon():e.jsx(qi,{})})};return e.jsxs("div",Rs(qt({ref:z,className:Kn(Xx({border:d,modalPresentationStyle:i,activityEnterStyle:l,enterStyle:_}),A),style:cn(ln({[U.appBar.iconColor]:u,[U.appBar.iconColorTransitionDuration]:m,[U.appBar.textColor]:f,[U.appBar.textColorTransitionDuration]:h,[U.appBar.borderColor]:g,[U.appBar.borderColorTransitionDuration]:b,[U.appBar.borderSize]:p,[U.appBar.height]:x,[U.appBar.heightTransitionDuration]:v,[U.appBar.overflow]:j,[U.appBar.backgroundColor]:N??(ae?U.backgroundColor:"transparent"),[U.appBar.backgroundColorTransitionDuration]:y,[U.appBar.backgroundImage]:S??(ae?U.appBar.backgroundImage:"none"),[U.appBar.backgroundImageTransitionDuration]:k,[fs.appBar.center.mainWidth]:`${ne}px`,[U.appBar.minHeight]:E,[U.appBar.containerPadding]:P,[U.appBar.fontSize]:C,[U.appBar.hitSlop]:w,[U.appBar.lineHeight]:T,[U.appBar.itemGap]:L})),"data-part":"appBar"},K),{children:[e.jsx("div",{className:ig}),e.jsxs("div",{className:ng,children:[e.jsxs("div",{className:ag,children:[o==="left"&&O(),H(),s?.()]}),e.jsx("div",{ref:ie,className:Yx,children:e.jsxs("div",{className:Zx,children:[typeof t=="string"?e.jsx("div",{className:tg,children:t}):t,e.jsx("button",{className:eg,type:"button",onClick:I})]})}),e.jsxs("div",{className:rg,children:[n?.(),o==="right"&&O()]})]})]}))});Gc.displayName="AppBar";var xg=Gc,gg=32,Ui=80,vg=c.createContext(null),yg=({backgroundColor:t,backgroundImage:s,dimBackgroundColor:n,appBar:a,preventSwipeBack:r,CUPERTINO_ONLY_modalPresentationStyle:o,ANDROID_ONLY_activityEnterStyle:d,className:i,children:l})=>{var u;const m=Kc(),f=is(),h=Uc();Nr();const{pop:g}=on(),b=c.useRef(null),p=c.useRef(null),x=c.useRef(null),v=c.useRef(null),j=c.useRef(null),N=c.useRef(null),y=m.theme==="cupertino"?o:void 0,S=m.theme==="android"?d:void 0,k=r||y==="fullScreen",I=!!a,_=Js();let A,E,C,T;m.theme==="cupertino"?(A=_+(y==="fullScreen"?2:0),E=_+(I&&y!=="fullScreen"?a.enterStyle==="cover"?2:1:3),C=_+4,T=_+7):(A=_,E=_+(S==="slideInLeft"&&a?.enterStyle!=="cover"?0:2),C=_+4,T=_+(S==="slideInLeft"?6:4));const w=(u=f?.transitionState)!=null?u:"enter-done",P=wr(w);zx({refs:[b]}),Ox({refs:(m.theme==="cupertino"||S==="slideInLeft")&&a?.enterStyle!=="cover"?[x]:[x,j],offsetStyles:m.theme==="cupertino"?{transform:`translate3d(-${Ui/16}rem, 0, 0)`,opacity:"1"}:S==="slideInLeft"?{transform:"translate3d(-50%, 0, 0)",opacity:"0"}:{transform:`translate3d(0, -${gg/16}rem, 0)`,opacity:"1"},transitionDuration:U.computedTransitionDuration,hasEffect:y!=="fullScreen"}),Bx({dimRef:p,edgeRef:v,paperRef:x,appBarRef:j,offset:Ui,transitionDuration:U.transitionDuration,moveAppBarTogether:a?.enterStyle==="cover",preventSwipeBack:k||m.theme!=="cupertino",getActivityTransitionState(){const z=x.current,R=z?.parentElement;return R?R.classList.contains(dg)?"enter-active":R.classList.contains(ug)?"enter-done":R.classList.contains(mg)?"exit-active":R.classList.contains(fg)?"exit-done":null:null},onSwipeEnd({swiped:z}){z&&g()}});const L=z=>{var R,q;(R=a?.onTopClick)==null||R.call(a,z),z.defaultPrevented||(q=N.current)==null||q.scroll({top:0,behavior:"smooth"})};return kr({ref:b}),e.jsx(vg.Provider,{value:c.useMemo(()=>({scroll({top:z}){var R;(R=N?.current)==null||R.scroll({top:z,behavior:"smooth"})},zIndices:{dim:A,paper:E,edge:C,appBar:T}}),[N,A,E,C,T]),children:e.jsxs("div",Rs(qt({ref:b,className:Kn(og({hasAppBar:I,transitionState:w==="enter-done"||w==="exit-done"?w:P}),i),style:cn(ln({[U.backgroundColor]:t,[U.backgroundImage]:s,[U.dimBackgroundColor]:n,[U.appBar.height]:a?.height,[U.appBar.heightTransitionDuration]:a?.heightTransitionDuration,[fs.zIndexes.dim]:`${A}`,[fs.zIndexes.paper]:`${E}`,[fs.zIndexes.edge]:`${C}`,[fs.zIndexes.appBar]:`${T}`,[fs.transitionDuration]:w==="enter-active"||w==="exit-active"?U.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"AppScreen"},h),{children:[S!=="slideInLeft"&&e.jsx("div",qt({ref:p,className:cg,"data-part":"dim"},h)),a&&e.jsx(xg,Rs(qt({},a),{ref:j,modalPresentationStyle:y,activityEnterStyle:S,onTopClick:L})),e.jsx("div",Rs(qt({ref:x,className:pg({hasAppBar:I,modalPresentationStyle:y,activityEnterStyle:S}),"data-part":"paper"},h),{children:e.jsx("div",{ref:N,className:hg({hasAppBar:I}),children:l})}),f?.id),!f?.isRoot&&m.theme==="cupertino"&&!k&&e.jsx("div",qt({ref:v,className:lg({hasAppBar:I}),"data-part":"edge"},h))]}))})},le=yg,bg=Dt({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_1ht38h04","enter-done":"_1ht38h05","exit-active":"_1ht38h06","exit-done":"_1ht38h07"}},defaultVariants:{},compoundVariants:[]}),jg="_1ht38h0d dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc dhthxqa dhthxq7 _1ht38h03",Ng="_1ht38h0e dhthxqc _1ht38h03",xa={transitionDuration:"var(--_1ht38h00)",zIndexes:{dim:"var(--_1ht38h01)",paper:"var(--_1ht38h02)"}},Qc=({borderRadius:t="1rem",backgroundColor:s,backgroundImage:n,dimBackgroundColor:a,paperRef:r,onOutsideClick:o,children:d,className:i})=>{var l;const u=is(),{pop:m}=on(),f=c.useRef(null),h=c.useRef(null);lt({styleName:"hide",refs:[f]}),lt({styleName:"offset",refs:[h]}),lt({styleName:"swipe-back",refs:[h]});const g=c.useRef(!1),b=N=>{o?.(N),!N.defaultPrevented&&(g.current||(g.current=!0,m()))},p=N=>{N.stopPropagation()},x=Js()+3,v=Js()+4,j=(l=u?.transitionState)!=null?l:"enter-done";return kr({ref:f}),e.jsx("div",{className:Kn(bg({transitionState:wr(j)}),i),ref:f,style:cn(ln({[U.bottomSheet.borderRadius]:t,[U.backgroundColor]:s,[U.backgroundImage]:n,[U.dimBackgroundColor]:a,[xa.zIndexes.dim]:`${x}`,[xa.zIndexes.paper]:`${v}`,[xa.transitionDuration]:j==="enter-active"||j==="exit-active"?U.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"BottomSheet","data-stackflow-activity-id":u?.id,"data-stackflow-activity-is-active":u?.isActive,children:e.jsx("div",{className:jg,ref:h,onClick:b,children:e.jsx("div",{className:Ng,ref:r,onClick:p,children:d})})})};Qc.displayName="BottomSheet";var wg=Qc,kg=Dt({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_5ozg8c4","enter-done":"_5ozg8c5","exit-active":"_5ozg8c6","exit-done":"_5ozg8c7"}},defaultVariants:{},compoundVariants:[]}),Cg="_5ozg8cd dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc dhthxq9 dhthxq7 dhthxqb _5ozg8c3",Sg="_5ozg8ce dhthxqc _5ozg8c3",ga={transitionDuration:"var(--_5ozg8c0)",zIndexes:{dim:"var(--_5ozg8c1)",paper:"var(--_5ozg8c2)"}},Xc=({backgroundColor:t,backgroundImage:s,dimBackgroundColor:n,borderRadius:a="1rem",maxWidth:r,onOutsideClick:o,children:d,className:i})=>{var l;const u=is(),{pop:m}=on(),f=c.useRef(null),h=c.useRef(null);lt({styleName:"hide",refs:[f]}),lt({styleName:"offset",refs:[h]}),lt({styleName:"swipe-back",refs:[h]});const g=c.useRef(!1),b=N=>{o?.(N),!N.defaultPrevented&&(g.current||(g.current=!0,m()))},p=N=>{N.stopPropagation()},x=Js()+3,v=Js()+4,j=(l=u?.transitionState)!=null?l:"enter-done";return kr({ref:f}),e.jsx("div",{className:Kn(kg({transitionState:wr(j)}),i),ref:f,style:cn(ln({[U.backgroundColor]:t,[U.backgroundImage]:s,[U.dimBackgroundColor]:n,[U.modal.borderRadius]:a,[U.modal.maxWidth]:r,[ga.zIndexes.dim]:`${x}`,[ga.zIndexes.paper]:`${v}`,[ga.transitionDuration]:j==="enter-active"||j==="exit-active"?U.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"Modal","data-stackflow-activity-id":u?.id,"data-stackflow-activity-is-active":u?.isActive,children:e.jsx("div",{className:Cg,ref:h,onClick:b,children:e.jsx("div",{className:Sg,onClick:p,children:d})})})};Xc.displayName="Modal";var Ag=Xc,Ig=Object.defineProperty,Q=(t,s)=>Ig(t,"name",{value:s,configurable:!0}),gs=class{type=3;name="";prefix="";value="";suffix="";modifier=3;constructor(t,s,n,a,r,o){this.type=t,this.name=s,this.prefix=n,this.value=a,this.suffix=r,this.modifier=o}hasCustomName(){return this.name!==""&&typeof this.name!="number"}};Q(gs,"Part");var Tg=/[$_\p{ID_Start}]/u,Pg=/[$_\u200C\u200D\p{ID_Continue}]/u,Da=".*";function Yc(t,s){return(s?/^[\x00-\xFF]*$/:/^[\x00-\x7F]*$/).test(t)}Q(Yc,"isASCII");function Cr(t,s=!1){let n=[],a=0;for(;a<t.length;){let r=t[a],o=Q(function(d){if(!s)throw new TypeError(d);n.push({type:"INVALID_CHAR",index:a,value:t[a++]})},"ErrorOrInvalid");if(r==="*"){n.push({type:"ASTERISK",index:a,value:t[a++]});continue}if(r==="+"||r==="?"){n.push({type:"OTHER_MODIFIER",index:a,value:t[a++]});continue}if(r==="\\"){n.push({type:"ESCAPED_CHAR",index:a++,value:t[a++]});continue}if(r==="{"){n.push({type:"OPEN",index:a,value:t[a++]});continue}if(r==="}"){n.push({type:"CLOSE",index:a,value:t[a++]});continue}if(r===":"){let d="",i=a+1;for(;i<t.length;){let l=t.substr(i,1);if(i===a+1&&Tg.test(l)||i!==a+1&&Pg.test(l)){d+=t[i++];continue}break}if(!d){o(`Missing parameter name at ${a}`);continue}n.push({type:"NAME",index:a,value:d}),a=i;continue}if(r==="("){let d=1,i="",l=a+1,u=!1;if(t[l]==="?"){o(`Pattern cannot start with "?" at ${l}`);continue}for(;l<t.length;){if(!Yc(t[l],!1)){o(`Invalid character '${t[l]}' at ${l}.`),u=!0;break}if(t[l]==="\\"){i+=t[l++]+t[l++];continue}if(t[l]===")"){if(d--,d===0){l++;break}}else if(t[l]==="("&&(d++,t[l+1]!=="?")){o(`Capturing groups are not allowed at ${l}`),u=!0;break}i+=t[l++]}if(u)continue;if(d){o(`Unbalanced pattern at ${a}`);continue}if(!i){o(`Missing pattern at ${a}`);continue}n.push({type:"REGEX",index:a,value:i}),a=l;continue}n.push({type:"CHAR",index:a,value:t[a++]})}return n.push({type:"END",index:a,value:""}),n}Q(Cr,"lexer");function Sr(t,s={}){let n=Cr(t);s.delimiter??="/#?",s.prefixes??="./";let a=`[^${Me(s.delimiter)}]+?`,r=[],o=0,d=0,i=new Set,l=Q(j=>{if(d<n.length&&n[d].type===j)return n[d++].value},"tryConsume"),u=Q(()=>l("OTHER_MODIFIER")??l("ASTERISK"),"tryConsumeModifier"),m=Q(j=>{let N=l(j);if(N!==void 0)return N;let{type:y,index:S}=n[d];throw new TypeError(`Unexpected ${y} at ${S}, expected ${j}`)},"mustConsume"),f=Q(()=>{let j="",N;for(;N=l("CHAR")??l("ESCAPED_CHAR");)j+=N;return j},"consumeText"),h=Q(j=>j,"DefaultEncodePart"),g=s.encodePart||h,b="",p=Q(j=>{b+=j},"appendToPendingFixedValue"),x=Q(()=>{b.length&&(r.push(new gs(3,"","",g(b),"",3)),b="")},"maybeAddPartFromPendingFixedValue"),v=Q((j,N,y,S,k)=>{let I=3;switch(k){case"?":I=1;break;case"*":I=0;break;case"+":I=2;break}if(!N&&!y&&I===3){p(j);return}if(x(),!N&&!y){if(!j)return;r.push(new gs(3,"","",g(j),"",I));return}let _;y?y==="*"?_=Da:_=y:_=a;let A=2;_===a?(A=1,_=""):_===Da&&(A=0,_="");let E;if(N?E=N:y&&(E=o++),i.has(E))throw new TypeError(`Duplicate name '${E}'.`);i.add(E),r.push(new gs(A,E,g(j),_,g(S),I))},"addPart");for(;d<n.length;){let j=l("CHAR"),N=l("NAME"),y=l("REGEX");if(!N&&!y&&(y=l("ASTERISK")),N||y){let k=j??"";s.prefixes.indexOf(k)===-1&&(p(k),k=""),x();let I=u();v(k,N,y,"",I);continue}let S=j??l("ESCAPED_CHAR");if(S){p(S);continue}if(l("OPEN")){let k=f(),I=l("NAME"),_=l("REGEX");!I&&!_&&(_=l("ASTERISK"));let A=f();m("CLOSE");let E=u();v(k,I,_,A,E);continue}x(),m("END")}return r}Q(Sr,"parse");function Me(t){return t.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}Q(Me,"escapeString");function za(t){return t&&t.ignoreCase?"ui":"u"}Q(za,"flags");function Zc(t,s,n){return Ar(Sr(t,n),s,n)}Q(Zc,"stringToRegexp");function Vt(t){switch(t){case 0:return"*";case 1:return"?";case 2:return"+";case 3:return""}}Q(Vt,"modifierToString");function Ar(t,s,n={}){n.delimiter??="/#?",n.prefixes??="./",n.sensitive??=!1,n.strict??=!1,n.end??=!0,n.start??=!0,n.endsWith="";let a=n.start?"^":"";for(let i of t){if(i.type===3){i.modifier===3?a+=Me(i.value):a+=`(?:${Me(i.value)})${Vt(i.modifier)}`;continue}s&&s.push(i.name);let l=`[^${Me(n.delimiter)}]+?`,u=i.value;if(i.type===1?u=l:i.type===0&&(u=Da),!i.prefix.length&&!i.suffix.length){i.modifier===3||i.modifier===1?a+=`(${u})${Vt(i.modifier)}`:a+=`((?:${u})${Vt(i.modifier)})`;continue}if(i.modifier===3||i.modifier===1){a+=`(?:${Me(i.prefix)}(${u})${Me(i.suffix)})`,a+=Vt(i.modifier);continue}a+=`(?:${Me(i.prefix)}`,a+=`((?:${u})(?:`,a+=Me(i.suffix),a+=Me(i.prefix),a+=`(?:${u}))*)${Me(i.suffix)})`,i.modifier===0&&(a+="?")}let r=`[${Me(n.endsWith)}]|$`,o=`[${Me(n.delimiter)}]`;if(n.end)return n.strict||(a+=`${o}?`),n.endsWith.length?a+=`(?=${r})`:a+="$",new RegExp(a,za(n));n.strict||(a+=`(?:${o}(?=${r}))?`);let d=!1;if(t.length){let i=t[t.length-1];i.type===3&&i.modifier===3&&(d=n.delimiter.indexOf(i)>-1)}return d||(a+=`(?=${o}|${r})`),new RegExp(a,za(n))}Q(Ar,"partsToRegexp");var Nt={delimiter:"",prefixes:"",sensitive:!0,strict:!0},Eg={delimiter:".",prefixes:"",sensitive:!0,strict:!0},_g={delimiter:"/",prefixes:"/",sensitive:!0,strict:!0};function el(t,s){return t.length?t[0]==="/"?!0:!s||t.length<2?!1:(t[0]=="\\"||t[0]=="{")&&t[1]=="/":!1}Q(el,"isAbsolutePathname");function Ir(t,s){return t.startsWith(s)?t.substring(s.length,t.length):t}Q(Ir,"maybeStripPrefix");function tl(t,s){return t.endsWith(s)?t.substr(0,t.length-s.length):t}Q(tl,"maybeStripSuffix");function Tr(t){return!t||t.length<2?!1:t[0]==="["||(t[0]==="\\"||t[0]==="{")&&t[1]==="["}Q(Tr,"treatAsIPv6Hostname");var sl=["ftp","file","http","https","ws","wss"];function Pr(t){if(!t)return!0;for(let s of sl)if(t.test(s))return!0;return!1}Q(Pr,"isSpecialScheme");function nl(t,s){if(t=Ir(t,"#"),s||t==="")return t;let n=new URL("https://example.com");return n.hash=t,n.hash?n.hash.substring(1,n.hash.length):""}Q(nl,"canonicalizeHash");function al(t,s){if(t=Ir(t,"?"),s||t==="")return t;let n=new URL("https://example.com");return n.search=t,n.search?n.search.substring(1,n.search.length):""}Q(al,"canonicalizeSearch");function rl(t,s){return s||t===""?t:Tr(t)?Mr(t):_r(t)}Q(rl,"canonicalizeHostname");function il(t,s){if(s||t==="")return t;let n=new URL("https://example.com");return n.password=t,n.password}Q(il,"canonicalizePassword");function ol(t,s){if(s||t==="")return t;let n=new URL("https://example.com");return n.username=t,n.username}Q(ol,"canonicalizeUsername");function cl(t,s,n){if(n||t==="")return t;if(s&&!sl.includes(s))return new URL(`${s}:${t}`).pathname;let a=t[0]=="/";return t=new URL(a?t:"/-"+t,"https://example.com").pathname,a||(t=t.substring(2,t.length)),t}Q(cl,"canonicalizePathname");function ll(t,s,n){return Er(s)===t&&(t=""),n||t===""?t:Rr(t)}Q(ll,"canonicalizePort");function dl(t,s){return t=tl(t,":"),s||t===""?t:Zn(t)}Q(dl,"canonicalizeProtocol");function Er(t){switch(t){case"ws":case"http":return"80";case"wws":case"https":return"443";case"ftp":return"21";default:return""}}Q(Er,"defaultPortForProtocol");function Zn(t){if(t==="")return t;if(/^[-+.A-Za-z0-9]*$/.test(t))return t.toLowerCase();throw new TypeError(`Invalid protocol '${t}'.`)}Q(Zn,"protocolEncodeCallback");function ul(t){if(t==="")return t;let s=new URL("https://example.com");return s.username=t,s.username}Q(ul,"usernameEncodeCallback");function ml(t){if(t==="")return t;let s=new URL("https://example.com");return s.password=t,s.password}Q(ml,"passwordEncodeCallback");function _r(t){if(t==="")return t;if(/[\t\n\r #%/:<>?@[\]^\\|]/g.test(t))throw new TypeError(`Invalid hostname '${t}'`);let s=new URL("https://example.com");return s.hostname=t,s.hostname}Q(_r,"hostnameEncodeCallback");function Mr(t){if(t==="")return t;if(/[^0-9a-fA-F[\]:]/g.test(t))throw new TypeError(`Invalid IPv6 hostname '${t}'`);return t.toLowerCase()}Q(Mr,"ipv6HostnameEncodeCallback");function Rr(t){if(t===""||/^[0-9]*$/.test(t)&&parseInt(t)<=65535)return t;throw new TypeError(`Invalid port '${t}'.`)}Q(Rr,"portEncodeCallback");function fl(t){if(t==="")return t;let s=new URL("https://example.com");return s.pathname=t[0]!=="/"?"/-"+t:t,t[0]!=="/"?s.pathname.substring(2,s.pathname.length):s.pathname}Q(fl,"standardURLPathnameEncodeCallback");function pl(t){return t===""?t:new URL(`data:${t}`).pathname}Q(pl,"pathURLPathnameEncodeCallback");function hl(t){if(t==="")return t;let s=new URL("https://example.com");return s.search=t,s.search.substring(1,s.search.length)}Q(hl,"searchEncodeCallback");function xl(t){if(t==="")return t;let s=new URL("https://example.com");return s.hash=t,s.hash.substring(1,s.hash.length)}Q(xl,"hashEncodeCallback");var gl=class{#r;#n=[];#t={};#e=0;#a=1;#l=0;#o=0;#f=0;#p=0;#h=!1;constructor(t){this.#r=t}get result(){return this.#t}parse(){for(this.#n=Cr(this.#r,!0);this.#e<this.#n.length;this.#e+=this.#a){if(this.#a=1,this.#n[this.#e].type==="END"){if(this.#o===0){this.#y(),this.#d()?this.#s(9,1):this.#u()?this.#s(8,1):this.#s(7,0);continue}else if(this.#o===2){this.#m(5);continue}this.#s(10,0);break}if(this.#f>0)if(this.#S())this.#f-=1;else continue;if(this.#C()){this.#f+=1;continue}switch(this.#o){case 0:this.#b()&&this.#m(1);break;case 1:if(this.#b()){this.#T();let t=7,s=1;this.#N()?(t=2,s=3):this.#h&&(t=2),this.#s(t,s)}break;case 2:this.#g()?this.#m(3):(this.#v()||this.#u()||this.#d())&&this.#m(5);break;case 3:this.#w()?this.#s(4,1):this.#g()&&this.#s(5,1);break;case 4:this.#g()&&this.#s(5,1);break;case 5:this.#A()?this.#p+=1:this.#I()&&(this.#p-=1),this.#k()&&!this.#p?this.#s(6,1):this.#v()?this.#s(7,0):this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 6:this.#v()?this.#s(7,0):this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 7:this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 8:this.#d()&&this.#s(9,1);break}}this.#t.hostname!==void 0&&this.#t.port===void 0&&(this.#t.port="")}#s(t,s){switch(this.#o){case 0:break;case 1:this.#t.protocol=this.#c();break;case 2:break;case 3:this.#t.username=this.#c();break;case 4:this.#t.password=this.#c();break;case 5:this.#t.hostname=this.#c();break;case 6:this.#t.port=this.#c();break;case 7:this.#t.pathname=this.#c();break;case 8:this.#t.search=this.#c();break;case 9:this.#t.hash=this.#c();break}this.#o!==0&&t!==10&&([1,2,3,4].includes(this.#o)&&[6,7,8,9].includes(t)&&(this.#t.hostname??=""),[1,2,3,4,5,6].includes(this.#o)&&[8,9].includes(t)&&(this.#t.pathname??=this.#h?"/":""),[1,2,3,4,5,6,7].includes(this.#o)&&t===9&&(this.#t.search??="")),this.#j(t,s)}#j(t,s){this.#o=t,this.#l=this.#e+s,this.#e+=s,this.#a=0}#y(){this.#e=this.#l,this.#a=0}#m(t){this.#y(),this.#o=t}#x(t){return t<0&&(t=this.#n.length-t),t<this.#n.length?this.#n[t]:this.#n[this.#n.length-1]}#i(t,s){let n=this.#x(t);return n.value===s&&(n.type==="CHAR"||n.type==="ESCAPED_CHAR"||n.type==="INVALID_CHAR")}#b(){return this.#i(this.#e,":")}#N(){return this.#i(this.#e+1,"/")&&this.#i(this.#e+2,"/")}#g(){return this.#i(this.#e,"@")}#w(){return this.#i(this.#e,":")}#k(){return this.#i(this.#e,":")}#v(){return this.#i(this.#e,"/")}#u(){if(this.#i(this.#e,"?"))return!0;if(this.#n[this.#e].value!=="?")return!1;let t=this.#x(this.#e-1);return t.type!=="NAME"&&t.type!=="REGEX"&&t.type!=="CLOSE"&&t.type!=="ASTERISK"}#d(){return this.#i(this.#e,"#")}#C(){return this.#n[this.#e].type=="OPEN"}#S(){return this.#n[this.#e].type=="CLOSE"}#A(){return this.#i(this.#e,"[")}#I(){return this.#i(this.#e,"]")}#c(){let t=this.#n[this.#e],s=this.#x(this.#l).index;return this.#r.substring(s,t.index)}#T(){let t={};Object.assign(t,Nt),t.encodePart=Zn;let s=Zc(this.#c(),void 0,t);this.#h=Pr(s)}};Q(gl,"Parser");var va=["protocol","username","password","hostname","port","pathname","search","hash"],bt="*";function Oa(t,s){if(typeof t!="string")throw new TypeError("parameter 1 is not of type 'string'.");let n=new URL(t,s);return{protocol:n.protocol.substring(0,n.protocol.length-1),username:n.username,password:n.password,hostname:n.hostname,port:n.port,pathname:n.pathname,search:n.search!==""?n.search.substring(1,n.search.length):void 0,hash:n.hash!==""?n.hash.substring(1,n.hash.length):void 0}}Q(Oa,"extractValues");function Qe(t,s){return s?hs(t):t}Q(Qe,"processBaseURLString");function ps(t,s,n){let a;if(typeof s.baseURL=="string")try{a=new URL(s.baseURL),s.protocol===void 0&&(t.protocol=Qe(a.protocol.substring(0,a.protocol.length-1),n)),!n&&s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.username===void 0&&(t.username=Qe(a.username,n)),!n&&s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.username===void 0&&s.password===void 0&&(t.password=Qe(a.password,n)),s.protocol===void 0&&s.hostname===void 0&&(t.hostname=Qe(a.hostname,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&(t.port=Qe(a.port,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&(t.pathname=Qe(a.pathname,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&s.search===void 0&&(t.search=Qe(a.search.substring(1,a.search.length),n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&s.search===void 0&&s.hash===void 0&&(t.hash=Qe(a.hash.substring(1,a.hash.length),n))}catch{throw new TypeError(`invalid baseURL '${s.baseURL}'.`)}if(typeof s.protocol=="string"&&(t.protocol=dl(s.protocol,n)),typeof s.username=="string"&&(t.username=ol(s.username,n)),typeof s.password=="string"&&(t.password=il(s.password,n)),typeof s.hostname=="string"&&(t.hostname=rl(s.hostname,n)),typeof s.port=="string"&&(t.port=ll(s.port,t.protocol,n)),typeof s.pathname=="string"){if(t.pathname=s.pathname,a&&!el(t.pathname,n)){let r=a.pathname.lastIndexOf("/");r>=0&&(t.pathname=Qe(a.pathname.substring(0,r+1),n)+t.pathname)}t.pathname=cl(t.pathname,t.protocol,n)}return typeof s.search=="string"&&(t.search=al(s.search,n)),typeof s.hash=="string"&&(t.hash=nl(s.hash,n)),t}Q(ps,"applyInit");function hs(t){return t.replace(/([+*?:{}()\\])/g,"\\$1")}Q(hs,"escapePatternString");function vl(t){return t.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}Q(vl,"escapeRegexpString");function yl(t,s){s.delimiter??="/#?",s.prefixes??="./",s.sensitive??=!1,s.strict??=!1,s.end??=!0,s.start??=!0,s.endsWith="";let n=".*",a=`[^${vl(s.delimiter)}]+?`,r=/[$_\u200C\u200D\p{ID_Continue}]/u,o="";for(let d=0;d<t.length;++d){let i=t[d];if(i.type===3){if(i.modifier===3){o+=hs(i.value);continue}o+=`{${hs(i.value)}}${Vt(i.modifier)}`;continue}let l=i.hasCustomName(),u=!!i.suffix.length||!!i.prefix.length&&(i.prefix.length!==1||!s.prefixes.includes(i.prefix)),m=d>0?t[d-1]:null,f=d<t.length-1?t[d+1]:null;if(!u&&l&&i.type===1&&i.modifier===3&&f&&!f.prefix.length&&!f.suffix.length)if(f.type===3){let h=f.value.length>0?f.value[0]:"";u=r.test(h)}else u=!f.hasCustomName();if(!u&&!i.prefix.length&&m&&m.type===3){let h=m.value[m.value.length-1];u=s.prefixes.includes(h)}u&&(o+="{"),o+=hs(i.prefix),l&&(o+=`:${i.name}`),i.type===2?o+=`(${i.value})`:i.type===1?l||(o+=`(${a})`):i.type===0&&(!l&&(!m||m.type===3||m.modifier!==3||u||i.prefix!=="")?o+="*":o+=`(${n})`),i.type===1&&l&&i.suffix.length&&r.test(i.suffix[0])&&(o+="\\"),o+=hs(i.suffix),u&&(o+="}"),i.modifier!==3&&(o+=Vt(i.modifier))}return o}Q(yl,"partsToPattern");var bl=class{#r;#n={};#t={};#e={};#a={};#l=!1;constructor(t={},s,n){try{let a;if(typeof s=="string"?a=s:n=s,typeof t=="string"){let i=new gl(t);if(i.parse(),t=i.result,a===void 0&&typeof t.protocol!="string")throw new TypeError("A base URL must be provided for a relative constructor string.");t.baseURL=a}else{if(!t||typeof t!="object")throw new TypeError("parameter 1 is not of type 'string' and cannot convert to dictionary.");if(a)throw new TypeError("parameter 1 is not of type 'string'.")}typeof n>"u"&&(n={ignoreCase:!1});let r={ignoreCase:n.ignoreCase===!0},o={pathname:bt,protocol:bt,username:bt,password:bt,hostname:bt,port:bt,search:bt,hash:bt};this.#r=ps(o,t,!0),Er(this.#r.protocol)===this.#r.port&&(this.#r.port="");let d;for(d of va){if(!(d in this.#r))continue;let i={},l=this.#r[d];switch(this.#t[d]=[],d){case"protocol":Object.assign(i,Nt),i.encodePart=Zn;break;case"username":Object.assign(i,Nt),i.encodePart=ul;break;case"password":Object.assign(i,Nt),i.encodePart=ml;break;case"hostname":Object.assign(i,Eg),Tr(l)?i.encodePart=Mr:i.encodePart=_r;break;case"port":Object.assign(i,Nt),i.encodePart=Rr;break;case"pathname":Pr(this.#n.protocol)?(Object.assign(i,_g,r),i.encodePart=fl):(Object.assign(i,Nt,r),i.encodePart=pl);break;case"search":Object.assign(i,Nt,r),i.encodePart=hl;break;case"hash":Object.assign(i,Nt,r),i.encodePart=xl;break}try{this.#a[d]=Sr(l,i),this.#n[d]=Ar(this.#a[d],this.#t[d],i),this.#e[d]=yl(this.#a[d],i),this.#l=this.#l||this.#a[d].some(u=>u.type===2)}catch{throw new TypeError(`invalid ${d} pattern '${this.#r[d]}'.`)}}}catch(a){throw new TypeError(`Failed to construct 'URLPattern': ${a.message}`)}}get[Symbol.toStringTag](){return"URLPattern"}test(t={},s){let n={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof t!="string"&&s)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof t>"u")return!1;try{typeof t=="object"?n=ps(n,t,!1):n=ps(n,Oa(t,s),!1)}catch{return!1}let a;for(a of va)if(!this.#n[a].exec(n[a]))return!1;return!0}exec(t={},s){let n={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof t!="string"&&s)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof t>"u")return;try{typeof t=="object"?n=ps(n,t,!1):n=ps(n,Oa(t,s),!1)}catch{return null}let a={};s?a.inputs=[t,s]:a.inputs=[t];let r;for(r of va){let o=this.#n[r].exec(n[r]);if(!o)return null;let d={};for(let[i,l]of this.#t[r].entries())if(typeof l=="string"||typeof l=="number"){let u=o[i+1];d[l]=u}a[r]={input:n[r]??"",groups:d}}return a}static compareComponent(t,s,n){let a=Q((i,l)=>{for(let u of["type","modifier","prefix","value","suffix"]){if(i[u]<l[u])return-1;if(i[u]!==l[u])return 1}return 0},"comparePart"),r=new gs(3,"","","","",3),o=new gs(0,"","","","",3),d=Q((i,l)=>{let u=0;for(;u<Math.min(i.length,l.length);++u){let m=a(i[u],l[u]);if(m)return m}return i.length===l.length?0:a(i[u]??r,l[u]??r)},"comparePartList");return!s.#e[t]&&!n.#e[t]?0:s.#e[t]&&!n.#e[t]?d(s.#a[t],[o]):!s.#e[t]&&n.#e[t]?d([o],n.#a[t]):d(s.#a[t],n.#a[t])}get protocol(){return this.#e.protocol}get username(){return this.#e.username}get password(){return this.#e.password}get hostname(){return this.#e.hostname}get port(){return this.#e.port}get pathname(){return this.#e.pathname}get search(){return this.#e.search}get hash(){return this.#e.hash}get hasRegExpGroups(){return this.#l}};Q(bl,"URLPattern");globalThis.URLPattern||(globalThis.URLPattern=bl);const Mg=c.createContext({requestHistoryTick:()=>{}}),jl=({children:t,requestHistoryTick:s})=>{const n=c.useMemo(()=>({requestHistoryTick:s}),[s]);return e.jsx(Mg.Provider,{value:n,children:t})};jl.__docgenInfo={description:"",methods:[],displayName:"HistoryQueueProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},requestHistoryTick:{required:!0,tsType:{name:"signature",type:"function",raw:"(cb: (resolve: () => void) => void) => void",signature:{arguments:[{type:{name:"signature",type:"function",raw:"(resolve: () => void) => void",signature:{arguments:[{type:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},name:"resolve"}],return:{name:"void"}}},name:"cb"}],return:{name:"void"}}},description:""}}};function js(){return js=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},js.apply(null,arguments)}var et;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(et||(et={}));var Dn=function(t){return t},Vi="beforeunload",Rg="popstate";function Lg(t){t===void 0&&(t={});var s=t,n=s.window,a=n===void 0?document.defaultView:n,r=a.history;function o(){var I=a.location,_=I.pathname,A=I.search,E=I.hash,C=r.state||{};return[C.idx,Dn({pathname:_,search:A,hash:E,state:C.usr||null,key:C.key||"default"})]}var d=null;function i(){if(d)g.call(d),d=null;else{var I=et.Pop,_=o(),A=_[0],E=_[1];if(g.length){if(A!=null){var C=m-A;C&&(d={action:I,location:E,retry:function(){S(C*-1)}},S(C))}}else j(I)}}a.addEventListener(Rg,i);var l=et.Pop,u=o(),m=u[0],f=u[1],h=zn(),g=zn();m==null&&(m=0,r.replaceState(js({},r.state,{idx:m}),""));function b(I){return typeof I=="string"?I:Nl(I)}function p(I,_){return _===void 0&&(_=null),Dn(js({pathname:f.pathname,hash:"",search:""},typeof I=="string"?Fa(I):I,{state:_,key:Ba()}))}function x(I,_){return[{usr:I.state,key:I.key,idx:_},b(I)]}function v(I,_,A){return!g.length||(g.call({action:I,location:_,retry:A}),!1)}function j(I){l=I;var _=o();m=_[0],f=_[1],h.call({action:l,location:f})}function N(I,_){var A=et.Push,E=p(I,_);function C(){N(I,_)}if(v(A,E,C)){var T=x(E,m+1),w=T[0],P=T[1];try{r.pushState(w,"",P)}catch{a.location.assign(P)}j(A)}}function y(I,_){var A=et.Replace,E=p(I,_);function C(){y(I,_)}if(v(A,E,C)){var T=x(E,m),w=T[0],P=T[1];r.replaceState(w,"",P),j(A)}}function S(I){r.go(I)}var k={get action(){return l},get location(){return f},createHref:b,push:N,replace:y,go:S,back:function(){S(-1)},forward:function(){S(1)},listen:function(_){return h.push(_)},block:function(_){var A=g.push(_);return g.length===1&&a.addEventListener(Vi,Ki),function(){A(),g.length||a.removeEventListener(Vi,Ki)}}};return k}function Dg(t){t===void 0&&(t={});var s=t,n=s.initialEntries,a=n===void 0?["/"]:n,r=s.initialIndex,o=a.map(function(N){var y=Dn(js({pathname:"/",search:"",hash:"",state:null,key:Ba()},typeof N=="string"?Fa(N):N));return y}),d=Ji(r??o.length-1,0,o.length-1),i=et.Pop,l=o[d],u=zn(),m=zn();function f(N){return typeof N=="string"?N:Nl(N)}function h(N,y){return y===void 0&&(y=null),Dn(js({pathname:l.pathname,search:"",hash:""},typeof N=="string"?Fa(N):N,{state:y,key:Ba()}))}function g(N,y,S){return!m.length||(m.call({action:N,location:y,retry:S}),!1)}function b(N,y){i=N,l=y,u.call({action:i,location:l})}function p(N,y){var S=et.Push,k=h(N,y);function I(){p(N,y)}g(S,k,I)&&(d+=1,o.splice(d,o.length,k),b(S,k))}function x(N,y){var S=et.Replace,k=h(N,y);function I(){x(N,y)}g(S,k,I)&&(o[d]=k,b(S,k))}function v(N){var y=Ji(d+N,0,o.length-1),S=et.Pop,k=o[y];function I(){v(N)}g(S,k,I)&&(d=y,b(S,k))}var j={get index(){return d},get action(){return i},get location(){return l},createHref:f,push:p,replace:x,go:v,back:function(){v(-1)},forward:function(){v(1)},listen:function(y){return u.push(y)},block:function(y){return m.push(y)}};return j}function Ji(t,s,n){return Math.min(Math.max(t,s),n)}function Ki(t){t.preventDefault(),t.returnValue=""}function zn(){var t=[];return{get length(){return t.length},push:function(n){return t.push(n),function(){t=t.filter(function(a){return a!==n})}},call:function(n){t.forEach(function(a){return a&&a(n)})}}}function Ba(){return Math.random().toString(36).substr(2,8)}function Nl(t){var s=t.pathname,n=s===void 0?"/":s,a=t.search,r=a===void 0?"":a,o=t.hash,d=o===void 0?"":o;return r&&r!=="?"&&(n+=r.charAt(0)==="?"?r:"?"+r),d&&d!=="#"&&(n+=d.charAt(0)==="#"?d:"#"+d),n}function Fa(t){var s={};if(t){var n=t.indexOf("#");n>=0&&(s.hash=t.substr(n),t=t.substr(0,n));var a=t.indexOf("?");a>=0&&(s.search=t.substr(a),t=t.substr(0,a)),t&&(s.pathname=t)}return s}const zg=c.createContext([]);function wl(t){return t.name==="Pushed"||t.name==="Popped"||t.name==="Replaced"}function Og(t){return t.name==="StepPushed"||t.name==="StepPopped"||t.name==="StepReplaced"}function Bg(t){return wl(t)||Og(t)}const Ht={IDLE:"idle",PROGRESS:"progress",SUCCEEDED:"succeeded",FAILED:"failed"};function kl(t){return t===Ht.SUCCEEDED||t===Ht.FAILED}class Fg{targetId;initialSetupProcess;focusCount;previousActivationTrigger;constructor(s,n){this.targetId=s,this.initialSetupProcess=n,this.focusCount=0,this.previousActivationTrigger=null}captureStackChange(s){const n=this.initialSetupProcess.getStatus();if(!kl(n))return;const a=s.activities.find(o=>o.id===this.targetId);if(!a||!a.isActive)return;const r=s.events.findLast(wl);!r||this.previousActivationTrigger&&r.eventDate<=this.previousActivationTrigger.eventDate||(this.focusCount++,this.previousActivationTrigger=r)}getActivationCount(){return this.focusCount}getTargetId(){return this.targetId}}const{parse:Wg,stringify:$g}=JSON,{keys:qg}=Object,Ks=String,Cl="string",Gi={},Lr="object",Sl=(t,s)=>s,Hg=t=>t instanceof Ks?Ks(t):t,Ug=(t,s)=>typeof s===Cl?new Ks(s):s,Al=(t,s,n,a)=>{const r=[];for(let o=qg(n),{length:d}=o,i=0;i<d;i++){const l=o[i],u=n[l];if(u instanceof Ks){const m=t[u];typeof m===Lr&&!s.has(m)?(s.add(m),n[l]=Gi,r.push({k:l,a:[t,s,m,a]})):n[l]=a.call(n,l,m)}else n[l]!==Gi&&(n[l]=a.call(n,l,u))}for(let{length:o}=r,d=0;d<o;d++){const{k:i,a:l}=r[d];n[i]=a.call(n,i,Al.apply(null,l))}return n},Qi=(t,s,n)=>{const a=Ks(s.push(n)-1);return t.set(n,a),a},Vg=(t,s)=>{const n=Wg(t,Ug).map(Hg),a=n[0],r=s||Sl,o=typeof a===Lr&&a?Al(n,new Set,a,r):a;return r.call({"":o},"",o)},Jg=(t,s,n)=>{const a=Sl,r=new Map,o=[],d=[];let i=+Qi(r,o,a.call({"":t},"",t)),l=!i;for(;i<o.length;)l=!0,d[i]=$g(o[i++],u,n);return"["+d.join(",")+"]";function u(m,f){if(l)return l=!l,f;const h=a.call(this,m,f);switch(typeof h){case Lr:if(h===null)return h;case Cl:return r.get(h)||Qi(r,o,h)}return h}},Il="@biochain/plugin-navigation-sync";function Tl(t){return{_TAG:Il,flattedState:Jg({activity:t.activity,step:t.step})}}function Kg(t){return typeof t=="object"&&t!==null&&"_TAG"in t&&"flattedState"in t&&typeof t._TAG=="string"&&t._TAG===Il&&typeof t.flattedState=="string"}function gn(t){try{return Kg(t)?Vg(t.flattedState):null}catch{return null}}function Xi({history:t,pathname:s,state:n,useHash:a}){const r=a?`${t.location.pathname}#${s}`:s;t.push(r,Tl(n))}function ya({history:t,pathname:s,state:n,useHash:a}){const r=a?`${t.location.pathname}#${s}`:s;t.replace(r,Tl(n))}function Yi(t){return t.length===0?void 0:t[t.length-1]}const Gg=t=>{let s=Promise.resolve();return{requestHistoryTick:a=>{s=s.then(()=>new Promise(r=>{const o=t.listen(()=>{o(),r()});a(()=>{o(),r()})}))}}};function Pl(t){return new URL(t,"file://")}function Wa(t){const s={};return t.forEach((n,a)=>{s[a]=n}),s}function vn(t){return t.endsWith("/")?t:`${t}/`}function Zi(t){return t.toString().length>0?`?${t}`:t}function We({path:t,decode:s},n){const a=t==="*"||t==="/*",r=a?[]:Array.from(t.matchAll(/:([A-Za-z0-9_]+)/g)).map(u=>u[1]).filter(Boolean),o=Array.from(new Set(r)),d=a?Number.POSITIVE_INFINITY:o.length,i=a?"*":vn(t),l=a?null:new URLPattern({pathname:i});return{fill(u){if(a){const g=new URLSearchParams(Object.entries(u).reduce((b,[p,x])=>x?{...b,[p]:x}:b,{}));return vn("/")+Zi(g)}let m=t;for(const g of o){const b=u[g];if(b===void 0)throw new Error(`Missing route param: ${g}`);m=m.replace(`:${g}`,encodeURIComponent(b))}m=vn(m);const f={...u};o.forEach(g=>{delete f[g]});const h=new URLSearchParams(Object.entries(f).reduce((g,[b,p])=>({...g,...p?{[b]:p}:null}),{}));return m+Zi(h)},parse(u){const m=Pl(u);if(a){const v={...Wa(m.searchParams)};return s?s(v):v}if(!l)return null;const f=vn(m.pathname),h=l.exec({pathname:f}),g=Wa(m.searchParams);if(!h)return null;const b=h.pathname.groups,p={...g};for(const[x,v]of Object.entries(b))v!==void 0&&(p[x]=v);return s?s(p):p},variableCount:d}}class Qg{status;pendingNavigations;dispatchedEvents;baseNavigationEvents;constructor(s,n=[]){this.status=s.length>0?Ht.IDLE:Ht.SUCCEEDED,this.pendingNavigations=s.slice(),this.dispatchedEvents=[],this.baseNavigationEvents=n}captureNavigationOpportunity(s){if(kl(this.status))return[];if(s&&s.globalTransitionState!=="idle")return[];if(this.pendingNavigations.length===0)return this.status=Ht.SUCCEEDED,[];const n=s?s.events.filter(Bg):[];if(!(this.verifyAllDispatchedEventsAreInNavigationHistory(n)&&this.verifyNoUnknownNavigationEvents(n)))return this.pendingNavigations=[],this.status=Ht.FAILED,[];const a=this.pendingNavigations.shift();if(!a)return[];const r=a();return this.dispatchedEvents.push(...r),this.status=Ht.PROGRESS,r}getStatus(){return this.status}verifyAllDispatchedEventsAreInNavigationHistory(s){const n=new Set(s.map(a=>a.id));return this.dispatchedEvents.every(a=>n.has(a.id))}verifyNoUnknownNavigationEvents(s){const n=new Set([...this.baseNavigationEvents,...this.dispatchedEvents].map(a=>a.id));return s.every(a=>n.has(a.id))}}function Xg(t){return typeof t=="string"?{path:t}:t}function Yg(t){return(Array.isArray(t)?t:[t]).map(Xg)}function Zg(t){return Object.keys(t).flatMap(n=>{const a=t[n];return a?Yg(a).map(r=>({activityName:n,...r})):[]})}class ev{latestlyBookedSession=Promise.resolve();acquire(){return new Promise(s=>{this.latestlyBookedSession=this.latestlyBookedSession.then(()=>new Promise(n=>s({release:()=>n()})))})}async runExclusively(s){const{release:n}=await this.acquire();try{return await s()}finally{n()}}}class tv{subscribers=[];publishLock=new ev;subscribe(s){return this.subscribers.push(s),()=>{this.subscribers=this.subscribers.filter(n=>n!==s)}}publish(s){const n=this.subscribers.slice();return this.publishLock.runExclusively(()=>Promise.allSettled(n.map(a=>a(s))))}}const sv=c.createContext([]),Dr=t=>e.jsx(sv.Provider,{value:t.routes,children:t.children});Dr.displayName="RoutesProvider";Dr.__docgenInfo={description:"",methods:[],displayName:"RoutesProvider",props:{routes:{required:!0,tsType:{name:"Array",elements:[{name:"ActivityRoute",elements:[{name:"T"}],raw:"ActivityRoute<T>"}],raw:"ActivityRoute<T>[]"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const nv=/^:[\w-]+$/,av=3,rv=1,iv=10,ov=-2,eo=t=>t==="*";function to(t){const s=t.split("/");let n=s.length;return s.some(eo)&&(n+=ov),s.filter(a=>!eo(a)).reduce((a,r)=>a+(nv.test(r)?av:r===""?rv:iv),n)}function cv(t){return[...t].toSorted((s,n)=>to(n.path)-to(s.path))}const lv=1e3,dv=60*lv;function uv(t){"config"in t&&t.config.decorate("historySync",{makeTemplate:We,urlPatternOptions:t.urlPatternOptions});const s=t.history??(typeof window>"u"?Dg({}):Lg({window})),{location:n}=s,a="routes"in t?t.routes:t.config.activities.reduce((o,d)=>({...o,[d.name]:d.route}),{}),r=cv(Zg(a));return()=>{let o=0,d=!1,i=null;const l=[],u=new tv,{requestHistoryTick:m}=Gg(s),f=p=>u.subscribe(async()=>p());let h=null;const g=()=>{const p=l.map(x=>({activityId:x.getTargetId(),activationCount:x.getActivationCount()}));return(!h||h.length!==p.length||h.some(({activityId:x,activationCount:v})=>p.some(({activityId:j,activationCount:N})=>j===x&&N!==v)))&&(h=p),h},b=p=>{let x=!1;for(const v of l){const j=v.getActivationCount();v.captureStackChange(p),j!==v.getActivationCount()&&(x=!0)}x&&u.publish()};return{key:"plugin-history-sync",wrapStack({stack:p}){const x=c.useSyncExternalStore(f,g,g);return e.jsx(jl,{requestHistoryTick:m,children:e.jsx(Dr,{routes:r,children:e.jsx(zg.Provider,{value:x,children:p.render()})})})},overrideInitialEvents({initialContext:p}){const x=gn(s.location.state);if(x)return[{...x.activity.enteredBy,name:"Pushed"},...x.step?.enteredBy.name==="StepPushed"||x.step?.enteredBy.name==="StepReplaced"?[{...x.step.enteredBy,name:"StepPushed"}]:[]];function v(){return p?.req?.path&&typeof p.req.path=="string"?p.req.path:t.useHash?n.hash.split("#")[1]??"/":n.pathname+n.search}const j=v(),N=t.fallbackActivity({initialContext:p}),y=r.find(A=>We(A,t.urlPatternOptions).parse(j)!==null)??r.find(A=>A.activityName===N),k=We(y,t.urlPatternOptions).parse(j)??{},I=Object.entries(k).reduce((A,[E,C])=>(typeof C=="string"&&(A[E]=C),A),{}),_=y.defaultHistory?.(I)??[];return i=new Qg([..._.map(({activityName:A,activityParams:E,additionalSteps:C=[]})=>()=>{const T=[{name:"Pushed",id:it(),activityId:it(),activityName:A,activityParams:{...E},activityContext:{path:j,lazyActivityComponentRenderContext:{shouldRenderImmediately:!0}}},...C.map(({stepParams:w,hasZIndex:P})=>({name:"StepPushed",id:it(),stepId:it(),stepParams:w,hasZIndex:P}))];for(const w of T)w.name==="Pushed"&&l.push(new Fg(w.activityId,i));return T}),()=>[{name:"Pushed",id:it(),activityId:it(),activityName:y.activityName,activityParams:We(y,t.urlPatternOptions).parse(j)??Wa(Pl(j).searchParams),activityContext:{path:j,lazyActivityComponentRenderContext:{shouldRenderImmediately:!0}}}]]),i.captureNavigationOpportunity(null).map(A=>({...A,eventDate:Date.now()-dv}))},onInit({actions:{getStack:p,dispatchEvent:x,push:v,stepPush:j}}){const N=p(),y=N.activities[0],S=r.find(A=>A.activityName===y.name),k=We(S,t.urlPatternOptions),I=Yi(y.steps);m(()=>{d=!0,ya({history:s,pathname:k.fill(y.params),state:{activity:y,step:I},useHash:t.useHash})});const _=A=>{if(d){d=!1;return}const E=gn(A.location.state);if(!E)return;const C=E.activity,T=E.activity.id,w=E.step,{activities:P}=p(),L=P.find($=>$.isActive);if(!L)return;const z=Yi(L.steps),R=P.find($=>$.id===T),q=L.steps.find($=>$.id===w?.id),M=()=>L.id>T,F=()=>L.id<T,K=()=>L.id===T,ee=()=>K()?!!(!w||z&&z.id>w.id):!1,W=()=>K()?!!(!z||w&&z.id<w.id):!1;if(M()&&(x("Popped",{}),!R&&(o+=1,v({...C.enteredBy}),w?.enteredBy.name==="StepPushed"||w?.enteredBy.name==="StepReplaced"))){const{enteredBy:$}=w;o+=1,j({...$})}if(ee()){if(!q&&w&&(w?.enteredBy.name==="StepPushed"||w?.enteredBy.name==="StepReplaced")){const{enteredBy:$}=w;o+=1,j({...$})}x("StepPopped",{})}if(F()&&(o+=1,v({activityId:C.id,activityName:C.name,activityParams:C.params})),W()){if(!w)return;o+=1,j({stepId:w.id,stepParams:w.params})}};s.listen(_),i?.captureNavigationOpportunity(N).forEach(A=>A.name==="Pushed"?v(A):j(A)),b(N)},onPushed({effect:{activity:p}}){if(o){o-=1;return}const x=r.find(j=>j.activityName===p.name),v=We(x,t.urlPatternOptions);m(()=>{d=!0,Xi({history:s,pathname:v.fill(p.params),state:{activity:p},useHash:t.useHash})})},onStepPushed({effect:{activity:p,step:x}}){if(o){o-=1;return}const v=r.find(N=>N.activityName===p.name),j=We(v,t.urlPatternOptions);m(()=>{d=!0,Xi({history:s,pathname:j.fill(p.params),state:{activity:p,step:x},useHash:t.useHash})})},onReplaced({effect:{activity:p}}){if(!p.isActive)return;const x=r.find(j=>j.activityName===p.name),v=We(x,t.urlPatternOptions);m(()=>{d=!0,ya({history:s,pathname:v.fill(p.params),state:{activity:p},useHash:t.useHash})})},onStepReplaced({effect:{activity:p,step:x}}){if(!p.isActive)return;const v=r.find(N=>N.activityName===p.name),j=We(v,t.urlPatternOptions);m(()=>{d=!0,ya({history:s,pathname:j.fill(p.params),state:{activity:p,step:x},useHash:t.useHash})})},onBeforePush({actionParams:p,actions:{overrideActionParams:x}}){if(!p.activityContext||!("path"in p.activityContext)){const v=r.find(y=>y.activityName===p.activityName),N=We(v,t.urlPatternOptions).fill(p.activityParams);x({...p,activityContext:{...p.activityContext,path:N}})}},onBeforeReplace({actionParams:p,actions:{overrideActionParams:x,getStack:v}}){if(!p.activityContext||!("path"in p.activityContext)){const S=r.find(_=>_.activityName===p.activityName),I=We(S,t.urlPatternOptions).fill(p.activityParams);x({...p,activityContext:{...p.activityContext,path:I}})}const{activities:j}=v(),N=j.filter(S=>S.transitionState==="enter-active"||S.transitionState==="enter-done"),y=N.length>0?N[N.length-1]:null;if(y)for(let S=0;S<y.steps.length-1;S+=1)m(k=>{gn(s.location.state)?k():(d=!0,s.back())}),m(()=>{d=!0,s.back()})},onBeforeStepPop({actions:{getStack:p}}){const{activities:x}=p();(x.find(j=>j.isActive)?.steps.length??0)>1&&m(()=>{d=!0,s.back()})},onBeforePop({actions:{getStack:p}}){const{activities:x}=p(),v=x.find(j=>j.isActive);if(v){const{isRoot:j,steps:N}=v,y=j?0:N.length;for(let S=0;S<y;S+=1)m(k=>{gn(s.location.state)?k():(d=!0,s.back())}),m(()=>{d=!0,s.back()})}},onChanged({actions:{getStack:p,push:x,stepPush:v}}){const j=p();i?.captureNavigationOpportunity(j).forEach(N=>N.name==="Pushed"?x(N):v(N)),b(j)}}}}function El(){const{t}=B(["settings","common"]),[s,n]=c.useState(!1),a=()=>{n(!0);const r="./";window.location.href=`${r}clear.html`};return e.jsx("div",{className:"bg-background flex min-h-screen flex-col items-center justify-center p-6",children:e.jsxs("div",{className:"flex max-w-sm flex-col items-center gap-6 text-center",children:[e.jsx("div",{className:"bg-destructive/10 flex size-20 items-center justify-center rounded-full",children:e.jsx(Oe,{className:"text-destructive size-10"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-xl font-bold",children:t("settings:storage.migrationRequired")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:t("settings:storage.migrationDesc")})]}),e.jsx("div",{className:"bg-destructive/5 w-full rounded-lg p-4",children:e.jsxs("ul",{className:"text-destructive space-y-2 text-left text-sm",children:[e.jsxs("li",{children:[" ",t("settings:clearData.item1")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item2")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item3")]})]})}),e.jsxs(V,{variant:"destructive",onClick:a,className:"w-full gap-2",disabled:s,children:[e.jsx(ns,{className:"size-4"}),t("settings:clearData.confirm")]})]})})}El.__docgenInfo={description:`


 Stackflow context  useFlow()`,methods:[],displayName:"MigrationRequiredView"};function mv(t){switch(t){case"confirmed":return"confirmed";case"failed":return"failed";default:return"pending"}}function _l(t,s){const n=t.meta?.displayAmount??"0",a=t.meta?.displaySymbol??"",r=oe.fromFormatted(n,s,a);return{id:`${t.chainId}--${t.txHash}`,type:t.meta?.type??"other",status:mv(t.status),amount:r,symbol:a,address:t.meta?.displayToAddress??t.fromAddress,timestamp:new Date(t.createdAt),hash:t.txHash,chain:t.chainId}}const Ml=c.createContext(null);function zt({chainId:t,children:s,fallback:n=null}){const a=c.useMemo(()=>t?Ee(t):null,[t]);return a?e.jsx(Ml.Provider,{value:a,children:s},t):e.jsx(e.Fragment,{children:n})}function os(){const t=c.useContext(Ml);if(!t)throw new Error("useChainProvider must be used within ChainProviderGate. Make sure to wrap your component with <ChainProviderGate chainId={...}>.");return t}zt.__docgenInfo={description:`ChainProvider 

 ChainProvider 
 chainId  fallback  null

@example
\`\`\`tsx
<ChainProviderGate chainId={selectedChain} fallback={<ChainNotSupported />}>
  <WalletContent />
</ChainProviderGate>
\`\`\``,methods:[],displayName:"ChainProviderGate",props:{chainId:{required:!0,tsType:{name:"union",raw:"string | null | undefined",elements:[{name:"string"},{name:"null"},{name:"undefined"}]},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},fallback:{required:!1,tsType:{name:"ReactNode"},description:" provider ",defaultValue:{value:"null",computed:!1}}}};function $a(t,s){return c.useMemo(()=>t?t instanceof $o?{supported:!1,limited:!1,type:"notSupported",reason:s("common:service.notSupported")}:t instanceof zm?{supported:!0,limited:!0,type:"limited",reason:s("common:service.limited")}:{supported:!0,limited:!1,type:"error",error:t,reason:t.message}:{supported:!0,limited:!1,type:"ok"},[t,s])}function fv(t,s){return t==="transfer"?s==="in"?"receive":"send":{swap:"swap",exchange:"exchange",approve:"approve",stake:"stake",unstake:"unstake",mint:"mint",burn:"destroy",gift:"gift",grab:"grab",trust:"trust",signFor:"signFor",emigrate:"emigrate",immigrate:"immigrate",issueAsset:"issueAsset",increaseAsset:"increaseAsset",destroyAsset:"destroy",issueEntity:"issueEntity",destroyEntity:"destroyEntity",locationName:"locationName",dapp:"dapp",certificate:"certificate",mark:"mark",signature:"signature"}[t]??"other"}function pv(t,s){const n=l=>l?s?`${s}--${l}`:l:"unknown";if(!t||!t.hash||!t.assets||t.assets.length===0)return{id:n(t?.hash),type:"other",status:"pending",amount:oe.fromRaw("0",8,""),symbol:"",address:t?.from??t?.to??"",timestamp:new Date,hash:t?.hash,chain:s};const a=t.assets[0],r=t.direction==="in"?t.from:t.to;let o=8,d="0",i="";return(a.assetType==="native"||a.assetType==="token")&&(o=a.decimals??8,d=a.value??"0",i=a.symbol??""),{id:n(t.hash),type:fv(t.action,t.direction),status:t.status,amount:oe.fromRaw(d,o,i),symbol:i,address:r,timestamp:new Date(t.timestamp),hash:t.hash,chain:s}}function Rl(t,s){return!t||!Array.isArray(t)?[]:t.filter(n=>n!=null).map(n=>{try{return pv(n,s)}catch(a){return console.warn("[toTransactionInfoList] Failed to convert transaction:",n,a),{id:s?`${s}--${n?.hash??"error"}`:n?.hash??"error",type:"other",status:"pending",amount:oe.fromRaw("0",8,""),symbol:"",address:"",timestamp:new Date,chain:s}}})}function hv({address:t,selectedChain:s,selectedChainName:n,mainAssetSymbol:a,wallets:r,currentWalletId:o,chainPreferences:d,onWalletChange:i,onCopyAddress:l,onOpenChainSelector:u,onOpenSettings:m,onOpenWalletList:f,onAddWallet:h,onOpenAddressBalance:g,onOpenAddressTransactions:b}){const{push:p}=Z(),x=rn(),{t:v}=B(["home","wallet","common","transaction"]),j=ut(),N=j.snapshot?He.getChainById(j,s):void 0,y=os(),{data:S=[],isLoading:k,isFetching:I,error:_}=y.allBalances.useState({address:t},{enabled:!!t}),{data:A,isLoading:E,isFetching:C,error:T}=y.transactionHistory.useState({address:t,limit:50},{enabled:!!t}),w=k||I&&S.length===0,P=$a(_,v),L=$a(T,v),{transactions:z,deleteTransaction:R,retryTransaction:q}=Oo(o??void 0,s,t,A),M=c.useMemo(()=>A?Rl(A,s):[],[A,s]),F=E||C&&M.length===0,K=c.useCallback(W=>{if(W.id){const $=A?.find(ne=>ne.hash===W.hash),ie=$?Xt.stringify($):void 0;p("TransactionDetailActivity",{txId:W.id,txData:ie})}},[p,A]),ee=c.useCallback((W,$)=>[{label:v("home:wallet.transfer"),icon:e.jsx(pc,{className:"size-4"}),onClick:()=>{x.impact("light"),p("SendActivity",{assetType:W.symbol})}},{label:v("home:wallet.destroy"),icon:e.jsx(In,{className:"size-4"}),onClick:()=>{x.impact("light"),p("DestroyActivity",{assetType:W.symbol,assetLocked:"true"})},variant:"destructive",show:$.canDestroy}],[x,p,v]);return e.jsxs("div",{"data-testid":"wallet-home",className:"flex h-full flex-col overflow-y-auto bg-background",children:[e.jsxs("div",{className:"pt-2 pb-1",children:[e.jsx(lm,{wallets:r,currentWalletId:o,selectedChain:s,chainPreferences:d,onWalletChange:i,onCopyAddress:l,onOpenChainSelector:u,onOpenSettings:m,onOpenWalletList:f,onAddWallet:h,onOpenAddressBalance:g,onOpenAddressTransactions:b}),e.jsxs("div",{className:"mt-2 flex justify-center gap-8 px-6",children:[e.jsxs("button",{onClick:()=>p("SendActivity",{}),"data-testid":"wallet-home-send-button",className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:e.jsx(bc,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:v("home:wallet.send")})]}),e.jsxs("button",{onClick:()=>p("ReceiveActivity",{}),"data-testid":"wallet-home-receive-button",className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:e.jsx(Up,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:v("home:wallet.receive")})]}),e.jsxs("button",{onClick:()=>p("ScannerActivity",{}),"data-testid":"wallet-home-scan-button",className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:e.jsx(qm,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:v("common:a11y.scan")})]})]})]}),z.length>0&&e.jsxs("div",{className:"px-4 pt-2 space-y-2",children:[e.jsx("h3",{className:"text-muted-foreground text-xs font-medium uppercase tracking-wider px-1",children:v("transaction:pendingTx.title")}),e.jsx("div",{className:"space-y-1",children:z.slice(0,3).map(W=>{const $=_l(W,N?.decimals??8);return e.jsx(qo,{transaction:$,onClick:()=>p("TransactionDetailActivity",{txId:$.id}),onRetry:W.status==="failed"?()=>q(W):void 0,onDelete:()=>R(W)},W.id)})}),z.length>3&&e.jsx("button",{onClick:()=>p("HistoryActivity",{chain:s}),className:"mt-2 w-full rounded-lg bg-muted/60 py-2 text-xs font-medium text-muted-foreground transition-colors hover:bg-muted",children:v("transaction:pendingTx.viewAll",{count:z.length})})]}),e.jsx("div",{className:"flex-1 pt-3",children:e.jsx(_m,{chainId:s,chainName:n,tokens:S.map(W=>({symbol:W.symbol,name:W.name,chain:s,balance:W.amount.toFormatted(),decimals:W.decimals,fiatValue:void 0,change24h:0,icon:W.icon})),transactions:M.slice(0,5),tokensLoading:w,tokensRefreshing:I&&S.length>0,transactionsLoading:F,transactionsRefreshing:C&&M.length>0,tokensSupported:P.type!=="notSupported",tokensFallbackReason:P.type!=="ok"?P.reason:void 0,transactionsSupported:L.type!=="notSupported"&&L.type!=="limited",transactionsFallbackReason:L.type!=="ok"?L.reason:void 0,onTokenClick:W=>{},onTransactionClick:K,mainAssetSymbol:a,tokenMenuItems:ee,renderTransactionFooter:()=>e.jsx("button",{onClick:()=>p("HistoryActivity",{chain:M.length>0?s:"all"}),className:"mt-3 w-full rounded-lg bg-muted/60 py-2.5 text-sm font-medium text-muted-foreground transition-colors hover:bg-muted",children:M.length>0?v("transaction:history.viewAll",{count:M.length}):v("transaction:history.viewAllChains")}),testId:"wallet-home"})}),e.jsx("div",{className:"shrink-0 h-[var(--tab-bar-height)]"})]})}function Ll(){const{push:t}=Z(),s=vr(),n=nt(),a=rn(),{t:r}=B(["home","wallet","common","transaction"]),o=fm(),d=ym(),i=bm(),l=Rt(),u=Fe(),m=Gn(),f=u?.id??null,h=Je(),g=nr(),b=r(`common:chains.${h}`,{defaultValue:h}),p=ut(),v=(p.snapshot?He.getChainById(p,h):null)?.symbol;Lo();const j=m?.address??"",N=c.useCallback(async C=>{await s.write({text:C}),await a.impact("light"),n.show(r("home:wallet.addressCopied"))},[s,a,n,r]),y=c.useCallback(C=>{C!==f&&ye.setCurrentWallet(C),t("ChainSelectorJob",{})},[t,f]),S=c.useCallback(C=>{const T=l.find(w=>w.id===C);T&&t("WalletConfigActivity",{walletId:C,walletName:T.name})},[t,l]),k=c.useCallback(C=>{ye.setCurrentWallet(C)},[]),I=c.useCallback(()=>{t("WalletAddJob",{})},[t]),_=c.useCallback(()=>{t("WalletListJob",{})},[t]),A=c.useCallback(()=>{t("AddressBalanceActivity",{})},[t]),E=c.useCallback(()=>{t("AddressTransactionsActivity",{})},[t]);return o?e.jsx(El,{}):d?!i||!u?e.jsx(xv,{}):e.jsx(zt,{chainId:h,fallback:e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:r("common:ecosystem.chainNotSupported")})}),children:e.jsx(hv,{address:j,selectedChain:h,selectedChainName:b,mainAssetSymbol:v,wallets:l,currentWalletId:f,chainPreferences:g,onWalletChange:k,onCopyAddress:N,onOpenChainSelector:y,onOpenSettings:S,onOpenWalletList:_,onAddWallet:I,onOpenAddressBalance:A,onOpenAddressTransactions:E})}):e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(Pe,{size:"lg"})})}function xv(){const{push:t}=Z(),{t:s}=B("home");return e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-6 p-6 text-center",children:[e.jsx("div",{className:"bg-primary/10 rounded-full p-6",children:e.jsx(mt,{className:"text-primary size-12"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:s("welcome.title")}),e.jsx("p",{className:"text-muted-foreground mt-2",children:s("welcome.subtitle")})]}),e.jsxs("div",{className:"flex w-full max-w-xs flex-col gap-3",children:[e.jsx(Ue,{variant:"mint",className:"w-full","data-testid":"create-wallet-button",onClick:()=>t("WalletCreateActivity",{}),children:s("welcome.createWallet")}),e.jsx(V,{variant:"outline",className:"w-full","data-testid":"import-wallet-button",onClick:()=>t("OnboardingRecoverActivity",{}),children:s("welcome.importWallet")})]})]})}Ll.__docgenInfo={description:"",methods:[],displayName:"WalletTab"};function Dl(){const{push:t}=Z(),s=c.useRef(null),[n,a]=c.useState([]),[r,o]=c.useState(!0),d=Ie(ir,b=>b.myApps);c.useEffect(()=>{let b=!1;const p=Gm(x=>{a(x),b||(b=!0,o(!1))});return Vo({refresh:!0}).then(()=>{b||(a(Qm()),o(!1))}),()=>p()},[]),Xm();const i=c.useCallback(b=>{t("MiniappDetailActivity",{appId:encodeURIComponent(b.id)})},[t]),l=c.useCallback(b=>{Re.installApp(b.id),Re.updateAppLastUsed(b.id),Re.setActiveSubPage("mine"),s.current?.slideTo("mine"),requestAnimationFrame(()=>{Jo(b.id,{...b,targetDesktop:"mine"})})},[]),u=c.useCallback(b=>{Re.uninstallApp(b)},[]),m=c.useMemo(()=>d.map(b=>({...b,app:n.find(p=>p.id===b.appId)})).filter(b=>!!b.app).map(({app:b,lastUsedAt:p})=>({app:b,lastUsed:p})),[d,n]),f=c.useMemo(()=>n.length===0?[]:[...n].toSorted((b,p)=>mi(p)-mi(b)).slice(0,2),[n]),h=c.useMemo(()=>{const b=new Set(f.map(p=>p.id));return[...n].filter(p=>!b.has(p.id)).toSorted((p,x)=>(x.officialScore??0)-(p.officialScore??0)).slice(0,6)},[n,f]),g=c.useMemo(()=>[...n].toSorted((b,p)=>(p.communityScore??0)-(b.communityScore??0)).slice(0,10),[n]);return r?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(Pe,{size:"lg"})}):e.jsx(df,{ref:s,showDiscoverPage:!0,showStackPage:"auto",apps:n,myApps:m,featuredApps:f,recommendedApps:h,hotApps:g,onAppOpen:l,onAppDetail:i,onAppRemove:u})}Dl.__docgenInfo={description:"",methods:[],displayName:"EcosystemTab"};const gv=/^(\d+)\.(\d+)\.(\d+)(?:-([0-9A-Za-z.-]+))?$/;function so(t){const s=t.match(gv);if(!s)return null;const[,n,a,r,o]=s,d=o&&/^\d+$/.test(o)?Number(o):void 0;return{major:Number(n),minor:Number(a),patch:Number(r),suffix:o??void 0,suffixNumber:d}}function vv(t,s){const n=so(t),a=so(s);if(!n||!a)return null;if(n.major!==a.major)return n.major-a.major;if(n.minor!==a.minor)return n.minor-a.minor;if(n.patch!==a.patch)return n.patch-a.patch;const r=n.suffixNumber??(n.suffix?Number.NaN:0),o=a.suffixNumber??(a.suffix?Number.NaN:0);return!Number.isNaN(r)&&!Number.isNaN(o)?r-o:n.suffix&&!a.suffix?1:!n.suffix&&a.suffix?-1:n.suffix&&a.suffix?n.suffix.localeCompare(a.suffix):0}function ba(t){return t.endsWith("/")?t:`${t}/`}function yv(t){return t.endsWith("/")?t:`${t}/`}function bv(){const t=ba("https://BioforestChain.github.io");try{const a=new URL(t).pathname;if(a&&a!=="/")return ba(t)}catch{return t}const s=yv("/KeyApp/");return ba(new URL(s,t).toString())}function jv(){const t=bv(),s="dweb-dev/metadata.json";return new URL(s,t).toString()}function Nv(t){return`dweb://install?url=${encodeURIComponent(t)}`}async function wv(t){const s=await fetch(t,{cache:"no-store"});if(!s.ok)throw new Error(`metadata fetch failed: ${s.status}`);const n=await s.json(),a=typeof n.version=="string"?n.version:"",r=typeof n.change_log=="string"?n.change_log:n.changeLog;return{version:a,changeLog:r}}async function kv(){const t="1.0.4-021713",s=Rm();let n="",a="";try{n=jv(),a=Nv(n)}catch(r){const o=r instanceof Error?r.message:"invalid site origin";return{status:"error",currentVersion:t,metadataUrl:n,installUrl:a,error:o}}try{const r=await wv(n);if(!r.version)return{status:"error",currentVersion:t,metadataUrl:n,installUrl:a,error:"metadata version missing"};const o=vv(r.version,t);return o===null?{status:"error",currentVersion:t,metadataUrl:n,installUrl:a,error:"version parse failed"}:s?o>0?{status:"update-available",currentVersion:t,latestVersion:r.version,metadataUrl:n,installUrl:a,changeLog:r.changeLog}:{status:"up-to-date",currentVersion:t,latestVersion:r.version,metadataUrl:n,installUrl:a,changeLog:r.changeLog}:{status:"not-dweb",currentVersion:t,latestVersion:r.version,metadataUrl:n,installUrl:a,changeLog:r.changeLog}}catch(r){const o=r instanceof Error?r.message:"unknown error";return{status:"error",currentVersion:t,metadataUrl:n,installUrl:a,error:o}}}const Cv={status:"idle",currentVersion:"1.0.4-021713",dialogOpen:!1},$t=new im(Cv),Sv={openDialog:()=>{$t.setState(t=>({...t,dialogOpen:!0}))},closeDialog:()=>{$t.setState(t=>({...t,dialogOpen:!1}))},check:async t=>{const{status:s}=$t.state;if(s==="checking")return{status:"error",currentVersion:"1.0.4-021713",metadataUrl:"",installUrl:"",error:"already checking"};$t.setState(a=>({...a,status:"checking"}));const n=await kv();return $t.setState(a=>({...a,status:n.status,currentVersion:n.currentVersion,latestVersion:n.latestVersion,changeLog:n.changeLog,metadataUrl:n.metadataUrl,installUrl:n.installUrl,error:n.error,lastCheckedAt:Date.now(),dialogOpen:n.status==="update-available"?!0:a.dialogOpen})),t==="auto"&&n.status!=="update-available"&&$t.setState(a=>({...a,dialogOpen:!1})),n}};function Av(){return Ie($t)}function Ae({icon:t,label:s,value:n,showChevron:a=!0,disabled:r=!1,onClick:o,trailing:d,className:i,testId:l}){const u=o?"button":"div";return e.jsxs(u,{type:o?"button":void 0,onClick:r?void 0:o,disabled:r,"data-testid":l,className:D("bg-background flex w-full items-center gap-3 rounded-xl px-4 py-3.5","transition-colors",o&&!r&&"hover:bg-muted/50 active:bg-muted",r&&"cursor-not-allowed",i),children:[t&&e.jsx("span",{className:"bg-muted text-foreground flex size-8 shrink-0 items-center justify-center rounded-lg",children:t}),e.jsx("span",{className:D("flex-1 text-left text-sm font-medium",r&&"text-muted-foreground"),children:s}),d??e.jsxs(e.Fragment,{children:[n&&e.jsx("span",{className:"text-muted-foreground text-sm",children:n}),a&&o&&e.jsx(De,{className:"text-muted-foreground/50 size-5"})]})]})}Ae.__docgenInfo={description:"",methods:[],displayName:"SettingsItem",props:{icon:{required:!1,tsType:{name:"union",raw:"ReactNode | undefined",elements:[{name:"ReactNode"},{name:"undefined"}]},description:""},label:{required:!0,tsType:{name:"string"},description:""},value:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},showChevron:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"",defaultValue:{value:"true",computed:!1}},disabled:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"",defaultValue:{value:"false",computed:!1}},onClick:{required:!1,tsType:{name:"union",raw:"(() => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},trailing:{required:!1,tsType:{name:"union",raw:"ReactNode | undefined",elements:[{name:"ReactNode"},{name:"undefined"}]},description:""},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:" className"},testId:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:" ID"}}};function _s({title:t,children:s,className:n,allowContextMenu:a}){return e.jsxs("section",{className:D("space-y-1",n),"data-allow-context-menu":a?"true":void 0,children:[t&&e.jsx("h3",{className:"mb-2 px-1 text-xs font-medium uppercase text-muted-foreground",children:t}),e.jsx("div",{className:"overflow-hidden rounded-xl bg-card shadow-sm",children:s})]})}_s.__docgenInfo={description:"",methods:[],displayName:"SettingsSection",props:{title:{required:!1,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},className:{required:!1,tsType:{name:"string"},description:" className"},allowContextMenu:{required:!1,tsType:{name:"boolean"},description:"DWEB "}}};const Iv=[{value:"system",icon:Cp},{value:"light",icon:Xp},{value:"dark",icon:zp}];function zl({open:t,onOpenChange:s}){const{t:n}=B("settings"),a=Mo(),r=o=>{Jn.setTheme(o),s(!1)};return e.jsx(St,{open:t,onOpenChange:s,children:e.jsxs(At,{side:"bottom",className:"rounded-t-2xl",children:[e.jsx(It,{children:e.jsx(Tt,{children:n("appearance.title")})}),e.jsx("div",{className:"mt-4 space-y-2",children:Iv.map(({value:o,icon:d})=>e.jsxs("button",{onClick:()=>r(o),className:D("flex w-full items-center gap-3 rounded-xl p-4 transition-colors",a===o?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx(d,{size:24}),e.jsx("span",{className:"flex-1 text-left font-medium",children:n(`appearance.${o}`)}),a===o&&e.jsx(Ne,{size:20})]},o))})]})})}zl.__docgenInfo={description:"",methods:[],displayName:"AppearanceSheet",props:{open:{required:!0,tsType:{name:"boolean"},description:""},onOpenChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(open: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"open"}],return:{name:"void"}}},description:""}}};const qe=ke.t.bind(ke);async function Tv(t,s){const n=Ee(t.id);if(!n.estimateFee||!n.buildTransaction){const r=dt.getBiowalletApi(t.id);if(!r)throw new Error(qe("error:transaction.feeEstimateFailed"));const o=await Kr(r,t.id,s,"1");return{amount:oe.fromRaw(o,t.decimals,t.symbol),symbol:t.symbol}}const a=await n.buildTransaction({type:"transfer",from:s,to:s,amount:oe.fromRaw("1",t.decimals,t.symbol)});try{return{amount:(await n.estimateFee(a)).standard.amount,symbol:t.symbol}}catch{const r=dt.getBiowalletApi(t.id);if(!r)throw new Error(qe("error:transaction.feeEstimateFailed"));const o=await Kr(r,t.id,s,"1");return{amount:oe.fromRaw(o,t.decimals,t.symbol),symbol:t.symbol}}}async function no({chainConfig:t,walletId:s,password:n,fromAddress:a,toAddress:r,amount:o,assetType:d,fee:i,twoStepSecret:l}){let u;try{u=await vs.getMnemonic(s,n)}catch(f){return f instanceof Qs&&f.code===ys.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:f instanceof Error?f.message:qe("error:unknown")}}if(!o.isPositive())return{status:"error",message:qe("error:validation.enterValidAmount")};const m=Ee(t.id);if(!m.supportsFullTransaction)return{status:"error",message:qe("error:transaction.chainNotSupported")};try{let f=null;if(m.bioGetAccountInfo){if(f=(await m.bioGetAccountInfo(a)).secondPublicKey,f&&!l)return{status:"password_required",secondPublicKey:f};if(l&&f&&m.bioVerifyPayPassword&&!await m.bioVerifyPayPassword({mainSecret:u,paySecret:l,publicKey:f}))return{status:"error",message:qe("error:transaction.securityPasswordFailed")}}const h=await m.buildTransaction({type:"transfer",from:a,to:r,amount:o,fee:i,bioAssetType:d}),g=await m.signTransaction(h,{privateKey:new TextEncoder().encode(u),bioSecret:u,bioPaySecret:l}),b=await kt.create({walletId:Wo(t.id,a),chainId:t.id,fromAddress:a,rawTx:g,meta:{type:"send",displayAmount:o.toFormatted(),displaySymbol:d,displayToAddress:r}});await kt.updateStatus({id:b.id,status:"broadcasting"});try{const p=await m.broadcastTransaction(g);return await kt.updateStatus({id:b.id,status:"broadcasted",txHash:p}),{status:"ok",txHash:p,pendingTxId:b.id}}catch(p){const x=p;return await kt.updateStatus({id:b.id,status:"failed",errorCode:"BROADCAST_FAILED",errorMessage:x.message}),{status:"error",message:x.message,pendingTxId:b.id}}}catch(f){return{status:"error",message:(f instanceof Error?f.message:String(f))||qe("error:transaction.failed")}}}async function Pv({chainConfig:t,walletId:s,password:n,fromAddress:a,newTwoStepSecret:r}){let o;try{o=await vs.getMnemonic(s,n)}catch(i){return i instanceof Qs&&i.code===ys.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:i instanceof Error?i.message:qe("error:unknown")}}const d=Ee(t.id);if(!d.supportsFullTransaction)return{status:"error",message:qe("error:transaction.chainNotSupported")};try{if(d.bioGetAccountInfo&&(await d.bioGetAccountInfo(a)).secondPublicKey)return{status:"already_set"};const i=await d.buildTransaction({type:"setPayPassword",from:a}),l=await d.signTransaction(i,{privateKey:new TextEncoder().encode(o),bioSecret:o,bioNewPaySecret:r});return{status:"ok",txHash:await d.broadcastTransaction(l)}}catch(i){const l=i instanceof Error?i.message:String(i);return l.includes("fee")||l.includes("")?{status:"error",message:qe("error:insufficientFunds")}:{status:"error",message:l||qe("error:transaction.failed")}}}async function Ev(t){const s=Ee(t.id);if(!s.buildTransaction||!s.estimateFee)return null;try{const n=await s.buildTransaction({type:"setPayPassword",from:"0x0000000000000000000000000000000000000000"});return{amount:(await s.estimateFee(n)).standard.amount,symbol:t.symbol}}catch{return null}}async function _v(t,s){const n=Ee(t.id);if(!n.bioGetAccountInfo)return!1;try{return!!(await n.bioGetAccountInfo(s)).secondPublicKey}catch{return!1}}function pe({cancelable:t,onCancel:s,onOutsideClick:n,...a}){const r=t??!!s,o=d=>{if(!r){d.preventDefault();return}if(s){s(),d.preventDefault();return}n?.(d)};return e.jsx(wg,{onOutsideClick:o,...a})}const Ol=Ag;function On({title:t,children:s,className:n}){return e.jsxs("div",{className:D("bg-background rounded-t-2xl",n),children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),t&&e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t})}),s,e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}pe.__docgenInfo={description:"Re-export Stackflow BottomSheet",methods:[],displayName:"BottomSheet",props:{cancelable:{required:!1,tsType:{name:"boolean"},description:`Whether the sheet supports cancel (outside click).
Defaults to true to preserve existing behavior.`},onCancel:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:`Cancel handler invoked when outside click happens.
If provided, it is responsible for closing the sheet (call pop).`}}};On.__docgenInfo={description:"Standard sheet content wrapper with handle, title, and safe area",methods:[],displayName:"SheetContent",props:{title:{required:!1,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};function Mv(t,s=10,n=8){return t.length<=s+n+3?t:`${t.slice(0,s)}...${t.slice(-n)}`}const Bl=()=>{const{t}=B(["home","common"]),{pop:s}=Z(),n=Fe(),a=Je(),r=ss(),o=c.useMemo(()=>n?n.chainAddresses.map(l=>l.chain):[],[n]),d=l=>{ye.setSelectedChain(l),s()},i=()=>{s()};return e.jsx(pe,{onCancel:i,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("home:wallet.selectNetwork")})}),e.jsx("div",{"data-testid":"chain-sheet",className:"max-h-[60vh] space-y-2 overflow-y-auto p-4",children:o.map(l=>{const u=n?.chainAddresses.find(m=>m.chain===l);return e.jsxs("button",{"data-testid":`chain-option-${l}`,onClick:()=>d(l),className:`flex w-full items-center gap-3 rounded-xl p-4 transition-colors ${l===a?"bg-primary/10 ring-1 ring-primary":"bg-muted/50 hover:bg-muted"}`,children:[e.jsx(_t,{chain:l,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:r[l]??l}),e.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:u?.address?Mv(u.address):"---"})]}),l===a&&e.jsx(Ne,{className:"size-5 text-primary"})]},l)})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};Bl.__docgenInfo={description:"",methods:[],displayName:"ChainSelectorJob"};const ao={"/":"MainTabsActivity","/wallet/list":"WalletListActivity","/wallet/create":"WalletCreateActivity","/send":"SendActivity","/receive":"ReceiveActivity","/settings":"SettingsActivity","/settings/language":"SettingsLanguageActivity","/settings/currency":"SettingsCurrencyActivity","/settings/chains":"SettingsChainsActivity","/settings/mnemonic":"SettingsMnemonicActivity","/settings/wallet-lock":"SettingsWalletLockActivity","/settings/wallet-chains":"SettingsWalletChainsActivity","/settings/storage":"SettingsStorageActivity","/settings/sources":"SettingsSourcesActivity","/history":"HistoryActivity","/scanner":"ScannerActivity","/onboarding/recover":"OnboardingRecoverActivity","/address-book":"AddressBookActivity","/my-card":"MyCardActivity","/notifications":"NotificationsActivity","/staking":"StakingActivity","/welcome":"WelcomeActivity"},Rv=[{pattern:/^\/wallet\/([^/]+)$/,activity:"WalletConfigActivity",paramExtractor:t=>({walletId:t[1]??""})},{pattern:/^\/transaction\/([^/]+)$/,activity:"TransactionDetailActivity",paramExtractor:t=>({txId:t[1]??""})},{pattern:/^\/authorize\/address\/([^/]+)$/,activity:"AuthorizeAddressActivity",paramExtractor:t=>({id:t[1]??""})},{pattern:/^\/authorize\/signature\/([^/]+)$/,activity:"AuthorizeSignatureActivity",paramExtractor:t=>({id:t[1]??""})},{pattern:/^\/token\/([^/]+)$/,activity:"TokenDetailActivity",paramExtractor:t=>({tokenId:t[1]??""})}];function Lv(t){if(ao[t])return{activity:ao[t],params:{}};for(const{pattern:s,activity:n,paramExtractor:a}of Rv){const r=t.match(s);if(r)return{activity:n,params:a(r)}}return null}function de(){const t=Z();return{navigate:a=>{const r=typeof a=="string"?{to:a}:a,o=Lv(r.to);if(!o)return;const d={...o.params,...r.search};r.replace?t.replace(o.activity,d,{animate:!0}):t.push(o.activity,d,{animate:!0})},goBack:()=>{t.pop()}}}const Fl=c.createContext({});function me({params:t,children:s}){return e.jsx(Fl.Provider,{value:t,children:s})}function he(){return c.useContext(Fl)}me.__docgenInfo={description:"",methods:[],displayName:"ActivityParamsProvider",props:{params:{required:!0,tsType:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""}}};function Dv(){const{t}=B("wallet"),{pop:s}=Z(),{walletId:n}=he(),r=Rt().find(m=>m.id===n),[o,d]=c.useState(r?.name??"");c.useEffect(()=>{r&&d(r.name)},[r]);const i=c.useCallback(()=>{if(!r)return;const m=o.trim();m&&(ye.updateWalletName(r.id,m),s())},[r,o,s]),l=()=>{s()};if(!r)return null;const u=o.trim().length>0&&o.trim()!==r.name;return e.jsx(pe,{onCancel:l,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("editSheet.renameTitle")})}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"wallet-name",className:"text-sm font-medium",children:t("editSheet.walletName")}),e.jsx("input",{id:"wallet-name",type:"text",value:o,onChange:m=>d(m.target.value),placeholder:t("editSheet.walletNamePlaceholder"),maxLength:20,className:D("w-full rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")}),e.jsxs("p",{className:"text-right text-xs text-muted-foreground",children:[o.length,"/20"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:i,disabled:!u,className:D("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t("editSheet.save")}),e.jsx("button",{onClick:l,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("editSheet.cancel")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Wl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Dv,{})});Wl.__docgenInfo={description:"",methods:[],displayName:"WalletRenameJob"};function zv(){const{t}=B("wallet"),{pop:s}=Z(),{navigate:n}=de(),{walletId:a}=he(),o=Rt().find(b=>b.id===a),[d,i]=c.useState([]),[l,u]=c.useState(!1),[m,f]=c.useState(!1),h=()=>{s()},g=c.useCallback(async b=>{if(!(!o||b.length<4)){if(!o.encryptedMnemonic){ye.deleteWallet(o.id),n({to:"/"});return}f(!0),u(!1);try{const p=Be(b);if(!await Jt(o.encryptedMnemonic,p)){u(!0),i([]);return}ye.deleteWallet(o.id),n({to:"/"})}catch{u(!0),i([])}finally{f(!1)}}},[o,n]);return o?e.jsx(pe,{onCancel:h,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("editSheet.deleteTitle")})}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsx("p",{className:"text-center text-muted-foreground",children:t("editSheet.deleteWarning",{name:o.name})}),e.jsx(ft,{value:d,onChange:i,onComplete:g,minPoints:4,error:l,disabled:m}),e.jsx("div",{className:"space-y-3",children:e.jsx("button",{onClick:h,disabled:m,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("editSheet.cancel")})})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}):null}const $l=({params:t})=>e.jsx(me,{params:t,children:e.jsx(zv,{})});$l.__docgenInfo={description:"",methods:[],displayName:"WalletDeleteJob"};let Bn=null,zr=null;function Cs(t,s){Bn=t,zr=null}function Ov(){Bn=null,zr=null}function Bv(){const{t}=B("security"),{pop:s}=Z(),{title:n,description:a,biometricAvailable:r,miniappName:o,miniappIcon:d,walletName:i,walletAddress:l,walletChainId:u}=he(),[m,f]=c.useState([]),[h,g]=c.useState(!1),[b,p]=c.useState(null),[x,v]=c.useState(!1),j=c.useRef(null),N=c.useRef(null),y=c.useRef(null),S=c.useRef(!1);!S.current&&Bn&&(N.current=Bn,y.current=zr,Ov(),S.current=!0);const k=n??t("patternLock.unlockTitle"),I=r==="true"&&y.current,_=!!(i&&l&&u),A=!!(o||d||_||u),E=c.useCallback(()=>{j.current&&(clearTimeout(j.current),j.current=null),g(!1),p(null)},[]),C=c.useCallback(L=>{h&&L.length>0&&E(),f(L)},[h,E]),T=c.useCallback(async L=>{const z=N.current;if(!(L.length<4||!z)){v(!0),E();try{const R=Be(L);await z(R)?s():(g(!0),p(t("walletLock.error")),f([]),j.current=setTimeout(()=>{g(!1),p(null)},1500))}catch(R){g(!0),p(R instanceof Error?R.message:t("walletLock.error")),f([]),j.current=setTimeout(()=>{g(!1),p(null)},1500)}finally{v(!1)}}},[s,E,t]),w=c.useCallback(async()=>{const L=y.current;if(L){v(!0),E();try{await L()?s():(g(!0),j.current=setTimeout(()=>{g(!1)},1500))}catch{g(!0),j.current=setTimeout(()=>{g(!1)},1500)}finally{v(!1)}}},[s,E]),P=()=>{s()};return e.jsx(pe,{"data-testid":"wallet-lock-dialog",onCancel:P,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),A?e.jsx(Lt,{title:k,description:a,appName:o,appIcon:d,chainId:_?void 0:u,walletInfo:_?{name:i,address:l,chainId:u}:void 0}):e.jsxs("div",{className:"px-4 pb-4 text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:k}),a&&e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:a})]}),e.jsx("div",{className:"px-4 pb-4",children:e.jsx(ft,{value:m,onChange:C,onComplete:T,minPoints:4,error:h,errorText:b??void 0,disabled:x,"data-testid":"wallet-lock-pattern"})}),e.jsxs("div",{className:"space-y-3 px-4 pb-4",children:[I&&e.jsxs("button",{type:"button",onClick:w,disabled:x,className:D("flex w-full items-center justify-center gap-2 rounded-full border border-border py-3 font-medium transition-colors","hover:bg-muted","disabled:cursor-not-allowed disabled:opacity-50"),children:[e.jsx(Pp,{className:"size-5"}),e.jsx("span",{children:t("walletLock.biometric")})]}),e.jsx("button",{type:"button",onClick:P,disabled:x,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("walletLock.cancel")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const ql=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Bv,{})});ql.__docgenInfo={description:"",methods:[],displayName:"WalletLockConfirmJob"};let Fv=null;function Wv(){const{t}=B(["security","transaction","common"]),{pop:s}=Z(),{title:n,description:a}=he(),[r,o]=c.useState(""),[d,i]=c.useState(),[l,u]=c.useState(!1),m=c.useRef(null);c.useRef(!1).current;const h=n??t("security:twoStepSecret.confirmTitle"),g=a??t("security:twoStepSecret.confirmDesc"),b=c.useCallback(async v=>{v.preventDefault();const j=m.current;if(!(!r.trim()||!j)){u(!0),i(void 0);try{await j(r)?s():i(t("security:twoStepSecret.notMatch"))}catch{i(t("security:twoStepSecret.notMatch"))}finally{u(!1)}}},[r,s,t]),p=r.trim().length>0&&!l,x=()=>{s()};return e.jsx(pe,{"data-testid":"two-step-secret-dialog",onCancel:x,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(tn,{className:"size-5 text-primary"}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:h})]})}),e.jsxs("form",{onSubmit:b,className:"space-y-6 p-4",children:[e.jsx("p",{className:"text-center text-muted-foreground text-sm",children:g}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(bs,{value:r,onChange:v=>o(v.target.value),placeholder:t("security:twoStepSecret.inputPlaceholder"),disabled:l,"aria-describedby":d?"two-step-secret-error":void 0,"data-testid":"two-step-secret-input"}),d&&e.jsxs("div",{id:"two-step-secret-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(Mt,{className:"size-4"}),e.jsx("span",{children:d})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{type:"submit",disabled:!p,"data-testid":"two-step-secret-confirm-button",className:D("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(l?"security:walletLock.verifying":"common:confirm")}),e.jsx("button",{type:"button",onClick:x,disabled:l,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("security:walletLock.cancel")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Hl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Wv,{})});Hl.__docgenInfo={description:"",methods:[],displayName:"TwoStepSecretConfirmJob"};let Ls=null,Fn=null;function Ul(t,s){Ls=t,Fn=s}function ro(){Ls=null,Fn=null}function $v(){const{t}=B(["transaction","common"]),{pop:s}=Z();he();const n=c.useRef(Ls),a=c.useRef(Fn),r=c.useRef(!1);!r.current&&Ls&&(n.current=Ls,a.current=Fn,ro(),r.current=!0);const o=n.current,[d,i]=c.useState(o?.currentFee??""),[l,u]=c.useState();c.useEffect(()=>()=>{ro()},[]);const m=c.useCallback(v=>{if(!o)return;const j=parseFloat(v),N=parseFloat(o.minFee);if(isNaN(j)||j<=0)return t("transaction:feeEdit.invalidFee");if(j<N)return t("transaction:feeEdit.belowMinFee",{minFee:o.minFee,symbol:o.symbol})},[o,t]),f=c.useCallback(v=>{const j=v.target.value;(j===""||/^\d*\.?\d*$/.test(j))&&(i(j),u(void 0))},[]),h=c.useCallback(v=>{i(v),u(void 0)},[]),g=c.useCallback(v=>{v.preventDefault();const j=m(d);if(j){u(j);return}a.current?.({fee:d}),s()},[d,m,s]),b=c.useCallback(()=>{s()},[s]);if(!o)return null;const p=[{label:t("transaction:feeEdit.presetMin"),value:o.minFee}],x=o.presets??p;return e.jsx(Ol,{children:e.jsxs("div",{className:"bg-background rounded-2xl p-4","data-testid":"fee-edit-modal",children:[e.jsx("h2",{className:"mb-4 text-center text-lg font-semibold",children:t("transaction:feeEdit.title")}),e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 text-sm text-muted-foreground",children:[e.jsxs("p",{children:[t("transaction:feeEdit.currentFee"),": ",o.currentFee," ",o.symbol]}),e.jsxs("p",{children:[t("transaction:feeEdit.minFee"),": ",o.minFee," ",o.symbol]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:x.map(v=>e.jsx("button",{type:"button",onClick:()=>h(v.value),className:D("rounded-full px-3 py-1 text-sm transition-colors",d===v.value?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:v.label},v.value))}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("transaction:feeEdit.customFee")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{type:"text",inputMode:"decimal",value:d,onChange:f,placeholder:o.minFee,className:D(l&&"border-destructive"),"data-testid":"fee-input"}),e.jsx("span",{className:"shrink-0 text-sm text-muted-foreground",children:o.symbol})]}),l&&e.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(Mt,{className:"size-4"}),e.jsx("span",{children:l})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(V,{type:"button",variant:"outline",onClick:b,className:"flex-1",children:t("common:cancel")}),e.jsx(V,{type:"submit",className:"flex-1",disabled:!d,children:t("common:confirm")})]})]})]})})}const Vl=({params:t})=>e.jsx(me,{params:t,children:e.jsx($v,{})});Vl.__docgenInfo={description:"",methods:[],displayName:"FeeEditJob"};let Ds=null,Wn=null,$n=null,qn="";function qv(t,s,n){Ds=t,Wn=n??null,s&&($n=s.amount,qn=s.symbol)}function Hv(){Ds=null,Wn=null,$n=null,qn=""}function Uv(){const{t}=B(["security","transaction","common"]),{pop:s,push:n}=Z(),{chainId:a,chainIcon:r,chainSymbol:o,address:d,chainName:i}=he(),[l,u]=c.useState(""),[m,f]=c.useState(""),[h,g]=c.useState([]),[b,p]=c.useState(!1),[x,v]=c.useState("input"),[j,N]=c.useState(),[y,S]=c.useState(!1),[k,I]=c.useState("idle"),[_,A]=c.useState(),[E,C]=c.useState(null),T=c.useRef(Ds),w=c.useRef(Wn),P=c.useRef({amount:$n,symbol:qn}),L=E??P.current.amount?.toDisplayString()??"0";c.useEffect(()=>(Ds&&!T.current&&(T.current=Ds,w.current=Wn,P.current={amount:$n,symbol:qn}),()=>{Hv()}),[]);const z=c.useCallback(()=>{const F=P.current.amount?.toDisplayString()??"0";Ul({currentFee:L,minFee:F,symbol:P.current.symbol},K=>{C(K.fee)}),n("FeeEditJob",{})},[L,n]),R=c.useCallback(()=>{if(N(void 0),x==="input"){if(!l.trim())return;v("confirm")}else if(x==="confirm"){if(l!==m){N(t("security:twoStepSecret.notMatch"));return}v("walletLock")}},[x,l,m,t]),q=c.useCallback(()=>{x==="input"?s():x==="confirm"?(v("input"),N(void 0)):(v("confirm"),N(void 0),p(!1),g([]))},[x,s]),M=c.useCallback(async F=>{const K=T.current;if(F.length<4||!K)return;S(!0),I("broadcasting"),N(void 0),p(!1);const ee=Be(F);try{const W=await K(l,ee);W.success?(A(W.txHash),I("broadcasted")):(I("idle"),p(!0),g([]),N(W.error??t("security:twoStepSecret.setFailed")))}catch{I("idle"),p(!0),g([]),N(t("security:twoStepSecret.setFailed"))}finally{S(!1)}},[l,t]);return k!=="idle"?e.jsx(pe,{onCancel:q,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx(Qo,{status:k,txHash:_,title:{confirmed:t("security:twoStepSecret.txConfirmed")},description:{confirmed:t("security:twoStepSecret.setSuccessDesc")},checkConfirmed:w.current??void 0,onStatusChange:I,onDone:()=>s()}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}):e.jsx(pe,{onCancel:q,children:e.jsxs("div",{className:"bg-background rounded-t-2xl","data-testid":"set-two-step-secret-dialog",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsxs("div",{className:"border-b border-border px-4 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(tn,{className:"size-5 text-primary"}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("security:twoStepSecret.setTitle")})]}),a&&d?e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(ar,{chainId:a,chainIcon:r,chainSymbol:o,address:d,size:"sm"})}):i?e.jsx("p",{className:"mt-1 text-center text-sm text-muted-foreground",children:i}):null]}),e.jsxs("div",{className:"space-y-6 p-4",children:[P.current.amount&&e.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-muted/50 p-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:t("security:twoStepSecret.feeInfo")}),e.jsx(or,{amount:L,symbol:P.current.symbol,editable:!0,onEdit:z})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:D("size-2 rounded-full",x==="input"?"bg-primary":"bg-muted")}),e.jsx("div",{className:D("size-2 rounded-full",x==="confirm"?"bg-primary":"bg-muted")}),e.jsx("div",{className:D("size-2 rounded-full",x==="walletLock"?"bg-primary":"bg-muted")})]}),x==="input"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:t("security:twoStepSecret.inputDesc")}),e.jsx(bs,{value:l,onChange:F=>u(F.target.value),placeholder:t("security:twoStepSecret.inputPlaceholder"),"aria-describedby":j?"two-step-secret-error":void 0,"data-testid":"new-two-step-secret-input"})]}),x==="confirm"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:t("security:twoStepSecret.confirmDesc")}),e.jsx(bs,{value:m,onChange:F=>f(F.target.value),placeholder:t("security:twoStepSecret.confirmPlaceholder"),"aria-describedby":j?"two-step-secret-error":void 0,"data-testid":"confirm-two-step-secret-input"})]}),x==="walletLock"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:t("security:twoStepSecret.walletLockDesc")}),e.jsx(ft,{value:h,onChange:g,onComplete:M,minPoints:4,error:b,disabled:y,"data-testid":"wallet-lock-pattern"})]}),j&&e.jsxs("div",{id:"two-step-secret-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(Mt,{className:"size-4"}),e.jsx("span",{children:j})]}),e.jsxs("div",{className:"space-y-3",children:[x!=="walletLock"&&e.jsx("button",{type:"button",onClick:R,"data-testid":"set-two-step-secret-next-button",className:D("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90"),children:t("common:next")}),e.jsx("button",{type:"button",onClick:q,disabled:y,"data-testid":"set-two-step-secret-cancel-button",className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t(x==="input"?"common:cancel":"common:back")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Jl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Uv,{})});Jl.__docgenInfo={description:"",methods:[],displayName:"SetTwoStepSecretJob"};let qa=null;function Vv(){qa=null}const Jv=[{value:"english",label:"English"},{value:"zh-Hans",label:""},{value:"zh-Hant",label:""}],Kv=[12,15,18,21,24,36];function Gv(){const{t}=B("onboarding"),{pop:s}=Z(),{language:n,length:a}=he(),[r,o]=c.useState({language:n||"english",length:Number(a)||12}),d=m=>{o(f=>({...f,language:m}))},i=m=>{o(f=>({...f,length:m}))},l=()=>{qa&&qa(r),Vv(),s()},u=()=>{s()};return e.jsx(pe,{onCancel:u,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx("div",{className:"border-border border-b px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("create.mnemonicOptions.title")})}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:t("create.mnemonicOptions.language")}),e.jsx("div",{className:"space-y-1",role:"radiogroup",children:Jv.map(m=>e.jsxs("button",{type:"button",role:"radio","aria-checked":r.language===m.value,onClick:()=>d(m.value),className:D("flex w-full items-center justify-between rounded-lg px-4 py-3","hover:bg-muted/50 transition-colors",r.language===m.value&&"bg-muted"),children:[e.jsx("span",{className:"text-sm",children:m.label}),r.language===m.value&&e.jsx(Ne,{className:"text-primary size-5"})]},m.value))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:t("create.mnemonicOptions.wordCount")}),e.jsx("div",{className:"grid grid-cols-3 gap-2",role:"radiogroup",children:Kv.map(m=>e.jsxs("button",{type:"button",role:"radio","aria-checked":r.length===m,onClick:()=>i(m),className:D("flex items-center justify-center rounded-lg py-3 text-sm font-medium","transition-colors",r.length===m?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:[m," ",t("create.mnemonicOptions.words")]},m))})]}),e.jsx("button",{type:"button",onClick:l,className:D("text-primary-foreground w-full rounded-full py-3 font-medium transition-colors","bg-primary hover:bg-primary/90"),children:t("create.mnemonicOptions.confirm")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Kl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Gv,{})});Kl.__docgenInfo={description:"",methods:[],displayName:"MnemonicOptionsJob"};const ja=3,Qv=10;function Xv(){const{t}=B("common"),{pop:s}=Z(),{contactId:n}=he(),a=Ie(Os,C=>C.contacts),r=n?a.find(C=>C.id===n):null,[o,d]=c.useState(""),[i,l]=c.useState([{id:crypto.randomUUID(),label:"",address:""}]),[u,m]=c.useState(""),[f,h]=c.useState(()=>Math.floor(Math.random()*1e4)),[g,b]=c.useState(!1),p=!!r;c.useEffect(()=>{r&&(d(r.name),l(r.addresses.length>0?r.addresses.map(C=>({id:C.id,label:C.label||"",address:C.address})):[{id:crypto.randomUUID(),label:"",address:""}]),m(r.memo??""),b(!1))},[r]);const x=c.useCallback(()=>{h(Math.floor(Math.random()*1e4)),b(!0)},[]),v=i.find(C=>C.address.trim())?.address.trim(),j=!p||g?v?Kt(v,f):void 0:r?.avatar||(v?Kt(v,f):void 0),N=c.useCallback(()=>{i.length>=ja||l(C=>[...C,{id:crypto.randomUUID(),label:"",address:""}])},[i.length]),y=c.useCallback(C=>{l(T=>T.length<=1?T:T.filter(w=>w.id!==C))},[]),S=c.useCallback((C,T,w)=>{l(P=>P.map(L=>L.id===C?{...L,[T]:w}:L))},[]),k=c.useCallback(()=>{const C=o.trim(),T=u.trim(),w=i.filter(L=>L.address.trim()).map((L,z)=>({id:L.id,address:L.address.trim(),label:L.label.trim()||void 0,isDefault:z===0}));if(!C||w.length===0)return;const P=!p||g?w[0]?Kt(w[0].address,f):void 0:r?.avatar;p&&r?Bs.updateContact(r.id,{name:C,avatar:P,addresses:w,memo:T||void 0}):Bs.addContact({name:C,addresses:w,avatar:P,memo:T||void 0}),s()},[o,i,u,f,p,r,s]),I=i.some(C=>C.address.trim()),_=o.trim().length>0&&I,A=i.length<ja,E=()=>{s()};return e.jsx(pe,{onCancel:E,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t(p?"contact.editTitle":"contact.addTitle")})}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:x,disabled:!v,className:"group relative shrink-0",title:t("addressBook.changeAvatar"),children:[e.jsx(Ns,{src:j,size:56}),v&&e.jsx("div",{className:"bg-background/80 absolute inset-0 flex items-center justify-center rounded-full opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx(rs,{className:"text-primary size-5"})})]}),e.jsx("input",{id:"contact-name",type:"text",value:o,onChange:C=>d(C.target.value),placeholder:t("contact.namePlaceholder"),maxLength:20,className:D("flex-1 rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:t("contact.addresses")}),e.jsx("span",{className:"text-muted-foreground text-xs",children:t("contact.addressCount",{count:i.length,max:ja})})]}),i.map((C,T)=>e.jsxs("div",{className:"space-y-2 rounded-xl border border-border p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:C.label,onChange:w=>S(C.id,"label",w.target.value),placeholder:t("contact.addressLabelPlaceholder"),maxLength:Qv,className:D("w-24 shrink-0 rounded-lg border border-border bg-muted/50 px-3 py-2 text-sm","focus:outline-none focus:ring-2 focus:ring-primary")}),i.length>1&&e.jsx("button",{type:"button",onClick:()=>y(C.id),className:"text-muted-foreground hover:text-destructive shrink-0 p-1",children:e.jsx(ns,{className:"size-4"})}),T===0&&e.jsx("span",{className:"bg-primary/10 text-primary rounded px-1.5 py-0.5 text-xs",children:t("contact.defaultLabel")})]}),e.jsx("input",{type:"text",value:C.address,onChange:w=>S(C.id,"address",w.target.value),placeholder:t("contact.addressPlaceholder"),className:D("w-full rounded-lg border border-border bg-background px-3 py-2 font-mono text-sm","focus:outline-none focus:ring-2 focus:ring-primary")})]},C.id)),A&&e.jsxs("button",{type:"button",onClick:N,className:"flex w-full items-center justify-center gap-2 rounded-xl border border-dashed border-border py-3 text-sm text-muted-foreground hover:border-primary hover:text-primary",children:[e.jsx(mt,{className:"size-4"}),t("contact.addAddress")]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"contact-memo",className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(Ho,{className:"size-4"}),t("contact.memoOptional")]}),e.jsx("textarea",{id:"contact-memo",value:u,onChange:C=>m(C.target.value),placeholder:t("contact.memoPlaceholder"),maxLength:100,rows:2,className:D("w-full resize-none rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")})]}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsx("button",{onClick:k,disabled:!_,className:D("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(p?"contact.save":"contact.add")}),e.jsx("button",{onClick:E,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("contact.cancel")})]})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Gl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Xv,{})});Gl.__docgenInfo={description:"",methods:[],displayName:"ContactEditJob"};function Yv(t,s=8,n=6){return t.length<=s+n+3?t:`${t.slice(0,s)}...${t.slice(-n)}`}function Zv(){const{t}=B("common"),{pop:s}=Z(),{chainType:n}=he(),a=n,[r,o]=c.useState(""),d=Ie(Os),i=c.useMemo(()=>{let m=d.contacts;return r&&(m=er.searchContacts(d,r)),m=[...m].toSorted((f,h)=>h.updatedAt-f.updatedAt),m.map(f=>{const h=f.addresses.map(b=>({...b,isValidForCurrentChain:a?kf(b.address,a):!0})),g=h.some(b=>b.isValidForCurrentChain);return{contact:f,addresses:h,hasValidAddress:g}})},[d,r,a]),l=(m,f)=>{const h=new CustomEvent("contact-picker-select",{detail:{contact:m,address:f}});window.dispatchEvent(h),s()},u=()=>{s()};return e.jsx(pe,{onCancel:u,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx("div",{className:"border-border border-b px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("contact.selectAddress")})}),e.jsx("div",{className:"border-border border-b p-4",children:e.jsxs("div",{className:"bg-muted/50 flex items-center gap-2 rounded-xl px-3 py-2",children:[e.jsx(sn,{className:"text-muted-foreground size-4"}),e.jsx("input",{type:"text",value:r,onChange:m=>o(m.target.value),placeholder:t("addressBook.searchPlaceholder"),className:"placeholder:text-muted-foreground min-w-0 flex-1 bg-transparent text-sm outline-none"})]})}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto",children:i.length===0?e.jsx("div",{className:"text-muted-foreground py-12 text-center text-sm",children:t(r?"addressBook.noResults":"contact.noContacts")}):e.jsx("div",{className:"divide-border divide-y",children:i.map(({contact:m,addresses:f,hasValidAddress:h})=>e.jsxs("div",{className:D(!h&&"opacity-50"),children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 pt-3 pb-2",children:[e.jsx(Ns,{src:m.avatar||(f[0]?.address?Kt(f[0].address):void 0),size:40,className:"shrink-0"}),e.jsx("p",{className:"min-w-0 flex-1 truncate font-medium",children:m.name})]}),e.jsx("div",{className:"space-y-1 pb-3 pl-[56px] pr-4",children:f.map(g=>{const b=!g.isValidForCurrentChain,p=g.label;return e.jsxs("button",{onClick:()=>!b&&l(m,g),disabled:b,className:D("flex min-h-[44px] w-full items-center gap-3 rounded-xl px-3 py-2.5 transition-colors",b?"cursor-not-allowed opacity-50":"hover:bg-muted/50 active:bg-muted"),children:[e.jsx("p",{className:D("min-w-0 flex-1 truncate text-left font-mono text-sm",b?"text-muted-foreground/50":"text-foreground"),children:Yv(g.address)}),e.jsxs("div",{className:"flex shrink-0 items-center gap-2",children:[p&&e.jsx("span",{className:D("max-w-[5rem] truncate rounded-md bg-muted px-2 py-0.5 text-xs",b?"text-muted-foreground/50":"text-muted-foreground"),children:p}),g.isDefault&&e.jsx("span",{className:"bg-primary/10 text-primary rounded-md px-2 py-0.5 text-xs",children:t("contact.defaultLabel")})]})]},g.id)})})]},m.id))})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Ql=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Zv,{})});Ql.__docgenInfo={description:"",methods:[],displayName:"ContactPickerJob"};const Xl=()=>{const{t}=B(["wallet","home"]),{pop:s}=Z(),{navigate:n}=de(),a=()=>{s(),n({to:"/wallet/create"})},r=()=>{s(),n({to:"/onboarding/recover"})},o=()=>{s()};return e.jsx(pe,{onCancel:o,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("wallet:add")})}),e.jsxs("div",{className:"space-y-3 p-4",children:[e.jsxs("button",{onClick:a,className:D("flex w-full items-center gap-4 rounded-xl p-4 transition-colors","bg-muted/50 hover:bg-muted active:bg-muted/80"),children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10",children:e.jsx(mt,{className:"size-6 text-primary"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-semibold",children:t("home:welcome.createWallet")}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t("wallet:createDesc")})]})]}),e.jsxs("button",{onClick:r,className:D("flex w-full items-center gap-4 rounded-xl p-4 transition-colors","bg-muted/50 hover:bg-muted active:bg-muted/80"),children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10",children:e.jsx(nn,{className:"size-6 text-primary"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-semibold",children:t("home:welcome.importWallet")}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t("wallet:importDesc")})]})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};Xl.__docgenInfo={description:"",methods:[],displayName:"WalletAddJob"};const Yl=()=>{const{t}=B(["wallet","common"]),{pop:s,push:n}=Z(),a=Rt(),o=Fe()?.id,{getWalletTheme:d}=Lo(),i=Do(),l=f=>{ye.setCurrentWallet(f),s()},u=()=>{s(),n("WalletAddJob",{})},m=()=>{s()};return e.jsx(pe,{onCancel:m,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("common:a11y.tabWallet")})}),e.jsx("div",{className:"max-h-[50vh] space-y-2 overflow-y-auto p-4",children:a.map(f=>{const h=f.id===o,g=f.chainAddresses[0]?.address,b=g?`${g.slice(0,6)}...${g.slice(-4)}`:"---",p=d(f.id);return e.jsxs("button",{onClick:()=>l(f.id),className:D("flex w-full items-center gap-3 rounded-xl p-4 transition-all","active:scale-[0.98]",h?"bg-primary/10 ring-2 ring-primary":"bg-muted/50 hover:bg-muted"),children:[e.jsx(Sf,{themeHue:p,size:"md",watermarkIconUrl:i[f.chain]}),e.jsxs("div",{className:"min-w-0 flex-1 text-left",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate font-medium",children:f.name}),h&&e.jsx(If,{className:"size-4 shrink-0 text-primary"})]}),e.jsx("p",{className:"truncate font-mono text-xs text-muted-foreground",children:b})]})]},f.id)})}),e.jsx("div",{className:"border-t border-border p-4",children:e.jsxs("button",{onClick:u,className:D("flex w-full items-center justify-center gap-2 rounded-xl p-4","bg-muted/50 hover:bg-muted active:bg-muted/80 transition-colors"),children:[e.jsx(mt,{className:"size-5"}),e.jsx("span",{className:"font-medium",children:t("wallet:add")})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};Yl.__docgenInfo={description:"",methods:[],displayName:"WalletListJob"};let Ha=null;function ey(t){Ha=t}const Zl=()=>{const{t}=B(["onboarding","common"]),{pop:s}=Z(),[n,a]=c.useState(!1),r=()=>{s()},o=()=>{n&&(s(),Ha?.(),Ha=null)};return e.jsx(Ol,{children:e.jsxs("div",{className:"bg-background mx-4 max-w-sm rounded-2xl p-5",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"rounded-full bg-amber-500/15 p-2",children:e.jsx(Oe,{className:"size-5 text-amber-600","aria-hidden":"true"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h2",{className:"text-base font-semibold",children:t("onboarding:securityWarning.title")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:t("onboarding:securityWarning.message")})]})]}),e.jsxs("label",{className:"mt-4 flex cursor-pointer items-center gap-2 text-sm",children:[e.jsx(Xo,{checked:n,onCheckedChange:a}),e.jsx("span",{children:t("onboarding:securityWarning.acknowledge")})]}),e.jsxs("div",{className:"mt-5 flex gap-2",children:[e.jsx(V,{type:"button",variant:"outline",className:"flex-1",onClick:r,children:t("common:cancel")}),e.jsx(V,{type:"button",className:"flex-1",onClick:o,disabled:!n,children:t("common:confirm")})]})]})})};Zl.__docgenInfo={description:"",methods:[],displayName:"SecurityWarningJob"};let zs=null;function ed(t,s){zs={onConfirm:t,minFee:s?.minFee,onFeeChange:s?.onFeeChange}}function io(){zs=null}function ty(t){return t.length<=16?t:`${t.slice(0,10)}...${t.slice(-6)}`}function sy(){const{t}=B("transaction"),{pop:s,push:n}=Z(),a=he(),[r,o]=c.useState(!1),[d,i]=c.useState(!1),[l,u]=c.useState(!1),[m,f]=c.useState(null),h=c.useRef(zs),g=c.useRef(!1);!g.current&&zs&&(h.current=zs,io(),g.current=!0),c.useEffect(()=>()=>{io()},[]);const b=a.feeLoading==="true",p=a.feeFiatValue?parseFloat(a.feeFiatValue):void 0,x=m??a.feeAmount,v=!!h.current?.onFeeChange,j=c.useCallback(async()=>{try{await rr.write({text:a.toAddress}),i(!0),setTimeout(()=>i(!1),2e3)}catch{}},[a.toAddress]),N=c.useCallback(()=>{o(I=>!I)},[]),y=c.useCallback(()=>{const I=h.current;I?.onFeeChange&&(Ul({currentFee:x,minFee:I.minFee??a.feeAmount,symbol:a.feeSymbol},_=>{f(_.fee),I.onFeeChange?.(_.fee)}),n("FeeEditJob",{}))},[x,a.feeAmount,a.feeSymbol,n]),S=c.useCallback(async()=>{const I=h.current;if(!(!I?.onConfirm||l)){u(!0);try{s(),await I.onConfirm()}finally{u(!1)}}},[l,s]),k=c.useCallback(()=>{s()},[s]);return e.jsx(pe,{"data-testid":"transfer-confirm-sheet",onCancel:k,children:e.jsx(On,{title:t("confirmSheet.title"),children:e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-3xl font-bold",children:[a.amount," ",a.symbol]}),a.fiatValue&&e.jsxs("p",{className:"text-muted-foreground mt-1",children:[" $",a.fiatValue]})]}),e.jsxs("div",{className:"bg-muted/30 space-y-4 rounded-xl p-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:t("confirmSheet.toAddress")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:N,className:"hover:text-primary flex min-w-0 flex-1 items-center gap-1 text-left font-mono text-sm",children:[e.jsx("span",{className:D("min-w-0",r?"break-all":"truncate"),children:r?a.toAddress:ty(a.toAddress)}),r?e.jsx(Yo,{className:"size-4 shrink-0"}):e.jsx(ec,{className:"size-4 shrink-0"})]}),e.jsx("button",{type:"button",onClick:j,className:"text-muted-foreground hover:text-foreground shrink-0 p-1","aria-label":t(d?"confirmSheet.copied":"confirmSheet.copyAddress"),children:d?e.jsx(Ne,{className:"size-4 text-green-500"}):e.jsx(Fo,{className:"size-4"})})]})]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:t("confirmSheet.networkFee")}),e.jsx(or,{amount:x,symbol:a.feeSymbol,...p!==void 0&&{fiatValue:p},isLoading:b,editable:v,onEdit:y})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button","data-testid":"cancel-transfer-button",onClick:k,className:"border-border hover:bg-muted flex-1 rounded-full border py-3 font-medium transition-colors",disabled:l,children:t("confirmSheet.cancel")}),e.jsx("button",{type:"button","data-testid":"confirm-transfer-button",onClick:S,disabled:l||b,className:D("flex-1 rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(l?"confirmSheet.confirming":"confirmSheet.confirm")})]})]})})})}const td=({params:t})=>e.jsx(me,{params:t,children:e.jsx(sy,{})});td.__docgenInfo={description:"",methods:[],displayName:"TransferConfirmJob"};let Hn=null;function sd(t){Hn=t}function ny(){Hn=null}function ay(){const{t}=B(["security","transaction","common"]),{pop:s,push:n}=Z(),{title:a}=he(),r=vr(),o=nt(),d=Je(),i=ut(),l=Fe(),[u,m]=c.useState("wallet_lock"),[f,h]=c.useState([]),[g,b]=c.useState(""),[p,x]=c.useState("idle"),[v,j]=c.useState(),[N,y]=c.useState(),[S,k]=c.useState(!1),[I,_]=c.useState(!1),[A,E]=c.useState(),[C,T]=c.useState(null),w=c.useRef(null),P=c.useRef(""),L=c.useRef(!1);!L.current&&Hn&&(w.current=Hn,ny(),L.current=!0),c.useEffect(()=>{if(!v||!d||!l?.address)return;const ne=Ee(d);return ne?.transaction?ne.transaction.subscribe({txHash:v,senderId:l.address},se=>{se&&(se.status==="confirmed"?x("confirmed"):se.status==="failed"?x("failed"):se.status==="pending"&&x("broadcasted"))}):void 0},[v,d,l?.address]),c.useEffect(()=>{if(p!=="confirmed"){T(null);return}T(5);const ne=setInterval(()=>{T(ae=>ae===null||ae<=1?(clearInterval(ne),s(),null):ae-1)},1e3);return()=>clearInterval(ne)},[p,s]);const z=c.useMemo(()=>He.getChainById(i,d),[i,d]),R=c.useMemo(()=>{const ne=z?.explorer?.queryTx;return!ne||!v?null:ne.replace(":hash",v).replace(":signature",v)},[z?.explorer?.queryTx,v]),q=c.useCallback(()=>{R&&window.open(R,"_blank","noopener,noreferrer")},[R]),M=u==="wallet_lock"?a??t("security:walletLock.verifyTitle"):t("transaction:sendPage.twoStepSecretTitle"),F=c.useCallback(async ne=>{const ae=w.current;if(ne.length<4||!ae)return;_(!0),y(void 0),k(!1),x("broadcasting");const se=Be(ne);P.current=se;try{const H=await ae(se);if(H.status==="ok"){H.txHash&&j(H.txHash),H.pendingTxId&&E(H.pendingTxId),x("broadcasted");return}if(H.status==="wallet_lock_invalid"){k(!0),h([]),x("idle");return}if(H.status==="two_step_secret_required"){m("two_step_secret"),y(void 0),x("idle");return}if(H.status==="error"){y(H.message??t("transaction:broadcast.unknown")),x("failed"),H.pendingTxId&&E(H.pendingTxId);return}}catch(H){y(H instanceof Error?H.message:t("transaction:broadcast.unknown")),x("failed")}finally{_(!1)}},[t]),K=c.useCallback(async()=>{const ne=w.current;if(!(!g.trim()||!ne)){_(!0),y(void 0);try{const ae=await ne(P.current,g);if(ae.status==="ok"){ae.txHash&&j(ae.txHash),ae.pendingTxId&&E(ae.pendingTxId),x("broadcasted");return}(ae.status==="two_step_secret_invalid"||ae.status==="error")&&(y(ae.message??t("transaction:sendPage.twoStepSecretError")),ae.pendingTxId&&(E(ae.pendingTxId),x("failed")))}catch{y(t("transaction:sendPage.twoStepSecretError"))}finally{_(!1)}}},[g,t]),ee=c.useCallback(ne=>{ne.preventDefault(),u==="two_step_secret"&&K()},[u,K]),W=g.trim().length>0&&!I,$=c.useCallback(async()=>{if(A){_(!0),y(void 0);try{await jm.retryBroadcast(A,i),x("broadcasted")}catch(ne){y(ne instanceof Error?ne.message:t("transaction:broadcast.unknown"))}finally{_(!1)}}},[A,i,t]),ie=c.useCallback(()=>{s()},[s]);if(p!=="idle"){const ne=p==="failed",ae=p==="confirmed";return e.jsx(pe,{onCancel:ie,children:e.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx(Qo,{status:p,txHash:v,title:{broadcasted:t("transaction:txStatus.broadcasted"),confirmed:t("transaction:sendResult.success"),failed:t("transaction:txStatus.failed")},description:{broadcasted:t("transaction:txStatus.broadcastedDesc"),confirmed:C!==null?t("transaction:txStatus.autoCloseIn",{seconds:C}):t("transaction:txStatus.confirmedDesc"),failed:N},onStatusChange:x,onDone:()=>s(),onViewDetails:()=>{s(),v&&n("TransactionDetailActivity",{txId:v})},onViewExplorer:R?q:void 0,onShare:async()=>{v&&(await r.write({text:v}),o.show(t("common:copied")))}}),e.jsxs("div",{className:"px-4 pb-4 space-y-2",children:[ne&&e.jsxs("button",{type:"button",onClick:$,disabled:I,className:D("w-full flex items-center justify-center gap-2 rounded-full py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:[e.jsx(rs,{className:"size-4"}),t(I?"common:retrying":"transaction:pendingTx.retry")]}),e.jsx("button",{type:"button",onClick:ie,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:ae&&C!==null?t("transaction:txStatus.closeIn",{seconds:C}):t("common:close")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})})}return u==="wallet_lock"?e.jsx(pe,{onCancel:ie,children:e.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:e.jsx(On,{title:M,children:e.jsxs("div",{className:"p-4",children:[e.jsx(ft,{value:f,onChange:h,onComplete:F,minPoints:4,error:S,disabled:I,"data-testid":"transfer-wallet-lock-pattern"}),N&&e.jsxs("div",{className:"flex items-start justify-center gap-1.5 text-sm text-destructive mt-3",children:[e.jsx(Mt,{className:"size-4 shrink-0 mt-0.5"}),e.jsx("pre",{className:"overflow-auto whitespace-break-spaces",children:N})]}),e.jsx("button",{type:"button",onClick:ie,disabled:I,className:"mt-4 w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("common:cancel")})]})})})}):e.jsx(pe,{onCancel:ie,children:e.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:e.jsx(On,{title:M,children:e.jsxs("form",{onSubmit:ee,className:"space-y-6 p-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-primary mb-2",children:[e.jsx(tn,{className:"size-5"}),e.jsx("span",{className:"text-sm",children:t("transaction:sendPage.twoStepSecretDescription")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(bs,{value:g,onChange:ne=>b(ne.target.value),placeholder:t("transaction:sendPage.twoStepSecretPlaceholder"),disabled:I,"aria-describedby":N?"two-step-error":void 0,"data-testid":"two-step-secret-input"}),g.length>0&&g.length<6&&e.jsx("div",{className:"absolute right-10 top-1/2 -translate-y-1/2",children:e.jsx("span",{className:"text-xs text-amber-500",children:t("security:twoStepSecret.lengthHint",{count:g.length})})})]}),N&&e.jsxs("div",{id:"two-step-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(Mt,{className:"size-4"}),e.jsx("span",{children:N})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{type:"submit","data-testid":"two-step-confirm-button",disabled:!W,className:D("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(I?"common:verifying":"common:confirm")}),e.jsx("button",{type:"button",onClick:()=>s(),disabled:I,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("common:cancel")})]})]})})})})}const nd=({params:t})=>e.jsx(me,{params:t,children:e.jsx(ay,{})});nd.__docgenInfo={description:"",methods:[],displayName:"TransferWalletLockJob"};const ry=150;function iy(){const{t}=B("scanner"),{pop:s}=Z(),n=Nc(),{chainType:a,title:r,hint:o}=he(),d=c.useRef(null),i=c.useRef(null),l=c.useRef(null),u=c.useRef(null),m=c.useRef(!1),f=c.useRef(!1),h=c.useRef(!1),[g,b]=c.useState(!1),[p,x]=c.useState(!1),[v,j]=c.useState(null),[N,y]=c.useState(null),S=Pf(a),k=c.useCallback(w=>{if(w===N)return;y(w);const P=tc(w),L=S(w,P);if(L===!0){j({type:"success",text:t("scanSuccess")}),"vibrate"in navigator&&navigator.vibrate(100),m.current=!1;const z=Ef();setTimeout(()=>{s(),setTimeout(()=>{z?.({content:w,parsed:P})},100)},300)}else j({type:"error",text:t(L,{defaultValue:L})}),setTimeout(()=>{j(null),y(null)},3e3)},[N,S,t,s]),I=c.useCallback(()=>{if(m.current)return;m.current=!0,i.current||(i.current=document.createElement("canvas"));const w=async()=>{if(!(!m.current||!d.current||!u.current)){try{const P=await u.current.scanFromVideo(d.current,i.current??void 0);P&&k(P.content)}catch{}m.current&&setTimeout(w,ry)}};w()},[k]),_=c.useCallback(()=>{m.current=!1,l.current&&(l.current.getTracks().forEach(w=>w.stop()),l.current=null),b(!1)},[]),A=c.useCallback(async()=>{if(!h.current){if(h.current=!0,!navigator.mediaDevices?.getUserMedia){j({type:"error",text:t("error")}),h.current=!1;return}try{try{if(!await n.checkPermission()&&!await n.requestPermission()){j({type:"error",text:t("permissionDenied")}),h.current=!1;return}}catch{}if(!f.current){h.current=!1;return}const w=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});if(!f.current){w.getTracks().forEach(P=>P.stop()),h.current=!1;return}if(l.current=w,d.current){d.current.srcObject=w;try{await d.current.play(),f.current&&(b(!0),I())}catch(P){if(!(P instanceof DOMException&&P.name==="AbortError"))throw P}}}catch(w){if(!f.current){h.current=!1;return}w instanceof DOMException?w.name==="NotAllowedError"?j({type:"error",text:t("permissionDenied")}):w.name==="NotFoundError"?j({type:"error",text:t("noCameraFound",{defaultValue:t("error")})}):w.name==="AbortError"||j({type:"error",text:t("error")}):j({type:"error",text:t("error")})}finally{h.current=!1}}},[n,I,t]);c.useEffect(()=>(f.current=!0,u.current=sc({useWorker:!0}),A(),()=>{f.current=!1,_(),u.current?.destroy(),u.current=null}),[]);const E=c.useCallback(()=>{const w=document.createElement("input");w.type="file",w.accept="image/*",w.onchange=async P=>{const L=P.target.files?.[0];if(!(!L||!u.current))try{const z=new Image,R=URL.createObjectURL(L);z.onload=async()=>{URL.revokeObjectURL(R);const q=document.createElement("canvas");q.width=z.width,q.height=z.height;const M=q.getContext("2d");if(!M||!u.current){j({type:"error",text:t("noQrFound")});return}M.drawImage(z,0,0);const F=await u.current.scanFromCanvas(q);F?k(F.content):j({type:"error",text:t("noQrFound")})},z.onerror=()=>{URL.revokeObjectURL(R),j({type:"error",text:t("noQrFound")})},z.src=R}catch{j({type:"error",text:t("noQrFound")})}},w.click()},[k,t]),C=c.useCallback(async()=>{if(l.current){const w=l.current.getVideoTracks()[0];if(w)try{await w.applyConstraints({advanced:[{torch:!p}]}),x(!p)}catch{}}},[p]),T=c.useCallback(()=>{_(),s()},[_,s]);return e.jsx(pe,{onCancel:T,children:e.jsxs("div",{className:"flex h-[80vh] flex-col overflow-hidden rounded-t-2xl bg-black",children:[e.jsx("div",{className:"flex justify-center py-2",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-white/30"})}),e.jsxs("div",{className:"flex items-center justify-between px-4 pb-2",children:[e.jsx(V,{variant:"ghost",size:"icon",onClick:T,className:"text-white hover:bg-white/20","data-testid":"scanner-close-button",children:e.jsx(an,{className:"size-6"})}),e.jsx("h2",{className:"text-lg font-medium text-white","data-testid":"scanner-title",children:r??t("title")}),e.jsx(V,{variant:"ghost",size:"icon",onClick:C,className:D("text-white hover:bg-white/20",p&&"text-yellow-400"),"data-testid":"scanner-flash-button",children:e.jsx(xc,{className:"size-6"})})]}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("video",{ref:d,className:D("absolute inset-0 size-full object-cover",!g&&"hidden"),playsInline:!0,muted:!0,"data-testid":"scanner-video"}),!g&&!v&&e.jsx("div",{className:"flex size-full items-center justify-center",children:e.jsx("p",{className:"text-white/60",children:t("initializing")})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"relative size-64","data-testid":"scanner-viewfinder",children:[e.jsx("div",{className:D("absolute top-0 left-0 size-8 border-t-4 border-l-4",v?.type==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:D("absolute top-0 right-0 size-8 border-t-4 border-r-4",v?.type==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:D("absolute bottom-0 left-0 size-8 border-b-4 border-l-4",v?.type==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:D("absolute right-0 bottom-0 size-8 border-r-4 border-b-4",v?.type==="success"?"border-green-500":"border-primary")}),g&&!v&&e.jsx("div",{className:"animate-scan bg-primary absolute right-2 left-2 h-0.5"})]})}),e.jsx("div",{className:"absolute inset-x-0 bottom-24 px-4 text-center",children:v?e.jsx("div",{className:D("inline-block rounded-lg px-4 py-2",v.type==="error"&&"bg-red-500/80 text-white",v.type==="success"&&"bg-green-500/80 text-white",v.type==="info"&&"bg-black/50 text-white"),"data-testid":"scanner-message",children:v.text}):g?e.jsx("p",{className:"text-white/80","data-testid":"scanner-hint",children:o??(a?t("scanPromptChain",{chain:a}):t("scanPrompt"))}):null})]}),e.jsx("div",{className:"flex justify-center gap-8 bg-black/50 py-6",children:e.jsxs(V,{variant:"ghost",size:"lg",onClick:E,className:"flex flex-col items-center text-white hover:bg-white/20","data-testid":"scanner-gallery-button",children:[e.jsx(fc,{className:"mb-1 size-6"}),e.jsx("span",{className:"text-xs",children:t("gallery")})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)] bg-black"})]})})}const ad=({params:t})=>e.jsx(me,{params:t,children:e.jsx(iy,{})});ad.__docgenInfo={description:"",methods:[],displayName:"ScannerJob"};function oy(){const{t}=B("common"),{pop:s}=Z(),n=he(),[a,r]=c.useState(n.name||""),[o,d]=c.useState(n.memo||""),[i,l]=c.useState(0),[u,m]=c.useState(!1),[f,h]=c.useState(!1),g=(()=>{try{return JSON.parse(n.addresses||"[]")}catch{return[]}})(),b=c.useCallback(()=>{l(v=>v+1)},[]),p=c.useCallback(async()=>{if(!(!a.trim()||g.length===0)){m(!0);try{const v=n.avatar||(g[0]?.address?Kt(g[0].address,i):void 0);Bs.addContact({name:a.trim(),addresses:g.map((j,N)=>({id:`addr-${N}`,address:j.address,label:j.label,isDefault:N===0})),memo:o.trim()||void 0,avatar:v}),h(!0),setTimeout(()=>s(),500)}catch{}finally{m(!1)}}},[a,o,g,n.avatar,i,s]),x=c.useCallback(()=>{s()},[s]);return e.jsx(pe,{onCancel:x,children:e.jsxs("div",{className:"bg-background rounded-t-2xl pb-[env(safe-area-inset-bottom)]",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx("div",{className:"border-border border-b px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("addressBook.addContact")})}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:b,className:"group relative",title:t("addressBook.changeAvatar"),children:[e.jsx(Ns,{src:n.avatar||(g[0]?.address?Kt(g[0].address,i):void 0),size:48}),!n.avatar&&e.jsx("div",{className:"bg-background/80 absolute inset-0 flex items-center justify-center rounded-full opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx(rs,{className:"text-primary size-5"})})]}),e.jsx(Ve,{value:a,onChange:v=>r(v.target.value),placeholder:t("addressBook.namePlaceholder"),className:"flex-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm",children:t("addressBook.addresses")}),e.jsx("div",{className:"space-y-2",children:g.map((v,j)=>{const N=Cf(v.address),y=v.label||N.chainType?.toUpperCase()||"";return e.jsxs("div",{className:"bg-muted/50 flex items-center gap-3 rounded-lg p-3",children:[e.jsx(lr,{className:"text-muted-foreground size-5 shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[y&&e.jsx("div",{className:"text-muted-foreground text-xs",children:y}),e.jsx("div",{className:"truncate font-mono text-sm",children:v.address})]})]},j)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm",children:t("addressBook.memo")}),e.jsx(Ve,{value:o,onChange:v=>d(v.target.value),placeholder:t("addressBook.memoPlaceholder")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx(V,{variant:"outline",onClick:x,disabled:u||f,className:"flex-1",children:t("cancel")}),e.jsx(V,{onClick:p,disabled:!a.trim()||g.length===0||u||f,className:D("flex-1",f&&"bg-green-500"),children:f?e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"mr-1 size-4"}),t("saved")]}):t(u?"saving":"save")})]})]})})}const rd=({params:t})=>e.jsx(me,{params:t,children:e.jsx(oy,{})});rd.__docgenInfo={description:"",methods:[],displayName:"ContactAddConfirmJob"};function cy(){const{t}=B("common"),{pop:s}=Z(),n=he(),a=c.useRef(null),[r,o]=c.useState(!1),d=c.useMemo(()=>{try{return JSON.parse(n.addresses||"[]")}catch{return[]}},[n.addresses]),i=c.useMemo(()=>cr({name:n.name,addresses:d,avatar:n.avatar}),[n.name,d,n.avatar]),l=c.useCallback(async()=>{const f=a.current;if(!(!f||r)){o(!0);try{const{snapdom:h}=await Et(async()=>{const{snapdom:g}=await import("./snapdom-CO8q8LPW.js").then(b=>b.s);return{snapdom:g}},__vite__mapDeps([0,1]),import.meta.url);await h.download(f,{type:"png",filename:`contact-${n.name}.png`,scale:2,quality:1})}catch{}finally{o(!1)}}},[n.name,r]),u=c.useCallback(async()=>{const f=a.current;if(!(!f||!navigator.share)){o(!0);try{const{snapdom:h}=await Et(async()=>{const{snapdom:x}=await import("./snapdom-CO8q8LPW.js").then(v=>v.s);return{snapdom:x}},__vite__mapDeps([0,1]),import.meta.url),b=await(await h(f,{scale:2})).toBlob(),p=new File([b],`contact-${n.name}.png`,{type:"image/png"});await navigator.share({title:t("addressBook.shareContact"),text:`${n.name} - ${d.map(x=>`${x.label||""}: ${x.address}`).join(", ")}`,files:[p]})}catch{}finally{o(!1)}}},[n.name,d,t,r]),m=()=>{s()};return e.jsx(pe,{onCancel:m,children:e.jsxs("div",{className:"bg-background rounded-t-2xl pb-[env(safe-area-inset-bottom)]",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"flex items-center justify-between border-b px-4 pb-4",children:[e.jsx(V,{variant:"ghost",size:"icon",onClick:m,children:e.jsx(an,{className:"size-5"})}),e.jsx("h2",{className:"text-lg font-semibold",children:t("addressBook.shareContact")}),e.jsx("div",{className:"w-10"})]}),e.jsxs("div",{className:"flex flex-col items-center p-6",children:[e.jsx("div",{ref:a,children:e.jsx(dr,{name:n.name,avatar:n.avatar,addresses:d,qrContent:i})}),e.jsx("p",{className:"text-muted-foreground mt-4 text-center text-sm",children:t("addressBook.scanToAdd")})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsxs(V,{variant:"outline",onClick:l,disabled:r,className:"flex-1",children:[r?e.jsx(be,{className:"mr-2 size-4 animate-spin"}):e.jsx(nn,{className:"mr-2 size-4"}),t("download")]}),"share"in navigator&&e.jsxs(V,{onClick:u,disabled:r,className:"flex-1",children:[r?e.jsx(be,{className:"mr-2 size-4 animate-spin"}):e.jsx(Us,{className:"mr-2 size-4"}),t("share")]})]})]})})}const id=({params:t})=>e.jsx(me,{params:t,children:e.jsx(cy,{})});id.__docgenInfo={description:"",methods:[],displayName:"ContactShareJob"};function ly(){const{t}=B(["settings","common"]),{pop:s}=Z(),[n,a]=c.useState(!1),r=c.useCallback(()=>{a(!0);const d="./";window.location.href=`${d}clear.html`},[]),o=()=>{s()};return e.jsx(pe,{onCancel:o,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-destructive/10 flex size-16 items-center justify-center rounded-full",children:e.jsx(Oe,{className:"text-destructive size-8"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:t("settings:clearData.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("settings:clearData.warning")})]}),e.jsx("div",{className:"bg-destructive/5 rounded-lg p-4",children:e.jsxs("ul",{className:"text-destructive space-y-2 text-sm",children:[e.jsxs("li",{children:[" ",t("settings:clearData.item1")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item2")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item3")]})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(V,{variant:"outline",className:"flex-1",onClick:o,disabled:n,children:t("common:cancel")}),e.jsx(V,{variant:"destructive",className:"flex-1",onClick:r,disabled:n,children:t("settings:clearData.confirm")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const od=()=>e.jsx(ly,{});od.__docgenInfo={description:"",methods:[],displayName:"ClearDataConfirmJob"};function dy(t){if(!t)return;if(t.startsWith("0x")){const n=Qn(t);if(n)return n}const s=Mf(t);return dt.getConfig(s),s}function uy(){const{t}=B("common"),{pop:s}=Z(),{chain:n,exclude:a,appName:r,appIcon:o}=he(),d=Ys(),i=c.useMemo(()=>dy(n),[n]),l=c.useMemo(()=>i?d.find(x=>x.id===i):null,[i,d]),u=i?dt.getName(i):void 0,m=Ie(Le),f=Xs.getCurrentWallet(m),h=c.useMemo(()=>{const x=a?.toLowerCase(),v=[];for(const j of m.wallets){const N=i?j.chainAddresses.find(y=>y.chain===i):j.chainAddresses[0];N&&(x&&N.address.toLowerCase()===x||v.push({id:j.id,name:j.name,address:N.address,themeHue:j.themeHue,chainIconUrl:l?.icon}))}return v},[m.wallets,i,a]),g=c.useMemo(()=>{const x=new Map;return m.wallets.forEach(v=>{const j=i?v.chainAddresses.find(N=>N.chain===i):v.chainAddresses[0];j&&x.set(v.id,{wallet:v,chainAddress:j})}),x},[m.wallets,i]),b=x=>{const v=g.get(x);if(!v)return;const j=new CustomEvent("wallet-picker-select",{detail:{address:v.chainAddress.address,chain:v.chainAddress.chain,name:v.wallet.name,publicKey:v.chainAddress.publicKey}});window.dispatchEvent(j),s()},p=x=>{x?.preventDefault?.();const v=new CustomEvent("wallet-picker-cancel");window.dispatchEvent(v),s()};return e.jsx(pe,{onCancel:p,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Lt,{title:i?t("selectChainWallet",{chain:u}):t("selectWallet"),description:`${r||t("unknownDApp")} ${t("requestsAccess")}`,appName:r,appIcon:o,chainId:i}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto p-4",children:h.length===0?e.jsx("div",{className:"text-muted-foreground py-12 text-center text-sm",children:i?t("noWalletsForChain",{chain:i}):t("noWallets")}):e.jsx(Tf,{wallets:h,currentWalletId:f?.id,onSelect:b,showAddButton:!1})}),e.jsx("div",{className:"border-border border-t p-4",children:e.jsx("button",{onClick:p,className:"bg-muted hover:bg-muted/80 w-full rounded-xl py-3 font-medium transition-colors",children:t("cancel")})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const cd=({params:t})=>e.jsx(me,{params:t,children:e.jsx(uy,{})});cd.__docgenInfo={description:"",methods:[],displayName:"WalletPickerJob"};const my={"bfmeta-v2":"bfmetav2",bfmeta_v2:"bfmetav2"};function Ua(t){return t.trim().toLowerCase()}function oo(t){return t.trim()}function co(t){return t.startsWith("0x")}function fy(t,s){return Ua(t)===Ua(s)}function py(t,s){const n=oo(t),a=oo(s);return co(n)||co(a)?n.toLowerCase()===a.toLowerCase():n===a}function dn(t){const s=Ua(t);if(s.length===0)return s;const n=Pa.state,a=He.getChainById(n,s);return a?a.id:my[s]??s}function Or(t,s){const n=dn(t);for(const a of Le.state.wallets){const r=a.chainAddresses.find(o=>fy(o.chain,n)&&py(o.address,s));if(r)return{wallet:a,chainAddress:r}}return null}function ld(t,s){return Or(t,s)?.wallet.id??null}function hy(){const{t}=B("common"),{pop:s,push:n}=Z(),{message:a,address:r,appName:o,appIcon:d,chainName:i}=he(),[l,u]=c.useState(!1),m=c.useMemo(()=>dn(i),[i]),f=c.useMemo(()=>Or(m,r),[m,r]),h=f?.wallet,g=f?.chainAddress.chain,b=!!(h?.encryptedMnemonic&&g),p=h?.name||t("unknownWallet"),x=g??m,v=c.useCallback(()=>{l||!b||(Cs(async y=>{u(!0);try{if(!h||!h.encryptedMnemonic||!g)throw new Error(t("signingAddressNotFound"));const S=`miniapp_sign_${Date.now()}`,I=await new wc(Vs,S).handleMessageSign({chainName:g,senderAddress:r,message:a},h.encryptedMnemonic,y),_=new CustomEvent("signing-confirm",{detail:{confirmed:!0,signature:I.signature,publicKey:I.publicKey}});return window.dispatchEvent(_),s(),!0}catch(S){throw S instanceof Error?S:new Error(t("walletLock.error"))}finally{u(!1)}}),n("WalletLockConfirmJob",{title:t("signMessage"),description:o||t("unknownDApp"),miniappName:o,miniappIcon:d,walletName:p,walletAddress:r,walletChainId:x}))},[l,b,r,a,s,n,g,t,h,o,d,p,x]),j=c.useCallback(()=>{const y=new CustomEvent("signing-confirm",{detail:{confirmed:!1}});window.dispatchEvent(y),s()},[s]),N=a.startsWith("0x")&&/^0x[0-9a-fA-F]+$/.test(a);return e.jsx(pe,{onCancel:j,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Lt,{title:t("signMessage"),description:o||t("unknownDApp"),appName:o,appIcon:d,walletInfo:{name:p,address:r,chainId:x}}),e.jsxs("div",{className:"space-y-4 p-4",children:[!b&&e.jsx("div",{className:"rounded-xl bg-amber-50 p-3 text-sm text-amber-800 dark:bg-amber-950/30 dark:text-amber-200",children:t("signingAddressNotFound")}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsxs("p",{className:"text-muted-foreground mb-1 text-xs",children:[" ",t("message")]}),e.jsx("div",{className:"max-h-40 overflow-y-auto",children:e.jsx("pre",{className:"font-mono text-sm break-all whitespace-pre-wrap",children:a})})]}),N&&e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[e.jsx(Oe,{className:"size-5 shrink-0 text-amber-600"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:t("hexDataWarning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:j,disabled:l,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("cancel")}),e.jsx("button",{onClick:v,disabled:l||!b,className:D("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","flex items-center justify-center gap-2 disabled:opacity-50"),children:l?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"size-4 animate-spin"}),t("signing")]}):t("sign")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const dd=({params:t})=>e.jsx(me,{params:t,children:e.jsx(hy,{})});dd.__docgenInfo={description:"",methods:[],displayName:"SigningConfirmJob"};const xy={bio_requestAccounts:lr,bio_createTransaction:Ho,bio_signMessage:oa,bio_signTypedData:oa,bio_signTransaction:oa,bio_sendTransaction:bp};function gy(){const{t}=B("permission"),{pop:s}=Z(),{appName:n,appIcon:a,permissions:r}=he(),o=(()=>{try{return JSON.parse(r)}catch{return[]}})(),d=()=>{const m=new CustomEvent("permission-request",{detail:{approved:!0,permissions:o}});window.dispatchEvent(m),s()},i=()=>{const m=new CustomEvent("permission-request",{detail:{approved:!1}});window.dispatchEvent(m),s()},l=m=>{const f=`${m}.label`;return String(t(f))},u=m=>{const f=`${m}.description`;return String(t(f))};return e.jsx(pe,{onCancel:i,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"border-border border-b px-4 pb-4",children:[e.jsx("div",{className:"bg-primary/10 mx-auto mb-3 flex size-14 items-center justify-center rounded-2xl",children:a?e.jsx("img",{src:a,alt:n,className:"size-10 rounded-xl"}):e.jsx(zf,{className:"text-primary size-8"})}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:n}),e.jsx("p",{className:"text-muted-foreground mt-1 text-center text-sm",children:String(t("requestsPermissions"))})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"space-y-3",children:o.map(m=>{const f=xy[m];return f?e.jsxs("div",{className:"bg-muted/50 flex items-center gap-3 rounded-xl p-3",children:[e.jsx("div",{className:"bg-primary/10 flex size-10 shrink-0 items-center justify-center rounded-full",children:e.jsx(f,{className:"text-primary size-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium",children:l(m)}),e.jsx("p",{className:"text-muted-foreground text-sm",children:u(m)})]})]},m):null})}),e.jsxs("div",{className:"text-muted-foreground mt-4 flex items-center gap-2 text-sm",children:[e.jsx(ur,{className:"size-4"}),e.jsx("span",{children:String(t("permissionNote"))})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:i,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("reject")}),e.jsx("button",{onClick:d,className:D("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90"),children:t("approve")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const ud=({params:t})=>e.jsx(me,{params:t,children:e.jsx(gy,{})});ud.__docgenInfo={description:"",methods:[],displayName:"PermissionRequestJob"};const Va="MINIAPP_TRANSFER_UNSUPPORTED_PIPELINE";function vy(t){return/timeout|timed out|etimedout|aborterror|aborted/i.test(t)}function md(t){return/failed to broadcast transaction|broadcast failed|tx_broadcast_failed/i.test(t)}function lo(t){return/cannot transfer(?:\s+\w+)*\s+to yourself||/i.test(t)}function uo(t){return/^broadcast failed:?$/i.test(t.trim())||/^failed to broadcast transaction:?$/i.test(t.trim())}function ea(t){const s=[],n=new Set;let a=t;for(;a instanceof Error&&!n.has(a);)n.add(a),a.message&&s.push(a.message),a=a.cause;return s}function Na(t){return ea(t).some(s=>vy(s))}function mo(t){return ea(t).some(s=>md(s))}function wa(t){if(t instanceof as&&typeof t.details?.reason=="string")return t.details.reason.trim()||null;for(const s of ea(t)){const n=s.trim(),a=n.match(/^broadcast failed:\s*(.+)$/i);if(a?.[1])return a[1].trim();if(!(!uo(n)&&!md(n))&&!uo(n))return n}return null}function ka(t,s){return s?`${t}: ${s}`:t}function yy(t){return new as(Ze.NOT_SUPPORTED,Va,{scope:"miniapp-transfer",chainId:t})}function by(t,s,n){if(s instanceof as){if(s.code===Ze.NOT_SUPPORTED&&s.message===Va)return t("common:miniappTransferUnsupportedPipeline",{chainId:n});if(s.code===Ze.TRANSACTION_TIMEOUT)return t("transaction:broadcast.timeout");if(s.code===Ze.TX_BROADCAST_FAILED)return Na(s)?t("transaction:broadcast.timeout"):ka(t("transaction:broadcast.failed"),wa(s));if(s.code===Ze.TX_BUILD_FAILED){const r=(typeof s.details?.reason=="string"?s.details.reason.trim():"")||s.message;if(lo(r))return t("error:validation.cannotTransferToSelf");if(r)return r}if(s.code===Ze.NETWORK_ERROR){if(Na(s))return t("transaction:broadcast.timeout");if(mo(s))return ka(t("transaction:broadcast.failed"),wa(s))}}if(s instanceof Error){if(s.message===Va)return t("common:miniappTransferUnsupportedPipeline",{chainId:n});if(Na(s))return t("transaction:broadcast.timeout");if(mo(s))return ka(t("transaction:broadcast.failed"),wa(s));if(lo(s.message))return t("error:validation.cannotTransferToSelf");const[a]=ea(s);if(a)return a}return t("transaction:broadcast.unknown")}const jy=/^\d+$/;function Ny(t,s,n){const a=t.trim();if(!jy.test(a))throw new Error("Invalid miniapp transfer amount");return oe.fromRaw(a,s,n)}const fo=/pay password|pay secret|second secret|security password/i;function Ja(t){return t instanceof Qs?t.code===ys.DECRYPTION_FAILED||t.code===ys.INVALID_PASSWORD:t instanceof Error?/wrong password|decrypt mnemonic|invalid walletlock|wallet lock/i.test(t.message):!1}function Ka(t){return t instanceof as&&t.code===Ze.SIGNATURE_FAILED&&fo.test(t.message)?!0:t instanceof Error?fo.test(t.message):!1}async function fd(t,s){const n=Ee(t);if(!n.bioGetAccountInfo)return!1;try{return!!(await n.bioGetAccountInfo(s)).secondPublicKey}catch{return!1}}const po=new Map;function wy(t,s){const n=JSON.stringify({locale:t,options:s}),a=po.get(n);if(a)return a;const r=new Intl.NumberFormat(t,s);return po.set(n,r),r}function ho(t,s,n){return t==null?"":wy(s,n).format(t)}const pd=c.createContext(void 0);function hd(){const t=c.useContext(pd);if(t===void 0)throw new Error(Bf(51));return t}let Ca=(function(t){return t.complete="data-complete",t.indeterminate="data-indeterminate",t.progressing="data-progressing",t})({});const Br={status(t){return t==="progressing"?{[Ca.progressing]:""}:t==="complete"?{[Ca.complete]:""}:t==="indeterminate"?{[Ca.indeterminate]:""}:null}};function ky(t,s,n){return t==null?"":n?ho(t,s,n):ho(t/100,s,{style:"percent"})}function Cy(t,s){return s==null?"indeterminate progress":t||`${s}%`}const Sy=c.forwardRef(function(s,n){const{format:a,getAriaValueText:r=Cy,locale:o,max:d=100,min:i=0,value:l,render:u,className:m,...f}=s,[h,g]=c.useState(),b=Of(a);let p="indeterminate";Number.isFinite(l)&&(p=l===d?"complete":"progressing");const x=ky(l,o,b.current),v=c.useMemo(()=>({status:p}),[p]),j={"aria-labelledby":h,"aria-valuemax":d,"aria-valuemin":i,"aria-valuenow":l??void 0,"aria-valuetext":r(x,l),role:"progressbar"},N=c.useMemo(()=>({formattedValue:x,max:d,min:i,setLabelId:g,state:v,status:p,value:l}),[x,d,i,g,v,p,l]),y=mr("div",s,{state:v,ref:n,props:[j,f],stateAttributesMapping:Br});return e.jsx(pd.Provider,{value:N,children:y})}),Ay=c.forwardRef(function(s,n){const{render:a,className:r,...o}=s,{state:d}=hd();return mr("div",s,{state:d,ref:n,props:o,stateAttributesMapping:Br})});function Iy(t,s,n){return(t-s)*100/(n-s)}const Ty=c.forwardRef(function(s,n){const{render:a,className:r,...o}=s,{max:d,min:i,value:l,state:u}=hd(),m=Number.isFinite(l)&&l!==null?Iy(l,i,d):null,f=c.useCallback(()=>m==null?{}:{insetInlineStart:0,height:"inherit",width:`${m}%`},[m]);return mr("div",s,{state:u,ref:n,props:[{style:f()},o],stateAttributesMapping:Br})});function xd({className:t,children:s,value:n,...a}){return e.jsxs(Sy,{value:n,"data-slot":"progress",className:D("flex flex-wrap gap-3",t),...a,children:[s,e.jsx(gd,{children:e.jsx(vd,{})})]})}function gd({className:t,...s}){return e.jsx(Ay,{className:D("bg-muted h-1 rounded-full relative flex w-full items-center overflow-x-hidden",t),"data-slot":"progress-track",...s})}function vd({className:t,...s}){return e.jsx(Ty,{"data-slot":"progress-indicator",className:D("bg-primary h-full transition-all",t),...s})}xd.__docgenInfo={description:"",methods:[],displayName:"Progress"};gd.__docgenInfo={description:"",methods:[],displayName:"ProgressTrack"};vd.__docgenInfo={description:"",methods:[],displayName:"ProgressIndicator"};function Fr({currentStep:t,totalSteps:s,percent:n,className:a}){const{t:r}=B("common");return e.jsxs("div",{className:a,"data-testid":"miniapp-step-progress",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:r("stepProgress")}),e.jsx("span",{className:"text-muted-foreground text-xs tabular-nums",children:r("stepFraction",{current:t,total:s})})]}),e.jsx(xd,{value:n,className:"w-full","aria-label":r("stepProgressAriaLabel")})]})}Fr.__docgenInfo={description:"",methods:[],displayName:"MiniappStepProgress",props:{currentStep:{required:!0,tsType:{name:"number"},description:""},totalSteps:{required:!0,tsType:{name:"number"},description:""},percent:{required:!0,tsType:{name:"number"},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Py=["review","wallet_lock","broadcasting"],Ey=["review","wallet_lock","two_step_secret","broadcasting"],_y=["review","wallet_lock","signing"],My=["review","wallet_lock","two_step_secret","signing"];function xo(t,s){const n=Math.max(1,t),a=Math.min(Math.max(s,1),n);return{currentStep:a,totalSteps:n,percent:Math.round(a/n*100)}}function Ry(t){return t?Ey:Py}function Ly(t){return t?My:_y}function yd(t,s){const n=t.indexOf(s);return n<0?xo(t.length,1):xo(t.length,n+1)}function Un(t){return typeof t=="object"&&t!==null}function go(t){if(typeof structuredClone=="function")try{const s=structuredClone(t);if(Un(s))return s}catch{}try{const s=JSON.parse(JSON.stringify(t));if(Un(s))return s}catch{}return{...t}}const Dy=3,yn=new Map;function zy(){const{t}=B(["common","transaction"]),{pop:s}=Z(),n=nt(),a=he(),{requestId:r,appName:o,appIcon:d,from:i,to:l,amount:u,chain:m,asset:f,remark:h}=a,b=c.useRef(r??`legacy-transfer-${Date.now()}-${Math.random().toString(36).slice(2,8)}`).current,[p,x]=c.useState("review"),[v,j]=c.useState([]),[N,y]=c.useState(""),[S,k]=c.useState(!1),[I,_]=c.useState(!1),[A,E]=c.useState(null),[C,T]=c.useState("idle"),[w,P]=c.useState(null),[L,z]=c.useState(!1),[R,q]=c.useState(!0),M=c.useRef(!0),F=c.useRef(!1),K=c.useRef(!1),ee=c.useRef(!1),W=c.useRef(!1),$=c.useMemo(()=>dn(m),[m]),ie=c.useMemo(()=>ld($,i),[$,i]),ae=Le.state.wallets.find(Y=>Y.id===ie)?.name||t("unknownWallet"),se=`${o||t("unknownDApp")} ${t("requestsTransfer")}`,H=c.useMemo(()=>Ry(L),[L]),X=c.useMemo(()=>yd(H,p),[H,p]),O=c.useMemo(()=>f||dt.getSymbol($)||$.toUpperCase(),[f,$]),G=c.useMemo(()=>dt.getDecimals($),[$]),re=c.useMemo(()=>{try{return Ny(u,G,O)}catch{return null}},[u,G,O]),ge=c.useMemo(()=>re?.toFormatted({trimTrailingZeros:!1})??u,[re,u]),ve=c.useMemo(()=>re?null:t("transaction:broadcast.invalidParams"),[re,t]),ze=c.useMemo(()=>h?Object.entries(h).map(([Y,te])=>({key:Y.trim(),value:te.trim()})).filter(Y=>Y.key.length>0&&Y.value.length>0):[],[h]),pt=c.useMemo(()=>t("transaction:miniappTransfer.shortTitle",{amount:ge,asset:O}),[t,ge,O]),Ot=C==="building",Bt=C==="broadcasting",ht=C==="success",Se=C==="building"||C==="broadcasting",fe=c.useCallback((Y,te={})=>{console.log("[miniapp-transfer-sheet]",Y,{requestId:b,appName:o,chain:$,...te})},[o,b,$]),un=c.useCallback(()=>{j([]),k(!1),y(""),_(!1),E(null)},[]);c.useEffect(()=>{if(M.current=!0,typeof window<"u"){const Y=yn.get(b);Y!==void 0&&(window.clearTimeout(Y),yn.delete(b),fe("sheet.unmount-settle.cancelled"))}return fe("sheet.mount",{from:i,to:l,amount:u,asset:f??"native"}),r||fe("sheet.request-id.fallback",{fallbackRequestId:b}),()=>{if(M.current=!1,fe("sheet.unmount"),typeof window>"u"||!r)return;const Y=window.setTimeout(()=>{if(yn.delete(b),!K.current){K.current=!0;const te={requestId:b,confirmed:!1};fe("sheet.emit.on-unmount",{confirmed:!1,hasTxHash:!1,hasTransaction:!1}),window.dispatchEvent(new CustomEvent("miniapp-transfer-confirm",{detail:te}))}if(!ee.current){ee.current=!0;const te={requestId:b,reason:"cancel"};fe("sheet.closed.on-unmount",te),window.dispatchEvent(new CustomEvent("miniapp-transfer-sheet-closed",{detail:te}))}},0);yn.set(b,Y)}},[u,f,b,i,fe,r,l]),c.useEffect(()=>{let Y=!0;return q(!0),fd($,i).then(te=>{Y&&z(te)}).finally(()=>{Y&&q(!1)}),()=>{Y=!1}},[$,i]);const cs=c.useCallback(Y=>{if(K.current||(K.current=!0,typeof window>"u"))return;const te={requestId:b,...Y};fe("sheet.emit",{confirmed:te.confirmed,hasTxHash:!!te.txHash,hasTransaction:!!te.transaction,txId:te.txId}),window.dispatchEvent(new CustomEvent("miniapp-transfer-confirm",{detail:te}))},[b,fe]),xt=c.useCallback(Y=>{if(ee.current||(ee.current=!0,typeof window>"u"))return;const te={requestId:b,reason:Y};fe("sheet.closed",te),window.dispatchEvent(new CustomEvent("miniapp-transfer-sheet-closed",{detail:te}))},[b,fe]);c.useEffect(()=>{if(!ht||w===null)return;if(w<=0){fe("sheet.success.auto-close"),xt("confirmed"),s();return}const Y=window.setTimeout(()=>{P(te=>te===null?null:te-1)},1e3);return()=>{window.clearTimeout(Y)}},[xt,ht,fe,s,w]);const sa=c.useCallback(()=>{!Bt||F.current||(F.current=!0,fe("sheet.background-broadcast"),xt("background"),n.show(t("transaction:miniappTransfer.toast.background",{title:pt})),s())},[xt,Bt,fe,s,t,n,pt]),Yu=c.useCallback(()=>{Se||!ie||(un(),x("wallet_lock"))},[Se,ie,un]),qr=c.useCallback(()=>{Se||(un(),x("review"))},[Se,un]),Zu=c.useCallback(Y=>{(S||A||I)&&(k(!1),_(!1),E(null)),j(Y)},[S,A,I]),em=c.useCallback(Y=>{(I||A)&&(_(!1),E(null)),y(Y)},[I,A]),Hr=c.useCallback(async(Y,te)=>{if(!ie)throw new Error("missing walletId");const _e=Ee($);if(!_e.supportsFullTransaction||!_e.buildTransaction||!_e.signTransaction||!_e.broadcastTransaction)throw yy($);if(!re)throw new Error("Invalid miniapp transfer amount");const fn=await _e.buildTransaction({type:"transfer",from:i,to:l,amount:re,...f?{bioAssetType:f}:{},...h?{remark:h}:{}}),Te=await Ko({walletId:ie,password:Y,from:i,chainId:$,unsignedTx:fn,...te?{paySecret:te}:{}}),gt=Un(Te.data)?{...Te,data:go(Te.data)}:Te;M.current&&(x("broadcasting"),T("broadcasting"));const nm=await _e.broadcastTransaction(gt),am=Un(gt.data)?go(gt.data):{data:gt.data};return{txHash:nm,transaction:am}},[$,re,f,i,l,ie,h]),Ur=c.useCallback((Y,te)=>{const _e=by(t,Y,$);if(F.current){M.current&&(x(te),T("idle")),cs({confirmed:!1}),n.show(t("transaction:miniappTransfer.toast.failed",{title:pt,reason:_e}));return}if(!M.current){fe("transfer.failed.after-unmount",{inputStep:te,message:_e});return}if(T("idle"),Ja(Y)){k(!0),_(!1),E(t("walletLock.error")),x("wallet_lock"),j([]);return}if(Ka(Y)){k(!1),_(!0),E(t("transaction:sendPage.twoStepSecretError")),x("two_step_secret");return}k(!1),_(!1),E(_e),x(te),te==="wallet_lock"&&j([])},[cs,fe,$,t,n,pt]),mn=c.useCallback(async(Y,te,_e)=>{if(W.current){fe("transfer.skip.in-flight",{inputStep:te});return}let fn=!1;W.current=!0,fe("transfer.start",{inputStep:te,hasPaySecret:!!_e}),T("building"),k(!1),_(!1),E(null);try{const{txHash:Te,transaction:gt}=await Hr(Y,_e);fn=!0,fe("transfer.broadcast.success",{txHash:Te}),(F.current||!M.current)&&n.show(t("transaction:miniappTransfer.toast.success",{title:pt})),cs({confirmed:!0,txHash:Te,txId:Te,transaction:gt}),!F.current&&M.current&&(x("broadcasting"),T("success"),P(Dy))}catch(Te){const gt=Te instanceof Error?Te.name:typeof Te;fe("transfer.failed",{inputStep:te,errorType:gt}),console.error(te==="two_step_secret"?"[miniapp-transfer][two-step-secret]":"[miniapp-transfer]",Te),Ur(Te,te)}finally{fe("transfer.finally",{inputStep:te,backgrounded:F.current}),W.current=!1,M.current&&!F.current&&!fn&&T("idle")}},[cs,Ur,fe,Hr,t,n,pt]),tm=c.useCallback(async Y=>{if(Y.length<4||Se||W.current||!ie)return;const te=Be(Y);await mn(te,"wallet_lock")},[Se,ie,mn]),Vr=c.useCallback(async()=>{if(!ie||!v.length||!N.trim()||Se||W.current)return;const Y=Be(v);await mn(Y,"two_step_secret",N.trim())},[ie,v,N,Se,mn]),sm=c.useCallback(()=>{Vr()},[Vr]),na=c.useCallback(()=>{fe("sheet.success.manual-close",{countdown:w}),xt("confirmed"),s()},[xt,fe,s,w]),aa=c.useCallback(()=>{if(ht){na();return}if(Bt){fe("sheet.cancel.broadcasting"),sa();return}if(Ot){fe("sheet.cancel.blocked-building");return}fe("sheet.cancel.idle"),cs({confirmed:!1}),xt("cancel"),s()},[xt,cs,na,Bt,Ot,ht,fe,sa,s]);return e.jsx(pe,{onCancel:aa,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Lt,{title:t("confirmTransfer"),description:Ot?t("buildingTransaction"):p==="review"?se:t(p==="wallet_lock"?"drawPatternToConfirm":p==="two_step_secret"?"transaction:sendPage.twoStepSecretDescription":ht?"transaction:txStatus.broadcastedDesc":"transaction:txStatus.broadcasting"),appName:o,appIcon:d,walletInfo:{name:ae,address:i,chainId:$}}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(Fr,{currentStep:X.currentStep,totalSteps:X.totalSteps,percent:X.percent})}),p==="review"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx("div",{className:"bg-muted/50 rounded-xl p-4 text-center",children:e.jsx(wt,{value:ge,symbol:O,size:"xl",weight:"bold",decimals:G,fixedDecimals:!0})}),e.jsxs("div",{className:"bg-muted/50 space-y-3 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-10 shrink-0 text-xs",children:[" ",t("from")]}),e.jsx(ot,{address:i,copyable:!0,className:"flex-1 text-sm"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(Fs,{className:"text-muted-foreground size-4"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-10 shrink-0 text-xs",children:[" ",t("to")]}),e.jsx(ot,{address:l,copyable:!0,className:"flex-1 text-sm"})]})]}),!ie&&e.jsx("div",{className:"rounded-xl bg-amber-50 p-3 text-sm text-amber-800 dark:bg-amber-950/30 dark:text-amber-200",children:t("signingAddressNotFound")}),ve&&e.jsx("div",{className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:ve}),e.jsxs("div",{className:"bg-muted/50 flex items-center justify-between rounded-xl p-3",children:[e.jsxs("span",{className:"text-muted-foreground text-sm",children:[" ",t("network")]}),e.jsx(Tn,{chainId:$})]}),ze.length>0&&e.jsxs("div",{"data-testid":"miniapp-transfer-remark",className:"bg-muted/50 space-y-2 rounded-xl p-3",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:t("memo")}),e.jsx("div",{className:"max-h-36 space-y-1 overflow-y-auto pr-1 scrollbar-thin scrollbar-track-transparent scrollbar-thumb-[color-mix(in_srgb,currentColor,transparent)]",children:ze.map((Y,te)=>e.jsxs("div",{className:D("flex flex-row items-start justify-between gap-2 rounded-md px-2 py-1 text-xs leading-5",te%2===0?"bg-white":"bg-muted/40"),children:[e.jsx("span",{className:"text-muted-foreground min-w-0 break-all",children:Y.key}),e.jsx("span",{className:"min-w-0 break-all text-right",children:Y.value})]},Y.key))})]}),e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[e.jsx(Oe,{className:"mt-0.5 size-5 shrink-0 text-amber-600"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:t("transferWarning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:aa,disabled:Se,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("cancel")}),e.jsx("button",{"data-testid":"miniapp-transfer-review-confirm",onClick:Yu,disabled:Se||!ie||R||!re,className:D("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","flex items-center justify-center gap-2 disabled:opacity-50"),children:t("confirm")})]})]}):p==="wallet_lock"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 p-4",children:[!ie&&e.jsx("div",{className:"rounded-xl bg-amber-50 p-3 text-sm text-amber-800 dark:bg-amber-950/30 dark:text-amber-200",children:t("signingAddressNotFound")}),e.jsx(ft,{value:v,onChange:Zu,onComplete:tm,minPoints:4,disabled:Se||!ie,error:S,errorText:S?t("walletLock.error"):void 0}),A&&!S&&e.jsx("div",{"data-testid":"miniapp-transfer-error",className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:A}),Ot&&e.jsxs("div",{"data-testid":"miniapp-transfer-building-status",className:"bg-muted text-muted-foreground flex items-center justify-center gap-2 rounded-xl p-3 text-sm",children:[e.jsx(be,{className:"size-4 animate-spin"}),t("buildingTransaction")]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:qr,disabled:Se,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("back")}),e.jsx("button",{onClick:aa,disabled:Se,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("cancel")})]})]}):p==="two_step_secret"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx(bs,{value:N,onChange:Y=>em(Y.target.value),placeholder:t("transaction:sendPage.twoStepSecretPlaceholder"),disabled:Se,"aria-describedby":A?"miniapp-two-step-secret-error":void 0,"data-testid":"miniapp-two-step-secret-input"}),A&&e.jsx("div",{id:"miniapp-two-step-secret-error","data-testid":"miniapp-transfer-error",className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:A}),Ot&&e.jsxs("div",{"data-testid":"miniapp-transfer-building-status",className:"bg-muted text-muted-foreground flex items-center justify-center gap-2 rounded-xl p-3 text-sm",children:[e.jsx(be,{className:"size-4 animate-spin"}),t("buildingTransaction")]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:qr,disabled:Se,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("back")}),e.jsx("button",{onClick:sm,disabled:Se||N.trim().length===0,className:D("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","disabled:opacity-50"),children:t("confirm")})]})]}):e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx("div",{className:"bg-muted/50 rounded-xl p-4 text-center",children:e.jsx(wt,{value:ge,symbol:O,size:"xl",weight:"bold",decimals:G,fixedDecimals:!0})}),e.jsxs("div",{className:"bg-muted/50 space-y-3 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-10 shrink-0 text-xs",children:[" ",t("from")]}),e.jsx(ot,{address:i,copyable:!0,className:"flex-1 text-sm"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(Fs,{className:"text-muted-foreground size-4"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-10 shrink-0 text-xs",children:[" ",t("to")]}),e.jsx(ot,{address:l,copyable:!0,className:"flex-1 text-sm"})]})]}),e.jsxs("div",{className:"bg-muted/50 flex items-center justify-between rounded-xl p-3",children:[e.jsxs("span",{className:"text-muted-foreground text-sm",children:[" ",t("network")]}),e.jsx(Tn,{chainId:$})]}),ze.length>0&&e.jsxs("div",{"data-testid":"miniapp-transfer-remark",className:"bg-muted/50 space-y-2 rounded-xl p-3",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:t("memo")}),e.jsx("div",{className:"max-h-36 space-y-1 overflow-y-auto pr-1 scrollbar-thin scrollbar-track-transparent scrollbar-thumb-[color-mix(in_srgb,currentColor,transparent)]",children:ze.map((Y,te)=>e.jsxs("div",{className:D("flex flex-row items-start justify-between gap-2 rounded-md px-2 py-1 text-xs leading-5",te%2===0?"bg-white":"bg-muted/40"),children:[e.jsx("span",{className:"text-muted-foreground min-w-0 break-all",children:Y.key}),e.jsx("span",{className:"min-w-0 break-all text-right",children:Y.value})]},Y.key))})]}),ht?e.jsxs(e.Fragment,{children:[e.jsx("div",{"data-testid":"miniapp-transfer-broadcast-success-status",className:"bg-muted text-muted-foreground flex items-center justify-center gap-2 rounded-xl p-3 text-sm",children:t("transaction:txStatus.broadcasted")}),e.jsx("button",{type:"button","data-testid":"miniapp-transfer-success-close",onClick:na,className:D("w-full rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90"),children:t("transaction:txStatus.closeIn",{seconds:w??0})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{"data-testid":"miniapp-transfer-broadcasting-status",className:"bg-muted text-muted-foreground flex items-center justify-center gap-2 rounded-xl p-3 text-sm",children:[e.jsx(be,{className:"size-4 animate-spin"}),t("transaction:txStatus.broadcasting")]}),e.jsx("button",{type:"button","data-testid":"miniapp-transfer-background-broadcast",onClick:sa,disabled:!Bt,className:D("w-full rounded-xl py-3 font-medium transition-colors","bg-muted hover:bg-muted/80 text-foreground","disabled:opacity-50"),children:t("transaction:miniappTransfer.backgroundBroadcast")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const bd=({params:t})=>e.jsx(me,{params:t,children:e.jsx(zy,{})});bd.__docgenInfo={description:"",methods:[],displayName:"MiniappTransferConfirmJob"};const Ts=ke.t.bind(ke);function Ga(t){return typeof t=="object"&&t!==null}function Oy(t){if(typeof structuredClone=="function")try{const s=structuredClone(t);if(Ga(s))return s}catch{}try{const s=JSON.parse(JSON.stringify(t));if(Ga(s))return s}catch{}return{...t}}async function jd(t,s,n){const a=Ee(t.id);return a.bioGetAssetDetail?(await a.bioGetAssetDetail(s,n))?.applyAddress??null:null}async function Nd(t,s,n){const a=Ee(t.id);if(!a.buildTransaction||!a.estimateFee)return{amount:oe.fromRaw("1000",t.decimals,t.symbol),symbol:t.symbol};try{const r=await a.buildTransaction({type:"destroy",from:"0x0000000000000000000000000000000000000000",recipientId:"0x0000000000000000000000000000000000000000",bioAssetType:s,amount:oe.fromRaw(n,t.decimals,t.symbol)});return{amount:(await a.estimateFee(r)).standard.amount,symbol:t.symbol}}catch{return{amount:oe.fromRaw("1000",t.decimals,t.symbol),symbol:t.symbol}}}async function Vn({chainConfig:t,walletId:s,password:n,fromAddress:a,recipientAddress:r,assetType:o,amount:d,fee:i,twoStepSecret:l,remark:u}){let m;try{m=await vs.getMnemonic(s,n)}catch(h){return h instanceof Qs&&h.code===ys.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:h instanceof Error?h.message:Ts("error:unknown")}}if(!d.isPositive())return{status:"error",message:Ts("error:validation.enterValidAmount")};const f=Ee(t.id);if(!f.supportsFullTransaction)return{status:"error",message:Ts("error:transaction.chainNotSupported")};try{let h=null;if(f.bioGetAccountInfo){if(h=(await f.bioGetAccountInfo(a)).secondPublicKey,h&&!l)return{status:"password_required",secondPublicKey:h};if(l&&h&&f.bioVerifyPayPassword&&!await f.bioVerifyPayPassword({mainSecret:m,paySecret:l,publicKey:h}))return{status:"error",message:Ts("error:transaction.securityPasswordFailed")}}const g=await f.buildTransaction({type:"destroy",from:a,recipientId:r,amount:d,bioAssetType:o,...u?{remark:u}:{}}),b=await f.signTransaction(g,{privateKey:new TextEncoder().encode(m),bioSecret:m,bioPaySecret:l}),p=await kt.create({walletId:Wo(t.id,a),chainId:t.id,fromAddress:a,rawTx:b,meta:{type:"destroy",displayAmount:d.toFormatted(),displaySymbol:o,displayToAddress:r}});await kt.updateStatus({id:p.id,status:"broadcasting"});try{const x=await f.broadcastTransaction(b);await kt.updateStatus({id:p.id,status:"broadcasted",txHash:x});const v=Ga(b.data)?Oy(b.data):{data:b.data};return{status:"ok",txHash:x,txId:x,transaction:v,pendingTxId:p.id}}catch(x){const v=x;return await kt.updateStatus({id:p.id,status:"failed",errorCode:"BROADCAST_FAILED",errorMessage:v.message}),{status:"error",message:v.message,pendingTxId:p.id}}}catch(h){return{status:"error",message:(h instanceof Error?h.message:String(h))||Ts("error:transaction.burnFailed")}}}const By=Object.freeze(Object.defineProperty({__proto__:null,fetchAssetApplyAddress:jd,fetchBioforestBurnFee:Nd,submitBioforestBurn:Vn},Symbol.toStringTag,{value:"Module"}));function Fy(){const{t}=B(["common","transaction"]),{pop:s,push:n}=Z(),a=he(),{requestId:r,appName:o,appIcon:d,from:i,amount:l,chain:u,asset:m,remark:f}=a,h=ut(),g=c.useMemo(()=>dn(u),[u]),p=c.useMemo(()=>Or(g,i),[g,i])?.wallet,x=h.snapshot?He.getChainById(h,g):null,[v,j]=c.useState(!1),N=c.useCallback(w=>{if(typeof window>"u")return;const P={requestId:r,...w};window.dispatchEvent(new CustomEvent("miniapp-destroy-confirm",{detail:P}))},[r]),y=c.useCallback(w=>{if(typeof window>"u")return;const P={requestId:r,reason:w};window.dispatchEvent(new CustomEvent("miniapp-destroy-sheet-closed",{detail:P}))},[r]),S=p?.name||t("common:unknownWallet"),k=`${o||t("common:unknownDApp")} ${t("common:requestsDestroy")}`,I=c.useMemo(()=>{if(!x)return null;try{return oe.fromRaw(l,x.decimals,m)}catch{return null}},[l,m,x]),_=c.useMemo(()=>I?.toFormatted({trimTrailingZeros:!1})??l,[l,I]),A=x?.decimals??8,E=c.useMemo(()=>x?I?null:t("transaction:broadcast.invalidParams"):null,[x,I,t]),C=c.useCallback(()=>{v||(Cs(async w=>{j(!0);try{if(!p?.id||!x)throw new Error(t("common:signingAddressNotFound"));const{fetchAssetApplyAddress:P}=await Et(async()=>{const{fetchAssetApplyAddress:M}=await Promise.resolve().then(()=>By);return{fetchAssetApplyAddress:M}},void 0,import.meta.url),L=await P(x,m,i);if(!L)return!1;if(!I)throw new Error("Invalid miniapp destroy amount");const z=I,R=await Vn({chainConfig:x,walletId:p.id,password:w,fromAddress:i,recipientAddress:L,assetType:m,amount:z,...f?{remark:f}:{}});if(R.status==="password"||R.status==="error")return!1;const q=new CustomEvent("miniapp-destroy-confirm",{detail:{requestId:r,confirmed:!0,txHash:R.status==="ok"?R.txHash:void 0,txId:R.status==="ok"?R.txId:void 0,transaction:R.status==="ok"?R.transaction:void 0}});return window.dispatchEvent(q),y("confirmed"),s(),!0}catch{return!1}finally{j(!1)}}),n("WalletLockConfirmJob",{title:t("transaction:destroyPage.title"),description:k,miniappName:o,miniappIcon:d,walletName:S,walletAddress:i,walletChainId:g}))},[v,p,x,m,i,l,I,s,n,t,k,o,d,S,g,f,r,y]),T=c.useCallback(()=>{N({confirmed:!1}),y("cancel"),s()},[N,y,s]);return e.jsx(pe,{onCancel:T,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Lt,{title:t("transaction:destroyPage.title"),description:k,appName:o,appIcon:d,walletInfo:{name:S,address:i,chainId:g}}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx("div",{className:"bg-destructive/5 rounded-xl p-4 text-center",children:e.jsx(wt,{value:_,symbol:m,size:"xl",weight:"bold",decimals:A,fixedDecimals:!0})}),e.jsx("div",{className:"bg-muted/50 space-y-3 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-10 shrink-0 text-xs",children:[" ",t("common:from")]}),e.jsx(ar,{chainId:g,address:i,copyable:!0,size:"sm"})]})}),E&&e.jsx("div",{className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:E}),e.jsxs("div",{className:"bg-muted/50 flex items-center justify-between rounded-xl p-3",children:[e.jsxs("span",{className:"text-muted-foreground text-sm",children:[" ",t("common:network")]}),e.jsx(Tn,{chainId:g})]}),e.jsxs("div",{className:"bg-destructive/10 flex items-start gap-2 rounded-xl p-3",children:[e.jsx(Oe,{className:"text-destructive mt-0.5 size-5 shrink-0"}),e.jsx("p",{className:"text-destructive text-sm",children:t("transaction:destroyPage.warning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:T,disabled:v,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("common:cancel")}),e.jsx("button",{onClick:C,disabled:v||!p?.id||!x||!I,className:D("flex-1 rounded-xl py-3 font-medium transition-colors","bg-destructive text-destructive-foreground hover:bg-destructive/90","flex items-center justify-center gap-2 disabled:opacity-50"),children:v?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"size-4 animate-spin"}),t("common:confirming")]}):e.jsxs(e.Fragment,{children:[e.jsx(In,{className:"size-4"}),t("transaction:destroyPage.confirm")]})})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const wd=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Fy,{})});wd.__docgenInfo={description:"",methods:[],displayName:"MiniappDestroyConfirmJob"};function Wy(){const{t}=B("common"),{pop:s}=Z(),n=he(),{appName:a,appIcon:r,from:o,chain:d,unsignedTx:i}=n,[l,u]=c.useState("review"),[m,f]=c.useState([]),[h,g]=c.useState(""),[b,p]=c.useState(!1),[x,v]=c.useState(!1),[j,N]=c.useState(null),[y,S]=c.useState(!1),[k,I]=c.useState(!1),[_,A]=c.useState(!0),E=c.useMemo(()=>{try{return Xt.parse(i)}catch{return null}},[i]),C=c.useMemo(()=>dn(d),[d]),T=c.useMemo(()=>ld(C,o),[C,o]),P=Le.state.wallets.find(se=>se.id===T)?.name||t("unknownWallet"),L=c.useMemo(()=>Ly(k),[k]),z=c.useMemo(()=>yd(L,l),[L,l]),R=c.useCallback(()=>{f([]),p(!1),g(""),v(!1),N(null)},[]);c.useEffect(()=>{let se=!0;return A(!0),fd(C,o).then(H=>{se&&I(H)}).finally(()=>{se&&A(!1)}),()=>{se=!1}},[C,o]);const q=c.useCallback(()=>{y||!E||!T||(R(),u("wallet_lock"))},[y,E,T,R]),M=c.useCallback(()=>{y||(R(),u("review"))},[y,R]),F=c.useCallback(se=>{(b||j||x)&&(p(!1),v(!1),N(null)),f(se)},[b,j,x]),K=c.useCallback(se=>{(x||j)&&(v(!1),N(null)),g(se)},[x,j]),ee=c.useCallback(async(se,H)=>{if(!T||!E)return;const X=await Ko({walletId:T,password:se,from:o,chainId:C,unsignedTx:E,...H?{paySecret:H}:{}}),O=new CustomEvent("miniapp-sign-transaction-confirm",{detail:{confirmed:!0,signedTx:X}});window.dispatchEvent(O),s()},[T,E,o,C,s]),W=c.useCallback(async se=>{if(se.length<4||y||!E||!T)return;const H=Be(se);S(!0),p(!1),v(!1),N(null);try{u("signing"),await ee(H)}catch(X){console.error("[miniapp-sign-transaction]",X),Ja(X)?(p(!0),N(t("walletLock.error"))):Ka(X)?(p(!1),v(!0),N(t("transaction:sendPage.twoStepSecretError")),u("two_step_secret")):(p(!1),v(!1),N(t("signingFailed"))),f([])}finally{S(!1)}},[y,E,T,ee,t]),$=c.useCallback(async()=>{if(!T||!E||!m.length||!h.trim()||y)return;const se=Be(m);S(!0),v(!1),N(null);try{u("signing"),await ee(se,h.trim())}catch(H){console.error("[miniapp-sign-transaction][two-step-secret]",H),Ka(H)?(v(!0),N(t("transaction:sendPage.twoStepSecretError")),u("two_step_secret")):Ja(H)?(p(!0),N(t("walletLock.error")),u("wallet_lock")):(v(!1),N(t("signingFailed")),u("two_step_secret"))}finally{S(!1)}},[T,E,m,h,y,ee,t]),ie=c.useCallback(()=>{$()},[$]),ne=c.useCallback(()=>{const se=new CustomEvent("miniapp-sign-transaction-confirm",{detail:{confirmed:!1}});window.dispatchEvent(se),s()},[s]),ae=c.useMemo(()=>{if(!E)return"";try{return JSON.stringify(E.data,null,2)}catch{return String(E.data)}},[E]);return e.jsx(pe,{onCancel:ne,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Lt,{title:t("signTransaction"),description:l==="review"?a||t("unknownDApp"):t(l==="wallet_lock"?"drawPatternToConfirm":l==="two_step_secret"?"transaction:sendPage.twoStepSecretDescription":"signing"),appName:a,appIcon:r,walletInfo:{name:P,address:o,chainId:C}}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(Fr,{currentStep:z.currentStep,totalSteps:z.totalSteps,percent:z.percent})}),l==="review"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 p-4",children:[!E&&e.jsx("div",{className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:t("invalidTransaction")}),E&&!T&&e.jsx("div",{className:"rounded-xl bg-amber-50 p-3 text-sm text-amber-800 dark:bg-amber-950/30 dark:text-amber-200",children:t("signingAddressNotFound")}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("network")}),e.jsx(Tn,{chainId:C})]}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("signingAddress")}),e.jsx(ar,{chainId:C,address:o,copyable:!1,size:"sm"})]}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("transaction")}),e.jsx("div",{className:"max-h-44 overflow-y-auto",children:e.jsx("pre",{className:"font-mono text-xs break-all whitespace-pre-wrap",children:ae})})]}),e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[e.jsx(Oe,{className:"mt-0.5 size-5 shrink-0 text-amber-600"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:t("signTxWarning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:ne,disabled:y,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("cancel")}),e.jsx("button",{onClick:q,disabled:y||!E||!T||_,className:D("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","flex items-center justify-center gap-2 disabled:opacity-50"),children:t("sign")})]})]}):l==="wallet_lock"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 p-4",children:[!T&&e.jsx("div",{className:"rounded-xl bg-amber-50 p-3 text-sm text-amber-800 dark:bg-amber-950/30 dark:text-amber-200",children:t("signingAddressNotFound")}),e.jsx(ft,{value:m,onChange:F,onComplete:W,minPoints:4,disabled:y||!T,error:b,errorText:b?t("walletLock.error"):void 0}),j&&!b&&e.jsx("div",{className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:j}),y&&e.jsxs("div",{className:"bg-muted text-muted-foreground flex items-center justify-center gap-2 rounded-xl p-3 text-sm",children:[e.jsx(be,{className:"size-4 animate-spin"}),t("signing")]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:M,disabled:y,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("back")}),e.jsx("button",{onClick:ne,disabled:y,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("cancel")})]})]}):l==="two_step_secret"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx(bs,{value:h,onChange:se=>K(se.target.value),placeholder:t("transaction:sendPage.twoStepSecretPlaceholder"),disabled:y,"aria-describedby":j?"miniapp-sign-two-step-secret-error":void 0,"data-testid":"miniapp-sign-two-step-secret-input"}),j&&e.jsx("div",{id:"miniapp-sign-two-step-secret-error",className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:j}),y&&e.jsxs("div",{className:"bg-muted text-muted-foreground flex items-center justify-center gap-2 rounded-xl p-3 text-sm",children:[e.jsx(be,{className:"size-4 animate-spin"}),t("signing")]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:M,disabled:y,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("back")}),e.jsx("button",{onClick:ie,disabled:y||h.trim().length===0,className:D("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","disabled:opacity-50"),children:t("confirm")})]})]}):e.jsx("div",{className:"space-y-4 p-4",children:e.jsxs("div",{className:"bg-muted text-muted-foreground flex items-center justify-center gap-2 rounded-xl p-3 text-sm",children:[e.jsx(be,{className:"size-4 animate-spin"}),t("signing")]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const kd=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Wy,{})});kd.__docgenInfo={description:"",methods:[],displayName:"MiniappSignTransactionJob"};function vo(t){const s=Qn(t);if(s)return dt.getName(s);try{return`Chain ${Rf(t)}`}catch{return t}}function yo(t){return Qn(t)}function $y(){const{t}=B("common"),{pop:s}=Z(),{fromChainId:n,toChainId:a,appName:r,appIcon:o}=he(),d=vo(n),i=vo(a),l=yo(n),u=yo(a),m=()=>{const h=new CustomEvent("chain-switch-confirm",{detail:{approved:!0,toChainId:a}});window.dispatchEvent(h),s()},f=()=>{const h=new CustomEvent("chain-switch-confirm",{detail:{approved:!1}});window.dispatchEvent(h),s()};return e.jsx(pe,{onCancel:f,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Lt,{title:t("switchNetwork"),description:`${r||t("unknownDApp")} ${t("requestsNetworkSwitch")}`,appName:r,appIcon:o}),e.jsxs("div",{className:"flex items-center justify-center gap-4 px-6 py-8",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[l?e.jsx(_t,{chain:l,size:"lg"}):e.jsx("div",{className:"bg-muted flex size-12 items-center justify-center rounded-full",children:e.jsx(Oe,{className:"text-muted-foreground size-6"})}),e.jsx("span",{className:"text-muted-foreground text-sm",children:d})]}),e.jsx(pc,{className:"text-primary size-8"}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[u?e.jsx(_t,{chain:u,size:"lg"}):e.jsx("div",{className:"bg-muted flex size-12 items-center justify-center rounded-full",children:e.jsx(Oe,{className:"text-muted-foreground size-6"})}),e.jsx("span",{className:"font-medium",children:i})]})]}),e.jsx("div",{className:"bg-warning/10 border-warning/20 mx-4 mb-4 rounded-lg border p-3",children:e.jsx("p",{className:"text-warning text-sm",children:t("chainSwitchWarning")})}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:f,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("cancel")}),e.jsx("button",{onClick:m,className:"bg-primary hover:bg-primary/90 text-primary-foreground flex-1 rounded-xl py-3 font-medium transition-colors",children:t("confirm")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Cd=({params:t})=>e.jsx(me,{params:t,children:e.jsx($y,{})});Cd.__docgenInfo={description:"",methods:[],displayName:"ChainSwitchConfirmJob"};function qy(){const{t}=B("common"),{pop:s}=Z(),n=he(),a=Xt.parse(n.actions),r=n.duration,{address:o,chainId:d,appName:i,appIcon:l}=n,u=Le.state.wallets.find(k=>k.chainAddresses.some(I=>I.address===o)),m=u?.name,f=u?.id,[h,g]=c.useState([]),[b,p]=c.useState(!1),[x,v]=c.useState(!1),[j,N]=c.useState(r),y=c.useCallback(async k=>{v(!0),p(!1);try{const I=Be(k),_=await vs.getAllWallets();if(_.length===0){p(!0),g([]),v(!1);return}let A=!1;for(const E of _)try{await vs.getMnemonic(E.id,I),A=!0;break}catch{}if(A&&f){const E=new CustomEvent("crypto-authorize-confirm",{detail:{approved:!0,patternKey:I,walletId:f,selectedDuration:j}});window.dispatchEvent(E),s()}else p(!0),g([])}catch{p(!0),g([])}finally{v(!1)}},[s,j]),S=c.useCallback(()=>{const k=new CustomEvent("crypto-authorize-confirm",{detail:{approved:!1}});window.dispatchEvent(k),s()},[s]);return e.jsx(pe,{onCancel:S,children:e.jsxs("div",{className:"bg-background flex max-h-[85vh] flex-col rounded-t-2xl",children:[e.jsx("div",{className:"flex flex-shrink-0 justify-center py-2",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Lt,{title:t("cryptoAuthorize"),description:i||t("unknownDApp"),appName:i,appIcon:l,walletInfo:{name:m||t("unknownWallet"),address:o,chainId:d||"bfmeta"}}),e.jsx("div",{className:"min-h-0 flex-1 space-y-3 overflow-y-auto px-4 py-3",children:e.jsxs("div",{className:"bg-muted/50 space-y-2 rounded-xl p-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tn,{className:"text-primary size-4 flex-shrink-0"}),e.jsxs("span",{className:"text-muted-foreground",children:[t("permissions"),""]}),e.jsx("span",{className:"truncate font-medium",children:a.map(k=>Ym[k]?.name||k).join("")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-muted-foreground ml-6",children:[t("duration"),""]}),e.jsxs(Ws,{value:j,onValueChange:k=>N(k),children:[e.jsx($s,{className:"h-7 w-24 text-xs",children:e.jsx(qs,{})}),e.jsx(Hs,{children:Zm.map(k=>e.jsx(Yt,{value:k,children:ef[k]},k))})]})]})]})}),e.jsxs("div",{className:"flex-shrink-0 px-4 pb-2",children:[e.jsx("p",{className:"text-muted-foreground mb-2 text-center text-xs",children:t("drawPatternToConfirm")}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-[280px]",children:e.jsx(ft,{value:h,onChange:g,onComplete:y,error:b,disabled:x})})}),e.jsx("div",{className:"flex h-6 items-center justify-center",children:x&&e.jsxs("div",{className:"text-muted-foreground flex items-center gap-2",children:[e.jsx(be,{className:"size-4 animate-spin"}),e.jsx("span",{className:"text-xs",children:t("verifying")})]})})]}),e.jsx("div",{className:"flex-shrink-0 px-4 pb-2",children:e.jsx("button",{onClick:S,disabled:x,className:"bg-muted hover:bg-muted/80 w-full rounded-xl py-2.5 text-sm font-medium transition-colors disabled:opacity-50",children:t("cancel")})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)] flex-shrink-0"})]})})}const Sd=({params:t})=>e.jsx(me,{params:t,children:e.jsx(qy,{})});Sd.__docgenInfo={description:"",methods:[],displayName:"CryptoAuthorizeJob"};const Hy={"zh-CN":"","zh-TW":"",en:"English",ja:"",ko:"",ar:""},Uy={USD:"USD ($)",CNY:"CNY ()",EUR:"EUR ()",JPY:"JPY ()",KRW:"KRW ()"};function Wr(){const{navigate:t}=de(),{push:s}=Z(),{t:n}=B(["settings","common","security","error"]),a=Fe(),r=tr(),o=ts(),d=Ro(),i=Mo(),l=nt(),u=Av(),[m,f]=c.useState(!1),[h,g]=c.useState("loading");c.useEffect(()=>{async function N(){if(!a){g("unavailable");return}const y=a.chainAddresses.find(S=>S.chain==="bfmeta"||S.chain==="bfm");if(!y){g("unavailable");return}try{const S=He.getChainById(Pa.state,"bfmeta");if(!S){g("unavailable");return}const k=await _v(S,y.address);g(k?"set":"not_set")}catch{g("unavailable")}}N()},[a]);const b=()=>n(`settings:appearance.${i}`),p=()=>{switch(u.status){case"checking":return n("settings:update.checking");case"update-available":return n("settings:update.available");case"up-to-date":return n("settings:update.upToDate");case"error":return n("settings:update.failed");case"not-dweb":return n("settings:update.dwebRequired");default:return n("settings:update.notChecked")}},x=async()=>{const N=await Sv.check("manual");if(N.status==="not-dweb"){l.show(n("error:crypto.dwebEnvironmentRequired"));return}if(N.status==="error"){l.show(n("settings:update.failed"));return}N.status==="up-to-date"&&l.show(n("settings:update.upToDate"))},v=()=>{switch(h){case"loading":return"...";case"set":return n("security:twoStepSecret.alreadySet");case"not_set":return n("security:twoStepSecret.notSet");default:return n("settings:notSupported")}},j=async()=>{if(h!=="not_set"||!a)return;const N=a.chainAddresses.find(k=>k.chain==="bfmeta"||k.chain==="bfm");if(!N)return;const y=He.getChainById(Pa.state,"bfmeta");if(!y)return;const S=await Ev(y);qv(async(k,I)=>{const _=await Pv({chainConfig:y,walletId:a.id,password:I,fromAddress:N.address,newTwoStepSecret:k});return _.status==="ok"?(g("set"),{success:!0,txHash:_.txHash}):_.status==="password"?{success:!1,error:n("security:passwordConfirm.verifying")}:_.status==="already_set"?(g("set"),{success:!1,error:n("security:twoStepSecret.alreadySet")}):{success:!1,error:_.message}},S??void 0,async()=>{const{getChainProvider:k}=await Et(async()=>{const{getChainProvider:_}=await import("./index-DwhhC-lB.js").then(A=>A.x);return{getChainProvider:_}},__vite__mapDeps([2,3,1,4,5,6,7,8,9,10]),import.meta.url),I=k(y.id);if(!I.bioGetAccountInfo)return!1;try{return!!(await I.bioGetAccountInfo(N.address)).secondPublicKey}catch{return!1}}),s("SetTwoStepSecretJob",{chainName:"BioForest Chain"})};return e.jsxs("div",{className:"bg-muted/30 flex h-full flex-col overflow-y-auto",children:[e.jsx(J,{title:n("common:a11y.tabSettings")}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("button",{type:"button",onClick:()=>t({to:"/my-card"}),className:"bg-card hover:bg-accent flex w-full items-center gap-4 rounded-xl p-4 shadow-sm transition-colors","data-testid":"my-card-button",children:[e.jsx(Ns,{src:r.avatar,size:56}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("h2",{className:"font-semibold",children:r.username||n("common:myCard.defaultName")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:n("settings:items.myCard")})]}),e.jsx(_p,{size:20,className:"text-muted-foreground"})]}),e.jsxs(_s,{title:n("settings:sections.walletManagement"),children:[e.jsx(Ae,{icon:e.jsx(lr,{size:20}),label:n("settings:items.walletManagement"),onClick:()=>t({to:`/wallet/${a?.id??""}`})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ae,{icon:e.jsx(yc,{size:20}),label:n("settings:items.walletChains"),onClick:()=>t({to:"/settings/wallet-chains"}),testId:"wallet-chains-button"}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ae,{icon:e.jsx(rp,{size:20}),label:n("settings:items.addressBook"),onClick:()=>t({to:"/address-book"}),testId:"address-book-button"})]}),e.jsxs(_s,{title:n("settings:sections.security"),children:[e.jsx(Ae,{icon:e.jsx(tn,{size:20}),label:n("settings:items.appLock"),value:n("settings:notSupported"),disabled:!0}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ae,{icon:e.jsx(fr,{size:20}),label:n("settings:items.viewMnemonic"),onClick:()=>t({to:"/settings/mnemonic"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ae,{icon:e.jsx(gr,{size:20}),label:n("settings:items.changeWalletLock"),onClick:()=>t({to:"/settings/wallet-lock"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ae,{icon:e.jsx(Bm,{size:20}),label:n("security:twoStepSecret.setup"),value:v(),onClick:j,disabled:h==="set"||h==="unavailable",testId:"set-pay-password-button"})]}),e.jsxs(_s,{title:n("settings:sections.preferences"),children:[e.jsx(Ae,{icon:e.jsx(Rp,{size:20}),label:n("settings:items.language"),value:Hy[o],onClick:()=>t({to:"/settings/language"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ae,{icon:e.jsx(vp,{size:20}),label:n("settings:items.currency"),value:Uy[d],onClick:()=>t({to:"/settings/currency"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ae,{icon:e.jsx(Wp,{size:20}),label:n("settings:items.appearance"),value:b(),onClick:()=>f(!0)}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ae,{icon:e.jsx(Bp,{size:20}),label:n("settings:items.chainConfig"),onClick:()=>t({to:"/settings/chains"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ae,{icon:e.jsx(jc,{size:20}),label:n("settings:items.miniappSources"),onClick:()=>t({to:"/settings/sources"})})]}),e.jsxs(_s,{title:n("settings:sections.about"),allowContextMenu:!0,children:[e.jsx(Ae,{icon:e.jsx(cf,{size:20}),label:n("settings:items.aboutApp"),value:"v1.0.4-021713",onClick:()=>{}}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ae,{icon:e.jsx(rs,{size:20}),label:n("settings:update.check"),value:p(),onClick:x}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ae,{icon:e.jsx(gc,{size:20}),label:n("settings:items.storage"),onClick:()=>t({to:"/settings/storage"}),testId:"storage-button"})]}),e.jsx("div",{className:"h-[var(--tab-bar-height)]"})]}),e.jsx(zl,{open:m,onOpenChange:f})]})}Wr.__docgenInfo={description:"",methods:[],displayName:"SettingsPage"};function Ad(){return e.jsx(Wr,{})}Ad.__docgenInfo={description:`SettingsTab - 

 SettingsPage `,methods:[],displayName:"SettingsTab"};const Id=({params:t})=>{const{push:s}=Z(),[n,a]=c.useState(t.tab||"wallet"),r=c.useRef(Promise.resolve()),o=c.useRef(0);return c.useEffect(()=>{tf(),Qr().setPermissionRequestCallback(async(l,u,m)=>{const f=sf.state.apps.get(l)?.manifest.icon;return new Promise(h=>{const g=window.setTimeout(()=>h(!1),3e4),b=p=>{window.clearTimeout(g);const x=p.detail;h(x?.approved===!0)};window.addEventListener("permission-request",b,{once:!0}),s("PermissionRequestJob",{appName:u,appIcon:f,permissions:JSON.stringify(m)})})}),Xr(async l=>{const u=l?.app?.name,m=l?.app?.icon;return new Promise(f=>{const h=window.setTimeout(()=>f(null),3e4),g=()=>{window.clearTimeout(h),window.removeEventListener("wallet-picker-select",b),window.removeEventListener("wallet-picker-cancel",p)},b=x=>{g();const v=x.detail;f({address:v.address,chain:v.chain,name:v.name})},p=()=>{g(),f(null)};window.addEventListener("wallet-picker-select",b),window.addEventListener("wallet-picker-cancel",p),s("WalletPickerJob",{chain:l?.chain,exclude:l?.exclude,...u?{appName:u}:{},...m?{appIcon:m}:{}})})}),Yr(()=>{const l=Le.state,u=Xs.getCurrentWallet(l);return u?u.chainAddresses.map(m=>({address:m.address,chain:m.chain,name:u.name})):[]}),Zr(async l=>new Promise(u=>{const m=window.setTimeout(()=>u(null),6e4),f=h=>{window.clearTimeout(m);const g=h.detail;if(g?.confirmed&&g.signature&&g.publicKey){u({signature:g.signature,publicKey:g.publicKey});return}u(null)};window.addEventListener("signing-confirm",f,{once:!0}),s("SigningConfirmJob",{message:l.message,address:l.address,appName:l.app.name,appIcon:l.app.icon??"",chainName:l.chainName})}));const d=(l,u)=>{console.log("[miniapp-transfer-sheet]",l,u)},i=(l,u)=>{d("queue.enqueue",u);const m=r.current.catch(()=>{}).then(async()=>(d("queue.start",u),l()));return r.current=m.then(()=>{d("queue.done",u)},f=>{const h=f instanceof Error?f.message:String(f);d("queue.error",{...u,message:h})}),m};return ei(async l=>{const u=`transfer-${Date.now()}-${++o.current}`;return new Promise(m=>{i(()=>new Promise(f=>{let h=!1,g=!1;const b=()=>{window.removeEventListener("miniapp-transfer-confirm",v),window.removeEventListener("miniapp-transfer-sheet-closed",j)},p=N=>{h||(h=!0,m(N),g&&b())},x=N=>{g||(g=!0,d("queue.release",{requestId:u,source:"bio",reason:N,resultSettled:h}),f(),h&&b())},v=N=>{const y=N.detail;if(y?.requestId!==u){d("dialog.ignore",{requestId:u,source:"bio",incomingRequestId:y?.requestId??"unknown"});return}if(d("dialog.receive",{requestId:u,source:"bio",confirmed:y?.confirmed===!0}),y?.confirmed&&y.txHash){p({txHash:y.txHash,txId:y.txId,transaction:y.transaction});return}p(null)},j=N=>{const y=N.detail;y?.requestId===u&&(d("dialog.sheet-closed",{requestId:u,source:"bio",reason:y?.reason??"unknown"}),h||p(null),x(y?.reason??"sheet-closed"))};window.addEventListener("miniapp-transfer-confirm",v),window.addEventListener("miniapp-transfer-sheet-closed",j),d("dialog.push",{requestId:u,source:"bio",from:l.from,to:l.to,chain:l.chain}),s("MiniappTransferConfirmJob",{requestId:u,appName:l.app.name,appIcon:l.app.icon??"",from:l.from,to:l.to,amount:l.amount,chain:l.chain,...l.asset?{asset:l.asset}:{},...l.remark?{remark:l.remark}:{}})}),{requestId:u,source:"bio"})})}),ti(async l=>{const u=`destroy-${Date.now()}-${++o.current}`;return new Promise(m=>{i(()=>new Promise(f=>{let h=!1,g=!1;const b=()=>{window.removeEventListener("miniapp-destroy-confirm",v),window.removeEventListener("miniapp-destroy-sheet-closed",j)},p=N=>{h||(h=!0,m(N),g&&b())},x=N=>{g||(g=!0,d("queue.release",{requestId:u,source:"destroy",reason:N,resultSettled:h}),f(),h&&b())},v=N=>{const y=N.detail;if(y?.requestId!==u){d("dialog.ignore",{requestId:u,source:"destroy",incomingRequestId:y?.requestId??"unknown"});return}if(d("dialog.receive",{requestId:u,source:"destroy",confirmed:y?.confirmed===!0}),y?.confirmed&&y.txHash){p({txHash:y.txHash,txId:y.txId,transaction:y.transaction});return}p(null)},j=N=>{const y=N.detail;y?.requestId===u&&(d("dialog.sheet-closed",{requestId:u,source:"destroy",reason:y?.reason??"unknown"}),h||p(null),x(y?.reason??"sheet-closed"))};window.addEventListener("miniapp-destroy-confirm",v),window.addEventListener("miniapp-destroy-sheet-closed",j),d("dialog.push",{requestId:u,source:"destroy",from:l.from,chain:l.chain,asset:l.asset}),s("MiniappDestroyConfirmJob",{requestId:u,appName:l.app.name,appIcon:l.app.icon??"",from:l.from,amount:l.amount,chain:l.chain,asset:l.asset,...l.remark?{remark:l.remark}:{}})}),{requestId:u,source:"destroy"})})}),si(async l=>new Promise(u=>{const m=window.setTimeout(()=>u(null),6e4),f=h=>{window.clearTimeout(m);const g=h.detail;if(g?.confirmed&&g.signedTx){u(g.signedTx);return}u(null)};window.addEventListener("miniapp-sign-transaction-confirm",f,{once:!0}),s("MiniappSignTransactionJob",{appName:l.app.name,appIcon:l.app.icon??"",from:l.from,chain:l.chain,unsignedTx:Xt.stringify(l.unsignedTx)})})),ni(async l=>{const u=l.app?.name,m=l.app?.icon;return new Promise(f=>{const h=window.setTimeout(()=>f(null),3e4),g=()=>{window.clearTimeout(h),window.removeEventListener("wallet-picker-select",b),window.removeEventListener("wallet-picker-cancel",p)},b=x=>{g();const v=x.detail;f({address:v.address,chain:v.chain,name:v.name})},p=()=>{g(),f(null)};window.addEventListener("wallet-picker-select",b),window.addEventListener("wallet-picker-cancel",p),s("WalletPickerJob",{chain:l.chainId,...u?{appName:u}:{},...m?{appIcon:m}:{}})})}),oi(async l=>new Promise(u=>{const m=window.setTimeout(()=>u(!1),3e4),f=h=>{window.clearTimeout(m);const g=h.detail;u(g?.approved===!0)};window.addEventListener("chain-switch-confirm",f,{once:!0}),s("ChainSwitchConfirmJob",{fromChainId:l.fromChainId,toChainId:l.toChainId,appName:l.appName,appIcon:l.appIcon})})),ai(async l=>new Promise(u=>{const m=window.setTimeout(()=>u(null),6e4),f=h=>{window.clearTimeout(m);const g=h.detail;if(g?.confirmed&&g.signature){u({signature:g.signature});return}u(null)};window.addEventListener("signing-confirm",f,{once:!0}),s("SigningConfirmJob",{message:l.message,address:l.address,appName:l.appName,chainName:"ethereum"})})),ri(async l=>{const{from:u,to:m,value:f,chainId:h}=l.tx;if(!u||!m)return null;const b=BigInt(f??"0x0").toString(),p=h?Qn(h):null,x=`transfer-${Date.now()}-${++o.current}`;return new Promise(v=>{i(()=>new Promise(j=>{let N=!1,y=!1;const S=()=>{window.removeEventListener("miniapp-transfer-confirm",_),window.removeEventListener("miniapp-transfer-sheet-closed",A)},k=E=>{N||(N=!0,v(E),y&&S())},I=E=>{y||(y=!0,d("queue.release",{requestId:x,source:"evm",reason:E,resultSettled:N}),j(),N&&S())},_=E=>{const C=E.detail;if(C?.requestId!==x){d("dialog.ignore",{requestId:x,source:"evm",incomingRequestId:C?.requestId??"unknown"});return}if(d("dialog.receive",{requestId:x,source:"evm",confirmed:C?.confirmed===!0}),C?.confirmed&&C.txHash){k({txHash:C.txHash});return}k(null)},A=E=>{const C=E.detail;C?.requestId===x&&(d("dialog.sheet-closed",{requestId:x,source:"evm",reason:C?.reason??"unknown"}),N||k(null),I(C?.reason??"sheet-closed"))};window.addEventListener("miniapp-transfer-confirm",_),window.addEventListener("miniapp-transfer-sheet-closed",A),d("dialog.push",{requestId:x,source:"evm",from:u,to:m,chain:p??"ethereum"}),s("MiniappTransferConfirmJob",{requestId:x,appName:l.appName,from:u,to:m,amount:b,chain:p??"ethereum"})}),{requestId:x,source:"evm"})})}),ii(async l=>{const u=l?.app?.name,m=l?.app?.icon;return new Promise(f=>{const h=window.setTimeout(()=>f(null),3e4),g=()=>{window.clearTimeout(h),window.removeEventListener("wallet-picker-select",b),window.removeEventListener("wallet-picker-cancel",p)},b=x=>{g();const v=x.detail;f({address:v.address,chain:v.chain,name:v.name})},p=()=>{g(),f(null)};window.addEventListener("wallet-picker-select",b),window.addEventListener("wallet-picker-cancel",p),s("WalletPickerJob",{chain:"tron",...u?{appName:u}:{},...m?{appIcon:m}:{}})})}),ci(l=>async u=>new Promise(m=>{const f=window.setTimeout(()=>m({approved:!1}),6e4),h=g=>{window.clearTimeout(f);const b=g.detail;if(b?.approved&&b.patternKey&&b.walletId){m({approved:!0,patternKey:b.patternKey,walletId:b.walletId,selectedDuration:b.selectedDuration});return}m({approved:!1})};window.addEventListener("crypto-authorize-confirm",h,{once:!0}),s("CryptoAuthorizeJob",{actions:Xt.stringify(u.actions),duration:u.duration,address:u.address,chainId:u.chainId,appName:u.app.name,appIcon:u.app.icon})})),()=>{Qr().setPermissionRequestCallback(null),Xr(null),ni(null),oi(null),ai(null),ri(null),ii(null),ci(null),Yr(null),Zr(null),ei(null),ti(null),si(null)}},[s]),e.jsx(le,{children:e.jsx(Tm,{children:e.jsxs("div",{className:"bg-background relative h-dvh",children:[e.jsx(c.Activity,{mode:n==="wallet"?"visible":"hidden",children:e.jsx(Ll,{})}),e.jsx("div",{style:{display:n==="ecosystem"?"contents":"none"},children:e.jsx(Dl,{})}),e.jsx(c.Activity,{mode:n==="settings"?"visible":"hidden",children:e.jsx(Ad,{})}),e.jsx(Nm,{activeTab:n,onTabChange:a})]})})})};Id.__docgenInfo={description:"",methods:[],displayName:"MainTabsActivity"};function Td(){const{t}=B("wallet"),{navigate:s,goBack:n}=de(),{push:a}=Z(),r=Ie(Le,m=>m.wallets),o=Ie(Le,m=>m.currentWalletId),d=c.useCallback(m=>{ye.setCurrentWallet(m)},[]),i=c.useCallback(m=>{s({to:`/wallet/${m}`})},[s]),l=c.useCallback(()=>{a("WalletAddJob",{})},[a]),u=c.useCallback(()=>{n()},[n]);return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(J,{title:t("list.title"),onBack:u,rightAction:e.jsx("button",{onClick:l,className:D("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":t("add"),children:e.jsx(mt,{className:"size-5"})})}),e.jsx("div",{className:"flex-1 p-4",children:r.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[e.jsx("p",{className:"text-muted-foreground",children:t("list.empty")}),e.jsx("button",{onClick:l,className:D("bg-primary rounded-full px-6 py-2.5 text-sm font-medium text-primary-foreground","hover:bg-primary/90 active:bg-primary/80"),children:t("add")})]}):e.jsx("div",{className:"space-y-3",children:r.map(m=>e.jsx(Vy,{wallet:m,isActive:m.id===o,onSelect:()=>d(m.id),onDetail:()=>i(m.id),t},m.id))})})]})}function Vy({wallet:t,isActive:s,onSelect:n,onDetail:a,t:r}){return e.jsxs("div",{className:D("bg-card rounded-xl p-4 shadow-sm transition-colors",s&&"ring-primary ring-2"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:n,className:D("flex size-12 items-center justify-center rounded-full text-lg font-semibold",s?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),children:t.name.slice(0,1)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"truncate font-semibold",children:t.name}),s&&e.jsxs("span",{className:"text-primary flex items-center gap-1 text-xs",children:[e.jsx(Ne,{className:"size-3"}),r("list.current")]})]}),e.jsx("p",{className:"text-muted-foreground text-sm",children:r("list.chainAddresses",{count:t.chainAddresses.length})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-semibold",children:["$",0 .toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})}),e.jsx("button",{onClick:a,className:D("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":r("list.viewDetail"),children:e.jsx(De,{className:"text-muted-foreground size-5"})})]})]}),e.jsx("p",{className:"text-muted-foreground mt-2 truncate font-mono text-xs",children:t.address})]})}Td.__docgenInfo={description:"",methods:[],displayName:"WalletListPage"};const Pd=()=>e.jsx(le,{children:e.jsx(Td,{})});Pd.__docgenInfo={description:"",methods:[],displayName:"WalletListActivity"};function Jy(){const{t}=B("wallet"),{walletId:s,mode:n="default"}=he(),{goBack:a,navigate:r}=de(),d=Rt().find(u=>u.id===s),i=()=>{r({to:"/",replace:!0})};if(!d)return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(J,{title:t("detail.title"),onBack:a}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(Qt,{variant:"error",children:t("detail.notFound")})})]});const l=t(n==="edit-only"?"detail.editTitle":"detail.title");return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(J,{title:l,...n!=="edit-only"&&{onBack:a}}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsx(ta,{mode:n,walletId:s,onEditOnlyComplete:i}),n==="default"&&e.jsx("div",{className:"mt-6",children:e.jsx(Qt,{variant:"warning",children:t("detail.securityWarning")})})]})]})}const Ed=({params:t})=>e.jsx(le,{children:e.jsx(me,{params:t,children:e.jsx(Jy,{})})});Ed.__docgenInfo={description:"",methods:[],displayName:"WalletConfigActivity"};const Ky=["pattern","mnemonic","verify","chains","theme"];function _d(){const{goBack:t,navigate:s}=de(),{t:n}=B("onboarding"),a=Ys(),r=ts(),[o,d]=c.useState("pattern"),[i,l]=c.useState(""),[u]=c.useState(()=>{if(typeof window<"u"){const w=window.__E2E_MNEMONIC__;if(typeof w=="string"&&w.trim())return w.trim().split(/\s+/);if(Array.isArray(w)&&w.every(P=>typeof P=="string"))return w}return wm()}),[m,f]=c.useState(!0),[h,g]=c.useState(!1),[b,p]=c.useState([]),[x,v]=c.useState(!1),[j,N]=c.useState(!1),[y,S]=c.useState(null),k=Ky.indexOf(o)+1;c.useEffect(()=>{!x&&a.length>0&&(p(ac(a)),v(!0))},[a,x]);const I=()=>{o==="mnemonic"?(d("pattern"),l("")):o==="verify"?d("mnemonic"):o==="chains"?d("verify"):o==="theme"||t()},_=w=>{l(w),d("mnemonic")},A=()=>{(h||!m)&&d("verify")},E=()=>{d("chains")},C=async()=>{if(!j){N(!0);try{const w=u.join(" "),L=(await rc({mnemonic:w,selectedChainIds:b,chainConfigs:a})).map(({chainId:M,address:F,publicKey:K})=>({chain:M,address:F,publicKey:K??"",tokens:[]})),z=L[0];if(!z)throw new Error("No chain addresses derived");const R=Ta(z.address),q=await ye.createWallet({name:n("create.generatedNamePattern",{word:En(r),suffix:n("create.walletSuffix")}),keyType:"mnemonic",address:z.address,chain:z.chain,chainAddresses:L,themeHue:R},w,i,R);S(q.id),d("theme")}catch{}finally{N(!1)}}},T=()=>{s({to:"/",replace:!0})};return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(J,{title:n("create.title"),onBack:I}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(jt,{total:5,current:k})}),e.jsxs("div",{className:"flex-1 p-4",children:[o==="pattern"&&e.jsx("div",{"data-testid":"pattern-step",children:e.jsx(pr,{onComplete:_,minPoints:4})}),o==="mnemonic"&&e.jsx("div",{"data-testid":"mnemonic-step",children:e.jsx(Gy,{mnemonic:u,hidden:m,copied:h,onToggleHidden:()=>f(!m),onCopy:()=>g(!0),onContinue:A})}),o==="verify"&&e.jsx("div",{"data-testid":"verify-step",children:e.jsx(Qy,{mnemonic:u,onContinue:E})}),o==="chains"&&e.jsx("div",{"data-testid":"chain-selector-step",children:e.jsx(Xy,{chains:a,selectedChains:b,selectionCount:b.length,onSelectionChange:p,onComplete:C,completeLabel:n("create.nextStep"),isSubmitting:j})}),o==="theme"&&y&&e.jsx("div",{"data-testid":"theme-step",children:e.jsx(ta,{mode:"edit-only",walletId:y,onEditOnlyComplete:T})})]})]})}function Gy({mnemonic:t,hidden:s,copied:n,onToggleHidden:a,onCopy:r,onContinue:o}){const{t:d}=B("onboarding"),i=n||!s;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(en,{icon:e.jsx(gr,{className:"size-full"}),variant:"warning",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:d("create.backupMnemonic")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:d("create.backupHint")})]}),e.jsx(Qt,{variant:"warning",children:d("create.mnemonicWarning")}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:d("create.mnemonicTitle")}),e.jsxs("button",{type:"button","data-testid":"toggle-mnemonic-button",onClick:a,className:"text-primary flex items-center gap-1 text-sm",children:[s?e.jsx(fr,{className:"size-4"}):e.jsx(ic,{className:"size-4"}),d(s?"create.mnemonicShow":"create.mnemonicHide")]})]}),e.jsx(nc,{words:t,hidden:s,onCopy:r})]}),e.jsxs(Ue,{variant:"mint",className:"w-full","data-testid":"mnemonic-backed-up-button",disabled:!i,onClick:o,children:[d(i?"create.mnemonicBackedUp":"create.mnemonicViewFirst"),i&&e.jsx(De,{className:"ml-2 size-4"})]})]})}function Qy({mnemonic:t,onContinue:s}){const{t:n}=B(["onboarding","common"]),[a]=c.useState(()=>Array.from({length:t.length},(f,h)=>h).toSorted(()=>Math.random()-.5).slice(0,3).toSorted((f,h)=>f-h)),[r,o]=c.useState({}),d=a.every(u=>{const m=t[u],f=r[u];return m&&f&&f.toLowerCase()===m.toLowerCase()}),i=(u,m)=>{o(f=>({...f,[u]:m}))},l=u=>{const m=t[u],f=r[u];if(f&&m&&f.toLowerCase()!==m.toLowerCase())return n("create.wordIncorrect")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(en,{icon:e.jsx(ws,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:n("create.verifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("create.verifyDesc")})]}),e.jsx("div",{className:"space-y-4",children:a.map(u=>e.jsx(Jm,{label:n("create.wordN",{n:u+1}),error:l(u),children:e.jsx(Ve,{"data-testid":`verify-word-input-${u}`,"data-verify-index":u,value:r[u]||"",onChange:m=>i(u,m.target.value),className:D(l(u)&&"border-destructive focus-visible:ring-destructive"),placeholder:n("create.wordNPlaceholder",{n:u+1}),autoCapitalize:"off",autoCorrect:"off"})},u))}),e.jsx(Ue,{variant:"mint",className:"w-full","data-testid":"verify-next-button",disabled:!d,onClick:s,children:n("common:next")})]})}function Xy({chains:t,selectedChains:s,selectionCount:n,isSubmitting:a,completeLabel:r,onSelectionChange:o,onComplete:d}){const{t:i}=B(["onboarding","common"]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(en,{icon:e.jsx(ws,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:i("chainSelector.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:i("chainSelector.subtitle")})]}),t.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(Pe,{})}):e.jsx(hr,{"data-testid":"chain-selector",chains:t,selectedChains:s,onSelectionChange:o}),e.jsx(Ue,{variant:"mint",className:"w-full","data-testid":"chain-selector-complete-button",disabled:n===0||a,onClick:d,children:r})]})}_d.__docgenInfo={description:"",methods:[],displayName:"WalletCreatePage"};const Md=()=>e.jsx(le,{children:e.jsx(_d,{})});Md.__docgenInfo={description:"",methods:[],displayName:"WalletCreateActivity"};function Yy(t,s){return{symbol:t.symbol,name:t.name,balance:t.amount.toFormatted(),decimals:t.decimals,fiatValue:void 0,chain:s,icon:t.icon,change24h:0,contractAddress:t.contractAddress}}function Rd(t,s){return t.map(n=>Yy(n,s))}const Zy={ETH:{amount:"0.002",symbol:"ETH"},USDT:{amount:"0.003",symbol:"ETH"},USDC:{amount:"0.003",symbol:"ETH"},BTC:{amount:"0.0001",symbol:"BTC"},TRX:{amount:"1",symbol:"TRX"},BFM:{amount:"0.1",symbol:"BFM"}},bo={step:"input",asset:null,toAddress:"",amount:null,addressError:null,amountError:null,feeAmount:null,feeMinAmount:null,feeSymbol:"",feeLoading:!1,isSubmitting:!1,resultStatus:null,txHash:null,errorMessage:null},je=ke.t.bind(ke);function $r(t){const s=[],n=new Set;let a=t;for(;a instanceof Error&&!n.has(a);)n.add(a),a.message&&s.push(a.message),a=a.cause;return s}function eb(t){return/timeout|timed out|etimedout|aborterror|aborted/i.test(t)}function tb(t){return/failed to broadcast transaction|broadcast failed|tx_broadcast_failed/i.test(t)}function jo(t){return/cannot transfer(?:\s+\w+)*\s+to yourself||/i.test(t)}function sb(t){return/^broadcast failed:?$/i.test(t.trim())||/^failed to broadcast transaction:?$/i.test(t.trim())}function nb(t){if(t instanceof as&&typeof t.details?.reason=="string")return t.details.reason.trim()||null;for(const s of $r(t)){const a=s.trim().match(/^(?:failed to create tron transaction|trc20 transaction build failed)\s*:\s*(.+)$/i);if(a?.[1])return a[1].trim()}return null}function ab(t){if(t instanceof as&&typeof t.details?.reason=="string")return t.details.reason.trim()||null;for(const s of $r(t)){const n=s.trim(),a=n.match(/^broadcast failed:\s*(.+)$/i);if(a?.[1])return a[1].trim();if(tb(n)&&!sb(n))return n}return null}function rb(t){return $r(t).some(s=>eb(s))}function ib(t){const s=t.trim().replace(/^0x/i,"");if(!/^[0-9a-fA-F]{64}$/.test(s))return null;try{return Nn(s)}catch{return null}}function ob(t,s){const n=ib(t);try{if(s.chainKind==="evm")return Nn(ia(t,"ethereum",0,0).privateKey);if(s.chainKind==="tron")return Nn(ia(t,"tron",0,0).privateKey);if(s.chainKind==="bitcoin")return Nn(ia(t,"bitcoin",0,0).privateKey)}catch{if(n)return n;throw new Error(je("error:crypto.keyDerivationFailed"))}if(n)return n;throw new Error(je("error:chain.transferNotImplemented"))}async function cb({chainConfig:t,fromAddress:s,toAddress:n,amount:a}){const r=Ee(t.id);if(!r.supportsFeeEstimate||!r.supportsBuildTransaction)throw new Error(`Chain ${t.id} does not support fee estimation`);const o=a&&a.isPositive()?a:oe.fromRaw("1",t.decimals,t.symbol),d=await r.buildTransaction({type:"transfer",from:s,to:n,amount:o});return{amount:(await r.estimateFee(d)).standard.amount,symbol:t.symbol}}async function lb({chainConfig:t,walletId:s,password:n,fromAddress:a,toAddress:r,amount:o}){let d;try{d=await vs.getMnemonic(s,n)}catch(i){return i instanceof Qs&&i.code===ys.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:i instanceof Error?i.message:je("error:transaction.unknownError")}}if(!o.isPositive())return{status:"error",message:je("error:validation.enterValidAmount")};try{const i=Ee(t.id);if(!i.supportsFullTransaction)return{status:"error",message:je("error:transaction.chainNotSupported",{chainId:t.id})};const l=ob(d,t),u=await i.buildTransaction({type:"transfer",from:a,to:r,amount:o}),m=await i.signTransaction(u,{privateKey:l});return{status:"ok",txHash:await i.broadcastTransaction(m)}}catch(i){const l=i instanceof Error?i.message:String(i);if(i instanceof as){if(i.code===Ze.TX_BUILD_FAILED){const u=nb(i);return u&&jo(u)?{status:"error",message:je("error:validation.cannotTransferToSelf")}:{status:"error",message:u??l}}if(i.code===Ze.TRANSACTION_TIMEOUT||rb(i))return{status:"error",message:je("transaction:broadcast.timeout")};if(i.code===Ze.TX_BROADCAST_FAILED){const u=ab(i);return{status:"error",message:u?`${je("transaction:broadcast.failed")}: ${u}`:je("transaction:broadcast.failed")}}}return l.includes("insufficient")||l.includes("balance")?{status:"error",message:je("error:insufficientFunds")}:l.includes("fee")||l.includes("gas")?{status:"error",message:je("error:transaction.insufficientGas")}:l.includes("not yet implemented")||l.includes("not supported")?{status:"error",message:je("error:chain.transferNotImplemented")}:jo(l)?{status:"error",message:je("error:validation.cannotTransferToSelf")}:{status:"error",message:l||je("error:transaction.failed")}}}function db(t,s){const n=Ee(t.id);return n.supportsAddressValidation?!s||s.trim()===""?je("error:validation.enterRecipientAddress"):n.isValidAddress(s)?!s||s.trim()===""?je("error:validation.enterReceiverAddress"):n.isValidAddress(s)?null:je("error:validation.invalidAddress"):je("error:validation.invalidAddressFormat"):je("error:validation.unsupportedChainType")}const tt=ke.t.bind(ke);function Ld(t,s){return t.trim()?s?Df(t):Hm(t):!1}function ub(t,s,n){return t.trim()?Ld(t,s)?s&&n&&t.trim()===n.trim()?tt("error:validation.cannotTransferToSelf"):null:tt("error:validation.invalidAddressFormat"):tt("error:validation.enterRecipientAddress")}function mb(t,s){return t?s?t.isPositive()?t.gt(s.amount)?tt("error:insufficientFunds"):null:tt("error:validation.enterValidAmount"):null:tt("error:validation.enterAmount")}function fb(t){const{toAddress:s,amount:n,asset:a,isBioforestChain:r,feeAmount:o,feeLoading:d}=t;return!a||!n||d||!o?!1:s.trim()!==""&&Ld(s,r)&&n.isPositive()&&n.lte(a.amount)}function Dd(t,s,n){if(!t)return{status:"error",message:tt("error:validation.enterValidAmount")};const a=s.amount;if(s.assetType===n.symbol){if(t.add(n).lte(a))return{status:"ok"};if(!t.eq(a))return{status:"error",message:tt("error:insufficientFunds")};const o=a.sub(n);return o.isPositive()?{status:"ok",adjustedAmount:o}:{status:"error",message:tt("error:insufficientFunds")}}else return t.lte(a)?{status:"ok"}:{status:"error",message:tt("error:insufficientFunds")}}const No=ke.t.bind(ke);async function pb(t){t(s=>({...s,step:"sending",isSubmitting:!0}));try{if(await new Promise(n=>setTimeout(n,2e3)),Math.random()>.2)return t(n=>({...n,step:"result",isSubmitting:!1,resultStatus:"success",txHash:`0x${Math.random().toString(16).slice(2)}${Math.random().toString(16).slice(2)}`,errorMessage:null})),{status:"ok"};throw new Error(No("error:transaction.transactionFailed"))}catch(s){return t(n=>({...n,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:s instanceof Error?s.message:No("error:transaction.unknownError")})),{status:"error"}}}const Ge=ke.t.bind(ke);function hb(t={}){const{initialAsset:s,useMock:n=!0,walletId:a,fromAddress:r,chainConfig:o,getBalance:d}=t,[i,l]=c.useState({...bo,asset:s??null}),u=c.useRef(null),m=c.useRef(0),f=o?.chainKind==="bioforest",h=o?.chainKind==="evm"||o?.chainKind==="tron"||o?.chainKind==="bitcoin",g=c.useCallback(C=>h&&o?db(o,C):ub(C,f,r),[f,h,o,r]),b=c.useCallback((C,T)=>mb(C,T),[]),p=c.useCallback(C=>{l(T=>({...T,toAddress:C,addressError:null}))},[]),x=c.useCallback(C=>{l(T=>({...T,amount:C,amountError:null}))},[]),v=c.useCallback(C=>{l(T=>{if(!T.feeAmount)return T;const w=oe.fromFormatted(C,T.feeAmount.decimals,T.feeAmount.symbol);return{...T,feeAmount:w}})},[]),j=c.useCallback(C=>{l(T=>({...T,asset:C,feeAmount:null,feeMinAmount:null,feeSymbol:"",feeLoading:!1}))},[]);c.useEffect(()=>{if(u.current&&(clearTimeout(u.current),u.current=null),!i.asset)return;const C=n||!f&&!h||!o||!r,T=i.toAddress.trim(),w=i.amount?.isPositive()===!0,P=o?.chainKind==="tron"&&r!==void 0&&r.trim().length>0&&r.trim()===T;if(!(T.length>0&&w&&!P)){l(R=>!R.feeLoading&&R.feeAmount===null&&R.feeMinAmount===null&&R.feeSymbol===""?R:{...R,feeLoading:!1,feeAmount:null,feeMinAmount:null,feeSymbol:""});return}l(R=>({...R,feeLoading:!0,feeAmount:null,feeMinAmount:null,feeSymbol:""}));const z=++m.current;return u.current=setTimeout(()=>{(async()=>{try{const R=C?(()=>{const q=Zy[i.asset.assetType]??{amount:"0.001",symbol:i.asset.assetType};return{amount:oe.fromFormatted(q.amount,i.asset.decimals,q.symbol),symbol:q.symbol}})():h&&o&&r?await cb({chainConfig:o,fromAddress:r,toAddress:T,amount:i.amount??void 0}):await Tv(o,r);if(z!==m.current)return;l(q=>({...q,feeAmount:R.amount,feeMinAmount:R.amount,feeSymbol:R.symbol,feeLoading:!1}))}catch(R){if(z!==m.current)return;l(q=>({...q,feeAmount:null,feeMinAmount:null,feeSymbol:"",feeLoading:!1,errorMessage:R instanceof Error?R.message:Ge("error:transaction.feeEstimateFailed")}))}})()},300),()=>{u.current&&(clearTimeout(u.current),u.current=null)}},[o,r,f,h,i.amount,i.asset,i.toAddress,n]);const N=c.useMemo(()=>!i.asset?.assetType||!d?i.asset?.amount??null:d(i.asset.assetType)??i.asset?.amount??null,[i.asset?.assetType,i.asset?.amount,d]),y=c.useMemo(()=>!i.asset||!N?i.asset:N.decimals===i.asset.decimals?{...i.asset,amount:N}:{...i.asset,amount:N,decimals:N.decimals},[i.asset,N]),S=c.useMemo(()=>fb({toAddress:i.toAddress,amount:i.amount,asset:y,isBioforestChain:f,feeAmount:i.feeAmount,feeLoading:i.feeLoading}),[f,i.amount,y,i.toAddress,i.feeAmount,i.feeLoading]),k=c.useCallback(()=>{const C=g(i.toAddress),T=y?b(i.amount,y):Ge("error:validation.selectAsset");if(C||T)return l(w=>({...w,addressError:C,amountError:T})),!1;if(y&&i.feeAmount&&i.amount){const w=Dd(i.amount,y,i.feeAmount);if(w.status==="error")return l(P=>({...P,amountError:w.message})),!1;w.adjustedAmount&&l(P=>({...P,amount:w.adjustedAmount??P.amount}))}return l(w=>({...w,step:"confirm",addressError:null,amountError:null})),!0},[i.toAddress,i.amount,y,i.feeAmount,g,b]),I=c.useCallback(()=>{l(C=>({...C,step:"input"}))},[]),_=c.useCallback(async C=>{if(n)return(await pb(l)).status==="ok"?{status:"ok"}:{status:"error",message:Ge("transaction:broadcast.unknown")};if(!o)return l(L=>({...L,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:Ge("error:transaction.chainConfigMissing")})),{status:"error"};if(o.chainKind==="evm"||o.chainKind==="tron"||o.chainKind==="bitcoin"){if(!a||!r||!i.asset||!i.amount)return l(z=>({...z,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:Ge("error:transaction.walletInfoIncomplete")})),{status:"error"};l(z=>({...z,step:"sending",isSubmitting:!0,errorMessage:null}));const L=await lb({chainConfig:o,walletId:a,password:C,fromAddress:r,toAddress:i.toAddress,amount:i.amount});return L.status==="password"?(l(z=>({...z,step:"confirm",isSubmitting:!1})),{status:"password"}):L.status==="error"?(l(z=>({...z,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:L.message})),{status:"error",message:L.message}):(l(z=>({...z,step:"result",isSubmitting:!1,resultStatus:"success",txHash:L.txHash,errorMessage:null})),{status:"ok",txHash:L.txHash})}if(o.chainKind!=="bioforest")return l(L=>({...L,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:Ge("error:transaction.unsupportedChainType",{chainType:o.chainKind})})),{status:"error"};if(!a||!r||!i.asset)return l(L=>({...L,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:Ge("error:wallet.incompleteInfo")})),{status:"error"};const T=g(i.toAddress),w=b(i.amount,i.asset);if(T||w)return l(L=>({...L,addressError:T,amountError:w})),{status:"error"};if(l(L=>({...L,step:"sending",isSubmitting:!0,errorMessage:null})),!i.amount)return l(L=>({...L,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:Ge("error:transaction.invalidAmount")})),{status:"error"};const P=await no({chainConfig:o,walletId:a,password:C,fromAddress:r,toAddress:i.toAddress,amount:i.amount,assetType:i.asset.assetType,fee:i.feeAmount??void 0});return P.status==="password"?(l(L=>({...L,step:"confirm",isSubmitting:!1})),{status:"password"}):P.status==="password_required"?(l(L=>({...L,step:"confirm",isSubmitting:!1})),{status:"two_step_secret_required",secondPublicKey:P.secondPublicKey}):P.status==="error"?(l(L=>({...L,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:P.message})),{status:"error",message:P.message,pendingTxId:P.pendingTxId}):(l(L=>({...L,step:"result",isSubmitting:!1,resultStatus:"success",txHash:P.txHash,errorMessage:null})),{status:"ok",txHash:P.txHash,pendingTxId:P.pendingTxId})},[o,r,i.amount,i.asset,i.toAddress,n,g,b,a]),A=c.useCallback(async(C,T)=>{if(!o||!a||!r)return{status:"error"};if(l(P=>({...P,step:"sending",isSubmitting:!0,resultStatus:null,txHash:null,errorMessage:null})),!i.amount||!i.asset)return l(P=>({...P,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:Ge("error:transaction.invalidAmount")})),{status:"error"};const w=await no({chainConfig:o,walletId:a,password:C,fromAddress:r,toAddress:i.toAddress,amount:i.amount,assetType:i.asset.assetType,fee:i.feeAmount??void 0,twoStepSecret:T});return w.status==="password"?(l(P=>({...P,step:"confirm",isSubmitting:!1})),{status:"password"}):w.status==="error"?(l(P=>({...P,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:w.message})),{status:"error",message:w.message,pendingTxId:w.pendingTxId}):w.status==="password_required"?(l(P=>({...P,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:Ge("error:transaction.securityPasswordFailed")})),{status:"error"}):(l(P=>({...P,step:"result",isSubmitting:!1,resultStatus:"success",txHash:w.txHash,errorMessage:null})),{status:"ok",txHash:w.txHash,pendingTxId:w.pendingTxId})},[o,r,i.amount,i.toAddress,a]),E=c.useCallback(()=>{l({...bo,asset:s??null})},[s]);return{state:i,setToAddress:p,setAmount:x,setAsset:j,setFee:v,goToConfirm:k,goBack:I,submit:_,submitWithTwoStepSecret:A,reset:E,canProceed:S}}function xb(){const{t}=B(["transaction","common","security"]),{goBack:s}=de(),{push:n}=Z(),a=nt(),r=rn(),o=c.useRef(!1),{address:d,amount:i,assetType:l,assetLocked:u}=he(),m=u==="true",f=Je(),h=Fe(),g=Gn(),b=ut(),p=b.snapshot?He.getChainById(b,f):null,x=sr(f),j=os().tokenBalances.useState({address:g?.address??""},{enabled:!!g?.address}),N=c.useMemo(()=>j?.data?Rd(j.data,f):[],[j?.data,f]),y=c.useMemo(()=>{if(!p)return null;if(l){const O=N.find(G=>G.symbol.toUpperCase()===l.toUpperCase());return O?{assetType:O.symbol,name:O.name,amount:oe.fromFormatted(O.balance,O.decimals??p.decimals,O.symbol),decimals:O.decimals??p.decimals,logoUrl:O.icon}:null}const X=N.find(O=>O.symbol===p.symbol)?.balance??"0";return{assetType:p.symbol,name:p.name,amount:oe.fromFormatted(X,p.decimals,p.symbol),decimals:p.decimals}},[p,N,l]),S=c.useCallback(H=>{const X=N.find(O=>O.symbol===H);return X?oe.fromFormatted(X.balance,X.decimals??p?.decimals??8,X.symbol):null},[N,p?.decimals]),{state:k,setToAddress:I,setAmount:_,setAsset:A,setFee:E,goToConfirm:C,submit:T,submitWithTwoStepSecret:w,canProceed:P}=hb({initialAsset:y??void 0,useMock:!1,walletId:h?.id,fromAddress:g?.address,chainConfig:p,getBalance:S}),L=c.useMemo(()=>{if(!k.asset)return null;const H=S(k.asset.assetType);return{symbol:k.asset.assetType,name:k.asset.name??k.asset.assetType,balance:H?.toFormatted()??k.asset.amount.toFormatted(),decimals:k.asset.decimals,chain:f,icon:k.asset.logoUrl}},[k.asset,f,S]),z=c.useCallback(H=>{const X={assetType:H.symbol,name:H.name,amount:oe.fromFormatted(H.balance,H.decimals??p?.decimals??8,H.symbol),decimals:H.decimals??p?.decimals??8,logoUrl:H.icon};A(X)},[p?.decimals,A]),R=c.useRef(!1);c.useEffect(()=>{y&&!R.current&&!k.asset&&(A(y),R.current=!0)},[y,A,k.asset]),c.useEffect(()=>{if(d&&!k.toAddress&&I(d),i&&!k.amount&&k.asset){const H=oe.tryFromFormatted(i,k.asset.decimals,k.asset.assetType);H&&_(H)}},[d,i,k.toAddress,k.amount,k.asset,I,_]),c.useEffect(()=>{const H=X=>{I(X.detail.address.address)};return window.addEventListener("contact-picker-select",H),()=>window.removeEventListener("contact-picker-select",H)},[I]),c.useEffect(()=>{if(k.resultStatus==="success"&&k.toAddress){const H=er.getContactByAddress(Os.state,k.toAddress);H&&Jn.trackRecentContact(H.contact.id)}},[k.resultStatus,k.toAddress]);const q=c.useCallback(()=>{n("ContactPickerJob",{chainType:f})},[n,f]),M=c.useMemo(()=>k.asset?S(k.asset.assetType):null,[S,k.asset]),F=k.asset?.assetType??"TOKEN",K=k.feeSymbol||p?.symbol,ee=!!K&&K===F,W=c.useMemo(()=>!(!k.asset||k.toAddress.trim().length===0||!k.amount?.isPositive()),[k.amount,k.asset,k.toAddress]),$=c.useMemo(()=>k.feeLoading?t("sendPage.feeEstimating"):k.feeAmount?`${k.feeAmount.toFormatted()} ${k.feeSymbol||F}`:t(W?"sendPage.feeUnavailable":"sendPage.feePending"),[W,k.feeAmount,k.feeLoading,k.feeSymbol,F,t]),ie=c.useMemo(()=>{if(!k.asset||!M)return;if(!k.feeAmount)return M;const H={...k.asset,amount:M,decimals:M.decimals},X=Dd(M,H,k.feeAmount);return X.status==="ok"?X.adjustedAmount??M:oe.zero(M.decimals,H.assetType)},[M,k.asset,k.feeAmount]),ne=ee&&(!k.feeAmount||k.feeLoading),ae=c.useCallback(()=>{_f(({content:H,parsed:X})=>{let O=H;X.type==="address"||X.type==="payment"?O=X.address:X.type==="contact"&&X.addresses.length>0&&(O=X.addresses[0].address),I(O),r.impact("success"),a.show(t("sendPage.scanSuccess"))}),n("ScannerJob",{chainType:x??f})},[n,f,x,I,r,a,t]),se=()=>{C()&&(r.impact("light"),ed(async()=>{o.current||(o.current=!0,await r.impact("medium"),sd(async(H,X)=>{if(!X){const G=await T(H);return G.status==="password"?{status:"wallet_lock_invalid"}:G.status==="two_step_secret_required"?{status:"two_step_secret_required"}:G.status==="ok"?(o.current=!1,{status:"ok",txHash:G.txHash,pendingTxId:G.pendingTxId}):G.status==="error"?{status:"error",message:G.message??t("transaction:broadcast.unknown"),pendingTxId:G.pendingTxId}:{status:"error",message:t("transaction:broadcast.unknown")}}const O=await w(H,X);return O.status==="ok"?(o.current=!1,{status:"ok",txHash:O.txHash,pendingTxId:O.pendingTxId}):O.status==="password"?{status:"two_step_secret_invalid",message:t("error:transaction.securityPasswordWrong")}:O.status==="error"?{status:"error",message:O.message??t("transaction:broadcast.unknown"),pendingTxId:O.pendingTxId}:{status:"error",message:t("transaction:broadcast.unknown")}}),n("TransferWalletLockJob",{title:t("security:walletLock.verifyTitle")}))},{minFee:k.feeMinAmount?.toFormatted()??k.feeAmount?.toFormatted()??"0",onFeeChange:E}),n("TransferConfirmJob",{amount:k.amount?.toFormatted()??"0",symbol:F,toAddress:k.toAddress,feeAmount:k.feeAmount?.toFormatted()??"0",feeSymbol:k.feeSymbol,feeLoading:k.feeLoading?"true":"false"}))};return!h||!g?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(J,{title:t("sendPage.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("history.noWallet")})})]}):e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(J,{title:t("sendPage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"bg-muted/50 space-y-2 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(_t,{chain:f,size:"sm"}),e.jsx("span",{className:"text-sm font-medium",children:x})]}),g?.address&&e.jsxs("div",{className:"text-muted-foreground flex items-center justify-center gap-1 text-xs",children:[e.jsxs("span",{children:[t("sendPage.from"),":"]}),e.jsxs("span",{className:"font-mono",children:[g.address.slice(0,8),"...",g.address.slice(-6)]})]})]}),N.length>1&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("sendPage.assetLabel")}),e.jsx(Zo,{selectedAsset:L,assets:N,onSelect:z,disabled:m,testId:"send-asset-selector"})]}),e.jsx(Um,{label:t("sendPage.toAddressLabel"),value:k.toAddress,onChange:I,placeholder:t("sendPage.toAddressPlaceholder",{chain:x}),onScan:ae,onContactPicker:q,chainType:f,error:k.addressError??void 0}),e.jsx(oc,{label:t("sendPage.amountLabel"),value:k.amount??void 0,onChange:_,balance:M??void 0,max:ie,maxDisabled:ne,symbol:F,error:k.amountError??void 0,fiatValue:k.amount?k.amount.toNumber().toFixed(2):void 0}),e.jsxs("div",{className:"text-muted-foreground flex items-center justify-between text-xs",children:[e.jsx("span",{children:t("sendPage.fee")}),e.jsx("span",{children:$})]}),e.jsx(Qt,{variant:"info",children:t("sendPage.networkWarning",{chain:x})}),e.jsx("div",{className:"pt-4",children:e.jsxs(Ue,{variant:"mint",className:"w-full","data-testid":"send-continue-button",disabled:!P,onClick:se,children:[t("sendPage.continue"),e.jsx(De,{className:"-mr-4 ml-2 size-4"})]})})]})]})}function zd(){const{goBack:t}=de(),s=Je(),{t:n}=B(["transaction","common"]);return e.jsx(zt,{chainId:s,fallback:e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(J,{title:n("sendPage.title"),onBack:t}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Chain not supported"})})]}),children:e.jsx(xb,{})})}zd.__docgenInfo={description:"",methods:[],displayName:"SendPage"};const Od=({params:t})=>e.jsx(le,{children:e.jsx(me,{params:t,children:e.jsx(Uo,{children:e.jsx(zd,{})})})});Od.__docgenInfo={description:"",methods:[],displayName:"SendActivity"};const Xe=ke.t.bind(ke),wo={step:"input",asset:null,amount:null,amountError:null,recipientAddress:null,feeAmount:null,feeMinAmount:null,feeSymbol:"",feeLoading:!1,isSubmitting:!1,resultStatus:null,txHash:null,errorMessage:null},Ps={amount:"0.001",symbol:"BFM"};function gb(t,s){if(!t||!s)return null;if(!t.isPositive())return Xe("error:validation.enterValidAmount");const n=s.amount;return t.gt(n)?Xe("error:validation.exceedsBalance"):null}function vb(t={}){const{initialAsset:s,assetLocked:n=!1,useMock:a=!0,walletId:r,fromAddress:o,chainConfig:d}=t,[i,l]=c.useState({...wo,asset:s??null}),u=d?.chainKind==="bioforest",m=c.useCallback((N,y)=>gb(N,y),[]),f=c.useCallback(N=>{l(y=>({...y,amount:N,amountError:null}))},[]),h=c.useCallback(N=>{if(l(S=>({...S,asset:N,amount:null,amountError:null,feeLoading:!0,recipientAddress:null})),a||!u||!d||!o){setTimeout(()=>{l(S=>({...S,recipientAddress:"mock_apply_address",feeAmount:oe.fromFormatted(Ps.amount,N.decimals,Ps.symbol),feeMinAmount:oe.fromFormatted(Ps.amount,N.decimals,Ps.symbol),feeSymbol:d?.symbol??Ps.symbol,feeLoading:!1}))},300);return}(async()=>{try{const S=await jd(d,N.assetType,o);if(!S){l(I=>({...I,feeLoading:!1,errorMessage:Xe("error:transaction.issuerAddressNotFound")}));return}const k=await Nd(d,N.assetType,"1");l(I=>({...I,recipientAddress:S,feeAmount:k.amount,feeMinAmount:k.amount,feeSymbol:k.symbol,feeLoading:!1}))}catch(S){l(k=>({...k,feeLoading:!1,errorMessage:S instanceof Error?S.message:Xe("error:transaction.feeEstimateFailed")}))}})()},[d,o,u,a]);c.useEffect(()=>{s&&!i.recipientAddress&&h(s)},[s,h,i.recipientAddress]);const g=c.useMemo(()=>!!(i.asset&&i.amount&&i.amount.isPositive()&&i.recipientAddress&&!i.feeLoading),[i.amount,i.asset,i.recipientAddress,i.feeLoading]),b=c.useCallback(()=>{const N=m(i.amount,i.asset);return N?(l(y=>({...y,amountError:N})),!1):i.recipientAddress?(l(y=>({...y,step:"confirm",amountError:null})),!0):(l(y=>({...y,errorMessage:Xe("error:transaction.issuerAddressNotReady")})),!1)},[i.amount,i.asset,i.recipientAddress,m]),p=c.useCallback(()=>{l(N=>({...N,step:"input"}))},[]),x=c.useCallback(async N=>{if(a)return l(S=>({...S,step:"burning",isSubmitting:!0})),await new Promise(S=>setTimeout(S,1500)),l(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"success",txHash:`mock_burn_tx_${Date.now()}`})),{status:"ok",txHash:`mock_burn_tx_${Date.now()}`};if(!d||d.chainKind!=="bioforest")return l(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:Xe("error:burn.bioforestOnly")})),{status:"error",message:Xe("error:burn.bioforestOnly")};if(!r||!o||!i.asset||!i.amount||!i.recipientAddress)return l(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:Xe("error:transaction.paramsIncomplete")})),{status:"error",message:Xe("error:transaction.paramsIncomplete")};l(S=>({...S,step:"burning",isSubmitting:!0,errorMessage:null}));const y=await Vn({chainConfig:d,walletId:r,password:N,fromAddress:o,recipientAddress:i.recipientAddress,assetType:i.asset.assetType,amount:i.amount,fee:i.feeAmount??void 0});return y.status==="password"?(l(S=>({...S,step:"confirm",isSubmitting:!1})),{status:"password"}):y.status==="password_required"?(l(S=>({...S,step:"confirm",isSubmitting:!1})),{status:"two_step_secret_required",secondPublicKey:y.secondPublicKey}):y.status==="error"?(l(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:y.message})),{status:"error",message:y.message}):(l(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"success",txHash:y.txHash})),{status:"ok",txHash:y.txHash})},[d,o,i.amount,i.asset,i.feeAmount,i.recipientAddress,a,r]),v=c.useCallback(async(N,y)=>{if(!d||!r||!o||!i.asset||!i.amount||!i.recipientAddress)return{status:"error",message:Xe("error:transaction.paramsIncomplete")};l(k=>({...k,step:"burning",isSubmitting:!0,errorMessage:null}));const S=await Vn({chainConfig:d,walletId:r,password:N,fromAddress:o,recipientAddress:i.recipientAddress,assetType:i.asset.assetType,amount:i.amount,fee:i.feeAmount??void 0,twoStepSecret:y});return S.status==="password"?(l(k=>({...k,step:"confirm",isSubmitting:!1})),{status:"password"}):S.status==="error"?(l(k=>({...k,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:S.message})),{status:"error",message:S.message}):S.status==="password_required"?(l(k=>({...k,step:"confirm",isSubmitting:!1})),{status:"two_step_secret_required",secondPublicKey:S.secondPublicKey}):(l(k=>({...k,step:"result",isSubmitting:!1,resultStatus:"success",txHash:S.txHash})),{status:"ok",txHash:S.txHash})},[d,o,i.amount,i.asset,i.feeAmount,i.recipientAddress,r]),j=c.useCallback(()=>{l({...wo,asset:s??null})},[s]);return{state:i,setAmount:f,setAsset:h,goToConfirm:b,goBack:p,submit:x,submitWithTwoStepSecret:v,reset:j,canProceed:g,assetLocked:n}}function ko(t){return{assetType:t.symbol,name:t.name,amount:oe.fromFormatted(t.balance,t.decimals??8,t.symbol),decimals:t.decimals??8,logoUrl:t.icon}}function yb(t,s){return{symbol:t.assetType,name:t.name??t.assetType,balance:t.amount.toFormatted(),decimals:t.decimals,chain:s,icon:t.logoUrl}}function bb(){const{t}=B(["transaction","common","security"]),{goBack:s}=de(),{push:n}=Z(),a=nt(),r=rn(),o=c.useRef(!1),{assetType:d,assetLocked:i}=he(),l=Je(),u=Fe(),m=Gn(),f=ut(),h=f.snapshot?He.getChainById(f,l):null,g=sr(l),p=os().tokenBalances.useState({address:m?.address??""},{enabled:!!m?.address}),x=c.useMemo(()=>p?.data?Rd(p.data,l):[],[p?.data,l]),v=c.useMemo(()=>h?x.filter(K=>K.symbol.toUpperCase()!==h.symbol.toUpperCase()):[],[x,h]),j=c.useMemo(()=>{if(!d||v.length===0)return null;const K=v.find(ee=>ee.symbol.toUpperCase()===d.toUpperCase());return K?ko(K):null},[d,v]),N=i==="true",{state:y,setAmount:S,setAsset:k,goToConfirm:I,submit:_,submitWithTwoStepSecret:A,reset:E,canProceed:C}=vb({initialAsset:j??void 0,assetLocked:N,useMock:!1,walletId:u?.id,fromAddress:m?.address,chainConfig:h}),T=c.useCallback(K=>{k(ko(K))},[k]),w=c.useMemo(()=>y.asset?yb(y.asset,l):null,[y.asset,l]),P=y.asset?.amount??null,L=y.asset?.assetType??"TOKEN",z=()=>{I()&&(r.impact("light"),ed(async()=>{o.current||(o.current=!0,await r.impact("medium"),sd(async(K,ee)=>{if(!ee){const $=await _(K);return $.status==="password"?{status:"wallet_lock_invalid"}:$.status==="two_step_secret_required"?{status:"two_step_secret_required"}:$.status==="ok"?(o.current=!1,{status:"ok",txHash:$.txHash,pendingTxId:$.pendingTxId}):$.status==="error"?{status:"error",message:$.message,pendingTxId:$.pendingTxId}:{status:"error",message:t("error:destroy.failed")}}const W=await A(K,ee);return W.status==="ok"?(o.current=!1,{status:"ok",txHash:W.txHash,pendingTxId:W.pendingTxId}):W.status==="password"?{status:"two_step_secret_invalid",message:t("error:security.passwordInvalid")}:W.status==="error"?{status:"error",message:W.message,pendingTxId:W.pendingTxId}:{status:"error",message:t("error:unknown")}}),n("TransferWalletLockJob",{title:t("security:walletLock.verifyTitle")}))},{minFee:y.feeMinAmount?.toFormatted()??y.feeAmount?.toFormatted()??"0"}),n("TransferConfirmJob",{amount:y.amount?.toFormatted()??"0",symbol:L,toAddress:y.recipientAddress??"",feeAmount:y.feeAmount?.toFormatted()??"0",feeSymbol:y.feeSymbol,feeLoading:y.feeLoading?"true":"false"}))},R=()=>{y.resultStatus==="success"&&r.impact("success"),s()},q=()=>{E()},M=c.useCallback(()=>{if(!y.txHash)return;const K=h?.explorer?.queryTx;if(!K){a.show(t("sendPage.explorerNotImplemented"));return}const ee=K.replace(":hash",y.txHash).replace(":signature",y.txHash);window.open(ee,"_blank","noopener,noreferrer")},[y.txHash,h?.explorer?.queryTx,a,t]),F=h?.chainKind==="bioforest";return!u||!m?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(J,{title:t("destroyPage.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("history.noWallet")})})]}):F?y.step==="result"||y.step==="burning"?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(J,{title:t("destroyPage.resultTitle")}),e.jsx(qf,{status:y.step==="burning"?"pending":y.resultStatus??"pending",amount:y.amount?.toFormatted()??"0",symbol:L,toAddress:y.recipientAddress??"",txHash:y.txHash??void 0,errorMessage:y.errorMessage??void 0,onDone:R,onRetry:y.resultStatus==="failed"?q:void 0,onViewExplorer:y.resultStatus==="success"&&h?.explorer?.queryTx?M:void 0})]}):e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(J,{title:t("destroyPage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"bg-muted/50 space-y-2 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(_t,{chain:l,size:"sm"}),e.jsx("span",{className:"text-sm font-medium",children:g})]}),m?.address&&e.jsxs("div",{className:"text-muted-foreground flex items-center justify-center gap-1 text-xs",children:[e.jsxs("span",{children:[t("sendPage.from"),":"]}),e.jsxs("span",{className:"font-mono",children:[m.address.slice(0,8),"...",m.address.slice(-6)]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("destroyPage.assetLabel")}),e.jsx(Zo,{selectedAsset:w,assets:v,onSelect:T,disabled:N,excludeAssets:h?[h.symbol]:[],testId:"destroy-asset-selector"}),v.length===0&&e.jsx("p",{className:"text-muted-foreground text-xs",children:t("destroyPage.noDestroyableAssets")})]}),y.asset&&e.jsx(oc,{label:t("destroyPage.amountLabel"),value:y.amount??void 0,onChange:S,balance:P??void 0,symbol:L,error:y.amountError??void 0}),e.jsx(Qt,{variant:"warning",children:t("destroyPage.warning")}),y.feeAmount&&e.jsx("div",{className:"bg-muted/50 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:t("sendPage.fee")}),e.jsxs("span",{className:"font-medium",children:[y.feeAmount.toFormatted()," ",y.feeSymbol]})]})}),e.jsx("div",{className:"pt-4",children:e.jsxs(Ue,{variant:"mint",className:"w-full","data-testid":"destroy-confirm-button",disabled:!C,onClick:z,children:[e.jsx(In,{className:"mr-2 -ml-4 size-4"}),t("destroyPage.confirm")]})})]})]}):e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(J,{title:t("destroyPage.title"),onBack:s}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx(In,{className:"text-muted-foreground size-16"}),e.jsx("p",{className:"text-muted-foreground text-center",children:t("destroyPage.notSupported")})]})]})}function Bd(){const{goBack:t}=de(),s=Je(),{t:n}=B(["transaction","common"]);return e.jsx(zt,{chainId:s,fallback:e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(J,{title:n("destroyPage.title"),onBack:t}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Chain not supported"})})]}),children:e.jsx(bb,{})})}Bd.__docgenInfo={description:"",methods:[],displayName:"DestroyPage"};const Fd=({params:t})=>e.jsx(le,{children:e.jsx(me,{params:t,children:e.jsx(Uo,{children:e.jsx(Bd,{})})})});Fd.__docgenInfo={description:"",methods:[],displayName:"DestroyActivity"};function Wd(){const{t}=B(["transaction","common"]),{goBack:s}=de(),n=vr(),a=nt(),r=rn(),o=Gn(),d=Je(),i=sr(d),l=tr(),[u,m]=c.useState(!1),[f,h]=c.useState(!1),g=c.useRef(null),b=o?.address||"",p=l.username||t("common:myCard.defaultName"),x=c.useMemo(()=>b?cr({name:p,addresses:[{address:b,label:i}],avatar:l.avatar}):"",[p,b,i,l.avatar]),v=async()=>{b&&(await n.write({text:b}),await r.impact("light"),m(!0),a.show(t("receivePage.addressCopied")),setTimeout(()=>m(!1),2e3))},j=c.useCallback(async()=>{const y=g.current;if(!(!y||f)){h(!0);try{const{snapdom:S}=await Et(async()=>{const{snapdom:k}=await import("./snapdom-CO8q8LPW.js").then(I=>I.s);return{snapdom:k}},__vite__mapDeps([0,1]),import.meta.url);await S.download(y,{type:"png",filename:`receive-${d}-${b.slice(0,8)}.png`,scale:2,quality:1}),await r.impact("success"),a.show(t("receivePage.imageSaved"))}catch{}finally{h(!1)}}},[b,d,f,r,a,t]),N=c.useCallback(async()=>{const y=g.current;if(!(!y||f)){h(!0);try{if(navigator.share){const{snapdom:S}=await Et(async()=>{const{snapdom:A}=await import("./snapdom-CO8q8LPW.js").then(E=>E.s);return{snapdom:A}},__vite__mapDeps([0,1]),import.meta.url),I=await(await S(y,{scale:2})).toBlob(),_=new File([I],`receive-${d}.png`,{type:"image/png"});await navigator.share({title:t("receivePage.shareTitle"),text:b,files:[_]}),await r.impact("success")}}catch{}finally{h(!1)}}},[b,d,f,r,t]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:t("receivePage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"text-muted-foreground flex items-center justify-center gap-2",children:[e.jsx(_t,{chain:d,size:"sm"}),e.jsx("span",{className:"text-sm",children:i})]}),e.jsx("div",{ref:g,className:"flex justify-center",children:e.jsx(dr,{name:p,avatar:l.avatar,addresses:[{address:b,label:i}],qrContent:x,caption:t("common:contactCard.transferToMe")})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm font-medium",children:t("receivePage.receiveAddress")}),e.jsx("div",{className:"border-border bg-card rounded-xl border p-4",children:e.jsx(ot,{address:b,copyable:!0})})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(V,{variant:"outline",className:"flex-1",onClick:v,children:u?e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"mr-2 size-4"}),t("receivePage.copied")]}):e.jsxs(e.Fragment,{children:[e.jsx(Fo,{className:"mr-2 size-4"}),t("receivePage.copyAddress")]})}),e.jsxs(V,{variant:"outline",className:"flex-1",onClick:j,disabled:f,children:[f?e.jsx(be,{className:"mr-2 size-4 animate-spin"}):e.jsx(nn,{className:"mr-2 size-4"}),t("receivePage.saveImage")]})]}),e.jsxs(Ue,{variant:"mint",className:"w-full",onClick:N,disabled:f,children:[f?e.jsx(be,{className:"mr-2 size-4 animate-spin"}):e.jsx(Kp,{className:"mr-2 size-4"}),t("receivePage.share")]}),e.jsx(Qt,{variant:"info",children:t("receivePage.networkWarning",{chain:i})})]})]})}Wd.__docgenInfo={description:"",methods:[],displayName:"ReceivePage"};const $d=()=>e.jsx(le,{children:e.jsx(Wd,{})});$d.__docgenInfo={description:"",methods:[],displayName:"ReceiveActivity"};const qd=()=>e.jsx(le,{children:e.jsx(Wr,{})});qd.__docgenInfo={description:"",methods:[],displayName:"SettingsActivity"};const jb={"zh-CN":"","zh-TW":"",en:"English",ar:""};function Hd(){const{goBack:t}=de(),{t:s}=B("settings"),n=ts(),a=r=>{Jn.setLanguage(r),t()};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:s("languagePage.title"),onBack:t}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:Object.keys(om).map((r,o)=>e.jsxs("div",{children:[o>0&&e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsxs("button",{onClick:()=>a(r),className:D("flex w-full items-center justify-between px-4 py-3.5","hover:bg-muted/50 active:bg-muted transition-colors",r===n&&"bg-primary/5"),children:[e.jsx("span",{className:"text-sm font-medium",children:jb[r]}),r===n&&e.jsx(Ne,{className:"text-primary size-5"})]})]},r))}),e.jsx("p",{className:"text-muted-foreground mt-4 px-1 text-xs",children:s("languagePage.hint")})]})]})}Hd.__docgenInfo={description:"",methods:[],displayName:"LanguagePage"};const Ud=()=>e.jsx(le,{children:e.jsx(Hd,{})});Ud.__docgenInfo={description:"",methods:[],displayName:"SettingsLanguageActivity"};function Vd(){const{t}=B("settings"),{goBack:s}=de(),n=Ro(),a=r=>{Jn.setCurrency(r),s()};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:t("currency.title"),onBack:s}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:Object.keys(Jr).map((r,o)=>e.jsxs("div",{children:[o>0&&e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsxs("button",{onClick:()=>a(r),className:D("flex w-full items-center justify-between px-4 py-3.5","hover:bg-muted/50 active:bg-muted transition-colors",r===n&&"bg-primary/5"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-muted-foreground text-base font-semibold",children:Jr[r].symbol}),e.jsx("span",{className:"text-sm font-medium",children:t(`currency.names.${r}`)})]}),r===n&&e.jsx(Ne,{className:"text-primary size-5"})]})]},r))}),e.jsx("p",{className:"text-muted-foreground mt-4 px-1 text-xs",children:t("currency.hint")})]})]})}Vd.__docgenInfo={description:"",methods:[],displayName:"CurrencyPage"};const Jd=()=>e.jsx(le,{children:e.jsx(Vd,{})});Jd.__docgenInfo={description:"",methods:[],displayName:"SettingsCurrencyActivity"};function Nb(t){const{children:s,open:n,defaultOpen:a=!1,onOpenChange:r,onOpenChangeComplete:o,actionsRef:d,handle:i,triggerId:l,defaultTriggerId:u=null}=t,m=ff(),f=!!m,h=Ff(()=>i?.store??new xf({open:n??a,activeTriggerId:l!==void 0?l:u,modal:!0,disablePointerDismissal:!0,nested:f,role:"alertdialog"})).current;h.useControlledProp("open",n,a),h.useControlledProp("activeTriggerId",l,u),h.useSyncedValue("nested",f),h.useContextCallback("onOpenChange",r),h.useContextCallback("onOpenChangeComplete",o);const g=h.useState("payload");pf({store:h,actionsRef:d,parentContext:m?.store.context});const b=c.useMemo(()=>({store:h}),[h]);return e.jsx(hf.Provider,{value:b,children:typeof s=="function"?s({payload:g}):s})}function Kd({...t}){return e.jsx(Nb,{"data-slot":"alert-dialog",...t})}function Gd({...t}){return e.jsx(jf,{"data-slot":"alert-dialog-portal",...t})}function Qd({className:t,...s}){return e.jsx(Nf,{"data-slot":"alert-dialog-overlay",className:D("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 bg-black/10 duration-100 supports-backdrop-filter:backdrop-blur-xs fixed inset-0 isolate z-50",t),...s})}function Xd({className:t,size:s="default",...n}){return e.jsxs(Gd,{children:[e.jsx(Qd,{}),e.jsx(gf,{"data-slot":"alert-dialog-content","data-size":s,className:D("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 data-closed:zoom-out-95 data-open:zoom-in-95 bg-background ring-foreground/10 gap-4 rounded-xl p-4 ring-1 duration-100 data-[size=default]:max-w-xs data-[size=sm]:max-w-xs data-[size=default]:sm:max-w-sm group/alert-dialog-content fixed top-1/2 left-1/2 z-50 grid w-full -translate-x-1/2 -translate-y-1/2 outline-none",t),...n})]})}function Yd({className:t,...s}){return e.jsx("div",{"data-slot":"alert-dialog-header",className:D("grid grid-rows-[auto_1fr] place-items-center gap-1.5 text-center has-data-[slot=alert-dialog-media]:grid-rows-[auto_auto_1fr] has-data-[slot=alert-dialog-media]:gap-x-4 sm:group-data-[size=default]/alert-dialog-content:place-items-start sm:group-data-[size=default]/alert-dialog-content:text-left sm:group-data-[size=default]/alert-dialog-content:has-data-[slot=alert-dialog-media]:grid-rows-[auto_1fr]",t),...s})}function Zd({className:t,...s}){return e.jsx("div",{"data-slot":"alert-dialog-footer",className:D("bg-muted/50 -mx-4 -mb-4 rounded-b-xl border-t p-4 flex flex-col-reverse gap-2 group-data-[size=sm]/alert-dialog-content:grid group-data-[size=sm]/alert-dialog-content:grid-cols-2 sm:flex-row sm:justify-end",t),...s})}function eu({className:t,...s}){return e.jsx(vf,{"data-slot":"alert-dialog-title",className:D("text-sm font-medium sm:group-data-[size=default]/alert-dialog-content:group-has-data-[slot=alert-dialog-media]/alert-dialog-content:col-start-2",t),...s})}function tu({className:t,...s}){return e.jsx(yf,{"data-slot":"alert-dialog-description",className:D("text-muted-foreground *:[a]:hover:text-foreground text-sm text-balance md:text-pretty *:[a]:underline *:[a]:underline-offset-3",t),...s})}function su({className:t,...s}){return e.jsx(V,{"data-slot":"alert-dialog-action",className:D(t),...s})}function nu({className:t,variant:s="outline",size:n="default",...a}){return e.jsx(bf,{"data-slot":"alert-dialog-cancel",className:D(t),render:e.jsx(V,{variant:s,size:n}),...a})}Kd.__docgenInfo={description:"",methods:[],displayName:"AlertDialog"};su.__docgenInfo={description:"",methods:[],displayName:"AlertDialogAction"};nu.__docgenInfo={description:"",methods:[],displayName:"AlertDialogCancel",props:{variant:{defaultValue:{value:'"outline"',computed:!1},required:!1},size:{defaultValue:{value:'"default"',computed:!1},required:!1}}};Xd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogContent",props:{size:{required:!1,tsType:{name:"union",raw:'"default" | "sm"',elements:[{name:"literal",value:'"default"'},{name:"literal",value:'"sm"'}]},description:"",defaultValue:{value:'"default"',computed:!1}}}};tu.__docgenInfo={description:"",methods:[],displayName:"AlertDialogDescription"};Zd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogFooter"};Yd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogHeader"};Qd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogOverlay"};Gd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogPortal"};eu.__docgenInfo={description:"",methods:[],displayName:"AlertDialogTitle"};function Co(t){if(typeof t!="object"||t===null||Array.isArray(t))return null;const s=t.id;return typeof s=="string"&&s.trim()!==""?s:null}function wb(t){try{const s=JSON.parse(t),n=Array.isArray(s)?s.map(Co):[Co(s)];return Array.from(new Set(n.filter(a=>typeof a=="string")))}catch{return[]}}function kb(t,s){switch(s){case"default":return t("chainConfig.source.default");case"subscription":return t("chainConfig.source.subscription");case"manual":return t("chainConfig.source.manual")}}function Cb(t){switch(t){case"default":return"bg-muted text-muted-foreground";case"subscription":return"bg-blue-500/10 text-blue-600";case"manual":return"bg-amber-500/10 text-amber-700"}}function Sb(t){const s=new Map;for(const n of t)s.set(n.id,n);return s}function au(){const{goBack:t}=de(),{t:s}=B("settings"),n=nt(),a=Ys(),r=pm(),o=hm(),d=xm(),i=gm(),l=c.useMemo(()=>Sb(o),[o]),[u,m]=c.useState("default"),[f,h]=c.useState(""),[g,b]=c.useState(!1),[p,x]=c.useState([]),v=c.useRef(null),j=c.useRef(null),N=c.useRef(!1);c.useEffect(()=>{ls.initialize()},[]),c.useEffect(()=>{r?.url&&m(r.url)},[r?.url]),c.useEffect(()=>{const A=N.current;if(N.current=d,!A||d)return;const E=v.current;if(E){if(v.current=null,i){n.show(i);return}n.show(s(`chainConfig.toast.${E}`)),E==="manualAdded"&&h("")}},[i,d,s,n]);const y=async()=>{v.current="subscriptionSaved",await ls.setSubscriptionUrl(u)},S=async()=>{v.current="subscriptionRefreshed",await ls.refreshSubscription()},k=async()=>{const A=wb(f),E=new Set(a.map(T=>T.id)),C=A.filter(T=>E.has(T));if(C.length>0){j.current=f,x(C),b(!0);return}v.current="manualAdded",await ls.addManualConfig(f)},I=()=>{j.current=null,x([]),b(!1)},_=async()=>{const A=j.current;j.current=null,x([]),b(!1),A&&(v.current="manualAdded",await ls.addManualConfig(A))};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:s("chainConfig.title"),onBack:t}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx(Kd,{open:g,onOpenChange:A=>{A?b(A):I()},children:e.jsxs(Xd,{children:[e.jsxs(Yd,{children:[e.jsx(eu,{children:s("chainConfig.manual.duplicate.title")}),e.jsx(tu,{children:s("chainConfig.manual.duplicate.description")})]}),e.jsx("div",{className:"bg-muted/50 text-muted-foreground rounded-lg px-3 py-2 text-xs font-mono break-all",children:p.join(", ")}),e.jsxs(Zd,{children:[e.jsx(nu,{onClick:I,children:s("chainConfig.manual.duplicate.cancel")}),e.jsx(su,{onClick:_,disabled:d,children:s("chainConfig.manual.duplicate.replace")})]})]})}),i&&e.jsx("div",{className:"border-destructive/20 bg-destructive/5 text-destructive rounded-xl border px-4 py-3 text-sm",children:i}),e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:e.jsxs("div",{className:"space-y-3 px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.subscription.title")}),e.jsx("div",{className:"text-muted-foreground text-xs",children:e.jsx(lc,{ns:"settings",i18nKey:"chainConfig.subscription.description",components:{code:e.jsx("code",{className:"font-mono"})}})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{type:"button",variant:"outline",size:"icon","data-testid":"refresh-subscription-button",onClick:S,disabled:d,"aria-label":s("chainConfig.subscription.refreshAriaLabel"),children:e.jsx(rs,{className:D("size-4",d&&"animate-spin")})}),e.jsx(V,{type:"button","data-testid":"save-subscription-button",onClick:y,disabled:d,children:s("chainConfig.subscription.save")})]})]}),e.jsx(Ve,{"data-testid":"subscription-url-input",value:u,onChange:A=>m(A.target.value),placeholder:s("chainConfig.subscription.placeholder"),disabled:d,autoCapitalize:"off",autoCorrect:"off",spellCheck:!1}),r?.lastUpdated&&e.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.subscription.lastUpdated",{value:r.lastUpdated})})]})}),e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm","data-testid":"manual-add-section",children:e.jsxs("div",{className:"space-y-3 px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.manual.title")}),e.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.manual.description")})]}),e.jsxs(V,{type:"button",variant:"outline","data-testid":"add-chain-button",onClick:k,disabled:d||f.trim()==="",children:[e.jsx(mt,{className:"size-4"}),s("chainConfig.manual.add")]})]}),e.jsx("textarea",{"data-testid":"manual-config-textarea",value:f,onChange:A=>h(A.target.value),placeholder:s("chainConfig.manual.placeholder"),rows:5,disabled:d,className:D("bg-background w-full resize-none rounded-lg border px-3 py-3 text-sm","placeholder:text-muted-foreground","focus:ring-ring focus:ring-2 focus:ring-offset-2 focus:outline-none","disabled:cursor-not-allowed disabled:opacity-50"),autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})]})}),e.jsxs("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:[e.jsxs("div",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.list.title")}),e.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.list.description")})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{children:[a.map((A,E)=>{const C=l.get(A.id),T=C?.kind==="incompatible_major",w=kb(s,A.source);return e.jsxs("div",{"data-testid":`chain-item-${A.id}`,children:[E>0&&e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate text-sm font-medium",children:A.name}),e.jsx("span",{className:D("rounded px-2 py-0.5 text-xs",Cb(A.source)),children:w})]}),e.jsxs("div",{className:"text-muted-foreground mt-1 flex flex-wrap gap-x-3 gap-y-1 text-xs",children:[e.jsx("span",{className:"font-mono",children:A.id}),e.jsxs("span",{children:["v",A.version]}),e.jsx("span",{children:A.chainKind}),e.jsx("span",{children:A.symbol})]}),C?.kind==="incompatible_major"&&e.jsxs("div",{className:"mt-2 flex items-start gap-2 rounded-lg bg-amber-500/10 px-3 py-2 text-xs text-amber-800",children:[e.jsx(Oe,{className:"mt-0.5 size-4 shrink-0"}),e.jsx("div",{children:s("chainConfig.warning.incompatibleMajor",{version:C.version,supportedMajor:C.supportedMajor})})]})]}),e.jsx(Xo,{checked:A.enabled,onCheckedChange:P=>{ls.setChainEnabled(A.id,P)},disabled:d||T,className:D(T&&"cursor-not-allowed opacity-60")})]})})]},A.id)}),a.length===0&&e.jsx("div",{className:"text-muted-foreground px-4 py-8 text-center text-sm",children:s("chainConfig.list.empty")})]})]}),e.jsx("div",{className:"text-muted-foreground px-1 text-xs",children:s("chainConfig.hint")})]})]})}au.__docgenInfo={description:"",methods:[],displayName:"ChainConfigPage"};const ru=()=>e.jsx(le,{children:e.jsx(au,{})});ru.__docgenInfo={description:"",methods:[],displayName:"SettingsChainsActivity"};const Ab=3e4;function iu(){const{t}=B("settings"),{goBack:s}=de(),{push:n}=Z(),a=Fe(),o=(a?.keyType??"mnemonic")==="arbitrary",[d,i]=c.useState(""),[l,u]=c.useState(!0),m=c.useRef(!1);c.useEffect(()=>{if(d.length>0&&!l){const g=setTimeout(()=>{u(!0)},Ab);return()=>clearTimeout(g)}},[d.length,l]),c.useEffect(()=>{const g=()=>{document.hidden&&d.length>0&&u(!0)};return document.addEventListener("visibilitychange",g),()=>{document.removeEventListener("visibilitychange",g)}},[d.length]),c.useEffect(()=>{m.current||!a?.encryptedMnemonic||(m.current=!0,Cs(async g=>{try{const b=await xs(a.encryptedMnemonic,g);return i(b),u(!1),!0}catch{return!1}}),n("WalletLockConfirmJob",{title:t("viewMnemonic.verifyTitle"),description:t(o?"viewMnemonic.verifyDescKey":"viewMnemonic.verifyDescMnemonic")}))},[a,n,t,o]);const f=()=>{u(g=>!g)};if(!a)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:t(o?"viewMnemonic.titleKey":"viewMnemonic.titleMnemonic"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("viewMnemonic.noWallet")})})]});const h=o?[]:d.trim().split(/\s+/).filter(Boolean);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:t(o?"viewMnemonic.titleKey":"viewMnemonic.titleMnemonic"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"flex gap-3 rounded-xl bg-amber-500/10 p-4",children:[e.jsx(Oe,{className:"size-5 shrink-0 text-amber-500"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("p",{className:"font-medium text-amber-700 dark:text-amber-400",children:t("viewMnemonic.securityTip")}),e.jsx("p",{className:"text-muted-foreground",children:t(o?"viewMnemonic.securityWarningKey":"viewMnemonic.securityWarningMnemonic")})]})]}),d.length>0&&e.jsxs("div",{className:"bg-card space-y-4 rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:o?t("viewMnemonic.charCount",{count:d.length}):t("viewMnemonic.wordCount",{count:h.length})}),e.jsx("button",{onClick:f,className:D("flex items-center gap-1.5 rounded-full px-3 py-1.5 text-xs font-medium","bg-muted hover:bg-muted/80 transition-colors"),children:l?e.jsxs(e.Fragment,{children:[e.jsx(fr,{className:"size-3.5"}),t("viewMnemonic.show")]}):e.jsxs(e.Fragment,{children:[e.jsx(ic,{className:"size-3.5"}),t("viewMnemonic.hide")]})})]}),o?e.jsx("textarea",{value:d,readOnly:!0,rows:4,"data-testid":"secret-textarea",className:D("bg-background w-full resize-none rounded-lg border px-3 py-3 font-mono text-sm","focus:outline-none",l?"[-webkit-text-security:disc]":"[-webkit-text-security:none]")}):e.jsx(nc,{words:h,hidden:l}),!l&&e.jsx("p",{className:"text-muted-foreground text-center text-xs",children:t("viewMnemonic.autoHideNote")})]})]})]})}iu.__docgenInfo={description:"",methods:[],displayName:"ViewMnemonicPage"};const ou=()=>e.jsx(le,{children:e.jsx(iu,{})});ou.__docgenInfo={description:"",methods:[],displayName:"SettingsMnemonicActivity"};function cu(){const{t}=B("settings"),{goBack:s}=de(),n=Fe(),[a,r]=c.useState("verify"),[o,d]=c.useState("pattern"),[i,l]=c.useState([]),[u,m]=c.useState(!1),[f,h]=c.useState(!1),g=c.useRef(null),[b,p]=c.useState([]),[x,v]=c.useState(!1),[j,N]=c.useState(null),[y,S]=c.useState(null),k=c.useCallback(()=>{g.current&&(clearTimeout(g.current),g.current=null),m(!1)},[]),I=c.useCallback(T=>{u&&T.length>0&&k(),l(T)},[u,k]),_=c.useCallback(async T=>{if(n?.encryptedMnemonic){h(!0),k();try{const w=Be(T);await Jt(n.encryptedMnemonic,w)?(l(T),r("setup")):(m(!0),l([]),g.current=setTimeout(()=>{m(!1)},1500))}catch{m(!0),l([]),g.current=setTimeout(()=>{m(!1)},1500)}finally{h(!1)}}},[n,k]),A=c.useCallback((T,w)=>{p(T),v(w),N(null)},[]),E=c.useCallback(async()=>{if(n?.encryptedWalletLock){h(!0),N(null);try{if(!Bo(b)){N(t("changeWalletLock.invalidMnemonic")),h(!1);return}const T=b.join(" ");await ye.verifyMnemonic(n.id,T)?(S(T),r("setup")):N(t("changeWalletLock.mnemonicVerifyFailed"))}catch{N(t("changeWalletLock.mnemonicVerifyFailed"))}finally{h(!1)}}},[n,b,t]),C=c.useCallback(async T=>{if(n)try{if(o==="mnemonic"&&y)await ye.resetWalletLockByMnemonic(n.id,y,T);else{const w=Be(i);await ye.updateWalletLock(n.id,w,T)}r("success"),setTimeout(()=>{s()},2e3)}catch{r("verify"),l([]),S(null)}},[n,o,y,i,s]);return n?a==="success"?e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:t("changeWalletLock.title")}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx("div",{className:"bg-green-500/10 flex size-16 items-center justify-center rounded-full",children:e.jsx(Ne,{className:"text-green-500 size-8"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:t("changeWalletLock.success")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:t("changeWalletLock.returning")})]})]})]}):a==="verify"?e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:t("changeWalletLock.title"),onBack:s}),e.jsx("div",{className:"flex-1 p-4",children:o==="pattern"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:t("changeWalletLock.verifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("changeWalletLock.verifyDesc")})]}),e.jsx(ft,{value:i,onChange:I,onComplete:_,minPoints:4,error:u,disabled:f,"data-testid":"verify-pattern-lock"}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx("button",{type:"button",onClick:()=>d("mnemonic"),className:"text-primary hover:text-primary/80 text-sm underline","data-testid":"switch-to-mnemonic",children:t("changeWalletLock.forgotPattern")})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:t("changeWalletLock.mnemonicVerifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("changeWalletLock.mnemonicVerifyDesc")})]}),e.jsx(Hf,{wordCount:12,onChange:A}),j&&e.jsx("p",{className:"text-destructive mt-4 text-center text-sm",children:j}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx(V,{onClick:E,disabled:!x||f,className:"w-full","data-testid":"verify-mnemonic-button",children:t(f?"changeWalletLock.verifying":"changeWalletLock.verifyMnemonic")}),e.jsx("button",{type:"button",onClick:()=>{d("pattern"),p([]),N(null)},className:"text-muted-foreground hover:text-foreground w-full text-center text-sm","data-testid":"switch-to-pattern",children:t("changeWalletLock.usePattern")})]})]})})]}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:t("changeWalletLock.title"),onBack:()=>{r("verify"),l([])}}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(pr,{onComplete:C,minPoints:4})})]}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:t("changeWalletLock.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("changeWalletLock.noWallet")})})]})}cu.__docgenInfo={description:"",methods:[],displayName:"ChangeWalletLockPage"};const lu=()=>e.jsx(le,{children:e.jsx(cu,{})});lu.__docgenInfo={description:"",methods:[],displayName:"SettingsWalletLockActivity"};function Ib({targetChain:t,address:s,filter:n,setFilter:a,walletId:r,decimals:o}){const{navigate:d,goBack:i}=de(),l=Zs(),{t:u}=B(["transaction","common"]),m=os(),{data:f,isLoading:h,isFetching:g,error:b,refetch:p}=m.transactionHistory.useState({address:s,limit:50},{enabled:!!s}),x=$a(b,u),{transactions:v,deleteTransaction:j,retryTransaction:N}=Oo(r,t,s,f),y=c.useMemo(()=>{if(!f)return[];const C=n.period;if(!C||C==="all")return f;const T=C==="7d"?7:C==="30d"?30:90,w=Date.now()-T*24*60*60*1e3;return f.filter(P=>P.timestamp>=w)},[f,n.period]),S=c.useMemo(()=>[{value:"all",label:u("history.filter.allTime")},{value:"7d",label:u("history.filter.days7")},{value:"30d",label:u("history.filter.days30")},{value:"90d",label:u("history.filter.days90")}],[u]),k=c.useMemo(()=>[{value:"all",label:u("history.filter.allChains")},...l.map(C=>({value:C.id,label:C.name}))],[u,l]),I=c.useCallback(C=>{if(!C.id)return;const T=f?.find(P=>P.hash===C.hash),w=T?Xt.stringify(T):void 0;d({to:`/transaction/${C.id}`,search:{txData:w}})},[d,f]),_=c.useCallback(C=>{a(T=>({...T,chain:C}))},[a]),A=c.useCallback(C=>{a(T=>({...T,period:C}))},[a]),E=c.useCallback(async()=>{await p?.()},[p]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:u("transaction:history.title"),onBack:i,rightAction:e.jsx("button",{onClick:E,disabled:g,className:D("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80",g&&"animate-spin"),"aria-label":u("common:a11y.refresh"),children:e.jsx(rs,{className:"size-5"})})}),e.jsxs("div",{className:"bg-card border-b px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(vc,{className:"text-muted-foreground size-4"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:u("history.filter.chainLabel")}),e.jsxs(Ws,{value:n.chain||"all",onValueChange:C=>_(C),children:[e.jsx($s,{size:"sm","aria-label":u("common:a11y.selectChain"),children:e.jsx(qs,{children:k.find(C=>C.value===(n.chain||"all"))?.label})}),e.jsx(Hs,{children:k.map(C=>e.jsx(Yt,{value:C.value,children:C.label},C.value))})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:u("history.filter.periodLabel")}),e.jsxs(Ws,{value:n.period||"all",onValueChange:C=>A(C),children:[e.jsx($s,{size:"sm","aria-label":u("common:a11y.selectPeriod"),children:e.jsx(qs,{children:S.find(C=>C.value===(n.period||"all"))?.label})}),e.jsx(Hs,{children:S.map(C=>e.jsx(Yt,{value:C.value,children:C.label},C.value))})]})]})]}),e.jsx("p",{className:"text-muted-foreground mt-2 text-xs",children:u("transaction:history.totalRecords",{count:y.length})})]}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[v.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-muted-foreground text-xs font-medium uppercase tracking-wider px-1",children:u("pendingTx.title")}),e.jsx("div",{className:"space-y-1",children:v.map(C=>{const T=_l(C,o);return e.jsx(qo,{transaction:T,onClick:()=>d({to:`/pending-tx/${C.id}`}),onRetry:C.status==="failed"?()=>N(C):void 0,onDelete:()=>j(C)},C.id)})})]}),(x.limited||!x.supported)&&!h&&e.jsx(Km,{type:x.limited?"limited":"notSupported",feature:u("home:wallet.transactionHistory"),reason:x.reason,className:"mb-4"}),e.jsx(dc,{transactions:Rl(y??[],t),loading:h,onTransactionClick:I,emptyTitle:u("transaction:history.emptyTitle"),emptyDescription:u("transaction:history.emptyDesc"),showChainIcon:!0})]})]})}function du({initialChain:t}){const{goBack:s}=de(),n=Fe(),a=Je(),{t:r}=B(["transaction","common"]),o=ut(),[d,i]=c.useState({chain:t??a,period:"all"}),l=d.chain==="all"?a:d.chain,u=o.snapshot?He.getChainById(o,l??""):void 0,f=n?.chainAddresses?.find(h=>h.chain===l)?.address??"";return n?e.jsx(zt,{chainId:l,fallback:e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:r("transaction:history.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Chain not supported"})})]}),children:e.jsx(Ib,{targetChain:l,address:f,filter:d,setFilter:i,walletId:n.id,decimals:u?.decimals??8})}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:r("transaction:history.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:r("transaction:history.noWallet")})})]})}du.__docgenInfo={description:"",methods:[],displayName:"TransactionHistoryPage",props:{initialChain:{required:!1,tsType:{name:"union",raw:"ChainType | 'all' | undefined",elements:[{name:"ChainType"},{name:"literal",value:"'all'"},{name:"undefined"}]},description:""}}};const uu=()=>{const t=mh();return e.jsx(le,{children:e.jsx(du,{initialChain:t.chain})})};uu.__docgenInfo={description:"",methods:[],displayName:"HistoryActivity"};const Tb={transfer:"send",swap:"swap",exchange:"exchange",approve:"approve",signature:"signature",stake:"stake",unstake:"unstake",mint:"mint",burn:"destroy",gift:"gift",grab:"grab",trust:"trust",signFor:"signFor",emigrate:"emigrate",immigrate:"immigrate",issueAsset:"issueAsset",increaseAsset:"increaseAsset",destroyAsset:"destroy",issueEntity:"issueEntity",destroyEntity:"destroyEntity",locationName:"locationName",dapp:"dapp",certificate:"certificate",mark:"mark",contract:"interaction",unknown:"other",revoke:"approve",claim:"receive"};function Pb(t,s){const n=t.action,a=t.direction,r=n==="transfer"?a==="in"?"receive":"send":Tb[n]??"other",o=t.assets[0],d=o.assetType==="nft"?"1":o.value,i=o.assetType==="nft"?0:o.decimals,l=o.assetType==="nft"?"NFT":o.symbol,u=a==="in"?t.from:t.to;return{hash:t.hash,from:t.from,to:t.to,address:u,timestamp:t.timestamp,status:t.status,type:r,direction:a,amount:oe.fromRaw(d,i,l),symbol:l,chain:s,assets:t.assets,fee:t.fee?oe.fromRaw(t.fee.value,t.fee.decimals,t.fee.symbol):void 0,contract:t.contract,blockNumber:t.blockNumber}}function So(t){return!t||t.assetType==="nft"?null:{value:t.value,decimals:t.decimals,symbol:t.symbol}}function Eb(t){if(!t)return null;const[s,n]=t.split("--");return!s||!n?null:{chainId:s,hash:n}}function _b({hash:t,chainId:s,txData:n,onBack:a}){const{t:r}=B(["transaction","common"]),o=ut(),d=os(),i=c.useMemo(()=>n?Xt.parse(n):null,[n]),{data:l,isLoading:u,error:m}=d.transaction.useState({txHash:t},{enabled:!!t}),f=l??i,h=c.useMemo(()=>f?Pb(f,s):null,[f,s]),g=c.useMemo(()=>{const z=h?.chain??s;return z?He.getChainById(o,z):null},[o,s,h?.chain]),b=c.useMemo(()=>{const z=g?.explorer?.queryTx;return!z||!t?null:z.replace(":signature",t)},[g?.explorer?.queryTx,t]),p=c.useCallback(()=>{b&&window.open(b,"_blank","noopener,noreferrer")},[b]),[x,v]=c.useState(!1),j=c.useCallback(async()=>{b&&(await rr.write({text:b}),v(!0),setTimeout(()=>v(!1),2e3))},[b]);if(u&&!i)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:r("detail.title"),onBack:a}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx(ra,{className:"h-48"}),e.jsx(ra,{className:"h-64"}),e.jsx(ra,{className:"h-32"})]})]});if(m instanceof Om)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:r("detail.title"),onBack:a}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx("div",{className:"bg-card flex items-center justify-center rounded-xl p-6 shadow-sm",children:e.jsx("p",{className:"text-muted-foreground",children:r("detail.invalidData")})}),t&&e.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:r("detail.hash")}),e.jsx(Gr,{text:t,className:"text-muted-foreground text-xs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:p,disabled:!b,className:D("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:[e.jsx(Ea,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.openInExplorer")})]}),e.jsx("button",{onClick:j,disabled:!b,className:D("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:x?e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"text-green-500 size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.copied")})]}):e.jsxs(e.Fragment,{children:[e.jsx(Us,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.share")})]})})]})]})]})]});if(!h)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:r("detail.title"),onBack:a}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:r("detail.notFound")})})]});const N=h.type,y=Fm(N),S=y.Icon,k=h.type==="swap"?h.assets?.[0]:void 0,I=h.type==="swap"?h.assets?.[1]:void 0,_=So(k),A=So(I),E=h.contract?.address||h.to,C=h.contract?.method,T=h.contract?.methodId,w=C?r(`method.${C}`,{defaultValue:C}):null,P=_?oe.fromRaw(_.value,_.decimals,_.symbol):null,L=A?oe.fromRaw(A.value,A.decimals,A.symbol):null;return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:r("detail.title"),onBack:a}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"bg-card flex flex-col items-center gap-3 rounded-xl p-6 shadow-sm",children:[e.jsx("div",{className:D("flex size-16 items-center justify-center rounded-full",y.bg),children:e.jsx(S,{className:D("size-8",y.color)})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:r(`type.${h.type}`,{defaultValue:h.type})}),h.type==="swap"&&P&&L?e.jsxs("div",{className:D("flex items-center justify-center gap-2",y.color),children:[e.jsx(wt,{value:P.toNumber(),symbol:P.symbol,decimals:P.decimals,sign:"never",color:"default",weight:"normal",size:"lg"}),e.jsx("span",{className:"text-lg",children:""}),e.jsx(wt,{value:L.toNumber(),symbol:L.symbol,decimals:L.decimals,sign:"never",color:"default",weight:"normal",size:"lg"})]}):e.jsx(wt,{value:h.type==="send"?-Math.abs(h.amount.toNumber()):h.amount.toNumber(),symbol:h.symbol,sign:y.amountSign,color:"default",weight:"normal",size:"xl",className:y.color})]}),e.jsx(Uf,{status:Wm(h.status).badgeStatus,label:r(`transaction:status.${h.status}`)})]}),e.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:r("detail.info")}),h.from&&h.to?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.fromAddress")}),e.jsx(ot,{address:h.from,copyable:!0,className:"text-sm"})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.toAddress")}),e.jsx(ot,{address:h.to,copyable:!0,className:"text-sm"})]})]}):e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:h.type==="send"?r("detail.toAddress"):r("detail.fromAddress")}),e.jsx(ot,{address:h.address,copyable:!0,className:"text-sm"})]}),e.jsx("div",{className:"bg-border h-px"}),h.type==="swap"&&(_||A)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.swapFrom")}),e.jsx("span",{className:"text-sm font-medium",children:_?e.jsx(wt,{value:oe.fromRaw(_.value,_.decimals,_.symbol).toNumber(),symbol:_.symbol,decimals:_.decimals,sign:"never",color:"default",size:"sm"}):"-"})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.swapTo")}),e.jsx("span",{className:"text-sm font-medium",children:A?e.jsx(wt,{value:oe.fromRaw(A.value,A.decimals,A.symbol).toNumber(),symbol:A.symbol,decimals:A.decimals,sign:"never",color:"default",size:"sm"}):"-"})]}),e.jsx("div",{className:"bg-border h-px"})]}),(h.type==="approve"||h.type==="interaction"||h.type==="swap")&&E&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.contractAddress")}),e.jsx(ot,{address:E,copyable:!0,className:"text-sm"})]}),(h.type==="approve"||h.type==="interaction")&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.method")}),e.jsx("span",{className:"text-sm font-medium font-mono",children:w||T||r("common:unknown")})]}),h.type==="approve"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.spender")}),e.jsx("span",{className:"text-sm font-medium",children:r("common:unknown")})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.allowance")}),e.jsx("span",{className:"text-sm font-medium",children:r("common:unknown")})]})]})]}),e.jsx("div",{className:"bg-border h-px"})]}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.time")}),e.jsx(Vm,{value:h.timestamp,format:"datetime",className:"text-sm"})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.network")}),e.jsx("span",{className:"text-sm font-medium capitalize",children:h.chain})]}),h.fee&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.fee")}),e.jsx(or,{amount:h.fee?.toNumber?.()??0,symbol:h.fee?.symbol??"",className:"text-sm"})]})]}),h.blockNumber&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.blockHeight")}),e.jsx("span",{className:"text-sm font-medium",children:h.blockNumber.toLocaleString()})]})]}),h.confirmations!==void 0&&h.confirmations>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.confirmations")}),e.jsx("span",{className:"text-sm font-medium",children:h.confirmations})]})]})]}),t&&e.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:r("detail.hash")}),e.jsx(Gr,{text:t,className:"text-muted-foreground text-xs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:p,disabled:!b,className:D("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:[e.jsx(Ea,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.openInExplorer")})]}),e.jsx("button",{onClick:j,disabled:!b,className:D("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:x?e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"text-green-500 size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.copied")})]}):e.jsxs(e.Fragment,{children:[e.jsx(Us,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.share")})]})})]})]})]})]})}function mu(){const{t}=B(["transaction","common"]),{goBack:s}=de(),{txId:n,txData:a}=he(),r=Fe(),o=c.useMemo(()=>Eb(n),[n]),d=c.useCallback(()=>{s()},[s]);return r?o?e.jsx(zt,{chainId:o.chainId,fallback:e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:t("detail.title"),onBack:d}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Chain not supported"})})]}),children:e.jsx(_b,{hash:o.hash,chainId:o.chainId,txData:a,onBack:d})}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:t("detail.title"),onBack:d}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("detail.notFound")})})]}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:t("detail.title"),onBack:d}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("history.noWallet")})})]})}mu.__docgenInfo={description:"",methods:[],displayName:"TransactionDetailPage"};const fu=({params:t})=>e.jsx(le,{children:e.jsx(me,{params:t,children:e.jsx(mu,{})})});fu.__docgenInfo={description:"",methods:[],displayName:"TransactionDetailActivity"};const Mb=150;function pu({onScan:t,className:s}){const{t:n}=B("scanner"),{t:a}=B("common"),{navigate:r,goBack:o}=de(),{push:d}=Z(),i=Nc(),l=c.useRef(null),u=c.useRef(null),m=c.useRef(null),f=c.useRef(null),h=c.useRef(!1),g=c.useRef(null),b=c.useRef(t),[p,x]=c.useState("idle"),[v,j]=c.useState(null),[N,y]=c.useState(!1);c.useEffect(()=>{b.current=t},[t]);const S=c.useCallback(T=>{if(T===g.current)return;g.current=T,x("success"),h.current=!1,"vibrate"in navigator&&navigator.vibrate(100);const w=tc(T);if(b.current)b.current(T,w);else switch(w.type){case"address":case"payment":r({to:"/send",search:{address:w.address,chain:w.chain,amount:w.type==="payment"?w.amount:void 0}});break;case"deeplink":r({to:w.path,search:w.params});break;case"contact":d("ContactAddConfirmJob",{name:w.name,addresses:JSON.stringify(w.addresses),memo:w.memo,avatar:w.avatar});break;case"unknown":r({to:"/send",search:{address:w.content}});break}},[r,d]),k=c.useCallback(()=>{if(h.current)return;h.current=!0,u.current||(u.current=document.createElement("canvas"));const T=async()=>{if(!(!h.current||!l.current||!f.current)){try{const w=await f.current.scanFromVideo(l.current,u.current??void 0);if(w){S(w.content);return}}catch{}h.current&&setTimeout(T,Mb)}};T()},[S]),I=c.useCallback(()=>{h.current=!1,m.current&&(m.current.getTracks().forEach(T=>T.stop()),m.current=null)},[]),_=c.useCallback(async()=>{I(),x("requesting"),g.current=null;try{if(!await i.checkPermission()&&!await i.requestPermission()){x("denied");return}const w=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});m.current=w,l.current&&(l.current.srcObject=w,await l.current.play(),k()),x("scanning")}catch(T){x("error"),j(T instanceof Error?T.message:"Camera initialization failed")}},[i,k,I]);c.useEffect(()=>(f.current=sc({useWorker:!0}),_(),()=>{I(),f.current?.destroy(),f.current=null}),[]);const A=c.useCallback(()=>{I(),o()},[I,o]),E=c.useCallback(()=>{const T=document.createElement("input");T.type="file",T.accept="image/*",T.onchange=async w=>{const P=w.target.files?.[0];if(P)try{const L=new Image,z=URL.createObjectURL(P);L.onload=async()=>{URL.revokeObjectURL(z);const R=document.createElement("canvas");R.width=L.width,R.height=L.height;const q=R.getContext("2d");if(!q||!f.current){j(n("noQrFound")),x("error");return}q.drawImage(L,0,0);const M=await f.current.scanFromCanvas(R);M?S(M.content):(j(n("noQrFound")),x("error"))},L.onerror=()=>{URL.revokeObjectURL(z),j(n("noQrFound")),x("error")},L.src=z}catch{j(n("noQrFound")),x("error")}},T.click()},[S,n]),C=c.useCallback(async()=>{if(m.current){const T=m.current.getVideoTracks()[0];if(T)try{await T.applyConstraints({advanced:[{torch:!N}]}),y(!N)}catch{}}},[N]);return e.jsxs("div",{className:D("relative flex h-screen flex-col bg-black",s),children:[e.jsxs("div",{className:"absolute top-0 right-0 left-0 z-10 flex items-center justify-between p-4",children:[e.jsx(V,{variant:"ghost",size:"icon","data-testid":"back-button",onClick:A,className:"text-white","aria-label":a("a11y.back"),children:e.jsx(an,{className:"size-6"})}),e.jsx("h1",{"data-testid":"page-title",className:"text-lg font-medium text-white",children:n("title")}),e.jsx(V,{variant:"ghost",size:"icon",onClick:C,className:D("text-white",N&&"text-yellow-400"),"aria-label":n(N?"flashOff":"flashOn"),children:e.jsx(xc,{className:"size-6"})})]}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("video",{ref:l,className:D("absolute inset-0 size-full object-cover",p!=="scanning"&&p!=="success"&&"invisible"),playsInline:!0,muted:!0}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"relative size-64",children:[e.jsx("div",{className:D("absolute top-0 left-0 size-8 border-t-4 border-l-4",p==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:D("absolute top-0 right-0 size-8 border-t-4 border-r-4",p==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:D("absolute bottom-0 left-0 size-8 border-b-4 border-l-4",p==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:D("absolute right-0 bottom-0 size-8 border-r-4 border-b-4",p==="success"?"border-green-500":"border-primary")}),p==="scanning"&&e.jsx("div",{className:"animate-scan bg-primary absolute right-2 left-2 h-0.5"})]})}),e.jsxs("div",{className:"absolute inset-x-0 bottom-32 text-center",children:[p==="idle"&&e.jsx("p",{className:"text-white/80",children:n("initializing")}),p==="requesting"&&e.jsx("p",{className:"text-white/80",children:n("requestingPermission")}),p==="scanning"&&e.jsx("p",{className:"text-white/80",children:n("scanPrompt")}),p==="success"&&e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-green-400",children:n("scanSuccess")})}),p==="denied"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-red-400",children:n("permissionDenied")}),e.jsx(V,{variant:"outline","data-testid":"retry-button",onClick:_,children:n("retry")})]}),p==="error"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-red-400",children:v||n("error")}),e.jsx(V,{variant:"outline","data-testid":"retry-button",onClick:_,children:n("retry")})]})]})]}),e.jsxs("div",{className:"absolute inset-x-0 bottom-0 flex justify-center gap-8 pb-8",children:[e.jsxs(V,{variant:"ghost",size:"lg","data-testid":"gallery-button",onClick:E,className:"flex flex-col items-center text-white",children:[e.jsx(fc,{className:"mb-1 size-6"}),e.jsx("span",{className:"text-xs",children:n("gallery")})]}),e.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-white/20",children:e.jsx(hp,{className:"size-8 text-white"})}),e.jsx("div",{className:"w-16"})," "]})]})}pu.__docgenInfo={description:"",methods:[],displayName:"ScannerPage",props:{onScan:{required:!1,tsType:{name:"union",raw:"((content: string, parsed: ParsedQRContent) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:"Callback when QR code is scanned"},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"Custom class name"}}};const hu=()=>e.jsx(le,{children:e.jsx(pu,{})});hu.__docgenInfo={description:"",methods:[],displayName:"ScannerActivity"};const Rb=300*1e3;function xu(t){if(t)return t}function Lb(t){return t.map(s=>({id:s.id,name:s.name,address:s.address,balance:""}))}function Db(t,s,n){const a=new Map;for(const r of t)for(const o of r.chainAddresses){const d=xu(o.chain);if(!d)continue;const i=a.get(d)??[];i.push({address:o.address,isDefault:r.id===s}),a.set(d,i)}return Array.from(a.entries()).map(([r,o])=>({chain:r,name:n[r]??r,addresses:o.map(d=>({address:d.address,isDefault:d.isDefault}))}))}function Ao(t){const s=t?.trim().toLowerCase();return s==="true"||s==="1"}function gu(){const{t}=B("authorize"),{t:s}=B("common"),{navigate:n,goBack:a}=de(),{push:r}=Z(),o=nt(),{id:d,type:i,chainName:l,signMessage:u,getMain:m}=he(),f=Ie(Le,O=>O.currentWalletId),h=Ie(Le,O=>O.wallets),g=Ie(Le,Xs.getCurrentWallet),b=ss(),[p,x]=c.useState(null),[v,j]=c.useState(null),[N,y]=c.useState(!1),S=c.useMemo(()=>Lb(h),[h]),k=g?.id??h[0]?.id,[I,_]=c.useState(k),A=c.useMemo(()=>xu(l),[l]),[E,C]=c.useState(A);c.useEffect(()=>C(A),[A]);const[T,w]=c.useState(void 0),[P,L]=c.useState(()=>new Set(h.map(O=>O.id))),[z,R]=c.useState(!1);c.useEffect(()=>{_(k)},[k]),c.useEffect(()=>{L(new Set(h.map(O=>O.id)))},[h]);const q=c.useMemo(()=>{const O=["viewAddress","viewPublicKey"];return u?.trim()&&O.push("signMessage"),Ao(m)&&O.push("getMain"),O},[m,u]),M=c.useMemo(()=>new nh(Vs,d),[d]),F=c.useMemo(()=>!!u?.trim(),[u]),K=c.useMemo(()=>Ao(m),[m]),ee=F||K;c.useEffect(()=>{let O=!1;async function G(){j(null);try{const re=await Vs.getCallerAppInfo(d);if(O)return;x(re)}catch{if(O)return;j(t("error.authFailed"))}}return G(),()=>{O=!0}},[d,t]),c.useEffect(()=>{const O=window.setTimeout(()=>{(async()=>(await M.reject("timeout"),o.show({message:t("error.timeout"),position:"center"}),n({to:"/"})))()},Rb);return()=>{window.clearTimeout(O)}},[M,n,t,o]);const W=c.useMemo(()=>I?h.find(O=>O.id===I)??null:null,[I,h]),$=c.useMemo(()=>Db(h,f,b),[b,f,h]),ie=c.useMemo(()=>g?g.chainAddresses.map(O=>O.chain):[],[g]),ne=c.useMemo(()=>{if(!(!g||!E))return g.chainAddresses.find(O=>O.chain===E)?.address},[g,E]);c.useEffect(()=>{i==="network"&&(E||C($[0]?.chain))},[$,E,i]);const ae=c.useMemo(()=>h.length===0?!1:i==="main"?!!W:i==="network"?E?($.find(O=>O.chain===E)?.addresses.length??0)>0:!1:P.size>0,[$,E,W,P.size,i,h.length]),se=c.useCallback(()=>{a()},[a]),H=c.useCallback(async()=>{if(!N){y(!0);try{await M.reject("rejected"),n({to:"/"})}finally{y(!1)}}},[M,N,n]),X=c.useCallback(async()=>{if(!(!ae||N)){if(ee){Cs(async O=>{y(!0);try{const G=u?.trim()??"";let re=[],ge=[];if(i==="main"){if(!W)return!1;re=M.handleMainAddresses(W),ge=[W]}else if(i==="network"){if(!E)return!1;re=M.handleNetworkAddresses(h,E),ge=h}else{const ve=h.filter(ze=>P.has(ze.id));re=M.handleAllAddresses(ve),ge=ve}return re=await M.applySensitiveOptions(re,ge,{password:O,signMessage:G,getMain:K}),await M.approve(re),n({to:"/"}),!0}catch{return!1}finally{y(!1)}}),r("WalletLockConfirmJob",{title:t("passwordConfirm.title")});return}y(!0);try{let O=[];if(i==="main"){if(!W)return;O=M.handleMainAddresses(W)}else if(i==="network"){if(!E)return;O=M.handleNetworkAddresses(h,E)}else{const G=h.filter(re=>P.has(re.id));O=M.handleAllAddresses(G)}await M.approve(O),n({to:"/"})}finally{y(!1)}}},[M,ae,N,n,ee,K,r,E,W,P,u,t,i,h]);return i==="network"&&l&&!A?e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(J,{title:t("title.address"),onBack:se}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-destructive",children:t("error.unknownChain")}),e.jsx("div",{className:"mt-4",children:e.jsx(V,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]}):v?e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(J,{title:t("title.address"),onBack:se}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-destructive",children:v}),e.jsx("div",{className:"mt-4",children:e.jsx(V,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]}):e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(J,{title:t("title.address"),onBack:se}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[p&&e.jsx(uc,{appInfo:p}),e.jsx("div",{className:"px-1 text-sm text-foreground",children:t("address.shareWith")}),e.jsx(Vf,{permissions:q}),e.jsx("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:[i==="main"&&t("address.scope.main"),i==="network"&&t("address.scope.network",{chainName:(E?b[E]:void 0)??E??""}),i==="all"&&t("address.scope.all")]})}),e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[i==="main"&&e.jsx(Jf,{wallets:S,...I?{selectedId:I}:{},onSelect:O=>_(O.id)}),i==="network"&&g&&E&&e.jsx("div",{className:"flex w-full aspect-[1.6/1] items-stretch",children:e.jsx(zo,{wallet:g,chain:E,chainName:b[E]??E,address:ne,priority:"low",onOpenChainSelector:A?void 0:()=>R(!0)})}),i==="all"&&e.jsxs("div",{className:"space-y-2",children:[h.length===0&&e.jsx("div",{className:"py-6 text-center text-sm text-muted-foreground",children:t("address.noWallets")}),h.map(O=>{const G=P.has(O.id);return e.jsxs("button",{type:"button",onClick:()=>{L(re=>{const ge=new Set(re);return ge.has(O.id)?ge.delete(O.id):ge.add(O.id),ge})},className:D("flex w-full items-center justify-between rounded-lg border px-3 py-2 text-left transition-colors","hover:bg-muted/50",G?"border-primary bg-primary/5":"border-border bg-background"),"aria-pressed":G,children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-medium",children:O.name}),e.jsx("div",{className:"truncate font-mono text-xs text-muted-foreground",children:O.address})]}),e.jsx("div",{className:D("flex size-5 items-center justify-center rounded border",G?"border-primary bg-primary text-primary-foreground":"border-border bg-background"),"aria-hidden":"true",children:G?"":""})]},O.id)})]})]})]}),e.jsx("div",{className:"sticky bottom-0 border-t border-border bg-background p-4 safe-area-inset-bottom",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(V,{type:"button",variant:"outline",className:"flex-1",onClick:H,disabled:N,children:t("button.reject")}),e.jsx(V,{type:"button",className:"flex-1",onClick:X,disabled:!ae||N,children:t("button.approve")})]})}),z&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/50",onClick:()=>R(!1),children:e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-background rounded-t-2xl",onClick:O=>O.stopPropagation(),children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("address.selectNetwork")})}),e.jsx("div",{className:"max-h-[60vh] space-y-2 overflow-y-auto p-4",children:ie.map(O=>{const G=g?.chainAddresses.find(re=>re.chain===O);return e.jsxs("button",{onClick:()=>{C(O),R(!1)},className:D("flex w-full items-center gap-3 rounded-xl p-4 transition-colors",O===E?"bg-primary/10 ring-1 ring-primary":"bg-muted/50 hover:bg-muted"),children:[e.jsx(_t,{chain:O,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:b[O]??O}),e.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:G?.address?zb(G.address):"---"})]}),O===E&&e.jsx(Ne,{className:"size-5 text-primary"})]},O)})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})]})}function zb(t,s=10,n=8){return t.length<=s+n+3?t:`${t.slice(0,s)}...${t.slice(-n)}`}gu.__docgenInfo={description:"",methods:[],displayName:"AddressAuthPage"};const vu=({params:t})=>e.jsx(le,{children:e.jsx(me,{params:t,children:e.jsx(gu,{})})});vu.__docgenInfo={description:"",methods:[],displayName:"AuthorizeAddressActivity"};const Ob=300*1e3;function Io(t){return typeof t=="object"&&t!==null}function Ye(t,s){const n=t[s];if(typeof n=="string")return n;if(typeof n=="number"&&Number.isFinite(n))return String(n)}function Bb(t,s,n){const a=Ye(t,s)?.trim();return a?{ok:!0,value:a}:{ok:!1,error:`signaturedata missing field: ${n}`}}function Wt(t,s){for(const n of s){const a=Ye(t,n.key)?.trim();if(a)return{ok:!0,value:a}}return{ok:!1,error:`signaturedata missing field: ${s.map(n=>n.label).join(" / ")}`}}function Fb(t){if(typeof t=="string"){const s=t.trim().toLowerCase();return s==="message"?{ok:!0,value:"message"}:s==="transfer"?{ok:!0,value:"transfer"}:s==="destroy"||s==="destory"?{ok:!0,value:"destory"}:{ok:!1,error:`Unsupported signature type: ${t}`}}return typeof t=="number"&&Number.isInteger(t)?t===0?{ok:!0,value:"message"}:t===1?{ok:!0,value:"transfer"}:t===7?{ok:!0,value:"destory"}:{ok:!1,error:`Unsupported signature type: ${t}`}:{ok:!1,error:"signaturedata.type must be string or number"}}function Wb(t){if(t===void 0||t.trim()==="")return{ok:!1,error:"Missing signaturedata parameter"};let s;try{s=JSON.parse(t)}catch{return{ok:!1,error:"signaturedata is not valid JSON"}}if(!Array.isArray(s))return{ok:!1,error:"signaturedata must be a JSON array"};if(s.length===0)return{ok:!1,error:"signaturedata cannot be an empty array"};const n=s[0];if(!Io(n))return{ok:!1,error:"signaturedata[0] must be an object"};const a=Fb(n.type);if(!a.ok)return a;const r=Wt(n,[{key:"chainName",label:"chainName"},{key:"chain",label:"chain"}]);if(!r.ok)return r;const o=r.value;if(a.value==="message"){const d=Wt(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!d.ok)return d;const i=Bb(n,"message","message");return i.ok?{ok:!0,item:{type:"message",payload:{chainName:o,senderAddress:d.value,message:i.value}}}:i}if(a.value==="transfer"){const d=Wt(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!d.ok)return d;const i=Wt(n,[{key:"receiveAddress",label:"receiveAddress"},{key:"to",label:"to"}]);if(!i.ok)return i;const l=Wt(n,[{key:"balance",label:"balance"},{key:"amount",label:"amount"}]);if(!l.ok)return l;const u=Ye(n,"fee")?.trim(),m=Ye(n,"assetType")?.trim();let f;const h=n.contractInfo;if(Io(h)){const g=Ye(h,"assetType")?.trim(),b=h.decimals,p=Ye(h,"contractAddress")?.trim(),x=typeof b=="number"&&Number.isFinite(b)?b:typeof b=="string"&&b.trim()!==""?Number(b):void 0;g&&p&&typeof x=="number"&&Number.isFinite(x)&&(f={assetType:g,contractAddress:p,decimals:x})}return{ok:!0,item:{type:"transfer",payload:{chainName:o,senderAddress:d.value,receiveAddress:i.value,balance:l.value,...u?{fee:u}:{},...m?{assetType:m}:{},...f?{contractInfo:f}:{}}}}}{const d=Wt(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!d.ok)return d;const i=Wt(n,[{key:"destoryAmount",label:"destoryAmount"},{key:"amount",label:"amount"}]);if(!i.ok)return i;const l=Ye(n,"destoryAddress")?.trim()??Ye(n,"to")?.trim()??d.value,u=Ye(n,"fee")?.trim(),m=Ye(n,"assetType")?.trim();return{ok:!0,item:{type:"destory",payload:{chainName:o,senderAddress:d.value,destoryAddress:l,destoryAmount:i.value,...u?{fee:u}:{},...m?{assetType:m}:{}}}}}}function $b(t){return typeof t=="object"&&t!==null&&"senderAddress"in t&&"receiveAddress"in t&&"balance"in t}function qb(t){return typeof t=="object"&&t!==null&&"senderAddress"in t&&"message"in t&&!("receiveAddress"in t)}function Hb(t){return typeof t=="object"&&t!==null&&"senderAddress"in t&&"destoryAddress"in t&&"destoryAmount"in t}function To(t){return t.contractInfo?.assetType?t.contractInfo.assetType.toUpperCase():t.assetType?t.assetType.toUpperCase():{ethereum:"ETH",bitcoin:"BTC",tron:"TRX",binance:"BNB",bsc:"BNB"}[t.chainName?.toLowerCase()??""]??"TOKEN"}function Ub(t,s,n){const a=parseFloat(t)||0,r=parseFloat(s)||0,o=parseFloat(n??"0")||0,d=r+o;return{sufficient:a>=d,required:d.toString()}}function yu(){const{t}=B("authorize"),{t:s}=B("common"),{navigate:n,goBack:a}=de(),{push:r}=Z(),o=nt(),{id:d,signaturedata:i}=he(),l=Ie(Le,Xs.getCurrentWallet),[u,m]=c.useState(null),[f,h]=c.useState(null),[g,b]=c.useState(null),[p,x]=c.useState(!1),v=c.useMemo(()=>new wc(Vs,d),[d]);c.useEffect(()=>{let C=!1;async function T(){b(null);try{const w=Wb(i);if(!w.ok){b(w.error);return}const P=await Vs.getCallerAppInfo(d);if(C)return;m(P);const L={eventId:d,type:w.item.type,payload:w.item.payload,appName:P.appName,appHome:P.origin,appLogo:P.appIcon};h(L)}catch{if(C)return;b(t("error.authFailed"))}}return T(),()=>{C=!0}},[d,i,t]),c.useEffect(()=>{const C=window.setTimeout(()=>{(async()=>(await v.reject("timeout"),o.show({message:t("error.timeout"),position:"center"}),n({to:"/"})))()},Ob);return()=>{window.clearTimeout(C)}},[v,n,t,o]);const j=c.useMemo(()=>!f||!$b(f.payload)?null:f.payload,[f]),N=c.useMemo(()=>!f||!qb(f.payload)?null:f.payload,[f]),y=c.useMemo(()=>!f||!Hb(f.payload)?null:f.payload,[f]),S=c.useMemo(()=>{if(!l)return{sufficient:!0,required:"0",walletBalance:"0"};const C=j?{chainName:j.chainName,amount:j.balance,fee:j.fee}:y?{chainName:y.chainName,amount:y.destoryAmount,fee:y.fee}:null;if(!C)return{sufficient:!0,required:"0",walletBalance:"0"};const w=l.chainAddresses.find(L=>L.chain.toLowerCase()===C.chainName?.toLowerCase())?"1.0":"0";return{...Ub(w,C.amount,C.fee),walletBalance:w}},[l,y,j]),k=c.useMemo(()=>j?To(j):y?To(y):"TOKEN",[y,j]),I=c.useCallback(()=>{a()},[a]),_=c.useCallback(async()=>{if(!p){x(!0);try{await v.reject(S.sufficient?"rejected":"insufficient_balance"),n({to:"/"})}finally{x(!1)}}},[v,S.sufficient,p,n]),A=c.useCallback(()=>{S.sufficient&&(p||(Cs(async C=>{x(!0);try{const T=l?.encryptedMnemonic;if(!T||!f)return!1;let w="";if(f.type==="message"){if(!N)return!1;const P=await v.handleMessageSign(N,T,C);w=typeof P=="string"?P:P.signature??""}else if(f.type==="transfer"){if(!j)return!1;const P=await v.handleTransferSign(j,T,C);w=typeof P=="string"?P:P.signature??""}else if(f.type==="destory"){if(!y)return!1;const P=await v.handleDestroySign(y,T,C);w=typeof P=="string"?P:P.signature??""}else return!1;return await v.approve(w),n({to:"/"}),!0}catch{return!1}finally{x(!1)}}),r("WalletLockConfirmJob",{title:t("button.confirm")})))},[v,S.sufficient,l?.encryptedMnemonic,y,p,N,n,r,f,t,j]);if(g)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:t("title.signature"),onBack:I}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsx("p",{className:"text-destructive text-sm",children:g}),e.jsx("div",{className:"mt-4",children:e.jsx(V,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]});const E=f?.type==="message"?t("signature.type.message"):f?.type==="destory"?t("signature.type.destroy"):t("title.signature");return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:E,onBack:I}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[u&&e.jsx(uc,{appInfo:u}),e.jsx("div",{className:"text-foreground px-1 text-sm",children:t("signature.reviewTransaction")}),j&&e.jsxs(e.Fragment,{children:[e.jsx(di,{from:j.senderAddress,to:j.receiveAddress,amount:`${j.balance} ${k}`,...j.fee?{fee:`${j.fee} ${k}`}:{},chainId:j.chainName}),!S.sufficient&&e.jsx(ui,{balance:S.walletBalance,required:S.required,symbol:k})]}),N&&e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-sm",children:t("signature.messageToSign")}),e.jsx("div",{className:D("bg-muted/50 rounded-lg p-3","font-mono text-sm break-all whitespace-pre-wrap","max-h-48 overflow-y-auto"),children:N.message})]}),y&&e.jsxs(e.Fragment,{children:[e.jsx(di,{from:y.senderAddress,to:y.destoryAddress,amount:`${y.destoryAmount} ${k}`,...y.fee?{fee:`${y.fee} ${k}`}:{},chainId:y.chainName}),!S.sufficient&&e.jsx(ui,{balance:S.walletBalance,required:S.required,symbol:k})]}),f&&e.jsx("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:e.jsxs("div",{className:"text-muted-foreground text-sm",children:[f.type==="transfer"&&t("signature.type.transfer"),f.type==="message"&&t("signature.type.message"),f.type==="destory"&&t("signature.type.destroy")]})})]}),e.jsx("div",{className:"border-border bg-background safe-area-inset-bottom sticky bottom-0 border-t p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(V,{type:"button",variant:"outline",className:"flex-1",onClick:_,disabled:p,children:t("button.reject")}),e.jsx(V,{type:"button",className:"flex-1",onClick:A,disabled:p||!S.sufficient,children:t("button.confirm")})]})})]})}yu.__docgenInfo={description:"",methods:[],displayName:"SignatureAuthPage"};const bu=({params:t})=>e.jsx(le,{children:e.jsx(me,{params:t,children:e.jsx(yu,{})})});bu.__docgenInfo={description:"",methods:[],displayName:"AuthorizeSignatureActivity"};function ju({walletName:t,onEnterWallet:s,className:n}){const{t:a}=B("onboarding");return e.jsxs("div",{"data-testid":"import-success-step",className:D("flex min-h-screen flex-col items-center justify-center px-6 py-8",n),children:[e.jsx("div",{className:"mb-6 flex size-20 items-center justify-center rounded-full bg-green-100 dark:bg-green-900/30",children:e.jsx(ws,{className:"size-10 text-green-600 dark:text-green-400"})}),e.jsx("h1",{"data-testid":"success-message",className:"mb-2 text-2xl font-bold",children:a("import.success.title")}),e.jsx("p",{className:"text-muted-foreground mb-8 text-center",children:e.jsx(lc,{i18nKey:"import.success.description",ns:"onboarding",values:{name:t},components:{bold:e.jsx("span",{className:"text-foreground font-medium"})}})}),e.jsx("div",{className:"w-full max-w-xs",children:e.jsxs("button",{type:"button","data-testid":"enter-wallet-button",onClick:s,className:D("flex w-full items-center justify-center gap-2 rounded-full py-3 font-medium transition-colors","bg-primary hover:bg-primary/90 text-primary-foreground"),children:[e.jsx("span",{children:a("import.success.enterWallet")}),e.jsx(De,{className:"size-5"})]})})]})}ju.__docgenInfo={description:"Success screen shown after wallet import",methods:[],displayName:"ImportWalletSuccess",props:{walletName:{required:!0,tsType:{name:"string"},description:"Wallet name"},onEnterWallet:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback when user chooses to enter wallet"},className:{required:!1,tsType:{name:"string"},description:"Additional class name"}}};ke.t.bind(ke);function Vb(t){if(!Bo(t))throw new Error("Invalid mnemonic");return Lm(t.join(" "))}function Jb(t){return new Set(t.map(s=>s.address.toLowerCase()))}const Kb=ke.t.bind(ke),Sa={isDuplicate:!1,type:"none"};function Gb(t){const[s,n]=c.useState(Sa),[a,r]=c.useState(!1),[o,d]=c.useState(null),i=c.useCallback(async u=>{r(!0),d(null);try{const m=Vb(u),f=Jb(m),h=await t.getAllAddresses();for(const x of h)if(f.has(x.address.toLowerCase())){const v={isDuplicate:!0,type:"address",matchedWallet:{id:x.walletId,name:x.walletName,importType:"mnemonic",matchedAddress:x.address}};return n(v),v}const b=(await t.getAllMainWallets()).filter(x=>x.importType==="privateKey");for(const x of b)for(const v of x.addresses)if(f.has(v.address.toLowerCase())){const j={isDuplicate:!0,type:"privateKey",matchedWallet:{id:x.id,name:x.name,importType:"privateKey",matchedAddress:v.address}};return n(j),j}const p={isDuplicate:!1,type:"none"};return n(p),p}catch(m){const f=m instanceof Error?m.message:Kb("error:duplicate.detectionFailed");return d(f),Sa}finally{r(!1)}},[t]),l=c.useCallback(()=>{n(Sa),d(null)},[]);return{result:s,isChecking:a,error:o,check:i,reset:l}}const Qb={getAllAddresses:async()=>[],getAllMainWallets:async()=>[],findWalletByAddress:async()=>null};function Nu(){const{navigate:t,goBack:s}=de(),{push:n}=Z(),{t:a}=B(["onboarding","common","wallet"]),r=Ys(),o=ut().snapshot,d=vm(),i=ts(),[l,u]=c.useState("keyType"),[m,f]=c.useState("mnemonic"),[h,g]=c.useState(!1),[b,p]=c.useState([]),[x,v]=c.useState(""),[j,N]=c.useState(null),[y,S]=c.useState([]),[k,I]=c.useState(!1),[_,A]=c.useState(""),[E,C]=c.useState(null),[T,w]=c.useState([]),[P,L]=c.useState(!1);c.useEffect(()=>{!P&&r.length>0&&(w(ac(r)),L(!0))},[r,P]);const z=Gb(Qb),R=(()=>{switch(l){case"keyType":return 1;case"mnemonic":case"arbitrary":return 2;case"collision":return 2;case"pattern":return 3;case"chains":return 4;case"theme":return 5;case"success":return 5;default:return 1}})(),q=c.useCallback(()=>{switch(l){case"keyType":s();break;case"mnemonic":case"arbitrary":u("keyType"),z.reset();break;case"collision":u("mnemonic"),z.reset();break;case"pattern":u(m==="arbitrary"?"arbitrary":"mnemonic");break;case"chains":u("pattern");break;case"theme":u("chains");break}},[l,s,z,m]),M=c.useCallback(()=>{u("pattern")},[]),F=c.useCallback(X=>{A(X),u("chains")},[]),K=c.useCallback(()=>{if(m==="mnemonic"){u("mnemonic");return}if(h){u("arbitrary");return}ey(()=>{g(!0),u("arbitrary")}),n("SecurityWarningJob",{})},[m,h,n]),ee=c.useCallback(async X=>{p(X.mnemonic);const O=await z.check(X.mnemonic);if(O.isDuplicate){if(O.type==="address")return;if(O.type==="privateKey"){u("collision");return}}M()},[z,M]),W=c.useCallback(async()=>{M()},[M]),$=c.useCallback(()=>{u("mnemonic"),z.reset()},[z]),ie=c.useCallback(async(X,O)=>{I(!0);try{const G=X.join(" "),ge=(await rc({mnemonic:G,selectedChainIds:T,chainConfigs:r})).map(({chainId:Ot,address:Bt,publicKey:ht})=>({chain:Ot,address:Bt,publicKey:ht??"",tokens:[]})),ve=ge[0];if(!ve)throw new Error("No chain addresses derived");const ze=Ta(ve.address),pt=await ye.createWallet({name:a("onboarding:create.generatedNamePattern",{word:En(i),suffix:a("onboarding:create.walletSuffix")}),keyType:"mnemonic",address:ve.address,chain:ve.chain,chainAddresses:ge,themeHue:ze},G,O,ze);C(pt.id),u("theme")}catch{}finally{I(!1)}},[r,T,a]),ne=c.useCallback(async X=>{const O=x.trim();if(O&&y.length!==0){I(!0);try{const G=y[0];if(!G)throw new Error("No enabled bioforest chains");const re=Ta(G.address),ge=y.map(ze=>({chain:ze.chainId,address:ze.address,publicKey:"",tokens:[]})),ve=await ye.createWallet({name:a("onboarding:create.generatedNamePattern",{word:En(i),suffix:a("onboarding:create.walletSuffix")}),keyType:"arbitrary",address:G.address,chain:G.chainId,chainAddresses:ge,themeHue:re},O,X,re);C(ve.id),u("theme")}catch{}finally{I(!1)}}},[y,x,a]),ae=c.useCallback(()=>{t({to:"/",replace:!0})},[t]),se=c.useCallback(async()=>{if(!k){if(m==="arbitrary"){await ne(_);return}b.length!==0&&await ie(b,_)}},[ne,ie,k,m,b,_]),H=c.useCallback(()=>{t({to:"/"})},[t]);return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[l==="keyType"&&e.jsxs(e.Fragment,{children:[e.jsx(J,{title:a("onboarding:keyType.title"),onBack:q}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(jt,{total:5,current:R})}),e.jsxs("div",{"data-testid":"key-type-step",className:"flex-1 space-y-6 p-4",children:[e.jsx(Kf,{value:m,onChange:X=>{f(X),X==="mnemonic"&&(v(""),S([]))}}),e.jsx(V,{type:"button","data-testid":"continue-button",onClick:K,className:"w-full",children:a("common:continue")})]})]}),l==="mnemonic"&&e.jsxs(e.Fragment,{children:[e.jsx(J,{title:a("onboarding:recover.title"),onBack:q}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(jt,{total:5,current:R})}),e.jsx("div",{"data-testid":"mnemonic-step",className:"flex-1 p-4",children:e.jsx(km,{onSubmit:ee,isSubmitting:z.isChecking})})]}),l==="arbitrary"&&e.jsxs(e.Fragment,{children:[e.jsx(J,{title:a("onboarding:keyType.arbitrary"),onBack:q}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(jt,{total:5,current:R})}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx(Gf,{value:x,onChange:X=>{N(null),v(X)},disabled:k}),j&&e.jsxs("div",{className:"bg-destructive/10 text-destructive flex items-start gap-2 rounded-lg px-3 py-2 text-sm",children:[e.jsx(Mt,{className:"mt-0.5 size-4 shrink-0"}),e.jsx("span",{children:j})]}),e.jsx(Qf,{secret:x,enabledBioforestChainConfigs:o?d:void 0,onDerived:S}),e.jsxs(V,{type:"button",className:"w-full",disabled:k||x.trim()!==""&&y.length===0,onClick:()=>{if(!x.trim()){N(a("onboarding:arbitraryKey.required"));return}M()},children:[k&&e.jsx(be,{className:"size-4 animate-spin"}),a("common:continue")]})]})]}),l==="collision"&&e.jsxs(e.Fragment,{children:[e.jsx(J,{title:a("onboarding:recover.addressConflict"),onBack:q}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(jt,{total:5,current:R})}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(Xf,{result:z.result,onConfirm:W,onCancel:$,isLoading:k})})]}),l==="pattern"&&e.jsxs(e.Fragment,{children:[e.jsx(J,{title:a("onboarding:recover.setWalletLock"),onBack:q}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(jt,{total:5,current:R})}),e.jsx("div",{"data-testid":"pattern-step",className:"flex-1 p-4",children:e.jsx(pr,{onComplete:F,minPoints:4})})]}),l==="chains"&&e.jsxs(e.Fragment,{children:[e.jsx(J,{title:a("onboarding:chainSelector.title"),onBack:q}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(jt,{total:5,current:R})}),e.jsx("div",{"data-testid":"chains-step",className:"flex-1 p-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(en,{icon:e.jsx(ws,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:a("onboarding:chainSelector.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:a("onboarding:chainSelector.subtitle")})]}),r.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(Pe,{})}):e.jsx(hr,{"data-testid":"chain-selector",chains:r,selectedChains:T,onSelectionChange:w}),e.jsx(Ue,{variant:"mint",className:"w-full","data-testid":"chains-continue-button",disabled:T.length===0,onClick:se,children:a("common:next")})]})})]}),l==="theme"&&E&&e.jsxs(e.Fragment,{children:[e.jsx(J,{title:a("onboarding:create.themeTitle")}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(jt,{total:5,current:R})}),e.jsx("div",{"data-testid":"theme-step",className:"flex-1 p-4",children:e.jsx(ta,{mode:"edit-only",walletId:E,onEditOnlyComplete:ae})})]}),l==="success"&&e.jsx(ju,{walletName:a("wallet:defaultName"),onEnterWallet:H})]})}Nu.__docgenInfo={description:`Onboarding recover wallet page
Implements wallet recovery with duplicate detection per openspec/changes/add-wallet-recover-duplicate-guards`,methods:[],displayName:"OnboardingRecoverPage"};const wu=()=>e.jsx(le,{children:e.jsx(Nu,{})});wu.__docgenInfo={description:"",methods:[],displayName:"OnboardingRecoverActivity"};const bn={symbol:"USDT",balance:1234.56,fiatValue:"1234.56"},Xb=[{id:"1",type:"send",status:"confirmed",amount:oe.fromFormatted("100",6,"USDT"),symbol:"USDT",address:"0xabcd...1234",timestamp:new Date(Date.now()-36e5)},{id:"2",type:"receive",status:"confirmed",amount:oe.fromFormatted("500",6,"USDT"),symbol:"USDT",address:"0x1234...abcd",timestamp:new Date(Date.now()-864e5)}];function ku(){const{t}=B("token"),{navigate:s,goBack:n}=de();return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(J,{title:bn.symbol,onBack:n}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsx("div",{className:"text-center",children:e.jsx($f,{value:bn.balance,symbol:bn.symbol,fiatValue:bn.fiatValue,size:"lg"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(Ue,{variant:"mint",className:"flex-1",onClick:()=>s({to:"/send",search:{address:void 0,chain:void 0,amount:void 0}}),children:[e.jsx($m,{className:"mr-2 size-4"}),t("detail.send")]}),e.jsxs(Ue,{variant:"blue",className:"flex-1",onClick:()=>s({to:"/receive"}),children:[e.jsx(Fs,{className:"mr-2 size-4"}),t("detail.receive")]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold",children:t("detail.transactionHistory")}),e.jsx(dc,{transactions:Xb,emptyTitle:t("detail.noTransactions"),emptyDescription:t("detail.noTransactionsDesc")})]})]})]})}ku.__docgenInfo={description:"",methods:[],displayName:"TokenDetailPage"};const Cu=({params:t})=>e.jsx(le,{children:e.jsx(me,{params:t,children:e.jsx(ku,{})})});Cu.__docgenInfo={description:"",methods:[],displayName:"TokenDetailActivity"};function Su(){const{t}=B("common"),{goBack:s}=de(),{push:n}=Z(),r=Ie(Os).contacts,o=Ie(Le,Xs.getCurrentWallet),[d,i]=c.useState(""),l=c.useRef(null),u=c.useMemo(()=>d.trim()?er.searchContacts(Os.state,d.trim()):r,[r,d]),m=c.useCallback(()=>{s()},[s]),f=c.useCallback(()=>{n("ContactEditJob",{})},[n]),h=c.useCallback(p=>{n("ContactEditJob",{contactId:p.id})},[n]),g=c.useCallback(p=>{n("ContactShareJob",{name:p.name,addresses:JSON.stringify(p.addresses.map(x=>({address:x.address,label:x.label}))),memo:p.memo,avatar:p.avatar})},[n]),b=c.useCallback(p=>{l.current=p,o?.encryptedMnemonic?(Cs(async x=>{try{return await Jt(o.encryptedMnemonic,x)?(Bs.deleteContact(p.id),l.current=null,!0):!1}catch{return!1}}),n("WalletLockConfirmJob",{title:t("addressBook.deleteTitle"),description:t("addressBook.deleteConfirm",{name:p.name})})):(Bs.deleteContact(p.id),l.current=null)},[o?.encryptedMnemonic,n,t]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:t("addressBook.title"),onBack:m,rightAction:e.jsx("button",{onClick:f,className:D("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":t("a11y.addContact"),"data-testid":"address-book-add-button",children:e.jsx(mt,{className:"size-5"})})}),e.jsx("div",{className:"px-4 py-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(sn,{className:"text-muted-foreground absolute top-1/2 left-3 size-4 -translate-y-1/2"}),e.jsx("input",{type:"text",value:d,onChange:p=>i(p.target.value),placeholder:t("addressBook.searchPlaceholder"),className:D("border-border bg-background w-full rounded-xl border py-2.5 pr-4 pl-10","focus:ring-primary focus:ring-2 focus:outline-none")})]})}),e.jsx("div",{className:"flex-1 p-4",children:u.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[e.jsx(mf,{className:"text-muted-foreground/50 size-12"}),e.jsx("p",{className:"text-muted-foreground",children:t(d?"addressBook.noResults":"addressBook.noContacts")}),!d&&e.jsx("button",{onClick:f,className:D("bg-primary rounded-full px-6 py-2.5 text-sm font-medium text-primary-foreground","hover:bg-primary/90 active:bg-primary/80"),children:t("contact.addTitle")})]}):e.jsx("div",{className:"space-y-2",children:u.map(p=>e.jsx(Yb,{contact:p,onShare:()=>g(p),onEdit:()=>h(p),onDelete:()=>b(p)},p.id))})})]})}function Yb({contact:t,onEdit:s,onDelete:n,onShare:a}){const{t:r}=B("common"),[o,d]=c.useState(!1);return e.jsx("div",{className:D("bg-card rounded-xl p-4 shadow-sm","transition-colors"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ns,{src:t.avatar||(t.addresses[0]?.address?Kt(t.addresses[0].address):void 0),size:40}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"truncate font-medium",children:t.name}),t.addresses.length>0&&e.jsxs("p",{className:"text-muted-foreground truncate font-mono text-xs",children:[t.addresses[0]?.address,t.addresses.length>1&&` (+${t.addresses.length-1})`]}),t.memo&&e.jsx("p",{className:"text-muted-foreground mt-1 truncate text-xs",children:t.memo})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>d(!o),className:D("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":r("a11y.moreActions"),children:e.jsx(Yf,{className:"text-muted-foreground size-4"})}),o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>d(!1)}),e.jsxs("div",{className:"bg-popover border-border absolute top-full right-0 z-20 mt-1 w-32 rounded-lg border py-1 shadow-lg",children:[e.jsx("button",{onClick:()=>{d(!1),a()},className:"hover:bg-muted w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.shareContact")}),e.jsx("button",{onClick:()=>{d(!1),s()},className:"hover:bg-muted w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.edit")}),e.jsx("button",{onClick:()=>{d(!1),n()},className:"text-destructive hover:bg-destructive/10 w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.delete")})]})]})]})]})})}Su.__docgenInfo={description:"",methods:[],displayName:"AddressBookPage"};const Au=()=>e.jsx(le,{children:e.jsx(Su,{})});Au.__docgenInfo={description:"",methods:[],displayName:"AddressBookActivity"};function Iu({open:t,onOpenChange:s}){const{t:n}=B("common"),a=Rt(),r=nr(),o=um(),d=mm(),i=ss(),l=c.useCallback(u=>{!o.includes(u)&&!d||ms.toggleWalletSelection(u)},[o,d]);return e.jsx(St,{open:t,onOpenChange:s,children:e.jsxs(At,{side:"bottom",className:"rounded-t-2xl",children:[e.jsx(It,{className:"pb-4",children:e.jsx(Tt,{children:n("myCard.selectWallets")})}),e.jsxs("div",{className:"max-h-[50vh] overflow-y-auto pb-[env(safe-area-inset-bottom)]",children:[a.map(u=>{const m=r[u.id]||u.chain,f=u.chainAddresses.find(b=>b.chain===m),h=o.includes(u.id),g=!h&&!d;return e.jsxs("button",{type:"button",onClick:()=>l(u.id),disabled:g,className:D("flex w-full items-center gap-3 rounded-lg p-3 text-left transition-colors",h&&"bg-primary/10",!g&&"hover:bg-muted",g&&"cursor-not-allowed opacity-50"),children:[e.jsx(_t,{chain:m,size:"md"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium",children:u.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{children:i[m]||m}),e.jsxs("span",{className:"truncate font-mono text-xs",children:[f?.address.slice(0,8),"...",f?.address.slice(-6)]})]})]}),h&&e.jsx("div",{className:"flex size-6 items-center justify-center rounded-full bg-primary",children:e.jsx(Ne,{className:"size-4 text-primary-foreground"})})]},u.id)}),a.length===0&&e.jsx("div",{className:"py-8 text-center text-muted-foreground",children:n("noAssets")})]}),e.jsx("p",{className:"py-4 text-center text-xs text-muted-foreground",children:n("myCard.maxWallets",{max:3})})]})})}Iu.__docgenInfo={description:"",methods:[],displayName:"WalletPickerSheet",props:{open:{required:!0,tsType:{name:"boolean"},description:""},onOpenChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(open: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"open"}],return:{name:"void"}}},description:""}}};function Zb(t,s){const[n,a]=c.useState(!1),{filename:r,shareTitle:o,shareText:d}=s,i=c.useCallback(async()=>{const u=t.current;if(!(!u||n)){a(!0);try{const{snapdom:m}=await Et(async()=>{const{snapdom:f}=await import("./snapdom-CO8q8LPW.js").then(h=>h.s);return{snapdom:f}},__vite__mapDeps([0,1]),import.meta.url);await m.download(u,{type:"png",filename:`${r}.png`,scale:2,quality:1})}catch(m){console.error("Download failed:",m)}finally{a(!1)}}},[t,r,n]),l=c.useCallback(async()=>{const u=t.current;if(!(!u||!navigator.share||n)){a(!0);try{const{snapdom:m}=await Et(async()=>{const{snapdom:b}=await import("./snapdom-CO8q8LPW.js").then(p=>p.s);return{snapdom:b}},__vite__mapDeps([0,1]),import.meta.url),h=await(await m(u,{scale:2})).toBlob(),g=new File([h],`${r}.png`,{type:"image/png"});await navigator.share({title:o,text:d,files:[g]})}catch{}finally{a(!1)}}},[t,r,o,d,n]);return{isProcessing:n,download:i,share:l,canShare:typeof navigator<"u"&&"share"in navigator}}function Tu(){const{t}=B(["common","settings"]),{goBack:s}=de(),n=c.useRef(null),a=c.useRef(null),r=tr(),o=Rt(),d=nr(),i=ss(),[l,u]=c.useState(!1),[m,f]=c.useState(r.username),[h,g]=c.useState(!1);c.useEffect(()=>{if(!r.avatar&&o.length>0){const A=o[0]?.chainAddresses[0]?.address;A&&ms.initializeDefaultAvatar(A)}},[r.avatar,o]),c.useEffect(()=>{if(r.selectedWalletIds.length===0&&o.length>0){const A=o[0];A&&ms.toggleWalletSelection(A.id)}},[r.selectedWalletIds,o]);const b=c.useMemo(()=>r.selectedWalletIds.map(A=>o.find(E=>E.id===A)).filter(A=>!!A).map(A=>{const E=d[A.id]||A.chain,C=A.chainAddresses.find(T=>T.chain===E);return{wallet:A,chain:E,address:C?.address}}).filter(A=>A.address),[r.selectedWalletIds,o,d]),p=c.useMemo(()=>b.filter(A=>!!A.address).map(({wallet:A,address:E})=>({address:E,label:A.name})),[b]),x=c.useMemo(()=>p.length===0?"":cr({name:r.username||t("myCard.defaultName"),addresses:p,avatar:r.avatar}),[r.username,r.avatar,p,t]),v=c.useCallback(()=>{ms.randomizeAvatar()},[]),j=c.useCallback(()=>{f(r.username),u(!0)},[r.username]),N=c.useCallback(()=>{ms.setUsername(m),u(!1)},[m]),y=c.useCallback(A=>{A.key==="Enter"?N():A.key==="Escape"&&u(!1)},[N]);c.useEffect(()=>{l&&n.current?.focus()},[l]);const{isProcessing:S,download:k,share:I}=Zb(a,{filename:`my-card-${Date.now()}`,shareTitle:t("myCard.title"),shareText:r.username||t("myCard.defaultName")}),_=r.username||t("myCard.defaultName");return e.jsxs("div",{className:"flex min-h-screen flex-col bg-background",children:[e.jsx(J,{title:t("myCard.title"),onBack:s}),e.jsxs("div",{className:"flex flex-1 flex-col items-center p-6",children:[e.jsxs("button",{type:"button",onClick:v,className:"group relative mb-4 cursor-pointer transition-transform hover:scale-105","aria-label":t("myCard.changeAvatar"),children:[e.jsx(Ns,{src:r.avatar,size:80}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center rounded-full bg-black/50 opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx("span",{className:"text-xs text-white",children:t("myCard.changeAvatar")})})]}),l?e.jsx("div",{className:"mb-6 flex items-center gap-2",children:e.jsx(Ve,{ref:n,value:m,onChange:A=>f(A.target.value),onBlur:N,onKeyDown:y,placeholder:t("myCard.usernamePlaceholder"),className:"w-48 text-center"})}):e.jsxs("button",{type:"button",onClick:j,className:"group mb-6 flex items-center gap-2 text-xl font-semibold",children:[e.jsx("span",{children:_}),e.jsx(Zf,{className:"size-4 text-muted-foreground opacity-50 group-hover:opacity-100"})]}),p.length>0?e.jsx("div",{ref:a,className:"mb-6",children:e.jsx(dr,{name:_,avatar:r.avatar,addresses:p,qrContent:x})}):e.jsx("div",{className:"mb-6 flex h-[300px] w-[320px] items-center justify-center rounded-3xl bg-muted",children:e.jsx("p",{className:"text-muted-foreground",children:t("myCard.noWalletsSelected")})}),e.jsxs("div",{className:"mb-6 w-full max-w-[320px]",children:[e.jsx("h3",{className:"mb-2 text-sm font-medium text-muted-foreground",children:t("myCard.selectWallets")}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[b.map(({wallet:A,chain:E})=>{const{c0:C}=Af(A.themeHue);return e.jsxs("div",{className:"flex items-center gap-1.5 rounded-full px-3 py-1.5 text-sm font-medium",style:{backgroundColor:C,color:"#FFFFFF"},children:[e.jsx("span",{children:A.name}),e.jsx("span",{style:{opacity:.8},children:t("myCard.chainLabel",{chain:i[E]||E})}),e.jsx("button",{type:"button",onClick:()=>ms.toggleWalletSelection(A.id),className:"ml-0.5 rounded-full p-0.5 transition-colors hover:bg-white/20","aria-label":t("myCard.removeWallet",{name:A.name}),children:e.jsx(an,{className:"size-3"})})]},A.id)}),r.selectedWalletIds.length<3&&e.jsxs("button",{type:"button",onClick:()=>g(!0),className:"flex items-center gap-1 rounded-full border border-dashed border-muted-foreground/50 px-3 py-1 text-sm text-muted-foreground hover:border-primary hover:text-primary",children:[e.jsx(mt,{className:"size-3"}),t("myCard.addWallet")]})]}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:t("myCard.maxWallets",{max:3})})]}),e.jsxs("div",{className:"flex w-full max-w-[320px] gap-3",children:[e.jsxs(V,{variant:"outline",onClick:k,disabled:S||p.length===0,className:"flex-1",children:[S?e.jsx(be,{className:"mr-2 size-4 animate-spin"}):e.jsx(nn,{className:"mr-2 size-4"}),t("download")]}),"share"in navigator&&e.jsxs(V,{onClick:I,disabled:S||p.length===0,className:"flex-1",children:[S?e.jsx(be,{className:"mr-2 size-4 animate-spin"}):e.jsx(Us,{className:"mr-2 size-4"}),t("share")]})]}),e.jsx("p",{className:"mt-6 text-center text-sm text-muted-foreground",children:t("myCard.scanToAdd")})]}),e.jsx(Iu,{open:h,onOpenChange:g})]})}Tu.__docgenInfo={description:"",methods:[],displayName:"MyCardPage"};const Pu=()=>e.jsx(le,{children:e.jsx(Tu,{})});Pu.__docgenInfo={description:"",methods:[],displayName:"MyCardActivity"};const ej={transaction:{icon:"",bg:"bg-blue-100 dark:bg-blue-900/30"},security:{icon:"",bg:"bg-red-100 dark:bg-red-900/30"},system:{icon:"",bg:"bg-gray-100 dark:bg-gray-800/30"}};function tj(){const{t}=B("notification"),s=ts();return c.useCallback(n=>{const r=Date.now()-n,o=Math.floor(r/6e4),d=Math.floor(r/36e5),i=Math.floor(r/864e5);return o<1?t("time.justNow"):o<60?t("time.minutesAgo",{count:o}):d<24?t("time.hoursAgo",{count:d}):i<7?t("time.daysAgo",{count:i}):new Date(n).toLocaleDateString(s)},[t,s])}function sj({notification:t,onRead:s,onRemove:n,onNavigate:a,formatRelativeTime:r,t:o}){const d=ej[t.type],i=t.type==="transaction"&&!!t.data?.pendingTxId,l=c.useCallback(()=>{t.read||s(t.id),i&&a&&a(t)},[t,s,a,i]);return e.jsxs("div",{onClick:l,className:D("flex cursor-pointer items-start gap-3 rounded-xl p-4 transition-colors",t.read?"bg-muted/30":"bg-card shadow-sm"),children:[e.jsx("div",{className:D("flex size-10 shrink-0 items-center justify-center rounded-full",d.bg),children:e.jsx("span",{className:"text-lg",children:d.icon})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h4",{className:D("font-medium",t.read&&"text-muted-foreground"),children:t.title}),e.jsx("span",{className:"text-muted-foreground shrink-0 text-xs",children:r(t.timestamp)})]}),e.jsx("p",{className:D("mt-1 text-sm",t.read?"text-muted-foreground":"text-foreground/80"),children:t.message}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[!t.read&&e.jsx("div",{className:"bg-primary flex size-2 rounded-full","aria-label":o("unread")}),i&&e.jsxs("span",{className:"text-primary flex items-center gap-0.5 text-xs",children:[o("viewDetails"),e.jsx(De,{className:"size-3"})]})]})]}),e.jsx("button",{onClick:u=>{u.stopPropagation(),n(t.id)},className:"text-muted-foreground hover:text-destructive shrink-0 p-1","aria-label":o("delete"),children:e.jsx(ns,{className:"size-4"})})]})}function nj({notifications:t,onRead:s,onRemove:n,onNavigate:a,formatRelativeTime:r,t:o,language:d}){const i=c.useMemo(()=>{const l=new Map,u=new Date().toLocaleDateString(d),m=new Date(Date.now()-864e5).toLocaleDateString(d);for(const f of t){const h=new Date(f.timestamp).toLocaleDateString(d);let g=h;h===u?g=o("time.today"):h===m&&(g=o("time.yesterday"));const b=l.get(g)||[];l.set(g,[...b,f])}return l},[t,d,o]);return t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx("div",{className:"bg-muted mb-4 flex size-16 items-center justify-center rounded-full",children:e.jsx(ep,{className:"text-muted-foreground size-8"})}),e.jsx("h3",{className:"text-lg font-medium",children:o("empty.title")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:o("empty.desc")})]}):e.jsx("div",{className:"space-y-6",children:Array.from(i.entries()).map(([l,u])=>e.jsxs("div",{children:[e.jsx("h3",{className:"text-muted-foreground mb-2 text-sm font-medium",children:l}),e.jsx("div",{className:"space-y-2",children:u.map(m=>e.jsx(sj,{notification:m,onRead:s,onRemove:n,onNavigate:a,formatRelativeTime:r,t:o},m.id))})]},l))})}function Eu(){const{t}=B("notification"),s=ts(),n=tj(),{goBack:a,navigate:r}=de(),o=Ie(Dm);c.useEffect(()=>{o.isInitialized||Ss.initialize()},[o.isInitialized]);const d=c.useCallback(f=>{Ss.markRead(f)},[]),i=c.useCallback(f=>{Ss.remove(f)},[]),l=c.useCallback(()=>{Ss.markAllRead()},[]),u=c.useCallback(()=>{Ss.clearAll()},[]),m=c.useCallback(f=>{f.type==="transaction"&&f.data?.pendingTxId&&r({to:`/pending-tx/${f.data.pendingTxId}`})},[r]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:t("title"),onBack:a,rightAction:o.unreadCount>0?e.jsxs("button",{onClick:l,className:"text-primary hover:bg-primary/10 flex items-center gap-1 rounded-full px-3 py-1.5 text-sm","aria-label":t("markAllRead"),children:[e.jsx(Ne,{className:"size-4"}),t("markAllRead")]}):void 0}),e.jsx("div",{className:"bg-card border-b px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:o.unreadCount>0?t("unreadCount",{count:o.unreadCount}):t("noUnread")}),o.notifications.length>0&&e.jsxs(V,{variant:"ghost",size:"sm",onClick:u,className:"text-destructive",children:[e.jsx(ns,{className:"mr-1 size-4"}),t("clear")]})]})}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(nj,{notifications:o.notifications,onRead:d,onRemove:i,onNavigate:m,formatRelativeTime:n,t,language:s})})]})}Eu.__docgenInfo={description:"",methods:[],displayName:"NotificationCenterPage"};const _u=()=>e.jsx(le,{children:e.jsx(Eu,{})});_u.__docgenInfo={description:"",methods:[],displayName:"NotificationsActivity"};function aj(t){const s=t.toNumber();return s>=1e9?`${(s/1e9).toFixed(2)}B`:s>=1e6?`${(s/1e6).toFixed(2)}M`:s>=1e3?`${(s/1e3).toFixed(2)}K`:s.toFixed(Math.min(5,8))}function Mu({item:t,onMint:s,className:n}){const{t:a}=B("staking"),r=[{label:a("totalMinted",{asset:t.assetType}),value:t.totalMinted},{label:a("totalCirculation",{asset:t.assetType}),value:t.totalCirculation},{label:a("totalBurned",{asset:t.assetType}),value:t.totalBurned},{label:a("totalStaked",{asset:t.externalAssetType}),value:t.totalStaked}];return e.jsxs("div",{className:D("overflow-hidden rounded-xl shadow-md","bg-gradient-to-b from-primary/90 to-primary",n),children:[e.jsxs("div",{className:"relative grid grid-cols-2 gap-3 p-4",children:[r.map((o,d)=>e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("span",{className:"text-lg font-semibold text-amber-300",children:aj(o.value)}),e.jsx("span",{className:"text-xs text-primary-foreground/70",children:o.label})]},d)),e.jsx("div",{className:"pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 opacity-20",children:e.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-white/20 text-2xl font-bold text-white",children:t.chain.charAt(0)})})]}),e.jsxs("div",{className:"flex items-center justify-between bg-card px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ct,{symbol:t.externalAssetType,size:"sm"}),e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"font-medium text-foreground",children:t.externalAssetType}),e.jsx("div",{className:"text-muted-foreground",children:t.externalChain})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ct,{symbol:t.assetType,size:"sm"}),e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"font-medium text-foreground",children:t.assetType}),e.jsx("div",{className:"text-muted-foreground",children:t.chain})]})]}),e.jsx(V,{size:"sm",variant:"default",className:"rounded-full px-4",onClick:()=>s?.(t),children:a("mint")})]})]})]})}Mu.__docgenInfo={description:"Staking pool card component",methods:[],displayName:"StakingPoolCard",props:{item:{required:!0,tsType:{name:"StakingOverviewItem"},description:""},onMint:{required:!1,tsType:{name:"union",raw:"((item: StakingOverviewItem) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const rj=[{value:"all",label:"allNetworks"},{value:"ETH",label:"Ethereum"},{value:"BSC",label:"BNB Chain"},{value:"TRON",label:"Tron"},{value:"BFMeta",label:"BFMeta"},{value:"BFChain",label:"BFChain"}];function Ru({onMint:t,className:s}){const{t:n}=B("staking"),[a,r]=c.useState(""),[o,d]=c.useState("all"),[i,l]=c.useState(!1),[u,m]=c.useState([]),[f,h]=c.useState(!0);c.useEffect(()=>{let p=!0;return h(!0),Gt.getOverview().then(x=>{p&&(m(x),h(!1))}),()=>{p=!1}},[]);const g=c.useMemo(()=>{let p=u;if(a.trim()){const x=a.toLowerCase();p=p.filter(v=>v.assetType.toLowerCase().includes(x)||v.externalAssetType.toLowerCase().includes(x)||v.chain.toLowerCase().includes(x)||v.externalChain.toLowerCase().includes(x))}return o!=="all"&&(p=p.filter(x=>x.chain===o||x.externalChain===o)),p},[u,a,o]),b=p=>{d(p),l(!1)};return f?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[e.jsx(Pe,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):e.jsxs("div",{className:D("space-y-4",s),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(sn,{className:"text-muted-foreground absolute top-1/2 left-3 size-4 -translate-y-1/2"}),e.jsx(Ve,{type:"text",placeholder:n("searchPlaceholder"),value:a,onChange:p=>r(p.target.value),className:"pl-9"})]}),e.jsxs(St,{open:i,onOpenChange:l,children:[e.jsx(wf,{render:e.jsxs(V,{variant:"outline",size:"icon",className:"relative",children:[e.jsx(vc,{className:"size-4"}),o!=="all"&&e.jsx("span",{className:"bg-primary absolute -top-1 -right-1 size-2 rounded-full"})]})}),e.jsxs(At,{side:"bottom",className:"h-[60vh]",children:[e.jsx(It,{children:e.jsx(Tt,{children:n("selectNetwork")})}),e.jsx("div",{className:"mt-4 space-y-2",children:rj.map(p=>e.jsxs("button",{onClick:()=>b(p.value),className:D("flex w-full items-center justify-between rounded-lg px-4 py-3 text-left transition-colors",o===p.value?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("span",{children:p.value==="all"?n("allNetworks"):p.label}),o===p.value&&e.jsx("span",{className:"text-primary",children:""})]},p.value))})]})]})]}),g.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-20",children:e.jsx("p",{className:"text-muted-foreground",children:n("noResults")})}):e.jsx("div",{className:"space-y-4",children:g.map((p,x)=>e.jsx(Mu,{item:p,onMint:t},`${p.chain}-${p.assetType}-${x}`))})]})}Ru.__docgenInfo={description:"Staking overview panel with search and filter",methods:[],displayName:"StakingOverviewPanel",props:{onMint:{required:!1,tsType:{name:"signature",type:"function",raw:"(item: StakingOverviewItem) => void",signature:{arguments:[{type:{name:"StakingOverviewItem"},name:"item"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const ij=["ETH","BSC","TRON"],oj={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron"},Po={ETH:{BFM:"1000.00",USDT:"5000.00"},BSC:{BFM:"2500.00",USDT:"10000.00",BFC:"500.00"},TRON:{USDT:"8000.00"}};function cj(t,s){if(!t)return[];const n=[];for(const[a,r]of Object.entries(t))for(const[o,d]of Object.entries(r)){const i=d.supportChain[s];i&&n.push({asset:i.assetType,targetChain:a,targetAsset:o})}return n}function Lu({onSuccess:t,className:s}){const{t:n}=B("staking"),a=ss(),[r,o]=c.useState("BSC"),[d,i]=c.useState(""),[l,u]=c.useState(""),[m,f]=c.useState(""),[h,g]=c.useState(""),[b,p]=c.useState(!1),[x,v]=c.useState(!1),[j,N]=c.useState(!0),[y,S]=c.useState(!1),[k,I]=c.useState(null);c.useEffect(()=>{let R=!0;return Gt.getRechargeConfig().then(q=>{R&&(I(q),N(!1))}),()=>{R=!1}},[]);const _=c.useMemo(()=>cj(k,r),[k,r]),A=c.useCallback(R=>{const q=oj[R];if(q)return q;const M=R.toLowerCase();return a[M]??a[R]??R},[a]);c.useEffect(()=>{const R=_[0];R&&!d&&(i(R.asset),u(R.targetChain),f(R.targetAsset))},[_,d]);const E=c.useCallback(R=>{o(R),i(""),u(""),f(""),g(""),p(!1)},[]),C=c.useCallback(R=>{i(R.asset),u(R.targetChain),f(R.targetAsset),v(!1)},[]),T=c.useMemo(()=>Po[r]?.[d]??"0.00",[r,d]),w=c.useCallback(()=>{g(T.replace(/,/g,""))},[T]),P=c.useMemo(()=>{if(!h)return null;const R=parseFloat(h);if(isNaN(R)||R<=0)return n("invalidAmount");const q=parseFloat(T.replace(/,/g,""));return R>q?n("insufficientBalance"):null},[h,T,n]),L=c.useMemo(()=>r&&d&&l&&m&&h&&!P&&!y,[r,d,l,m,h,P,y]),z=c.useCallback(async()=>{if(L){S(!0);try{const R=h.replace(/,/g,""),q={sourceChain:r,sourceAsset:d,amount:oe.fromFormatted(R,18,d),targetChain:l,targetAsset:m},M=await Gt.submitMint(q);t?.(M.id)}finally{S(!1)}}},[L,r,d,h,l,m,t]);return j?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Pe,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):e.jsxs("div",{className:D("space-y-4",s),children:[e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("sourceChain")}),e.jsxs("button",{type:"button",onClick:()=>p(!0),className:"bg-background mb-3 flex w-full items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-muted flex size-6 items-center justify-center rounded-full text-xs font-bold",children:r.charAt(0)}),e.jsx("span",{className:"font-medium",children:A(r)})]}),e.jsx(De,{className:"text-muted-foreground size-4"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>v(!0),className:"bg-background flex shrink-0 items-center gap-2 rounded-lg px-3 py-2",children:[e.jsx(ct,{symbol:d||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:d||n("selectToken")}),e.jsx(De,{className:"text-muted-foreground size-4"})]}),e.jsx("div",{className:"flex-1",children:e.jsx(Ve,{type:"text",inputMode:"decimal",placeholder:"0.00",value:h,onChange:R=>g(R.target.value),className:"border-0 bg-transparent text-right text-lg font-semibold"})})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-muted-foreground",children:[n("availableBalance"),": ",T]}),e.jsx(V,{type:"button",variant:"ghost",size:"sm",className:"text-primary h-auto px-2 py-1 text-xs",onClick:w,children:n("max")})]}),P&&e.jsx("div",{className:"text-destructive mt-2 text-xs",children:P})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-muted rounded-full p-2",children:e.jsx(Fs,{className:"text-muted-foreground size-4"})})}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("targetChain")}),e.jsxs("div",{className:"bg-background flex items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-primary/20 text-primary flex size-6 items-center justify-center rounded-full text-xs font-bold",children:l.charAt(0)||"?"}),e.jsx("span",{className:"font-medium",children:l?A(l):n("selectToken")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ct,{symbol:m||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:m||"-"})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:n("amount")}),e.jsxs("span",{className:"font-semibold",children:[h||"0.00"," ",m]})]})]}),e.jsx(V,{type:"button",size:"lg",className:"w-full",disabled:!L,onClick:z,children:y?e.jsxs(e.Fragment,{children:[e.jsx(Pe,{size:"sm"}),e.jsx("span",{className:"ml-2",children:n("confirm")})]}):n("confirm")}),e.jsx(St,{open:b,onOpenChange:p,children:e.jsxs(At,{side:"bottom",className:"h-[50vh]",children:[e.jsx(It,{children:e.jsx(Tt,{children:n("selectChain")})}),e.jsx("div",{className:"mt-4 space-y-2",children:ij.map(R=>e.jsxs("button",{onClick:()=>E(R),className:D("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",r===R?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("div",{className:"bg-muted flex size-8 items-center justify-center rounded-full text-sm font-bold",children:R.charAt(0)}),e.jsx("span",{className:"font-medium",children:A(R)}),r===R&&e.jsx("span",{className:"text-primary ml-auto",children:""})]},R))})]})}),e.jsx(St,{open:x,onOpenChange:v,children:e.jsxs(At,{side:"bottom",className:"h-[60vh]",children:[e.jsx(It,{children:e.jsx(Tt,{children:n("selectToken")})}),e.jsx("div",{className:"mt-4 space-y-2",children:_.length===0?e.jsx("p",{className:"text-muted-foreground py-8 text-center",children:n("noResults")}):_.map(R=>e.jsxs("button",{onClick:()=>C(R),className:D("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",d===R.asset?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx(ct,{symbol:R.asset,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:R.asset}),e.jsx("div",{className:"text-muted-foreground text-xs",children:n("targetChainLabel",{chain:A(R.targetChain),asset:R.targetAsset})})]}),e.jsx("div",{className:"text-muted-foreground text-right text-sm",children:Po[r]?.[R.asset]??"0.00"}),d===R.asset&&e.jsx("span",{className:"text-primary",children:""})]},`${R.targetChain}-${R.asset}`))})]})})]})}Lu.__docgenInfo={description:"Mint form component",methods:[],displayName:"MintForm",props:{onSuccess:{required:!1,tsType:{name:"signature",type:"function",raw:"(txId: string) => void",signature:{arguments:[{type:{name:"string"},name:"txId"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const lj=["BFMeta","BFChain","CCChain","PMChain"],dj={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron"},Eo={BFMeta:{BFM:"5000.00",USDT:"2500.00"},BFChain:{BFC:"1000.00"},CCChain:{},PMChain:{}};function uj(t,s){if(!t)return[];const n=s.toLowerCase(),a=t[n];if(!a)return[];const r=[];for(const[o,d]of Object.entries(a)){const i=[];d.supportChain.ETH&&i.push("ETH"),d.supportChain.BSC&&i.push("BSC"),d.supportChain.TRON&&i.push("TRON"),i.length>0&&r.push({asset:o,targetChains:i})}return r}function Du({onSuccess:t,className:s}){const{t:n}=B("staking"),a=ss(),[r,o]=c.useState("BFMeta"),[d,i]=c.useState(""),[l,u]=c.useState(""),[m,f]=c.useState(""),[h,g]=c.useState(!1),[b,p]=c.useState(!1),[x,v]=c.useState(!1),[j,N]=c.useState(!0),[y,S]=c.useState(!1),[k,I]=c.useState(null);c.useEffect(()=>{let M=!0;return Gt.getRechargeConfig().then(F=>{M&&(I(F),N(!1))}),()=>{M=!1}},[]);const _=c.useMemo(()=>uj(k,r),[k,r]),A=c.useCallback(M=>{const F=dj[M];if(F)return F;const K=M.toLowerCase();return a[K]??a[M]??M},[a]),E=c.useMemo(()=>d?_.find(F=>F.asset===d)?.targetChains??[]:[],[_,d]);c.useEffect(()=>{const M=_[0];if(M&&!d){i(M.asset);const F=M.targetChains[0];F&&u(F)}},[_,d]);const C=c.useCallback(M=>{o(M),i(""),u(""),f(""),g(!1)},[]),T=c.useCallback(M=>{i(M.asset);const F=M.targetChains[0];F&&u(F),p(!1)},[]),w=c.useCallback(M=>{u(M),v(!1)},[]),P=c.useMemo(()=>Eo[r]?.[d]??"0.00",[r,d]),L=c.useCallback(()=>{f(P.replace(/,/g,""))},[P]),z=c.useMemo(()=>{if(!m)return null;const M=parseFloat(m);if(isNaN(M)||M<=0)return n("invalidAmount");const F=parseFloat(P.replace(/,/g,""));return M>F?n("insufficientBalance"):null},[m,P,n]),R=c.useMemo(()=>r&&d&&l&&m&&!z&&!y,[r,d,l,m,z,y]),q=c.useCallback(async()=>{if(!(!R||!l)){S(!0);try{const M=m.replace(/,/g,""),F={sourceChain:r,sourceAsset:d,amount:oe.fromFormatted(M,8,d),targetChain:l,targetAsset:d},K=await Gt.submitBurn(F);t?.(K.id)}finally{S(!1)}}},[R,r,d,m,l,t]);return j?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Pe,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):e.jsxs("div",{className:D("space-y-4",s),children:[e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("sourceChain")}),e.jsxs("button",{type:"button",onClick:()=>g(!0),className:"bg-background mb-3 flex w-full items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-primary/20 text-primary flex size-6 items-center justify-center rounded-full text-xs font-bold",children:r.charAt(0)}),e.jsx("span",{className:"font-medium",children:A(r)})]}),e.jsx(De,{className:"text-muted-foreground size-4"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>p(!0),className:"bg-background flex shrink-0 items-center gap-2 rounded-lg px-3 py-2",children:[e.jsx(ct,{symbol:d||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:d||n("selectToken")}),e.jsx(De,{className:"text-muted-foreground size-4"})]}),e.jsx("div",{className:"flex-1",children:e.jsx(Ve,{type:"text",inputMode:"decimal",placeholder:"0.00",value:m,onChange:M=>f(M.target.value),className:"border-0 bg-transparent text-right text-lg font-semibold"})})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-muted-foreground",children:[n("availableBalance"),": ",P]}),e.jsx(V,{type:"button",variant:"ghost",size:"sm",className:"text-primary h-auto px-2 py-1 text-xs",onClick:L,children:n("max")})]}),z&&e.jsx("div",{className:"text-destructive mt-2 text-xs",children:z})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-muted rounded-full p-2",children:e.jsx(Fs,{className:"text-muted-foreground size-4"})})}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("targetChain")}),e.jsxs("button",{type:"button",onClick:()=>v(!0),disabled:E.length===0,className:"bg-background flex w-full items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-muted flex size-6 items-center justify-center rounded-full text-xs font-bold",children:l?l.charAt(0):"?"}),e.jsx("span",{className:"font-medium",children:l?A(l):n("selectChain")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ct,{symbol:d||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:d||"-"}),e.jsx(De,{className:"text-muted-foreground size-4"})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:n("amount")}),e.jsxs("span",{className:"font-semibold",children:[m||"0.00"," ",d]})]})]}),e.jsx(V,{type:"button",size:"lg",className:"w-full",disabled:!R,onClick:q,children:y?e.jsxs(e.Fragment,{children:[e.jsx(Pe,{size:"sm"}),e.jsx("span",{className:"ml-2",children:n("confirm")})]}):n("confirm")}),e.jsx(St,{open:h,onOpenChange:g,children:e.jsxs(At,{side:"bottom",className:"h-[50vh]",children:[e.jsx(It,{children:e.jsx(Tt,{children:n("selectChain")})}),e.jsx("div",{className:"mt-4 space-y-2",children:lj.map(M=>e.jsxs("button",{onClick:()=>C(M),className:D("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",r===M?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("div",{className:"bg-primary/20 text-primary flex size-8 items-center justify-center rounded-full text-sm font-bold",children:M.charAt(0)}),e.jsx("span",{className:"font-medium",children:A(M)}),r===M&&e.jsx("span",{className:"text-primary ml-auto",children:""})]},M))})]})}),e.jsx(St,{open:b,onOpenChange:p,children:e.jsxs(At,{side:"bottom",className:"h-[60vh]",children:[e.jsx(It,{children:e.jsx(Tt,{children:n("selectToken")})}),e.jsx("div",{className:"mt-4 space-y-2",children:_.length===0?e.jsx("p",{className:"text-muted-foreground py-8 text-center",children:n("noResults")}):_.map(M=>e.jsxs("button",{onClick:()=>T(M),className:D("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",d===M.asset?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx(ct,{symbol:M.asset,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:M.asset}),e.jsxs("div",{className:"text-muted-foreground text-xs",children:[" ",M.targetChains.join(", ")]})]}),e.jsx("div",{className:"text-muted-foreground text-right text-sm",children:Eo[r]?.[M.asset]??"0.00"}),d===M.asset&&e.jsx("span",{className:"text-primary",children:""})]},M.asset))})]})}),e.jsx(St,{open:x,onOpenChange:v,children:e.jsxs(At,{side:"bottom",className:"h-[50vh]",children:[e.jsx(It,{children:e.jsx(Tt,{children:n("selectChain")})}),e.jsx("div",{className:"mt-4 space-y-2",children:E.map(M=>e.jsxs("button",{onClick:()=>w(M),className:D("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",l===M?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("div",{className:"bg-muted flex size-8 items-center justify-center rounded-full text-sm font-bold",children:M.charAt(0)}),e.jsx("span",{className:"font-medium",children:A(M)}),l===M&&e.jsx("span",{className:"text-primary ml-auto",children:""})]},M))})]})})]})}Du.__docgenInfo={description:"Burn form component",methods:[],displayName:"BurnForm",props:{onSuccess:{required:!1,tsType:{name:"signature",type:"function",raw:"(txId: string) => void",signature:{arguments:[{type:{name:"string"},name:"txId"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const mj={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron"};function fj({status:t}){switch(t){case"pending":return e.jsx(sp,{className:"size-4 text-yellow-500"});case"confirming":return e.jsx(be,{className:"size-4 animate-spin text-blue-500"});case"confirmed":return e.jsx(ws,{className:"size-4 text-green-500"});case"failed":return e.jsx(tp,{className:"text-destructive size-4"})}}function pj(t){const n=Date.now()-t;return n<6e4?"Just now":n<36e5?`${Math.floor(n/6e4)}m ago`:n<864e5?`${Math.floor(n/36e5)}h ago`:new Date(t).toLocaleDateString()}function hj(t){const s=t.toNumber();return s>=1e6?`${(s/1e6).toFixed(2)}M`:s>=1e3?`${(s/1e3).toFixed(2)}K`:s.toFixed(4)}function _o(t,s){const n=mj[t];if(n)return n;const a=t.toLowerCase();return s[a]??s[t]??t}function xj({record:t,onClick:s}){const{t:n}=B("staking"),a=ss(),r=_o(t.sourceChain,a),o=_o(t.targetChain,a),d=t.type==="mint",i=d?dp:hc;return e.jsxs("button",{type:"button",onClick:s,className:"bg-card hover:bg-muted/50 flex w-full items-center gap-3 rounded-lg p-3 text-left transition-colors",children:[e.jsx("div",{className:D("flex size-10 items-center justify-center rounded-full",d?"bg-green-500/10":"bg-orange-500/10"),children:e.jsx(i,{className:D("size-5",d?"text-green-500":"text-orange-500")})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:n(d?"mint":"burn")}),e.jsx(fj,{status:t.status})]}),e.jsxs("div",{className:"text-muted-foreground flex items-center gap-1 text-xs",children:[e.jsx("span",{children:r}),e.jsx("span",{children:""}),e.jsx("span",{children:o})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(ct,{symbol:t.sourceAsset,size:"sm"}),e.jsx("span",{className:"font-medium",children:hj(t.sourceAmount)})]}),e.jsx("div",{className:"text-muted-foreground text-xs",children:pj(t.createdAt)})]})]})}function zu({filterType:t="all",onRecordClick:s,className:n}){const{t:a}=B("staking"),[r,o]=c.useState([]),[d,i]=c.useState(!0),[l,u]=c.useState(t==="all"?"all":t);c.useEffect(()=>{let g=!0;return i(!0),Gt.getTransactions().then(b=>{g&&(o(b),i(!1))}),()=>{g=!1}},[]);const m=c.useMemo(()=>l==="all"?r:r.filter(g=>g.type===l),[r,l]),f=[{id:"all",label:a("history")},{id:"mint",label:a("mint")},{id:"burn",label:a("burn")}],h=c.useCallback(()=>{i(!0),Gt.getTransactions().then(g=>{o(g),i(!1)})},[]);return d?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Pe,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:a("loading")})]}):e.jsxs("div",{className:D("space-y-4",n),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[f.map(g=>e.jsx(V,{type:"button",variant:l===g.id?"default":"outline",size:"sm",onClick:()=>u(g.id),children:g.label},g.id)),e.jsx(V,{type:"button",variant:"ghost",size:"sm",className:"ml-auto",onClick:h,children:a("refresh")})]}),m.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:a("noTransactions")})}):e.jsx("div",{className:"space-y-2",children:m.map(g=>e.jsx(xj,{record:g,onClick:()=>s?.(g)},g.id))})]})}zu.__docgenInfo={description:"Staking record list component",methods:[],displayName:"StakingRecordList",props:{filterType:{required:!1,tsType:{name:"union",raw:"StakingTxType | 'all'",elements:[{name:"StakingTxType"},{name:"literal",value:"'all'"}]},description:"Filter by transaction type",defaultValue:{value:"'all'",computed:!1}},onRecordClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(record: StakingTransaction) => void",signature:{arguments:[{type:{name:"StakingTransaction"},name:"record"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};function Ou(){const{t}=B("staking"),{goBack:s}=de(),[n,a]=c.useState("overview"),r=[{id:"overview",label:t("overview")},{id:"mint",label:t("mint")},{id:"burn",label:t("burn")},{id:"history",label:t("history")}],o=d=>{a("mint")};return e.jsxs("div",{className:"flex min-h-screen flex-col bg-background",children:[e.jsx(J,{title:t("title"),onBack:s}),e.jsx("div",{className:"flex border-b border-border px-4",children:r.map(d=>e.jsx("button",{onClick:()=>a(d.id),className:D("flex-1 py-3 text-sm font-medium transition-colors",n===d.id?"border-b-2 border-primary text-primary":"text-muted-foreground hover:text-foreground"),children:d.label},d.id))}),e.jsxs("div",{className:"flex-1 p-4",children:[n==="overview"&&e.jsx(Ru,{onMint:o}),n==="mint"&&e.jsx(gj,{}),n==="burn"&&e.jsx(vj,{}),n==="history"&&e.jsx(zu,{})]})]})}function gj(){const{t}=B("staking"),s=n=>{};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:t("mintDescription")}),e.jsx(Lu,{onSuccess:s})]})}function vj(){const{t}=B("staking"),s=n=>{};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:t("burnDescription")}),e.jsx(Du,{onSuccess:s})]})}Ou.__docgenInfo={description:"Staking page with tab navigation",methods:[],displayName:"StakingPage"};const Bu=()=>e.jsx(le,{children:e.jsx(Ou,{})});Bu.__docgenInfo={description:"",methods:[],displayName:"StakingActivity"};const yj=ks({assetType:ce(),decimals:Xn(),amount:ce().optional(),useDefaultDecimals:Pt().optional(),logoUrl:ce().optional(),contractAddress:ce().optional()}),bj=ks({address:ce(),symbol:ce(),addressKey:ce(),mainWalletId:ce(),chain:ce(),mnemonic:ce().optional(),privateKey:ce(),publicKey:ce().optional(),isCustomAssets:Pt().optional(),isFreezed:Pt().optional(),assets:xr(yj),name:ce(),prohibitChangeName:Pt().optional(),index:Xn().optional(),purpose:mc([Ct(44),Ct(49),Ct(84),Ct(86)]).optional()}),jj=ks({chainName:ce(),addressKey:ce(),address:ce(),symbol:ce(),mainWalletId:ce(),index:Xn().optional(),purpose:mc([Ct(44),Ct(49),Ct(84),Ct(86)]).optional()});ks({name:ce(),skipBackup:Pt().optional(),importPhrase:ce(),importType:ce(),addressKeyList:xr(jj),mainWalletId:ce(),headSculpture:ce(),createTimestamp:Xn(),lastBitcoinAddressKey:ce().optional()});ks({addressBookId:ce(),name:ce(),address:ce(),chainList:xr(ce()).optional(),remarks:ce().optional(),iconName:ce().optional(),symbol:ce().optional()});ks({password:ce(),passwordTips:ce().optional(),lastWalletActivate:bj.optional(),walletLock:Pt().optional(),fingerprintLock:Pt().optional(),fingerprintPay:Pt().optional()});const Nj=c.createContext(null);function wj(){return c.useContext(Nj)}const kj="keyapp_welcome_shown";function jn(){localStorage.setItem(kj,"1")}function Fu(){const{t}=B("guide"),{navigate:s}=de(),[n,a]=c.useState(0),r=wj(),o=c.useMemo(()=>[{icon:e.jsx(bc,{className:"text-primary size-16"}),title:t("welcome.slides.transfer.title"),description:t("welcome.slides.transfer.description")},{icon:e.jsx(yc,{className:"text-primary size-16"}),title:t("welcome.slides.multichain.title"),description:t("welcome.slides.multichain.description")},{icon:e.jsx(np,{className:"text-primary size-16"}),title:t("welcome.slides.security.title"),description:t("welcome.slides.security.description")}],[t]),d=o[n];if(!d)return null;const i=c.useCallback(()=>{jn(),s({to:"/wallet/create"})},[s]),l=c.useCallback(()=>{jn(),s({to:"/onboarding/recover"})},[s]),u=c.useCallback(()=>{jn(),s({to:"/onboarding/migrate"})},[s]),m=c.useCallback(()=>{jn(),s({to:"/"})},[s]),f=c.useCallback(()=>{n<o.length-1&&a(b=>b+1)},[n,o.length]),h=n===o.length-1,g=r?.shouldPromptMigration;return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx("div",{className:"flex justify-end p-4",children:e.jsx(V,{variant:"ghost",size:"sm","data-testid":"skip-button",onClick:m,children:t("welcome.skip")})}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center px-8",children:[e.jsx("div",{className:"bg-primary/10 mb-8 flex size-32 items-center justify-center rounded-full",children:d.icon}),e.jsx("h1",{className:"mb-4 text-center text-2xl font-bold",children:d.title}),e.jsx("p",{className:"text-muted-foreground mb-8 max-w-sm text-center",children:d.description}),e.jsx("div",{className:"mb-8 flex gap-2",children:o.map((b,p)=>e.jsx("button",{"data-testid":`slide-dot-${p}`,onClick:()=>a(p),className:D("size-2 rounded-full transition-colors",p===n?"bg-primary":"bg-muted-foreground/30"),"aria-label":t("welcome.goToSlide",{number:p+1})},p))})]}),e.jsx("div",{className:"p-6",children:h?e.jsxs("div",{className:"flex flex-col gap-3",children:[g&&e.jsxs(V,{"data-testid":"migrate-button",onClick:u,className:"w-full",size:"lg",variant:"default",children:[e.jsx(nn,{className:"mr-2 size-4"}),t("welcome.migrateFromMpay")]}),e.jsx(V,{"data-testid":"get-started-button",onClick:i,className:"w-full",size:"lg",variant:g?"outline":"default",children:t("welcome.getStarted")}),e.jsx(V,{"data-testid":"have-wallet-button",onClick:l,variant:"outline",className:"w-full",size:"lg",children:t("welcome.haveWallet")})]}):e.jsxs(V,{"data-testid":"next-button",onClick:f,className:"w-full",size:"lg",children:[t("welcome.next"),e.jsx(De,{className:"ml-2 size-4"})]})})]})}Fu.__docgenInfo={description:"",methods:[],displayName:"WelcomeScreen"};const Wu=()=>e.jsx(le,{children:e.jsx(Fu,{})});Wu.__docgenInfo={description:"",methods:[],displayName:"WelcomeActivity"};function $u(){const{t}=B(["wallet","onboarding","security","common"]),{goBack:s}=de(),n=Fe(),a=Ys(),r=Je(),[o,d]=c.useState("select"),[i,l]=c.useState([]),[u,m]=c.useState([]),[f,h]=c.useState(!1),g=c.useRef(!1);c.useEffect(()=>{!g.current&&n&&(l(n.chainAddresses.map(v=>v.chain)),g.current=!0)},[n]);const b=c.useCallback(()=>{if(!n)return!1;const v=new Set(n.chainAddresses.map(j=>j.chain));return v.size!==i.length?!0:i.some(j=>!v.has(j))},[n,i]),p=c.useCallback(()=>{if(!b()){s();return}d("verify")},[b,s]),x=c.useCallback(async v=>{if(!(!n||v.length<4)){h(!1),d("saving");try{const j=Be(v);await ye.updateWalletChainAddresses(n.id,i,j,a),!i.includes(r)&&i.length>0&&ye.setSelectedChain(i[0]),d("success"),setTimeout(()=>{s()},1500)}catch(j){j instanceof Error&&j.message.includes("decrypt")?(h(!0),m([]),d("verify"),setTimeout(()=>{h(!1)},1500)):d("select")}}},[n,i,a,s]);return n?o==="saving"?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(J,{title:t("wallet:chains.title")}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx(Pe,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground",children:t("wallet:chains.saving")})]})]}):o==="success"?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(J,{title:t("wallet:chains.title")}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-green-500/10",children:e.jsx(Ne,{className:"size-8 text-green-500"})}),e.jsx("p",{className:"font-medium",children:t("wallet:chains.success")})]})]}):o==="verify"?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(J,{title:t("wallet:chains.verifyTitle"),onBack:()=>{d("select"),m([])}}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:t("wallet:chains.verifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("wallet:chains.verifyDesc")})]}),e.jsx(ft,{value:u,onChange:m,onComplete:x,minPoints:4,error:f,"data-testid":"wallet-chains-pattern"})]})]}):e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(J,{title:t("wallet:chains.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(en,{icon:e.jsx(ws,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:t("onboarding:chainSelector.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("onboarding:chainSelector.subtitle")})]}),a.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(Pe,{})}):e.jsx(hr,{"data-testid":"wallet-chains-selector",chains:a,selectedChains:i,onSelectionChange:l}),e.jsx(Ue,{variant:"mint",className:"w-full","data-testid":"wallet-chains-save",disabled:i.length===0,onClick:p,children:b()?t("common:save"):t("common:done")})]})]}):e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(J,{title:t("wallet:chains.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx(Qt,{variant:"warning",children:t("wallet:chains.noWallet")})})]})}$u.__docgenInfo={description:"",methods:[],displayName:"WalletChainsPage"};const qu=()=>e.jsx(le,{children:e.jsx($u,{})});qu.__docgenInfo={description:"",methods:[],displayName:"SettingsWalletChainsActivity"};function Aa(t){if(t===0)return"0 B";const s=1024,n=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(s));return`${parseFloat((t/Math.pow(s,a)).toFixed(2))} ${n[a]}`}function Hu(){const{t}=B(["settings","common"]),{goBack:s}=de(),{push:n}=Z(),[a,r]=c.useState(null),[o,d]=c.useState(!0),i=c.useCallback(async()=>{d(!0);try{if(navigator.storage&&navigator.storage.estimate){const u=await navigator.storage.estimate();r({usage:u.usage??0,quota:u.quota??0})}}catch{}finally{d(!1)}},[]);c.useEffect(()=>{i()},[i]);const l=a?a.usage/a.quota*100:0;return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(J,{title:t("settings:storage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"bg-primary/10 flex size-10 items-center justify-center rounded-full",children:e.jsx(gc,{className:"text-primary size-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:t("settings:storage.usage")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:t("settings:storage.basedOn")})]})]}),o?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(be,{className:"text-muted-foreground size-6 animate-spin"})}):a?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"bg-muted h-3 w-full overflow-hidden rounded-full",children:e.jsx("div",{className:"bg-primary h-full rounded-full transition-all",style:{width:`${Math.min(l,100)}%`}})}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[t("settings:storage.used"),": ",Aa(a.usage)]}),e.jsxs("span",{className:"text-muted-foreground",children:[t("settings:storage.total"),": ",Aa(a.quota)]})]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:t("settings:storage.usagePercent")}),e.jsxs("span",{className:"font-medium",children:[l.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:t("settings:storage.available")}),e.jsx("span",{className:"font-medium",children:Aa(a.quota-a.usage)})]})]})]}):e.jsx("p",{className:"text-muted-foreground text-center py-4",children:t("settings:storage.unavailable")})]}),e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"font-medium mb-2",children:t("settings:storage.clearTitle")}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:t("settings:storage.clearDesc")}),e.jsxs(V,{variant:"destructive",className:"w-full",onClick:()=>n("ClearDataConfirmJob",{}),children:[e.jsx(ns,{className:"size-4 mr-2"}),t("settings:items.clearData")]})]})]})]})}Hu.__docgenInfo={description:"",methods:[],displayName:"SettingsStoragePage"};const Uu=()=>e.jsx(le,{children:e.jsx(Hu,{})});Uu.__docgenInfo={description:"",methods:[],displayName:"SettingsStorageActivity"};const Vu=()=>{const{t}=B("common"),{pop:s}=Z(),n=Ie(ir),[a,r]=c.useState(!1),[o,d]=c.useState(null),[i,l]=c.useState(""),[u,m]=c.useState(""),[f,h]=c.useState(null),[g,b]=c.useState(!1),[p,x]=c.useState(!1),[v,j]=c.useState(null),N=c.useCallback(async w=>{b(!0),h(null);try{const P=new URL(w).toString(),L=await fetch(P);if(L.ok){const z=await L.json();z.name&&typeof z.name=="string"&&h(z.name)}}catch{}finally{b(!1)}},[]);c.useEffect(()=>{if(!i.trim()){h(null);return}try{new URL(i)}catch{return}const w=setTimeout(()=>{N(i)},500);return()=>clearTimeout(w)},[i,N]);const y=()=>{r(!0),d(null),l(""),m(""),h(null),j(null)},S=w=>{r(!0),d(w.url),l(w.url),m(w.name),h(null),j(null)},k=()=>{r(!1),d(null),l(""),m(""),h(null),j(null)},I=async()=>{if(!i.trim()){j(t("sources.enterUrl"));return}let w;try{w=new URL(i).toString()}catch{j(t("sources.invalidUrl"));return}const P=u.trim()||f||t("sources.customSource");if(o)if(o!==w){if(n.sources.some(L=>L.url===w)){j(t("sources.alreadyExists"));return}Re.removeSource(o),Re.addSource(w,P)}else Re.updateSourceName(o,P);else{if(n.sources.some(L=>L.url===w)){j(t("sources.alreadyExists"));return}Re.addSource(w,P)}k(),nf(w)},_=w=>{Re.removeSource(w)},A=w=>{Re.toggleSource(w)},E=async()=>{x(!0);try{await Go()}catch{}x(!1)},C=o===null,T=f?t("sources.nameWithDefault",{name:f}):t("sources.namePlaceholder");return e.jsx(le,{children:e.jsxs("div",{className:"bg-background flex h-full flex-col",children:[e.jsx("div",{className:"bg-background sticky top-0 z-10 border-b",children:e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[e.jsx("button",{onClick:()=>s(),className:"hover:bg-muted rounded-full p-1.5 transition-colors","aria-label":t("back"),children:e.jsx(cc,{className:"size-5",stroke:1.5})}),e.jsx("h1",{className:"flex-1 text-lg font-semibold",children:t("sources.title")}),e.jsx("button",{onClick:E,disabled:p,className:"hover:bg-muted rounded-full p-1.5 transition-colors","aria-label":t("refresh"),children:e.jsx(rs,{className:D("size-5",p&&"animate-spin"),stroke:1.5})})]})}),e.jsxs("div",{className:"flex-1 space-y-3 overflow-y-auto p-4",children:[n.sources.map(w=>e.jsx(Cj,{source:w,onToggle:()=>A(w.url),onRemove:()=>_(w.url),onEdit:()=>S(w),isSelected:o===w.url},w.url)),n.sources.length===0&&e.jsx("div",{className:"text-muted-foreground py-12 text-center",children:t("sources.noSources")})]}),a?e.jsxs("div",{className:"bg-background space-y-3 border-t p-4",children:[e.jsx("textarea",{value:i,onChange:w=>{l(w.target.value),j(null)},placeholder:t("sources.urlPlaceholder"),rows:1,spellCheck:!1,className:"bg-background focus:ring-primary [field-sizing:content] w-full resize-none rounded-lg border px-3 py-2 focus:ring-2 focus:outline-none"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:u,onChange:w=>m(w.target.value),placeholder:T,className:"bg-background focus:ring-primary w-full rounded-lg border px-3 py-2 pr-8 focus:ring-2 focus:outline-none"}),g&&e.jsx(be,{className:"text-muted-foreground absolute top-1/2 right-3 size-4 -translate-y-1/2 animate-spin"})]}),v&&e.jsx("p",{className:"text-destructive text-sm",children:v}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:k,className:"bg-muted hover:bg-muted/80 flex-1 rounded-lg py-2 font-medium",children:t("cancel")}),e.jsx("button",{onClick:I,className:"bg-primary text-primary-foreground hover:bg-primary/90 flex-1 rounded-lg py-2 font-medium",children:t(C?"add":"save")})]})]}):e.jsx("div",{className:"border-t p-4",children:e.jsxs("button",{onClick:y,className:"border-muted-foreground/30 hover:border-primary hover:bg-primary/5 text-muted-foreground hover:text-primary flex w-full items-center justify-center gap-2 rounded-xl border-2 border-dashed py-3 transition-colors",children:[e.jsx(mt,{className:"size-5",stroke:1.5}),e.jsx("span",{children:t("sources.addSource")})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};function Cj({source:t,onToggle:s,onRemove:n,onEdit:a,isSelected:r}){const{t:o}=B("common"),d=t.url.includes("ecosystem.json"),i=t.status==="error"||t.status!=="loading"&&!!t.errorMessage;let l=null;return i?l=e.jsx(Mt,{className:"size-3 text-red-500"}):t.status==="loading"?l=e.jsx(be,{className:"text-muted-foreground size-3 animate-spin"}):t.status==="success"&&(l=e.jsx(Ne,{className:"size-3 text-green-500"})),e.jsx("div",{className:D("cursor-pointer rounded-xl border p-4 transition-colors",t.enabled?"bg-card":"bg-muted/30 opacity-60",r&&"ring-primary ring-2"),onClick:a,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/10 shrink-0 rounded-full p-2",children:e.jsx(jc,{className:"text-primary size-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"truncate font-medium",children:t.name}),d&&e.jsx("span",{className:"bg-primary/10 text-primary rounded px-1.5 py-0.5 text-xs",children:o("sources.official")}),l]}),e.jsx("p",{className:"text-muted-foreground mt-0.5 truncate text-sm",children:t.url}),e.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:o("sources.updatedAt",{date:new Date(t.lastUpdated).toLocaleString()})}),i&&e.jsx("p",{className:"truncate text-xs text-red-500",children:t.errorMessage??o("service.queryFailed")})]})]}),e.jsxs("div",{className:"flex shrink-0 items-center gap-1",onClick:u=>u.stopPropagation(),children:[e.jsx("button",{onClick:s,className:D("rounded-full p-2 transition-colors",t.enabled?"bg-green-100 text-green-600 hover:bg-green-200":"bg-muted text-muted-foreground hover:bg-muted/80"),"aria-label":t.enabled?o("disable"):o("enable"),children:t.enabled?e.jsx(Ne,{className:"size-4",stroke:2}):e.jsx(an,{className:"size-4",stroke:2})}),!d&&e.jsx("button",{onClick:n,className:"text-muted-foreground hover:text-destructive hover:bg-destructive/10 rounded-full p-2 transition-colors","aria-label":o("delete"),children:e.jsx(ns,{className:"size-4",stroke:1.5})})]})]})})}Vu.__docgenInfo={description:"",methods:[],displayName:"SettingsSourcesActivity"};function Zt({className:t,size:s="default",...n}){return e.jsx("div",{"data-slot":"card","data-size":s,className:D("ring-foreground/10 bg-card text-card-foreground gap-4 overflow-hidden rounded-xl py-4 text-sm ring-1 has-data-[slot=card-footer]:pb-0 has-[>img:first-child]:pt-0 data-[size=sm]:gap-3 data-[size=sm]:py-3 data-[size=sm]:has-data-[slot=card-footer]:pb-0 *:[img:first-child]:rounded-t-xl *:[img:last-child]:rounded-b-xl group/card flex flex-col",t),...n})}function Qa({className:t,...s}){return e.jsx("div",{"data-slot":"card-header",className:D("gap-1 rounded-t-xl px-4 group-data-[size=sm]/card:px-3 [.border-b]:pb-4 group-data-[size=sm]/card:[.border-b]:pb-3 group/card-header @container/card-header grid auto-rows-min items-start has-data-[slot=card-action]:grid-cols-[1fr_auto] has-data-[slot=card-description]:grid-rows-[auto_auto]",t),...s})}function Xa({className:t,...s}){return e.jsx("div",{"data-slot":"card-title",className:D("text-base leading-snug font-medium group-data-[size=sm]/card:text-sm",t),...s})}function Ya({className:t,...s}){return e.jsx("div",{"data-slot":"card-description",className:D("text-muted-foreground text-sm",t),...s})}function es({className:t,...s}){return e.jsx("div",{"data-slot":"card-content",className:D("px-4 group-data-[size=sm]/card:px-3",t),...s})}Zt.__docgenInfo={description:"",methods:[],displayName:"Card",props:{size:{required:!1,tsType:{name:"union",raw:'"default" | "sm"',elements:[{name:"literal",value:'"default"'},{name:"literal",value:'"sm"'}]},description:"",defaultValue:{value:'"default"',computed:!1}}}};Qa.__docgenInfo={description:"",methods:[],displayName:"CardHeader"};Xa.__docgenInfo={description:"",methods:[],displayName:"CardTitle"};Ya.__docgenInfo={description:"",methods:[],displayName:"CardDescription"};es.__docgenInfo={description:"",methods:[],displayName:"CardContent"};const Sj=dm("h-5 gap-1 rounded-4xl border border-transparent px-2 py-0.5 text-xs font-medium transition-all has-data-[icon=inline-end]:pr-1.5 has-data-[icon=inline-start]:pl-1.5 [&>svg]:size-3! inline-flex items-center justify-center w-fit whitespace-nowrap shrink-0 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-colors overflow-hidden group/badge",{variants:{variant:{default:"bg-primary text-primary-foreground [a]:hover:bg-primary/80",secondary:"bg-secondary text-secondary-foreground [a]:hover:bg-secondary/80",destructive:"bg-destructive/10 [a]:hover:bg-destructive/20 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 text-destructive dark:bg-destructive/20",outline:"border-border text-foreground [a]:hover:bg-muted [a]:hover:text-muted-foreground",ghost:"hover:bg-muted hover:text-muted-foreground dark:hover:bg-muted/50",link:"text-primary underline-offset-4 hover:underline"}},defaultVariants:{variant:"default"}});function Ia({className:t,variant:s="default",render:n,...a}){return uf({defaultTagName:"span",props:Wf({className:D(Sj({className:t,variant:s}))},a),...n!==void 0?{render:n}:{},state:{slot:"badge",variant:s}})}function Aj({permission:t}){const n=rf[t]?.risk??"medium",a=of(t),r=n==="high"?Oe:ur,o=n==="high"?"text-red-500":n==="medium"?"text-amber-500":"text-green-500";return e.jsxs("div",{className:"flex items-start gap-3 py-3",children:[e.jsx(r,{className:D("mt-0.5 size-5 shrink-0",o),stroke:1.5}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:a.label}),e.jsx("p",{className:"text-muted-foreground mt-0.5 text-xs",children:a.description})]})]})}function Ij({directive:t}){const{t:s}=B("ecosystem"),n=s(`permissionsPolicy.${t}.name`,{defaultValue:t}),a=s(`permissionsPolicy.${t}.description`,{defaultValue:s("permissionsPolicy.defaultDescription")});return e.jsxs("div",{className:"flex items-start gap-3 py-3",children:[e.jsx(ur,{className:"text-sky-500 mt-0.5 size-5 shrink-0",stroke:1.5}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:n}),e.jsx("p",{className:"text-muted-foreground mt-0.5 text-xs",children:a})]})]})}function us({label:t,value:s,isLink:n=!1,href:a}){const r=e.jsxs("div",{className:"border-border/50 flex items-center justify-between border-b py-3 last:border-0",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t}),e.jsxs("span",{className:D("text-sm font-medium",n&&"text-primary flex items-center gap-1"),children:[s,n&&e.jsx(De,{className:"size-4"})]})]});return n&&a?e.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",children:r}):r}const Ju=({params:t})=>{const{pop:s}=Z(),{t:n}=B("ecosystem"),[a,r]=c.useState(null),[o,d]=c.useState(!0),[i,l]=c.useState(!1),u=Ie(ir,v=>af.isAppInstalled(v,t.appId));c.useEffect(()=>{let v=!1;return(async()=>{d(!0),await Vo();let N=li(t.appId);N||(await Go({force:!1}),N=li(t.appId)),!v&&(r(N??null),d(!1))})(),()=>{v=!0}},[t.appId]);const m=c.useCallback(()=>{a&&Re.installApp(a.id)},[a]),f=c.useCallback(()=>{a&&(Re.updateAppLastUsed(a.id),Re.setActiveSubPage("mine"),Jo(a.id,{...a,targetDesktop:"mine"}),s())},[a,s]);if(o)return e.jsx(le,{children:e.jsx("div",{className:"bg-background flex min-h-screen items-center justify-center",children:e.jsx(Pe,{size:"lg"})})});if(!a)return e.jsx(le,{children:e.jsxs("div",{className:"bg-background flex min-h-screen flex-col items-center justify-center gap-4",children:[e.jsx("p",{className:"text-muted-foreground",children:n("detail.notFound")}),e.jsx("button",{onClick:()=>s(),className:"bg-primary text-primary-foreground rounded-full px-4 py-2 text-sm font-medium",children:n("detail.back")})]})});const h=a.longDescription??a.description,g=h.length>150,b=i||!g?h:h.slice(0,150)+"...",p=a.permissions??[],x=a.permissionsPolicy??[];return e.jsx(le,{children:e.jsxs("div",{className:"bg-background detail-scroll-container flex min-h-screen flex-col",children:[e.jsx("div",{className:"bg-background/80 border-border/50 sticky top-0 z-20 border-b backdrop-blur-xl",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[e.jsx("button",{onClick:()=>s(),className:"hover:bg-muted -ml-1.5 rounded-full p-1.5 transition-colors",children:e.jsx(cc,{className:"size-5",stroke:1.5})}),e.jsx("span",{className:"detail-header-title max-w-[200px] truncate font-semibold",children:a.name}),e.jsx("button",{className:"hover:bg-muted -mr-1.5 rounded-full p-1.5 transition-colors",children:e.jsx(Us,{className:"size-5",stroke:1.5})})]})}),e.jsxs("div",{className:"detail-scroller flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"px-5 pt-4 pb-5",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(lf,{src:a.icon,name:a.name,size:"2xl",shadow:"lg",className:"shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1 pt-1",children:[e.jsx("h1",{className:"truncate text-xl font-bold",children:a.name}),e.jsx("p",{className:"text-muted-foreground mt-0.5 truncate text-sm",children:a.author??n("detail.unknownDeveloper")}),u?e.jsx("button",{onClick:f,className:"bg-primary text-primary-foreground mt-4 rounded-full px-8 py-2 text-sm font-semibold",children:n("detail.open")}):e.jsx("button",{onClick:m,className:"bg-primary text-primary-foreground mt-4 rounded-full px-8 py-2 text-sm font-semibold",children:n("detail.get")})]})]}),e.jsxs("div",{className:"text-muted-foreground mt-5 flex items-center gap-4 text-xs",children:[a.category&&e.jsx("span",{className:"text-foreground font-medium",children:n(`detail.categories.${a.category}`,{defaultValue:a.category})}),a.beta&&e.jsx("span",{className:"rounded-full bg-amber-100 px-2 py-0.5 font-medium text-amber-700 dark:bg-amber-900/30 dark:text-amber-400",children:n("detail.beta")}),e.jsxs("span",{children:["v",a.version]})]})]}),a.screenshots&&a.screenshots.length>0&&e.jsx("div",{className:"border-border/50 border-t",children:e.jsxs("div",{className:"px-5 py-4",children:[e.jsx("h2",{className:"mb-4 text-lg font-bold",children:n("detail.preview")}),e.jsx("div",{className:"-mx-5 flex snap-x snap-mandatory gap-3 overflow-x-auto px-5 pb-2",style:{scrollbarWidth:"none"},children:a.screenshots.map((v,j)=>e.jsx("div",{className:"bg-muted aspect-[9/19.5] w-[220px] shrink-0 snap-center overflow-hidden rounded-2xl shadow-lg ring-1 ring-black/5",children:e.jsx("img",{src:v,alt:`${a.name} screenshot ${j+1}`,className:"h-full w-full object-cover",loading:"lazy",onError:N=>{const y=N.currentTarget.parentElement;y&&(y.style.display="none")}})},v))})]})}),e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:b}),g&&e.jsxs("button",{onClick:()=>l(!i),className:"text-primary mt-2 flex items-center gap-1 text-sm font-medium",children:[n(i?"detail.collapse":"detail.more"),i?e.jsx(Yo,{className:"size-4"}):e.jsx(ec,{className:"size-4"})]})]}),a.chains&&a.chains.length>0&&e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("h2",{className:"mb-3 text-lg font-bold",children:n("detail.supportedChains")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.chains.map(v=>e.jsx("span",{className:"bg-muted rounded-full px-3 py-1.5 text-sm font-medium",children:v},v))})]}),(p.length>0||x.length>0)&&e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-bold",children:n("detail.privacy")}),e.jsx(Ia,{variant:"outline",children:p.length+x.length})]}),e.jsxs("div",{className:"space-y-3",children:[p.length>0&&e.jsxs(Zt,{size:"sm",children:[e.jsxs(Qa,{className:"border-b",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx(Xa,{children:n("detail.permissions")}),e.jsx(Ia,{variant:"secondary",children:p.length})]}),e.jsx(Ya,{children:n("detail.privacyHint")})]}),e.jsx(es,{className:"divide-y divide-border/50",children:p.map(v=>e.jsx(Aj,{permission:v},v))})]}),x.length>0&&e.jsxs(Zt,{size:"sm",children:[e.jsxs(Qa,{className:"border-b",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx(Xa,{children:n("permissionsPolicy.title")}),e.jsx(Ia,{variant:"secondary",children:x.length})]}),e.jsx(Ya,{children:n("permissionsPolicy.hint")})]}),e.jsx(es,{className:"divide-y divide-border/50",children:x.map(v=>e.jsx(Ij,{directive:v},v))})]})]})]}),a.tags&&a.tags.length>0&&e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("h2",{className:"mb-3 text-lg font-bold",children:n("detail.tags")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.tags.map(v=>e.jsx("span",{className:"bg-primary/10 text-primary rounded-full px-3 py-1.5 text-sm font-medium",children:n("detail.tagLabel",{tag:v})},v))})]}),e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("h2",{className:"mb-2 text-lg font-bold",children:n("detail.info")}),e.jsxs("div",{className:"bg-muted/50 rounded-2xl px-4",children:[a.author&&e.jsx(us,{label:n("detail.developer"),value:a.author}),e.jsx(us,{label:n("detail.version"),value:a.version}),a.category&&e.jsx(us,{label:n("detail.category"),value:n(`detail.categories.${a.category}`,{defaultValue:a.category})}),a.publishedAt&&e.jsx(us,{label:n("detail.publishedAt"),value:a.publishedAt}),a.updatedAt&&e.jsx(us,{label:n("detail.updatedAt"),value:a.updatedAt}),a.website&&e.jsx(us,{label:n("detail.website"),value:n("detail.visit"),isLink:!0,href:a.website})]})]}),e.jsx("div",{className:"h-8"})]})]})})};Ju.__docgenInfo={description:"",methods:[],displayName:"MiniappDetailActivity"};function Gs({className:t,...s}){return e.jsx("label",{"data-slot":"label",className:D("gap-2 text-sm leading-none font-medium group-data-[disabled=true]:opacity-50 peer-disabled:opacity-50 flex items-center select-none group-data-[disabled=true]:pointer-events-none peer-disabled:cursor-not-allowed",t),...s})}Gs.__docgenInfo={description:"",methods:[],displayName:"Label"};function Tj({queryAddress:t,queryChain:s}){const{t:n}=B(["common"]),a=Zs(),r=os(),{data:o,isLoading:d,error:i}=r.nativeBalance.useState({address:t},{enabled:!!t});return e.jsx(Zt,{className:D("transition-all",d&&"opacity-50"),children:e.jsx(es,{className:"pt-6",children:i?e.jsxs("div",{className:"flex items-center gap-3 text-destructive",children:[e.jsx(Mt,{className:"size-5 shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:n("common:addressLookup.error")}),e.jsx("div",{className:"text-sm opacity-80",children:i.message})]})]}):o?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-primary/10 flex size-12 items-center justify-center rounded-full",children:e.jsx(Np,{className:"text-primary size-6"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[o.amount.toFormatted()," ",o.symbol]}),e.jsx("div",{className:"text-muted-foreground text-sm",children:n("common:addressLookup.onChain",{chain:a.find(l=>l.id===s)?.name??s})})]})]}):d?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx(Pe,{size:"lg"})}):null})})}function Ku(){const{t}=B(["common","wallet"]),{goBack:s}=de(),n=Zs(),[a,r]=c.useState("ethereum"),[o,d]=c.useState(""),[i,l]=c.useState(""),[u,m]=c.useState(""),[f,h]=c.useState(!1),g=c.useCallback(()=>{o.trim()&&(h(!0),l(o.trim()),m(a),setTimeout(()=>h(!1),100))},[o,a]),b=c.useCallback(v=>{v.key==="Enter"&&g()},[g]),p=n.filter(v=>v.chainKind==="evm"),x=n.filter(v=>v.chainKind!=="evm");return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(J,{title:t("common:addressLookup.balanceTitle"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Gs,{children:t("common:addressLookup.chain")}),e.jsxs(Ws,{value:a,onValueChange:v=>v&&r(v),children:[e.jsx($s,{children:e.jsx(qs,{})}),e.jsxs(Hs,{children:[p.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:"EVM"}),p.map(v=>e.jsx(Yt,{value:v.id,children:v.name},v.id))]}),x.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:t("common:addressLookup.otherChains")}),x.map(v=>e.jsx(Yt,{value:v.id,children:v.name},v.id))]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Gs,{children:t("common:addressLookup.address")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ve,{placeholder:t("common:addressLookup.addressPlaceholder"),value:o,onChange:v=>d(v.target.value),onKeyDown:b,className:"flex-1 font-mono text-sm"}),e.jsx(V,{onClick:g,disabled:!o.trim()||f,children:f?e.jsx(Pe,{size:"sm"}):e.jsx(sn,{className:"size-4"})})]})]}),i&&u&&e.jsx(zt,{chainId:u,fallback:e.jsx(Zt,{children:e.jsx(es,{className:"pt-6",children:e.jsx("p",{className:"text-muted-foreground text-center",children:"Chain not supported"})})}),children:e.jsx(Tj,{queryAddress:i,queryChain:u})}),!1]})]})}Ku.__docgenInfo={description:"",methods:[],displayName:"AddressBalancePage"};const Gu=()=>e.jsx(le,{children:e.jsx(Ku,{})});Gu.__docgenInfo={description:"",methods:[],displayName:"AddressBalanceActivity"};function Pj(t,s){return(parseFloat(t)/Math.pow(10,s)).toLocaleString(void 0,{maximumFractionDigits:6})}function Ej(t){return new Date(t).toLocaleString()}function _j({tx:t,address:s}){const{t:n}=B("common"),a=t.direction==="out"||t.from.toLowerCase()===s.toLowerCase(),r=t.assets.find(m=>m.assetType==="native"||m.assetType==="token"),o=r?r.value:"0",d=r?r.symbol:"",i=r?r.decimals:0,l=n(a?"signSymbol.minus":"signSymbol.plus"),u=n(a?"addressLookup.toLabel":"addressLookup.fromLabel");return e.jsxs("div",{className:"flex items-center gap-3 py-3 border-b last:border-b-0",children:[e.jsx("div",{className:`p-2 rounded-full ${a?"bg-red-100 text-red-600":"bg-green-100 text-green-600"}`,children:a?e.jsx(hc,{className:"size-4"}):e.jsx(cp,{className:"size-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"text-sm font-medium truncate",children:[u," ",a?t.to:t.from]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:Ej(t.timestamp)})]}),e.jsxs("div",{className:`text-sm font-medium ${a?"text-red-600":"text-green-600"}`,children:[l,Pj(o,i)," ",d]})]})}function Mj({searchAddress:t,selectedChain:s,explorerUrl:n,onOpenExplorer:a}){const{t:r}=B(["common"]),o=Zs(),d=c.useMemo(()=>o.find(h=>h.id===s),[o,s]),i=os(),{data:l,isLoading:u,error:m}=i.transactionHistory.useState({address:t,limit:50},{enabled:!!t}),f=!(m instanceof $o);return e.jsx(Zt,{children:e.jsxs(es,{className:"pt-6",children:[u?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(be,{className:"size-6 animate-spin text-muted-foreground"})}):m?e.jsx("div",{className:"text-center py-8 text-destructive",children:r("common:addressLookup.queryError")}):l&&l.length>0?e.jsx("div",{className:"divide-y",children:l.map(h=>e.jsx(_j,{tx:h,address:t},h.hash))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:f?e.jsx("p",{children:r("common:addressLookup.noTransactions")}):e.jsx("p",{children:r("common:addressLookup.useExplorerHint")})}),n&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs(V,{variant:f?"outline":"default",size:"sm",className:"w-full gap-2",onClick:a,children:[e.jsx(Ea,{className:"size-4"}),r("common:addressLookup.viewOnExplorer",{name:d?.name??s})]})})]})})}function Qu(){const{t}=B(["common","wallet"]),{goBack:s}=de(),n=Zs(),[a,r]=c.useState("bfmeta"),[o,d]=c.useState(""),[i,l]=c.useState(""),[u,m]=c.useState(""),f=c.useMemo(()=>n.find(j=>j.id===u),[n,u]),h=c.useMemo(()=>{if(!f?.explorer||!i.trim())return null;const{queryAddress:j,url:N}=f.explorer;return j?j.replace(":address",i.trim()):`${N}/address/${i.trim()}`},[f,i]),g=c.useCallback(()=>{o.trim()&&(l(o.trim()),m(a))},[o,a]),b=c.useCallback(j=>{j.key==="Enter"&&g()},[g]),p=c.useCallback(()=>{h&&window.open(h,"_blank","noopener,noreferrer")},[h]),x=n.filter(j=>j.chainKind==="evm"),v=n.filter(j=>j.chainKind!=="evm");return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(J,{title:t("common:addressLookup.transactionsTitle"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Gs,{children:t("common:addressLookup.chain")}),e.jsxs(Ws,{value:a,onValueChange:j=>j&&r(j),children:[e.jsx($s,{children:e.jsx(qs,{})}),e.jsxs(Hs,{children:[x.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:"EVM"}),x.map(j=>e.jsx(Yt,{value:j.id,children:j.name},j.id))]}),v.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:t("common:addressLookup.otherChains")}),v.map(j=>e.jsx(Yt,{value:j.id,children:j.name},j.id))]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Gs,{children:t("common:addressLookup.address")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ve,{placeholder:t("common:addressLookup.addressPlaceholder"),value:o,onChange:j=>d(j.target.value),onKeyDown:b,className:"flex-1 font-mono text-sm"}),e.jsx(V,{onClick:g,disabled:!o.trim(),children:e.jsx(sn,{className:"size-4"})})]})]}),i&&u&&e.jsx(zt,{chainId:u,fallback:e.jsx(Zt,{children:e.jsx(es,{className:"pt-6",children:e.jsx("p",{className:"text-muted-foreground text-center",children:"Chain not supported"})})}),children:e.jsx(Mj,{searchAddress:i,selectedChain:u,explorerUrl:h,onOpenExplorer:p})})]})]})}Qu.__docgenInfo={description:"",methods:[],displayName:"AddressTransactionsPage"};const Xu=()=>e.jsx(le,{children:e.jsx(Qu,{})});Xu.__docgenInfo={description:"",methods:[],displayName:"AddressTransactionsActivity"};const{useFlow:Z}=wx({transitionDuration:350,plugins:[kx(),Qx({theme:"cupertino"}),uv({routes:{MainTabsActivity:"/",WalletListActivity:"/wallet/list",WalletConfigActivity:"/wallet/:walletId",WalletCreateActivity:"/wallet/create",SendActivity:"/send",DestroyActivity:"/destroy",ReceiveActivity:"/receive",SettingsActivity:"/settings",SettingsLanguageActivity:"/settings/language",SettingsCurrencyActivity:"/settings/currency",SettingsChainsActivity:"/settings/chains",SettingsMnemonicActivity:"/settings/mnemonic",SettingsWalletLockActivity:"/settings/wallet-lock",SettingsWalletChainsActivity:"/settings/wallet-chains",SettingsStorageActivity:"/settings/storage",HistoryActivity:"/history",TransactionDetailActivity:"/transaction/:txId",ScannerActivity:"/scanner",AuthorizeAddressActivity:"/authorize/address/:id",AuthorizeSignatureActivity:"/authorize/signature/:id",OnboardingRecoverActivity:"/onboarding/recover",TokenDetailActivity:"/token/:tokenId",AddressBookActivity:"/address-book",MyCardActivity:"/my-card",NotificationsActivity:"/notifications",StakingActivity:"/staking",WelcomeActivity:"/welcome",SettingsSourcesActivity:"/settings/sources",MiniappDetailActivity:"/miniapp/:appId/detail",AddressBalanceActivity:"/address-balance",AddressTransactionsActivity:"/address-transactions",ChainSelectorJob:"/job/chain-selector",WalletRenameJob:"/job/wallet-rename/:walletId",WalletDeleteJob:"/job/wallet-delete/:walletId",WalletLockConfirmJob:"/job/wallet-lock-confirm",TwoStepSecretConfirmJob:"/job/two-step-secret-confirm",SetTwoStepSecretJob:"/job/set-two-step-secret",MnemonicOptionsJob:"/job/mnemonic-options",ContactEditJob:"/job/contact-edit",ContactPickerJob:"/job/contact-picker",WalletAddJob:"/job/wallet-add",WalletListJob:"/job/wallet-list",SecurityWarningJob:"/job/security-warning",TransferConfirmJob:"/job/transfer-confirm",TransferWalletLockJob:"/job/transfer-wallet-lock",FeeEditJob:"/job/fee-edit",ScannerJob:"/job/scanner",ContactAddConfirmJob:"/job/contact-add-confirm",ContactShareJob:"/job/contact-share",ClearDataConfirmJob:"/job/clear-data-confirm",WalletPickerJob:"/job/wallet-picker",SigningConfirmJob:"/job/signing-confirm",PermissionRequestJob:"/job/permission-request",MiniappTransferConfirmJob:"/job/miniapp-transfer-confirm",MiniappDestroyConfirmJob:"/job/miniapp-destroy-confirm",MiniappSignTransactionJob:"/job/miniapp-sign-transaction",ChainSwitchConfirmJob:"/job/chain-switch-confirm",CryptoAuthorizeJob:"/job/crypto-authorize"},fallbackActivity:()=>"MainTabsActivity",useHash:!0,urlPatternOptions:{segmentValueCharset:"a-zA-Z0-9-._~ %"}})],activities:{MainTabsActivity:Id,WalletListActivity:Pd,WalletConfigActivity:Ed,WalletCreateActivity:Md,SendActivity:Od,DestroyActivity:Fd,ReceiveActivity:$d,SettingsActivity:qd,SettingsLanguageActivity:Ud,SettingsCurrencyActivity:Jd,SettingsChainsActivity:ru,SettingsMnemonicActivity:ou,SettingsWalletLockActivity:lu,SettingsWalletChainsActivity:qu,SettingsStorageActivity:Uu,HistoryActivity:uu,TransactionDetailActivity:fu,ScannerActivity:hu,AuthorizeAddressActivity:vu,AuthorizeSignatureActivity:bu,OnboardingRecoverActivity:wu,TokenDetailActivity:Cu,AddressBookActivity:Au,MyCardActivity:Pu,NotificationsActivity:_u,StakingActivity:Bu,WelcomeActivity:Wu,SettingsSourcesActivity:Vu,MiniappDetailActivity:Ju,AddressBalanceActivity:Gu,AddressTransactionsActivity:Xu,ChainSelectorJob:Bl,WalletRenameJob:Wl,WalletDeleteJob:$l,WalletLockConfirmJob:ql,TwoStepSecretConfirmJob:Hl,SetTwoStepSecretJob:Jl,MnemonicOptionsJob:Kl,ContactEditJob:Gl,ContactPickerJob:Ql,WalletAddJob:Xl,WalletListJob:Yl,SecurityWarningJob:Zl,TransferConfirmJob:td,TransferWalletLockJob:nd,FeeEditJob:Vl,ScannerJob:ad,ContactAddConfirmJob:rd,ContactShareJob:id,ClearDataConfirmJob:od,WalletPickerJob:cd,SigningConfirmJob:dd,PermissionRequestJob:ud,MiniappTransferConfirmJob:bd,MiniappDestroyConfirmJob:wd,MiniappSignTransactionJob:kd,ChainSwitchConfirmJob:Cd,CryptoAuthorizeJob:Sd}});function Rj(t,s){const n=Math.abs(t-s);return Math.min(n,360-n)}function Lj(t,s,n=30){if(s.length===0)return 1;let a=180;for(const r of s){const o=Rj(t,r);o<a&&(a=o)}return a<n?a/n:1}function Dj(t){return cm.map(s=>({...s,weight:Lj(s.hue,t)}))}const zj="wallet-config-preview-name";function ta({mode:t,walletId:s,onEditOnlyComplete:n,className:a}){const{t:r}=B(["wallet","onboarding","common"]),{push:o}=Z(),d=Rt(),i=d.find(M=>M.id===s),l=Je(),u=Do(),m=ts(),[f,h]=c.useState(t==="edit-only"?"edit":t),[g,b]=c.useState(""),[p,x]=c.useState(0),v=c.useRef(null),[j,N]=c.useState(!1),y=c.useMemo(()=>d.filter(M=>M.id!==s).map(M=>M.themeHue),[d,s]),S=c.useMemo(()=>Dj(y),[y]);c.useEffect(()=>{i&&(b(i.name),x(i.themeHue))},[i]);const k=c.useMemo(()=>i?.chainAddresses.find(M=>M.chain===l)??i?.chainAddresses[0],[i,l]),I=c.useCallback(M=>{if(!v.current)return;const F=v.current.getBoundingClientRect(),ee=Math.max(0,Math.min(M-F.left,F.width))/F.width,W=Math.round(ee*3600)/10;x(W)},[]),_=M=>{M.stopPropagation(),N(!0),I(M.clientX)},A=M=>{M.stopPropagation(),N(!0),M.touches[0]&&I(M.touches[0].clientX)};c.useEffect(()=>{if(!j)return;const M=ee=>I(ee.clientX),F=ee=>{ee.touches[0]&&I(ee.touches[0].clientX)},K=()=>N(!1);return document.addEventListener("mousemove",M),document.addEventListener("mouseup",K),document.addEventListener("touchmove",F),document.addEventListener("touchend",K),()=>{document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",K),document.removeEventListener("touchmove",F),document.removeEventListener("touchend",K)}},[j,I]);const E=c.useCallback(()=>{o("ChainSelectorJob",{})},[o]),C=c.useCallback(()=>{i&&(b(i.name),x(i.themeHue)),h("edit")},[i]),T=c.useCallback(async()=>{if(!i)return;const M=g.trim();M&&M!==i.name&&await ye.updateWalletName(i.id,M),p!==i.themeHue&&await ye.updateWalletThemeHue(i.id,p),h("default")},[i,g,p]),w=c.useCallback(()=>{i&&(b(i.name),x(i.themeHue)),h("default")},[i]),P=c.useCallback(async()=>{if(!i)return;const M=g.trim();M&&M!==i.name&&await ye.updateWalletName(i.id,M),p!==i.themeHue&&await ye.updateWalletThemeHue(i.id,p),n?.()},[i,g,p,n]),L=c.useCallback(async()=>{i&&(await ye.setCurrentWallet(i.id),o("SettingsMnemonicActivity",{}))},[i,o]),z=c.useCallback(()=>{i&&o("WalletDeleteJob",{walletId:i.id})},[i,o]);if(!i)return e.jsx("div",{className:D("text-muted-foreground p-4 text-center",a),children:r("wallet:detail.notFound")});const R=f==="edit"||t==="edit-only"?p:i.themeHue,q=f==="edit"||t==="edit-only";return e.jsxs("div",{className:D("space-y-6",a),children:[e.jsx("div",{className:"flex justify-center px-4",children:e.jsx("div",{className:"flex w-full max-w-[360px] aspect-[1.6/1] items-stretch",children:e.jsx(zo,{wallet:{...i,name:q?g:i.name,themeHue:R},themeHue:R,walletNameTestId:zj,chain:k?.chain,chainName:k?.chain||"",address:k?.address||i.address,chainIconUrl:u[k?.chain??""],onOpenChainSelector:E})})}),q?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm",children:r("onboarding:theme.walletName")}),e.jsxs(Cm,{children:[e.jsx(Sm,{value:g,onChange:M=>b(M.target.value),placeholder:r("wallet:defaultName"),maxLength:20,className:"text-center"}),e.jsx(Am,{align:"inline-end",children:e.jsx(Im,{size:"icon-xs",variant:"ghost",onClick:()=>b(r("onboarding:create.generatedNamePattern",{word:En(m),suffix:r("onboarding:create.walletSuffix")})),title:r("wallet:randomName"),children:e.jsx(Ap,{className:"size-4"})})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:r("onboarding:theme.customColor")}),e.jsxs("span",{className:"text-muted-foreground font-mono",children:[p.toFixed(1),""]})]}),e.jsxs("div",{ref:v,className:"relative h-8 cursor-pointer touch-none rounded-full",style:{background:"linear-gradient(to right, oklch(0.6 0.25 0), oklch(0.6 0.25 60), oklch(0.6 0.25 120), oklch(0.6 0.25 180), oklch(0.6 0.25 240), oklch(0.6 0.25 300), oklch(0.6 0.25 360))"},onMouseDown:_,onTouchStart:A,children:[y.map((M,F)=>e.jsx("div",{className:"absolute top-0 h-full w-0.5 bg-black/30",style:{left:`${M/360*100}%`},title:r("onboarding:theme.usedColor")},F)),e.jsx("div",{className:"absolute top-1/2 -translate-x-1/2 -translate-y-1/2",style:{left:`${p/360*100}%`},children:e.jsx("div",{className:"size-6 rounded-full border-2 border-white shadow-md",style:{backgroundColor:`oklch(0.6 0.25 ${p})`}})})]})]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-3",children:S.map(M=>{const F=Math.abs(p-M.hue)<.5,K=M.weight<.5;return e.jsx("button",{type:"button",onClick:()=>x(M.hue),className:D("relative size-10 rounded-full transition-all","ring-offset-background focus-visible:ring-ring focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:outline-none",F&&"ring-primary ring-2 ring-offset-2",K&&"opacity-50"),style:{backgroundColor:M.color},title:r(M.nameKey),children:F&&e.jsx(Ne,{className:"absolute inset-0 m-auto size-5 text-white drop-shadow-md"})},M.hue)})})]}),t==="edit-only"?e.jsx(V,{className:"w-full",onClick:P,disabled:!g.trim(),"data-testid":"theme-complete-button",style:{"--primary-hue":p,"--primary":`oklch(var(--primary-lightness) var(--primary-saturation) ${p})`},children:r("common:confirm")}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{variant:"outline",className:"flex-1",onClick:w,children:r("common:cancel")}),e.jsx(V,{className:"flex-1",onClick:T,disabled:!g.trim(),style:{"--primary-hue":p,"--primary":`oklch(var(--primary-lightness) var(--primary-saturation) ${p})`},children:r("common:save")})]})]}):e.jsxs("div",{className:"flex justify-center gap-8",children:[e.jsxs("button",{onClick:C,className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"bg-primary/10 text-primary group-hover:bg-primary/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:e.jsx(qp,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:r("wallet:detail.editName")})]}),e.jsxs("button",{onClick:L,className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"bg-primary/10 text-primary group-hover:bg-primary/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:e.jsx(gr,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:r("wallet:detail.exportMnemonic")})]}),e.jsxs("button",{onClick:z,className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"bg-destructive/10 text-destructive group-hover:bg-destructive/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:e.jsx(ns,{className:"size-5"})}),e.jsx("span",{className:"text-destructive text-xs font-medium",children:r("wallet:detail.deleteWallet")})]})]})]})}ta.__docgenInfo={description:`
- default: + edit
- edit:  default  default
- edit-only: / onEditOnlyComplete`,methods:[],displayName:"WalletConfig",props:{mode:{required:!0,tsType:{name:"union",raw:"'edit-only' | 'default' | 'edit'",elements:[{name:"literal",value:"'edit-only'"},{name:"literal",value:"'default'"},{name:"literal",value:"'edit'"}]},description:""},walletId:{required:!0,tsType:{name:"string"},description:""},onEditOnlyComplete:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};export{Su as A,au as C,Bd as D,Rp as I,Hd as L,Tu as M,Eu as N,Wd as R,Ae as S,mu as T,iu as V,ta as W,Qu as a,du as b,cu as c,Vd as d,_s as e,Wr as f,Td as g};
