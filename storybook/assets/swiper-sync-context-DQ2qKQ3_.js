import{n as C,e as v}from"./swiper-BfG-bBVn.js";import{r as f,j as R}from"./iframe-DZOLjtV7.js";function N({swiper:e,extendParams:u,on:a}){u({controller:{control:void 0,inverse:!1,by:"slide"}}),e.controller={control:void 0};function d(o,n){const r=(function(){let i,s,h;return(T,b)=>{for(s=-1,i=T.length;i-s>1;)h=i+s>>1,T[h]<=b?s=h:i=h;return i}})();this.x=o,this.y=n,this.lastIndex=o.length-1;let t,l;return this.interpolate=function(i){return i?(l=r(this.x,i),t=l-1,(i-this.x[t])*(this.y[l]-this.y[t])/(this.x[l]-this.x[t])+this.y[t]):0},this}function m(o){e.controller.spline=e.params.loop?new d(e.slidesGrid,o.slidesGrid):new d(e.snapGrid,o.snapGrid)}function y(o,n){const r=e.controller.control;let t,l;const p=e.constructor;function i(s){if(s.destroyed)return;const h=e.rtlTranslate?-e.translate:e.translate;e.params.controller.by==="slide"&&(m(s),l=-e.controller.spline.interpolate(-h)),(!l||e.params.controller.by==="container")&&(t=(s.maxTranslate()-s.minTranslate())/(e.maxTranslate()-e.minTranslate()),(Number.isNaN(t)||!Number.isFinite(t))&&(t=1),l=(h-e.minTranslate())*t+s.minTranslate()),e.params.controller.inverse&&(l=s.maxTranslate()-l),s.updateProgress(l),s.setTranslate(l,e),s.updateActiveIndex(),s.updateSlidesClasses()}if(Array.isArray(r))for(let s=0;s<r.length;s+=1)r[s]!==n&&r[s]instanceof p&&i(r[s]);else r instanceof p&&n!==r&&i(r)}function x(o,n){const r=e.constructor,t=e.controller.control;let l;function p(i){i.destroyed||(i.setTransition(o,e),o!==0&&(i.transitionStart(),i.params.autoHeight&&C(()=>{i.updateAutoHeight()}),v(i.wrapperEl,()=>{t&&i.transitionEnd()})))}if(Array.isArray(t))for(l=0;l<t.length;l+=1)t[l]!==n&&t[l]instanceof r&&p(t[l]);else t instanceof r&&n!==t&&p(t)}function c(){e.controller.control&&e.controller.spline&&(e.controller.spline=void 0,delete e.controller.spline)}a("beforeInit",()=>{if(typeof window<"u"&&(typeof e.params.controller.control=="string"||e.params.controller.control instanceof HTMLElement)){(typeof e.params.controller.control=="string"?[...document.querySelectorAll(e.params.controller.control)]:[e.params.controller.control]).forEach(n=>{if(e.controller.control||(e.controller.control=[]),n&&n.swiper)e.controller.control.push(n.swiper);else if(n){const r=`${e.params.eventsPrefix}init`,t=l=>{e.controller.control.push(l.detail[0]),e.update(),n.removeEventListener(r,t)};n.addEventListener(r,t)}});return}e.controller.control=e.params.controller.control}),a("update",()=>{c()}),a("resize",()=>{c()}),a("observerUpdate",()=>{c()}),a("setTranslate",(o,n,r)=>{!e.controller.control||e.controller.control.destroyed||e.controller.setTranslate(n,r)}),a("setTransition",(o,n,r)=>{!e.controller.control||e.controller.control.destroyed||e.controller.setTransition(n,r)}),Object.assign(e.controller,{setTranslate:y,setTransition:x})}const g=f.createContext(null),S=(e,u)=>[e,u].sort().join(":");function E({children:e}){const u=f.useRef(new Map),a=f.useRef(new Set),d=f.useCallback((c,o)=>{u.current.set(c,o)},[]),m=f.useCallback(c=>{const o=u.current.get(c);o?.swiper&&!o.swiper.destroyed&&o.swiper.controller&&(o.swiper.controller.control=void 0),u.current.delete(c),a.current.forEach(n=>{n.includes(c)&&a.current.delete(n)})},[]),y=f.useCallback((c,o)=>{const n=S(c,o);if(a.current.has(n))return;const r=u.current.get(c),t=u.current.get(o);!r||!t||r.swiper.destroyed||t.swiper.destroyed||(a.current.add(n),r.swiper.controller.control=t.swiper,t.swiper.controller.control=r.swiper,r.swiper.slideTo(r.initialIndex,0,!1),t.swiper.slideTo(t.initialIndex,0,!1))},[]),x=f.useCallback((c,o)=>a.current.has(S(c,o)),[]);return R.jsx(g.Provider,{value:{membersRef:u,readyPairsRef:a,register:d,unregister:m,tryConnect:y,isReady:x},children:e})}function k(e,u,a){const d=f.useContext(g);if(!d)throw new Error("useSwiperMember must be used within SwiperSyncProvider");const m=f.useRef(a);m.current=a;const y=f.useRef(d);y.current=d;const x=f.useRef(e);x.current=e;const c=f.useCallback(n=>{d.register(e,{swiper:n,initialIndex:m.current.initialIndex}),d.tryConnect(e,u)},[d,e,u]),o=f.useCallback(n=>{d.isReady(e,u)&&m.current.onSlideChange?.(n)},[d,e,u]);return f.useEffect(()=>()=>y.current.unregister(x.current),[]),{onSwiper:c,onSlideChange:o}}E.__docgenInfo={description:"",methods:[],displayName:"SwiperSyncProvider",props:{children:{required:!0,tsType:{name:"ReactNode"},description:""}}};export{N as C,E as S,k as u};
