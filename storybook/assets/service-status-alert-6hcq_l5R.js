import{j as t,r as f,v as h}from"./iframe-mWBAGdu2.js";import{c as p}from"./utils-4perknFd.js";import{c as E,I as j}from"./web-CZBBkCl8.js";import{u as v}from"./useTranslation-CgcY4kD2.js";import{I as k}from"./IconCheck-CuLK5Lso.js";import{I as T}from"./IconX-BqC2qfgB.js";import{A as b}from"./LoadingSpinner-5yBM7ljk.js";import{I as w}from"./IconAlertTriangle-CNSsSeij.js";import{I as C}from"./IconLock-BgRk-y-j.js";import{c as I}from"./createReactComponent-B-6fW5hv.js";function q({label:r,hint:e,error:n,required:i,children:s,className:a}){return t.jsxs("div",{className:p("space-y-2",a),children:[r&&t.jsxs("label",{className:"text-sm font-medium",children:[r,i&&t.jsx("span",{className:"ml-1 text-destructive",children:"*"})]}),s,e&&!n&&t.jsx("p",{className:"text-xs text-muted-foreground",children:e}),n&&t.jsx("p",{className:"-mt-0.5 text-xs text-destructive",children:n})]})}q.__docgenInfo={description:"",methods:[],displayName:"FormField",props:{label:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"字段标签"},hint:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"帮助文本"},error:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"错误信息"},required:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"是否必填"},children:{required:!0,tsType:{name:"ReactNode"},description:"子元素 (input, select 等)"},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"自定义类名"}}};const g="captured_errors",x=50;function y(){try{const r=sessionStorage.getItem(g);return r?JSON.parse(r):[]}catch{return[]}}function d(r){try{const e=y();e.push(r),e.length>x&&e.splice(0,e.length-x),sessionStorage.setItem(g,JSON.stringify(e))}catch(e){console.warn("[ErrorCapture] Failed to save error:",e)}}function m(){return new Date().toISOString()}const R=console.error;console.error=function(...r){d({timestamp:m(),type:"error",message:r.map(e=>{if(e instanceof Error)return`${e.message}
${e.stack}`;if(typeof e=="object")try{return JSON.stringify(e)}catch{return String(e)}return String(e)}).join(" ")}),R.apply(console,r)};const _=console.warn;console.warn=function(...r){d({timestamp:m(),type:"warning",message:r.map(e=>{if(e instanceof Error)return`${e.message}
${e.stack}`;if(typeof e=="object")try{return JSON.stringify(e)}catch{return String(e)}return String(e)}).join(" ")}),_.apply(console,r)};window.onerror=function(r,e,n,i,s){return d({timestamp:m(),type:"unhandled",message:String(r),stack:s?.stack,source:e,lineno:n,colno:i}),!1};window.onunhandledrejection=function(r){const e=r.reason;d({timestamp:m(),type:"promise-rejection",message:e instanceof Error?e.message:String(e),stack:e instanceof Error?e.stack:void 0})};function $(){return y()}function A(){sessionStorage.removeItem(g)}function F(r,e){d({timestamp:m(),type:"error",message:r.message,stack:[r.stack,e?.componentStack].filter(Boolean).join(`
`)})}function O(){const r=y();console.log(`[ErrorCapture] ${r.length} captured errors:`),r.forEach((e,n)=>{console.log(`
--- Error ${n+1} (${e.timestamp}) [${e.type}] ---`),console.log(e.message),e.stack&&console.log("Stack:",e.stack),e.source&&console.log(`Source: ${e.source}:${e.lineno}:${e.colno}`)})}typeof window<"u"&&(window.__errorCapture={get:$,clear:A,print:O});console.log("[ErrorCapture] Initialized - errors will be saved to sessionStorage");class D extends f.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){F(e,n),this.props.onError?.(e,n)}handleReset=()=>{this.setState({hasError:!1,error:null})};render(){if(this.state.hasError&&this.state.error){const{fallback:e}=this.props;return e?typeof e=="function"?e(this.state.error,this.handleReset):e:t.jsxs("div",{className:"flex flex-col items-center justify-center p-4 text-center",children:[t.jsx("div",{className:"text-destructive mb-2",children:t.jsx("svg",{className:"size-8 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),t.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:h.t("error:boundary.title")}),t.jsx("button",{onClick:this.handleReset,className:"text-xs px-3 py-1.5 rounded-md bg-primary text-primary-foreground hover:bg-primary/90",children:h.t("error:boundary.retry")})]})}return this.props.children}}D.__docgenInfo={description:"",methods:[{name:"handleReset",docblock:null,modifiers:[],params:[],returns:{type:{name:"void"}}}],displayName:"ErrorBoundary",props:{children:{required:!0,tsType:{name:"ReactNode"},description:"子组件"},fallback:{required:!1,tsType:{name:"union",raw:"ReactNode | ((error: Error, reset: () => void) => ReactNode)",elements:[{name:"ReactNode"},{name:"unknown"}]},description:"自定义错误 UI"},onError:{required:!1,tsType:{name:"signature",type:"function",raw:"(error: Error, errorInfo: ErrorInfo) => void",signature:{arguments:[{type:{name:"Error"},name:"error"},{type:{name:"ErrorInfo"},name:"errorInfo"}],return:{name:"void"}}},description:"错误回调"}}};const z=[["path",{d:"M9.58 5.548c.24 -.11 .492 -.207 .752 -.286c1.88 -.572 3.956 -.193 5.444 1c1.488 1.19 2.162 3.007 1.77 4.769h.99c1.913 0 3.464 1.56 3.464 3.486c0 .957 -.383 1.824 -1.003 2.454m-2.997 1.033h-11.343c-2.572 -.004 -4.657 -2.011 -4.657 -4.487c0 -2.475 2.085 -4.482 4.657 -4.482c.13 -.582 .37 -1.128 .7 -1.62",key:"svg-0"}],["path",{d:"M3 3l18 18",key:"svg-1"}]],L=I("outline","cloud-off","CloudOff",z);function B({text:r,displayText:e,className:n,iconClassName:i,onCopy:s,testId:a}){const{t:l}=v("common"),[o,c]=f.useState("idle"),u=f.useCallback(async()=>{try{await E.write({text:r}),c("copied"),s?.(),setTimeout(()=>c("idle"),2e3)}catch{c("failed"),setTimeout(()=>c("idle"),2e3)}},[r,s]),S=o==="copied"?k:o==="failed"?T:j,N=o==="copied"?"text-green-500":o==="failed"?"text-red-500":"text-muted-foreground";return t.jsxs("button",{type:"button",onClick:u,...a&&{"data-testid":a},className:p("inline-flex items-center gap-1.5 font-mono transition-colors","hover:text-primary focus-visible:ring-ring rounded focus:outline-none focus-visible:ring-2",n),title:r,"aria-label":l(o==="copied"?"copiedToClipboard":"clickToCopy"),children:[t.jsx("span",{className:"break-all",children:e??r}),t.jsx(S,{className:p("size-4 shrink-0",N,i),"aria-hidden":"true"}),t.jsx("span",{role:"status","aria-live":"polite",className:"sr-only",children:o==="copied"?l("copiedToClipboard"):""})]})}B.__docgenInfo={description:"",methods:[],displayName:"CopyableText",props:{text:{required:!0,tsType:{name:"string"},description:""},displayText:{required:!1,tsType:{name:"string"},description:""},className:{required:!1,tsType:{name:"string"},description:""},iconClassName:{required:!1,tsType:{name:"string"},description:""},onCopy:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},testId:{required:!1,tsType:{name:"string"},description:""}}};function J({type:r,feature:e,reason:n,className:i}){const{t:s}=v("common"),a={notSupported:{variant:"info",icon:t.jsx(L,{className:"size-4"}),title:s("service.notSupported"),desc:e?s("service.notSupportedDesc",{feature:e}):s("service.notSupportedDescGeneric")},limited:{variant:"warning",icon:t.jsx(C,{className:"size-4"}),title:s("service.limited"),desc:s("service.limitedDesc")},error:{variant:"error",icon:t.jsx(w,{className:"size-4"}),title:s("service.queryFailed"),desc:s("service.queryFailedDesc")}},{variant:l,icon:o,title:c,desc:u}=a[r];return t.jsxs(b,{variant:l,title:c,icon:o,className:p(i),children:[t.jsx("p",{className:"text-xs opacity-80",children:u}),n&&t.jsxs("details",{className:"mt-2",children:[t.jsx("summary",{className:"text-xs cursor-pointer hover:underline opacity-70",children:s("service.technicalDetails")}),t.jsx("p",{className:"mt-1 text-xs font-mono break-all opacity-60",children:n})]})]})}J.__docgenInfo={description:`服务状态提示组件

@example
\`\`\`tsx
// 服务受限
<ServiceStatusAlert type="limited" feature="交易历史" />

// 不支持
<ServiceStatusAlert type="notSupported" feature="代币余额" />

// 查询失败
<ServiceStatusAlert type="error" reason={error.message} />
\`\`\``,methods:[],displayName:"ServiceStatusAlert",props:{type:{required:!0,tsType:{name:"union",raw:"'notSupported' | 'limited' | 'error'",elements:[{name:"literal",value:"'notSupported'"},{name:"literal",value:"'limited'"},{name:"literal",value:"'error'"}]},description:"错误类型"},feature:{required:!1,tsType:{name:"string"},description:'功能名称（如"交易历史"）'},reason:{required:!1,tsType:{name:"string"},description:"技术原因（可选展开查看）"},className:{required:!1,tsType:{name:"string"},description:"自定义样式"}}};export{B as C,D as E,q as F,J as S};
