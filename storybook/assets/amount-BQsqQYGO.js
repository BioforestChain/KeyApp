var k=20,$=1,b=1e6,M=1e6,j=-7,T=21,U=!1,N="[big.js] ",p=N+"Invalid ",R=p+"decimal places",J=p+"rounding mode",q=N+"Division by zero",a={},g=void 0,V=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function B(){function e(t){var r=this;if(!(r instanceof e))return t===g&&arguments.length===0?B():new e(t);if(t instanceof e)r.s=t.s,r.e=t.e,r.c=t.c.slice();else{if(typeof t!="string"){if(e.strict===!0&&typeof t!="bigint")throw TypeError(p+"value");t=t===0&&1/t<0?"-0":String(t)}z(r,t)}r.constructor=e}return e.prototype=a,e.DP=k,e.RM=$,e.NE=j,e.PE=T,e.strict=U,e.roundDown=0,e.roundHalfUp=1,e.roundHalfEven=2,e.roundUp=3,e}function z(e,t){var r,i,s;if(!V.test(t))throw Error(p+"number");for(e.s=t.charAt(0)=="-"?(t=t.slice(1),-1):1,(r=t.indexOf("."))>-1&&(t=t.replace(".","")),(i=t.search(/e/i))>0?(r<0&&(r=i),r+=+t.slice(i+1),t=t.substring(0,i)):r<0&&(r=t.length),s=t.length,i=0;i<s&&t.charAt(i)=="0";)++i;if(i==s)e.c=[e.e=0];else{for(;s>0&&t.charAt(--s)=="0";);for(e.e=r-i-1,e.c=[],r=0;i<=s;)e.c[r++]=+t.charAt(i++)}return e}function D(e,t,r,i){var s=e.c;if(r===g&&(r=e.constructor.RM),r!==0&&r!==1&&r!==2&&r!==3)throw Error(J);if(t<1)i=r===3&&(i||!!s[0])||t===0&&(r===1&&s[0]>=5||r===2&&(s[0]>5||s[0]===5&&(i||s[1]!==g))),s.length=1,i?(e.e=e.e-t+1,s[0]=1):s[0]=e.e=0;else if(t<s.length){if(i=r===1&&s[t]>=5||r===2&&(s[t]>5||s[t]===5&&(i||s[t+1]!==g||s[t-1]&1))||r===3&&(i||!!s[0]),s.length=t,i){for(;++s[--t]>9;)if(s[t]=0,t===0){++e.e,s.unshift(1);break}}for(t=s.length;!s[--t];)s.pop()}return e}function E(e,t,r){var i=e.e,s=e.c.join(""),o=s.length;if(t)s=s.charAt(0)+(o>1?"."+s.slice(1):"")+(i<0?"e":"e+")+i;else if(i<0){for(;++i;)s="0"+s;s="0."+s}else if(i>0)if(++i>o)for(i-=o;i--;)s+="0";else i<o&&(s=s.slice(0,i)+"."+s.slice(i));else o>1&&(s=s.charAt(0)+"."+s.slice(1));return e.s<0&&r?"-"+s:s}a.abs=function(){var e=new this.constructor(this);return e.s=1,e};a.cmp=function(e){var t,r=this,i=r.c,s=(e=new r.constructor(e)).c,o=r.s,l=e.s,n=r.e,u=e.e;if(!i[0]||!s[0])return i[0]?o:s[0]?-l:0;if(o!=l)return o;if(t=o<0,n!=u)return n>u^t?1:-1;for(l=(n=i.length)<(u=s.length)?n:u,o=-1;++o<l;)if(i[o]!=s[o])return i[o]>s[o]^t?1:-1;return n==u?0:n>u^t?1:-1};a.div=function(e){var t=this,r=t.constructor,i=t.c,s=(e=new r(e)).c,o=t.s==e.s?1:-1,l=r.DP;if(l!==~~l||l<0||l>b)throw Error(R);if(!s[0])throw Error(q);if(!i[0])return e.s=o,e.c=[e.e=0],e;var n,u,c,_,f,d=s.slice(),P=n=s.length,O=i.length,w=i.slice(0,n),v=w.length,S=e,F=S.c=[],I=0,x=l+(S.e=t.e-e.e)+1;for(S.s=o,o=x<0?0:x,d.unshift(0);v++<n;)w.push(0);do{for(c=0;c<10;c++){if(n!=(v=w.length))_=n>v?1:-1;else for(f=-1,_=0;++f<n;)if(s[f]!=w[f]){_=s[f]>w[f]?1:-1;break}if(_<0){for(u=v==n?s:d;v;){if(w[--v]<u[v]){for(f=v;f&&!w[--f];)w[f]=9;--w[f],w[v]+=10}w[v]-=u[v]}for(;!w[0];)w.shift()}else break}F[I++]=_?c:++c,w[0]&&_?w[v]=i[P]||0:w=[i[P]]}while((P++<O||w[0]!==g)&&o--);return!F[0]&&I!=1&&(F.shift(),S.e--,x--),I>x&&D(S,x,r.RM,w[0]!==g),S};a.eq=function(e){return this.cmp(e)===0};a.gt=function(e){return this.cmp(e)>0};a.gte=function(e){return this.cmp(e)>-1};a.lt=function(e){return this.cmp(e)<0};a.lte=function(e){return this.cmp(e)<1};a.minus=a.sub=function(e){var t,r,i,s,o=this,l=o.constructor,n=o.s,u=(e=new l(e)).s;if(n!=u)return e.s=-u,o.plus(e);var c=o.c.slice(),_=o.e,f=e.c,d=e.e;if(!c[0]||!f[0])return f[0]?e.s=-u:c[0]?e=new l(o):e.s=1,e;if(n=_-d){for((s=n<0)?(n=-n,i=c):(d=_,i=f),i.reverse(),u=n;u--;)i.push(0);i.reverse()}else for(r=((s=c.length<f.length)?c:f).length,n=u=0;u<r;u++)if(c[u]!=f[u]){s=c[u]<f[u];break}if(s&&(i=c,c=f,f=i,e.s=-e.s),(u=(r=f.length)-(t=c.length))>0)for(;u--;)c[t++]=0;for(u=t;r>n;){if(c[--r]<f[r]){for(t=r;t&&!c[--t];)c[t]=9;--c[t],c[r]+=10}c[r]-=f[r]}for(;c[--u]===0;)c.pop();for(;c[0]===0;)c.shift(),--d;return c[0]||(e.s=1,c=[d=0]),e.c=c,e.e=d,e};a.mod=function(e){var t,r=this,i=r.constructor,s=r.s,o=(e=new i(e)).s;if(!e.c[0])throw Error(q);return r.s=e.s=1,t=e.cmp(r)==1,r.s=s,e.s=o,t?new i(r):(s=i.DP,o=i.RM,i.DP=i.RM=0,r=r.div(e),i.DP=s,i.RM=o,this.minus(r.times(e)))};a.neg=function(){var e=new this.constructor(this);return e.s=-e.s,e};a.plus=a.add=function(e){var t,r,i,s=this,o=s.constructor;if(e=new o(e),s.s!=e.s)return e.s=-e.s,s.minus(e);var l=s.e,n=s.c,u=e.e,c=e.c;if(!n[0]||!c[0])return c[0]||(n[0]?e=new o(s):e.s=s.s),e;if(n=n.slice(),t=l-u){for(t>0?(u=l,i=c):(t=-t,i=n),i.reverse();t--;)i.push(0);i.reverse()}for(n.length-c.length<0&&(i=c,c=n,n=i),t=c.length,r=0;t;n[t]%=10)r=(n[--t]=n[t]+c[t]+r)/10|0;for(r&&(n.unshift(r),++u),t=n.length;n[--t]===0;)n.pop();return e.c=n,e.e=u,e};a.pow=function(e){var t=this,r=new t.constructor("1"),i=r,s=e<0;if(e!==~~e||e<-M||e>M)throw Error(p+"exponent");for(s&&(e=-e);e&1&&(i=i.times(t)),e>>=1,!!e;)t=t.times(t);return s?r.div(i):i};a.prec=function(e,t){if(e!==~~e||e<1||e>b)throw Error(p+"precision");return D(new this.constructor(this),e,t)};a.round=function(e,t){if(e===g)e=0;else if(e!==~~e||e<-b||e>b)throw Error(R);return D(new this.constructor(this),e+this.e+1,t)};a.sqrt=function(){var e,t,r,i=this,s=i.constructor,o=i.s,l=i.e,n=new s("0.5");if(!i.c[0])return new s(i);if(o<0)throw Error(N+"No square root");o=Math.sqrt(+E(i,!0,!0)),o===0||o===1/0?(t=i.c.join(""),t.length+l&1||(t+="0"),o=Math.sqrt(t),l=((l+1)/2|0)-(l<0||l&1),e=new s((o==1/0?"5e":(o=o.toExponential()).slice(0,o.indexOf("e")+1))+l)):e=new s(o+""),l=e.e+(s.DP+=4);do r=e,e=n.times(r.plus(i.div(r)));while(r.c.slice(0,l).join("")!==e.c.slice(0,l).join(""));return D(e,(s.DP-=4)+e.e+1,s.RM)};a.times=a.mul=function(e){var t,r=this,i=r.constructor,s=r.c,o=(e=new i(e)).c,l=s.length,n=o.length,u=r.e,c=e.e;if(e.s=r.s==e.s?1:-1,!s[0]||!o[0])return e.c=[e.e=0],e;for(e.e=u+c,l<n&&(t=s,s=o,o=t,c=l,l=n,n=c),t=new Array(c=l+n);c--;)t[c]=0;for(u=n;u--;){for(n=0,c=l+u;c>u;)n=t[c]+o[u]*s[c-u-1]+n,t[c--]=n%10,n=n/10|0;t[c]=n}for(n?++e.e:t.shift(),u=t.length;!t[--u];)t.pop();return e.c=t,e};a.toExponential=function(e,t){var r=this,i=r.c[0];if(e!==g){if(e!==~~e||e<0||e>b)throw Error(R);for(r=D(new r.constructor(r),++e,t);r.c.length<e;)r.c.push(0)}return E(r,!0,!!i)};a.toFixed=function(e,t){var r=this,i=r.c[0];if(e!==g){if(e!==~~e||e<0||e>b)throw Error(R);for(r=D(new r.constructor(r),e+r.e+1,t),e=e+r.e+1;r.c.length<e;)r.c.push(0)}return E(r,!1,!!i)};a.toJSON=a.toString=function(){var e=this,t=e.constructor;return E(e,e.e<=t.NE||e.e>=t.PE,!!e.c[0])};typeof Symbol<"u"&&(a[Symbol.for("nodejs.util.inspect.custom")]=a.toJSON);a.toNumber=function(){var e=+E(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(e.toString()))throw Error(N+"Imprecise conversion");return e};a.toPrecision=function(e,t){var r=this,i=r.constructor,s=r.c[0];if(e!==g){if(e!==~~e||e<1||e>b)throw Error(p+"precision");for(r=D(new i(r),e,t);r.c.length<e;)r.c.push(0)}return E(r,e<=r.e||r.e<=i.NE||r.e>=i.PE,!!s)};a.valueOf=function(){var e=this,t=e.constructor;if(t.strict===!0)throw Error(N+"valueOf disallowed");return E(e,e.e<=t.NE||e.e>=t.PE,!0)};var h=B();class m{_value;_decimals;_symbol;constructor(t,r,i){this._value=t,this._decimals=r,this._symbol=i}static fromRaw(t,r,i){const s=new h(t.toString());return new m(s,r,i)}static fromFormatted(t,r,i){const s=m.tryFromFormatted(t,r,i);if(s===null)throw new Error(`Invalid amount format: "${t}"`);return s}static tryFromFormatted(t,r,i){const s=t.trim();if(!s||!/^-?\d*\.?\d*$/.test(s)||s==="."||s==="-"||s==="-.")return null;try{const o=new h(s),l=new h(10).pow(r),n=o.times(l);return n.round(0,h.roundDown).eq(n)?new m(n.round(0,h.roundDown),r,i):null}catch{return null}}static zero(t,r){return new m(new h(0),t,r)}static parse(t,r,i){return t.includes(".")?m.fromFormatted(t,r,i):m.fromRaw(t,r,i)}static fromJSON(t){return m.fromRaw(t.raw,t.decimals,t.symbol)}get raw(){return BigInt(this._value.toFixed(0))}get decimals(){return this._decimals}get symbol(){return this._symbol}toRawString(){return this._value.toFixed(0)}toFormatted(t){const{trimTrailingZeros:r=!0}=t??{};if(this._value.eq(0))return"0";const i=new h(10).pow(this._decimals),s=this._value.div(i);return r?s.toFixed(this._decimals).replace(/\.?0+$/,""):s.toFixed(this._decimals)}toDisplayString(t){const{locale:r="en-US",maximumFractionDigits:i=this._decimals,minimumFractionDigits:s=0}=t??{},o=this.toNumber();return new Intl.NumberFormat(r,{maximumFractionDigits:i,minimumFractionDigits:s}).format(o)}toNumber(){const t=new h(10).pow(this._decimals);return this._value.div(t).toNumber()}toString(){const t=this.toFormatted();return this._symbol?`${t} ${this._symbol}`:t}toJSON(){return{raw:this.toRawString(),decimals:this._decimals,...this._symbol!==void 0&&{symbol:this._symbol}}}isZero(){return this._value.eq(0)}isPositive(){return this._value.gt(0)}isNegative(){return this._value.lt(0)}gt(t){return this.assertSameDecimals(t),this._value.gt(t._value)}gte(t){return this.assertSameDecimals(t),this._value.gte(t._value)}lt(t){return this.assertSameDecimals(t),this._value.lt(t._value)}lte(t){return this.assertSameDecimals(t),this._value.lte(t._value)}eq(t){return this.assertSameDecimals(t),this._value.eq(t._value)}add(t){return this.assertSameDecimals(t),new m(this._value.plus(t._value),this._decimals,this._symbol)}sub(t){return this.assertSameDecimals(t),new m(this._value.minus(t._value),this._decimals,this._symbol)}mul(t){const r=t instanceof h?t:new h(t.toString());return new m(this._value.times(r).round(0,h.roundDown),this._decimals,this._symbol)}div(t){const r=t instanceof h?t:new h(t.toString());return new m(this._value.div(r).round(0,h.roundDown),this._decimals,this._symbol)}mod(t){const r=t instanceof h?t:new h(t.toString());return new m(this._value.mod(r),this._decimals,this._symbol)}abs(){return new m(this._value.abs(),this._decimals,this._symbol)}neg(){return new m(this._value.neg(),this._decimals,this._symbol)}min(t){return this.assertSameDecimals(t),this._value.lte(t._value)?this:t}max(t){return this.assertSameDecimals(t),this._value.gte(t._value)?this:t}percent(t){return this.mul(t).div(100)}toDecimals(t){if(t===this._decimals)return this;const r=t-this._decimals;if(r>0){const i=new h(10).pow(r);return new m(this._value.times(i),t,this._symbol)}else{const i=new h(10).pow(-r);return new m(this._value.div(i).round(0,h.roundDown),t,this._symbol)}}withRaw(t){return m.fromRaw(t,this._decimals,this._symbol)}withSymbol(t){return new m(this._value,this._decimals,t)}withDecimals(t){return this.toDecimals(t)}withAsset(t){return this.toDecimals(t.decimals).withSymbol(t.assetType??this._symbol??"")}assertSameDecimals(t){if(this._decimals!==t._decimals)throw new Error(`Amount decimals mismatch: ${this._decimals} vs ${t._decimals}. Cannot compare or operate on amounts with different decimals.`)}}export{m as A};
