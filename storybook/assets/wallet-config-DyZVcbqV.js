const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./snapdom-CO8q8LPW.js","./preload-helper-PPVm8Dsz.js","./index-CreRbCXK.js","./iframe-SXVqHfW1.js","./iframe-D0rt0-mY.css","./service-D6CLtI_E.js","./schemas-CO8_C8zP.js","./index-D0E7N0oa.js","./derivation-DaU5Fc54.js","./amount-BQsqQYGO.js","./bioforest-BrSvoWuc.js"])))=>i.map(i=>d[i]);
import{g as nu,r as l,j as e,R as ba,u as we,S as au,aj as Wi,ak as _n,q as ve,al as Ft,w as Fi,am as ru,x as dr}from"./iframe-SXVqHfW1.js";import{a as Mn,c as R}from"./utils-4perknFd.js";import{u as $i,d as ra,W as iu}from"./useWalletTheme-C7YuGG2x.js";import{W as ou,u as qi}from"./wallet-card-carousel-BnSnrH4A.js";import{W as Hi}from"./wallet-card-Z0krHUC3.js";import{B as q}from"./button-Sidawz76.js";import{f as pe,e as as,W as Rn,g as Ln,c as Cs,a as Ss,b as ja,w as ke,d as Bs,u as Na,h as cu,i as lu,j as Xt}from"./user-profile-C-4ZMrz0.js";import{h as du,u as st,a as Je,c as As,j as $t,d as Os,e as ur,k as wa,l as uu,m as mu,n as fu,o as pu,f as Gt,p as Ws,q as hu}from"./service-D6CLtI_E.js";import{u as xu,a as gu,b as yt,c as Ae,d as zn,e as Be,f as ka,g as Ui,p as vu,T as yu}from"./TabBar-Cq-QEznK.js";import{s as gs}from"./index-D0E7N0oa.js";import{g as bu,v as Vi,R as ju,I as Nu,a as wu,b as ku,c as Cu}from"./recover-wallet-form-DxmUDRUP.js";import{S as Su}from"./swiper-sync-context-DNjL0t24.js";import{h as Au,c as Iu,W as Tu,C as Ca,s as Lt}from"./token-item-BnGiwygY.js";import{L as Se,G as ze,A as zt,P as ct,I as Fs,b as $n}from"./LoadingSpinner-aBqTPX38.js";import{u as B}from"./useTranslation-BszJ4SY-.js";import{I as _e}from"./IconAlertTriangle-Dgvaau8t.js";import{I as qt}from"./IconTrash-CJ3XQ8-M.js";import{c as Sa,I as Ji}from"./web-B-H01CmI.js";import{t as Pu}from"./web-B0-GrAVz.js";import{B as ss,k as Re,E as Mt,q as Ge,F as Eu,G as _u,H as Mu}from"./derivation-DaU5Fc54.js";import{p as dt,g as Ki,n as ms,a as Ru}from"./notification-BJvdwJuQ.js";import{g as Pe,N as Gi,o as Lu,q as Dt,u as mr,I as zu}from"./index-CreRbCXK.js";import"./breakpoint-DQ_qwb34.js";import{T as Qi}from"./transaction-item-DSlEkjQE.js";import{A as se}from"./amount-BQsqQYGO.js";import{I as nt}from"./IconPlus-D3C1BIOg.js";import{c as oe}from"./createReactComponent-BcoG-gz6.js";import{I as pn,b as Yi,c as qn,d as Dn,e as Du,g as Bu,f as Ou,h as Wu}from"./transaction-meta-Zi2xJpwV.js";import{I as Fu,i as $u,A as qu}from"./address-input-CKV_5HmU.js";import{A as At}from"./amount-display-lK4f5kKc.js";import"./animated-number-BdCWLope.js";import{T as Hu}from"./time-display-CZi5pY_E.js";import{F as Uu,E as Xi,S as Vu,C as fr}from"./service-status-alert-h_su97V4.js";import{e as Bt,I as Aa,H as je,u as Ju,l as Zi,J as Ku,K as Gu,T as Qu,L as Yu,M as Xu,N as pr,d as Zu,O as hr,P as xr,Q as gr,R as vr,S as yr,U as br,V as jr,W as Nr,X as wr,Y as kr,Z as Cr,_ as em,$ as tm}from"./index-BNYpzxkQ.js";import{b as Ia,i as Ta,l as Ye,o as Is,n as Ot,s as H,c as Ze,a as Xe,j as ls}from"./schemas-CO8_C8zP.js";import{I as sm,a as nm}from"./my-apps-page-Bjv_QsgB.js";import{E as am,c as Ht}from"./ecosystem-desktop-DwnEk1Nt.js";import"./miniapp-splash-screen-MCeXnw62.js";import"./swiper-BuLNzpU1.js";/* empty css                     */import{_ as ht}from"./preload-helper-PPVm8Dsz.js";import{P as U}from"./page-header-oU1hAIek.js";import{C as ds,I as rm}from"./contact-avatar-CIccd5Xf.js";import{I as Te}from"./IconChevronRight-CqaHggk9.js";import{S as ut,a as mt,b as ft,c as pt,u as im,f as om,D as cm,g as lm,h as dm,i as um,j as mm,k as fm,l as pm,m as hm,n as xm}from"./sheet-84DeISEL.js";import{I as xe}from"./IconCheck-CkWppXyE.js";import{C as xt,a as Pa}from"./chain-icon-c7kvVx0o.js";import{p as gt,P as Ut}from"./pattern-lock-BnVm-Pxn.js";import{P as hn}from"./password-input-UBkArAAB.js";import{I as $s}from"./IconLock-BR0NwITG.js";import{I as vt}from"./IconAlertCircle-Dp19wZ50.js";import{F as Ea}from"./fee-display-DA7P_5wN.js";import{T as eo}from"./tx-status-display-Cszl8FWr.js";import{I as De}from"./input-eDyOnTVf.js";import{b as Rt,i as gm,d as vm}from"./avatar-codec-BwHtyUo0.js";import{I as Vt}from"./IconRefresh-CCeB75gJ.js";import{I as qs}from"./IconSearch-g14yvdav.js";import{I as Hs}from"./IconDownload-CmD9nbMJ.js";import{W as ym,r as bm}from"./wallet-mini-card-CyHaRYNI.js";import{I as jm,W as Nm}from"./wallet-list-BAMBDZd4.js";import{C as to}from"./checkbox-DFyJc5Uf.js";import{I as so,S as Ts,a as Ps,b as Es,c as _s,d as Wt,A as no}from"./asset-selector-Cndq94qq.js";import{I as ao}from"./IconChevronDown-VcAwuOLA.js";import{p as ro,g as _a}from"./qr-parser-Ce47OVSU.js";import{c as io}from"./index-BEMrTJQI.js";import{g as wm,a as km,b as Cm}from"./scanner-validators-YRGmuXyx.js";import{I as Us}from"./IconX-RNHCmRZf.js";import{I as Ma}from"./IconWallet-DYMelbVU.js";import{C as Ra}from"./contact-card-v6Ie_xei.js";import{I as Ce}from"./IconLoader2-BDb9epWf.js";import{g as Bn,n as Sm,p as Am}from"./index-DRQXAVdd.js";import{a as cn,c as ln,s as dn,i as Im}from"./bioforest-BrSvoWuc.js";import{I as Tm}from"./IconApps-DKqw56sU.js";import{I as oo}from"./IconShieldCheck-D1h8LOCh.js";import{A as Pt}from"./address-display-DlzR_hmA.js";import{I as La}from"./IconEye-DvT8-XYG.js";import{M as co}from"./mnemonic-display-cYbUjTvB.js";import{P as za}from"./pattern-lock-setup-DPccpdLn.js";import{g as lo,C as Da}from"./chain-selector-CtaHlMCC.js";import{deriveWalletChainAddresses as uo}from"./index-ugvfWuJW.js";import{I as mo}from"./IconEyeOff-DwHZeAEo.js";import{I as us}from"./IconCircleCheck-CcHMgIqG.js";import"./asset-item-DmCi6o2o.js";import"./asset-list-CODP80Kw.js";import{A as fo}from"./amount-input-BcDNVZhi.js";import{B as Pm}from"./balance-display-91p9uEio.js";import{S as Em,I as po}from"./send-result-DCL1T_0g.js";import{d as _m}from"./useRenderElement-BkFxhWus.js";import{T as ho}from"./Trans-BlN3n9SV.js";import{M as Mm}from"./mnemonic-input-DJGliC3G.js";import{T as xo}from"./transaction-list-E0ahJq2Y.js";import{T as Rm}from"./transaction-status-A0Z5DblG.js";import{I as ia}from"./IconExternalLink-D8V3lNy8.js";import{A as go}from"./AppInfoCard-BfEF7Gtu.js";import{P as Lm}from"./PermissionList-DkTFb_0i.js";import{W as zm}from"./wallet-selector-CAwZxGIs.js";import{T as et}from"./token-icon-D714SkAu.js";import{T as Sr}from"./TransactionDetails-CWB5NUxC.js";import{B as Ar}from"./BalanceWarning-CXQm3blI.js";import{K as Dm}from"./key-type-selector-Duc1ajQG.js";import{A as Bm}from"./arbitrary-key-input-FVEviU13.js";import{C as Om}from"./chain-address-preview-FEHTWSCf.js";import{C as Wm}from"./collision-confirm-dialog-Bz1hWwb5.js";import{I as Fm}from"./dropdown-menu-Cr43akFE.js";import"./hologram-canvas-CUABOPdV.js";import{I as $m}from"./IconPencil-p91Yd7iE.js";import{I as qm}from"./IconBell-BvZ2xyQF.js";import{I as Hm}from"./IconCircleX-DW-MLS2c.js";import{I as Um}from"./IconClock-kxgl_G0D.js";import{I as Vm}from"./IconShield-vo3-j-KA.js";const Jm=[["path",{d:"M20 6v12a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2z",key:"svg-0"}],["path",{d:"M10 16h6",key:"svg-1"}],["path",{d:"M13 11m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-2"}],["path",{d:"M4 8h3",key:"svg-3"}],["path",{d:"M4 12h3",key:"svg-4"}],["path",{d:"M4 16h3",key:"svg-5"}]],Km=oe("outline","address-book","AddressBook",Jm);const Gm=[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 15h10.55",key:"svg-1"}],["path",{d:"M6.551 4.938l3.26 10.034",key:"svg-2"}],["path",{d:"M17.032 4.636l-8.535 6.201",key:"svg-3"}],["path",{d:"M20.559 14.51l-8.535 -6.201",key:"svg-4"}],["path",{d:"M12.257 20.916l3.261 -10.034",key:"svg-5"}]],vo=oe("outline","aperture","Aperture",Gm);const Qm=[["path",{d:"M17 7l-10 10",key:"svg-0"}],["path",{d:"M16 17l-9 0l0 -9",key:"svg-1"}]],Ym=oe("outline","arrow-down-left","ArrowDownLeft",Qm);const Xm=[["path",{d:"M7 7l10 10",key:"svg-0"}],["path",{d:"M17 8l0 9l-9 0",key:"svg-1"}]],Zm=oe("outline","arrow-down-right","ArrowDownRight",Xm);const ef=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M13 18l6 -6",key:"svg-1"}],["path",{d:"M13 6l6 6",key:"svg-2"}]],yo=oe("outline","arrow-right","ArrowRight",ef);const tf=[["path",{d:"M17 7l-10 10",key:"svg-0"}],["path",{d:"M8 7l9 0l0 9",key:"svg-1"}]],bo=oe("outline","arrow-up-right","ArrowUpRight",tf);const sf=[["path",{d:"M3 12h1m8 -9v1m8 8h1m-15.4 -6.4l.7 .7m12.1 -.7l-.7 .7",key:"svg-0"}],["path",{d:"M9 16a5 5 0 1 1 6 0a3.5 3.5 0 0 0 -1 3a2 2 0 0 1 -4 0a3.5 3.5 0 0 0 -1 -3",key:"svg-1"}],["path",{d:"M9.7 17l4.6 0",key:"svg-2"}]],jo=oe("outline","bulb","Bulb",sf);const nf=[["path",{d:"M5 7h1a2 2 0 0 0 2 -2a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1a2 2 0 0 0 2 2h1a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-9a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M9 13a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-1"}]],af=oe("outline","camera","Camera",nf);const rf=[["path",{d:"M14 10m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-0"}],["path",{d:"M21 12a9 9 0 1 1 -18 0a9 9 0 0 1 18 0z",key:"svg-1"}],["path",{d:"M12.5 11.5l-4 4l1.5 1.5",key:"svg-2"}],["path",{d:"M12 15l-1.5 -1.5",key:"svg-3"}]],Ba=oe("outline","circle-key","CircleKey",rf);const of=[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M14.8 9a2 2 0 0 0 -1.8 -1h-2a2 2 0 1 0 0 4h2a2 2 0 1 1 0 4h-2a2 2 0 0 1 -1.8 -1",key:"svg-1"}],["path",{d:"M12 7v10",key:"svg-2"}]],cf=oe("outline","coin","Coin",of);const lf=[["path",{d:"M16.7 8a3 3 0 0 0 -2.7 -2h-4a3 3 0 0 0 0 6h4a3 3 0 0 1 0 6h-4a3 3 0 0 1 -2.7 -2",key:"svg-0"}],["path",{d:"M12 3v3m0 12v3",key:"svg-1"}]],df=oe("outline","currency-dollar","CurrencyDollar",lf);const uf=[["path",{d:"M6 12l6 -9l6 9l-6 9z",key:"svg-0"}],["path",{d:"M6 12l6 -3l6 3l-6 2z",key:"svg-1"}]],mf=oe("outline","currency-ethereum","CurrencyEthereum",uf);const ff=[["path",{d:"M12 6m-8 0a8 3 0 1 0 16 0a8 3 0 1 0 -16 0",key:"svg-0"}],["path",{d:"M4 6v6a8 3 0 0 0 16 0v-6",key:"svg-1"}],["path",{d:"M4 12v6a8 3 0 0 0 16 0v-6",key:"svg-2"}]],No=oe("outline","database","Database",ff);const pf=[["path",{d:"M3 5a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v10a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1v-10z",key:"svg-0"}],["path",{d:"M7 20h10",key:"svg-1"}],["path",{d:"M9 16v4",key:"svg-2"}],["path",{d:"M15 16v4",key:"svg-3"}]],hf=oe("outline","device-desktop","DeviceDesktop",pf);const xf=[["path",{d:"M3 3m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["circle",{cx:"8.5",cy:"8.5",r:".5",fill:"currentColor",key:"svg-1"}],["circle",{cx:"15.5",cy:"8.5",r:".5",fill:"currentColor",key:"svg-2"}],["circle",{cx:"15.5",cy:"15.5",r:".5",fill:"currentColor",key:"svg-3"}],["circle",{cx:"8.5",cy:"15.5",r:".5",fill:"currentColor",key:"svg-4"}],["circle",{cx:"12",cy:"12",r:".5",fill:"currentColor",key:"svg-5"}]],gf=oe("outline","dice-5","Dice5",xf);const vf=[["path",{d:"M4 4h16v2.172a2 2 0 0 1 -.586 1.414l-4.414 4.414v7l-6 2v-8.5l-4.48 -4.928a2 2 0 0 1 -.52 -1.345v-2.227z",key:"svg-0"}]],wo=oe("outline","filter","Filter",vf);const yf=[["path",{d:"M18.9 7a8 8 0 0 1 1.1 5v1a6 6 0 0 0 .8 3",key:"svg-0"}],["path",{d:"M8 11a4 4 0 0 1 8 0v1a10 10 0 0 0 2 6",key:"svg-1"}],["path",{d:"M12 11v2a14 14 0 0 0 2.5 8",key:"svg-2"}],["path",{d:"M8 15a18 18 0 0 0 1.8 6",key:"svg-3"}],["path",{d:"M4.9 19a22 22 0 0 1 -.9 -7v-1a8 8 0 0 1 12 -6.95",key:"svg-4"}]],bf=oe("outline","fingerprint","Fingerprint",yf);const jf=[["path",{d:"M7 12h3v4h-3z",key:"svg-0"}],["path",{d:"M10 6h-6a1 1 0 0 0 -1 1v12a1 1 0 0 0 1 1h16a1 1 0 0 0 1 -1v-12a1 1 0 0 0 -1 -1h-6",key:"svg-1"}],["path",{d:"M10 3m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v3a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M14 16h2",key:"svg-3"}],["path",{d:"M14 12h4",key:"svg-4"}]],Nf=oe("outline","id-badge-2","IdBadge2",jf);const wf=[["path",{d:"M9 6.371c0 4.418 -2.239 6.629 -5 6.629",key:"svg-0"}],["path",{d:"M4 6.371h7",key:"svg-1"}],["path",{d:"M5 9c0 2.144 2.252 3.908 6 4",key:"svg-2"}],["path",{d:"M12 20l4 -9l4 9",key:"svg-3"}],["path",{d:"M19.1 18h-6.2",key:"svg-4"}],["path",{d:"M6.694 3l.793 .582",key:"svg-5"}]],kf=oe("outline","language","Language",wf);const Cf=[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]],ko=oe("outline","link","Link",Cf);const Sf=[["path",{d:"M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z",key:"svg-0"}]],Af=oe("outline","moon","Moon",Sf);const If=[["path",{d:"M6 9a6 6 0 1 0 12 0a6 6 0 0 0 -12 0",key:"svg-0"}],["path",{d:"M12 3c1.333 .333 2 2.333 2 6s-.667 5.667 -2 6",key:"svg-1"}],["path",{d:"M12 3c-1.333 .333 -2 2.333 -2 6s.667 5.667 2 6",key:"svg-2"}],["path",{d:"M6 9h12",key:"svg-3"}],["path",{d:"M3 20h7",key:"svg-4"}],["path",{d:"M14 20h7",key:"svg-5"}],["path",{d:"M10 20a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-6"}],["path",{d:"M12 15v3",key:"svg-7"}]],Tf=oe("outline","network","Network",If);const Pf=[["path",{d:"M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25",key:"svg-0"}],["path",{d:"M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}],["path",{d:"M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-3"}]],Ef=oe("outline","palette","Palette",Pf);const _f=[["path",{d:"M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4",key:"svg-0"}],["path",{d:"M13.5 6.5l4 4",key:"svg-1"}],["path",{d:"M16 19h6",key:"svg-2"}]],Mf=oe("outline","pencil-minus","PencilMinus",_f);const Rf=[["path",{d:"M4 4m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M7 17l0 .01",key:"svg-1"}],["path",{d:"M14 4m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M7 7l0 .01",key:"svg-3"}],["path",{d:"M4 14m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-4"}],["path",{d:"M17 7l0 .01",key:"svg-5"}],["path",{d:"M14 14l3 0",key:"svg-6"}],["path",{d:"M20 14l0 .01",key:"svg-7"}],["path",{d:"M14 14l0 3",key:"svg-8"}],["path",{d:"M14 20l3 0",key:"svg-9"}],["path",{d:"M17 17l3 0",key:"svg-10"}],["path",{d:"M20 17l0 3",key:"svg-11"}]],Lf=oe("outline","qrcode","Qrcode",Rf);const zf=[["path",{d:"M10 14l11 -11",key:"svg-0"}],["path",{d:"M21 3l-6.5 18a.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a.55 .55 0 0 1 0 -1l18 -6.5",key:"svg-1"}]],Co=oe("outline","send","Send",zf);const Df=[["path",{d:"M8 9h-1a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-8a2 2 0 0 0 -2 -2h-1",key:"svg-0"}],["path",{d:"M12 14v-11",key:"svg-1"}],["path",{d:"M9 6l3 -3l3 3",key:"svg-2"}]],Bf=oe("outline","share-2","Share2",Df);const Of=[["path",{d:"M6 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-0"}],["path",{d:"M18 6m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-1"}],["path",{d:"M18 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-2"}],["path",{d:"M8.7 10.7l6.6 -3.4",key:"svg-3"}],["path",{d:"M8.7 13.3l6.6 3.4",key:"svg-4"}]],Ms=oe("outline","share","Share",Of);const Wf=[["path",{d:"M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7",key:"svg-1"}]],Ff=oe("outline","sun","Sun",Wf);const $f=[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 9h16.8",key:"svg-1"}],["path",{d:"M3.6 15h16.8",key:"svg-2"}],["path",{d:"M11.5 3a17 17 0 0 0 0 18",key:"svg-3"}],["path",{d:"M12.5 3a17 17 0 0 1 0 18",key:"svg-4"}]],So=oe("outline","world","World",$f);function Oa(){return Sa}function at(){return Pu}function Vs(){return Au}function Ao(){return Iu}const xn={authorizeAddress:"/wallet/authorize/address",authorizeSignature:"/wallet/authorize/signature"};class qf{constructor(s,n){this.adapter=s,this.eventId=n}hasResponded=!1;handleNetworkAddresses(s,n){const a=n.trim().toLowerCase();if(!a)return[];const r=[];for(const o of s)for(const c of o.chainAddresses)String(c.chain).toLowerCase()===a&&r.push({name:o.name,address:c.address,chainName:c.chain,publicKey:"",magic:`${o.id}:${c.chain}`,signMessage:""});return r}handleMainAddresses(s){return s.chainAddresses.map(n=>({name:s.name,address:n.address,chainName:n.chain,publicKey:"",magic:`${s.id}:${n.chain}`,signMessage:""}))}async handleMainAddressesSigned(s,n){const a=this.handleMainAddresses(s);return await this.applySensitiveOptions(a,[s],{password:n.password,signMessage:n.signMessage,getMain:!1})}handleAllAddresses(s){const n=[];for(const a of s)n.push(...this.handleMainAddresses(a));return n}async handleAllAddressesSigned(s,n){const a=this.handleAllAddresses(s);return await this.applySensitiveOptions(a,s,{password:n.password,signMessage:n.signMessage,getMain:!1})}async handleNetworkAddressesSigned(s,n,a){const r=this.handleNetworkAddresses(s,n);return await this.applySensitiveOptions(r,s,{password:a.password,signMessage:a.signMessage,getMain:!1})}async applySensitiveOptions(s,n,a){return await this.applyPasswordProtectedFields(s,n,a)}async approve(s){await this.respondOnce(xn.authorizeAddress,s)}async reject(s){await this.respondOnce(xn.authorizeAddress,null)}async respondOnce(s,n){if(!this.hasResponded){this.hasResponded=!0;try{await this.adapter.respondWith(this.eventId,s,n)}finally{await this.adapter.removeEventId(this.eventId)}}}async applyPasswordProtectedFields(s,n,a){const r=a.signMessage?.trim()??"",o=!!r,c=!!a.getMain;if(!o&&!c)return s;const i=new Map;for(const m of n)i.set(m.id,m);const d=new Map,u=new Set;for(const m of s){const f=this.getWalletIdFromMagic(m.magic),h=i.get(f),x=h?.encryptedMnemonic;if(!h||!x)throw new Error("Missing secret");const b=m.chainName.trim().toLowerCase();if(c){let p=d.get(f);if(!p){try{p=await ss(x,a.password)}catch{throw new Error("Invalid password")}d.set(f,p)}m.main=p}if(o){if(cn(b)){let p=d.get(f);if(!p){try{p=await ss(x,a.password)}catch{throw new Error("Invalid password")}d.set(f,p)}const g=ln(p),v=dn(r,g.secretKey);m.signMessage=`0x${Re(v)}`,m.publicKey=Re(g.publicKey);continue}if(!u.has(f))if(d.has(f))u.add(f);else{if(!await Mt(x,a.password))throw new Error("Invalid password");u.add(f)}m.signMessage=this.createDeterministicMockSignature({message:r,address:m.address,chainName:m.chainName})}}return s}getWalletIdFromMagic(s){const n=s.indexOf(":");return n===-1?s:s.slice(0,n)}createDeterministicMockSignature({message:s,address:n,chainName:a}){const r=new TextEncoder,o=Ge(r.encode(`address:${n}|chain:${a}|message:${s}`)),c=Ge(r.encode(`event:${this.eventId}`)),i=new Uint8Array(64);return i.set(o,0),i.set(c,32),`0x${Re(i)}`}}class Wa{constructor(s,n){this.adapter=s,this.eventId=n}hasResponded=!1;async approve(s){await this.respondOnce(xn.authorizeSignature,s)}async reject(s){await this.respondOnce(xn.authorizeSignature,null)}async handleMessageSign(s,n,a){const r=s.chainName.trim().toLowerCase();if(cn(r)){let c;try{c=await ss(n,a)}catch{throw new Error("Invalid password")}const i=ln(c),d=dn(s.message,i.secretKey);return{signature:`0x${Re(d)}`,publicKey:Re(i.publicKey)}}if(!await Mt(n,a))throw new Error("Invalid password");{const c=new TextEncoder,i=Ge(c.encode(`message:${s.message}`)),d=Ge(c.encode(`event:${this.eventId}`)),u=new Uint8Array(64);u.set(i,0),u.set(d,32);const m=Ge(c.encode(`pubkey:${s.senderAddress}`));return{signature:`0x${Re(u)}`,publicKey:Re(m)}}}async handleTransferSign(s,n,a){const r=s.chainName.trim().toLowerCase(),o=["transfer",r,s.senderAddress,s.receiveAddress,s.balance,s.fee??"",s.contractInfo?.assetType??s.assetType??"",s.contractInfo?.contractAddress??"",s.contractInfo?.decimals?.toString()??""].join("|");if(cn(r)){let f;try{f=await ss(n,a)}catch{throw new Error("Invalid password")}const h=ln(f),x=dn(o,h.secretKey);return`0x${Re(x)}`}if(!await Mt(n,a))throw new Error("Invalid password");const i=new TextEncoder,d=Ge(i.encode(o)),u=Ge(i.encode(`event:${this.eventId}`)),m=new Uint8Array(64);return m.set(d,0),m.set(u,32),`0x${Re(m)}`}async handleDestroySign(s,n,a){const r=s.chainName.trim().toLowerCase(),o=["destory",r,s.senderAddress,s.destoryAddress,s.destoryAmount,s.fee??"",s.assetType??""].join("|");if(cn(r)){let f;try{f=await ss(n,a)}catch{throw new Error("Invalid password")}const h=ln(f),x=dn(o,h.secretKey);return`0x${Re(x)}`}if(!await Mt(n,a))throw new Error("Invalid password");const i=new TextEncoder,d=Ge(i.encode(o)),u=Ge(i.encode(`event:${this.eventId}`)),m=new Uint8Array(64);return m.set(d,0),m.set(u,32),`0x${Re(m)}`}async respondOnce(s,n){if(!this.hasResponded){this.hasResponded=!0;try{await this.adapter.respondWith(this.eventId,s,n)}finally{await this.adapter.removeEventId(this.eventId)}}}}class Hf{async getCallerAppInfo(s){throw new Error("DWEB runtime not available in web environment")}async respondWith(s,n,a){throw new Error("DWEB runtime not available in web environment")}async removeEventId(s){}isAvailable(){return!1}}const rs=new Hf,Uf={"zh-CN":gs.wordlists.chinese_simplified,"zh-TW":gs.wordlists.chinese_traditional,ja:gs.wordlists.japanese,ko:gs.wordlists.korean},Vf=["zh-CN","zh-TW","ja","ko"];function gn(t){const s=Uf[t]??gs.wordlists.english,n=s[Math.floor(Math.random()*s.length)];return Vf.includes(t)?n:n.charAt(0).toUpperCase()+n.slice(1)}function Jf(){return typeof window>"u"}function Xs(){return!Jf()}function Kf(){const t={value:null};function s(){return t.value}function n(a){t.value=a}return[s,n]}var Hn,Ir;function Gf(){if(Ir)return Hn;Ir=1;var t=typeof Element<"u",s=typeof Map=="function",n=typeof Set=="function",a=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function r(o,c){if(o===c)return!0;if(o&&c&&typeof o=="object"&&typeof c=="object"){if(o.constructor!==c.constructor)return!1;var i,d,u;if(Array.isArray(o)){if(i=o.length,i!=c.length)return!1;for(d=i;d--!==0;)if(!r(o[d],c[d]))return!1;return!0}var m;if(s&&o instanceof Map&&c instanceof Map){if(o.size!==c.size)return!1;for(m=o.entries();!(d=m.next()).done;)if(!c.has(d.value[0]))return!1;for(m=o.entries();!(d=m.next()).done;)if(!r(d.value[1],c.get(d.value[0])))return!1;return!0}if(n&&o instanceof Set&&c instanceof Set){if(o.size!==c.size)return!1;for(m=o.entries();!(d=m.next()).done;)if(!c.has(d.value[0]))return!1;return!0}if(a&&ArrayBuffer.isView(o)&&ArrayBuffer.isView(c)){if(i=o.length,i!=c.length)return!1;for(d=i;d--!==0;)if(o[d]!==c[d])return!1;return!0}if(o.constructor===RegExp)return o.source===c.source&&o.flags===c.flags;if(o.valueOf!==Object.prototype.valueOf&&typeof o.valueOf=="function"&&typeof c.valueOf=="function")return o.valueOf()===c.valueOf();if(o.toString!==Object.prototype.toString&&typeof o.toString=="function"&&typeof c.toString=="function")return o.toString()===c.toString();if(u=Object.keys(o),i=u.length,i!==Object.keys(c).length)return!1;for(d=i;d--!==0;)if(!Object.prototype.hasOwnProperty.call(c,u[d]))return!1;if(t&&o instanceof Element)return!1;for(d=i;d--!==0;)if(!((u[d]==="_owner"||u[d]==="__v"||u[d]==="__o")&&o.$$typeof)&&!r(o[u[d]],c[u[d]]))return!1;return!0}return o!==o&&c!==c}return Hn=function(c,i){try{return r(c,i)}catch(d){if((d.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw d}},Hn}var Qf=Gf();const ys=nu(Qf);function Io(t){const s=l.useRef(t),n=s.current,a=ys(n,t);return l.useEffect(()=>{a||(s.current=t)},[t]),a?n:t}var Fa=l.createContext(null),To=({children:t,value:s})=>e.jsx(Fa.Provider,{value:Io(s),children:t});To.displayName="ActivityProvider";var Yf=()=>l.useContext(Fa);function Xf(){return l.useContext(Fa).params}var Po=l.createContext(null),Eo=({children:t,value:s})=>e.jsx(Po.Provider,{value:Io(s),children:t});Eo.displayName="StackProvider";var Zf=()=>l.useContext(Po),ep=Object.defineProperty,tp=Object.defineProperties,sp=Object.getOwnPropertyDescriptors,vn=Object.getOwnPropertySymbols,_o=Object.prototype.hasOwnProperty,Mo=Object.prototype.propertyIsEnumerable,Tr=(t,s,n)=>s in t?ep(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,fe=(t,s)=>{for(var n in s||(s={}))_o.call(s,n)&&Tr(t,n,s[n]);if(vn)for(var n of vn(s))Mo.call(s,n)&&Tr(t,n,s[n]);return t},ge=(t,s)=>tp(t,sp(s)),np=(t,s)=>{var n={};for(var a in t)_o.call(t,a)&&s.indexOf(a)<0&&(n[a]=t[a]);if(t!=null&&vn)for(var a of vn(t))s.indexOf(a)<0&&Mo.call(t,a)&&(n[a]=t[a]);return n};function ap(t,s,n){const a=n(t),r=n(s);return a<r?-1:a===r?0:1}var rp=(t,s)=>{const n=[],a=[];return t.forEach(r=>{s(r)?n.push(r):a.push(r)}),[n,a]};function Ro(t,s){return t.map((n,a)=>s(n)?a:void 0).filter(n=>typeof n=="number")}var Un=0,Pr=0,Lo=()=>{const t=new Date().getTime();return Pr===t?Un+=1:(Pr=t,Un=0),(t*1e3+Un)/1e3};function Qe(){return(Lo()*1e3).toString(16)}function On(t){return t.length===0?void 0:t[t.length-1]}function Er(t,s){const n=fe({},t);return s.forEach(a=>{delete n[a]}),n}function ip(t){let s=!1;return()=>{s||(s=!0,t())}}function op(t,s){const n=new Map;return[...t].reverse().filter(a=>{const r=s(a);if(r===null)return!0;const o=!!n.get(r);return n.set(r,!0),!o}).reverse()}function oa(t){return!t.exitedBy}function ca(t,s){return s.enteredBy.eventDate-t.enteredBy.eventDate}function _r(t){return t.filter(oa).sort(ca)[0]}function cp(t,s,n){const a=[];switch(s.name){case"Replaced":{if(On(Ro(t,d=>d.id===s.activityId))!==void 0)break;const o=t.slice().sort(ca).filter(oa),c=n.now-s.eventDate>=n.transitionDuration;if((s.skipEnterActiveState||c?"enter-done":"enter-active")==="enter-done"){const d=o.findIndex(u=>!(s.skipEnterActiveState&&u.enteredBy.name==="Replaced"&&u.transitionState==="enter-active"));return o.slice(0,d+1).map(u=>t.indexOf(u))}break}case"Popped":{const r=t.filter(oa).sort(ca),o=r.slice(0,r.length-1)[0];o&&a.push(t.indexOf(o));break}case"StepPushed":case"StepReplaced":{const r=_r(t);if(r){if(s.targetActivityId&&s.targetActivityId!==r.id)break;a.push(t.indexOf(r))}break}case"StepPopped":{const r=_r(t);if(r&&r.steps.length>1){if(s.targetActivityId&&s.targetActivityId!==r.id)break;a.push(t.indexOf(r))}break}}return a}function Mr(t,s){switch(s.name){case"Pushed":case"Replaced":{const n=On(Ro(t,a=>a.id===s.activityId));return n??t.length}default:return-1}}function Rr(t,s){return{id:t.activityId,name:t.activityName,transitionState:s,params:t.activityParams,context:t.activityContext,steps:[{id:t.activityId,params:t.activityParams,enteredBy:t,zIndex:-1}],enteredBy:t,isTop:!1,isActive:!1,isRoot:!1,zIndex:-1}}function $a(t){return(s,n)=>{const a=t[n.name].bind(t);if(a)return a(s,n);throw new Error(`No reducer for event ${JSON.stringify(n)}`)}}function rt(t){return t}function lp({transitionDuration:t,now:s,resumedAt:n}){return $a({Pushed(a,r){const o=s-(n??r.eventDate)>=t,c=r.skipEnterActiveState||o?"enter-done":"enter-active",i=Mr(a,r);return[...a.slice(0,i),Rr(r,c),...a.slice(i+1)]},Replaced(a,r){var o,c;const i=s-(n??r.eventDate)>=t,d=Mr(a,r),u=(c=(o=a[d])==null?void 0:o.transitionState)!=null?c:r.skipEnterActiveState||i?"enter-done":"enter-active";return[...a.slice(0,d),Rr(r,u),...a.slice(d+1)]},Initialized:rt,ActivityRegistered:rt,Popped:rt,StepPushed:rt,StepReplaced:rt,StepPopped:rt,Paused:rt,Resumed:rt})}function fs(t){return t}function dp(t){return $a({Replaced:(s,n)=>ge(fe({},s),{exitedBy:n,transitionState:"exit-done"}),Popped:(s,n)=>{var a;const r=t.now-((a=t.resumedAt)!=null?a:n.eventDate)>=t.transitionDuration,o=n.skipExitActiveState||r?"exit-done":"exit-active";return ge(fe({},s),{exitedBy:n,transitionState:o,params:o==="exit-done"?s.steps[0].params:s.params,steps:o==="exit-done"?[s.steps[0]]:s.steps})},StepPushed:(s,n)=>{var a;const r={id:n.stepId,params:n.stepParams,enteredBy:n,zIndex:s.zIndex,hasZIndex:(a=n.hasZIndex)!=null?a:!1};return ge(fe({},s),{params:n.stepParams,steps:[...s.steps,r]})},StepReplaced:(s,n)=>{var a;const r={id:n.stepId,params:n.stepParams,enteredBy:n,zIndex:s.zIndex,hasZIndex:(a=n.hasZIndex)!=null?a:!1};return ge(fe({},s),{params:n.stepParams,steps:[...s.steps.slice(0,s.steps.length-1),r]})},StepPopped:(s,n)=>{var a;s.steps.pop();const r=(a=On(s.steps))==null?void 0:a.params;return ge(fe({},s),{params:r??s.params})},Initialized:fs,ActivityRegistered:fs,Pushed:fs,Paused:fs,Resumed:fs})}function Ke(t){return(s,n)=>s.globalTransitionState==="paused"?ge(fe({},s),{pausedEvents:s.pausedEvents?[...s.pausedEvents,n]:[n]}):t(s,n)}function Oe(t,s){return(n,a)=>{const r=lp({transitionDuration:n.transitionDuration,now:s.now,resumedAt:s.resumedAt}),o=dp({transitionDuration:n.transitionDuration,now:s.now,resumedAt:s.resumedAt}),c=r(n.activities,a),i=cp(n.activities,a,{transitionDuration:n.transitionDuration,now:s.now});for(const m of i)c[m]=o(c[m],a);const d=c.find(m=>m.transitionState==="enter-active"||m.transitionState==="exit-active"),u=n.globalTransitionState==="paused"?"paused":d?"loading":"idle";return t(ge(fe({},n),{activities:c,globalTransitionState:u}),a)}}function Qt(t,s){return ge(fe({},t),{events:[...t.events,s]})}function zo(t){return $a({Initialized:Ke(Oe((s,n)=>ge(fe({},s),{transitionDuration:n.transitionDuration,events:[...s.events,n]}),t)),ActivityRegistered:Ke(Oe((s,n)=>ge(fe({},s),{registeredActivities:[...s.registeredActivities,fe({name:n.activityName},n.activityParamsSchema?{paramsSchema:n.activityParamsSchema}:null)],events:[...s.events,n]}),t)),Paused:Ke(Oe((s,n)=>ge(fe({},s),{globalTransitionState:"paused",events:[...s.events,n]}),t)),Resumed:Oe((s,n)=>{if(s.globalTransitionState!=="paused"||!s.pausedEvents)return ge(fe({},s),{events:[...s.events,n]});const a=zo({now:t.now,resumedAt:n.eventDate}),r=s,{pausedEvents:o}=r,c=np(r,["pausedEvents"]),i=o.reduce(a,ge(fe({},c),{globalTransitionState:"idle"}));return ge(fe({},i),{events:[...i.events,n]})},t),Pushed:Ke(Oe(Qt,t)),Replaced:Ke(Oe(Qt,t)),Popped:Ke(Oe(Qt,t)),StepPushed:Ke(Oe(Qt,t)),StepReplaced:Ke(Oe(Qt,t)),StepPopped:Ke(Oe(Qt,t))})}function Vn(t,s){return t.filter(n=>n.name===s)}function un(t,s){return ge(fe({id:Qe(),eventDate:Lo()},s),{name:t})}function up(t){if(t.length===0)throw new Error("events parameter is empty");if(Vn(t,"Initialized").length>1)throw new Error("InitializedEvent can only exist once");const n=Vn(t,"ActivityRegistered"),a=new Set(n.map(o=>o.activityName));if(Vn(t,"Pushed").some(o=>!a.has(o.activityName)))throw new Error("the corresponding activity does not exist")}function Jn(t,s){const n=op([...t].sort((m,f)=>m.eventDate-f.eventDate),m=>m.id);up(n);const a=zo({now:s}),r=n.reduce(a,{activities:[],globalTransitionState:"idle",registeredActivities:[],transitionDuration:0,events:[]}),o=r.activities.filter(m=>m.transitionState==="enter-active"||m.transitionState==="enter-done"||m.transitionState==="exit-active"),c=o.filter(m=>m.transitionState==="enter-active"||m.transitionState==="enter-done"),i=o[o.length-1],d=c[c.length-1];return ge(fe({},r),{activities:r.activities.map(m=>{let f=o.findIndex(({id:b})=>b===m.id);const h=o.slice(0,f);for(const b of h)for(const p of b.steps)p.hasZIndex&&(f+=1);const x=m.steps.reduce((b,p)=>{var g;const v=On(b),j=(g=v?.zIndex)!=null?g:f;return[...b,ge(fe({},p),{zIndex:j+(p.hasZIndex?1:0)})]},[]);return fe(fe({id:m.id,name:m.name,transitionState:m.transitionState,params:m.params,steps:x,enteredBy:m.enteredBy,zIndex:f,isTop:i?.id===m.id,isActive:d?.id===m.id,isRoot:f===0||f===1&&m.transitionState==="enter-active"&&m.enteredBy.name==="Replaced"},m.exitedBy?{exitedBy:m.exitedBy}:null),m.context?{context:m.context}:null)}).sort((m,f)=>ap(m,f,h=>h.id))})}function mp(t,s){var n,a,r,o,c,i,d,u;const m=[];!ys(t,s)&&m.push({_TAG:"%SOMETHING_CHANGED%"});const h=t.globalTransitionState!=="paused"&&s.globalTransitionState==="paused",x=t.globalTransitionState==="paused"&&s.globalTransitionState!=="paused";h&&m.push({_TAG:"PAUSED"}),x&&m.push({_TAG:"RESUMED"});for(let b=0;b<Math.max(t.activities.length,s.activities.length);b+=1){const p=t.activities[b],g=s.activities[b],v=p?.transitionState==="exit-done"||p?.transitionState==="exit-active",j=g?.transitionState==="enter-active"||g?.transitionState==="enter-done";if(p&&g&&p.id===g.id)for(let N=0;N<Math.max(((n=p.steps)!=null?n:[]).length,((a=g.steps)!=null?a:[]).length);N+=1){const y=p.steps[N],C=g.steps[N];!y&&C?m.push({_TAG:"STEP_PUSHED",activity:g,step:C}):y&&!C?m.push({_TAG:"STEP_POPPED",activity:g}):p.steps.length===g.steps.length&&y.id!==C.id&&m.push({_TAG:"STEP_REPLACED",activity:g,step:C})}!p&&g?m.push({_TAG:g.enteredBy.name==="Pushed"?"PUSHED":"REPLACED",activity:g}):v&&j?m.push({_TAG:g.enteredBy.name==="Pushed"?"PUSHED":"REPLACED",activity:g}):p&&g&&p.id===g.id&&!ys(Er(p,["isActive","isTop","isRoot","transitionState","zIndex"]),Er(g,["isActive","isTop","isRoot","transitionState","zIndex"]))&&g.enteredBy.name==="Replaced"&&!ys(p.enteredBy,g.enteredBy)&&m.push({_TAG:"REPLACED",activity:g})}for(let b=Math.max(t.activities.length,s.activities.length)-1;b>=0;b-=1){const p=((r=t.activities[b])==null?void 0:r.transitionState)==="enter-done"||((o=t.activities[b])==null?void 0:o.transitionState)==="enter-active",g=((c=s.activities[b])==null?void 0:c.transitionState)==="exit-active"||((i=s.activities[b])==null?void 0:i.transitionState)==="exit-done",v=((d=s.activities[b+1])==null?void 0:d.enteredBy.name)==="Replaced"&&((u=s.activities[b+1])==null?void 0:u.transitionState)==="enter-done";p&&g&&!v&&m.push({_TAG:"POPPED",activity:s.activities[b]})}return m}var fp={Pushed:"onBeforePush",Replaced:"onBeforeReplace",Popped:"onBeforePop",StepPushed:"onBeforeStepPush",StepReplaced:"onBeforeStepReplace",StepPopped:"onBeforeStepPop",Paused:"onBeforePause",Resumed:"onBeforeResume"};function it(t,s,n,a){let r=!1,o=fe({},s);for(const c of n){const i=c[fp[t]];i&&i({actionParams:fe({},o),actions:ge(fe({},a),{preventDefault:()=>{r=!0},overrideActionParams:d=>{o=fe(fe({},o),d)}})})}return{isPrevented:r,nextActionParams:o}}function pp({dispatchEvent:t,pluginInstances:s,actions:n}){return{push(a){const{isPrevented:r,nextActionParams:o}=it("Pushed",a,s,n);r||t("Pushed",o)},replace(a){const{isPrevented:r,nextActionParams:o}=it("Replaced",a,s,n);r||t("Replaced",o)},pop(a={}){const{isPrevented:r,nextActionParams:o}=it("Popped",a,s,n);r||t("Popped",o)},stepPush(a){const{isPrevented:r,nextActionParams:o}=it("StepPushed",a,s,n);r||t("StepPushed",o)},stepReplace(a){const{isPrevented:r,nextActionParams:o}=it("StepReplaced",a,s,n);r||t("StepReplaced",o)},stepPop(a={}){const{isPrevented:r,nextActionParams:o}=it("StepPopped",a,s,n);r||t("StepPopped",o)},pause(a={}){const{isPrevented:r,nextActionParams:o}=it("Paused",a,s,n);r||t("Paused",o)},resume(a={}){const{isPrevented:r,nextActionParams:o}=it("Resumed",a,s,n);r||t("Resumed",o)}}}function hp(t,s,n){t.forEach(a=>{s.forEach(r=>{var o,c,i,d,u,m,f,h,x;switch(a._TAG){case"PUSHED":(o=r.onPushed)==null||o.call(r,{actions:n,effect:a});break;case"REPLACED":(c=r.onReplaced)==null||c.call(r,{actions:n,effect:a});break;case"POPPED":(i=r.onPopped)==null||i.call(r,{actions:n,effect:a});break;case"STEP_PUSHED":(d=r.onStepPushed)==null||d.call(r,{actions:n,effect:a});break;case"STEP_REPLACED":(u=r.onStepReplaced)==null||u.call(r,{actions:n,effect:a});break;case"STEP_POPPED":(m=r.onStepPopped)==null||m.call(r,{actions:n,effect:a});break;case"PAUSED":(f=r.onPaused)==null||f.call(r,{actions:n,effect:a});break;case"RESUMED":(h=r.onResumed)==null||h.call(r,{actions:n,effect:a});break;case"%SOMETHING_CHANGED%":(x=r.onChanged)==null||x.call(r,{actions:n,effect:a});break}})})}var xp=1e3,gp=xp/60;function Lr(t){var s,n,a,r;const o=[],i=[{key:"@stackflow/core",onChanged(){o.forEach(g=>g())}},...t.plugins.map(g=>g())],[d,u]=rp(t.initialEvents,g=>g.name==="Pushed"||g.name==="StepPushed"),m=i.reduce((g,v)=>{var j,N,y;return(y=(N=v.overrideInitialEvents)==null?void 0:N.call(v,{initialEvents:g,initialContext:(j=t.initialContext)!=null?j:{}}))!=null?y:g},d);m.length>0&&d.length>0&&m!==d&&((n=(s=t.handlers)==null?void 0:s.onInitialActivityIgnored)==null||n.call(s,m)),m.length===0&&((r=(a=t.handlers)==null?void 0:a.onInitialActivityNotFound)==null||r.call(a));const h={value:[...u,...m]},x={value:Jn(h.value,new Date().getTime())},b={getStack(){return x.value},dispatchEvent(g,v){const j=un(g,v),N=Jn([...h.value,j],new Date().getTime());h.value.push(j),p(N);const y=setInterval(()=>{const C=Jn(h.value,new Date().getTime());ys(x.value,C)||p(C),C.globalTransitionState==="idle"&&clearInterval(y)},gp)},push:()=>{},replace:()=>{},pop:()=>{},stepPush:()=>{},stepReplace:()=>{},stepPop:()=>{},pause:()=>{},resume:()=>{}},p=g=>{const v=mp(x.value,g);x.value=g,hp(v,i,b)};return Object.assign(b,pp({dispatchEvent:b.dispatchEvent,pluginInstances:i,actions:b})),{actions:b,init:ip(()=>{i.forEach(g=>{var v;(v=g.onInit)==null||v.call(g,{actions:b})})}),pullEvents:()=>h.value,subscribe(g){return o.push(g),function(){const j=o.findIndex(N=>N===g);j>-1&&o.splice(j,1)}},pluginInstances:i}}var Do=l.createContext(null);function vp(){const t=l.useContext(Do);if(t===null)throw new Error("useActivityComponentMap must be used within ActivityComponentMapProvider");return t}function yp({children:t,value:s}){return e.jsx(Do.Provider,{value:s,children:t})}var yn=t=>s=>s.find(({id:n})=>n===t);function bp(t){return!t.exitedBy}function jp(t,s){return s.enteredBy.eventDate-t.enteredBy.eventDate}function bn(t){return t.filter(bp).sort(jp)[0]}function Et(){return Qe()}function jn(){return Qe()}var zr,Np=(zr=ba.useDeferredValue)!=null?zr:t=>t,Dr,wp=(Dr=ba.useSyncExternalStore)!=null?Dr:(t,s)=>{const[n,a]=l.useState(()=>s());return l.useEffect(()=>t(()=>{a(()=>s())})),n},Br,Bo=(Br=ba.useTransition)!=null?Br:()=>[!1,t=>t()],Oo=l.createContext(null),Wo=l.createContext(null),Fo=({coreStore:t,children:s})=>{const n=wp(t.subscribe,t.actions.getStack,t.actions.getStack),a=Np(n);return e.jsx(Wo.Provider,{value:a,children:e.jsx(Oo.Provider,{value:t.actions,children:s})})};Fo.displayName="CoreProvider";var $o=()=>l.useContext(Oo),qo=()=>l.useContext(Wo),Ho=l.createContext(null),Uo=({children:t,value:s})=>e.jsx(Ho.Provider,{value:s,children:t});Uo.displayName="PluginsProvider";function Vo(){return l.useContext(Ho)}function kp(t){return typeof t=="object"&&t!==null&&"then"in t&&typeof t.then=="function"}var be={PENDING:"pending",FULFILLED:"fulfilled",REJECTED:"rejected"};function qa(t){if(t.status===be.PENDING)return{status:be.PENDING};if(t.status===be.FULFILLED&&"value"in t)return{status:be.FULFILLED,value:t.value};if(t.status===be.REJECTED&&"reason"in t)return{status:be.REJECTED,reason:t.reason};throw new Error("Invalid promise state")}function Cp(t){if("status"in t&&Object.values(be).some(n=>n===t.status))return t;const s=Object.assign(t,{status:be.PENDING});return s.then(n=>{s.status=be.FULFILLED,s.value=n},n=>{s.status=be.REJECTED,s.reason=n}),s}function mn(t){return kp(t)?Cp(t instanceof Promise?t:Promise.resolve(t)):Object.assign(Promise.resolve(t),{status:be.FULFILLED,value:t})}function Sp(t){return Object.assign(Promise.reject(t),{status:be.REJECTED,reason:t})}function Ap(t){const s=mn(t),n=qa(s);if(n.status===be.FULFILLED)return n.value;throw n.status===be.REJECTED?n.reason:s}var Ip=Object.defineProperty,Or=Object.getOwnPropertySymbols,Tp=Object.prototype.hasOwnProperty,Pp=Object.prototype.propertyIsEnumerable,Wr=(t,s,n)=>s in t?Ip(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Ep=(t,s)=>{for(var n in s||(s={}))Tp.call(s,n)&&Wr(t,n,s[n]);if(Or)for(var n of Or(s))Pp.call(s,n)&&Wr(t,n,s[n]);return t},_p=(t,s,n)=>new Promise((a,r)=>{var o=d=>{try{i(n.next(d))}catch(u){r(u)}},c=d=>{try{i(n.throw(d))}catch(u){r(u)}},i=d=>d.done?a(d.value):Promise.resolve(d.value).then(o,c);i((n=n.apply(t,s)).next())});function Mp(t){let s=null;const n=()=>((!s||qa(s).status===be.REJECTED)&&(s=t()),s);return{Component:r=>{const{default:o}=Ap(n());return e.jsx(o,Ep({},r))},preload:()=>_p(this,null,function*(){yield n()})}}var Rp=Symbol("STRUCTURED_ACTIVITY_COMPONENT_TYPE");function Lp(t){return t!==null&&typeof t=="object"&&Rp in t}var Kn=new WeakMap;function zp(t){if(Kn.has(t))return Kn.get(t);const{Component:s}=Mp(()=>{const n=t.content,a=mn(typeof n=="function"?n():{default:n}),r=qa(a);return r.status===be.FULFILLED?mn({default:r.value.default.component}):r.status===be.REJECTED?Sp(r.reason):mn(a.then(o=>({default:o.default.component})))});return Kn.set(t,s),s}var Dp=Object.defineProperty,Bp=Object.defineProperties,Op=Object.getOwnPropertyDescriptors,Fr=Object.getOwnPropertySymbols,Wp=Object.prototype.hasOwnProperty,Fp=Object.prototype.propertyIsEnumerable,la=(t,s,n)=>s in t?Dp(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,kt=(t,s)=>{for(var n in s||(s={}))Wp.call(s,n)&&la(t,n,s[n]);if(Fr)for(var n of Fr(s))Fp.call(s,n)&&la(t,n,s[n]);return t},Gn=(t,s)=>Bp(t,Op(s)),$r=(t,s,n)=>la(t,typeof s!="symbol"?s+"":s,n),Jo=({plugin:t,initialContext:s})=>{const n=vp(),a=qo(),r=Vo();return t.render({stack:Gn(kt({},a),{render(o){return{activities:kt(kt({},a),o).activities.map(i=>Gn(kt({},i),{key:i.id,render(d){const u=n[i.name];let m=Lp(u)?qp(u,i.params):e.jsx(u,{params:i.params});return r.forEach(f=>{var h,x;m=(x=(h=f.wrapActivity)==null?void 0:h.call(f,{activity:Gn(kt({},i),{render:()=>m}),initialContext:s}))!=null?x:m}),e.jsx(To,{value:kt(kt({},i),d),children:m},i.id)}}))}}}),initialContext:s})};Jo.displayName="PluginRenderer";var $p=Jo;function qp(t,s){const{layout:n,loading:a,errorHandler:r}=t,o=zp(t);return[i=>a?.component?e.jsx(l.Suspense,{fallback:e.jsx(a.component,{params:s}),children:i}):i,i=>{var d;if(!r)return i;const u=(d=r.boundary)!=null?d:Hp;return e.jsx(u,{renderFallback:(m,f)=>e.jsx(r.component,{params:s,error:m,reset:f}),children:i})},i=>n?.component?e.jsx(n.component,{params:s,children:i}):i].reduce((i,d)=>d(i),e.jsx(o,{params:s}))}var Hp=class extends l.Component{constructor(){super(...arguments),$r(this,"state",{hasError:!1,error:null}),$r(this,"reset",()=>this.setState({hasError:!1,error:null}))}render(){return this.state.hasError?this.props.renderFallback(this.state.error,this.reset):this.props.children}static getDerivedStateFromError(t){return{hasError:!0,error:t}}},Up=Object.defineProperty,Vp=Object.defineProperties,Jp=Object.getOwnPropertyDescriptors,qr=Object.getOwnPropertySymbols,Kp=Object.prototype.hasOwnProperty,Gp=Object.prototype.propertyIsEnumerable,Hr=(t,s,n)=>s in t?Up(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Qp=(t,s)=>{for(var n in s||(s={}))Kp.call(s,n)&&Hr(t,n,s[n]);if(qr)for(var n of qr(s))Gp.call(s,n)&&Hr(t,n,s[n]);return t},Yp=(t,s)=>Vp(t,Jp(s)),Ko=({initialContext:t})=>{const s=qo(),n=Vo(),a=n.filter(o=>!!o.render);l.useEffect(()=>{a.length===0&&console.warn(`Stackflow - There is no rendering plugin, so "<Stack />" doesn't render anything. If you want to render some UI, use "@stackflow/plugin-renderer-basic" or add another rendering plugin.`)},[a]);let r=e.jsx(e.Fragment,{children:a.map(o=>e.jsx($p,{plugin:o,initialContext:t},o.key))});return n.forEach(o=>{var c,i;r=(i=(c=o.wrapStack)==null?void 0:c.call(o,{stack:Yp(Qp({},s),{render(){return r}}),initialContext:t}))!=null?i:r}),e.jsx(Eo,{value:s,children:r})};Ko.displayName="MainRenderer";var Xp=Ko,Zp=Object.defineProperty,Ur=Object.getOwnPropertySymbols,eh=Object.prototype.hasOwnProperty,th=Object.prototype.propertyIsEnumerable,Vr=(t,s,n)=>s in t?Zp(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Jr=(t,s)=>{for(var n in s||(s={}))eh.call(s,n)&&Vr(t,n,s[n]);if(Ur)for(var n of Ur(s))th.call(s,n)&&Vr(t,n,s[n]);return t};function Qn(t){return t?t.animate==null?{skipActiveState:!1}:{skipActiveState:!t.animate}:{skipActiveState:!1}}function Js(){const t=$o(),[s]=Bo();return l.useMemo(()=>({pending:s,push(n,a,r){const o=Et();return t?.push({activityId:o,activityName:n,activityParams:a,skipEnterActiveState:Qn(r).skipActiveState}),{activityId:o}},replace(n,a,r){var o;const c=Et();return t?.replace({activityId:(o=r?.activityId)!=null?o:Et(),activityName:n,activityParams:a,skipEnterActiveState:Qn(r).skipActiveState}),{activityId:c}},pop(n,a){let r=1,o={};typeof n=="object"&&(o=Jr({},n)),typeof n=="number"&&(r=n),a&&(o=Jr({},a));for(let c=0;c<r;c+=1)t?.pop({skipExitActiveState:c===0?Qn(o).skipActiveState:!0})}}),[t?.push,t?.replace,t?.pop,s])}var sh=()=>{const t=$o(),[s]=Bo();return l.useMemo(()=>({pending:s,stepPush(n,a){const r=t?.getStack().activities,o=a?.targetActivityId?yn(a.targetActivityId):bn,c=r&&o(r);if(!c)throw new Error("The target activity is not found.");const i=typeof n=="function"?n(c.params):n,d=jn();t?.stepPush({stepId:d,stepParams:i,targetActivityId:a?.targetActivityId})},stepReplace(n,a){const r=t?.getStack().activities,o=a?.targetActivityId?yn(a.targetActivityId):bn,c=r&&o(r);if(!c)throw new Error("The target activity is not found.");const i=typeof n=="function"?n(c.params):n,d=jn();t?.stepReplace({stepId:d,stepParams:i,targetActivityId:a?.targetActivityId})},stepPop(n){t?.stepPop({targetActivityId:n?.targetActivityId})}}),[t?.stepPush,t?.stepReplace,t?.stepPop,t?.getStack,s])},nh=Object.defineProperty,ah=Object.defineProperties,rh=Object.getOwnPropertyDescriptors,Kr=Object.getOwnPropertySymbols,ih=Object.prototype.hasOwnProperty,oh=Object.prototype.propertyIsEnumerable,Gr=(t,s,n)=>s in t?nh(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Zs=(t,s)=>{for(var n in s||(s={}))ih.call(s,n)&&Gr(t,n,s[n]);if(Kr)for(var n of Kr(s))oh.call(s,n)&&Gr(t,n,s[n]);return t},ch=(t,s)=>ah(t,rh(s));function Yn(t){return t?t.animate==null?{skipActiveState:!1}:{skipActiveState:!t.animate}:{skipActiveState:!1}}function lh(t){var s;const n=((s=t.plugins)!=null?s:[]).flat(Number.POSITIVE_INFINITY).map(u=>u),a=Object.entries(t.activities).reduce((u,[m,f])=>ch(Zs({},u),{[m]:"component"in f?f.component:f}),{}),r=()=>new Date().getTime()-t.transitionDuration*2,o=Lr({initialEvents:[un("Initialized",{transitionDuration:t.transitionDuration,eventDate:r()}),...Object.entries(t.activities).map(([u,m])=>un("ActivityRegistered",Zs({activityName:u,eventDate:r()},"component"in m?{activityParamsSchema:m.paramsSchema}:null)))],plugins:[]}),[c,i]=Kf(),d=l.memo(u=>{const m=l.useMemo(()=>{const f=c();if(Xs()&&f)return f;const h=t.initialActivity?[un("Pushed",{activityId:Et(),activityName:t.initialActivity(),activityParams:{},eventDate:r(),skipEnterActiveState:!1})]:[],x=Lr({initialEvents:[...o.pullEvents(),...h],initialContext:u.initialContext,plugins:n,handlers:{onInitialActivityIgnored:b=>{Xs()&&console.warn(`Stackflow - Some plugin overrides an "initialActivity" option. The "initialActivity" option you set to "${b[0].activityName}" in the "stackflow" is ignored.`)},onInitialActivityNotFound:()=>{Xs()&&console.warn("Stackflow - There is no initial activity. If you want to set the initial activity, add the `initialActivity` option of the `stackflow()` function or add a plugin that sets the initial activity. (e.g. `@stackflow/plugin-history-sync`)")}}});return Xs()&&(x.init(),i(x)),x},[]);return e.jsx(Uo,{value:m.pluginInstances,children:e.jsx(Fo,{coreStore:m,children:e.jsx(yp,{value:a,children:e.jsx(Xp,{initialContext:u.initialContext})})})})});return d.displayName="Stack",{activities:t.activities,Stack:d,useFlow:Js,useStepFlow:sh,addActivity(u){if(c()){console.warn("Stackflow - `addActivity()` API cannot be called after a `<Stack />` component has been rendered");return}a[u.name]=l.memo(u.component),o.actions.dispatchEvent("ActivityRegistered",{activityName:u.name,activityParamsSchema:u.paramsSchema,eventDate:r()})},addPlugin(u){if(c()){console.warn("Stackflow - `addPlugin()` API cannot be called after a `<Stack />` component has been rendered");return}[u].flat(Number.POSITIVE_INFINITY).map(m=>m).forEach(m=>{n.push(m)})},actions:{getStack(){var u,m;return(m=(u=c())==null?void 0:u.actions.getStack())!=null?m:o.actions.getStack()},dispatchEvent(u,m){var f;return(f=c())==null?void 0:f.actions.dispatchEvent(u,m)},push(u,m,f){var h;const x=Et();return(h=c())==null||h.actions.push({activityId:x,activityName:u,activityParams:m,skipEnterActiveState:Yn(f).skipActiveState}),{activityId:x}},replace(u,m,f){var h,x,b;const p=(h=f?.activityId)!=null?h:Et();return(b=c())==null||b.actions.replace({activityId:(x=f?.activityId)!=null?x:Et(),activityName:u,activityParams:m,skipEnterActiveState:Yn(f).skipActiveState}),{activityId:p}},pop(u,m){var f;let h=1,x={};typeof u=="object"&&(x=Zs({},u)),typeof u=="number"&&(h=u),m&&(x=Zs({},m));for(let b=0;b<h;b+=1)(f=c())==null||f.actions.pop({skipExitActiveState:b===0?Yn(x).skipActiveState:!0})},stepPush(u,m){var f,h;const x=(f=c())==null?void 0:f.actions.getStack().activities,b=m?.targetActivityId?yn(m.targetActivityId):bn,p=x&&b(x);if(!p)throw new Error("The target activity is not found.");const g=typeof u=="function"?u(p.params):u,v=jn();return(h=c())==null?void 0:h.actions.stepPush({stepId:v,stepParams:g,targetActivityId:m?.targetActivityId})},stepReplace(u,m){var f,h;const x=(f=c())==null?void 0:f.actions.getStack().activities,b=m?.targetActivityId?yn(m.targetActivityId):bn,p=x&&b(x);if(!p)throw new Error("The target activity is not found.");const g=typeof u=="function"?u(p.params):u,v=jn();return(h=c())==null?void 0:h.actions.stepReplace({stepId:v,stepParams:g,targetActivityId:m?.targetActivityId})},stepPop(u){var m;return(m=c())==null?void 0:m.actions.stepPop({targetActivityId:u?.targetActivityId})}}}}function dh(){return()=>({key:"plugin-renderer-basic",render({stack:t}){return e.jsx(e.Fragment,{children:t.render().activities.filter(s=>s.transitionState!=="exit-done").map(s=>e.jsx(l.Fragment,{children:s.render()},s.key))})}})}function uh(t){var s=t.match(/^var\((.*)\)$/);return s?s[1]:t}function Ks(t,s){var n={};{var a=t;for(var r in a){var o=a[r];o!=null&&(n[uh(r)]=o)}}return Object.defineProperty(n,"toString",{value:function(){return Object.keys(this).map(i=>"".concat(i,":").concat(this[i])).join(";")},writable:!1}),n}function mh(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function fh(t){var s=mh(t,"string");return typeof s=="symbol"?s:String(s)}function ph(t,s,n){return s=fh(s),s in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function Qr(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,a)}return n}function Yr(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?Qr(Object(n),!0).forEach(function(a){ph(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Qr(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function Xr(t,s){var n={};for(var a in t)n[a]=s(t[a],a);return n}var hh=(t,s,n)=>{for(var a of Object.keys(t)){var r;if(t[a]!==((r=s[a])!==null&&r!==void 0?r:n[a]))return!1}return!0},bt=t=>{var s=n=>{var a=t.defaultClassName,r=Yr(Yr({},t.defaultVariants),n);for(var o in r){var c,i=(c=r[o])!==null&&c!==void 0?c:t.defaultVariants[o];if(i!=null){var d=i;typeof d=="boolean"&&(d=d===!0?"true":"false");var u=t.variantClassNames[o][d];u&&(a+=" "+u)}}for(var[m,f]of t.compoundVariants)hh(m,r,t.defaultVariants)&&(a+=" "+f);return a};return s.variants=()=>Object.keys(t.variantClassNames),s.classNames={get base(){return t.defaultClassName.split(" ")[0]},get variants(){return Xr(t.variantClassNames,n=>Xr(n,a=>a.split(" ")[0]))}},s},xh=Object.defineProperty,Zr=Object.getOwnPropertySymbols,gh=Object.prototype.hasOwnProperty,vh=Object.prototype.propertyIsEnumerable,ei=(t,s,n)=>s in t?xh(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,yh=(t,s)=>{for(var n in s||(s={}))gh.call(s,n)&&ei(t,n,s[n]);if(Zr)for(var n of Zr(s))vh.call(s,n)&&ei(t,n,s[n]);return t};function Ha(){const[t,s]=l.useReducer(()=>!0,!1);return l.useEffect(()=>{s()},[]),t}function Jt(){return Yf()}function Go(){const t=Jt(),s=Ha();return yh({},s?{"data-stackflow-activity-id":t?.id,"data-stackflow-activity-is-active":t?.isActive,"data-stackflow-activity-transition-state":t?.transitionState}:null)}function Qo(t,s,n){const a=()=>{s.forEach(r=>{t.removeEventListener(r,a)}),n()};s.forEach(r=>{t.addEventListener(r,a)})}var bh=t=>(t(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}),Ve=()=>{};function da(t){requestAnimationFrame(()=>{requestAnimationFrame(()=>{t()})})}function jh({outerRef:t,innerRef:s,enable:n}){const[a,r]=l.useState(void 0);return l.useEffect(()=>{const o=t&&"current"in t&&t.current,c=s.current;return!n||!o||!c?Ve:bh(()=>{const d=o.clientWidth,u=c.offsetLeft,m=c.clientWidth,f=d-u-m,h=Math.max(u,f);r(d-2*h)})}),{maxWidth:a}}function Ua(t){const[s,n]=l.useState(void 0);return l.useEffect(()=>{da(()=>{n(t)})},[t]),s}function Nh(){return Zf()}function Va({ref:t}){const s=Nh();l.useEffect(()=>{if(!s)return;const n=t.current;if(!n||s.globalTransitionState==="idle")return;const a=r=>{r.preventDefault(),r.stopPropagation()};return n.addEventListener("touchstart",a,{capture:!0}),n.addEventListener("touchmove",a,{capture:!0}),n.addEventListener("touchend",a,{capture:!0}),n.addEventListener("touchcancel",a,{capture:!0}),()=>{n.removeEventListener("touchstart",a,{capture:!0}),n.removeEventListener("touchmove",a,{capture:!0}),n.removeEventListener("touchend",a,{capture:!0}),n.removeEventListener("touchcancel",a,{capture:!0})}},[s?.globalTransitionState])}var ps={};function tt({styleName:t,refs:s,effect:n,effectDeps:a}){const r=Jt();l.useEffect(()=>r?(ps[t]||(ps[t]=new Map),ps[t].set(r.zIndex,{refs:s,hasEffect:!!n}),()=>{ps[t].delete(r.zIndex)}):Ve,[r?.id,s,n]),l.useEffect(()=>{if(!r||!n)return Ve;const o=(()=>{let i=[];for(let d=1;d<=r.zIndex;d+=1){const u=ps[t].get(r.zIndex-d);if(u?.refs&&(i=[...i,...u.refs]),u?.hasEffect)break}return i})(),c=n({activityTransitionState:r.transitionState,refs:o});return()=>{c?.()}},[r?.transitionState,...a??[]])}function wh({refs:t}){tt({styleName:"hide",refs:t,effect:({activityTransitionState:s,refs:n})=>{const a=()=>{n.forEach(r=>{if(!r.current)return;const o=r.current;o.style.display=""})};return s==="enter-done"?(n.forEach(r=>{if(!r.current)return;const o=r.current;o.style.display="none"}),()=>{a()}):(a(),Ve)}})}function kh({refs:t,transitionDuration:s,offsetStyles:n,hasEffect:a=!1}){tt({styleName:"offset",refs:t,effect:a?({activityTransitionState:r,refs:o})=>{const c=()=>{da(()=>{o.forEach(i=>{if(!i.current)return;const d=i.current;d.style.transform="",d.style.opacity="",Qo(d,["transitionend","transitioncancel"],()=>{d.style.transition=""})})})};switch(r){case"enter-active":case"enter-done":return o.forEach(i=>{i.current&&(i.current.style.transition=s,i.current.style.transform=n.transform,i.current.style.opacity=n.opacity)}),r==="enter-done"?()=>{c()}:Ve;case"exit-active":case"exit-done":return da(()=>{c()}),Ve;default:return Ve}}:void 0})}var en="--stackflow-swipe-back-ratio";function Ch({dimRef:t,edgeRef:s,paperRef:n,appBarRef:a,offset:r,transitionDuration:o,preventSwipeBack:c,moveAppBarTogether:i,getActivityTransitionState:d,onSwipeStart:u,onSwipeMove:m,onSwipeEnd:f,onTransitionEnd:h}){tt({styleName:"swipe-back",refs:i&&a?[n,a]:[n],effect:({refs:x})=>{if(c||!t.current||!s.current||!n.current)return Ve;const b=t.current,p=s.current,g=n.current,v=a?.current;let j=null,N=null,y=null,C=[];const w=()=>{j=null,N=null,y=null,C=[]};let S=!1;function M({dx:k,ratio:E}){S||(S=!0,requestAnimationFrame(()=>{b.style.opacity=`${1-E}`,b.style.transition="0s",g.style.overflowY="hidden",g.style.transform=`translate3d(${k}px, 0, 0)`,g.style.transition="0s",i&&v&&(v.style.overflowY="hidden",v.style.transform=`translate3d(${k}px, 0, 0)`,v.style.transition="0s"),v?.style.setProperty(en,String(E)),x.forEach(z=>{var D,L;z.current&&(z.current.style.transform=`translate3d(${-1*(1-E)*r}px, 0, 0)`,z.current.style.transition="0s",((D=z.current.parentElement)==null?void 0:D.style.display)==="none"&&(z.current.parentElement.style.display="block"),(L=z.current.parentElement)==null||L.style.setProperty(en,String(E)))}),S=!1}))}function A({swiped:k}){return new Promise(E=>{requestAnimationFrame(()=>{b.style.opacity=`${k?0:1}`,b.style.transition=o,g.style.overflowY="hidden",g.style.transform=`translateX(${k?"100%":"0"})`,g.style.transition=o,i&&v&&(v.style.overflowY="hidden",v.style.transform=`translateX(${k?"100%":"0"})`,v.style.transition=o),x.forEach(D=>{D.current&&(D.current.style.transition=o,D.current.style.transform=`translate3d(${k?"0":`-${r/16}rem`}, 0, 0)`)});const z=[...C];E(),Qo(g,["transitionend","transitioncancel"],()=>{const D=k||d()==="exit-active"||d()==="exit-done";b.style.opacity="",g.style.overflowY="",g.style.transform="",i&&v&&(v.style.overflowY="",v.style.transform="",v.style.removeProperty("transition")),v?.style.removeProperty(en),x.forEach((L,V)=>{var _;if(!L.current)return;const O=z[V];D?(L.current.style.transition="",L.current.style.transform="",L.current.parentElement&&(L.current.parentElement.style.display="")):O&&(L.current.style.transition=O.style.transition,L.current.style.transform=O.style.transform,L.current.parentElement&&O.parentElement&&(L.current.parentElement.style.display=O.parentElement.style.display)),(_=L.current.parentElement)==null||_.style.removeProperty(en)}),h?.({swiped:k})})})})}const I=k=>{var E;const{activeElement:z}=document;(E=z?.blur)==null||E.call(z),j=y=k.touches[0].clientX,N=Date.now(),C=x.map(D=>D.current?{style:{transform:D.current.style.transform,transition:D.current.style.transition},parentElement:D.current.parentElement?{style:{display:D.current.parentElement.style.display}}:void 0}:{style:{transform:"",transition:""}}),u?.()},T=k=>{if(!j){w();return}y=k.touches[0].clientX;const E=y-j,z=E/g.clientWidth;M({dx:E,ratio:z}),m?.({dx:E,ratio:z})},P=()=>{if(!j||!N||!y){w();return}const k=Date.now(),z=(y-j)/(k-N)>1||y/g.clientWidth>.4;f?.({swiped:z}),Promise.resolve().then(()=>A({swiped:z})).then(()=>w())};return p.addEventListener("touchstart",I,{passive:!0}),p.addEventListener("touchmove",T,{passive:!0}),p.addEventListener("touchend",P,{passive:!0}),p.addEventListener("touchcancel",P,{passive:!0}),()=>{p.removeEventListener("touchstart",I),p.removeEventListener("touchmove",T),p.removeEventListener("touchend",P),p.removeEventListener("touchcancel",P)}},effectDeps:[c]})}function Rs(){var t;const s=Jt();return((t=s?.zIndex)!=null?t:0)*5}var Sh=Object.defineProperty,Ah=Object.defineProperties,Ih=Object.getOwnPropertyDescriptors,ti=Object.getOwnPropertySymbols,Th=Object.prototype.hasOwnProperty,Ph=Object.prototype.propertyIsEnumerable,si=(t,s,n)=>s in t?Sh(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,It=(t,s)=>{for(var n in s||(s={}))Th.call(s,n)&&si(t,n,s[n]);if(ti)for(var n of ti(s))Ph.call(s,n)&&si(t,n,s[n]);return t},bs=(t,s)=>Ah(t,Ih(s)),Eh=t=>e.jsx("svg",{className:t.className,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.7241 2.76052C17.105 3.16043 17.0896 3.79341 16.6897 4.17431L8.45 12.0222L16.6896 19.8689C17.0896 20.2498 17.105 20.8827 16.7242 21.2827C16.3433 21.6826 15.7103 21.6981 15.3104 21.3172L6.31037 12.7464C6.11218 12.5576 6.00001 12.2959 6 12.0222C5.99999 11.7486 6.11215 11.4868 6.31032 11.2981L15.3103 2.72608C15.7102 2.34518 16.3432 2.3606 16.7241 2.76052Z",fill:"currentColor"})}),ni=Eh,_h=t=>e.jsx("svg",{className:t.className,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M20.7071 4.70711C21.0976 4.31658 21.0976 3.68342 20.7071 3.29289C20.3166 2.90237 19.6834 2.90237 19.2929 3.29289L12 10.5858L4.70711 3.29289C4.31658 2.90237 3.68342 2.90237 3.29289 3.29289C2.90237 3.68342 2.90237 4.31658 3.29289 4.70711L10.5858 12L3.29289 19.2929C2.90237 19.6834 2.90237 20.3166 3.29289 20.7071C3.68342 21.0976 4.31658 21.0976 4.70711 20.7071L12 13.4142L19.2929 20.7071C19.6834 21.0976 20.3166 21.0976 20.7071 20.7071C21.0976 20.3166 21.0976 19.6834 20.7071 19.2929L13.4142 12L20.7071 4.70711Z",fill:"currentColor"})}),ai=_h,F={backgroundColor:"var(--stackflow-plugin-basic-ui-background-color)",backgroundImage:"var(--stackflow-plugin-basic-ui-background-image)",dimBackgroundColor:"var(--stackflow-plugin-basic-ui-dim-background-color)",dimHeight:"var(--stackflow-plugin-basic-ui-dim-height)",transitionDuration:"var(--stackflow-plugin-basic-ui-transition-duration)",computedTransitionDuration:"var(--stackflow-plugin-basic-ui-computed-transition-duration)",defaultTransitionOffSet:"var(--stackflow-plugin-basic-ui-default-transition-off-set)",appBar:{borderColor:"var(--stackflow-plugin-basic-ui-app-bar-border-color)",borderColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-border-color-transition-duration)",borderSize:"var(--stackflow-plugin-basic-ui-app-bar-border-size)",height:"var(--stackflow-plugin-basic-ui-app-bar-height)",heightTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-height-transition-duration)",minHeight:"var(--stackflow-plugin-basic-ui-app-bar-min-height)",iconColor:"var(--stackflow-plugin-basic-ui-app-bar-icon-color)",iconColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-icon-color-transition-duration)",textColor:"var(--stackflow-plugin-basic-ui-app-bar-text-color)",textColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-text-color-transition-duration)",backgroundColor:"var(--stackflow-plugin-basic-ui-app-bar-background-color)",backgroundColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-background-color-transition-duration)",backgroundImage:"var(--stackflow-plugin-basic-ui-app-bar-background-image)",backgroundImageTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-background-image-transition-duration)",overflow:"var(--stackflow-plugin-basic-ui-app-bar-overflow)",minSafeAreaInsetTop:"var(--stackflow-plugin-basic-ui-app-bar-min-safe-area-inset-top)",containerPadding:"var(--stackflow-plugin-basic-ui-app-bar-container-padding)",itemGap:"var(--stackflow-plugin-basic-ui-app-bar-item-gap)",fontSize:"var(--stackflow-plugin-basic-ui-app-bar-font-size)",lineHeight:"var(--stackflow-plugin-basic-ui-app-bar-line-height)",hitSlop:"var(--stackflow-plugin-basic-ui-app-bar-hit-slop)"},bottomSheet:{borderRadius:"var(--stackflow-plugin-basic-ui-bottom-sheet-border-radius)"},modal:{borderRadius:"var(--stackflow-plugin-basic-ui-modal-border-radius)",maxWidth:"var(--stackflow-plugin-basic-ui-modal-max-width)"},edge:{width:"var(--stackflow-plugin-basic-ui-edge-width)"}},Mh=bt({defaultClassName:"_1q6dj2j2",variantClassNames:{theme:{android:"_1q6dj2j0",cupertino:"_1q6dj2j1"}},defaultVariants:{},compoundVariants:[]});function Rh(t){return t.filter(s=>s!=null)}function Gs(t){return Object.entries(t).reduce((s,[n,a])=>(a!=null&&(s[n]=a),s),{})}var Yo=l.createContext({theme:"android"}),Lh=Yo.Provider;function Xo(){return l.useContext(Yo)}var zh=t=>()=>({key:"basic-ui",wrapStack({stack:s,initialContext:n}){var a,r,o,c,i,d,u,m,f,h,x,b,p,g,v,j,N;const y=typeof t=="function"?t({initialContext:n}):t;return e.jsx(Lh,{value:bs(It({},y),{theme:(a=n?.theme)!=null?a:y.theme}),children:e.jsx("div",{className:Rh([Mh({theme:(r=n?.theme)!=null?r:y.theme}),y.rootClassName]).join(" "),style:Ks(Gs({[F.backgroundColor]:y.backgroundColor,[F.backgroundImage]:y.backgroundImage,[F.dimBackgroundColor]:y.dimBackgroundColor,[F.dimHeight]:y.dimHeight,[F.transitionDuration]:`${s.transitionDuration}ms`,[F.computedTransitionDuration]:s.globalTransitionState==="loading"?`${s.transitionDuration}ms`:"0ms",[F.defaultTransitionOffSet]:y.defaultTransitionOffSet,[F.appBar.borderColor]:(o=y.appBar)==null?void 0:o.borderColor,[F.appBar.borderSize]:(c=y.appBar)==null?void 0:c.borderSize,[F.appBar.height]:(i=y.appBar)==null?void 0:i.height,[F.appBar.minHeight]:(d=y.appBar)==null?void 0:d.minHeight,[F.appBar.iconColor]:(u=y.appBar)==null?void 0:u.iconColor,[F.appBar.textColor]:(m=y.appBar)==null?void 0:m.textColor,[F.appBar.minSafeAreaInsetTop]:(f=y.appBar)==null?void 0:f.minSafeAreaInsetTop,[F.bottomSheet.borderRadius]:(h=y.bottomSheet)==null?void 0:h.borderRadius,[F.modal.borderRadius]:(x=y.modal)==null?void 0:x.borderRadius,[F.appBar.containerPadding]:(b=y.appBar)==null?void 0:b.containerPadding,[F.appBar.fontSize]:(p=y.appBar)==null?void 0:p.fontSize,[F.appBar.lineHeight]:(g=y.appBar)==null?void 0:g.lineHeight,[F.appBar.hitSlop]:(v=y.appBar)==null?void 0:v.hitSlop,[F.appBar.itemGap]:(j=y.appBar)==null?void 0:j.itemGap,[F.edge.width]:(N=y.edge)==null?void 0:N.width})),children:s.render()})})}}),Dh=bt({defaultClassName:"_1yk3a452 dhthxq4 dhthxq0 dhthxqh _1yk3a451",variantClassNames:{activityEnterStyle:{slideInLeft:"_1yk3a453"},enterStyle:{cover:"_1yk3a454"},border:{true:"_1yk3a455"},modalPresentationStyle:{fullScreen:"_1yk3a456"}},defaultVariants:{},compoundVariants:[[{activityEnterStyle:"slideInLeft",enterStyle:"cover"},"_1yk3a457"]]}),ri="_1yk3a45b dhthxq9 dhthxq7 dhthxqb dhthxqf dhthxqi",Bh="dhthxq9 dhthxq7 dhthxq8 _1yk3a450",Oh="_1yk3a45e",Wh="_1yk3a45f dhthxqi dhthxq4 dhthxq2 dhthxqf",Fh="_1yk3a45g dhthxqc dhthxqd dhthxq0",$h="_1yk3a45b dhthxq9 dhthxq7 dhthxqb dhthxqf dhthxqi",qh="_1yk3a459 dhthxqa dhthxq7 _1yk3a451",Hh="_1yk3a45a dhthxq9 dhthxq7 dhthxq1 _1yk3a450",Uh="_1yk3a45h dhthxq9 dhthxq7 dhthxq1 dhthxq5 _1yk3a450",Vh="_1yk3a458",Jh=bt({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_1dlf434a","enter-done":"_1dlf434b","exit-active":"_1dlf434c","exit-done":"_1dlf434d"},hasAppBar:{true:"_1dlf434j"}},defaultVariants:{},compoundVariants:[]}),Kh="_1dlf434k dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 _1dlf4347 _1dlf4349",Gh=bt({defaultClassName:"_1dlf434r dhthxq4 dhthxq2 dhthxq3 dhthxq1",variantClassNames:{hasAppBar:{true:"_1dlf434s"}},defaultVariants:{},compoundVariants:[]}),Qh="_1dlf434a",Yh="_1dlf434b",Xh="_1dlf434c",Zh="_1dlf434d",ex=bt({defaultClassName:"_1dlf434l dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 _1dlf4348 _1dlf4349",variantClassNames:{hasAppBar:{true:"_1dlf434m dhthxqg"},modalPresentationStyle:{fullScreen:"_1dlf434n"},activityEnterStyle:{slideInLeft:"_1dlf434o"}},defaultVariants:{},compoundVariants:[]}),tx=bt({defaultClassName:"_1dlf434p dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3",variantClassNames:{hasAppBar:{true:"_1dlf434q"}},defaultVariants:{},compoundVariants:[]}),Zt={transitionDuration:"var(--_1dlf4340)",zIndexes:{dim:"var(--_1dlf4341)",paper:"var(--_1dlf4342)",edge:"var(--_1dlf4343)",appBar:"var(--_1dlf4344)"},appBar:{center:{mainWidth:"var(--_1dlf4346)"}}},Zo=l.forwardRef(({title:t,renderLeft:s,renderRight:n,backButton:a,closeButton:r,closeButtonLocation:o="left",border:c=!0,modalPresentationStyle:i,activityEnterStyle:d,iconColor:u,iconColorTransitionDuration:m,textColor:f,textColorTransitionDuration:h,borderColor:x,borderColorTransitionDuration:b,borderSize:p,height:g,heightTransitionDuration:v,overflow:j,backgroundColor:N,backgroundColorTransitionDuration:y,backgroundImage:C,backgroundImageTransitionDuration:w,onTopClick:S,enterStyle:M,className:A,minHeight:I,fontSize:T,lineHeight:P,hitSlop:k,containerPadding:E,itemGap:z},D)=>{var L,V;const _=Js(),O=Jt(),G=Go();Ha();const Z=Xo(),$=(L=Z.appBar)==null?void 0:L.closeButton,K=(V=Z.appBar)==null?void 0:V.backButton,te=l.useRef(null),{maxWidth:re}=jh({outerRef:D,innerRef:te,enable:Z.theme==="cupertino"}),Y=(Z.theme==="cupertino"&&i!=="fullScreen"||d==="slideInLeft")&&M!=="cover",X=ee=>{a&&"onClick"in a&&a.onClick&&a.onClick(ee),ee.defaultPrevented||_.pop()},ie=()=>{var ee,me;return!O||O.isRoot?null:!a&&!K?e.jsx("button",{type:"button","aria-label":"Go Back",className:ri,onClick:X,children:e.jsx(ni,{})}):a&&"render"in a&&a.render?(ee=a.render)==null?void 0:ee.call(a):K&&"render"in K&&K.render?(me=K.render)==null?void 0:me.call(K):e.jsx("button",{type:"button",className:ri,"aria-label":a&&"ariaLabel"in a?a.ariaLabel:K&&"ariaLabel"in K?K.ariaLabel:void 0,onClick:X,children:a&&"renderIcon"in a&&a.renderIcon?a.renderIcon():K&&"renderIcon"in K&&K.renderIcon?K.renderIcon():i==="fullScreen"?e.jsx(ai,{}):e.jsx(ni,{})})},le=ee=>{var me;r&&"onClick"in r&&r.onClick&&r.onClick(ee),!ee.defaultPrevented&&$&&"onClick"in $&&((me=$.onClick)==null||me.call($,ee))},W=()=>{var ee;const me=!O||O.isRoot,ye=he=>he&&"render"in he&&he.render||he&&"renderIcon"in he&&he.renderIcon||he&&"onClick"in he&&he.onClick;return!(ye(r)||ye((ee=Z.appBar)==null?void 0:ee.closeButton))||!me?null:r&&"render"in r&&r.render?r.render():$&&"render"in $&&$.render?$.render():e.jsx("button",{type:"button",className:$h,"aria-label":r&&"ariaLabel"in r?r.ariaLabel:$&&"ariaLabel"in $?$.ariaLabel:void 0,onClick:le,children:r&&"renderIcon"in r&&r.renderIcon?r.renderIcon():$&&"renderIcon"in $&&$.renderIcon?$.renderIcon():e.jsx(ai,{})})};return e.jsxs("div",bs(It({ref:D,className:Mn(Dh({border:c,modalPresentationStyle:i,activityEnterStyle:d,enterStyle:M}),A),style:Ks(Gs({[F.appBar.iconColor]:u,[F.appBar.iconColorTransitionDuration]:m,[F.appBar.textColor]:f,[F.appBar.textColorTransitionDuration]:h,[F.appBar.borderColor]:x,[F.appBar.borderColorTransitionDuration]:b,[F.appBar.borderSize]:p,[F.appBar.height]:g,[F.appBar.heightTransitionDuration]:v,[F.appBar.overflow]:j,[F.appBar.backgroundColor]:N??(Y?F.backgroundColor:"transparent"),[F.appBar.backgroundColorTransitionDuration]:y,[F.appBar.backgroundImage]:C??(Y?F.appBar.backgroundImage:"none"),[F.appBar.backgroundImageTransitionDuration]:w,[Zt.appBar.center.mainWidth]:`${re}px`,[F.appBar.minHeight]:I,[F.appBar.containerPadding]:E,[F.appBar.fontSize]:T,[F.appBar.hitSlop]:k,[F.appBar.lineHeight]:P,[F.appBar.itemGap]:z})),"data-part":"appBar"},G),{children:[e.jsx("div",{className:Vh}),e.jsxs("div",{className:qh,children:[e.jsxs("div",{className:Hh,children:[o==="left"&&W(),ie(),s?.()]}),e.jsx("div",{ref:te,className:Bh,children:e.jsxs("div",{className:Oh,children:[typeof t=="string"?e.jsx("div",{className:Fh,children:t}):t,e.jsx("button",{className:Wh,type:"button",onClick:S})]})}),e.jsxs("div",{className:Uh,children:[n?.(),o==="right"&&W()]})]})]}))});Zo.displayName="AppBar";var sx=Zo,nx=32,ii=80,ax=l.createContext(null),rx=({backgroundColor:t,backgroundImage:s,dimBackgroundColor:n,appBar:a,preventSwipeBack:r,CUPERTINO_ONLY_modalPresentationStyle:o,ANDROID_ONLY_activityEnterStyle:c,className:i,children:d})=>{var u;const m=Xo(),f=Jt(),h=Go();Ha();const{pop:x}=Js(),b=l.useRef(null),p=l.useRef(null),g=l.useRef(null),v=l.useRef(null),j=l.useRef(null),N=l.useRef(null),y=m.theme==="cupertino"?o:void 0,C=m.theme==="android"?c:void 0,w=r||y==="fullScreen",S=!!a,M=Rs();let A,I,T,P;m.theme==="cupertino"?(A=M+(y==="fullScreen"?2:0),I=M+(S&&y!=="fullScreen"?a.enterStyle==="cover"?2:1:3),T=M+4,P=M+7):(A=M,I=M+(C==="slideInLeft"&&a?.enterStyle!=="cover"?0:2),T=M+4,P=M+(C==="slideInLeft"?6:4));const k=(u=f?.transitionState)!=null?u:"enter-done",E=Ua(k);wh({refs:[b]}),kh({refs:(m.theme==="cupertino"||C==="slideInLeft")&&a?.enterStyle!=="cover"?[g]:[g,j],offsetStyles:m.theme==="cupertino"?{transform:`translate3d(-${ii/16}rem, 0, 0)`,opacity:"1"}:C==="slideInLeft"?{transform:"translate3d(-50%, 0, 0)",opacity:"0"}:{transform:`translate3d(0, -${nx/16}rem, 0)`,opacity:"1"},transitionDuration:F.computedTransitionDuration,hasEffect:y!=="fullScreen"}),Ch({dimRef:p,edgeRef:v,paperRef:g,appBarRef:j,offset:ii,transitionDuration:F.transitionDuration,moveAppBarTogether:a?.enterStyle==="cover",preventSwipeBack:w||m.theme!=="cupertino",getActivityTransitionState(){const D=g.current,L=D?.parentElement;return L?L.classList.contains(Qh)?"enter-active":L.classList.contains(Yh)?"enter-done":L.classList.contains(Xh)?"exit-active":L.classList.contains(Zh)?"exit-done":null:null},onSwipeEnd({swiped:D}){D&&x()}});const z=D=>{var L,V;(L=a?.onTopClick)==null||L.call(a,D),D.defaultPrevented||(V=N.current)==null||V.scroll({top:0,behavior:"smooth"})};return Va({ref:b}),e.jsx(ax.Provider,{value:l.useMemo(()=>({scroll({top:D}){var L;(L=N?.current)==null||L.scroll({top:D,behavior:"smooth"})},zIndices:{dim:A,paper:I,edge:T,appBar:P}}),[N,A,I,T,P]),children:e.jsxs("div",bs(It({ref:b,className:Mn(Jh({hasAppBar:S,transitionState:k==="enter-done"||k==="exit-done"?k:E}),i),style:Ks(Gs({[F.backgroundColor]:t,[F.backgroundImage]:s,[F.dimBackgroundColor]:n,[F.appBar.height]:a?.height,[F.appBar.heightTransitionDuration]:a?.heightTransitionDuration,[Zt.zIndexes.dim]:`${A}`,[Zt.zIndexes.paper]:`${I}`,[Zt.zIndexes.edge]:`${T}`,[Zt.zIndexes.appBar]:`${P}`,[Zt.transitionDuration]:k==="enter-active"||k==="exit-active"?F.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"AppScreen"},h),{children:[C!=="slideInLeft"&&e.jsx("div",It({ref:p,className:Kh,"data-part":"dim"},h)),a&&e.jsx(sx,bs(It({},a),{ref:j,modalPresentationStyle:y,activityEnterStyle:C,onTopClick:z})),e.jsx("div",bs(It({ref:g,className:ex({hasAppBar:S,modalPresentationStyle:y,activityEnterStyle:C}),"data-part":"paper"},h),{children:e.jsx("div",{ref:N,className:tx({hasAppBar:S}),children:d})}),f?.id),!f?.isRoot&&m.theme==="cupertino"&&!w&&e.jsx("div",It({ref:v,className:Gh({hasAppBar:S}),"data-part":"edge"},h))]}))})},ne=rx,ix=bt({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_1ht38h04","enter-done":"_1ht38h05","exit-active":"_1ht38h06","exit-done":"_1ht38h07"}},defaultVariants:{},compoundVariants:[]}),ox="_1ht38h0d dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc dhthxqa dhthxq7 _1ht38h03",cx="_1ht38h0e dhthxqc _1ht38h03",Xn={transitionDuration:"var(--_1ht38h00)",zIndexes:{dim:"var(--_1ht38h01)",paper:"var(--_1ht38h02)"}},ec=({borderRadius:t="1rem",backgroundColor:s,backgroundImage:n,dimBackgroundColor:a,paperRef:r,onOutsideClick:o,children:c,className:i})=>{var d;const u=Jt(),{pop:m}=Js(),f=l.useRef(null),h=l.useRef(null);tt({styleName:"hide",refs:[f]}),tt({styleName:"offset",refs:[h]}),tt({styleName:"swipe-back",refs:[h]});const x=l.useRef(!1),b=N=>{o?.(N),!N.defaultPrevented&&(x.current||(x.current=!0,m()))},p=N=>{N.stopPropagation()},g=Rs()+3,v=Rs()+4,j=(d=u?.transitionState)!=null?d:"enter-done";return Va({ref:f}),e.jsx("div",{className:Mn(ix({transitionState:Ua(j)}),i),ref:f,style:Ks(Gs({[F.bottomSheet.borderRadius]:t,[F.backgroundColor]:s,[F.backgroundImage]:n,[F.dimBackgroundColor]:a,[Xn.zIndexes.dim]:`${g}`,[Xn.zIndexes.paper]:`${v}`,[Xn.transitionDuration]:j==="enter-active"||j==="exit-active"?F.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"BottomSheet","data-stackflow-activity-id":u?.id,"data-stackflow-activity-is-active":u?.isActive,children:e.jsx("div",{className:ox,ref:h,onClick:b,children:e.jsx("div",{className:cx,ref:r,onClick:p,children:c})})})};ec.displayName="BottomSheet";var lx=ec,dx=bt({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_5ozg8c4","enter-done":"_5ozg8c5","exit-active":"_5ozg8c6","exit-done":"_5ozg8c7"}},defaultVariants:{},compoundVariants:[]}),ux="_5ozg8cd dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc dhthxq9 dhthxq7 dhthxqb _5ozg8c3",mx="_5ozg8ce dhthxqc _5ozg8c3",Zn={transitionDuration:"var(--_5ozg8c0)",zIndexes:{dim:"var(--_5ozg8c1)",paper:"var(--_5ozg8c2)"}},tc=({backgroundColor:t,backgroundImage:s,dimBackgroundColor:n,borderRadius:a="1rem",maxWidth:r,onOutsideClick:o,children:c,className:i})=>{var d;const u=Jt(),{pop:m}=Js(),f=l.useRef(null),h=l.useRef(null);tt({styleName:"hide",refs:[f]}),tt({styleName:"offset",refs:[h]}),tt({styleName:"swipe-back",refs:[h]});const x=l.useRef(!1),b=N=>{o?.(N),!N.defaultPrevented&&(x.current||(x.current=!0,m()))},p=N=>{N.stopPropagation()},g=Rs()+3,v=Rs()+4,j=(d=u?.transitionState)!=null?d:"enter-done";return Va({ref:f}),e.jsx("div",{className:Mn(dx({transitionState:Ua(j)}),i),ref:f,style:Ks(Gs({[F.backgroundColor]:t,[F.backgroundImage]:s,[F.dimBackgroundColor]:n,[F.modal.borderRadius]:a,[F.modal.maxWidth]:r,[Zn.zIndexes.dim]:`${g}`,[Zn.zIndexes.paper]:`${v}`,[Zn.transitionDuration]:j==="enter-active"||j==="exit-active"?F.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"Modal","data-stackflow-activity-id":u?.id,"data-stackflow-activity-is-active":u?.isActive,children:e.jsx("div",{className:ux,ref:h,onClick:b,children:e.jsx("div",{className:mx,onClick:p,children:c})})})};tc.displayName="Modal";var fx=tc,px=Object.defineProperty,J=(t,s)=>px(t,"name",{value:s,configurable:!0}),ns=class{type=3;name="";prefix="";value="";suffix="";modifier=3;constructor(t,s,n,a,r,o){this.type=t,this.name=s,this.prefix=n,this.value=a,this.suffix=r,this.modifier=o}hasCustomName(){return this.name!==""&&typeof this.name!="number"}};J(ns,"Part");var hx=/[$_\p{ID_Start}]/u,xx=/[$_\u200C\u200D\p{ID_Continue}]/u,ua=".*";function sc(t,s){return(s?/^[\x00-\xFF]*$/:/^[\x00-\x7F]*$/).test(t)}J(sc,"isASCII");function Ja(t,s=!1){let n=[],a=0;for(;a<t.length;){let r=t[a],o=J(function(c){if(!s)throw new TypeError(c);n.push({type:"INVALID_CHAR",index:a,value:t[a++]})},"ErrorOrInvalid");if(r==="*"){n.push({type:"ASTERISK",index:a,value:t[a++]});continue}if(r==="+"||r==="?"){n.push({type:"OTHER_MODIFIER",index:a,value:t[a++]});continue}if(r==="\\"){n.push({type:"ESCAPED_CHAR",index:a++,value:t[a++]});continue}if(r==="{"){n.push({type:"OPEN",index:a,value:t[a++]});continue}if(r==="}"){n.push({type:"CLOSE",index:a,value:t[a++]});continue}if(r===":"){let c="",i=a+1;for(;i<t.length;){let d=t.substr(i,1);if(i===a+1&&hx.test(d)||i!==a+1&&xx.test(d)){c+=t[i++];continue}break}if(!c){o(`Missing parameter name at ${a}`);continue}n.push({type:"NAME",index:a,value:c}),a=i;continue}if(r==="("){let c=1,i="",d=a+1,u=!1;if(t[d]==="?"){o(`Pattern cannot start with "?" at ${d}`);continue}for(;d<t.length;){if(!sc(t[d],!1)){o(`Invalid character '${t[d]}' at ${d}.`),u=!0;break}if(t[d]==="\\"){i+=t[d++]+t[d++];continue}if(t[d]===")"){if(c--,c===0){d++;break}}else if(t[d]==="("&&(c++,t[d+1]!=="?")){o(`Capturing groups are not allowed at ${d}`),u=!0;break}i+=t[d++]}if(u)continue;if(c){o(`Unbalanced pattern at ${a}`);continue}if(!i){o(`Missing pattern at ${a}`);continue}n.push({type:"REGEX",index:a,value:i}),a=d;continue}n.push({type:"CHAR",index:a,value:t[a++]})}return n.push({type:"END",index:a,value:""}),n}J(Ja,"lexer");function Ka(t,s={}){let n=Ja(t);s.delimiter??="/#?",s.prefixes??="./";let a=`[^${Ie(s.delimiter)}]+?`,r=[],o=0,c=0,i=new Set,d=J(j=>{if(c<n.length&&n[c].type===j)return n[c++].value},"tryConsume"),u=J(()=>d("OTHER_MODIFIER")??d("ASTERISK"),"tryConsumeModifier"),m=J(j=>{let N=d(j);if(N!==void 0)return N;let{type:y,index:C}=n[c];throw new TypeError(`Unexpected ${y} at ${C}, expected ${j}`)},"mustConsume"),f=J(()=>{let j="",N;for(;N=d("CHAR")??d("ESCAPED_CHAR");)j+=N;return j},"consumeText"),h=J(j=>j,"DefaultEncodePart"),x=s.encodePart||h,b="",p=J(j=>{b+=j},"appendToPendingFixedValue"),g=J(()=>{b.length&&(r.push(new ns(3,"","",x(b),"",3)),b="")},"maybeAddPartFromPendingFixedValue"),v=J((j,N,y,C,w)=>{let S=3;switch(w){case"?":S=1;break;case"*":S=0;break;case"+":S=2;break}if(!N&&!y&&S===3){p(j);return}if(g(),!N&&!y){if(!j)return;r.push(new ns(3,"","",x(j),"",S));return}let M;y?y==="*"?M=ua:M=y:M=a;let A=2;M===a?(A=1,M=""):M===ua&&(A=0,M="");let I;if(N?I=N:y&&(I=o++),i.has(I))throw new TypeError(`Duplicate name '${I}'.`);i.add(I),r.push(new ns(A,I,x(j),M,x(C),S))},"addPart");for(;c<n.length;){let j=d("CHAR"),N=d("NAME"),y=d("REGEX");if(!N&&!y&&(y=d("ASTERISK")),N||y){let w=j??"";s.prefixes.indexOf(w)===-1&&(p(w),w=""),g();let S=u();v(w,N,y,"",S);continue}let C=j??d("ESCAPED_CHAR");if(C){p(C);continue}if(d("OPEN")){let w=f(),S=d("NAME"),M=d("REGEX");!S&&!M&&(M=d("ASTERISK"));let A=f();m("CLOSE");let I=u();v(w,S,M,A,I);continue}g(),m("END")}return r}J(Ka,"parse");function Ie(t){return t.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}J(Ie,"escapeString");function ma(t){return t&&t.ignoreCase?"ui":"u"}J(ma,"flags");function nc(t,s,n){return Ga(Ka(t,n),s,n)}J(nc,"stringToRegexp");function _t(t){switch(t){case 0:return"*";case 1:return"?";case 2:return"+";case 3:return""}}J(_t,"modifierToString");function Ga(t,s,n={}){n.delimiter??="/#?",n.prefixes??="./",n.sensitive??=!1,n.strict??=!1,n.end??=!0,n.start??=!0,n.endsWith="";let a=n.start?"^":"";for(let i of t){if(i.type===3){i.modifier===3?a+=Ie(i.value):a+=`(?:${Ie(i.value)})${_t(i.modifier)}`;continue}s&&s.push(i.name);let d=`[^${Ie(n.delimiter)}]+?`,u=i.value;if(i.type===1?u=d:i.type===0&&(u=ua),!i.prefix.length&&!i.suffix.length){i.modifier===3||i.modifier===1?a+=`(${u})${_t(i.modifier)}`:a+=`((?:${u})${_t(i.modifier)})`;continue}if(i.modifier===3||i.modifier===1){a+=`(?:${Ie(i.prefix)}(${u})${Ie(i.suffix)})`,a+=_t(i.modifier);continue}a+=`(?:${Ie(i.prefix)}`,a+=`((?:${u})(?:`,a+=Ie(i.suffix),a+=Ie(i.prefix),a+=`(?:${u}))*)${Ie(i.suffix)})`,i.modifier===0&&(a+="?")}let r=`[${Ie(n.endsWith)}]|$`,o=`[${Ie(n.delimiter)}]`;if(n.end)return n.strict||(a+=`${o}?`),n.endsWith.length?a+=`(?=${r})`:a+="$",new RegExp(a,ma(n));n.strict||(a+=`(?:${o}(?=${r}))?`);let c=!1;if(t.length){let i=t[t.length-1];i.type===3&&i.modifier===3&&(c=n.delimiter.indexOf(i)>-1)}return c||(a+=`(?=${o}|${r})`),new RegExp(a,ma(n))}J(Ga,"partsToRegexp");var lt={delimiter:"",prefixes:"",sensitive:!0,strict:!0},gx={delimiter:".",prefixes:"",sensitive:!0,strict:!0},vx={delimiter:"/",prefixes:"/",sensitive:!0,strict:!0};function ac(t,s){return t.length?t[0]==="/"?!0:!s||t.length<2?!1:(t[0]=="\\"||t[0]=="{")&&t[1]=="/":!1}J(ac,"isAbsolutePathname");function Qa(t,s){return t.startsWith(s)?t.substring(s.length,t.length):t}J(Qa,"maybeStripPrefix");function rc(t,s){return t.endsWith(s)?t.substr(0,t.length-s.length):t}J(rc,"maybeStripSuffix");function Ya(t){return!t||t.length<2?!1:t[0]==="["||(t[0]==="\\"||t[0]==="{")&&t[1]==="["}J(Ya,"treatAsIPv6Hostname");var ic=["ftp","file","http","https","ws","wss"];function Xa(t){if(!t)return!0;for(let s of ic)if(t.test(s))return!0;return!1}J(Xa,"isSpecialScheme");function oc(t,s){if(t=Qa(t,"#"),s||t==="")return t;let n=new URL("https://example.com");return n.hash=t,n.hash?n.hash.substring(1,n.hash.length):""}J(oc,"canonicalizeHash");function cc(t,s){if(t=Qa(t,"?"),s||t==="")return t;let n=new URL("https://example.com");return n.search=t,n.search?n.search.substring(1,n.search.length):""}J(cc,"canonicalizeSearch");function lc(t,s){return s||t===""?t:Ya(t)?tr(t):er(t)}J(lc,"canonicalizeHostname");function dc(t,s){if(s||t==="")return t;let n=new URL("https://example.com");return n.password=t,n.password}J(dc,"canonicalizePassword");function uc(t,s){if(s||t==="")return t;let n=new URL("https://example.com");return n.username=t,n.username}J(uc,"canonicalizeUsername");function mc(t,s,n){if(n||t==="")return t;if(s&&!ic.includes(s))return new URL(`${s}:${t}`).pathname;let a=t[0]=="/";return t=new URL(a?t:"/-"+t,"https://example.com").pathname,a||(t=t.substring(2,t.length)),t}J(mc,"canonicalizePathname");function fc(t,s,n){return Za(s)===t&&(t=""),n||t===""?t:sr(t)}J(fc,"canonicalizePort");function pc(t,s){return t=rc(t,":"),s||t===""?t:Wn(t)}J(pc,"canonicalizeProtocol");function Za(t){switch(t){case"ws":case"http":return"80";case"wws":case"https":return"443";case"ftp":return"21";default:return""}}J(Za,"defaultPortForProtocol");function Wn(t){if(t==="")return t;if(/^[-+.A-Za-z0-9]*$/.test(t))return t.toLowerCase();throw new TypeError(`Invalid protocol '${t}'.`)}J(Wn,"protocolEncodeCallback");function hc(t){if(t==="")return t;let s=new URL("https://example.com");return s.username=t,s.username}J(hc,"usernameEncodeCallback");function xc(t){if(t==="")return t;let s=new URL("https://example.com");return s.password=t,s.password}J(xc,"passwordEncodeCallback");function er(t){if(t==="")return t;if(/[\t\n\r #%/:<>?@[\]^\\|]/g.test(t))throw new TypeError(`Invalid hostname '${t}'`);let s=new URL("https://example.com");return s.hostname=t,s.hostname}J(er,"hostnameEncodeCallback");function tr(t){if(t==="")return t;if(/[^0-9a-fA-F[\]:]/g.test(t))throw new TypeError(`Invalid IPv6 hostname '${t}'`);return t.toLowerCase()}J(tr,"ipv6HostnameEncodeCallback");function sr(t){if(t===""||/^[0-9]*$/.test(t)&&parseInt(t)<=65535)return t;throw new TypeError(`Invalid port '${t}'.`)}J(sr,"portEncodeCallback");function gc(t){if(t==="")return t;let s=new URL("https://example.com");return s.pathname=t[0]!=="/"?"/-"+t:t,t[0]!=="/"?s.pathname.substring(2,s.pathname.length):s.pathname}J(gc,"standardURLPathnameEncodeCallback");function vc(t){return t===""?t:new URL(`data:${t}`).pathname}J(vc,"pathURLPathnameEncodeCallback");function yc(t){if(t==="")return t;let s=new URL("https://example.com");return s.search=t,s.search.substring(1,s.search.length)}J(yc,"searchEncodeCallback");function bc(t){if(t==="")return t;let s=new URL("https://example.com");return s.hash=t,s.hash.substring(1,s.hash.length)}J(bc,"hashEncodeCallback");var jc=class{#r;#n=[];#t={};#e=0;#a=1;#l=0;#o=0;#f=0;#p=0;#h=!1;constructor(t){this.#r=t}get result(){return this.#t}parse(){for(this.#n=Ja(this.#r,!0);this.#e<this.#n.length;this.#e+=this.#a){if(this.#a=1,this.#n[this.#e].type==="END"){if(this.#o===0){this.#y(),this.#d()?this.#s(9,1):this.#u()?this.#s(8,1):this.#s(7,0);continue}else if(this.#o===2){this.#m(5);continue}this.#s(10,0);break}if(this.#f>0)if(this.#S())this.#f-=1;else continue;if(this.#C()){this.#f+=1;continue}switch(this.#o){case 0:this.#b()&&this.#m(1);break;case 1:if(this.#b()){this.#T();let t=7,s=1;this.#N()?(t=2,s=3):this.#h&&(t=2),this.#s(t,s)}break;case 2:this.#g()?this.#m(3):(this.#v()||this.#u()||this.#d())&&this.#m(5);break;case 3:this.#w()?this.#s(4,1):this.#g()&&this.#s(5,1);break;case 4:this.#g()&&this.#s(5,1);break;case 5:this.#A()?this.#p+=1:this.#I()&&(this.#p-=1),this.#k()&&!this.#p?this.#s(6,1):this.#v()?this.#s(7,0):this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 6:this.#v()?this.#s(7,0):this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 7:this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 8:this.#d()&&this.#s(9,1);break}}this.#t.hostname!==void 0&&this.#t.port===void 0&&(this.#t.port="")}#s(t,s){switch(this.#o){case 0:break;case 1:this.#t.protocol=this.#c();break;case 2:break;case 3:this.#t.username=this.#c();break;case 4:this.#t.password=this.#c();break;case 5:this.#t.hostname=this.#c();break;case 6:this.#t.port=this.#c();break;case 7:this.#t.pathname=this.#c();break;case 8:this.#t.search=this.#c();break;case 9:this.#t.hash=this.#c();break}this.#o!==0&&t!==10&&([1,2,3,4].includes(this.#o)&&[6,7,8,9].includes(t)&&(this.#t.hostname??=""),[1,2,3,4,5,6].includes(this.#o)&&[8,9].includes(t)&&(this.#t.pathname??=this.#h?"/":""),[1,2,3,4,5,6,7].includes(this.#o)&&t===9&&(this.#t.search??="")),this.#j(t,s)}#j(t,s){this.#o=t,this.#l=this.#e+s,this.#e+=s,this.#a=0}#y(){this.#e=this.#l,this.#a=0}#m(t){this.#y(),this.#o=t}#x(t){return t<0&&(t=this.#n.length-t),t<this.#n.length?this.#n[t]:this.#n[this.#n.length-1]}#i(t,s){let n=this.#x(t);return n.value===s&&(n.type==="CHAR"||n.type==="ESCAPED_CHAR"||n.type==="INVALID_CHAR")}#b(){return this.#i(this.#e,":")}#N(){return this.#i(this.#e+1,"/")&&this.#i(this.#e+2,"/")}#g(){return this.#i(this.#e,"@")}#w(){return this.#i(this.#e,":")}#k(){return this.#i(this.#e,":")}#v(){return this.#i(this.#e,"/")}#u(){if(this.#i(this.#e,"?"))return!0;if(this.#n[this.#e].value!=="?")return!1;let t=this.#x(this.#e-1);return t.type!=="NAME"&&t.type!=="REGEX"&&t.type!=="CLOSE"&&t.type!=="ASTERISK"}#d(){return this.#i(this.#e,"#")}#C(){return this.#n[this.#e].type=="OPEN"}#S(){return this.#n[this.#e].type=="CLOSE"}#A(){return this.#i(this.#e,"[")}#I(){return this.#i(this.#e,"]")}#c(){let t=this.#n[this.#e],s=this.#x(this.#l).index;return this.#r.substring(s,t.index)}#T(){let t={};Object.assign(t,lt),t.encodePart=Wn;let s=nc(this.#c(),void 0,t);this.#h=Xa(s)}};J(jc,"Parser");var ea=["protocol","username","password","hostname","port","pathname","search","hash"],ot="*";function fa(t,s){if(typeof t!="string")throw new TypeError("parameter 1 is not of type 'string'.");let n=new URL(t,s);return{protocol:n.protocol.substring(0,n.protocol.length-1),username:n.username,password:n.password,hostname:n.hostname,port:n.port,pathname:n.pathname,search:n.search!==""?n.search.substring(1,n.search.length):void 0,hash:n.hash!==""?n.hash.substring(1,n.hash.length):void 0}}J(fa,"extractValues");function Fe(t,s){return s?ts(t):t}J(Fe,"processBaseURLString");function es(t,s,n){let a;if(typeof s.baseURL=="string")try{a=new URL(s.baseURL),s.protocol===void 0&&(t.protocol=Fe(a.protocol.substring(0,a.protocol.length-1),n)),!n&&s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.username===void 0&&(t.username=Fe(a.username,n)),!n&&s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.username===void 0&&s.password===void 0&&(t.password=Fe(a.password,n)),s.protocol===void 0&&s.hostname===void 0&&(t.hostname=Fe(a.hostname,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&(t.port=Fe(a.port,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&(t.pathname=Fe(a.pathname,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&s.search===void 0&&(t.search=Fe(a.search.substring(1,a.search.length),n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&s.search===void 0&&s.hash===void 0&&(t.hash=Fe(a.hash.substring(1,a.hash.length),n))}catch{throw new TypeError(`invalid baseURL '${s.baseURL}'.`)}if(typeof s.protocol=="string"&&(t.protocol=pc(s.protocol,n)),typeof s.username=="string"&&(t.username=uc(s.username,n)),typeof s.password=="string"&&(t.password=dc(s.password,n)),typeof s.hostname=="string"&&(t.hostname=lc(s.hostname,n)),typeof s.port=="string"&&(t.port=fc(s.port,t.protocol,n)),typeof s.pathname=="string"){if(t.pathname=s.pathname,a&&!ac(t.pathname,n)){let r=a.pathname.lastIndexOf("/");r>=0&&(t.pathname=Fe(a.pathname.substring(0,r+1),n)+t.pathname)}t.pathname=mc(t.pathname,t.protocol,n)}return typeof s.search=="string"&&(t.search=cc(s.search,n)),typeof s.hash=="string"&&(t.hash=oc(s.hash,n)),t}J(es,"applyInit");function ts(t){return t.replace(/([+*?:{}()\\])/g,"\\$1")}J(ts,"escapePatternString");function Nc(t){return t.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}J(Nc,"escapeRegexpString");function wc(t,s){s.delimiter??="/#?",s.prefixes??="./",s.sensitive??=!1,s.strict??=!1,s.end??=!0,s.start??=!0,s.endsWith="";let n=".*",a=`[^${Nc(s.delimiter)}]+?`,r=/[$_\u200C\u200D\p{ID_Continue}]/u,o="";for(let c=0;c<t.length;++c){let i=t[c];if(i.type===3){if(i.modifier===3){o+=ts(i.value);continue}o+=`{${ts(i.value)}}${_t(i.modifier)}`;continue}let d=i.hasCustomName(),u=!!i.suffix.length||!!i.prefix.length&&(i.prefix.length!==1||!s.prefixes.includes(i.prefix)),m=c>0?t[c-1]:null,f=c<t.length-1?t[c+1]:null;if(!u&&d&&i.type===1&&i.modifier===3&&f&&!f.prefix.length&&!f.suffix.length)if(f.type===3){let h=f.value.length>0?f.value[0]:"";u=r.test(h)}else u=!f.hasCustomName();if(!u&&!i.prefix.length&&m&&m.type===3){let h=m.value[m.value.length-1];u=s.prefixes.includes(h)}u&&(o+="{"),o+=ts(i.prefix),d&&(o+=`:${i.name}`),i.type===2?o+=`(${i.value})`:i.type===1?d||(o+=`(${a})`):i.type===0&&(!d&&(!m||m.type===3||m.modifier!==3||u||i.prefix!=="")?o+="*":o+=`(${n})`),i.type===1&&d&&i.suffix.length&&r.test(i.suffix[0])&&(o+="\\"),o+=ts(i.suffix),u&&(o+="}"),i.modifier!==3&&(o+=_t(i.modifier))}return o}J(wc,"partsToPattern");var kc=class{#r;#n={};#t={};#e={};#a={};#l=!1;constructor(t={},s,n){try{let a;if(typeof s=="string"?a=s:n=s,typeof t=="string"){let i=new jc(t);if(i.parse(),t=i.result,a===void 0&&typeof t.protocol!="string")throw new TypeError("A base URL must be provided for a relative constructor string.");t.baseURL=a}else{if(!t||typeof t!="object")throw new TypeError("parameter 1 is not of type 'string' and cannot convert to dictionary.");if(a)throw new TypeError("parameter 1 is not of type 'string'.")}typeof n>"u"&&(n={ignoreCase:!1});let r={ignoreCase:n.ignoreCase===!0},o={pathname:ot,protocol:ot,username:ot,password:ot,hostname:ot,port:ot,search:ot,hash:ot};this.#r=es(o,t,!0),Za(this.#r.protocol)===this.#r.port&&(this.#r.port="");let c;for(c of ea){if(!(c in this.#r))continue;let i={},d=this.#r[c];switch(this.#t[c]=[],c){case"protocol":Object.assign(i,lt),i.encodePart=Wn;break;case"username":Object.assign(i,lt),i.encodePart=hc;break;case"password":Object.assign(i,lt),i.encodePart=xc;break;case"hostname":Object.assign(i,gx),Ya(d)?i.encodePart=tr:i.encodePart=er;break;case"port":Object.assign(i,lt),i.encodePart=sr;break;case"pathname":Xa(this.#n.protocol)?(Object.assign(i,vx,r),i.encodePart=gc):(Object.assign(i,lt,r),i.encodePart=vc);break;case"search":Object.assign(i,lt,r),i.encodePart=yc;break;case"hash":Object.assign(i,lt,r),i.encodePart=bc;break}try{this.#a[c]=Ka(d,i),this.#n[c]=Ga(this.#a[c],this.#t[c],i),this.#e[c]=wc(this.#a[c],i),this.#l=this.#l||this.#a[c].some(u=>u.type===2)}catch{throw new TypeError(`invalid ${c} pattern '${this.#r[c]}'.`)}}}catch(a){throw new TypeError(`Failed to construct 'URLPattern': ${a.message}`)}}get[Symbol.toStringTag](){return"URLPattern"}test(t={},s){let n={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof t!="string"&&s)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof t>"u")return!1;try{typeof t=="object"?n=es(n,t,!1):n=es(n,fa(t,s),!1)}catch{return!1}let a;for(a of ea)if(!this.#n[a].exec(n[a]))return!1;return!0}exec(t={},s){let n={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof t!="string"&&s)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof t>"u")return;try{typeof t=="object"?n=es(n,t,!1):n=es(n,fa(t,s),!1)}catch{return null}let a={};s?a.inputs=[t,s]:a.inputs=[t];let r;for(r of ea){let o=this.#n[r].exec(n[r]);if(!o)return null;let c={};for(let[i,d]of this.#t[r].entries())if(typeof d=="string"||typeof d=="number"){let u=o[i+1];c[d]=u}a[r]={input:n[r]??"",groups:c}}return a}static compareComponent(t,s,n){let a=J((i,d)=>{for(let u of["type","modifier","prefix","value","suffix"]){if(i[u]<d[u])return-1;if(i[u]!==d[u])return 1}return 0},"comparePart"),r=new ns(3,"","","","",3),o=new ns(0,"","","","",3),c=J((i,d)=>{let u=0;for(;u<Math.min(i.length,d.length);++u){let m=a(i[u],d[u]);if(m)return m}return i.length===d.length?0:a(i[u]??r,d[u]??r)},"comparePartList");return!s.#e[t]&&!n.#e[t]?0:s.#e[t]&&!n.#e[t]?c(s.#a[t],[o]):!s.#e[t]&&n.#e[t]?c([o],n.#a[t]):c(s.#a[t],n.#a[t])}get protocol(){return this.#e.protocol}get username(){return this.#e.username}get password(){return this.#e.password}get hostname(){return this.#e.hostname}get port(){return this.#e.port}get pathname(){return this.#e.pathname}get search(){return this.#e.search}get hash(){return this.#e.hash}get hasRegExpGroups(){return this.#l}};J(kc,"URLPattern");globalThis.URLPattern||(globalThis.URLPattern=kc);const yx=l.createContext({requestHistoryTick:()=>{}}),Cc=({children:t,requestHistoryTick:s})=>{const n=l.useMemo(()=>({requestHistoryTick:s}),[s]);return e.jsx(yx.Provider,{value:n,children:t})};Cc.__docgenInfo={description:"",methods:[],displayName:"HistoryQueueProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},requestHistoryTick:{required:!0,tsType:{name:"signature",type:"function",raw:"(cb: (resolve: () => void) => void) => void",signature:{arguments:[{type:{name:"signature",type:"function",raw:"(resolve: () => void) => void",signature:{arguments:[{type:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},name:"resolve"}],return:{name:"void"}}},name:"cb"}],return:{name:"void"}}},description:""}}};function is(){return is=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},is.apply(null,arguments)}var He;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(He||(He={}));var Nn=function(t){return t},oi="beforeunload",bx="popstate";function jx(t){t===void 0&&(t={});var s=t,n=s.window,a=n===void 0?document.defaultView:n,r=a.history;function o(){var S=a.location,M=S.pathname,A=S.search,I=S.hash,T=r.state||{};return[T.idx,Nn({pathname:M,search:A,hash:I,state:T.usr||null,key:T.key||"default"})]}var c=null;function i(){if(c)x.call(c),c=null;else{var S=He.Pop,M=o(),A=M[0],I=M[1];if(x.length){if(A!=null){var T=m-A;T&&(c={action:S,location:I,retry:function(){C(T*-1)}},C(T))}}else j(S)}}a.addEventListener(bx,i);var d=He.Pop,u=o(),m=u[0],f=u[1],h=wn(),x=wn();m==null&&(m=0,r.replaceState(is({},r.state,{idx:m}),""));function b(S){return typeof S=="string"?S:Sc(S)}function p(S,M){return M===void 0&&(M=null),Nn(is({pathname:f.pathname,hash:"",search:""},typeof S=="string"?ha(S):S,{state:M,key:pa()}))}function g(S,M){return[{usr:S.state,key:S.key,idx:M},b(S)]}function v(S,M,A){return!x.length||(x.call({action:S,location:M,retry:A}),!1)}function j(S){d=S;var M=o();m=M[0],f=M[1],h.call({action:d,location:f})}function N(S,M){var A=He.Push,I=p(S,M);function T(){N(S,M)}if(v(A,I,T)){var P=g(I,m+1),k=P[0],E=P[1];try{r.pushState(k,"",E)}catch{a.location.assign(E)}j(A)}}function y(S,M){var A=He.Replace,I=p(S,M);function T(){y(S,M)}if(v(A,I,T)){var P=g(I,m),k=P[0],E=P[1];r.replaceState(k,"",E),j(A)}}function C(S){r.go(S)}var w={get action(){return d},get location(){return f},createHref:b,push:N,replace:y,go:C,back:function(){C(-1)},forward:function(){C(1)},listen:function(M){return h.push(M)},block:function(M){var A=x.push(M);return x.length===1&&a.addEventListener(oi,li),function(){A(),x.length||a.removeEventListener(oi,li)}}};return w}function Nx(t){t===void 0&&(t={});var s=t,n=s.initialEntries,a=n===void 0?["/"]:n,r=s.initialIndex,o=a.map(function(N){var y=Nn(is({pathname:"/",search:"",hash:"",state:null,key:pa()},typeof N=="string"?ha(N):N));return y}),c=ci(r??o.length-1,0,o.length-1),i=He.Pop,d=o[c],u=wn(),m=wn();function f(N){return typeof N=="string"?N:Sc(N)}function h(N,y){return y===void 0&&(y=null),Nn(is({pathname:d.pathname,search:"",hash:""},typeof N=="string"?ha(N):N,{state:y,key:pa()}))}function x(N,y,C){return!m.length||(m.call({action:N,location:y,retry:C}),!1)}function b(N,y){i=N,d=y,u.call({action:i,location:d})}function p(N,y){var C=He.Push,w=h(N,y);function S(){p(N,y)}x(C,w,S)&&(c+=1,o.splice(c,o.length,w),b(C,w))}function g(N,y){var C=He.Replace,w=h(N,y);function S(){g(N,y)}x(C,w,S)&&(o[c]=w,b(C,w))}function v(N){var y=ci(c+N,0,o.length-1),C=He.Pop,w=o[y];function S(){v(N)}x(C,w,S)&&(c=y,b(C,w))}var j={get index(){return c},get action(){return i},get location(){return d},createHref:f,push:p,replace:g,go:v,back:function(){v(-1)},forward:function(){v(1)},listen:function(y){return u.push(y)},block:function(y){return m.push(y)}};return j}function ci(t,s,n){return Math.min(Math.max(t,s),n)}function li(t){t.preventDefault(),t.returnValue=""}function wn(){var t=[];return{get length(){return t.length},push:function(n){return t.push(n),function(){t=t.filter(function(a){return a!==n})}},call:function(n){t.forEach(function(a){return a&&a(n)})}}}function pa(){return Math.random().toString(36).substr(2,8)}function Sc(t){var s=t.pathname,n=s===void 0?"/":s,a=t.search,r=a===void 0?"":a,o=t.hash,c=o===void 0?"":o;return r&&r!=="?"&&(n+=r.charAt(0)==="?"?r:"?"+r),c&&c!=="#"&&(n+=c.charAt(0)==="#"?c:"#"+c),n}function ha(t){var s={};if(t){var n=t.indexOf("#");n>=0&&(s.hash=t.substr(n),t=t.substr(0,n));var a=t.indexOf("?");a>=0&&(s.search=t.substr(a),t=t.substr(0,a)),t&&(s.pathname=t)}return s}const wx=l.createContext([]);function Ac(t){return t.name==="Pushed"||t.name==="Popped"||t.name==="Replaced"}function kx(t){return t.name==="StepPushed"||t.name==="StepPopped"||t.name==="StepReplaced"}function Cx(t){return Ac(t)||kx(t)}const Tt={IDLE:"idle",PROGRESS:"progress",SUCCEEDED:"succeeded",FAILED:"failed"};function Ic(t){return t===Tt.SUCCEEDED||t===Tt.FAILED}class Sx{targetId;initialSetupProcess;focusCount;previousActivationTrigger;constructor(s,n){this.targetId=s,this.initialSetupProcess=n,this.focusCount=0,this.previousActivationTrigger=null}captureStackChange(s){const n=this.initialSetupProcess.getStatus();if(!Ic(n))return;const a=s.activities.find(o=>o.id===this.targetId);if(!a||!a.isActive)return;const r=s.events.findLast(Ac);!r||this.previousActivationTrigger&&r.eventDate<=this.previousActivationTrigger.eventDate||(this.focusCount++,this.previousActivationTrigger=r)}getActivationCount(){return this.focusCount}getTargetId(){return this.targetId}}const{parse:Ax,stringify:Ix}=JSON,{keys:Tx}=Object,Ls=String,Tc="string",di={},nr="object",Pc=(t,s)=>s,Px=t=>t instanceof Ls?Ls(t):t,Ex=(t,s)=>typeof s===Tc?new Ls(s):s,Ec=(t,s,n,a)=>{const r=[];for(let o=Tx(n),{length:c}=o,i=0;i<c;i++){const d=o[i],u=n[d];if(u instanceof Ls){const m=t[u];typeof m===nr&&!s.has(m)?(s.add(m),n[d]=di,r.push({k:d,a:[t,s,m,a]})):n[d]=a.call(n,d,m)}else n[d]!==di&&(n[d]=a.call(n,d,u))}for(let{length:o}=r,c=0;c<o;c++){const{k:i,a:d}=r[c];n[i]=a.call(n,i,Ec.apply(null,d))}return n},ui=(t,s,n)=>{const a=Ls(s.push(n)-1);return t.set(n,a),a},_x=(t,s)=>{const n=Ax(t,Ex).map(Px),a=n[0],r=s||Pc,o=typeof a===nr&&a?Ec(n,new Set,a,r):a;return r.call({"":o},"",o)},Mx=(t,s,n)=>{const a=Pc,r=new Map,o=[],c=[];let i=+ui(r,o,a.call({"":t},"",t)),d=!i;for(;i<o.length;)d=!0,c[i]=Ix(o[i++],u,n);return"["+c.join(",")+"]";function u(m,f){if(d)return d=!d,f;const h=a.call(this,m,f);switch(typeof h){case nr:if(h===null)return h;case Tc:return r.get(h)||ui(r,o,h)}return h}},_c="@biochain/plugin-navigation-sync";function Mc(t){return{_TAG:_c,flattedState:Mx({activity:t.activity,step:t.step})}}function Rx(t){return typeof t=="object"&&t!==null&&"_TAG"in t&&"flattedState"in t&&typeof t._TAG=="string"&&t._TAG===_c&&typeof t.flattedState=="string"}function tn(t){try{return Rx(t)?_x(t.flattedState):null}catch{return null}}function mi({history:t,pathname:s,state:n,useHash:a}){const r=a?`${t.location.pathname}#${s}`:s;t.push(r,Mc(n))}function ta({history:t,pathname:s,state:n,useHash:a}){const r=a?`${t.location.pathname}#${s}`:s;t.replace(r,Mc(n))}function fi(t){return t.length===0?void 0:t[t.length-1]}const Lx=t=>{let s=Promise.resolve();return{requestHistoryTick:a=>{s=s.then(()=>new Promise(r=>{const o=t.listen(()=>{o(),r()});a(()=>{o(),r()})}))}}};function Rc(t){return new URL(t,"file://")}function xa(t){const s={};return t.forEach((n,a)=>{s[a]=n}),s}function sn(t){return t.endsWith("/")?t:`${t}/`}function pi(t){return t.toString().length>0?`?${t}`:t}function Me({path:t,decode:s},n){const a=t==="*"||t==="/*",r=a?[]:Array.from(t.matchAll(/:([A-Za-z0-9_]+)/g)).map(u=>u[1]).filter(Boolean),o=Array.from(new Set(r)),c=a?Number.POSITIVE_INFINITY:o.length,i=a?"*":sn(t),d=a?null:new URLPattern({pathname:i});return{fill(u){if(a){const x=new URLSearchParams(Object.entries(u).reduce((b,[p,g])=>g?{...b,[p]:g}:b,{}));return sn("/")+pi(x)}let m=t;for(const x of o){const b=u[x];if(b===void 0)throw new Error(`Missing route param: ${x}`);m=m.replace(`:${x}`,encodeURIComponent(b))}m=sn(m);const f={...u};o.forEach(x=>{delete f[x]});const h=new URLSearchParams(Object.entries(f).reduce((x,[b,p])=>({...x,...p?{[b]:p}:null}),{}));return m+pi(h)},parse(u){const m=Rc(u);if(a){const v={...xa(m.searchParams)};return s?s(v):v}if(!d)return null;const f=sn(m.pathname),h=d.exec({pathname:f}),x=xa(m.searchParams);if(!h)return null;const b=h.pathname.groups,p={...x};for(const[g,v]of Object.entries(b))v!==void 0&&(p[g]=v);return s?s(p):p},variableCount:c}}class zx{status;pendingNavigations;dispatchedEvents;baseNavigationEvents;constructor(s,n=[]){this.status=s.length>0?Tt.IDLE:Tt.SUCCEEDED,this.pendingNavigations=s.slice(),this.dispatchedEvents=[],this.baseNavigationEvents=n}captureNavigationOpportunity(s){if(Ic(this.status))return[];if(s&&s.globalTransitionState!=="idle")return[];if(this.pendingNavigations.length===0)return this.status=Tt.SUCCEEDED,[];const n=s?s.events.filter(Cx):[];if(!(this.verifyAllDispatchedEventsAreInNavigationHistory(n)&&this.verifyNoUnknownNavigationEvents(n)))return this.pendingNavigations=[],this.status=Tt.FAILED,[];const a=this.pendingNavigations.shift();if(!a)return[];const r=a();return this.dispatchedEvents.push(...r),this.status=Tt.PROGRESS,r}getStatus(){return this.status}verifyAllDispatchedEventsAreInNavigationHistory(s){const n=new Set(s.map(a=>a.id));return this.dispatchedEvents.every(a=>n.has(a.id))}verifyNoUnknownNavigationEvents(s){const n=new Set([...this.baseNavigationEvents,...this.dispatchedEvents].map(a=>a.id));return s.every(a=>n.has(a.id))}}function Dx(t){return typeof t=="string"?{path:t}:t}function Bx(t){return(Array.isArray(t)?t:[t]).map(Dx)}function Ox(t){return Object.keys(t).flatMap(n=>{const a=t[n];return a?Bx(a).map(r=>({activityName:n,...r})):[]})}class Wx{latestlyBookedSession=Promise.resolve();acquire(){return new Promise(s=>{this.latestlyBookedSession=this.latestlyBookedSession.then(()=>new Promise(n=>s({release:()=>n()})))})}async runExclusively(s){const{release:n}=await this.acquire();try{return await s()}finally{n()}}}class Fx{subscribers=[];publishLock=new Wx;subscribe(s){return this.subscribers.push(s),()=>{this.subscribers=this.subscribers.filter(n=>n!==s)}}publish(s){const n=this.subscribers.slice();return this.publishLock.runExclusively(()=>Promise.allSettled(n.map(a=>a(s))))}}const $x=l.createContext([]),ar=t=>e.jsx($x.Provider,{value:t.routes,children:t.children});ar.displayName="RoutesProvider";ar.__docgenInfo={description:"",methods:[],displayName:"RoutesProvider",props:{routes:{required:!0,tsType:{name:"Array",elements:[{name:"ActivityRoute",elements:[{name:"T"}],raw:"ActivityRoute<T>"}],raw:"ActivityRoute<T>[]"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const qx=/^:[\w-]+$/,Hx=3,Ux=1,Vx=10,Jx=-2,hi=t=>t==="*";function xi(t){const s=t.split("/");let n=s.length;return s.some(hi)&&(n+=Jx),s.filter(a=>!hi(a)).reduce((a,r)=>a+(qx.test(r)?Hx:r===""?Ux:Vx),n)}function Kx(t){return[...t].toSorted((s,n)=>xi(n.path)-xi(s.path))}const Gx=1e3,Qx=60*Gx;function Yx(t){"config"in t&&t.config.decorate("historySync",{makeTemplate:Me,urlPatternOptions:t.urlPatternOptions});const s=t.history??(typeof window>"u"?Nx({}):jx({window})),{location:n}=s,a="routes"in t?t.routes:t.config.activities.reduce((o,c)=>({...o,[c.name]:c.route}),{}),r=Kx(Ox(a));return()=>{let o=0,c=!1,i=null;const d=[],u=new Fx,{requestHistoryTick:m}=Lx(s),f=p=>u.subscribe(async()=>p());let h=null;const x=()=>{const p=d.map(g=>({activityId:g.getTargetId(),activationCount:g.getActivationCount()}));return(!h||h.length!==p.length||h.some(({activityId:g,activationCount:v})=>p.some(({activityId:j,activationCount:N})=>j===g&&N!==v)))&&(h=p),h},b=p=>{let g=!1;for(const v of d){const j=v.getActivationCount();v.captureStackChange(p),j!==v.getActivationCount()&&(g=!0)}g&&u.publish()};return{key:"plugin-history-sync",wrapStack({stack:p}){const g=l.useSyncExternalStore(f,x,x);return e.jsx(Cc,{requestHistoryTick:m,children:e.jsx(ar,{routes:r,children:e.jsx(wx.Provider,{value:g,children:p.render()})})})},overrideInitialEvents({initialContext:p}){const g=tn(s.location.state);if(g)return[{...g.activity.enteredBy,name:"Pushed"},...g.step?.enteredBy.name==="StepPushed"||g.step?.enteredBy.name==="StepReplaced"?[{...g.step.enteredBy,name:"StepPushed"}]:[]];function v(){return p?.req?.path&&typeof p.req.path=="string"?p.req.path:t.useHash?n.hash.split("#")[1]??"/":n.pathname+n.search}const j=v(),N=t.fallbackActivity({initialContext:p}),y=r.find(A=>Me(A,t.urlPatternOptions).parse(j)!==null)??r.find(A=>A.activityName===N),w=Me(y,t.urlPatternOptions).parse(j)??{},S=Object.entries(w).reduce((A,[I,T])=>(typeof T=="string"&&(A[I]=T),A),{}),M=y.defaultHistory?.(S)??[];return i=new zx([...M.map(({activityName:A,activityParams:I,additionalSteps:T=[]})=>()=>{const P=[{name:"Pushed",id:Qe(),activityId:Qe(),activityName:A,activityParams:{...I},activityContext:{path:j,lazyActivityComponentRenderContext:{shouldRenderImmediately:!0}}},...T.map(({stepParams:k,hasZIndex:E})=>({name:"StepPushed",id:Qe(),stepId:Qe(),stepParams:k,hasZIndex:E}))];for(const k of P)k.name==="Pushed"&&d.push(new Sx(k.activityId,i));return P}),()=>[{name:"Pushed",id:Qe(),activityId:Qe(),activityName:y.activityName,activityParams:Me(y,t.urlPatternOptions).parse(j)??xa(Rc(j).searchParams),activityContext:{path:j,lazyActivityComponentRenderContext:{shouldRenderImmediately:!0}}}]]),i.captureNavigationOpportunity(null).map(A=>({...A,eventDate:Date.now()-Qx}))},onInit({actions:{getStack:p,dispatchEvent:g,push:v,stepPush:j}}){const N=p(),y=N.activities[0],C=r.find(A=>A.activityName===y.name),w=Me(C,t.urlPatternOptions),S=fi(y.steps);m(()=>{c=!0,ta({history:s,pathname:w.fill(y.params),state:{activity:y,step:S},useHash:t.useHash})});const M=A=>{if(c){c=!1;return}const I=tn(A.location.state);if(!I)return;const T=I.activity,P=I.activity.id,k=I.step,{activities:E}=p(),z=E.find(K=>K.isActive);if(!z)return;const D=fi(z.steps),L=E.find(K=>K.id===P),V=z.steps.find(K=>K.id===k?.id),_=()=>z.id>P,O=()=>z.id<P,G=()=>z.id===P,Z=()=>G()?!!(!k||D&&D.id>k.id):!1,$=()=>G()?!!(!D||k&&D.id<k.id):!1;if(_()&&(g("Popped",{}),!L&&(o+=1,v({...T.enteredBy}),k?.enteredBy.name==="StepPushed"||k?.enteredBy.name==="StepReplaced"))){const{enteredBy:K}=k;o+=1,j({...K})}if(Z()){if(!V&&k&&(k?.enteredBy.name==="StepPushed"||k?.enteredBy.name==="StepReplaced")){const{enteredBy:K}=k;o+=1,j({...K})}g("StepPopped",{})}if(O()&&(o+=1,v({activityId:T.id,activityName:T.name,activityParams:T.params})),$()){if(!k)return;o+=1,j({stepId:k.id,stepParams:k.params})}};s.listen(M),i?.captureNavigationOpportunity(N).forEach(A=>A.name==="Pushed"?v(A):j(A)),b(N)},onPushed({effect:{activity:p}}){if(o){o-=1;return}const g=r.find(j=>j.activityName===p.name),v=Me(g,t.urlPatternOptions);m(()=>{c=!0,mi({history:s,pathname:v.fill(p.params),state:{activity:p},useHash:t.useHash})})},onStepPushed({effect:{activity:p,step:g}}){if(o){o-=1;return}const v=r.find(N=>N.activityName===p.name),j=Me(v,t.urlPatternOptions);m(()=>{c=!0,mi({history:s,pathname:j.fill(p.params),state:{activity:p,step:g},useHash:t.useHash})})},onReplaced({effect:{activity:p}}){if(!p.isActive)return;const g=r.find(j=>j.activityName===p.name),v=Me(g,t.urlPatternOptions);m(()=>{c=!0,ta({history:s,pathname:v.fill(p.params),state:{activity:p},useHash:t.useHash})})},onStepReplaced({effect:{activity:p,step:g}}){if(!p.isActive)return;const v=r.find(N=>N.activityName===p.name),j=Me(v,t.urlPatternOptions);m(()=>{c=!0,ta({history:s,pathname:j.fill(p.params),state:{activity:p,step:g},useHash:t.useHash})})},onBeforePush({actionParams:p,actions:{overrideActionParams:g}}){if(!p.activityContext||!("path"in p.activityContext)){const v=r.find(y=>y.activityName===p.activityName),N=Me(v,t.urlPatternOptions).fill(p.activityParams);g({...p,activityContext:{...p.activityContext,path:N}})}},onBeforeReplace({actionParams:p,actions:{overrideActionParams:g,getStack:v}}){if(!p.activityContext||!("path"in p.activityContext)){const C=r.find(M=>M.activityName===p.activityName),S=Me(C,t.urlPatternOptions).fill(p.activityParams);g({...p,activityContext:{...p.activityContext,path:S}})}const{activities:j}=v(),N=j.filter(C=>C.transitionState==="enter-active"||C.transitionState==="enter-done"),y=N.length>0?N[N.length-1]:null;if(y)for(let C=0;C<y.steps.length-1;C+=1)m(w=>{tn(s.location.state)?w():(c=!0,s.back())}),m(()=>{c=!0,s.back()})},onBeforeStepPop({actions:{getStack:p}}){const{activities:g}=p();(g.find(j=>j.isActive)?.steps.length??0)>1&&m(()=>{c=!0,s.back()})},onBeforePop({actions:{getStack:p}}){const{activities:g}=p(),v=g.find(j=>j.isActive);if(v){const{isRoot:j,steps:N}=v,y=j?0:N.length;for(let C=0;C<y;C+=1)m(w=>{tn(s.location.state)?w():(c=!0,s.back())}),m(()=>{c=!0,s.back()})}},onChanged({actions:{getStack:p,push:g,stepPush:v}}){const j=p();i?.captureNavigationOpportunity(j).forEach(N=>N.name==="Pushed"?g(N):v(N)),b(j)}}}}function Lc(){const{t}=B(["settings","common"]),[s,n]=l.useState(!1),a=()=>{n(!0);const r="./";window.location.href=`${r}clear.html`};return e.jsx("div",{className:"bg-background flex min-h-screen flex-col items-center justify-center p-6",children:e.jsxs("div",{className:"flex max-w-sm flex-col items-center gap-6 text-center",children:[e.jsx("div",{className:"bg-destructive/10 flex size-20 items-center justify-center rounded-full",children:e.jsx(_e,{className:"text-destructive size-10"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-xl font-bold",children:t("settings:storage.migrationRequired")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:t("settings:storage.migrationDesc")})]}),e.jsx("div",{className:"bg-destructive/5 w-full rounded-lg p-4",children:e.jsxs("ul",{className:"text-destructive space-y-2 text-left text-sm",children:[e.jsxs("li",{children:[" ",t("settings:clearData.item1")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item2")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item3")]})]})}),e.jsxs(q,{variant:"destructive",onClick:a,className:"w-full gap-2",disabled:s,children:[e.jsx(qt,{className:"size-4"}),t("settings:clearData.confirm")]})]})})}Lc.__docgenInfo={description:`


 Stackflow context  useFlow()`,methods:[],displayName:"MigrationRequiredView"};function Xx(t){switch(t){case"confirmed":return"confirmed";case"failed":return"failed";default:return"pending"}}function zc(t,s){const n=t.meta?.displayAmount??"0",a=t.meta?.displaySymbol??"",r=se.fromFormatted(n,s,a);return{id:`${t.chainId}--${t.txHash}`,type:t.meta?.type??"other",status:Xx(t.status),amount:r,symbol:a,address:t.meta?.displayToAddress??t.fromAddress,timestamp:new Date(t.createdAt),hash:t.txHash,chain:t.chainId}}const Dc=l.createContext(null);function jt({chainId:t,children:s,fallback:n=null}){const a=l.useMemo(()=>t?Pe(t):null,[t]);return a?e.jsx(Dc.Provider,{value:a,children:s},t):e.jsx(e.Fragment,{children:n})}function Kt(){const t=l.useContext(Dc);if(!t)throw new Error("useChainProvider must be used within ChainProviderGate. Make sure to wrap your component with <ChainProviderGate chainId={...}>.");return t}jt.__docgenInfo={description:`ChainProvider 

 ChainProvider 
 chainId  fallback  null

@example
\`\`\`tsx
<ChainProviderGate chainId={selectedChain} fallback={<ChainNotSupported />}>
  <WalletContent />
</ChainProviderGate>
\`\`\``,methods:[],displayName:"ChainProviderGate",props:{chainId:{required:!0,tsType:{name:"union",raw:"string | null | undefined",elements:[{name:"string"},{name:"null"},{name:"undefined"}]},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},fallback:{required:!1,tsType:{name:"ReactNode"},description:" provider ",defaultValue:{value:"null",computed:!1}}}};function ga(t,s){return l.useMemo(()=>t?t instanceof Gi?{supported:!1,limited:!1,type:"notSupported",reason:s("common:service.notSupported")}:t instanceof Lu?{supported:!0,limited:!0,type:"limited",reason:s("common:service.limited")}:{supported:!0,limited:!1,type:"error",error:t,reason:t.message}:{supported:!0,limited:!1,type:"ok"},[t,s])}function Zx(t,s){return t==="transfer"?s==="in"?"receive":"send":{swap:"swap",exchange:"exchange",approve:"approve",stake:"stake",unstake:"unstake",mint:"mint",burn:"destroy",gift:"gift",grab:"grab",trust:"trust",signFor:"signFor",emigrate:"emigrate",immigrate:"immigrate",issueAsset:"issueAsset",increaseAsset:"increaseAsset",destroyAsset:"destroy",issueEntity:"issueEntity",destroyEntity:"destroyEntity",locationName:"locationName",dapp:"dapp",certificate:"certificate",mark:"mark",signature:"signature"}[t]??"other"}function eg(t,s){const n=d=>d?s?`${s}--${d}`:d:"unknown";if(!t||!t.hash||!t.assets||t.assets.length===0)return{id:n(t?.hash),type:"other",status:"pending",amount:se.fromRaw("0",8,""),symbol:"",address:t?.from??t?.to??"",timestamp:new Date,hash:t?.hash,chain:s};const a=t.assets[0],r=t.direction==="in"?t.from:t.to;let o=8,c="0",i="";return(a.assetType==="native"||a.assetType==="token")&&(o=a.decimals??8,c=a.value??"0",i=a.symbol??""),{id:n(t.hash),type:Zx(t.action,t.direction),status:t.status,amount:se.fromRaw(c,o,i),symbol:i,address:r,timestamp:new Date(t.timestamp),hash:t.hash,chain:s}}function Bc(t,s){return!t||!Array.isArray(t)?[]:t.filter(n=>n!=null).map(n=>{try{return eg(n,s)}catch(a){return console.warn("[toTransactionInfoList] Failed to convert transaction:",n,a),{id:s?`${s}--${n?.hash??"error"}`:n?.hash??"error",type:"other",status:"pending",amount:se.fromRaw("0",8,""),symbol:"",address:"",timestamp:new Date,chain:s}}})}function tg({address:t,selectedChain:s,selectedChainName:n,mainAssetSymbol:a,wallets:r,currentWalletId:o,chainPreferences:c,onWalletChange:i,onCopyAddress:d,onOpenChainSelector:u,onOpenSettings:m,onOpenWalletList:f,onAddWallet:h,onOpenAddressBalance:x,onOpenAddressTransactions:b}){const{push:p}=Q(),g=Vs(),{t:v}=B(["home","wallet","common","transaction"]),j=st(),N=j.snapshot?Je.getChainById(j,s):void 0,y=Kt(),{data:C=[],isLoading:w,isFetching:S,error:M}=y.allBalances.useState({address:t},{enabled:!!t}),{data:A,isLoading:I,isFetching:T,error:P}=y.transactionHistory.useState({address:t,limit:50},{enabled:!!t}),k=w||S&&C.length===0,E=ga(M,v),z=ga(P,v),{transactions:D,deleteTransaction:L,retryTransaction:V}=Ui(o??void 0,s,t,A),_=l.useMemo(()=>A?Bc(A,s):[],[A,s]),O=I||T&&_.length===0,G=l.useCallback($=>{if($.id){const K=A?.find(re=>re.hash===$.hash),te=K?Dt.stringify(K):void 0;p("TransactionDetailActivity",{txId:$.id,txData:te})}},[p,A]),Z=l.useCallback(($,K)=>[{label:v("home:wallet.transfer"),icon:e.jsx(yo,{className:"size-4"}),onClick:()=>{g.impact("light"),p("SendActivity",{assetType:$.symbol})}},{label:v("home:wallet.destroy"),icon:e.jsx(pn,{className:"size-4"}),onClick:()=>{g.impact("light"),p("DestroyActivity",{assetType:$.symbol,assetLocked:"true"})},variant:"destructive",show:K.canDestroy}],[g,p,v]);return e.jsxs("div",{"data-testid":"wallet-home",className:"flex h-full flex-col overflow-y-auto bg-background",children:[e.jsxs("div",{className:"pt-2 pb-1",children:[e.jsx(ou,{wallets:r,currentWalletId:o,selectedChain:s,chainPreferences:c,onWalletChange:i,onCopyAddress:d,onOpenChainSelector:u,onOpenSettings:m,onOpenWalletList:f,onAddWallet:h,onOpenAddressBalance:x,onOpenAddressTransactions:b}),e.jsxs("div",{className:"mt-2 flex justify-center gap-8 px-6",children:[e.jsxs("button",{onClick:()=>p("SendActivity",{}),"data-testid":"wallet-home-send-button",className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:e.jsx(Co,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:v("home:wallet.send")})]}),e.jsxs("button",{onClick:()=>p("ReceiveActivity",{}),"data-testid":"wallet-home-receive-button",className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:e.jsx(Lf,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:v("home:wallet.receive")})]}),e.jsxs("button",{onClick:()=>p("ScannerActivity",{}),"data-testid":"wallet-home-scan-button",className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:e.jsx(Fu,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:v("common:a11y.scan")})]})]})]}),D.length>0&&e.jsxs("div",{className:"px-4 pt-2 space-y-2",children:[e.jsx("h3",{className:"text-muted-foreground text-xs font-medium uppercase tracking-wider px-1",children:v("transaction:pendingTx.title")}),e.jsx("div",{className:"space-y-1",children:D.slice(0,3).map($=>{const K=zc($,N?.decimals??8);return e.jsx(Qi,{transaction:K,onClick:()=>p("TransactionDetailActivity",{txId:K.id}),onRetry:$.status==="failed"?()=>V($):void 0,onDelete:()=>L($)},$.id)})}),D.length>3&&e.jsx("button",{onClick:()=>p("HistoryActivity",{chain:s}),className:"mt-2 w-full rounded-lg bg-muted/60 py-2 text-xs font-medium text-muted-foreground transition-colors hover:bg-muted",children:v("transaction:pendingTx.viewAll",{count:D.length})})]}),e.jsx("div",{className:"flex-1 pt-3",children:e.jsx(Tu,{chainId:s,chainName:n,tokens:C.map($=>({symbol:$.symbol,name:$.name,chain:s,balance:$.amount.toFormatted(),decimals:$.decimals,fiatValue:void 0,change24h:0,icon:$.icon})),transactions:_.slice(0,5),tokensLoading:k,tokensRefreshing:S&&C.length>0,transactionsLoading:O,transactionsRefreshing:T&&_.length>0,tokensSupported:E.type!=="notSupported",tokensFallbackReason:E.type!=="ok"?E.reason:void 0,transactionsSupported:z.type!=="notSupported"&&z.type!=="limited",transactionsFallbackReason:z.type!=="ok"?z.reason:void 0,onTokenClick:$=>{},onTransactionClick:G,mainAssetSymbol:a,tokenMenuItems:Z,renderTransactionFooter:()=>e.jsx("button",{onClick:()=>p("HistoryActivity",{chain:_.length>0?s:"all"}),className:"mt-3 w-full rounded-lg bg-muted/60 py-2.5 text-sm font-medium text-muted-foreground transition-colors hover:bg-muted",children:_.length>0?v("transaction:history.viewAll",{count:_.length}):v("transaction:history.viewAllChains")}),testId:"wallet-home"})}),e.jsx("div",{className:"shrink-0 h-[var(--tab-bar-height)]"})]})}function Oc(){const{push:t}=Q(),s=Oa(),n=at(),a=Vs(),{t:r}=B(["home","wallet","common","transaction"]),o=du(),c=xu(),i=gu(),d=yt(),u=Ae(),m=zn(),f=u?.id??null,h=Be(),x=ka(),b=r(`common:chains.${h}`,{defaultValue:h}),p=st(),v=(p.snapshot?Je.getChainById(p,h):null)?.symbol;$i();const j=m?.address??"",N=l.useCallback(async T=>{await s.write({text:T}),await a.impact("light"),n.show(r("home:wallet.addressCopied"))},[s,a,n,r]),y=l.useCallback(T=>{T!==f&&pe.setCurrentWallet(T),t("ChainSelectorJob",{})},[t,f]),C=l.useCallback(T=>{const P=d.find(k=>k.id===T);P&&t("WalletConfigActivity",{walletId:T,walletName:P.name})},[t,d]),w=l.useCallback(T=>{pe.setCurrentWallet(T)},[]),S=l.useCallback(()=>{t("WalletAddJob",{})},[t]),M=l.useCallback(()=>{t("WalletListJob",{})},[t]),A=l.useCallback(()=>{t("AddressBalanceActivity",{})},[t]),I=l.useCallback(()=>{t("AddressTransactionsActivity",{})},[t]);return o?e.jsx(Lc,{}):c?!i||!u?e.jsx(sg,{}):e.jsx(jt,{chainId:h,fallback:e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:r("common:ecosystem.chainNotSupported")})}),children:e.jsx(tg,{address:j,selectedChain:h,selectedChainName:b,mainAssetSymbol:v,wallets:d,currentWalletId:f,chainPreferences:x,onWalletChange:w,onCopyAddress:N,onOpenChainSelector:y,onOpenSettings:C,onOpenWalletList:M,onAddWallet:S,onOpenAddressBalance:A,onOpenAddressTransactions:I})}):e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(Se,{size:"lg"})})}function sg(){const{push:t}=Q(),{t:s}=B("home");return e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-6 p-6 text-center",children:[e.jsx("div",{className:"bg-primary/10 rounded-full p-6",children:e.jsx(nt,{className:"text-primary size-12"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:s("welcome.title")}),e.jsx("p",{className:"text-muted-foreground mt-2",children:s("welcome.subtitle")})]}),e.jsxs("div",{className:"flex w-full max-w-xs flex-col gap-3",children:[e.jsx(ze,{variant:"mint",className:"w-full","data-testid":"create-wallet-button",onClick:()=>t("WalletCreateActivity",{}),children:s("welcome.createWallet")}),e.jsx(q,{variant:"outline",className:"w-full","data-testid":"import-wallet-button",onClick:()=>t("OnboardingRecoverActivity",{}),children:s("welcome.importWallet")})]})]})}Oc.__docgenInfo={description:"",methods:[],displayName:"WalletTab"};const ng=Ia(["defi","nft","tools","games","social","exchange","other"]),ag=Ta([Ye(!0),Is({timeout:Ot().int().positive().optional()}).passthrough()]),rg=Ia(["auto","dark","light"]),ig=Ia(["stack","mine"]),Wc=Is({id:H(),name:H(),description:H(),longDescription:H().optional(),icon:H(),url:H(),version:H(),author:H().optional(),website:H().optional(),category:ng.optional(),tags:Xe(H()).optional(),permissions:Xe(H()).optional(),chains:Xe(H()).optional(),screenshots:Xe(H()).optional(),minWalletVersion:H().optional(),publishedAt:H().optional(),updatedAt:H().optional(),beta:Ze().optional(),officialScore:Ot().min(0).max(100).optional(),communityScore:Ot().min(0).max(100).optional(),splashScreen:ag.optional(),capsuleTheme:rg.optional(),targetDesktop:ig.optional(),themeColor:H().optional(),themeColorFrom:H().optional(),themeColorTo:H().optional()}).passthrough(),og=Is({name:H(),version:H(),updated:H(),icon:H().optional(),search:Is({urlTemplate:H()}).passthrough().optional(),apps:Xe(Wc)}).passthrough();Is({version:H(),data:Xe(Wc)}).passthrough();const cg=15,lg=1440*60*1e3;function dg(t){return Math.floor(t.getTime()/lg)}function ug(t=new Date){const s=dg(t);return cg*(s+1)%100}function gi(t,s=new Date){const n=typeof t.officialScore=="number"?t.officialScore:0,a=typeof t.communityScore=="number"?t.communityScore:0,r=ug(s),o=100-r;return(n*r+a*o)/100}function mg(t){const s=typeof document<"u"?document.baseURI:"file:///",n=new URL(t,s).toString();return a=>a.startsWith("http://")||a.startsWith("https://")||a.startsWith("data:")?a:new URL(a,n).toString()}const fg="ecosystem-sources",os="sources";async function Fc(){return new Promise((t,s)=>{const n=indexedDB.open(fg,1);n.onerror=()=>s(n.error),n.onsuccess=()=>t(n.result),n.onupgradeneeded=()=>{const a=n.result;a.objectStoreNames.contains(os)||a.createObjectStore(os,{keyPath:"url"})}})}async function pg(t){try{const s=await Fc();return new Promise((n,a)=>{const c=s.transaction(os,"readonly").objectStore(os).get(t);c.onerror=()=>a(c.error),c.onsuccess=()=>n(c.result??null)})}catch{return null}}async function hg(t){try{const s=await Fc();await new Promise(n=>{const r=s.transaction(os,"readwrite").objectStore(os),o=t.url,c=r.keyPath?r.put(t):r.put(t,o);c.onerror=()=>n(),c.onsuccess=()=>n()})}catch{}}const nn=300*1e3,zs=new Map;function xg(t){if(typeof window>"u")return t;const s=t.trim();if(s.length===0)return t;if(/^[a-zA-Z][a-zA-Z\d+.-]*:/.test(s))return s;if(s.startsWith("//"))return`${window.location.protocol}${s}`;try{const n=typeof document<"u"?document.baseURI:window.location.origin;return new URL(s,n).toString()}catch{return t}}function gg(t){const s=zs.get(t);return s?Date.now()>s.expiresAt?(zs.delete(t),null):s.data:null}function an(t,s,n){zs.set(t,{data:s,expiresAt:Date.now()+n})}function $c(t){for(const s of zs.keys())s.startsWith(t)&&zs.delete(s)}async function rr(t){const s=xg(t),n=s,a=gg(`source:${n}`);if(a)return a;const r=await pg(n),o={};r?.etag&&(typeof window>"u"||new URL(s).origin===window.location.origin)&&(o["If-None-Match"]=r.etag);try{const c=await fetch(s,{headers:o});if(c.status===304&&r)return an(`source:${n}`,r.data,nn),r.data;if(!c.ok)return c.status,r?(an(`source:${n}`,r.data,nn),r.data):null;const i=c.headers.get("content-type")??"";let d;try{d=await c.json()}catch(h){return h instanceof Error?h.message:String(h),r?r.data:null}const u=og.safeParse(d);if(!u.success)return u.error.issues.map(h=>h.path.join(".")),r?r.data:null;const m=u.data,f=c.headers.get("etag")??void 0;return await hg({url:n,data:m,etag:f,cachedAt:Date.now()}),an(`source:${n}`,m,nn),m.apps?.length,m}catch(c){return c instanceof Error?c.message:String(c),r?(an(`source:${n}`,r.data,nn),r.data):null}}let cs=[];const js=new Map,fn=[];function qc(){const t=[...cs];fn.forEach(s=>s(t))}function vi(t){if(t.length===0)return 0;if(t.length===1)return t[0]??0;const s=t.reduce((d,u)=>d+u,0)/t.length,n=t.reduce((d,u)=>d+Math.pow(u-s,2),0)/Math.max(1,t.length-1),a=Math.sqrt(n),r=a>0?a:1,o=.05;let c=0,i=0;for(const d of t){const u=(d-s)/r,m=Math.exp(-.5*u*u),f=Math.max(o,m);c+=d*f,i+=f}return i===0?s:c/i}function Hc(t,s){const n=[],a=new Map,r=new Map,o=new Map;for(const c of t){const i=s.get(c.url);if(i)for(const d of i.apps??[]){const u=bg(d,c,i);if(!u)continue;const m=u.id;if(a.has(m)||(a.set(m,n.length),n.push(u)),typeof u.officialScore=="number"){const f=r.get(m)??[];f.push(u.officialScore),r.set(m,f)}if(typeof u.communityScore=="number"){const f=o.get(m)??[];f.push(u.communityScore),o.set(m,f)}}}for(const[c,i]of a){const d=n[i];if(!d)continue;const u=r.get(c);u&&u.length>0&&(d.officialScore=vi(u));const m=o.get(c);m&&m.length>0&&(d.communityScore=vi(m))}return t.length,n.length,n}function vg(t){return fn.push(t),()=>{const s=fn.indexOf(t);s>=0&&fn.splice(s,1)}}function yg(t){return/^[a-z0-9]+(?:\.[a-z0-9-]+)+$/i.test(t)}function bg(t,s,n){if(!yg(t.id))return null;const a=mg(s.url);return{...t,icon:a(t.icon),url:a(t.url),screenshots:t.screenshots?.map(a),splashScreen:t.splashScreen,sourceUrl:s.url,sourceName:s.name,sourceIcon:s.icon??(n.icon?a(n.icon):void 0)}}async function jg(t){return rr(t)}async function ir(){const t=Aa.getEnabledSources(Bt.state);t.length,await Promise.all(t.map(async s=>{const n=await jg(s.url);js.set(s.url,n),cs=Hc(t,js),qc()}))}function Ng(t){return t.map(s=>`${s.url}|${s.enabled?"1":"0"}`).sort().join(",")}let yi="";Bt.subscribe(()=>{const t=Ng(Bt.state.sources);t!==yi&&(yi=t,ir())});async function Uc(t){await ir(),t?.refresh===!0&&or({force:!1})}async function or(t){const s=t?.force===!0,n=Aa.getEnabledSources(Bt.state);return n.length,s&&$c("source:"),await Promise.all(n.map(async a=>{je.updateSourceStatus(a.url,"loading");try{const r=await rr(a.url);je.updateSourceStatus(a.url,"success"),js.set(a.url,r)}catch(r){const o=r instanceof Error?r.message:"Unknown error";je.updateSourceStatus(a.url,"error",o),js.set(a.url,null)}finally{cs=Hc(n,js),qc()}})),[...cs]}async function wg(t){je.updateSourceStatus(t,"loading");try{$c(`source:${t}`),await rr(t)?(je.updateSourceStatus(t,"success"),await ir()):je.updateSourceStatus(t,"error","Failed to fetch source")}catch(s){const n=s instanceof Error?s.message:"Unknown error";je.updateSourceStatus(t,"error",n)}}function kg(){return[...cs]}function bi(t){return cs.find(s=>s.id===t)}function Vc(){const{push:t}=Q(),s=l.useRef(null),[n,a]=l.useState([]),[r,o]=l.useState(!0),c=we(Bt,b=>b.myApps);l.useEffect(()=>{let b=!1;const p=vg(g=>{a(g),b||(b=!0,o(!1))});return Uc({refresh:!0}).then(()=>{b||(a(kg()),o(!1))}),()=>p()},[]),Ju();const i=l.useCallback(b=>{t("MiniappDetailActivity",{appId:encodeURIComponent(b.id)})},[t]),d=l.useCallback(b=>{je.installApp(b.id),je.updateAppLastUsed(b.id),je.setActiveSubPage("mine"),s.current?.slideTo("mine"),requestAnimationFrame(()=>{Zi(b.id,{...b,targetDesktop:"mine"})})},[]),u=l.useCallback(b=>{je.uninstallApp(b)},[]),m=l.useMemo(()=>c.map(b=>({...b,app:n.find(p=>p.id===b.appId)})).filter(b=>!!b.app).map(({app:b,lastUsedAt:p})=>({app:b,lastUsed:p})),[c,n]),f=l.useMemo(()=>n.length===0?[]:[...n].toSorted((b,p)=>gi(p)-gi(b)).slice(0,2),[n]),h=l.useMemo(()=>{const b=new Set(f.map(p=>p.id));return[...n].filter(p=>!b.has(p.id)).toSorted((p,g)=>(g.officialScore??0)-(p.officialScore??0)).slice(0,6)},[n,f]),x=l.useMemo(()=>[...n].toSorted((b,p)=>(p.communityScore??0)-(b.communityScore??0)).slice(0,10),[n]);return r?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(Se,{size:"lg"})}):e.jsx(am,{ref:s,showDiscoverPage:!0,showStackPage:"auto",apps:n,myApps:m,featuredApps:f,recommendedApps:h,hotApps:x,onAppOpen:d,onAppDetail:i,onAppRemove:u})}Vc.__docgenInfo={description:"",methods:[],displayName:"EcosystemTab"};const Cg=/^(\d+)\.(\d+)\.(\d+)(?:-([0-9A-Za-z.-]+))?$/;function ji(t){const s=t.match(Cg);if(!s)return null;const[,n,a,r,o]=s,c=o&&/^\d+$/.test(o)?Number(o):void 0;return{major:Number(n),minor:Number(a),patch:Number(r),suffix:o??void 0,suffixNumber:c}}function Sg(t,s){const n=ji(t),a=ji(s);if(!n||!a)return null;if(n.major!==a.major)return n.major-a.major;if(n.minor!==a.minor)return n.minor-a.minor;if(n.patch!==a.patch)return n.patch-a.patch;const r=n.suffixNumber??(n.suffix?Number.NaN:0),o=a.suffixNumber??(a.suffix?Number.NaN:0);return!Number.isNaN(r)&&!Number.isNaN(o)?r-o:n.suffix&&!a.suffix?1:!n.suffix&&a.suffix?-1:n.suffix&&a.suffix?n.suffix.localeCompare(a.suffix):0}function Ag(t){return t.endsWith("/")?t:`${t}/`}function Ig(){const t=Ag("https://BioforestChain.github.io"),s="dweb/metadata.json";return new URL(s,t).toString()}function Tg(t){return`dweb://install?url=${encodeURIComponent(t)}`}async function Pg(t){const s=await fetch(t,{cache:"no-store"});if(!s.ok)throw new Error(`metadata fetch failed: ${s.status}`);const n=await s.json(),a=typeof n.version=="string"?n.version:"",r=typeof n.change_log=="string"?n.change_log:n.changeLog;return{version:a,changeLog:r}}async function Eg(){const t="0.4.0";let s="",n="";try{s=Ig(),n=Tg(s)}catch(a){const r=a instanceof Error?a.message:"invalid site origin";return{status:"error",currentVersion:t,metadataUrl:s,installUrl:n,error:r}}if(!Eu())return{status:"not-dweb",currentVersion:t,metadataUrl:s,installUrl:n};try{const a=await Pg(s);if(!a.version)return{status:"error",currentVersion:t,metadataUrl:s,installUrl:n,error:"metadata version missing"};const r=Sg(a.version,t);return r===null?{status:"error",currentVersion:t,metadataUrl:s,installUrl:n,error:"version parse failed"}:r>0?{status:"update-available",currentVersion:t,latestVersion:a.version,metadataUrl:s,installUrl:n,changeLog:a.changeLog}:{status:"up-to-date",currentVersion:t,latestVersion:a.version,metadataUrl:s,installUrl:n,changeLog:a.changeLog}}catch(a){const r=a instanceof Error?a.message:"unknown error";return{status:"error",currentVersion:t,metadataUrl:s,installUrl:n,error:r}}}const _g={status:"idle",currentVersion:"0.4.0",dialogOpen:!1},St=new au(_g),Mg={openDialog:()=>{St.setState(t=>({...t,dialogOpen:!0}))},closeDialog:()=>{St.setState(t=>({...t,dialogOpen:!1}))},check:async t=>{const{status:s}=St.state;if(s==="checking")return{status:"error",currentVersion:"0.4.0",metadataUrl:"",installUrl:"",error:"already checking"};St.setState(a=>({...a,status:"checking"}));const n=await Eg();return St.setState(a=>({...a,status:n.status,currentVersion:n.currentVersion,latestVersion:n.latestVersion,changeLog:n.changeLog,metadataUrl:n.metadataUrl,installUrl:n.installUrl,error:n.error,lastCheckedAt:Date.now(),dialogOpen:n.status==="update-available"?!0:a.dialogOpen})),t==="auto"&&n.status!=="update-available"&&St.setState(a=>({...a,dialogOpen:!1})),n}};function Rg(){return we(St)}function Ne({icon:t,label:s,value:n,showChevron:a=!0,disabled:r=!1,onClick:o,trailing:c,className:i,testId:d}){const u=o?"button":"div";return e.jsxs(u,{type:o?"button":void 0,onClick:r?void 0:o,disabled:r,"data-testid":d,className:R("bg-background flex w-full items-center gap-3 rounded-xl px-4 py-3.5","transition-colors",o&&!r&&"hover:bg-muted/50 active:bg-muted",r&&"cursor-not-allowed",i),children:[t&&e.jsx("span",{className:"bg-muted text-foreground flex size-8 shrink-0 items-center justify-center rounded-lg",children:t}),e.jsx("span",{className:R("flex-1 text-left text-sm font-medium",r&&"text-muted-foreground"),children:s}),c??e.jsxs(e.Fragment,{children:[n&&e.jsx("span",{className:"text-muted-foreground text-sm",children:n}),a&&o&&e.jsx(Te,{className:"text-muted-foreground/50 size-5"})]})]})}Ne.__docgenInfo={description:"",methods:[],displayName:"SettingsItem",props:{icon:{required:!1,tsType:{name:"union",raw:"ReactNode | undefined",elements:[{name:"ReactNode"},{name:"undefined"}]},description:""},label:{required:!0,tsType:{name:"string"},description:""},value:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},showChevron:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"",defaultValue:{value:"true",computed:!1}},disabled:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"",defaultValue:{value:"false",computed:!1}},onClick:{required:!1,tsType:{name:"union",raw:"(() => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},trailing:{required:!1,tsType:{name:"union",raw:"ReactNode | undefined",elements:[{name:"ReactNode"},{name:"undefined"}]},description:""},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:" className"},testId:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:" ID"}}};function vs({title:t,children:s,className:n,allowContextMenu:a}){return e.jsxs("section",{className:R("space-y-1",n),"data-allow-context-menu":a?"true":void 0,children:[t&&e.jsx("h3",{className:"mb-2 px-1 text-xs font-medium uppercase text-muted-foreground",children:t}),e.jsx("div",{className:"overflow-hidden rounded-xl bg-card shadow-sm",children:s})]})}vs.__docgenInfo={description:"",methods:[],displayName:"SettingsSection",props:{title:{required:!1,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},className:{required:!1,tsType:{name:"string"},description:" className"},allowContextMenu:{required:!1,tsType:{name:"boolean"},description:"DWEB "}}};const Lg=[{value:"system",icon:hf},{value:"light",icon:Ff},{value:"dark",icon:Af}];function Jc({open:t,onOpenChange:s}){const{t:n}=B("settings"),a=Wi(),r=o=>{_n.setTheme(o),s(!1)};return e.jsx(ut,{open:t,onOpenChange:s,children:e.jsxs(mt,{side:"bottom",className:"rounded-t-2xl",children:[e.jsx(ft,{children:e.jsx(pt,{children:n("appearance.title")})}),e.jsx("div",{className:"mt-4 space-y-2",children:Lg.map(({value:o,icon:c})=>e.jsxs("button",{onClick:()=>r(o),className:R("flex w-full items-center gap-3 rounded-xl p-4 transition-colors",a===o?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx(c,{size:24}),e.jsx("span",{className:"flex-1 text-left font-medium",children:n(`appearance.${o}`)}),a===o&&e.jsx(xe,{size:20})]},o))})]})})}Jc.__docgenInfo={description:"",methods:[],displayName:"AppearanceSheet",props:{open:{required:!0,tsType:{name:"boolean"},description:""},onOpenChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(open: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"open"}],return:{name:"void"}}},description:""}}};const Le=ve.t.bind(ve);async function zg(t,s){const n=Pe(t.id);if(!n.estimateFee||!n.buildTransaction){const r=As.getBiowalletApi(t.id);if(!r)throw new Error(Le("error:transaction.feeEstimateFailed"));const o=await mr(r,t.id,s,"1");return{amount:se.fromRaw(o,t.decimals,t.symbol),symbol:t.symbol}}const a=await n.buildTransaction({type:"transfer",from:s,to:s,amount:se.fromRaw("1",t.decimals,t.symbol)});try{return{amount:(await n.estimateFee(a)).standard.amount,symbol:t.symbol}}catch{const r=As.getBiowalletApi(t.id);if(!r)throw new Error(Le("error:transaction.feeEstimateFailed"));const o=await mr(r,t.id,s,"1");return{amount:se.fromRaw(o,t.decimals,t.symbol),symbol:t.symbol}}}async function Ni({chainConfig:t,walletId:s,password:n,fromAddress:a,toAddress:r,amount:o,assetType:c,fee:i,twoStepSecret:d}){let u;try{u=await as.getMnemonic(s,n)}catch(f){return f instanceof Rn&&f.code===Ln.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:f instanceof Error?f.message:Le("error:unknown")}}if(!o.isPositive())return{status:"error",message:Le("error:validation.enterValidAmount")};const m=Pe(t.id);if(!m.supportsFullTransaction)return{status:"error",message:Le("error:transaction.chainNotSupported")};try{let f=null;if(m.bioGetAccountInfo){if(f=(await m.bioGetAccountInfo(a)).secondPublicKey,f&&!d)return{status:"password_required",secondPublicKey:f};if(d&&f&&m.bioVerifyPayPassword&&!await m.bioVerifyPayPassword({mainSecret:u,paySecret:d,publicKey:f}))return{status:"error",message:Le("error:transaction.securityPasswordFailed")}}const h=await m.buildTransaction({type:"transfer",from:a,to:r,amount:o,fee:i,bioAssetType:c}),x=await m.signTransaction(h,{privateKey:new TextEncoder().encode(u),bioSecret:u,bioPaySecret:d}),b=await dt.create({walletId:Ki(t.id,a),chainId:t.id,fromAddress:a,rawTx:x,meta:{type:"send",displayAmount:o.toFormatted(),displaySymbol:c,displayToAddress:r}});await dt.updateStatus({id:b.id,status:"broadcasting"});try{const p=await m.broadcastTransaction(x);return await dt.updateStatus({id:b.id,status:"broadcasted",txHash:p}),{status:"ok",txHash:p,pendingTxId:b.id}}catch(p){const g=p;return await dt.updateStatus({id:b.id,status:"failed",errorCode:"BROADCAST_FAILED",errorMessage:g.message}),{status:"error",message:g.message,pendingTxId:b.id}}}catch(f){return{status:"error",message:(f instanceof Error?f.message:String(f))||Le("error:transaction.failed")}}}async function Dg({chainConfig:t,walletId:s,password:n,fromAddress:a,newTwoStepSecret:r}){let o;try{o=await as.getMnemonic(s,n)}catch(i){return i instanceof Rn&&i.code===Ln.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:i instanceof Error?i.message:Le("error:unknown")}}const c=Pe(t.id);if(!c.supportsFullTransaction)return{status:"error",message:Le("error:transaction.chainNotSupported")};try{if(c.bioGetAccountInfo&&(await c.bioGetAccountInfo(a)).secondPublicKey)return{status:"already_set"};const i=await c.buildTransaction({type:"setPayPassword",from:a}),d=await c.signTransaction(i,{privateKey:new TextEncoder().encode(o),bioSecret:o,bioNewPaySecret:r});return{status:"ok",txHash:await c.broadcastTransaction(d)}}catch(i){const d=i instanceof Error?i.message:String(i);return d.includes("fee")||d.includes("")?{status:"error",message:Le("error:insufficientFunds")}:{status:"error",message:d||Le("error:transaction.failed")}}}async function Bg(t){const s=Pe(t.id);if(!s.buildTransaction||!s.estimateFee)return null;try{const n=await s.buildTransaction({type:"setPayPassword",from:"0x0000000000000000000000000000000000000000"});return{amount:(await s.estimateFee(n)).standard.amount,symbol:t.symbol}}catch{return null}}async function Og(t,s){const n=Pe(t.id);if(!n.bioGetAccountInfo)return!1;try{return!!(await n.bioGetAccountInfo(s)).secondPublicKey}catch{return!1}}const de=lx,Kc=fx;function kn({title:t,children:s,className:n}){return e.jsxs("div",{className:R("bg-background rounded-t-2xl",n),children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),t&&e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t})}),s,e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}kn.__docgenInfo={description:"Standard sheet content wrapper with handle, title, and safe area",methods:[],displayName:"SheetContent",props:{title:{required:!1,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};function Wg(t,s=10,n=8){return t.length<=s+n+3?t:`${t.slice(0,s)}...${t.slice(-n)}`}const Gc=()=>{const{t}=B(["home","common"]),{pop:s}=Q(),n=Ae(),a=Be(),r=$t(),o=l.useMemo(()=>n?n.chainAddresses.map(i=>i.chain):[],[n]),c=i=>{pe.setSelectedChain(i),s()};return e.jsx(de,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("home:wallet.selectNetwork")})}),e.jsx("div",{"data-testid":"chain-sheet",className:"max-h-[60vh] space-y-2 overflow-y-auto p-4",children:o.map(i=>{const d=n?.chainAddresses.find(u=>u.chain===i);return e.jsxs("button",{"data-testid":`chain-option-${i}`,onClick:()=>c(i),className:`flex w-full items-center gap-3 rounded-xl p-4 transition-colors ${i===a?"bg-primary/10 ring-1 ring-primary":"bg-muted/50 hover:bg-muted"}`,children:[e.jsx(xt,{chain:i,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:r[i]??i}),e.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:d?.address?Wg(d.address):"---"})]}),i===a&&e.jsx(xe,{className:"size-5 text-primary"})]},i)})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};Gc.__docgenInfo={description:"",methods:[],displayName:"ChainSelectorJob"};const wi={"/":"MainTabsActivity","/wallet/list":"WalletListActivity","/wallet/create":"WalletCreateActivity","/send":"SendActivity","/receive":"ReceiveActivity","/settings":"SettingsActivity","/settings/language":"SettingsLanguageActivity","/settings/currency":"SettingsCurrencyActivity","/settings/chains":"SettingsChainsActivity","/settings/mnemonic":"SettingsMnemonicActivity","/settings/wallet-lock":"SettingsWalletLockActivity","/settings/wallet-chains":"SettingsWalletChainsActivity","/settings/storage":"SettingsStorageActivity","/settings/sources":"SettingsSourcesActivity","/history":"HistoryActivity","/scanner":"ScannerActivity","/onboarding/recover":"OnboardingRecoverActivity","/address-book":"AddressBookActivity","/my-card":"MyCardActivity","/notifications":"NotificationsActivity","/staking":"StakingActivity","/welcome":"WelcomeActivity"},Fg=[{pattern:/^\/wallet\/([^/]+)$/,activity:"WalletConfigActivity",paramExtractor:t=>({walletId:t[1]??""})},{pattern:/^\/transaction\/([^/]+)$/,activity:"TransactionDetailActivity",paramExtractor:t=>({txId:t[1]??""})},{pattern:/^\/authorize\/address\/([^/]+)$/,activity:"AuthorizeAddressActivity",paramExtractor:t=>({id:t[1]??""})},{pattern:/^\/authorize\/signature\/([^/]+)$/,activity:"AuthorizeSignatureActivity",paramExtractor:t=>({id:t[1]??""})},{pattern:/^\/token\/([^/]+)$/,activity:"TokenDetailActivity",paramExtractor:t=>({tokenId:t[1]??""})}];function $g(t){if(wi[t])return{activity:wi[t],params:{}};for(const{pattern:s,activity:n,paramExtractor:a}of Fg){const r=t.match(s);if(r)return{activity:n,params:a(r)}}return null}function ae(){const t=Q();return{navigate:a=>{const r=typeof a=="string"?{to:a}:a,o=$g(r.to);if(!o)return;const c={...o.params,...r.search};r.replace?t.replace(o.activity,c,{animate:!0}):t.push(o.activity,c,{animate:!0})},goBack:()=>{t.pop()}}}const Qc=l.createContext({});function ce({params:t,children:s}){return e.jsx(Qc.Provider,{value:t,children:s})}function ue(){return l.useContext(Qc)}ce.__docgenInfo={description:"",methods:[],displayName:"ActivityParamsProvider",props:{params:{required:!0,tsType:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""}}};function qg(){const{t}=B("wallet"),{pop:s}=Q(),{walletId:n}=ue(),r=yt().find(u=>u.id===n),[o,c]=l.useState(r?.name??"");l.useEffect(()=>{r&&c(r.name)},[r]);const i=l.useCallback(()=>{if(!r)return;const u=o.trim();u&&(pe.updateWalletName(r.id,u),s())},[r,o,s]);if(!r)return null;const d=o.trim().length>0&&o.trim()!==r.name;return e.jsx(de,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("editSheet.renameTitle")})}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"wallet-name",className:"text-sm font-medium",children:t("editSheet.walletName")}),e.jsx("input",{id:"wallet-name",type:"text",value:o,onChange:u=>c(u.target.value),placeholder:t("editSheet.walletNamePlaceholder"),maxLength:20,className:R("w-full rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")}),e.jsxs("p",{className:"text-right text-xs text-muted-foreground",children:[o.length,"/20"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:i,disabled:!d,className:R("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t("editSheet.save")}),e.jsx("button",{onClick:()=>s(),className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("editSheet.cancel")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Yc=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(qg,{})});Yc.__docgenInfo={description:"",methods:[],displayName:"WalletRenameJob"};function Hg(){const{t}=B("wallet"),{pop:s}=Q(),{navigate:n}=ae(),{walletId:a}=ue(),o=yt().find(x=>x.id===a),[c,i]=l.useState([]),[d,u]=l.useState(!1),[m,f]=l.useState(!1),h=l.useCallback(async x=>{if(!(!o||x.length<4)){if(!o.encryptedMnemonic){pe.deleteWallet(o.id),n({to:"/"});return}f(!0),u(!1);try{const b=gt(x);if(!await Mt(o.encryptedMnemonic,b)){u(!0),i([]);return}pe.deleteWallet(o.id),n({to:"/"})}catch{u(!0),i([])}finally{f(!1)}}},[o,n]);return o?e.jsx(de,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("editSheet.deleteTitle")})}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsx("p",{className:"text-center text-muted-foreground",children:t("editSheet.deleteWarning",{name:o.name})}),e.jsx(Ut,{value:c,onChange:i,onComplete:h,minPoints:4,error:d,disabled:m}),e.jsx("div",{className:"space-y-3",children:e.jsx("button",{onClick:()=>s(),disabled:m,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("editSheet.cancel")})})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}):null}const Xc=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(Hg,{})});Xc.__docgenInfo={description:"",methods:[],displayName:"WalletDeleteJob"};let Cn=null,cr=null;function Nt(t,s){Cn=t,cr=null}function Ug(){Cn=null,cr=null}function Vg(){const{t}=B("security"),{pop:s}=Q(),{title:n,description:a,biometricAvailable:r}=ue(),[o,c]=l.useState([]),[i,d]=l.useState(!1),[u,m]=l.useState(null),[f,h]=l.useState(!1),x=l.useRef(null),b=l.useRef(null),p=l.useRef(null),g=l.useRef(!1);!g.current&&Cn&&(b.current=Cn,p.current=cr,Ug(),g.current=!0);const v=n??t("patternLock.unlockTitle"),j=r==="true"&&p.current,N=l.useCallback(()=>{x.current&&(clearTimeout(x.current),x.current=null),d(!1),m(null)},[]),y=l.useCallback(S=>{i&&S.length>0&&N(),c(S)},[i,N]),C=l.useCallback(async S=>{const M=b.current;if(!(S.length<4||!M)){h(!0),N();try{const A=gt(S);await M(A)?s():(d(!0),m(t("walletLock.error")),c([]),x.current=setTimeout(()=>{d(!1),m(null)},1500))}catch(A){d(!0),m(A instanceof Error?A.message:t("walletLock.error")),c([]),x.current=setTimeout(()=>{d(!1),m(null)},1500)}finally{h(!1)}}},[s,N]),w=l.useCallback(async()=>{const S=p.current;if(S){h(!0),N();try{await S()?s():(d(!0),x.current=setTimeout(()=>{d(!1)},1500))}catch{d(!0),x.current=setTimeout(()=>{d(!1)},1500)}finally{h(!1)}}},[s,N]);return e.jsx(de,{"data-testid":"wallet-lock-dialog",children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsxs("div",{className:"px-4 pb-4 text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:v}),a&&e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:a})]}),e.jsxs("div",{className:"px-4 pb-4",children:[e.jsx(Ut,{value:o,onChange:y,onComplete:C,minPoints:4,error:i,disabled:f,"data-testid":"wallet-lock-pattern"}),i&&u&&e.jsx("p",{className:"mt-2 text-center text-sm text-destructive",children:u})]}),e.jsxs("div",{className:"space-y-3 px-4 pb-4",children:[j&&e.jsxs("button",{type:"button",onClick:w,disabled:f,className:R("flex w-full items-center justify-center gap-2 rounded-full border border-border py-3 font-medium transition-colors","hover:bg-muted","disabled:cursor-not-allowed disabled:opacity-50"),children:[e.jsx(bf,{className:"size-5"}),e.jsx("span",{children:t("walletLock.biometric")})]}),e.jsx("button",{type:"button",onClick:()=>s(),disabled:f,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("walletLock.cancel")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Zc=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(Vg,{})});Zc.__docgenInfo={description:"",methods:[],displayName:"WalletLockConfirmJob"};let Jg=null;function Kg(){const{t}=B(["security","transaction","common"]),{pop:s}=Q(),{title:n,description:a}=ue(),[r,o]=l.useState(""),[c,i]=l.useState(),[d,u]=l.useState(!1),m=l.useRef(null);l.useRef(!1).current;const h=n??t("security:twoStepSecret.confirmTitle"),x=a??t("security:twoStepSecret.confirmDesc"),b=l.useCallback(async g=>{g.preventDefault();const v=m.current;if(!(!r.trim()||!v)){u(!0),i(void 0);try{await v(r)?s():i(t("security:twoStepSecret.notMatch"))}catch{i(t("security:twoStepSecret.notMatch"))}finally{u(!1)}}},[r,s,t]),p=r.trim().length>0&&!d;return e.jsx(de,{"data-testid":"two-step-secret-dialog",children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx($s,{className:"size-5 text-primary"}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:h})]})}),e.jsxs("form",{onSubmit:b,className:"space-y-6 p-4",children:[e.jsx("p",{className:"text-center text-muted-foreground text-sm",children:x}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(hn,{value:r,onChange:g=>o(g.target.value),placeholder:t("security:twoStepSecret.inputPlaceholder"),disabled:d,"aria-describedby":c?"two-step-secret-error":void 0,"data-testid":"two-step-secret-input"}),c&&e.jsxs("div",{id:"two-step-secret-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(vt,{className:"size-4"}),e.jsx("span",{children:c})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{type:"submit",disabled:!p,"data-testid":"two-step-secret-confirm-button",className:R("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(d?"security:walletLock.verifying":"common:confirm")}),e.jsx("button",{type:"button",onClick:()=>s(),disabled:d,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("security:walletLock.cancel")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const el=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(Kg,{})});el.__docgenInfo={description:"",methods:[],displayName:"TwoStepSecretConfirmJob"};let Ns=null,Sn=null;function tl(t,s){Ns=t,Sn=s}function ki(){Ns=null,Sn=null}function Gg(){const{t}=B(["transaction","common"]),{pop:s}=Q();ue();const n=l.useRef(Ns),a=l.useRef(Sn),r=l.useRef(!1);!r.current&&Ns&&(n.current=Ns,a.current=Sn,ki(),r.current=!0);const o=n.current,[c,i]=l.useState(o?.currentFee??""),[d,u]=l.useState();l.useEffect(()=>()=>{ki()},[]);const m=l.useCallback(v=>{if(!o)return;const j=parseFloat(v),N=parseFloat(o.minFee);if(isNaN(j)||j<=0)return t("transaction:feeEdit.invalidFee");if(j<N)return t("transaction:feeEdit.belowMinFee",{minFee:o.minFee,symbol:o.symbol})},[o,t]),f=l.useCallback(v=>{const j=v.target.value;(j===""||/^\d*\.?\d*$/.test(j))&&(i(j),u(void 0))},[]),h=l.useCallback(v=>{i(v),u(void 0)},[]),x=l.useCallback(v=>{v.preventDefault();const j=m(c);if(j){u(j);return}a.current?.({fee:c}),s()},[c,m,s]),b=l.useCallback(()=>{s()},[s]);if(!o)return null;const p=[{label:t("transaction:feeEdit.presetMin"),value:o.minFee}],g=o.presets??p;return e.jsx(Kc,{children:e.jsxs("div",{className:"bg-background rounded-2xl p-4","data-testid":"fee-edit-modal",children:[e.jsx("h2",{className:"mb-4 text-center text-lg font-semibold",children:t("transaction:feeEdit.title")}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 text-sm text-muted-foreground",children:[e.jsxs("p",{children:[t("transaction:feeEdit.currentFee"),": ",o.currentFee," ",o.symbol]}),e.jsxs("p",{children:[t("transaction:feeEdit.minFee"),": ",o.minFee," ",o.symbol]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:g.map(v=>e.jsx("button",{type:"button",onClick:()=>h(v.value),className:R("rounded-full px-3 py-1 text-sm transition-colors",c===v.value?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:v.label},v.value))}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("transaction:feeEdit.customFee")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(De,{type:"text",inputMode:"decimal",value:c,onChange:f,placeholder:o.minFee,className:R(d&&"border-destructive"),"data-testid":"fee-input"}),e.jsx("span",{className:"shrink-0 text-sm text-muted-foreground",children:o.symbol})]}),d&&e.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(vt,{className:"size-4"}),e.jsx("span",{children:d})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(q,{type:"button",variant:"outline",onClick:b,className:"flex-1",children:t("common:cancel")}),e.jsx(q,{type:"submit",className:"flex-1",disabled:!c,children:t("common:confirm")})]})]})]})})}const sl=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(Gg,{})});sl.__docgenInfo={description:"",methods:[],displayName:"FeeEditJob"};let ws=null,An=null,In=null,Tn="";function Qg(t,s,n){ws=t,An=n??null,s&&(In=s.amount,Tn=s.symbol)}function Yg(){ws=null,An=null,In=null,Tn=""}function Xg(){const{t}=B(["security","transaction","common"]),{pop:s,push:n}=Q(),{chainId:a,chainIcon:r,chainSymbol:o,address:c,chainName:i}=ue(),[d,u]=l.useState(""),[m,f]=l.useState(""),[h,x]=l.useState([]),[b,p]=l.useState(!1),[g,v]=l.useState("input"),[j,N]=l.useState(),[y,C]=l.useState(!1),[w,S]=l.useState("idle"),[M,A]=l.useState(),[I,T]=l.useState(null),P=l.useRef(ws),k=l.useRef(An),E=l.useRef({amount:In,symbol:Tn}),z=I??E.current.amount?.toDisplayString()??"0";l.useEffect(()=>(ws&&!P.current&&(P.current=ws,k.current=An,E.current={amount:In,symbol:Tn}),()=>{Yg()}),[]);const D=l.useCallback(()=>{const _=E.current.amount?.toDisplayString()??"0";tl({currentFee:z,minFee:_,symbol:E.current.symbol},O=>{T(O.fee)}),n("FeeEditJob",{})},[z,n]),L=l.useCallback(()=>{if(N(void 0),g==="input"){if(!d.trim())return;v("confirm")}else if(g==="confirm"){if(d!==m){N(t("security:twoStepSecret.notMatch"));return}v("walletLock")}},[g,d,m,t]),V=l.useCallback(async _=>{const O=P.current;if(_.length<4||!O)return;C(!0),S("broadcasting"),N(void 0),p(!1);const G=gt(_);try{const Z=await O(d,G);Z.success?(A(Z.txHash),S("broadcasted")):(S("idle"),p(!0),x([]),N(Z.error??t("security:twoStepSecret.setFailed")))}catch{S("idle"),p(!0),x([]),N(t("security:twoStepSecret.setFailed"))}finally{C(!1)}},[d,t]);return w!=="idle"?e.jsx(de,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx(eo,{status:w,txHash:M,title:{confirmed:t("security:twoStepSecret.txConfirmed")},description:{confirmed:t("security:twoStepSecret.setSuccessDesc")},checkConfirmed:k.current??void 0,onStatusChange:S,onDone:()=>s()}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}):e.jsx(de,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl","data-testid":"set-two-step-secret-dialog",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsxs("div",{className:"border-b border-border px-4 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx($s,{className:"size-5 text-primary"}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("security:twoStepSecret.setTitle")})]}),a&&c?e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(Ca,{chainId:a,chainIcon:r,chainSymbol:o,address:c,size:"sm"})}):i?e.jsx("p",{className:"mt-1 text-center text-sm text-muted-foreground",children:i}):null]}),e.jsxs("div",{className:"space-y-6 p-4",children:[E.current.amount&&e.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-muted/50 p-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:t("security:twoStepSecret.feeInfo")}),e.jsx(Ea,{amount:z,symbol:E.current.symbol,editable:!0,onEdit:D})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:R("size-2 rounded-full",g==="input"?"bg-primary":"bg-muted")}),e.jsx("div",{className:R("size-2 rounded-full",g==="confirm"?"bg-primary":"bg-muted")}),e.jsx("div",{className:R("size-2 rounded-full",g==="walletLock"?"bg-primary":"bg-muted")})]}),g==="input"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:t("security:twoStepSecret.inputDesc")}),e.jsx(hn,{value:d,onChange:_=>u(_.target.value),placeholder:t("security:twoStepSecret.inputPlaceholder"),"aria-describedby":j?"two-step-secret-error":void 0,"data-testid":"new-two-step-secret-input"})]}),g==="confirm"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:t("security:twoStepSecret.confirmDesc")}),e.jsx(hn,{value:m,onChange:_=>f(_.target.value),placeholder:t("security:twoStepSecret.confirmPlaceholder"),"aria-describedby":j?"two-step-secret-error":void 0,"data-testid":"confirm-two-step-secret-input"})]}),g==="walletLock"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:t("security:twoStepSecret.walletLockDesc")}),e.jsx(Ut,{value:h,onChange:x,onComplete:V,minPoints:4,error:b,disabled:y,"data-testid":"wallet-lock-pattern"})]}),j&&e.jsxs("div",{id:"two-step-secret-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(vt,{className:"size-4"}),e.jsx("span",{children:j})]}),e.jsxs("div",{className:"space-y-3",children:[g!=="walletLock"&&e.jsx("button",{type:"button",onClick:L,"data-testid":"set-two-step-secret-next-button",className:R("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90"),children:t("common:next")}),e.jsx("button",{type:"button",onClick:()=>{g==="input"?s():g==="confirm"?(v("input"),N(void 0)):(v("confirm"),N(void 0),p(!1),x([]))},disabled:y,"data-testid":"set-two-step-secret-cancel-button",className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t(g==="input"?"common:cancel":"common:back")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const nl=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(Xg,{})});nl.__docgenInfo={description:"",methods:[],displayName:"SetTwoStepSecretJob"};let va=null;function Zg(){va=null}const ev=[{value:"english",label:"English"},{value:"zh-Hans",label:""},{value:"zh-Hant",label:""}],tv=[12,15,18,21,24,36];function sv(){const{t}=B("onboarding"),{pop:s}=Q(),{language:n,length:a}=ue(),[r,o]=l.useState({language:n||"english",length:Number(a)||12}),c=u=>{o(m=>({...m,language:u}))},i=u=>{o(m=>({...m,length:u}))},d=()=>{va&&va(r),Zg(),s()};return e.jsx(de,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx("div",{className:"border-border border-b px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("create.mnemonicOptions.title")})}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:t("create.mnemonicOptions.language")}),e.jsx("div",{className:"space-y-1",role:"radiogroup",children:ev.map(u=>e.jsxs("button",{type:"button",role:"radio","aria-checked":r.language===u.value,onClick:()=>c(u.value),className:R("flex w-full items-center justify-between rounded-lg px-4 py-3","hover:bg-muted/50 transition-colors",r.language===u.value&&"bg-muted"),children:[e.jsx("span",{className:"text-sm",children:u.label}),r.language===u.value&&e.jsx(xe,{className:"text-primary size-5"})]},u.value))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:t("create.mnemonicOptions.wordCount")}),e.jsx("div",{className:"grid grid-cols-3 gap-2",role:"radiogroup",children:tv.map(u=>e.jsxs("button",{type:"button",role:"radio","aria-checked":r.length===u,onClick:()=>i(u),className:R("flex items-center justify-center rounded-lg py-3 text-sm font-medium","transition-colors",r.length===u?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:[u," ",t("create.mnemonicOptions.words")]},u))})]}),e.jsx("button",{type:"button",onClick:d,className:R("text-primary-foreground w-full rounded-full py-3 font-medium transition-colors","bg-primary hover:bg-primary/90"),children:t("create.mnemonicOptions.confirm")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const al=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(sv,{})});al.__docgenInfo={description:"",methods:[],displayName:"MnemonicOptionsJob"};const sa=3,nv=10;function av(){const{t}=B("common"),{pop:s}=Q(),{contactId:n}=ue(),a=we(Cs,I=>I.contacts),r=n?a.find(I=>I.id===n):null,[o,c]=l.useState(""),[i,d]=l.useState([{id:crypto.randomUUID(),label:"",address:""}]),[u,m]=l.useState(""),[f,h]=l.useState(()=>Math.floor(Math.random()*1e4)),[x,b]=l.useState(!1),p=!!r;l.useEffect(()=>{r&&(c(r.name),d(r.addresses.length>0?r.addresses.map(I=>({id:I.id,label:I.label||"",address:I.address})):[{id:crypto.randomUUID(),label:"",address:""}]),m(r.memo??""),b(!1))},[r]);const g=l.useCallback(()=>{h(Math.floor(Math.random()*1e4)),b(!0)},[]),v=i.find(I=>I.address.trim())?.address.trim(),j=!p||x?v?Rt(v,f):void 0:r?.avatar||(v?Rt(v,f):void 0),N=l.useCallback(()=>{i.length>=sa||d(I=>[...I,{id:crypto.randomUUID(),label:"",address:""}])},[i.length]),y=l.useCallback(I=>{d(T=>T.length<=1?T:T.filter(P=>P.id!==I))},[]),C=l.useCallback((I,T,P)=>{d(k=>k.map(E=>E.id===I?{...E,[T]:P}:E))},[]),w=l.useCallback(()=>{const I=o.trim(),T=u.trim(),P=i.filter(E=>E.address.trim()).map((E,z)=>({id:E.id,address:E.address.trim(),label:E.label.trim()||void 0,isDefault:z===0}));if(!I||P.length===0)return;const k=!p||x?P[0]?Rt(P[0].address,f):void 0:r?.avatar;p&&r?Ss.updateContact(r.id,{name:I,avatar:k,addresses:P,memo:T||void 0}):Ss.addContact({name:I,addresses:P,avatar:k,memo:T||void 0}),s()},[o,i,u,f,p,r,s]),S=i.some(I=>I.address.trim()),M=o.trim().length>0&&S,A=i.length<sa;return e.jsx(de,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t(p?"contact.editTitle":"contact.addTitle")})}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:g,disabled:!v,className:"group relative shrink-0",title:t("addressBook.changeAvatar"),children:[e.jsx(ds,{src:j,size:56}),v&&e.jsx("div",{className:"bg-background/80 absolute inset-0 flex items-center justify-center rounded-full opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx(Vt,{className:"text-primary size-5"})})]}),e.jsx("input",{id:"contact-name",type:"text",value:o,onChange:I=>c(I.target.value),placeholder:t("contact.namePlaceholder"),maxLength:20,className:R("flex-1 rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:t("contact.addresses")}),e.jsx("span",{className:"text-muted-foreground text-xs",children:t("contact.addressCount",{count:i.length,max:sa})})]}),i.map((I,T)=>e.jsxs("div",{className:"space-y-2 rounded-xl border border-border p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:I.label,onChange:P=>C(I.id,"label",P.target.value),placeholder:t("contact.addressLabelPlaceholder"),maxLength:nv,className:R("w-24 shrink-0 rounded-lg border border-border bg-muted/50 px-3 py-2 text-sm","focus:outline-none focus:ring-2 focus:ring-primary")}),i.length>1&&e.jsx("button",{type:"button",onClick:()=>y(I.id),className:"text-muted-foreground hover:text-destructive shrink-0 p-1",children:e.jsx(qt,{className:"size-4"})}),T===0&&e.jsx("span",{className:"bg-primary/10 text-primary rounded px-1.5 py-0.5 text-xs",children:t("contact.defaultLabel")})]}),e.jsx("input",{type:"text",value:I.address,onChange:P=>C(I.id,"address",P.target.value),placeholder:t("contact.addressPlaceholder"),className:R("w-full rounded-lg border border-border bg-background px-3 py-2 font-mono text-sm","focus:outline-none focus:ring-2 focus:ring-primary")})]},I.id)),A&&e.jsxs("button",{type:"button",onClick:N,className:"flex w-full items-center justify-center gap-2 rounded-xl border border-dashed border-border py-3 text-sm text-muted-foreground hover:border-primary hover:text-primary",children:[e.jsx(nt,{className:"size-4"}),t("contact.addAddress")]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"contact-memo",className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(Yi,{className:"size-4"}),t("contact.memoOptional")]}),e.jsx("textarea",{id:"contact-memo",value:u,onChange:I=>m(I.target.value),placeholder:t("contact.memoPlaceholder"),maxLength:100,rows:2,className:R("w-full resize-none rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")})]}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsx("button",{onClick:w,disabled:!M,className:R("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(p?"contact.save":"contact.add")}),e.jsx("button",{onClick:()=>s(),className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("contact.cancel")})]})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const rl=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(av,{})});rl.__docgenInfo={description:"",methods:[],displayName:"ContactEditJob"};function rv(t,s=8,n=6){return t.length<=s+n+3?t:`${t.slice(0,s)}...${t.slice(-n)}`}function iv(){const{t}=B("common"),{pop:s}=Q(),{chainType:n}=ue(),a=n,[r,o]=l.useState(""),c=we(Cs),i=l.useMemo(()=>{let u=c.contacts;return r&&(u=ja.searchContacts(c,r)),u=[...u].toSorted((m,f)=>f.updatedAt-m.updatedAt),u.map(m=>{const f=m.addresses.map(x=>({...x,isValidForCurrentChain:a?gm(x.address,a):!0})),h=f.some(x=>x.isValidForCurrentChain);return{contact:m,addresses:f,hasValidAddress:h}})},[c,r,a]),d=(u,m)=>{const f=new CustomEvent("contact-picker-select",{detail:{contact:u,address:m}});window.dispatchEvent(f),s()};return e.jsx(de,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx("div",{className:"border-border border-b px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("contact.selectAddress")})}),e.jsx("div",{className:"border-border border-b p-4",children:e.jsxs("div",{className:"bg-muted/50 flex items-center gap-2 rounded-xl px-3 py-2",children:[e.jsx(qs,{className:"text-muted-foreground size-4"}),e.jsx("input",{type:"text",value:r,onChange:u=>o(u.target.value),placeholder:t("addressBook.searchPlaceholder"),className:"placeholder:text-muted-foreground min-w-0 flex-1 bg-transparent text-sm outline-none"})]})}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto",children:i.length===0?e.jsx("div",{className:"text-muted-foreground py-12 text-center text-sm",children:t(r?"addressBook.noResults":"contact.noContacts")}):e.jsx("div",{className:"divide-border divide-y",children:i.map(({contact:u,addresses:m,hasValidAddress:f})=>e.jsxs("div",{className:R(!f&&"opacity-50"),children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 pt-3 pb-2",children:[e.jsx(ds,{src:u.avatar||(m[0]?.address?Rt(m[0].address):void 0),size:40,className:"shrink-0"}),e.jsx("p",{className:"min-w-0 flex-1 truncate font-medium",children:u.name})]}),e.jsx("div",{className:"space-y-1 pb-3 pl-[56px] pr-4",children:m.map(h=>{const x=!h.isValidForCurrentChain,b=h.label;return e.jsxs("button",{onClick:()=>!x&&d(u,h),disabled:x,className:R("flex min-h-[44px] w-full items-center gap-3 rounded-xl px-3 py-2.5 transition-colors",x?"cursor-not-allowed opacity-50":"hover:bg-muted/50 active:bg-muted"),children:[e.jsx("p",{className:R("min-w-0 flex-1 truncate text-left font-mono text-sm",x?"text-muted-foreground/50":"text-foreground"),children:rv(h.address)}),e.jsxs("div",{className:"flex shrink-0 items-center gap-2",children:[b&&e.jsx("span",{className:R("max-w-[5rem] truncate rounded-md bg-muted px-2 py-0.5 text-xs",x?"text-muted-foreground/50":"text-muted-foreground"),children:b}),h.isDefault&&e.jsx("span",{className:"bg-primary/10 text-primary rounded-md px-2 py-0.5 text-xs",children:t("contact.defaultLabel")})]})]},h.id)})})]},u.id))})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const il=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(iv,{})});il.__docgenInfo={description:"",methods:[],displayName:"ContactPickerJob"};const ol=()=>{const{t}=B(["wallet","home"]),{pop:s}=Q(),{navigate:n}=ae(),a=()=>{s(),n({to:"/wallet/create"})},r=()=>{s(),n({to:"/onboarding/recover"})};return e.jsx(de,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("wallet:add")})}),e.jsxs("div",{className:"space-y-3 p-4",children:[e.jsxs("button",{onClick:a,className:R("flex w-full items-center gap-4 rounded-xl p-4 transition-colors","bg-muted/50 hover:bg-muted active:bg-muted/80"),children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10",children:e.jsx(nt,{className:"size-6 text-primary"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-semibold",children:t("home:welcome.createWallet")}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t("wallet:createDesc")})]})]}),e.jsxs("button",{onClick:r,className:R("flex w-full items-center gap-4 rounded-xl p-4 transition-colors","bg-muted/50 hover:bg-muted active:bg-muted/80"),children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10",children:e.jsx(Hs,{className:"size-6 text-primary"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-semibold",children:t("home:welcome.importWallet")}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t("wallet:importDesc")})]})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};ol.__docgenInfo={description:"",methods:[],displayName:"WalletAddJob"};const cl=()=>{const{t}=B(["wallet","common"]),{pop:s,push:n}=Q(),a=yt(),o=Ae()?.id,{getWalletTheme:c}=$i(),i=qi(),d=m=>{pe.setCurrentWallet(m),s()},u=()=>{s(),n("WalletAddJob",{})};return e.jsx(de,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("common:a11y.tabWallet")})}),e.jsx("div",{className:"max-h-[50vh] space-y-2 overflow-y-auto p-4",children:a.map(m=>{const f=m.id===o,h=m.chainAddresses[0]?.address,x=h?`${h.slice(0,6)}...${h.slice(-4)}`:"---",b=c(m.id);return e.jsxs("button",{onClick:()=>d(m.id),className:R("flex w-full items-center gap-3 rounded-xl p-4 transition-all","active:scale-[0.98]",f?"bg-primary/10 ring-2 ring-primary":"bg-muted/50 hover:bg-muted"),children:[e.jsx(ym,{themeHue:b,size:"md",watermarkIconUrl:i[m.chain]}),e.jsxs("div",{className:"min-w-0 flex-1 text-left",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate font-medium",children:m.name}),f&&e.jsx(jm,{className:"size-4 shrink-0 text-primary"})]}),e.jsx("p",{className:"truncate font-mono text-xs text-muted-foreground",children:x})]})]},m.id)})}),e.jsx("div",{className:"border-t border-border p-4",children:e.jsxs("button",{onClick:u,className:R("flex w-full items-center justify-center gap-2 rounded-xl p-4","bg-muted/50 hover:bg-muted active:bg-muted/80 transition-colors"),children:[e.jsx(nt,{className:"size-5"}),e.jsx("span",{className:"font-medium",children:t("wallet:add")})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};cl.__docgenInfo={description:"",methods:[],displayName:"WalletListJob"};let ya=null;function ov(t){ya=t}const ll=()=>{const{t}=B(["onboarding","common"]),{pop:s}=Q(),[n,a]=l.useState(!1),r=()=>{s()},o=()=>{n&&(s(),ya?.(),ya=null)};return e.jsx(Kc,{children:e.jsxs("div",{className:"bg-background mx-4 max-w-sm rounded-2xl p-5",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"rounded-full bg-amber-500/15 p-2",children:e.jsx(_e,{className:"size-5 text-amber-600","aria-hidden":"true"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h2",{className:"text-base font-semibold",children:t("onboarding:securityWarning.title")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:t("onboarding:securityWarning.message")})]})]}),e.jsxs("label",{className:"mt-4 flex cursor-pointer items-center gap-2 text-sm",children:[e.jsx(to,{checked:n,onCheckedChange:a}),e.jsx("span",{children:t("onboarding:securityWarning.acknowledge")})]}),e.jsxs("div",{className:"mt-5 flex gap-2",children:[e.jsx(q,{type:"button",variant:"outline",className:"flex-1",onClick:r,children:t("common:cancel")}),e.jsx(q,{type:"button",className:"flex-1",onClick:o,disabled:!n,children:t("common:confirm")})]})]})})};ll.__docgenInfo={description:"",methods:[],displayName:"SecurityWarningJob"};let ks=null;function dl(t,s){ks={onConfirm:t,minFee:s?.minFee,onFeeChange:s?.onFeeChange}}function Ci(){ks=null}function cv(t){return t.length<=16?t:`${t.slice(0,10)}...${t.slice(-6)}`}function lv(){const{t}=B("transaction"),{pop:s,push:n}=Q(),a=ue(),[r,o]=l.useState(!1),[c,i]=l.useState(!1),[d,u]=l.useState(!1),[m,f]=l.useState(null),h=l.useRef(ks),x=l.useRef(!1);!x.current&&ks&&(h.current=ks,Ci(),x.current=!0),l.useEffect(()=>()=>{Ci()},[]);const b=a.feeLoading==="true",p=a.feeFiatValue?parseFloat(a.feeFiatValue):void 0,g=m??a.feeAmount,v=!!h.current?.onFeeChange,j=l.useCallback(async()=>{try{await Sa.write({text:a.toAddress}),i(!0),setTimeout(()=>i(!1),2e3)}catch{}},[a.toAddress]),N=l.useCallback(()=>{o(S=>!S)},[]),y=l.useCallback(()=>{const S=h.current;S?.onFeeChange&&(tl({currentFee:g,minFee:S.minFee??a.feeAmount,symbol:a.feeSymbol},M=>{f(M.fee),S.onFeeChange?.(M.fee)}),n("FeeEditJob",{}))},[g,a.feeAmount,a.feeSymbol,n]),C=l.useCallback(async()=>{const S=h.current;if(!(!S?.onConfirm||d)){u(!0);try{s(),await S.onConfirm()}finally{u(!1)}}},[d,s]),w=l.useCallback(()=>{s()},[s]);return e.jsx(de,{"data-testid":"transfer-confirm-sheet",children:e.jsx(kn,{title:t("confirmSheet.title"),children:e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-3xl font-bold",children:[a.amount," ",a.symbol]}),a.fiatValue&&e.jsxs("p",{className:"text-muted-foreground mt-1",children:[" $",a.fiatValue]})]}),e.jsxs("div",{className:"bg-muted/30 space-y-4 rounded-xl p-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:t("confirmSheet.toAddress")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:N,className:"hover:text-primary flex min-w-0 flex-1 items-center gap-1 text-left font-mono text-sm",children:[e.jsx("span",{className:R("min-w-0",r?"break-all":"truncate"),children:r?a.toAddress:cv(a.toAddress)}),r?e.jsx(so,{className:"size-4 shrink-0"}):e.jsx(ao,{className:"size-4 shrink-0"})]}),e.jsx("button",{type:"button",onClick:j,className:"text-muted-foreground hover:text-foreground shrink-0 p-1","aria-label":t(c?"confirmSheet.copied":"confirmSheet.copyAddress"),children:c?e.jsx(xe,{className:"size-4 text-green-500"}):e.jsx(Ji,{className:"size-4"})})]})]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:t("confirmSheet.networkFee")}),e.jsx(Ea,{amount:g,symbol:a.feeSymbol,...p!==void 0&&{fiatValue:p},isLoading:b,editable:v,onEdit:y})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button","data-testid":"cancel-transfer-button",onClick:w,className:"border-border hover:bg-muted flex-1 rounded-full border py-3 font-medium transition-colors",disabled:d,children:t("confirmSheet.cancel")}),e.jsx("button",{type:"button","data-testid":"confirm-transfer-button",onClick:C,disabled:d||b,className:R("flex-1 rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(d?"confirmSheet.confirming":"confirmSheet.confirm")})]})]})})})}const ul=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(lv,{})});ul.__docgenInfo={description:"",methods:[],displayName:"TransferConfirmJob"};let Pn=null;function ml(t){Pn=t}function dv(){Pn=null}function uv(){const{t}=B(["security","transaction","common"]),{pop:s,push:n}=Q(),{title:a}=ue(),r=Oa(),o=at(),c=Be(),i=st(),d=Ae(),[u,m]=l.useState("wallet_lock"),[f,h]=l.useState([]),[x,b]=l.useState(""),[p,g]=l.useState("idle"),[v,j]=l.useState(),[N,y]=l.useState(),[C,w]=l.useState(!1),[S,M]=l.useState(!1),[A,I]=l.useState(),[T,P]=l.useState(null),k=l.useRef(null),E=l.useRef(""),z=l.useRef(!1);!z.current&&Pn&&(k.current=Pn,dv(),z.current=!0),l.useEffect(()=>{if(!v||!c||!d?.address)return;const te=Pe(c);return te?.transaction?te.transaction.subscribe({txHash:v,senderId:d.address},Y=>{Y&&(Y.status==="confirmed"?g("confirmed"):Y.status==="failed"?g("failed"):Y.status==="pending"&&g("broadcasted"))}):void 0},[v,c,d?.address]),l.useEffect(()=>{if(p!=="confirmed"){P(null);return}P(5);const te=setInterval(()=>{P(re=>re===null||re<=1?(clearInterval(te),s(),null):re-1)},1e3);return()=>clearInterval(te)},[p,s]);const D=l.useMemo(()=>Je.getChainById(i,c),[i,c]),L=l.useMemo(()=>{const te=D?.explorer?.queryTx;return!te||!v?null:te.replace(":hash",v).replace(":signature",v)},[D?.explorer?.queryTx,v]),V=l.useCallback(()=>{L&&window.open(L,"_blank","noopener,noreferrer")},[L]),_=u==="wallet_lock"?a??t("security:walletLock.verifyTitle"):t("transaction:sendPage.twoStepSecretTitle"),O=l.useCallback(async te=>{const re=k.current;if(te.length<4||!re)return;M(!0),y(void 0),w(!1),g("broadcasting");const Y=gt(te);E.current=Y;try{const X=await re(Y);if(X.status==="ok"){X.txHash&&j(X.txHash),X.pendingTxId&&I(X.pendingTxId),g("broadcasted");return}if(X.status==="wallet_lock_invalid"){w(!0),h([]),g("idle");return}if(X.status==="two_step_secret_required"){m("two_step_secret"),y(void 0),g("idle");return}if(X.status==="error"){y(X.message??t("transaction:broadcast.unknown")),g("failed"),X.pendingTxId&&I(X.pendingTxId);return}}catch{y(t("transaction:broadcast.unknown")),g("failed")}finally{M(!1)}},[t]),G=l.useCallback(async()=>{const te=k.current;if(!(!x.trim()||!te)){M(!0),y(void 0);try{const re=await te(E.current,x);if(re.status==="ok"){re.txHash&&j(re.txHash),re.pendingTxId&&I(re.pendingTxId),g("broadcasted");return}(re.status==="two_step_secret_invalid"||re.status==="error")&&(y(re.message??t("transaction:sendPage.twoStepSecretError")),re.pendingTxId&&(I(re.pendingTxId),g("failed")))}catch{y(t("transaction:sendPage.twoStepSecretError"))}finally{M(!1)}}},[x,t]),Z=l.useCallback(te=>{te.preventDefault(),u==="two_step_secret"&&G()},[u,G]),$=x.trim().length>0&&!S,K=l.useCallback(async()=>{if(A){M(!0),y(void 0);try{await vu.retryBroadcast(A,i),g("broadcasted")}catch(te){y(te instanceof Error?te.message:t("transaction:broadcast.unknown"))}finally{M(!1)}}},[A,i,t]);if(p!=="idle"){const te=p==="failed",re=p==="confirmed";return e.jsx(de,{children:e.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx(eo,{status:p,txHash:v,title:{broadcasted:t("transaction:txStatus.broadcasted"),confirmed:t("transaction:sendResult.success"),failed:t("transaction:broadcast.failed")},description:{broadcasted:t("transaction:txStatus.broadcastedDesc"),confirmed:T!==null?t("transaction:txStatus.autoCloseIn",{seconds:T}):t("transaction:txStatus.confirmedDesc"),failed:N},onStatusChange:g,onDone:()=>s(),onViewDetails:()=>{s(),v&&n("TransactionDetailActivity",{txId:v})},onViewExplorer:L?V:void 0,onShare:async()=>{v&&(await r.write({text:v}),o.show(t("common:copied")))}}),e.jsxs("div",{className:"px-4 pb-4 space-y-2",children:[te&&e.jsxs("button",{type:"button",onClick:K,disabled:S,className:R("w-full flex items-center justify-center gap-2 rounded-full py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:[e.jsx(Vt,{className:"size-4"}),t(S?"common:retrying":"transaction:pendingTx.retry")]}),e.jsx("button",{type:"button",onClick:()=>s(),className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:re&&T!==null?t("transaction:txStatus.closeIn",{seconds:T}):t("common:close")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})})}return u==="wallet_lock"?e.jsx(de,{children:e.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:e.jsx(kn,{title:_,children:e.jsxs("div",{className:"p-4",children:[e.jsx(Ut,{value:f,onChange:h,onComplete:O,minPoints:4,error:C,disabled:S,"data-testid":"transfer-wallet-lock-pattern"}),N&&e.jsxs("div",{className:"flex items-start justify-center gap-1.5 text-sm text-destructive mt-3",children:[e.jsx(vt,{className:"size-4 shrink-0 mt-0.5"}),e.jsx("pre",{className:"overflow-auto whitespace-break-spaces",children:N})]}),e.jsx("button",{type:"button",onClick:()=>s(),disabled:S,className:"mt-4 w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("common:cancel")})]})})})}):e.jsx(de,{children:e.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:e.jsx(kn,{title:_,children:e.jsxs("form",{onSubmit:Z,className:"space-y-6 p-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-primary mb-2",children:[e.jsx($s,{className:"size-5"}),e.jsx("span",{className:"text-sm",children:t("transaction:sendPage.twoStepSecretDescription")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(hn,{value:x,onChange:te=>b(te.target.value),placeholder:t("transaction:sendPage.twoStepSecretPlaceholder"),disabled:S,"aria-describedby":N?"two-step-error":void 0,"data-testid":"two-step-secret-input"}),x.length>0&&x.length<6&&e.jsx("div",{className:"absolute right-10 top-1/2 -translate-y-1/2",children:e.jsx("span",{className:"text-xs text-amber-500",children:t("security:twoStepSecret.lengthHint",{count:x.length})})})]}),N&&e.jsxs("div",{id:"two-step-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(vt,{className:"size-4"}),e.jsx("span",{children:N})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{type:"submit","data-testid":"two-step-confirm-button",disabled:!$,className:R("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(S?"common:verifying":"common:confirm")}),e.jsx("button",{type:"button",onClick:()=>s(),disabled:S,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("common:cancel")})]})]})})})})}const fl=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(uv,{})});fl.__docgenInfo={description:"",methods:[],displayName:"TransferWalletLockJob"};const mv=150;function fv(){const{t}=B("scanner"),{pop:s}=Q(),n=Ao(),{chainType:a,title:r,hint:o}=ue(),c=l.useRef(null),i=l.useRef(null),d=l.useRef(null),u=l.useRef(null),m=l.useRef(!1),f=l.useRef(!1),h=l.useRef(!1),[x,b]=l.useState(!1),[p,g]=l.useState(!1),[v,j]=l.useState(null),[N,y]=l.useState(null),C=wm(a),w=l.useCallback(k=>{if(k===N)return;y(k);const E=ro(k),z=C(k,E);if(z===!0){j({type:"success",text:t("scanSuccess")}),"vibrate"in navigator&&navigator.vibrate(100),m.current=!1;const D=km();setTimeout(()=>{s(),setTimeout(()=>{D?.({content:k,parsed:E})},100)},300)}else j({type:"error",text:t(z,{defaultValue:z})}),setTimeout(()=>{j(null),y(null)},3e3)},[N,C,t,s]),S=l.useCallback(()=>{if(m.current)return;m.current=!0,i.current||(i.current=document.createElement("canvas"));const k=async()=>{if(!(!m.current||!c.current||!u.current)){try{const E=await u.current.scanFromVideo(c.current,i.current??void 0);E&&w(E.content)}catch{}m.current&&setTimeout(k,mv)}};k()},[w]),M=l.useCallback(()=>{m.current=!1,d.current&&(d.current.getTracks().forEach(k=>k.stop()),d.current=null),b(!1)},[]),A=l.useCallback(async()=>{if(!h.current){if(h.current=!0,!navigator.mediaDevices?.getUserMedia){j({type:"error",text:t("error")}),h.current=!1;return}try{try{if(!await n.checkPermission()&&!await n.requestPermission()){j({type:"error",text:t("permissionDenied")}),h.current=!1;return}}catch{}if(!f.current){h.current=!1;return}const k=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});if(!f.current){k.getTracks().forEach(E=>E.stop()),h.current=!1;return}if(d.current=k,c.current){c.current.srcObject=k;try{await c.current.play(),f.current&&(b(!0),S())}catch(E){if(!(E instanceof DOMException&&E.name==="AbortError"))throw E}}}catch(k){if(!f.current){h.current=!1;return}k instanceof DOMException?k.name==="NotAllowedError"?j({type:"error",text:t("permissionDenied")}):k.name==="NotFoundError"?j({type:"error",text:t("noCameraFound",{defaultValue:t("error")})}):k.name==="AbortError"||j({type:"error",text:t("error")}):j({type:"error",text:t("error")})}finally{h.current=!1}}},[n,S,t]);l.useEffect(()=>(f.current=!0,u.current=io({useWorker:!0}),A(),()=>{f.current=!1,M(),u.current?.destroy(),u.current=null}),[]);const I=l.useCallback(()=>{const k=document.createElement("input");k.type="file",k.accept="image/*",k.onchange=async E=>{const z=E.target.files?.[0];if(!(!z||!u.current))try{const D=new Image,L=URL.createObjectURL(z);D.onload=async()=>{URL.revokeObjectURL(L);const V=document.createElement("canvas");V.width=D.width,V.height=D.height;const _=V.getContext("2d");if(!_||!u.current){j({type:"error",text:t("noQrFound")});return}_.drawImage(D,0,0);const O=await u.current.scanFromCanvas(V);O?w(O.content):j({type:"error",text:t("noQrFound")})},D.onerror=()=>{URL.revokeObjectURL(L),j({type:"error",text:t("noQrFound")})},D.src=L}catch{j({type:"error",text:t("noQrFound")})}},k.click()},[w,t]),T=l.useCallback(async()=>{if(d.current){const k=d.current.getVideoTracks()[0];if(k)try{await k.applyConstraints({advanced:[{torch:!p}]}),g(!p)}catch{}}},[p]),P=l.useCallback(()=>{M(),s()},[M,s]);return e.jsx(de,{children:e.jsxs("div",{className:"flex h-[80vh] flex-col overflow-hidden rounded-t-2xl bg-black",children:[e.jsx("div",{className:"flex justify-center py-2",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-white/30"})}),e.jsxs("div",{className:"flex items-center justify-between px-4 pb-2",children:[e.jsx(q,{variant:"ghost",size:"icon",onClick:P,className:"text-white hover:bg-white/20","data-testid":"scanner-close-button",children:e.jsx(Us,{className:"size-6"})}),e.jsx("h2",{className:"text-lg font-medium text-white","data-testid":"scanner-title",children:r??t("title")}),e.jsx(q,{variant:"ghost",size:"icon",onClick:T,className:R("text-white hover:bg-white/20",p&&"text-yellow-400"),"data-testid":"scanner-flash-button",children:e.jsx(jo,{className:"size-6"})})]}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("video",{ref:c,className:R("absolute inset-0 size-full object-cover",!x&&"hidden"),playsInline:!0,muted:!0,"data-testid":"scanner-video"}),!x&&!v&&e.jsx("div",{className:"flex size-full items-center justify-center",children:e.jsx("p",{className:"text-white/60",children:t("initializing")})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"relative size-64","data-testid":"scanner-viewfinder",children:[e.jsx("div",{className:R("absolute top-0 left-0 size-8 border-t-4 border-l-4",v?.type==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:R("absolute top-0 right-0 size-8 border-t-4 border-r-4",v?.type==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:R("absolute bottom-0 left-0 size-8 border-b-4 border-l-4",v?.type==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:R("absolute right-0 bottom-0 size-8 border-r-4 border-b-4",v?.type==="success"?"border-green-500":"border-primary")}),x&&!v&&e.jsx("div",{className:"animate-scan bg-primary absolute right-2 left-2 h-0.5"})]})}),e.jsx("div",{className:"absolute inset-x-0 bottom-24 px-4 text-center",children:v?e.jsx("div",{className:R("inline-block rounded-lg px-4 py-2",v.type==="error"&&"bg-red-500/80 text-white",v.type==="success"&&"bg-green-500/80 text-white",v.type==="info"&&"bg-black/50 text-white"),"data-testid":"scanner-message",children:v.text}):x?e.jsx("p",{className:"text-white/80","data-testid":"scanner-hint",children:o??(a?t("scanPromptChain",{chain:a}):t("scanPrompt"))}):null})]}),e.jsx("div",{className:"flex justify-center gap-8 bg-black/50 py-6",children:e.jsxs(q,{variant:"ghost",size:"lg",onClick:I,className:"flex flex-col items-center text-white hover:bg-white/20","data-testid":"scanner-gallery-button",children:[e.jsx(vo,{className:"mb-1 size-6"}),e.jsx("span",{className:"text-xs",children:t("gallery")})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)] bg-black"})]})})}const pl=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(fv,{})});pl.__docgenInfo={description:"",methods:[],displayName:"ScannerJob"};function pv(){const{t}=B("common"),{pop:s}=Q(),n=ue(),[a,r]=l.useState(n.name||""),[o,c]=l.useState(n.memo||""),[i,d]=l.useState(0),[u,m]=l.useState(!1),[f,h]=l.useState(!1),x=(()=>{try{return JSON.parse(n.addresses||"[]")}catch{return[]}})(),b=l.useCallback(()=>{d(v=>v+1)},[]),p=l.useCallback(async()=>{if(!(!a.trim()||x.length===0)){m(!0);try{const v=n.avatar||(x[0]?.address?Rt(x[0].address,i):void 0);Ss.addContact({name:a.trim(),addresses:x.map((j,N)=>({id:`addr-${N}`,address:j.address,label:j.label,isDefault:N===0})),memo:o.trim()||void 0,avatar:v}),h(!0),setTimeout(()=>s(),500)}catch{}finally{m(!1)}}},[a,o,x,n.avatar,i,s]),g=l.useCallback(()=>{s()},[s]);return e.jsx(de,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl pb-[env(safe-area-inset-bottom)]",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx("div",{className:"border-border border-b px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("addressBook.addContact")})}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:b,className:"group relative",title:t("addressBook.changeAvatar"),children:[e.jsx(ds,{src:n.avatar||(x[0]?.address?Rt(x[0].address,i):void 0),size:48}),!n.avatar&&e.jsx("div",{className:"bg-background/80 absolute inset-0 flex items-center justify-center rounded-full opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx(Vt,{className:"text-primary size-5"})})]}),e.jsx(De,{value:a,onChange:v=>r(v.target.value),placeholder:t("addressBook.namePlaceholder"),className:"flex-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm",children:t("addressBook.addresses")}),e.jsx("div",{className:"space-y-2",children:x.map((v,j)=>{const N=vm(v.address),y=v.label||N.chainType?.toUpperCase()||"";return e.jsxs("div",{className:"bg-muted/50 flex items-center gap-3 rounded-lg p-3",children:[e.jsx(Ma,{className:"text-muted-foreground size-5 shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[y&&e.jsx("div",{className:"text-muted-foreground text-xs",children:y}),e.jsx("div",{className:"truncate font-mono text-sm",children:v.address})]})]},j)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm",children:t("addressBook.memo")}),e.jsx(De,{value:o,onChange:v=>c(v.target.value),placeholder:t("addressBook.memoPlaceholder")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx(q,{variant:"outline",onClick:g,disabled:u||f,className:"flex-1",children:t("cancel")}),e.jsx(q,{onClick:p,disabled:!a.trim()||x.length===0||u||f,className:R("flex-1",f&&"bg-green-500"),children:f?e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"mr-1 size-4"}),t("saved")]}):t(u?"saving":"save")})]})]})})}const hl=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(pv,{})});hl.__docgenInfo={description:"",methods:[],displayName:"ContactAddConfirmJob"};function hv(){const{t}=B("common"),{pop:s}=Q(),n=ue(),a=l.useRef(null),[r,o]=l.useState(!1),c=l.useMemo(()=>{try{return JSON.parse(n.addresses||"[]")}catch{return[]}},[n.addresses]),i=l.useMemo(()=>_a({name:n.name,addresses:c,avatar:n.avatar}),[n.name,c,n.avatar]),d=l.useCallback(async()=>{const m=a.current;if(!(!m||r)){o(!0);try{const{snapdom:f}=await ht(async()=>{const{snapdom:h}=await import("./snapdom-CO8q8LPW.js").then(x=>x.s);return{snapdom:h}},__vite__mapDeps([0,1]),import.meta.url);await f.download(m,{type:"png",filename:`contact-${n.name}.png`,scale:2,quality:1})}catch{}finally{o(!1)}}},[n.name,r]),u=l.useCallback(async()=>{const m=a.current;if(!(!m||!navigator.share)){o(!0);try{const{snapdom:f}=await ht(async()=>{const{snapdom:p}=await import("./snapdom-CO8q8LPW.js").then(g=>g.s);return{snapdom:p}},__vite__mapDeps([0,1]),import.meta.url),x=await(await f(m,{scale:2})).toBlob(),b=new File([x],`contact-${n.name}.png`,{type:"image/png"});await navigator.share({title:t("addressBook.shareContact"),text:`${n.name} - ${c.map(p=>`${p.label||""}: ${p.address}`).join(", ")}`,files:[b]})}catch{}finally{o(!1)}}},[n.name,c,t,r]);return e.jsx(de,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl pb-[env(safe-area-inset-bottom)]",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"flex items-center justify-between border-b px-4 pb-4",children:[e.jsx(q,{variant:"ghost",size:"icon",onClick:()=>s(),children:e.jsx(Us,{className:"size-5"})}),e.jsx("h2",{className:"text-lg font-semibold",children:t("addressBook.shareContact")}),e.jsx("div",{className:"w-10"})]}),e.jsxs("div",{className:"flex flex-col items-center p-6",children:[e.jsx("div",{ref:a,children:e.jsx(Ra,{name:n.name,avatar:n.avatar,addresses:c,qrContent:i})}),e.jsx("p",{className:"text-muted-foreground mt-4 text-center text-sm",children:t("addressBook.scanToAdd")})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsxs(q,{variant:"outline",onClick:d,disabled:r,className:"flex-1",children:[r?e.jsx(Ce,{className:"mr-2 size-4 animate-spin"}):e.jsx(Hs,{className:"mr-2 size-4"}),t("download")]}),"share"in navigator&&e.jsxs(q,{onClick:u,disabled:r,className:"flex-1",children:[r?e.jsx(Ce,{className:"mr-2 size-4 animate-spin"}):e.jsx(Ms,{className:"mr-2 size-4"}),t("share")]})]})]})})}const xl=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(hv,{})});xl.__docgenInfo={description:"",methods:[],displayName:"ContactShareJob"};function xv(){const{t}=B(["settings","common"]),{pop:s}=Q(),[n,a]=l.useState(!1),r=l.useCallback(()=>{a(!0);const o="./";window.location.href=`${o}clear.html`},[]);return e.jsx(de,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-destructive/10 flex size-16 items-center justify-center rounded-full",children:e.jsx(_e,{className:"text-destructive size-8"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:t("settings:clearData.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("settings:clearData.warning")})]}),e.jsx("div",{className:"bg-destructive/5 rounded-lg p-4",children:e.jsxs("ul",{className:"text-destructive space-y-2 text-sm",children:[e.jsxs("li",{children:[" ",t("settings:clearData.item1")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item2")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item3")]})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(q,{variant:"outline",className:"flex-1",onClick:()=>s(),disabled:n,children:t("common:cancel")}),e.jsx(q,{variant:"destructive",className:"flex-1",onClick:r,disabled:n,children:t("settings:clearData.confirm")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const gl=()=>e.jsx(xv,{});gl.__docgenInfo={description:"",methods:[],displayName:"ClearDataConfirmJob"};function gv(t){if(!t)return;if(t.startsWith("0x")){const n=Bn(t);if(n)return n}const s=Sm(t);return As.getConfig(s),s}function vv(){const{t}=B("common"),{pop:s}=Q(),{chain:n,exclude:a,appName:r,appIcon:o}=ue(),c=Os(),i=l.useMemo(()=>gv(n),[n]),d=l.useMemo(()=>i?c.find(g=>g.id===i):null,[i,c]),u=i?As.getName(i):void 0,m=we(ke),f=Bs.getCurrentWallet(m),h=l.useMemo(()=>{const g=a?.toLowerCase(),v=[];for(const j of m.wallets){const N=i?j.chainAddresses.find(y=>y.chain===i):j.chainAddresses[0];N&&(g&&N.address.toLowerCase()===g||v.push({id:j.id,name:j.name,address:N.address,themeHue:j.themeHue,chainIconUrl:d?.icon}))}return v},[m.wallets,i,a]),x=l.useMemo(()=>{const g=new Map;return m.wallets.forEach(v=>{const j=i?v.chainAddresses.find(N=>N.chain===i):v.chainAddresses[0];j&&g.set(v.id,{wallet:v,chainAddress:j})}),g},[m.wallets,i]),b=g=>{const v=x.get(g);if(!v)return;const j=new CustomEvent("wallet-picker-select",{detail:{address:v.chainAddress.address,chain:v.chainAddress.chain,name:v.wallet.name,publicKey:v.chainAddress.publicKey}});window.dispatchEvent(j),s()},p=()=>{const g=new CustomEvent("wallet-picker-cancel");window.dispatchEvent(g),s()};return e.jsx(de,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Ht,{title:i?t("selectChainWallet",{chain:u}):t("selectWallet"),description:`${r||t("unknownDApp")} ${t("requestsAccess")}`,appName:r,appIcon:o,chainId:i}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto p-4",children:h.length===0?e.jsx("div",{className:"text-muted-foreground py-12 text-center text-sm",children:i?t("noWalletsForChain",{chain:i}):t("noWallets")}):e.jsx(Nm,{wallets:h,currentWalletId:f?.id,onSelect:b,showAddButton:!1})}),e.jsx("div",{className:"border-border border-t p-4",children:e.jsx("button",{onClick:p,className:"bg-muted hover:bg-muted/80 w-full rounded-xl py-3 font-medium transition-colors",children:t("cancel")})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const vl=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(vv,{})});vl.__docgenInfo={description:"",methods:[],displayName:"WalletPickerJob"};function yv(){const{t}=B("common"),{pop:s,push:n}=Q(),{message:a,address:r,appName:o,appIcon:c,chainName:i}=ue(),d=Ae(),[u,m]=l.useState(!1),f=ke.state.wallets.find(g=>g.chainAddresses.some(v=>v.address===r)),h=f?.name||t("unknownWallet"),x=l.useCallback(()=>{u||(Nt(async g=>{m(!0);try{const v=f?.encryptedMnemonic??d?.encryptedMnemonic;if(!v||!f)throw new Error(t("signingAddressNotFound"));const j=`miniapp_sign_${Date.now()}`,y=await new Wa(rs,j).handleMessageSign({chainName:i||"bioforest",senderAddress:r,message:a},v,g),C=new CustomEvent("signing-confirm",{detail:{confirmed:!0,signature:y.signature,publicKey:y.publicKey}});return window.dispatchEvent(C),s(),!0}catch(v){throw v instanceof Error?v:new Error(t("walletLock.error"))}finally{m(!1)}}),n("WalletLockConfirmJob",{title:t("sign")}))},[u,d,i,r,a,s,n,t,f]),b=l.useCallback(()=>{const g=new CustomEvent("signing-confirm",{detail:{confirmed:!1}});window.dispatchEvent(g),s()},[s]),p=a.startsWith("0x")&&/^0x[0-9a-fA-F]+$/.test(a);return e.jsx(de,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Ht,{title:t("signMessage"),description:o||t("unknownDApp"),appName:o,appIcon:c,walletInfo:{name:h,address:r,chainId:i||"bfmeta"}}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsxs("p",{className:"text-muted-foreground mb-1 text-xs",children:[" ",t("message")]}),e.jsx("div",{className:"max-h-40 overflow-y-auto",children:e.jsx("pre",{className:"font-mono text-sm break-all whitespace-pre-wrap",children:a})})]}),p&&e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[e.jsx(_e,{className:"size-5 shrink-0 text-amber-600"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:t("hexDataWarning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:b,disabled:u,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("cancel")}),e.jsx("button",{onClick:x,disabled:u,className:R("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","flex items-center justify-center gap-2 disabled:opacity-50"),children:u?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"size-4 animate-spin"}),t("signing")]}):t("sign")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const yl=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(yv,{})});yl.__docgenInfo={description:"",methods:[],displayName:"SigningConfirmJob"};const bv={bio_requestAccounts:Ma,bio_createTransaction:Yi,bio_signMessage:qn,bio_signTypedData:qn,bio_signTransaction:qn,bio_sendTransaction:df};function jv(){const{t}=B("permission"),{pop:s}=Q(),{appName:n,appIcon:a,permissions:r}=ue(),o=(()=>{try{return JSON.parse(r)}catch{return[]}})(),c=()=>{const m=new CustomEvent("permission-request",{detail:{approved:!0,permissions:o}});window.dispatchEvent(m),s()},i=()=>{const m=new CustomEvent("permission-request",{detail:{approved:!1}});window.dispatchEvent(m),s()},d=m=>{const f=`${m}.label`;return String(t(f))},u=m=>{const f=`${m}.description`;return String(t(f))};return e.jsx(de,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"border-border border-b px-4 pb-4",children:[e.jsx("div",{className:"bg-primary/10 mx-auto mb-3 flex size-14 items-center justify-center rounded-2xl",children:a?e.jsx("img",{src:a,alt:n,className:"size-10 rounded-xl"}):e.jsx(Tm,{className:"text-primary size-8"})}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:n}),e.jsx("p",{className:"text-muted-foreground mt-1 text-center text-sm",children:String(t("requestsPermissions"))})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"space-y-3",children:o.map(m=>{const f=bv[m];return f?e.jsxs("div",{className:"bg-muted/50 flex items-center gap-3 rounded-xl p-3",children:[e.jsx("div",{className:"bg-primary/10 flex size-10 shrink-0 items-center justify-center rounded-full",children:e.jsx(f,{className:"text-primary size-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium",children:d(m)}),e.jsx("p",{className:"text-muted-foreground text-sm",children:u(m)})]})]},m):null})}),e.jsxs("div",{className:"text-muted-foreground mt-4 flex items-center gap-2 text-sm",children:[e.jsx(oo,{className:"size-4"}),e.jsx("span",{children:String(t("permissionNote"))})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:i,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("reject")}),e.jsx("button",{onClick:c,className:R("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90"),children:t("approve")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const bl=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(jv,{})});bl.__docgenInfo={description:"",methods:[],displayName:"PermissionRequestJob"};function Nv(){const{t}=B("common"),{pop:s,push:n}=Q(),a=ue(),{appName:r,appIcon:o,from:c,to:i,amount:d,chain:u,asset:m}=a,f=Ae(),[h,x]=l.useState(!1),p=ke.state.wallets.find(N=>N.chainAddresses.some(y=>y.address===c))?.name||t("unknownWallet"),g=l.useCallback(()=>{h||(Nt(async N=>{x(!0);try{const y=f?.encryptedMnemonic;if(!y)return!1;const C=`miniapp_transfer_${Date.now()}`,w=new Wa(rs,C),S={chainName:u,senderAddress:c,receiveAddress:i,balance:d};m&&(S.assetType=m);const A=await w.handleTransferSign(S,y,N),I=new CustomEvent("miniapp-transfer-confirm",{detail:{confirmed:!0,txHash:A}});return window.dispatchEvent(I),s(),!0}catch{return!1}finally{x(!1)}}),n("WalletLockConfirmJob",{title:t("confirmTransfer")}))},[h,f,u,c,i,d,m,s,n,t]),v=l.useCallback(()=>{const N=new CustomEvent("miniapp-transfer-confirm",{detail:{confirmed:!1}});window.dispatchEvent(N),s()},[s]),j=m||u.toUpperCase();return e.jsx(de,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Ht,{title:t("confirmTransfer"),description:`${r||t("unknownDApp")} ${t("requestsTransfer")}`,appName:r,appIcon:o,walletInfo:{name:p,address:c,chainId:u}}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx("div",{className:"bg-muted/50 rounded-xl p-4 text-center",children:e.jsx(At,{value:d,symbol:j,size:"xl",weight:"bold",decimals:8,fixedDecimals:!0})}),e.jsxs("div",{className:"bg-muted/50 space-y-3 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-10 shrink-0 text-xs",children:[" ",t("from")]}),e.jsx(Pt,{address:c,copyable:!0,className:"flex-1 text-sm"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(Dn,{className:"text-muted-foreground size-4"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-10 shrink-0 text-xs",children:[" ",t("to")]}),e.jsx(Pt,{address:i,copyable:!0,className:"flex-1 text-sm"})]})]}),e.jsxs("div",{className:"bg-muted/50 flex items-center justify-between rounded-xl p-3",children:[e.jsxs("span",{className:"text-muted-foreground text-sm",children:[" ",t("network")]}),e.jsx(Pa,{chainId:u})]}),e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[e.jsx(_e,{className:"mt-0.5 size-5 shrink-0 text-amber-600"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:t("transferWarning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:v,disabled:h,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("cancel")}),e.jsx("button",{onClick:g,disabled:h,className:R("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","flex items-center justify-center gap-2 disabled:opacity-50"),children:h?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"size-4 animate-spin"}),t("confirming")]}):t("confirm")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const jl=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(Nv,{})});jl.__docgenInfo={description:"",methods:[],displayName:"MiniappTransferConfirmJob"};const hs=ve.t.bind(ve);async function Nl(t,s,n){const a=Pe(t.id);return a.bioGetAssetDetail?(await a.bioGetAssetDetail(s,n))?.applyAddress??null:null}async function wl(t,s,n){const a=Pe(t.id);if(!a.buildTransaction||!a.estimateFee)return{amount:se.fromRaw("1000",t.decimals,t.symbol),symbol:t.symbol};try{const r=await a.buildTransaction({type:"destroy",from:"0x0000000000000000000000000000000000000000",recipientId:"0x0000000000000000000000000000000000000000",bioAssetType:s,amount:se.fromRaw(n,t.decimals,t.symbol)});return{amount:(await a.estimateFee(r)).standard.amount,symbol:t.symbol}}catch{return{amount:se.fromRaw("1000",t.decimals,t.symbol),symbol:t.symbol}}}async function En({chainConfig:t,walletId:s,password:n,fromAddress:a,recipientAddress:r,assetType:o,amount:c,fee:i,twoStepSecret:d}){let u;try{u=await as.getMnemonic(s,n)}catch(f){return f instanceof Rn&&f.code===Ln.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:f instanceof Error?f.message:hs("error:unknown")}}if(!c.isPositive())return{status:"error",message:hs("error:validation.enterValidAmount")};const m=Pe(t.id);if(!m.supportsFullTransaction)return{status:"error",message:hs("error:transaction.chainNotSupported")};try{let f=null;if(m.bioGetAccountInfo){if(f=(await m.bioGetAccountInfo(a)).secondPublicKey,f&&!d)return{status:"password_required",secondPublicKey:f};if(d&&f&&m.bioVerifyPayPassword&&!await m.bioVerifyPayPassword({mainSecret:u,paySecret:d,publicKey:f}))return{status:"error",message:hs("error:transaction.securityPasswordFailed")}}const h=await m.buildTransaction({type:"destroy",from:a,recipientId:r,amount:c,bioAssetType:o}),x=await m.signTransaction(h,{privateKey:new TextEncoder().encode(u),bioSecret:u,bioPaySecret:d}),b=await dt.create({walletId:Ki(t.id,a),chainId:t.id,fromAddress:a,rawTx:x,meta:{type:"destroy",displayAmount:c.toFormatted(),displaySymbol:o,displayToAddress:r}});await dt.updateStatus({id:b.id,status:"broadcasting"});try{const p=await m.broadcastTransaction(x);return await dt.updateStatus({id:b.id,status:"broadcasted",txHash:p}),{status:"ok",txHash:p,pendingTxId:b.id}}catch(p){const g=p;return await dt.updateStatus({id:b.id,status:"failed",errorCode:"BROADCAST_FAILED",errorMessage:g.message}),{status:"error",message:g.message,pendingTxId:b.id}}}catch(f){return{status:"error",message:(f instanceof Error?f.message:String(f))||hs("error:transaction.burnFailed")}}}const wv=Object.freeze(Object.defineProperty({__proto__:null,fetchAssetApplyAddress:Nl,fetchBioforestBurnFee:wl,submitBioforestBurn:En},Symbol.toStringTag,{value:"Module"}));function kv(){const{t}=B(["common","transaction"]),{pop:s,push:n}=Q(),a=ue(),{appName:r,appIcon:o,from:c,amount:i,chain:d,asset:u}=a,m=Ae(),f=st(),h=f.snapshot?Je.getChainById(f,d):null,[x,b]=l.useState(!1),g=ke.state.wallets.find(N=>N.chainAddresses.some(y=>y.address===c))?.name||t("common:unknownWallet"),v=l.useCallback(()=>{x||(Nt(async N=>{b(!0);try{if(!m?.id||!h)return!1;const{fetchAssetApplyAddress:y}=await ht(async()=>{const{fetchAssetApplyAddress:A}=await Promise.resolve().then(()=>wv);return{fetchAssetApplyAddress:A}},void 0,import.meta.url),C=await y(h,u,c);if(!C)return!1;const w=se.fromFormatted(i,h.decimals,u),S=await En({chainConfig:h,walletId:m.id,password:N,fromAddress:c,recipientAddress:C,assetType:u,amount:w});if(S.status==="password"||S.status==="error")return!1;const M=new CustomEvent("miniapp-destroy-confirm",{detail:{confirmed:!0,txHash:S.status==="ok"?S.txHash:void 0}});return window.dispatchEvent(M),s(),!0}catch{return!1}finally{b(!1)}}),n("WalletLockConfirmJob",{title:t("transaction:destroyPage.title")}))},[x,m,h,u,c,i,s,n,t]),j=l.useCallback(()=>{const N=new CustomEvent("miniapp-destroy-confirm",{detail:{confirmed:!1}});window.dispatchEvent(N),s()},[s]);return e.jsx(de,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Ht,{title:t("transaction:destroyPage.title"),description:`${r||t("common:unknownDApp")} ${t("common:requestsDestroy")}`,appName:r,appIcon:o,walletInfo:{name:g,address:c,chainId:d}}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx("div",{className:"bg-destructive/5 rounded-xl p-4 text-center",children:e.jsx(At,{value:i,symbol:u,size:"xl",weight:"bold",decimals:8,fixedDecimals:!0})}),e.jsx("div",{className:"bg-muted/50 space-y-3 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-10 shrink-0 text-xs",children:[" ",t("common:from")]}),e.jsx(Ca,{chainId:d,address:c,copyable:!0,size:"sm"})]})}),e.jsxs("div",{className:"bg-muted/50 flex items-center justify-between rounded-xl p-3",children:[e.jsxs("span",{className:"text-muted-foreground text-sm",children:[" ",t("common:network")]}),e.jsx(Pa,{chainId:d})]}),e.jsxs("div",{className:"bg-destructive/10 flex items-start gap-2 rounded-xl p-3",children:[e.jsx(_e,{className:"text-destructive mt-0.5 size-5 shrink-0"}),e.jsx("p",{className:"text-destructive text-sm",children:t("transaction:destroyPage.warning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:j,disabled:x,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("common:cancel")}),e.jsx("button",{onClick:v,disabled:x,className:R("flex-1 rounded-xl py-3 font-medium transition-colors","bg-destructive text-destructive-foreground hover:bg-destructive/90","flex items-center justify-center gap-2 disabled:opacity-50"),children:x?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"size-4 animate-spin"}),t("common:confirming")]}):e.jsxs(e.Fragment,{children:[e.jsx(pn,{className:"size-4"}),t("transaction:destroyPage.confirm")]})})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const kl=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(kv,{})});kl.__docgenInfo={description:"",methods:[],displayName:"MiniappDestroyConfirmJob"};function Cv(t,s){const n=s.startsWith("0x"),a=n?s.toLowerCase():s;for(const r of ke.state.wallets)if(r.chainAddresses.find(c=>c.chain!==t?!1:n||c.address.startsWith("0x")?c.address.toLowerCase()===a:c.address===a))return r.id;return null}function Sv(){const{t}=B("common"),{pop:s,push:n}=Q(),a=ue(),{appName:r,appIcon:o,from:c,chain:i,unsignedTx:d}=a,[u,m]=l.useState(!1),f=l.useMemo(()=>{try{return Dt.parse(d)}catch{return null}},[d]),h=l.useMemo(()=>Cv(i,c),[i,c]),b=ke.state.wallets.find(j=>j.id===h)?.name||t("unknownWallet"),p=l.useCallback(()=>{u||f&&h&&(Nt(async j=>{m(!0);try{const N=await Ku({walletId:h,password:j,from:c,chainId:i,unsignedTx:f}),y=new CustomEvent("miniapp-sign-transaction-confirm",{detail:{confirmed:!0,signedTx:N}});return window.dispatchEvent(y),s(),!0}catch(N){throw console.error("[miniapp-sign-transaction]",N),N instanceof Error?N:new Error("Sign transaction failed")}finally{m(!1)}}),n("WalletLockConfirmJob",{title:t("signTransaction")}))},[i,c,u,s,n,t,f,h]),g=l.useCallback(()=>{const j=new CustomEvent("miniapp-sign-transaction-confirm",{detail:{confirmed:!1}});window.dispatchEvent(j),s()},[s]),v=l.useMemo(()=>{if(!f)return"";try{return JSON.stringify(f.data,null,2)}catch{return String(f.data)}},[f]);return e.jsx(de,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Ht,{title:t("signTransaction"),description:r||t("unknownDApp"),appName:r,appIcon:o,walletInfo:{name:b,address:c,chainId:i}}),e.jsxs("div",{className:"space-y-4 p-4",children:[!f&&e.jsx("div",{className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:t("invalidTransaction")}),f&&!h&&e.jsx("div",{className:"rounded-xl bg-amber-50 p-3 text-sm text-amber-800 dark:bg-amber-950/30 dark:text-amber-200",children:t("signingAddressNotFound")}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("network")}),e.jsx(Pa,{chainId:i})]}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("signingAddress")}),e.jsx(Ca,{chainId:i,address:c,copyable:!1,size:"sm"})]}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("transaction")}),e.jsx("div",{className:"max-h-44 overflow-y-auto",children:e.jsx("pre",{className:"font-mono text-xs break-all whitespace-pre-wrap",children:v})})]}),e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[e.jsx(_e,{className:"mt-0.5 size-5 shrink-0 text-amber-600"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:t("signTxWarning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:g,disabled:u,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("cancel")}),e.jsx("button",{onClick:p,disabled:u||!f||!h,className:R("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","flex items-center justify-center gap-2 disabled:opacity-50"),children:u?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"size-4 animate-spin"}),t("signing")]}):t("sign")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Cl=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(Sv,{})});Cl.__docgenInfo={description:"",methods:[],displayName:"MiniappSignTransactionJob"};function Si(t){const s=Bn(t);if(s)return As.getName(s);try{return`Chain ${Am(t)}`}catch{return t}}function Ai(t){return Bn(t)}function Av(){const{t}=B("common"),{pop:s}=Q(),{fromChainId:n,toChainId:a,appName:r,appIcon:o}=ue(),c=Si(n),i=Si(a),d=Ai(n),u=Ai(a),m=()=>{const h=new CustomEvent("chain-switch-confirm",{detail:{approved:!0,toChainId:a}});window.dispatchEvent(h),s()},f=()=>{const h=new CustomEvent("chain-switch-confirm",{detail:{approved:!1}});window.dispatchEvent(h),s()};return e.jsx(de,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Ht,{title:t("switchNetwork"),description:`${r||t("unknownDApp")} ${t("requestsNetworkSwitch")}`,appName:r,appIcon:o}),e.jsxs("div",{className:"flex items-center justify-center gap-4 px-6 py-8",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[d?e.jsx(xt,{chain:d,size:"lg"}):e.jsx("div",{className:"bg-muted flex size-12 items-center justify-center rounded-full",children:e.jsx(_e,{className:"text-muted-foreground size-6"})}),e.jsx("span",{className:"text-muted-foreground text-sm",children:c})]}),e.jsx(yo,{className:"text-primary size-8"}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[u?e.jsx(xt,{chain:u,size:"lg"}):e.jsx("div",{className:"bg-muted flex size-12 items-center justify-center rounded-full",children:e.jsx(_e,{className:"text-muted-foreground size-6"})}),e.jsx("span",{className:"font-medium",children:i})]})]}),e.jsx("div",{className:"bg-warning/10 border-warning/20 mx-4 mb-4 rounded-lg border p-3",children:e.jsx("p",{className:"text-warning text-sm",children:t("chainSwitchWarning")})}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:f,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("cancel")}),e.jsx("button",{onClick:m,className:"bg-primary hover:bg-primary/90 text-primary-foreground flex-1 rounded-xl py-3 font-medium transition-colors",children:t("confirm")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Sl=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(Av,{})});Sl.__docgenInfo={description:"",methods:[],displayName:"ChainSwitchConfirmJob"};function Iv(){const{t}=B("common"),{pop:s}=Q(),n=ue(),a=Dt.parse(n.actions),r=n.duration,{address:o,chainId:c,appName:i,appIcon:d}=n,u=ke.state.wallets.find(w=>w.chainAddresses.some(S=>S.address===o)),m=u?.name,f=u?.id,[h,x]=l.useState([]),[b,p]=l.useState(!1),[g,v]=l.useState(!1),[j,N]=l.useState(r),y=l.useCallback(async w=>{v(!0),p(!1);try{const S=gt(w),M=await as.getAllWallets();if(M.length===0){p(!0),x([]),v(!1);return}let A=!1;for(const I of M)try{await as.getMnemonic(I.id,S),A=!0;break}catch{}if(A&&f){const I=new CustomEvent("crypto-authorize-confirm",{detail:{approved:!0,patternKey:S,walletId:f,selectedDuration:j}});window.dispatchEvent(I),s()}else p(!0),x([])}catch{p(!0),x([])}finally{v(!1)}},[s,j]),C=l.useCallback(()=>{const w=new CustomEvent("crypto-authorize-confirm",{detail:{approved:!1}});window.dispatchEvent(w),s()},[s]);return e.jsx(de,{children:e.jsxs("div",{className:"bg-background flex max-h-[85vh] flex-col rounded-t-2xl",children:[e.jsx("div",{className:"flex flex-shrink-0 justify-center py-2",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Ht,{title:t("cryptoAuthorize"),description:i||t("unknownDApp"),appName:i,appIcon:d,walletInfo:{name:m||t("unknownWallet"),address:o,chainId:c||"bfmeta"}}),e.jsx("div",{className:"min-h-0 flex-1 space-y-3 overflow-y-auto px-4 py-3",children:e.jsxs("div",{className:"bg-muted/50 space-y-2 rounded-xl p-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($s,{className:"text-primary size-4 flex-shrink-0"}),e.jsxs("span",{className:"text-muted-foreground",children:[t("permissions"),""]}),e.jsx("span",{className:"truncate font-medium",children:a.map(w=>Gu[w]?.name||w).join("")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-muted-foreground ml-6",children:[t("duration"),""]}),e.jsxs(Ts,{value:j,onValueChange:w=>N(w),children:[e.jsx(Ps,{className:"h-7 w-24 text-xs",children:e.jsx(Es,{})}),e.jsx(_s,{children:Qu.map(w=>e.jsx(Wt,{value:w,children:Yu[w]},w))})]})]})]})}),e.jsxs("div",{className:"flex-shrink-0 px-4 pb-2",children:[e.jsx("p",{className:"text-muted-foreground mb-2 text-center text-xs",children:t("drawPatternToConfirm")}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-[280px]",children:e.jsx(Ut,{value:h,onChange:x,onComplete:y,error:b,disabled:g})})}),e.jsx("div",{className:"flex h-6 items-center justify-center",children:g&&e.jsxs("div",{className:"text-muted-foreground flex items-center gap-2",children:[e.jsx(Ce,{className:"size-4 animate-spin"}),e.jsx("span",{className:"text-xs",children:t("verifying")})]})})]}),e.jsx("div",{className:"flex-shrink-0 px-4 pb-2",children:e.jsx("button",{onClick:C,disabled:g,className:"bg-muted hover:bg-muted/80 w-full rounded-xl py-2.5 text-sm font-medium transition-colors disabled:opacity-50",children:t("cancel")})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)] flex-shrink-0"})]})})}const Al=({params:t})=>e.jsx(ce,{params:t,children:e.jsx(Iv,{})});Al.__docgenInfo={description:"",methods:[],displayName:"CryptoAuthorizeJob"};const Tv={"zh-CN":"","zh-TW":"",en:"English",ja:"",ko:"",ar:""},Pv={USD:"USD ($)",CNY:"CNY ()",EUR:"EUR ()",JPY:"JPY ()",KRW:"KRW ()"};function lr(){const{navigate:t}=ae(),{push:s}=Q(),{t:n}=B(["settings","common","security","error"]),a=Ae(),r=Na(),o=Ft(),c=Fi(),i=Wi(),d=at(),u=Rg(),[m,f]=l.useState(!1),[h,x]=l.useState("loading");l.useEffect(()=>{async function N(){if(!a){x("unavailable");return}const y=a.chainAddresses.find(C=>C.chain==="bfmeta"||C.chain==="bfm");if(!y){x("unavailable");return}try{const C=Je.getChainById(ur.state,"bfmeta");if(!C){x("unavailable");return}const w=await Og(C,y.address);x(w?"set":"not_set")}catch{x("unavailable")}}N()},[a]);const b=()=>n(`settings:appearance.${i}`),p=()=>{switch(u.status){case"checking":return n("settings:update.checking");case"update-available":return n("settings:update.available");case"up-to-date":return n("settings:update.upToDate");case"error":return n("settings:update.failed");case"not-dweb":return n("settings:update.dwebRequired");default:return n("settings:update.notChecked")}},g=async()=>{const N=await Mg.check("manual");if(N.status==="not-dweb"){d.show(n("error:crypto.dwebEnvironmentRequired"));return}if(N.status==="error"){d.show(n("settings:update.failed"));return}N.status==="up-to-date"&&d.show(n("settings:update.upToDate"))},v=()=>{switch(h){case"loading":return"...";case"set":return n("security:twoStepSecret.alreadySet");case"not_set":return n("security:twoStepSecret.notSet");default:return n("settings:notSupported")}},j=async()=>{if(h!=="not_set"||!a)return;const N=a.chainAddresses.find(w=>w.chain==="bfmeta"||w.chain==="bfm");if(!N)return;const y=Je.getChainById(ur.state,"bfmeta");if(!y)return;const C=await Bg(y);Qg(async(w,S)=>{const M=await Dg({chainConfig:y,walletId:a.id,password:S,fromAddress:N.address,newTwoStepSecret:w});return M.status==="ok"?(x("set"),{success:!0,txHash:M.txHash}):M.status==="password"?{success:!1,error:n("security:passwordConfirm.verifying")}:M.status==="already_set"?(x("set"),{success:!1,error:n("security:twoStepSecret.alreadySet")}):{success:!1,error:M.message}},C??void 0,async()=>{const{getChainProvider:w}=await ht(async()=>{const{getChainProvider:M}=await import("./index-CreRbCXK.js").then(A=>A.x);return{getChainProvider:M}},__vite__mapDeps([2,3,1,4,5,6,7,8,9,10]),import.meta.url),S=w(y.id);if(!S.bioGetAccountInfo)return!1;try{return!!(await S.bioGetAccountInfo(N.address)).secondPublicKey}catch{return!1}}),s("SetTwoStepSecretJob",{chainName:"BioForest Chain"})};return e.jsxs("div",{className:"bg-muted/30 flex h-full flex-col overflow-y-auto",children:[e.jsx(U,{title:n("common:a11y.tabSettings")}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("button",{type:"button",onClick:()=>t({to:"/my-card"}),className:"bg-card hover:bg-accent flex w-full items-center gap-4 rounded-xl p-4 shadow-sm transition-colors","data-testid":"my-card-button",children:[e.jsx(ds,{src:r.avatar,size:56}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("h2",{className:"font-semibold",children:r.username||n("common:myCard.defaultName")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:n("settings:items.myCard")})]}),e.jsx(Nf,{size:20,className:"text-muted-foreground"})]}),e.jsxs(vs,{title:n("settings:sections.walletManagement"),children:[e.jsx(Ne,{icon:e.jsx(Ma,{size:20}),label:n("settings:items.walletManagement"),onClick:()=>t({to:`/wallet/${a?.id??""}`})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(ko,{size:20}),label:n("settings:items.walletChains"),onClick:()=>t({to:"/settings/wallet-chains"}),testId:"wallet-chains-button"}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(Km,{size:20}),label:n("settings:items.addressBook"),onClick:()=>t({to:"/address-book"}),testId:"address-book-button"})]}),e.jsxs(vs,{title:n("settings:sections.security"),children:[e.jsx(Ne,{icon:e.jsx($s,{size:20}),label:n("settings:items.appLock"),value:n("settings:notSupported"),disabled:!0}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(La,{size:20}),label:n("settings:items.viewMnemonic"),onClick:()=>t({to:"/settings/mnemonic"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(Ba,{size:20}),label:n("settings:items.changeWalletLock"),onClick:()=>t({to:"/settings/wallet-lock"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(Du,{size:20}),label:n("security:twoStepSecret.setup"),value:v(),onClick:j,disabled:h==="set"||h==="unavailable",testId:"set-pay-password-button"})]}),e.jsxs(vs,{title:n("settings:sections.preferences"),children:[e.jsx(Ne,{icon:e.jsx(kf,{size:20}),label:n("settings:items.language"),value:Tv[o],onClick:()=>t({to:"/settings/language"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(cf,{size:20}),label:n("settings:items.currency"),value:Pv[c],onClick:()=>t({to:"/settings/currency"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(Ef,{size:20}),label:n("settings:items.appearance"),value:b(),onClick:()=>f(!0)}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(Tf,{size:20}),label:n("settings:items.chainConfig"),onClick:()=>t({to:"/settings/chains"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(So,{size:20}),label:n("settings:items.miniappSources"),onClick:()=>t({to:"/settings/sources"})})]}),e.jsxs(vs,{title:n("settings:sections.about"),allowContextMenu:!0,children:[e.jsx(Ne,{icon:e.jsx(sm,{size:20}),label:n("settings:items.aboutApp"),value:"v0.4.0",onClick:()=>{}}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(Vt,{size:20}),label:n("settings:update.check"),value:p(),onClick:g}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(No,{size:20}),label:n("settings:items.storage"),onClick:()=>t({to:"/settings/storage"}),testId:"storage-button"})]}),e.jsx("div",{className:"h-[var(--tab-bar-height)]"})]}),e.jsx(Jc,{open:m,onOpenChange:f})]})}lr.__docgenInfo={description:"",methods:[],displayName:"SettingsPage"};function Il(){return e.jsx(lr,{})}Il.__docgenInfo={description:`SettingsTab - 

 SettingsPage `,methods:[],displayName:"SettingsTab"};function Ev(t,s){let n=t.toString();const a=n.startsWith("-");a&&(n=n.slice(1)),n=n.padStart(s,"0");let[r,o]=[n.slice(0,n.length-s),n.slice(n.length-s)];return o=o.replace(/(0+)$/,""),`${a?"-":""}${r||"0"}${o?`.${o}`:""}`}const Tl=({params:t})=>{const{push:s}=Q(),[n,a]=l.useState(t.tab||"wallet");return l.useEffect(()=>(Xu(),pr().setPermissionRequestCallback(async(r,o,c)=>{const i=Zu.state.apps.get(r)?.manifest.icon;return new Promise(d=>{const u=window.setTimeout(()=>d(!1),3e4),m=f=>{window.clearTimeout(u);const h=f.detail;d(h?.approved===!0)};window.addEventListener("permission-request",m,{once:!0}),s("PermissionRequestJob",{appName:o,appIcon:i,permissions:JSON.stringify(c)})})}),hr(async r=>{const o=r?.app?.name,c=r?.app?.icon;return new Promise(i=>{const d=window.setTimeout(()=>i(null),3e4),u=()=>{window.clearTimeout(d),window.removeEventListener("wallet-picker-select",m),window.removeEventListener("wallet-picker-cancel",f)},m=h=>{u();const x=h.detail;i({address:x.address,chain:x.chain,name:x.name})},f=()=>{u(),i(null)};window.addEventListener("wallet-picker-select",m),window.addEventListener("wallet-picker-cancel",f),s("WalletPickerJob",{chain:r?.chain,exclude:r?.exclude,...o?{appName:o}:{},...c?{appIcon:c}:{}})})}),xr(()=>{const r=ke.state,o=Bs.getCurrentWallet(r);return o?o.chainAddresses.map(c=>({address:c.address,chain:c.chain,name:o.name})):[]}),gr(async r=>{const o=ke.state.wallets.flatMap(c=>c.chainAddresses).find(c=>c.address===r.address)?.chain;return new Promise(c=>{const i=window.setTimeout(()=>c(null),6e4),d=u=>{window.clearTimeout(i);const m=u.detail;if(m?.confirmed&&m.signature&&m.publicKey){c({signature:m.signature,publicKey:m.publicKey});return}c(null)};window.addEventListener("signing-confirm",d,{once:!0}),s("SigningConfirmJob",{message:r.message,address:r.address,appName:r.app.name,appIcon:r.app.icon??"",chainName:o??"bioforest"})})}),vr(async r=>new Promise(o=>{const c=window.setTimeout(()=>o(null),6e4),i=d=>{window.clearTimeout(c);const u=d.detail;if(u?.confirmed&&u.txHash){o({txHash:u.txHash});return}o(null)};window.addEventListener("miniapp-transfer-confirm",i,{once:!0}),s("MiniappTransferConfirmJob",{appName:r.app.name,appIcon:r.app.icon??"",from:r.from,to:r.to,amount:r.amount,chain:r.chain,...r.asset?{asset:r.asset}:{}})})),yr(async r=>new Promise(o=>{const c=window.setTimeout(()=>o(null),6e4),i=d=>{window.clearTimeout(c);const u=d.detail;if(u?.confirmed&&u.signedTx){o(u.signedTx);return}o(null)};window.addEventListener("miniapp-sign-transaction-confirm",i,{once:!0}),s("MiniappSignTransactionJob",{appName:r.app.name,appIcon:r.app.icon??"",from:r.from,chain:r.chain,unsignedTx:Dt.stringify(r.unsignedTx)})})),br(async r=>{const o=r.app?.name,c=r.app?.icon;return new Promise(i=>{const d=window.setTimeout(()=>i(null),3e4),u=()=>{window.clearTimeout(d),window.removeEventListener("wallet-picker-select",m),window.removeEventListener("wallet-picker-cancel",f)},m=h=>{u();const x=h.detail;i({address:x.address,chain:x.chain,name:x.name})},f=()=>{u(),i(null)};window.addEventListener("wallet-picker-select",m),window.addEventListener("wallet-picker-cancel",f),s("WalletPickerJob",{chain:r.chainId,...o?{appName:o}:{},...c?{appIcon:c}:{}})})}),kr(async r=>new Promise(o=>{const c=window.setTimeout(()=>o(!1),3e4),i=d=>{window.clearTimeout(c);const u=d.detail;o(u?.approved===!0)};window.addEventListener("chain-switch-confirm",i,{once:!0}),s("ChainSwitchConfirmJob",{fromChainId:r.fromChainId,toChainId:r.toChainId,appName:r.appName,appIcon:r.appIcon})})),jr(async r=>new Promise(o=>{const c=window.setTimeout(()=>o(null),6e4),i=d=>{window.clearTimeout(c);const u=d.detail;if(u?.confirmed&&u.signature){o({signature:u.signature});return}o(null)};window.addEventListener("signing-confirm",i,{once:!0}),s("SigningConfirmJob",{message:r.message,address:r.address,appName:r.appName,chainName:"ethereum"})})),Nr(async r=>{const{from:o,to:c,value:i,chainId:d}=r.tx;if(!o||!c)return null;const u=BigInt(i??"0x0"),m=Ev(u,18),f=d?Bn(d):null;return new Promise(h=>{const x=window.setTimeout(()=>h(null),6e4),b=p=>{window.clearTimeout(x);const g=p.detail;if(g?.confirmed&&g.txHash){h({txHash:g.txHash});return}h(null)};window.addEventListener("miniapp-transfer-confirm",b,{once:!0}),s("MiniappTransferConfirmJob",{appName:r.appName,from:o,to:c,amount:m,chain:f??"ethereum"})})}),wr(async r=>{const o=r?.app?.name,c=r?.app?.icon;return new Promise(i=>{const d=window.setTimeout(()=>i(null),3e4),u=()=>{window.clearTimeout(d),window.removeEventListener("wallet-picker-select",m),window.removeEventListener("wallet-picker-cancel",f)},m=h=>{u();const x=h.detail;i({address:x.address,chain:x.chain,name:x.name})},f=()=>{u(),i(null)};window.addEventListener("wallet-picker-select",m),window.addEventListener("wallet-picker-cancel",f),s("WalletPickerJob",{chain:"tron",...o?{appName:o}:{},...c?{appIcon:c}:{}})})}),Cr(r=>async o=>new Promise(c=>{const i=window.setTimeout(()=>c({approved:!1}),6e4),d=u=>{window.clearTimeout(i);const m=u.detail;if(m?.approved&&m.patternKey&&m.walletId){c({approved:!0,patternKey:m.patternKey,walletId:m.walletId,selectedDuration:m.selectedDuration});return}c({approved:!1})};window.addEventListener("crypto-authorize-confirm",d,{once:!0}),s("CryptoAuthorizeJob",{actions:Dt.stringify(o.actions),duration:o.duration,address:o.address,chainId:o.chainId,appName:o.app.name,appIcon:o.app.icon})})),()=>{pr().setPermissionRequestCallback(null),hr(null),br(null),kr(null),jr(null),Nr(null),wr(null),Cr(null),xr(null),gr(null),vr(null),yr(null)}),[s]),e.jsx(ne,{children:e.jsx(Su,{children:e.jsxs("div",{className:"bg-background relative h-dvh",children:[e.jsx(l.Activity,{mode:n==="wallet"?"visible":"hidden",children:e.jsx(Oc,{})}),e.jsx("div",{style:{display:n==="ecosystem"?"contents":"none"},children:e.jsx(Vc,{})}),e.jsx(l.Activity,{mode:n==="settings"?"visible":"hidden",children:e.jsx(Il,{})}),e.jsx(yu,{activeTab:n,onTabChange:a})]})})})};Tl.__docgenInfo={description:"",methods:[],displayName:"MainTabsActivity"};function Pl(){const{t}=B("wallet"),{navigate:s,goBack:n}=ae(),{push:a}=Q(),r=we(ke,m=>m.wallets),o=we(ke,m=>m.currentWalletId),c=l.useCallback(m=>{pe.setCurrentWallet(m)},[]),i=l.useCallback(m=>{s({to:`/wallet/${m}`})},[s]),d=l.useCallback(()=>{a("WalletAddJob",{})},[a]),u=l.useCallback(()=>{n()},[n]);return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(U,{title:t("list.title"),onBack:u,rightAction:e.jsx("button",{onClick:d,className:R("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":t("add"),children:e.jsx(nt,{className:"size-5"})})}),e.jsx("div",{className:"flex-1 p-4",children:r.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[e.jsx("p",{className:"text-muted-foreground",children:t("list.empty")}),e.jsx("button",{onClick:d,className:R("bg-primary rounded-full px-6 py-2.5 text-sm font-medium text-primary-foreground","hover:bg-primary/90 active:bg-primary/80"),children:t("add")})]}):e.jsx("div",{className:"space-y-3",children:r.map(m=>e.jsx(_v,{wallet:m,isActive:m.id===o,onSelect:()=>c(m.id),onDetail:()=>i(m.id),t},m.id))})})]})}function _v({wallet:t,isActive:s,onSelect:n,onDetail:a,t:r}){return e.jsxs("div",{className:R("bg-card rounded-xl p-4 shadow-sm transition-colors",s&&"ring-primary ring-2"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:n,className:R("flex size-12 items-center justify-center rounded-full text-lg font-semibold",s?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),children:t.name.slice(0,1)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"truncate font-semibold",children:t.name}),s&&e.jsxs("span",{className:"text-primary flex items-center gap-1 text-xs",children:[e.jsx(xe,{className:"size-3"}),r("list.current")]})]}),e.jsx("p",{className:"text-muted-foreground text-sm",children:r("list.chainAddresses",{count:t.chainAddresses.length})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-semibold",children:["$",0 .toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})}),e.jsx("button",{onClick:a,className:R("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":r("list.viewDetail"),children:e.jsx(Te,{className:"text-muted-foreground size-5"})})]})]}),e.jsx("p",{className:"text-muted-foreground mt-2 truncate font-mono text-xs",children:t.address})]})}Pl.__docgenInfo={description:"",methods:[],displayName:"WalletListPage"};const El=()=>e.jsx(ne,{children:e.jsx(Pl,{})});El.__docgenInfo={description:"",methods:[],displayName:"WalletListActivity"};function Mv(){const{t}=B("wallet"),{walletId:s,mode:n="default"}=ue(),{goBack:a,navigate:r}=ae(),c=yt().find(u=>u.id===s),i=()=>{r({to:"/",replace:!0})};if(!c)return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:t("detail.title"),onBack:a}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(zt,{variant:"error",children:t("detail.notFound")})})]});const d=t(n==="edit-only"?"detail.editTitle":"detail.title");return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:d,...n!=="edit-only"&&{onBack:a}}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsx(Fn,{mode:n,walletId:s,onEditOnlyComplete:i}),n==="default"&&e.jsx("div",{className:"mt-6",children:e.jsx(zt,{variant:"warning",children:t("detail.securityWarning")})})]})]})}const _l=({params:t})=>e.jsx(ne,{children:e.jsx(ce,{params:t,children:e.jsx(Mv,{})})});_l.__docgenInfo={description:"",methods:[],displayName:"WalletConfigActivity"};const Rv=["pattern","mnemonic","verify","chains","theme"];function Ml(){const{goBack:t,navigate:s}=ae(),{t:n}=B("onboarding"),a=Os(),r=Ft(),[o,c]=l.useState("pattern"),[i,d]=l.useState(""),[u]=l.useState(()=>{if(typeof window<"u"){const k=window.__E2E_MNEMONIC__;if(typeof k=="string"&&k.trim())return k.trim().split(/\s+/);if(Array.isArray(k)&&k.every(E=>typeof E=="string"))return k}return bu()}),[m,f]=l.useState(!0),[h,x]=l.useState(!1),[b,p]=l.useState([]),[g,v]=l.useState(!1),[j,N]=l.useState(!1),[y,C]=l.useState(null),w=Rv.indexOf(o)+1;l.useEffect(()=>{!g&&a.length>0&&(p(lo(a)),v(!0))},[a,g]);const S=()=>{o==="mnemonic"?(c("pattern"),d("")):o==="verify"?c("mnemonic"):o==="chains"?c("verify"):o==="theme"||t()},M=k=>{d(k),c("mnemonic")},A=()=>{(h||!m)&&c("verify")},I=()=>{c("chains")},T=async()=>{if(!j){N(!0);try{const k=u.join(" "),z=(await uo({mnemonic:k,selectedChainIds:b,chainConfigs:a})).map(({chainId:_,address:O,publicKey:G})=>({chain:_,address:O,publicKey:G??"",tokens:[]})),D=z[0];if(!D)throw new Error("No chain addresses derived");const L=ra(D.address),V=await pe.createWallet({name:n("create.generatedNamePattern",{word:gn(r),suffix:n("create.walletSuffix")}),keyType:"mnemonic",address:D.address,chain:D.chain,chainAddresses:z,themeHue:L},k,i,L);C(V.id),c("theme")}catch{}finally{N(!1)}}},P=()=>{s({to:"/",replace:!0})};return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:n("create.title"),onBack:S}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(ct,{total:5,current:w})}),e.jsxs("div",{className:"flex-1 p-4",children:[o==="pattern"&&e.jsx("div",{"data-testid":"pattern-step",children:e.jsx(za,{onComplete:M,minPoints:4})}),o==="mnemonic"&&e.jsx("div",{"data-testid":"mnemonic-step",children:e.jsx(Lv,{mnemonic:u,hidden:m,copied:h,onToggleHidden:()=>f(!m),onCopy:()=>x(!0),onContinue:A})}),o==="verify"&&e.jsx("div",{"data-testid":"verify-step",children:e.jsx(zv,{mnemonic:u,onContinue:I})}),o==="chains"&&e.jsx("div",{"data-testid":"chain-selector-step",children:e.jsx(Dv,{chains:a,selectedChains:b,selectionCount:b.length,onSelectionChange:p,onComplete:T,completeLabel:n("create.nextStep"),isSubmitting:j})}),o==="theme"&&y&&e.jsx("div",{"data-testid":"theme-step",children:e.jsx(Fn,{mode:"edit-only",walletId:y,onEditOnlyComplete:P})})]})]})}function Lv({mnemonic:t,hidden:s,copied:n,onToggleHidden:a,onCopy:r,onContinue:o}){const{t:c}=B("onboarding"),i=n||!s;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Fs,{icon:e.jsx(Ba,{className:"size-full"}),variant:"warning",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:c("create.backupMnemonic")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:c("create.backupHint")})]}),e.jsx(zt,{variant:"warning",children:c("create.mnemonicWarning")}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:c("create.mnemonicTitle")}),e.jsxs("button",{type:"button","data-testid":"toggle-mnemonic-button",onClick:a,className:"text-primary flex items-center gap-1 text-sm",children:[s?e.jsx(La,{className:"size-4"}):e.jsx(mo,{className:"size-4"}),c(s?"create.mnemonicShow":"create.mnemonicHide")]})]}),e.jsx(co,{words:t,hidden:s,onCopy:r})]}),e.jsxs(ze,{variant:"mint",className:"w-full","data-testid":"mnemonic-backed-up-button",disabled:!i,onClick:o,children:[c(i?"create.mnemonicBackedUp":"create.mnemonicViewFirst"),i&&e.jsx(Te,{className:"ml-2 size-4"})]})]})}function zv({mnemonic:t,onContinue:s}){const{t:n}=B(["onboarding","common"]),[a]=l.useState(()=>Array.from({length:t.length},(f,h)=>h).toSorted(()=>Math.random()-.5).slice(0,3).toSorted((f,h)=>f-h)),[r,o]=l.useState({}),c=a.every(u=>{const m=t[u],f=r[u];return m&&f&&f.toLowerCase()===m.toLowerCase()}),i=(u,m)=>{o(f=>({...f,[u]:m}))},d=u=>{const m=t[u],f=r[u];if(f&&m&&f.toLowerCase()!==m.toLowerCase())return n("create.wordIncorrect")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Fs,{icon:e.jsx(us,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:n("create.verifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("create.verifyDesc")})]}),e.jsx("div",{className:"space-y-4",children:a.map(u=>e.jsx(Uu,{label:n("create.wordN",{n:u+1}),error:d(u),children:e.jsx(De,{"data-testid":`verify-word-input-${u}`,"data-verify-index":u,value:r[u]||"",onChange:m=>i(u,m.target.value),className:R(d(u)&&"border-destructive focus-visible:ring-destructive"),placeholder:n("create.wordNPlaceholder",{n:u+1}),autoCapitalize:"off",autoCorrect:"off"})},u))}),e.jsx(ze,{variant:"mint",className:"w-full","data-testid":"verify-next-button",disabled:!c,onClick:s,children:n("common:next")})]})}function Dv({chains:t,selectedChains:s,selectionCount:n,isSubmitting:a,completeLabel:r,onSelectionChange:o,onComplete:c}){const{t:i}=B(["onboarding","common"]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Fs,{icon:e.jsx(us,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:i("chainSelector.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:i("chainSelector.subtitle")})]}),t.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(Se,{})}):e.jsx(Da,{"data-testid":"chain-selector",chains:t,selectedChains:s,onSelectionChange:o}),e.jsx(ze,{variant:"mint",className:"w-full","data-testid":"chain-selector-complete-button",disabled:n===0||a,onClick:c,children:r})]})}Ml.__docgenInfo={description:"",methods:[],displayName:"WalletCreatePage"};const Rl=()=>e.jsx(ne,{children:e.jsx(Ml,{})});Rl.__docgenInfo={description:"",methods:[],displayName:"WalletCreateActivity"};function Bv(t,s){return{symbol:t.symbol,name:t.name,balance:t.amount.toFormatted(),decimals:t.decimals,fiatValue:void 0,chain:s,icon:t.icon,change24h:0,contractAddress:t.contractAddress}}function Ll(t,s){return t.map(n=>Bv(n,s))}const Ov={ETH:{amount:"0.002",symbol:"ETH"},USDT:{amount:"0.003",symbol:"ETH"},USDC:{amount:"0.003",symbol:"ETH"},BTC:{amount:"0.0001",symbol:"BTC"},TRX:{amount:"1",symbol:"TRX"},BFM:{amount:"0.1",symbol:"BFM"}},Ii={step:"input",asset:null,toAddress:"",amount:null,addressError:null,amountError:null,feeAmount:null,feeMinAmount:null,feeSymbol:"",feeLoading:!1,isSubmitting:!1,resultStatus:null,txHash:null,errorMessage:null},Ee=ve.t.bind(ve);async function Wv(t,s){const n=Pe(t.id);if(!n.supportsFeeEstimate||!n.supportsBuildTransaction)throw new Error(`Chain ${t.id} does not support fee estimation`);const a=await n.buildTransaction({type:"transfer",from:s,to:s,amount:se.fromRaw("1",t.decimals,t.symbol)});return{amount:(await n.estimateFee(a)).standard.amount,symbol:t.symbol}}async function Fv({chainConfig:t,walletId:s,password:n,fromAddress:a,toAddress:r,amount:o}){let c;try{c=await as.getMnemonic(s,n)}catch(i){return i instanceof Rn&&i.code===Ln.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:i instanceof Error?i.message:Ee("error:transaction.unknownError")}}if(!o.isPositive())return{status:"error",message:Ee("error:validation.enterValidAmount")};try{const i=Pe(t.id);if(!i.supportsFullTransaction)return{status:"error",message:Ee("error:transaction.chainNotSupported",{chainId:t.id})};const d=_u(c),u=await i.buildTransaction({type:"transfer",from:a,to:r,amount:o}),m=await i.signTransaction(u,{privateKey:d});return{status:"ok",txHash:await i.broadcastTransaction(m)}}catch(i){const d=i instanceof Error?i.message:String(i);return d.includes("insufficient")||d.includes("balance")?{status:"error",message:Ee("error:insufficientFunds")}:d.includes("fee")||d.includes("gas")?{status:"error",message:Ee("error:transaction.insufficientGas")}:d.includes("not yet implemented")||d.includes("not supported")?{status:"error",message:Ee("error:chain.transferNotImplemented")}:{status:"error",message:d||Ee("error:transaction.failed")}}}function $v(t,s){const n=Pe(t.id);return n.supportsAddressValidation?!s||s.trim()===""?Ee("error:validation.enterRecipientAddress"):n.isValidAddress(s)?!s||s.trim()===""?Ee("error:validation.enterReceiverAddress"):n.isValidAddress(s)?null:Ee("error:validation.invalidAddress"):Ee("error:validation.invalidAddressFormat"):Ee("error:validation.unsupportedChainType")}const Ue=ve.t.bind(ve);function zl(t,s){return t.trim()?s?Im(t):$u(t):!1}function qv(t,s,n){return t.trim()?zl(t,s)?s&&n&&t.trim()===n.trim()?Ue("error:validation.cannotTransferToSelf"):null:Ue("error:validation.invalidAddressFormat"):Ue("error:validation.enterRecipientAddress")}function Hv(t,s){return t?s?t.isPositive()?t.gt(s.amount)?Ue("error:insufficientFunds"):null:Ue("error:validation.enterValidAmount"):null:Ue("error:validation.enterAmount")}function Uv(t){const{toAddress:s,amount:n,asset:a,isBioforestChain:r,feeAmount:o,feeLoading:c}=t;return!a||!n||c||!o?!1:s.trim()!==""&&zl(s,r)&&n.isPositive()&&n.lte(a.amount)}function Dl(t,s,n){if(!t)return{status:"error",message:Ue("error:validation.enterValidAmount")};const a=s.amount;if(s.assetType===n.symbol){if(t.add(n).lte(a))return{status:"ok"};if(!t.eq(a))return{status:"error",message:Ue("error:insufficientFunds")};const o=a.sub(n);return o.isPositive()?{status:"ok",adjustedAmount:o}:{status:"error",message:Ue("error:insufficientFunds")}}else return t.lte(a)?{status:"ok"}:{status:"error",message:Ue("error:insufficientFunds")}}const Ti=ve.t.bind(ve);async function Vv(t){t(s=>({...s,step:"sending",isSubmitting:!0}));try{if(await new Promise(n=>setTimeout(n,2e3)),Math.random()>.2)return t(n=>({...n,step:"result",isSubmitting:!1,resultStatus:"success",txHash:`0x${Math.random().toString(16).slice(2)}${Math.random().toString(16).slice(2)}`,errorMessage:null})),{status:"ok"};throw new Error(Ti("error:transaction.transactionFailed"))}catch(s){return t(n=>({...n,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:s instanceof Error?s.message:Ti("error:transaction.unknownError")})),{status:"error"}}}const We=ve.t.bind(ve);function Jv(t={}){const{initialAsset:s,useMock:n=!0,walletId:a,fromAddress:r,chainConfig:o,getBalance:c}=t,[i,d]=l.useState({...Ii,asset:s??null}),u=l.useRef(null),m=o?.chainKind==="bioforest",f=o?.chainKind==="evm"||o?.chainKind==="tron"||o?.chainKind==="bitcoin",h=l.useCallback(I=>f&&o?$v(o,I):qv(I,m,r),[m,f,o,r]),x=l.useCallback((I,T)=>Hv(I,T),[]),b=l.useCallback(I=>{d(T=>({...T,toAddress:I,addressError:null}))},[]),p=l.useCallback(I=>{d(T=>({...T,amount:I,amountError:null}))},[]),g=l.useCallback(I=>{d(T=>{if(!T.feeAmount)return T;const P=se.fromFormatted(I,T.feeAmount.decimals,T.feeAmount.symbol);return{...T,feeAmount:P}})},[]),v=l.useCallback(I=>{if(d(P=>({...P,asset:I,feeLoading:!0})),n||!m&&!f||!o||!r){setTimeout(()=>{const P=Ov[I.assetType]??{amount:"0.001",symbol:I.assetType},k=se.fromFormatted(P.amount,I.decimals,P.symbol);d(E=>({...E,feeAmount:k,feeMinAmount:k,feeSymbol:P.symbol,feeLoading:!1}))},300);return}(async()=>{try{const P=f?await Wv(o,r):await zg(o,r);d(k=>({...k,feeAmount:P.amount,feeMinAmount:P.amount,feeSymbol:P.symbol,feeLoading:!1}))}catch(P){d(k=>({...k,feeLoading:!1,errorMessage:P instanceof Error?P.message:We("error:transaction.feeEstimateFailed")}))}})()},[o,r,m,f,n]);l.useEffect(()=>{if(!i.asset||i.feeLoading)return;const I=`${o?.id??"unknown"}:${r??""}:${i.asset.assetType}`,T=u.current!==I;T&&(u.current=I),!(!T&&i.feeAmount)&&(!T&&!i.feeAmount||v(i.asset))},[o?.id,r,v,i.asset,i.feeAmount,i.feeLoading]);const j=l.useMemo(()=>!i.asset?.assetType||!c?i.asset?.amount??null:c(i.asset.assetType)??i.asset?.amount??null,[i.asset?.assetType,i.asset?.amount,c]),N=l.useMemo(()=>!i.asset||!j?i.asset:j.decimals===i.asset.decimals?{...i.asset,amount:j}:{...i.asset,amount:j,decimals:j.decimals},[i.asset,j]),y=l.useMemo(()=>Uv({toAddress:i.toAddress,amount:i.amount,asset:N,isBioforestChain:m,feeAmount:i.feeAmount,feeLoading:i.feeLoading}),[m,i.amount,N,i.toAddress,i.feeAmount,i.feeLoading]),C=l.useCallback(()=>{const I=h(i.toAddress),T=N?x(i.amount,N):We("error:validation.selectAsset");if(I||T)return d(P=>({...P,addressError:I,amountError:T})),!1;if(N&&i.feeAmount&&i.amount){const P=Dl(i.amount,N,i.feeAmount);if(P.status==="error")return d(k=>({...k,amountError:P.message})),!1;P.adjustedAmount&&d(k=>({...k,amount:P.adjustedAmount??k.amount}))}return d(P=>({...P,step:"confirm",addressError:null,amountError:null})),!0},[i.toAddress,i.amount,N,i.feeAmount,h,x]),w=l.useCallback(()=>{d(I=>({...I,step:"input"}))},[]),S=l.useCallback(async I=>{if(n)return(await Vv(d)).status==="ok"?{status:"ok"}:{status:"error",message:We("transaction:broadcast.unknown")};if(!o)return d(E=>({...E,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:We("error:transaction.chainConfigMissing")})),{status:"error"};if(o.chainKind==="evm"||o.chainKind==="tron"||o.chainKind==="bitcoin"){if(!a||!r||!i.asset||!i.amount)return d(z=>({...z,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:We("error:transaction.walletInfoIncomplete")})),{status:"error"};d(z=>({...z,step:"sending",isSubmitting:!0,errorMessage:null}));const E=await Fv({chainConfig:o,walletId:a,password:I,fromAddress:r,toAddress:i.toAddress,amount:i.amount});return E.status==="password"?(d(z=>({...z,step:"confirm",isSubmitting:!1})),{status:"password"}):E.status==="error"?(d(z=>({...z,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:E.message})),{status:"error"}):(d(z=>({...z,step:"result",isSubmitting:!1,resultStatus:"success",txHash:E.txHash,errorMessage:null})),{status:"ok",txHash:E.txHash})}if(o.chainKind!=="bioforest")return d(E=>({...E,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:We("error:transaction.unsupportedChainType",{chainType:o.chainKind})})),{status:"error"};if(!a||!r||!i.asset)return d(E=>({...E,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:We("error:wallet.incompleteInfo")})),{status:"error"};const T=h(i.toAddress),P=x(i.amount,i.asset);if(T||P)return d(E=>({...E,addressError:T,amountError:P})),{status:"error"};if(d(E=>({...E,step:"sending",isSubmitting:!0,errorMessage:null})),!i.amount)return d(E=>({...E,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:We("error:transaction.invalidAmount")})),{status:"error"};const k=await Ni({chainConfig:o,walletId:a,password:I,fromAddress:r,toAddress:i.toAddress,amount:i.amount,assetType:i.asset.assetType,fee:i.feeAmount??void 0});return k.status==="password"?(d(E=>({...E,step:"confirm",isSubmitting:!1})),{status:"password"}):k.status==="password_required"?(d(E=>({...E,step:"confirm",isSubmitting:!1})),{status:"two_step_secret_required",secondPublicKey:k.secondPublicKey}):k.status==="error"?(d(E=>({...E,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:k.message})),{status:"error",message:k.message,pendingTxId:k.pendingTxId}):(d(E=>({...E,step:"result",isSubmitting:!1,resultStatus:"success",txHash:k.txHash,errorMessage:null})),{status:"ok",txHash:k.txHash,pendingTxId:k.pendingTxId})},[o,r,i.amount,i.asset,i.toAddress,n,h,x,a]),M=l.useCallback(async(I,T)=>{if(!o||!a||!r)return{status:"error"};if(d(k=>({...k,step:"sending",isSubmitting:!0,resultStatus:null,txHash:null,errorMessage:null})),!i.amount||!i.asset)return d(k=>({...k,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:We("error:transaction.invalidAmount")})),{status:"error"};const P=await Ni({chainConfig:o,walletId:a,password:I,fromAddress:r,toAddress:i.toAddress,amount:i.amount,assetType:i.asset.assetType,fee:i.feeAmount??void 0,twoStepSecret:T});return P.status==="password"?(d(k=>({...k,step:"confirm",isSubmitting:!1})),{status:"password"}):P.status==="error"?(d(k=>({...k,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:P.message})),{status:"error",message:P.message,pendingTxId:P.pendingTxId}):P.status==="password_required"?(d(k=>({...k,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:We("error:transaction.securityPasswordFailed")})),{status:"error"}):(d(k=>({...k,step:"result",isSubmitting:!1,resultStatus:"success",txHash:P.txHash,errorMessage:null})),{status:"ok",txHash:P.txHash,pendingTxId:P.pendingTxId})},[o,r,i.amount,i.toAddress,a]),A=l.useCallback(()=>{d({...Ii,asset:s??null})},[s]);return{state:i,setToAddress:b,setAmount:p,setAsset:v,setFee:g,goToConfirm:C,goBack:w,submit:S,submitWithTwoStepSecret:M,reset:A,canProceed:y}}function Kv(){const{t}=B(["transaction","common","security"]),{goBack:s}=ae(),{push:n}=Q(),a=at(),r=Vs(),o=l.useRef(!1),{address:c,amount:i,assetType:d,assetLocked:u}=ue(),m=u==="true",f=Be(),h=Ae(),x=zn(),b=st(),p=b.snapshot?Je.getChainById(b,f):null,g=wa(f),j=Kt().tokenBalances.useState({address:x?.address??""},{enabled:!!x?.address}),N=l.useMemo(()=>j?.data?Ll(j.data,f):[],[j?.data,f]),y=l.useMemo(()=>{if(!p)return null;if(d){const ie=N.find(le=>le.symbol.toUpperCase()===d.toUpperCase());return ie?{assetType:ie.symbol,name:ie.name,amount:se.fromFormatted(ie.balance,ie.decimals??p.decimals,ie.symbol),decimals:ie.decimals??p.decimals,logoUrl:ie.icon}:null}const X=N.find(ie=>ie.symbol===p.symbol)?.balance??"0";return{assetType:p.symbol,name:p.name,amount:se.fromFormatted(X,p.decimals,p.symbol),decimals:p.decimals}},[p,N,d]),C=l.useCallback(Y=>{const X=N.find(ie=>ie.symbol===Y);return X?se.fromFormatted(X.balance,X.decimals??p?.decimals??8,X.symbol):null},[N,p?.decimals]),{state:w,setToAddress:S,setAmount:M,setAsset:A,setFee:I,goToConfirm:T,submit:P,submitWithTwoStepSecret:k,canProceed:E}=Jv({initialAsset:y??void 0,useMock:!1,walletId:h?.id,fromAddress:x?.address,chainConfig:p,getBalance:C}),z=l.useMemo(()=>{if(!w.asset)return null;const Y=C(w.asset.assetType);return{symbol:w.asset.assetType,name:w.asset.name??w.asset.assetType,balance:Y?.toFormatted()??w.asset.amount.toFormatted(),decimals:w.asset.decimals,chain:f,icon:w.asset.logoUrl}},[w.asset,f,C]),D=l.useCallback(Y=>{const X={assetType:Y.symbol,name:Y.name,amount:se.fromFormatted(Y.balance,Y.decimals??p?.decimals??8,Y.symbol),decimals:Y.decimals??p?.decimals??8,logoUrl:Y.icon};A(X)},[p?.decimals,A]),L=l.useRef(!1);l.useEffect(()=>{y&&!L.current&&!w.asset&&(A(y),L.current=!0)},[y,A,w.asset]),l.useEffect(()=>{if(c&&!w.toAddress&&S(c),i&&!w.amount&&w.asset){const Y=se.tryFromFormatted(i,w.asset.decimals,w.asset.assetType);Y&&M(Y)}},[c,i,w.toAddress,w.amount,w.asset,S,M]),l.useEffect(()=>{const Y=X=>{S(X.detail.address.address)};return window.addEventListener("contact-picker-select",Y),()=>window.removeEventListener("contact-picker-select",Y)},[S]),l.useEffect(()=>{if(w.resultStatus==="success"&&w.toAddress){const Y=ja.getContactByAddress(Cs.state,w.toAddress);Y&&_n.trackRecentContact(Y.contact.id)}},[w.resultStatus,w.toAddress]);const V=l.useCallback(()=>{n("ContactPickerJob",{chainType:f})},[n,f]),_=l.useMemo(()=>w.asset?C(w.asset.assetType):null,[C,w.asset]),O=w.asset?.assetType??"TOKEN",G=w.feeSymbol||p?.symbol,Z=!!G&&G===O,$=l.useMemo(()=>{if(!w.asset||!_)return;if(!w.feeAmount)return _;const Y={...w.asset,amount:_,decimals:_.decimals},X=Dl(_,Y,w.feeAmount);return X.status==="ok"?X.adjustedAmount??_:se.zero(_.decimals,Y.assetType)},[_,w.asset,w.feeAmount]),K=Z&&(!w.feeAmount||w.feeLoading),te=l.useCallback(()=>{Cm(({content:Y,parsed:X})=>{let ie=Y;X.type==="address"||X.type==="payment"?ie=X.address:X.type==="contact"&&X.addresses.length>0&&(ie=X.addresses[0].address),S(ie),r.impact("success"),a.show(t("sendPage.scanSuccess"))}),n("ScannerJob",{chainType:g??f})},[n,f,g,S,r,a,t]),re=()=>{T()&&(r.impact("light"),dl(async()=>{o.current||(o.current=!0,await r.impact("medium"),ml(async(Y,X)=>{if(!X){const le=await P(Y);return le.status==="password"?{status:"wallet_lock_invalid"}:le.status==="two_step_secret_required"?{status:"two_step_secret_required"}:le.status==="ok"?(o.current=!1,{status:"ok",txHash:le.txHash,pendingTxId:le.pendingTxId}):le.status==="error"?{status:"error",message:le.message??t("transaction:broadcast.unknown"),pendingTxId:le.pendingTxId}:{status:"error",message:t("transaction:broadcast.unknown")}}const ie=await k(Y,X);return ie.status==="ok"?(o.current=!1,{status:"ok",txHash:ie.txHash,pendingTxId:ie.pendingTxId}):ie.status==="password"?{status:"two_step_secret_invalid",message:t("error:transaction.securityPasswordWrong")}:ie.status==="error"?{status:"error",message:ie.message??t("transaction:broadcast.unknown"),pendingTxId:ie.pendingTxId}:{status:"error",message:t("transaction:broadcast.unknown")}}),n("TransferWalletLockJob",{title:t("security:walletLock.verifyTitle")}))},{minFee:w.feeMinAmount?.toFormatted()??w.feeAmount?.toFormatted()??"0",onFeeChange:I}),n("TransferConfirmJob",{amount:w.amount?.toFormatted()??"0",symbol:O,toAddress:w.toAddress,feeAmount:w.feeAmount?.toFormatted()??"0",feeSymbol:w.feeSymbol,feeLoading:w.feeLoading?"true":"false"}))};return!h||!x?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:t("sendPage.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("history.noWallet")})})]}):e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:t("sendPage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"bg-muted/50 space-y-2 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(xt,{chain:f,size:"sm"}),e.jsx("span",{className:"text-sm font-medium",children:g})]}),x?.address&&e.jsxs("div",{className:"text-muted-foreground flex items-center justify-center gap-1 text-xs",children:[e.jsxs("span",{children:[t("sendPage.from"),":"]}),e.jsxs("span",{className:"font-mono",children:[x.address.slice(0,8),"...",x.address.slice(-6)]})]})]}),N.length>1&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("sendPage.assetLabel")}),e.jsx(no,{selectedAsset:z,assets:N,onSelect:D,disabled:m,testId:"send-asset-selector"})]}),e.jsx(qu,{label:t("sendPage.toAddressLabel"),value:w.toAddress,onChange:S,placeholder:t("sendPage.toAddressPlaceholder",{chain:g}),onScan:te,onContactPicker:V,chainType:f,error:w.addressError??void 0}),e.jsx(fo,{label:t("sendPage.amountLabel"),value:w.amount??void 0,onChange:M,balance:_??void 0,max:$,maxDisabled:K,symbol:O,error:w.amountError??void 0,fiatValue:w.amount?w.amount.toNumber().toFixed(2):void 0}),e.jsxs("div",{className:"text-muted-foreground flex items-center justify-between text-xs",children:[e.jsx("span",{children:t("sendPage.fee")}),e.jsx("span",{children:w.feeLoading?t("sendPage.feeEstimating"):w.feeAmount?`${w.feeAmount.toFormatted()} ${w.feeSymbol||O}`:t("sendPage.feeUnavailable")})]}),e.jsx(zt,{variant:"info",children:t("sendPage.networkWarning",{chain:g})}),e.jsx("div",{className:"pt-4",children:e.jsxs(ze,{variant:"mint",className:"w-full","data-testid":"send-continue-button",disabled:!E,onClick:re,children:[t("sendPage.continue"),e.jsx(Te,{className:"-mr-4 ml-2 size-4"})]})})]})]})}function Bl(){const{goBack:t}=ae(),s=Be(),{t:n}=B(["transaction","common"]);return e.jsx(jt,{chainId:s,fallback:e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:n("sendPage.title"),onBack:t}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Chain not supported"})})]}),children:e.jsx(Kv,{})})}Bl.__docgenInfo={description:"",methods:[],displayName:"SendPage"};const Ol=({params:t})=>e.jsx(ne,{children:e.jsx(ce,{params:t,children:e.jsx(Xi,{children:e.jsx(Bl,{})})})});Ol.__docgenInfo={description:"",methods:[],displayName:"SendActivity"};const $e=ve.t.bind(ve),Pi={step:"input",asset:null,amount:null,amountError:null,recipientAddress:null,feeAmount:null,feeMinAmount:null,feeSymbol:"",feeLoading:!1,isSubmitting:!1,resultStatus:null,txHash:null,errorMessage:null},xs={amount:"0.001",symbol:"BFM"};function Gv(t,s){if(!t||!s)return null;if(!t.isPositive())return $e("error:validation.enterValidAmount");const n=s.amount;return t.gt(n)?$e("error:validation.exceedsBalance"):null}function Qv(t={}){const{initialAsset:s,assetLocked:n=!1,useMock:a=!0,walletId:r,fromAddress:o,chainConfig:c}=t,[i,d]=l.useState({...Pi,asset:s??null}),u=c?.chainKind==="bioforest",m=l.useCallback((N,y)=>Gv(N,y),[]),f=l.useCallback(N=>{d(y=>({...y,amount:N,amountError:null}))},[]),h=l.useCallback(N=>{if(d(C=>({...C,asset:N,amount:null,amountError:null,feeLoading:!0,recipientAddress:null})),a||!u||!c||!o){setTimeout(()=>{d(C=>({...C,recipientAddress:"mock_apply_address",feeAmount:se.fromFormatted(xs.amount,N.decimals,xs.symbol),feeMinAmount:se.fromFormatted(xs.amount,N.decimals,xs.symbol),feeSymbol:c?.symbol??xs.symbol,feeLoading:!1}))},300);return}(async()=>{try{const C=await Nl(c,N.assetType,o);if(!C){d(S=>({...S,feeLoading:!1,errorMessage:$e("error:transaction.issuerAddressNotFound")}));return}const w=await wl(c,N.assetType,"1");d(S=>({...S,recipientAddress:C,feeAmount:w.amount,feeMinAmount:w.amount,feeSymbol:w.symbol,feeLoading:!1}))}catch(C){d(w=>({...w,feeLoading:!1,errorMessage:C instanceof Error?C.message:$e("error:transaction.feeEstimateFailed")}))}})()},[c,o,u,a]);l.useEffect(()=>{s&&!i.recipientAddress&&h(s)},[s,h,i.recipientAddress]);const x=l.useMemo(()=>!!(i.asset&&i.amount&&i.amount.isPositive()&&i.recipientAddress&&!i.feeLoading),[i.amount,i.asset,i.recipientAddress,i.feeLoading]),b=l.useCallback(()=>{const N=m(i.amount,i.asset);return N?(d(y=>({...y,amountError:N})),!1):i.recipientAddress?(d(y=>({...y,step:"confirm",amountError:null})),!0):(d(y=>({...y,errorMessage:$e("error:transaction.issuerAddressNotReady")})),!1)},[i.amount,i.asset,i.recipientAddress,m]),p=l.useCallback(()=>{d(N=>({...N,step:"input"}))},[]),g=l.useCallback(async N=>{if(a)return d(C=>({...C,step:"burning",isSubmitting:!0})),await new Promise(C=>setTimeout(C,1500)),d(C=>({...C,step:"result",isSubmitting:!1,resultStatus:"success",txHash:`mock_burn_tx_${Date.now()}`})),{status:"ok",txHash:`mock_burn_tx_${Date.now()}`};if(!c||c.chainKind!=="bioforest")return d(C=>({...C,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:$e("error:burn.bioforestOnly")})),{status:"error",message:$e("error:burn.bioforestOnly")};if(!r||!o||!i.asset||!i.amount||!i.recipientAddress)return d(C=>({...C,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:$e("error:transaction.paramsIncomplete")})),{status:"error",message:$e("error:transaction.paramsIncomplete")};d(C=>({...C,step:"burning",isSubmitting:!0,errorMessage:null}));const y=await En({chainConfig:c,walletId:r,password:N,fromAddress:o,recipientAddress:i.recipientAddress,assetType:i.asset.assetType,amount:i.amount,fee:i.feeAmount??void 0});return y.status==="password"?(d(C=>({...C,step:"confirm",isSubmitting:!1})),{status:"password"}):y.status==="password_required"?(d(C=>({...C,step:"confirm",isSubmitting:!1})),{status:"two_step_secret_required",secondPublicKey:y.secondPublicKey}):y.status==="error"?(d(C=>({...C,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:y.message})),{status:"error",message:y.message}):(d(C=>({...C,step:"result",isSubmitting:!1,resultStatus:"success",txHash:y.txHash})),{status:"ok",txHash:y.txHash})},[c,o,i.amount,i.asset,i.feeAmount,i.recipientAddress,a,r]),v=l.useCallback(async(N,y)=>{if(!c||!r||!o||!i.asset||!i.amount||!i.recipientAddress)return{status:"error",message:$e("error:transaction.paramsIncomplete")};d(w=>({...w,step:"burning",isSubmitting:!0,errorMessage:null}));const C=await En({chainConfig:c,walletId:r,password:N,fromAddress:o,recipientAddress:i.recipientAddress,assetType:i.asset.assetType,amount:i.amount,fee:i.feeAmount??void 0,twoStepSecret:y});return C.status==="password"?(d(w=>({...w,step:"confirm",isSubmitting:!1})),{status:"password"}):C.status==="error"?(d(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:C.message})),{status:"error",message:C.message}):C.status==="password_required"?(d(w=>({...w,step:"confirm",isSubmitting:!1})),{status:"two_step_secret_required",secondPublicKey:C.secondPublicKey}):(d(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"success",txHash:C.txHash})),{status:"ok",txHash:C.txHash})},[c,o,i.amount,i.asset,i.feeAmount,i.recipientAddress,r]),j=l.useCallback(()=>{d({...Pi,asset:s??null})},[s]);return{state:i,setAmount:f,setAsset:h,goToConfirm:b,goBack:p,submit:g,submitWithTwoStepSecret:v,reset:j,canProceed:x,assetLocked:n}}function Ei(t){return{assetType:t.symbol,name:t.name,amount:se.fromFormatted(t.balance,t.decimals??8,t.symbol),decimals:t.decimals??8,logoUrl:t.icon}}function Yv(t,s){return{symbol:t.assetType,name:t.name??t.assetType,balance:t.amount.toFormatted(),decimals:t.decimals,chain:s,icon:t.logoUrl}}function Xv(){const{t}=B(["transaction","common","security"]),{goBack:s}=ae(),{push:n}=Q(),a=at(),r=Vs(),o=l.useRef(!1),{assetType:c,assetLocked:i}=ue(),d=Be(),u=Ae(),m=zn(),f=st(),h=f.snapshot?Je.getChainById(f,d):null,x=wa(d),p=Kt().tokenBalances.useState({address:m?.address??""},{enabled:!!m?.address}),g=l.useMemo(()=>p?.data?Ll(p.data,d):[],[p?.data,d]),v=l.useMemo(()=>h?g.filter(G=>G.symbol.toUpperCase()!==h.symbol.toUpperCase()):[],[g,h]),j=l.useMemo(()=>{if(!c||v.length===0)return null;const G=v.find(Z=>Z.symbol.toUpperCase()===c.toUpperCase());return G?Ei(G):null},[c,v]),N=i==="true",{state:y,setAmount:C,setAsset:w,goToConfirm:S,submit:M,submitWithTwoStepSecret:A,reset:I,canProceed:T}=Qv({initialAsset:j??void 0,assetLocked:N,useMock:!1,walletId:u?.id,fromAddress:m?.address,chainConfig:h}),P=l.useCallback(G=>{w(Ei(G))},[w]),k=l.useMemo(()=>y.asset?Yv(y.asset,d):null,[y.asset,d]),E=y.asset?.amount??null,z=y.asset?.assetType??"TOKEN",D=()=>{S()&&(r.impact("light"),dl(async()=>{o.current||(o.current=!0,await r.impact("medium"),ml(async(G,Z)=>{if(!Z){const K=await M(G);return K.status==="password"?{status:"wallet_lock_invalid"}:K.status==="two_step_secret_required"?{status:"two_step_secret_required"}:K.status==="ok"?(o.current=!1,{status:"ok",txHash:K.txHash,pendingTxId:K.pendingTxId}):K.status==="error"?{status:"error",message:K.message,pendingTxId:K.pendingTxId}:{status:"error",message:t("error:destroy.failed")}}const $=await A(G,Z);return $.status==="ok"?(o.current=!1,{status:"ok",txHash:$.txHash,pendingTxId:$.pendingTxId}):$.status==="password"?{status:"two_step_secret_invalid",message:t("error:security.passwordInvalid")}:$.status==="error"?{status:"error",message:$.message,pendingTxId:$.pendingTxId}:{status:"error",message:t("error:unknown")}}),n("TransferWalletLockJob",{title:t("security:walletLock.verifyTitle")}))},{minFee:y.feeMinAmount?.toFormatted()??y.feeAmount?.toFormatted()??"0"}),n("TransferConfirmJob",{amount:y.amount?.toFormatted()??"0",symbol:z,toAddress:y.recipientAddress??"",feeAmount:y.feeAmount?.toFormatted()??"0",feeSymbol:y.feeSymbol,feeLoading:y.feeLoading?"true":"false"}))},L=()=>{y.resultStatus==="success"&&r.impact("success"),s()},V=()=>{I()},_=l.useCallback(()=>{if(!y.txHash)return;const G=h?.explorer?.queryTx;if(!G){a.show(t("sendPage.explorerNotImplemented"));return}const Z=G.replace(":hash",y.txHash).replace(":signature",y.txHash);window.open(Z,"_blank","noopener,noreferrer")},[y.txHash,h?.explorer?.queryTx,a,t]),O=h?.chainKind==="bioforest";return!u||!m?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:t("destroyPage.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("history.noWallet")})})]}):O?y.step==="result"||y.step==="burning"?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:t("destroyPage.resultTitle")}),e.jsx(Em,{status:y.step==="burning"?"pending":y.resultStatus??"pending",amount:y.amount?.toFormatted()??"0",symbol:z,toAddress:y.recipientAddress??"",txHash:y.txHash??void 0,errorMessage:y.errorMessage??void 0,onDone:L,onRetry:y.resultStatus==="failed"?V:void 0,onViewExplorer:y.resultStatus==="success"&&h?.explorer?.queryTx?_:void 0})]}):e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:t("destroyPage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"bg-muted/50 space-y-2 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(xt,{chain:d,size:"sm"}),e.jsx("span",{className:"text-sm font-medium",children:x})]}),m?.address&&e.jsxs("div",{className:"text-muted-foreground flex items-center justify-center gap-1 text-xs",children:[e.jsxs("span",{children:[t("sendPage.from"),":"]}),e.jsxs("span",{className:"font-mono",children:[m.address.slice(0,8),"...",m.address.slice(-6)]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("destroyPage.assetLabel")}),e.jsx(no,{selectedAsset:k,assets:v,onSelect:P,disabled:N,excludeAssets:h?[h.symbol]:[],testId:"destroy-asset-selector"}),v.length===0&&e.jsx("p",{className:"text-muted-foreground text-xs",children:t("destroyPage.noDestroyableAssets")})]}),y.asset&&e.jsx(fo,{label:t("destroyPage.amountLabel"),value:y.amount??void 0,onChange:C,balance:E??void 0,symbol:z,error:y.amountError??void 0}),e.jsx(zt,{variant:"warning",children:t("destroyPage.warning")}),y.feeAmount&&e.jsx("div",{className:"bg-muted/50 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:t("sendPage.fee")}),e.jsxs("span",{className:"font-medium",children:[y.feeAmount.toFormatted()," ",y.feeSymbol]})]})}),e.jsx("div",{className:"pt-4",children:e.jsxs(ze,{variant:"mint",className:"w-full","data-testid":"destroy-confirm-button",disabled:!T,onClick:D,children:[e.jsx(pn,{className:"mr-2 -ml-4 size-4"}),t("destroyPage.confirm")]})})]})]}):e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:t("destroyPage.title"),onBack:s}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx(pn,{className:"text-muted-foreground size-16"}),e.jsx("p",{className:"text-muted-foreground text-center",children:t("destroyPage.notSupported")})]})]})}function Wl(){const{goBack:t}=ae(),s=Be(),{t:n}=B(["transaction","common"]);return e.jsx(jt,{chainId:s,fallback:e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:n("destroyPage.title"),onBack:t}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Chain not supported"})})]}),children:e.jsx(Xv,{})})}Wl.__docgenInfo={description:"",methods:[],displayName:"DestroyPage"};const Fl=({params:t})=>e.jsx(ne,{children:e.jsx(ce,{params:t,children:e.jsx(Xi,{children:e.jsx(Wl,{})})})});Fl.__docgenInfo={description:"",methods:[],displayName:"DestroyActivity"};function $l(){const{t}=B(["transaction","common"]),{goBack:s}=ae(),n=Oa(),a=at(),r=Vs(),o=zn(),c=Be(),i=wa(c),d=Na(),[u,m]=l.useState(!1),[f,h]=l.useState(!1),x=l.useRef(null),b=o?.address||"",p=d.username||t("common:myCard.defaultName"),g=l.useMemo(()=>b?_a({name:p,addresses:[{address:b,label:i}],avatar:d.avatar}):"",[p,b,i,d.avatar]),v=async()=>{b&&(await n.write({text:b}),await r.impact("light"),m(!0),a.show(t("receivePage.addressCopied")),setTimeout(()=>m(!1),2e3))},j=l.useCallback(async()=>{const y=x.current;if(!(!y||f)){h(!0);try{const{snapdom:C}=await ht(async()=>{const{snapdom:w}=await import("./snapdom-CO8q8LPW.js").then(S=>S.s);return{snapdom:w}},__vite__mapDeps([0,1]),import.meta.url);await C.download(y,{type:"png",filename:`receive-${c}-${b.slice(0,8)}.png`,scale:2,quality:1}),await r.impact("success"),a.show(t("receivePage.imageSaved"))}catch{}finally{h(!1)}}},[b,c,f,r,a,t]),N=l.useCallback(async()=>{const y=x.current;if(!(!y||f)){h(!0);try{if(navigator.share){const{snapdom:C}=await ht(async()=>{const{snapdom:A}=await import("./snapdom-CO8q8LPW.js").then(I=>I.s);return{snapdom:A}},__vite__mapDeps([0,1]),import.meta.url),S=await(await C(y,{scale:2})).toBlob(),M=new File([S],`receive-${c}.png`,{type:"image/png"});await navigator.share({title:t("receivePage.shareTitle"),text:b,files:[M]}),await r.impact("success")}}catch{}finally{h(!1)}}},[b,c,f,r,t]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("receivePage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"text-muted-foreground flex items-center justify-center gap-2",children:[e.jsx(xt,{chain:c,size:"sm"}),e.jsx("span",{className:"text-sm",children:i})]}),e.jsx("div",{ref:x,className:"flex justify-center",children:e.jsx(Ra,{name:p,avatar:d.avatar,addresses:[{address:b,label:i}],qrContent:g,caption:t("common:contactCard.transferToMe")})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm font-medium",children:t("receivePage.receiveAddress")}),e.jsx("div",{className:"border-border bg-card rounded-xl border p-4",children:e.jsx(Pt,{address:b,copyable:!0})})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(q,{variant:"outline",className:"flex-1",onClick:v,children:u?e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"mr-2 size-4"}),t("receivePage.copied")]}):e.jsxs(e.Fragment,{children:[e.jsx(Ji,{className:"mr-2 size-4"}),t("receivePage.copyAddress")]})}),e.jsxs(q,{variant:"outline",className:"flex-1",onClick:j,disabled:f,children:[f?e.jsx(Ce,{className:"mr-2 size-4 animate-spin"}):e.jsx(Hs,{className:"mr-2 size-4"}),t("receivePage.saveImage")]})]}),e.jsxs(ze,{variant:"mint",className:"w-full",onClick:N,disabled:f,children:[f?e.jsx(Ce,{className:"mr-2 size-4 animate-spin"}):e.jsx(Bf,{className:"mr-2 size-4"}),t("receivePage.share")]}),e.jsx(zt,{variant:"info",children:t("receivePage.networkWarning",{chain:i})})]})]})}$l.__docgenInfo={description:"",methods:[],displayName:"ReceivePage"};const ql=()=>e.jsx(ne,{children:e.jsx($l,{})});ql.__docgenInfo={description:"",methods:[],displayName:"ReceiveActivity"};const Hl=()=>e.jsx(ne,{children:e.jsx(lr,{})});Hl.__docgenInfo={description:"",methods:[],displayName:"SettingsActivity"};const Zv={"zh-CN":"","zh-TW":"",en:"English",ar:""};function Ul(){const{goBack:t}=ae(),{t:s}=B("settings"),n=Ft(),a=r=>{_n.setLanguage(r),t()};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:s("languagePage.title"),onBack:t}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:Object.keys(ru).map((r,o)=>e.jsxs("div",{children:[o>0&&e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsxs("button",{onClick:()=>a(r),className:R("flex w-full items-center justify-between px-4 py-3.5","hover:bg-muted/50 active:bg-muted transition-colors",r===n&&"bg-primary/5"),children:[e.jsx("span",{className:"text-sm font-medium",children:Zv[r]}),r===n&&e.jsx(xe,{className:"text-primary size-5"})]})]},r))}),e.jsx("p",{className:"text-muted-foreground mt-4 px-1 text-xs",children:s("languagePage.hint")})]})]})}Ul.__docgenInfo={description:"",methods:[],displayName:"LanguagePage"};const Vl=()=>e.jsx(ne,{children:e.jsx(Ul,{})});Vl.__docgenInfo={description:"",methods:[],displayName:"SettingsLanguageActivity"};function Jl(){const{t}=B("settings"),{goBack:s}=ae(),n=Fi(),a=r=>{_n.setCurrency(r),s()};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("currency.title"),onBack:s}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:Object.keys(dr).map((r,o)=>e.jsxs("div",{children:[o>0&&e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsxs("button",{onClick:()=>a(r),className:R("flex w-full items-center justify-between px-4 py-3.5","hover:bg-muted/50 active:bg-muted transition-colors",r===n&&"bg-primary/5"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-muted-foreground text-base font-semibold",children:dr[r].symbol}),e.jsx("span",{className:"text-sm font-medium",children:t(`currency.names.${r}`)})]}),r===n&&e.jsx(xe,{className:"text-primary size-5"})]})]},r))}),e.jsx("p",{className:"text-muted-foreground mt-4 px-1 text-xs",children:t("currency.hint")})]})]})}Jl.__docgenInfo={description:"",methods:[],displayName:"CurrencyPage"};const Kl=()=>e.jsx(ne,{children:e.jsx(Jl,{})});Kl.__docgenInfo={description:"",methods:[],displayName:"SettingsCurrencyActivity"};function ey(t){const{children:s,open:n,defaultOpen:a=!1,onOpenChange:r,onOpenChangeComplete:o,actionsRef:c,handle:i,triggerId:d,defaultTriggerId:u=null}=t,m=im(),f=!!m,h=_m(()=>i?.store??new lm({open:n??a,activeTriggerId:d!==void 0?d:u,modal:!0,disablePointerDismissal:!0,nested:f,role:"alertdialog"})).current;h.useControlledProp("open",n,a),h.useControlledProp("activeTriggerId",d,u),h.useSyncedValue("nested",f),h.useContextCallback("onOpenChange",r),h.useContextCallback("onOpenChangeComplete",o);const x=h.useState("payload");om({store:h,actionsRef:c,parentContext:m?.store.context});const b=l.useMemo(()=>({store:h}),[h]);return e.jsx(cm.Provider,{value:b,children:typeof s=="function"?s({payload:x}):s})}function Gl({...t}){return e.jsx(ey,{"data-slot":"alert-dialog",...t})}function Ql({...t}){return e.jsx(pm,{"data-slot":"alert-dialog-portal",...t})}function Yl({className:t,...s}){return e.jsx(hm,{"data-slot":"alert-dialog-overlay",className:R("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 bg-black/10 duration-100 supports-backdrop-filter:backdrop-blur-xs fixed inset-0 isolate z-50",t),...s})}function Xl({className:t,size:s="default",...n}){return e.jsxs(Ql,{children:[e.jsx(Yl,{}),e.jsx(dm,{"data-slot":"alert-dialog-content","data-size":s,className:R("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 data-closed:zoom-out-95 data-open:zoom-in-95 bg-background ring-foreground/10 gap-4 rounded-xl p-4 ring-1 duration-100 data-[size=default]:max-w-xs data-[size=sm]:max-w-xs data-[size=default]:sm:max-w-sm group/alert-dialog-content fixed top-1/2 left-1/2 z-50 grid w-full -translate-x-1/2 -translate-y-1/2 outline-none",t),...n})]})}function Zl({className:t,...s}){return e.jsx("div",{"data-slot":"alert-dialog-header",className:R("grid grid-rows-[auto_1fr] place-items-center gap-1.5 text-center has-data-[slot=alert-dialog-media]:grid-rows-[auto_auto_1fr] has-data-[slot=alert-dialog-media]:gap-x-4 sm:group-data-[size=default]/alert-dialog-content:place-items-start sm:group-data-[size=default]/alert-dialog-content:text-left sm:group-data-[size=default]/alert-dialog-content:has-data-[slot=alert-dialog-media]:grid-rows-[auto_1fr]",t),...s})}function ed({className:t,...s}){return e.jsx("div",{"data-slot":"alert-dialog-footer",className:R("bg-muted/50 -mx-4 -mb-4 rounded-b-xl border-t p-4 flex flex-col-reverse gap-2 group-data-[size=sm]/alert-dialog-content:grid group-data-[size=sm]/alert-dialog-content:grid-cols-2 sm:flex-row sm:justify-end",t),...s})}function td({className:t,...s}){return e.jsx(um,{"data-slot":"alert-dialog-title",className:R("text-sm font-medium sm:group-data-[size=default]/alert-dialog-content:group-has-data-[slot=alert-dialog-media]/alert-dialog-content:col-start-2",t),...s})}function sd({className:t,...s}){return e.jsx(mm,{"data-slot":"alert-dialog-description",className:R("text-muted-foreground *:[a]:hover:text-foreground text-sm text-balance md:text-pretty *:[a]:underline *:[a]:underline-offset-3",t),...s})}function nd({className:t,...s}){return e.jsx(q,{"data-slot":"alert-dialog-action",className:R(t),...s})}function ad({className:t,variant:s="outline",size:n="default",...a}){return e.jsx(fm,{"data-slot":"alert-dialog-cancel",className:R(t),render:e.jsx(q,{variant:s,size:n}),...a})}Gl.__docgenInfo={description:"",methods:[],displayName:"AlertDialog"};nd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogAction"};ad.__docgenInfo={description:"",methods:[],displayName:"AlertDialogCancel",props:{variant:{defaultValue:{value:'"outline"',computed:!1},required:!1},size:{defaultValue:{value:'"default"',computed:!1},required:!1}}};Xl.__docgenInfo={description:"",methods:[],displayName:"AlertDialogContent",props:{size:{required:!1,tsType:{name:"union",raw:'"default" | "sm"',elements:[{name:"literal",value:'"default"'},{name:"literal",value:'"sm"'}]},description:"",defaultValue:{value:'"default"',computed:!1}}}};sd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogDescription"};ed.__docgenInfo={description:"",methods:[],displayName:"AlertDialogFooter"};Zl.__docgenInfo={description:"",methods:[],displayName:"AlertDialogHeader"};Yl.__docgenInfo={description:"",methods:[],displayName:"AlertDialogOverlay"};Ql.__docgenInfo={description:"",methods:[],displayName:"AlertDialogPortal"};td.__docgenInfo={description:"",methods:[],displayName:"AlertDialogTitle"};function _i(t){if(typeof t!="object"||t===null||Array.isArray(t))return null;const s=t.id;return typeof s=="string"&&s.trim()!==""?s:null}function ty(t){try{const s=JSON.parse(t),n=Array.isArray(s)?s.map(_i):[_i(s)];return Array.from(new Set(n.filter(a=>typeof a=="string")))}catch{return[]}}function sy(t,s){switch(s){case"default":return t("chainConfig.source.default");case"subscription":return t("chainConfig.source.subscription");case"manual":return t("chainConfig.source.manual")}}function ny(t){switch(t){case"default":return"bg-muted text-muted-foreground";case"subscription":return"bg-blue-500/10 text-blue-600";case"manual":return"bg-amber-500/10 text-amber-700"}}function ay(t){const s=new Map;for(const n of t)s.set(n.id,n);return s}function rd(){const{goBack:t}=ae(),{t:s}=B("settings"),n=at(),a=Os(),r=uu(),o=mu(),c=fu(),i=pu(),d=l.useMemo(()=>ay(o),[o]),[u,m]=l.useState("default"),[f,h]=l.useState(""),[x,b]=l.useState(!1),[p,g]=l.useState([]),v=l.useRef(null),j=l.useRef(null),N=l.useRef(!1);l.useEffect(()=>{Gt.initialize()},[]),l.useEffect(()=>{r?.url&&m(r.url)},[r?.url]),l.useEffect(()=>{const A=N.current;if(N.current=c,!A||c)return;const I=v.current;if(I){if(v.current=null,i){n.show(i);return}n.show(s(`chainConfig.toast.${I}`)),I==="manualAdded"&&h("")}},[i,c,s,n]);const y=async()=>{v.current="subscriptionSaved",await Gt.setSubscriptionUrl(u)},C=async()=>{v.current="subscriptionRefreshed",await Gt.refreshSubscription()},w=async()=>{const A=ty(f),I=new Set(a.map(P=>P.id)),T=A.filter(P=>I.has(P));if(T.length>0){j.current=f,g(T),b(!0);return}v.current="manualAdded",await Gt.addManualConfig(f)},S=()=>{j.current=null,g([]),b(!1)},M=async()=>{const A=j.current;j.current=null,g([]),b(!1),A&&(v.current="manualAdded",await Gt.addManualConfig(A))};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:s("chainConfig.title"),onBack:t}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx(Gl,{open:x,onOpenChange:A=>{A?b(A):S()},children:e.jsxs(Xl,{children:[e.jsxs(Zl,{children:[e.jsx(td,{children:s("chainConfig.manual.duplicate.title")}),e.jsx(sd,{children:s("chainConfig.manual.duplicate.description")})]}),e.jsx("div",{className:"bg-muted/50 text-muted-foreground rounded-lg px-3 py-2 text-xs font-mono break-all",children:p.join(", ")}),e.jsxs(ed,{children:[e.jsx(ad,{onClick:S,children:s("chainConfig.manual.duplicate.cancel")}),e.jsx(nd,{onClick:M,disabled:c,children:s("chainConfig.manual.duplicate.replace")})]})]})}),i&&e.jsx("div",{className:"border-destructive/20 bg-destructive/5 text-destructive rounded-xl border px-4 py-3 text-sm",children:i}),e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:e.jsxs("div",{className:"space-y-3 px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.subscription.title")}),e.jsx("div",{className:"text-muted-foreground text-xs",children:e.jsx(ho,{ns:"settings",i18nKey:"chainConfig.subscription.description",components:{code:e.jsx("code",{className:"font-mono"})}})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{type:"button",variant:"outline",size:"icon","data-testid":"refresh-subscription-button",onClick:C,disabled:c,"aria-label":s("chainConfig.subscription.refreshAriaLabel"),children:e.jsx(Vt,{className:R("size-4",c&&"animate-spin")})}),e.jsx(q,{type:"button","data-testid":"save-subscription-button",onClick:y,disabled:c,children:s("chainConfig.subscription.save")})]})]}),e.jsx(De,{"data-testid":"subscription-url-input",value:u,onChange:A=>m(A.target.value),placeholder:s("chainConfig.subscription.placeholder"),disabled:c,autoCapitalize:"off",autoCorrect:"off",spellCheck:!1}),r?.lastUpdated&&e.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.subscription.lastUpdated",{value:r.lastUpdated})})]})}),e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm","data-testid":"manual-add-section",children:e.jsxs("div",{className:"space-y-3 px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.manual.title")}),e.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.manual.description")})]}),e.jsxs(q,{type:"button",variant:"outline","data-testid":"add-chain-button",onClick:w,disabled:c||f.trim()==="",children:[e.jsx(nt,{className:"size-4"}),s("chainConfig.manual.add")]})]}),e.jsx("textarea",{"data-testid":"manual-config-textarea",value:f,onChange:A=>h(A.target.value),placeholder:s("chainConfig.manual.placeholder"),rows:5,disabled:c,className:R("bg-background w-full resize-none rounded-lg border px-3 py-3 text-sm","placeholder:text-muted-foreground","focus:ring-ring focus:ring-2 focus:ring-offset-2 focus:outline-none","disabled:cursor-not-allowed disabled:opacity-50"),autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})]})}),e.jsxs("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:[e.jsxs("div",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.list.title")}),e.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.list.description")})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{children:[a.map((A,I)=>{const T=d.get(A.id),P=T?.kind==="incompatible_major",k=sy(s,A.source);return e.jsxs("div",{"data-testid":`chain-item-${A.id}`,children:[I>0&&e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate text-sm font-medium",children:A.name}),e.jsx("span",{className:R("rounded px-2 py-0.5 text-xs",ny(A.source)),children:k})]}),e.jsxs("div",{className:"text-muted-foreground mt-1 flex flex-wrap gap-x-3 gap-y-1 text-xs",children:[e.jsx("span",{className:"font-mono",children:A.id}),e.jsxs("span",{children:["v",A.version]}),e.jsx("span",{children:A.chainKind}),e.jsx("span",{children:A.symbol})]}),T?.kind==="incompatible_major"&&e.jsxs("div",{className:"mt-2 flex items-start gap-2 rounded-lg bg-amber-500/10 px-3 py-2 text-xs text-amber-800",children:[e.jsx(_e,{className:"mt-0.5 size-4 shrink-0"}),e.jsx("div",{children:s("chainConfig.warning.incompatibleMajor",{version:T.version,supportedMajor:T.supportedMajor})})]})]}),e.jsx(to,{checked:A.enabled,onCheckedChange:E=>{Gt.setChainEnabled(A.id,E)},disabled:c||P,className:R(P&&"cursor-not-allowed opacity-60")})]})})]},A.id)}),a.length===0&&e.jsx("div",{className:"text-muted-foreground px-4 py-8 text-center text-sm",children:s("chainConfig.list.empty")})]})]}),e.jsx("div",{className:"text-muted-foreground px-1 text-xs",children:s("chainConfig.hint")})]})]})}rd.__docgenInfo={description:"",methods:[],displayName:"ChainConfigPage"};const id=()=>e.jsx(ne,{children:e.jsx(rd,{})});id.__docgenInfo={description:"",methods:[],displayName:"SettingsChainsActivity"};const ry=3e4;function od(){const{t}=B("settings"),{goBack:s}=ae(),{push:n}=Q(),a=Ae(),o=(a?.keyType??"mnemonic")==="arbitrary",[c,i]=l.useState(""),[d,u]=l.useState(!0),m=l.useRef(!1);l.useEffect(()=>{if(c.length>0&&!d){const x=setTimeout(()=>{u(!0)},ry);return()=>clearTimeout(x)}},[c.length,d]),l.useEffect(()=>{const x=()=>{document.hidden&&c.length>0&&u(!0)};return document.addEventListener("visibilitychange",x),()=>{document.removeEventListener("visibilitychange",x)}},[c.length]),l.useEffect(()=>{m.current||!a?.encryptedMnemonic||(m.current=!0,Nt(async x=>{try{const b=await ss(a.encryptedMnemonic,x);return i(b),u(!1),!0}catch{return!1}}),n("WalletLockConfirmJob",{title:t("viewMnemonic.verifyTitle"),description:t(o?"viewMnemonic.verifyDescKey":"viewMnemonic.verifyDescMnemonic")}))},[a,n,t,o]);const f=()=>{u(x=>!x)};if(!a)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t(o?"viewMnemonic.titleKey":"viewMnemonic.titleMnemonic"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("viewMnemonic.noWallet")})})]});const h=o?[]:c.trim().split(/\s+/).filter(Boolean);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t(o?"viewMnemonic.titleKey":"viewMnemonic.titleMnemonic"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"flex gap-3 rounded-xl bg-amber-500/10 p-4",children:[e.jsx(_e,{className:"size-5 shrink-0 text-amber-500"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("p",{className:"font-medium text-amber-700 dark:text-amber-400",children:t("viewMnemonic.securityTip")}),e.jsx("p",{className:"text-muted-foreground",children:t(o?"viewMnemonic.securityWarningKey":"viewMnemonic.securityWarningMnemonic")})]})]}),c.length>0&&e.jsxs("div",{className:"bg-card space-y-4 rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:o?t("viewMnemonic.charCount",{count:c.length}):t("viewMnemonic.wordCount",{count:h.length})}),e.jsx("button",{onClick:f,className:R("flex items-center gap-1.5 rounded-full px-3 py-1.5 text-xs font-medium","bg-muted hover:bg-muted/80 transition-colors"),children:d?e.jsxs(e.Fragment,{children:[e.jsx(La,{className:"size-3.5"}),t("viewMnemonic.show")]}):e.jsxs(e.Fragment,{children:[e.jsx(mo,{className:"size-3.5"}),t("viewMnemonic.hide")]})})]}),o?e.jsx("textarea",{value:c,readOnly:!0,rows:4,"data-testid":"secret-textarea",className:R("bg-background w-full resize-none rounded-lg border px-3 py-3 font-mono text-sm","focus:outline-none",d?"[-webkit-text-security:disc]":"[-webkit-text-security:none]")}):e.jsx(co,{words:h,hidden:d}),!d&&e.jsx("p",{className:"text-muted-foreground text-center text-xs",children:t("viewMnemonic.autoHideNote")})]})]})]})}od.__docgenInfo={description:"",methods:[],displayName:"ViewMnemonicPage"};const cd=()=>e.jsx(ne,{children:e.jsx(od,{})});cd.__docgenInfo={description:"",methods:[],displayName:"SettingsMnemonicActivity"};function ld(){const{t}=B("settings"),{goBack:s}=ae(),n=Ae(),[a,r]=l.useState("verify"),[o,c]=l.useState("pattern"),[i,d]=l.useState([]),[u,m]=l.useState(!1),[f,h]=l.useState(!1),x=l.useRef(null),[b,p]=l.useState([]),[g,v]=l.useState(!1),[j,N]=l.useState(null),[y,C]=l.useState(null),w=l.useCallback(()=>{x.current&&(clearTimeout(x.current),x.current=null),m(!1)},[]),S=l.useCallback(P=>{u&&P.length>0&&w(),d(P)},[u,w]),M=l.useCallback(async P=>{if(n?.encryptedMnemonic){h(!0),w();try{const k=gt(P);await Mt(n.encryptedMnemonic,k)?(d(P),r("setup")):(m(!0),d([]),x.current=setTimeout(()=>{m(!1)},1500))}catch{m(!0),d([]),x.current=setTimeout(()=>{m(!1)},1500)}finally{h(!1)}}},[n,w]),A=l.useCallback((P,k)=>{p(P),v(k),N(null)},[]),I=l.useCallback(async()=>{if(n?.encryptedWalletLock){h(!0),N(null);try{if(!Vi(b)){N(t("changeWalletLock.invalidMnemonic")),h(!1);return}const P=b.join(" ");await pe.verifyMnemonic(n.id,P)?(C(P),r("setup")):N(t("changeWalletLock.mnemonicVerifyFailed"))}catch{N(t("changeWalletLock.mnemonicVerifyFailed"))}finally{h(!1)}}},[n,b,t]),T=l.useCallback(async P=>{if(n)try{if(o==="mnemonic"&&y)await pe.resetWalletLockByMnemonic(n.id,y,P);else{const k=gt(i);await pe.updateWalletLock(n.id,k,P)}r("success"),setTimeout(()=>{s()},2e3)}catch{r("verify"),d([]),C(null)}},[n,o,y,i,s]);return n?a==="success"?e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("changeWalletLock.title")}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx("div",{className:"bg-green-500/10 flex size-16 items-center justify-center rounded-full",children:e.jsx(xe,{className:"text-green-500 size-8"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:t("changeWalletLock.success")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:t("changeWalletLock.returning")})]})]})]}):a==="verify"?e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("changeWalletLock.title"),onBack:s}),e.jsx("div",{className:"flex-1 p-4",children:o==="pattern"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:t("changeWalletLock.verifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("changeWalletLock.verifyDesc")})]}),e.jsx(Ut,{value:i,onChange:S,onComplete:M,minPoints:4,error:u,disabled:f,"data-testid":"verify-pattern-lock"}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx("button",{type:"button",onClick:()=>c("mnemonic"),className:"text-primary hover:text-primary/80 text-sm underline","data-testid":"switch-to-mnemonic",children:t("changeWalletLock.forgotPattern")})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:t("changeWalletLock.mnemonicVerifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("changeWalletLock.mnemonicVerifyDesc")})]}),e.jsx(Mm,{wordCount:12,onChange:A}),j&&e.jsx("p",{className:"text-destructive mt-4 text-center text-sm",children:j}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx(q,{onClick:I,disabled:!g||f,className:"w-full","data-testid":"verify-mnemonic-button",children:t(f?"changeWalletLock.verifying":"changeWalletLock.verifyMnemonic")}),e.jsx("button",{type:"button",onClick:()=>{c("pattern"),p([]),N(null)},className:"text-muted-foreground hover:text-foreground w-full text-center text-sm","data-testid":"switch-to-pattern",children:t("changeWalletLock.usePattern")})]})]})})]}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("changeWalletLock.title"),onBack:()=>{r("verify"),d([])}}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(za,{onComplete:T,minPoints:4})})]}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("changeWalletLock.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("changeWalletLock.noWallet")})})]})}ld.__docgenInfo={description:"",methods:[],displayName:"ChangeWalletLockPage"};const dd=()=>e.jsx(ne,{children:e.jsx(ld,{})});dd.__docgenInfo={description:"",methods:[],displayName:"SettingsWalletLockActivity"};function iy({targetChain:t,address:s,filter:n,setFilter:a,walletId:r,decimals:o}){const{navigate:c,goBack:i}=ae(),d=Ws(),{t:u}=B(["transaction","common"]),m=Kt(),{data:f,isLoading:h,isFetching:x,error:b,refetch:p}=m.transactionHistory.useState({address:s,limit:50},{enabled:!!s}),g=ga(b,u),{transactions:v,deleteTransaction:j,retryTransaction:N}=Ui(r,t,s,f),y=l.useMemo(()=>{if(!f)return[];const T=n.period;if(!T||T==="all")return f;const P=T==="7d"?7:T==="30d"?30:90,k=Date.now()-P*24*60*60*1e3;return f.filter(E=>E.timestamp>=k)},[f,n.period]),C=l.useMemo(()=>[{value:"all",label:u("history.filter.allTime")},{value:"7d",label:u("history.filter.days7")},{value:"30d",label:u("history.filter.days30")},{value:"90d",label:u("history.filter.days90")}],[u]),w=l.useMemo(()=>[{value:"all",label:u("history.filter.allChains")},...d.map(T=>({value:T.id,label:T.name}))],[u,d]),S=l.useCallback(T=>{if(!T.id)return;const P=f?.find(E=>E.hash===T.hash),k=P?Dt.stringify(P):void 0;c({to:`/transaction/${T.id}`,search:{txData:k}})},[c,f]),M=l.useCallback(T=>{a(P=>({...P,chain:T}))},[a]),A=l.useCallback(T=>{a(P=>({...P,period:T}))},[a]),I=l.useCallback(async()=>{await p?.()},[p]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:u("transaction:history.title"),onBack:i,rightAction:e.jsx("button",{onClick:I,disabled:x,className:R("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80",x&&"animate-spin"),"aria-label":u("common:a11y.refresh"),children:e.jsx(Vt,{className:"size-5"})})}),e.jsxs("div",{className:"bg-card border-b px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(wo,{className:"text-muted-foreground size-4"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:u("history.filter.chainLabel")}),e.jsxs(Ts,{value:n.chain||"all",onValueChange:T=>M(T),children:[e.jsx(Ps,{size:"sm","aria-label":u("common:a11y.selectChain"),children:e.jsx(Es,{children:w.find(T=>T.value===(n.chain||"all"))?.label})}),e.jsx(_s,{children:w.map(T=>e.jsx(Wt,{value:T.value,children:T.label},T.value))})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:u("history.filter.periodLabel")}),e.jsxs(Ts,{value:n.period||"all",onValueChange:T=>A(T),children:[e.jsx(Ps,{size:"sm","aria-label":u("common:a11y.selectPeriod"),children:e.jsx(Es,{children:C.find(T=>T.value===(n.period||"all"))?.label})}),e.jsx(_s,{children:C.map(T=>e.jsx(Wt,{value:T.value,children:T.label},T.value))})]})]})]}),e.jsx("p",{className:"text-muted-foreground mt-2 text-xs",children:u("transaction:history.totalRecords",{count:y.length})})]}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[v.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-muted-foreground text-xs font-medium uppercase tracking-wider px-1",children:u("pendingTx.title")}),e.jsx("div",{className:"space-y-1",children:v.map(T=>{const P=zc(T,o);return e.jsx(Qi,{transaction:P,onClick:()=>c({to:`/pending-tx/${T.id}`}),onRetry:T.status==="failed"?()=>N(T):void 0,onDelete:()=>j(T)},T.id)})})]}),(g.limited||!g.supported)&&!h&&e.jsx(Vu,{type:g.limited?"limited":"notSupported",feature:u("home:wallet.transactionHistory"),reason:g.reason,className:"mb-4"}),e.jsx(xo,{transactions:Bc(y??[],t),loading:h,onTransactionClick:S,emptyTitle:u("transaction:history.emptyTitle"),emptyDescription:u("transaction:history.emptyDesc"),showChainIcon:!0})]})]})}function ud({initialChain:t}){const{goBack:s}=ae(),n=Ae(),a=Be(),{t:r}=B(["transaction","common"]),o=st(),[c,i]=l.useState({chain:t??a,period:"all"}),d=c.chain==="all"?a:c.chain,u=o.snapshot?Je.getChainById(o,d??""):void 0,f=n?.chainAddresses?.find(h=>h.chain===d)?.address??"";return n?e.jsx(jt,{chainId:d,fallback:e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:r("transaction:history.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Chain not supported"})})]}),children:e.jsx(iy,{targetChain:d,address:f,filter:c,setFilter:i,walletId:n.id,decimals:u?.decimals??8})}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:r("transaction:history.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:r("transaction:history.noWallet")})})]})}ud.__docgenInfo={description:"",methods:[],displayName:"TransactionHistoryPage",props:{initialChain:{required:!1,tsType:{name:"union",raw:"ChainType | 'all' | undefined",elements:[{name:"ChainType"},{name:"literal",value:"'all'"},{name:"undefined"}]},description:""}}};const md=()=>{const t=Xf();return e.jsx(ne,{children:e.jsx(ud,{initialChain:t.chain})})};md.__docgenInfo={description:"",methods:[],displayName:"HistoryActivity"};const oy={transfer:"send",swap:"swap",exchange:"exchange",approve:"approve",signature:"signature",stake:"stake",unstake:"unstake",mint:"mint",burn:"destroy",gift:"gift",grab:"grab",trust:"trust",signFor:"signFor",emigrate:"emigrate",immigrate:"immigrate",issueAsset:"issueAsset",increaseAsset:"increaseAsset",destroyAsset:"destroy",issueEntity:"issueEntity",destroyEntity:"destroyEntity",locationName:"locationName",dapp:"dapp",certificate:"certificate",mark:"mark",contract:"interaction",unknown:"other",revoke:"approve",claim:"receive"};function cy(t,s){const n=t.action,a=t.direction,r=n==="transfer"?a==="in"?"receive":"send":oy[n]??"other",o=t.assets[0],c=o.assetType==="nft"?"1":o.value,i=o.assetType==="nft"?0:o.decimals,d=o.assetType==="nft"?"NFT":o.symbol,u=a==="in"?t.from:t.to;return{hash:t.hash,from:t.from,to:t.to,address:u,timestamp:t.timestamp,status:t.status,type:r,direction:a,amount:se.fromRaw(c,i,d),symbol:d,chain:s,assets:t.assets,fee:t.fee?se.fromRaw(t.fee.value,t.fee.decimals,t.fee.symbol):void 0,contract:t.contract,blockNumber:t.blockNumber}}function Mi(t){return!t||t.assetType==="nft"?null:{value:t.value,decimals:t.decimals,symbol:t.symbol}}function ly(t){if(!t)return null;const[s,n]=t.split("--");return!s||!n?null:{chainId:s,hash:n}}function dy({hash:t,chainId:s,txData:n,onBack:a}){const{t:r}=B(["transaction","common"]),o=st(),c=Kt(),i=l.useMemo(()=>n?Dt.parse(n):null,[n]),{data:d,isLoading:u,error:m}=c.transaction.useState({txHash:t},{enabled:!!t}),f=d??i,h=l.useMemo(()=>f?cy(f,s):null,[f,s]),x=l.useMemo(()=>{const D=h?.chain??s;return D?Je.getChainById(o,D):null},[o,s,h?.chain]),b=l.useMemo(()=>{const D=x?.explorer?.queryTx;return!D||!t?null:D.replace(":signature",t)},[x?.explorer?.queryTx,t]),p=l.useCallback(()=>{b&&window.open(b,"_blank","noopener,noreferrer")},[b]),[g,v]=l.useState(!1),j=l.useCallback(async()=>{b&&(await Sa.write({text:b}),v(!0),setTimeout(()=>v(!1),2e3))},[b]);if(u&&!i)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:r("detail.title"),onBack:a}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx($n,{className:"h-48"}),e.jsx($n,{className:"h-64"}),e.jsx($n,{className:"h-32"})]})]});if(m instanceof zu)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:r("detail.title"),onBack:a}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx("div",{className:"bg-card flex items-center justify-center rounded-xl p-6 shadow-sm",children:e.jsx("p",{className:"text-muted-foreground",children:r("detail.invalidData")})}),t&&e.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:r("detail.hash")}),e.jsx(fr,{text:t,className:"text-muted-foreground text-xs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:p,disabled:!b,className:R("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:[e.jsx(ia,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.openInExplorer")})]}),e.jsx("button",{onClick:j,disabled:!b,className:R("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:g?e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"text-green-500 size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.copied")})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ms,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.share")})]})})]})]})]})]});if(!h)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:r("detail.title"),onBack:a}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:r("detail.notFound")})})]});const N=h.type,y=Bu(N),C=y.Icon,w=h.type==="swap"?h.assets?.[0]:void 0,S=h.type==="swap"?h.assets?.[1]:void 0,M=Mi(w),A=Mi(S),I=h.contract?.address||h.to,T=h.contract?.method,P=h.contract?.methodId,k=T?r(`method.${T}`,{defaultValue:T}):null,E=M?se.fromRaw(M.value,M.decimals,M.symbol):null,z=A?se.fromRaw(A.value,A.decimals,A.symbol):null;return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:r("detail.title"),onBack:a}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"bg-card flex flex-col items-center gap-3 rounded-xl p-6 shadow-sm",children:[e.jsx("div",{className:R("flex size-16 items-center justify-center rounded-full",y.bg),children:e.jsx(C,{className:R("size-8",y.color)})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:r(`type.${h.type}`,{defaultValue:h.type})}),h.type==="swap"&&E&&z?e.jsxs("div",{className:R("flex items-center justify-center gap-2",y.color),children:[e.jsx(At,{value:E.toNumber(),symbol:E.symbol,decimals:E.decimals,sign:"never",color:"default",weight:"normal",size:"lg"}),e.jsx("span",{className:"text-lg",children:""}),e.jsx(At,{value:z.toNumber(),symbol:z.symbol,decimals:z.decimals,sign:"never",color:"default",weight:"normal",size:"lg"})]}):e.jsx(At,{value:h.type==="send"?-Math.abs(h.amount.toNumber()):h.amount.toNumber(),symbol:h.symbol,sign:y.amountSign,color:"default",weight:"normal",size:"xl",className:y.color})]}),e.jsx(Rm,{status:Ou(h.status).badgeStatus,label:r(`transaction:status.${h.status}`)})]}),e.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:r("detail.info")}),h.from&&h.to?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.fromAddress")}),e.jsx(Pt,{address:h.from,copyable:!0,className:"text-sm"})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.toAddress")}),e.jsx(Pt,{address:h.to,copyable:!0,className:"text-sm"})]})]}):e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:h.type==="send"?r("detail.toAddress"):r("detail.fromAddress")}),e.jsx(Pt,{address:h.address,copyable:!0,className:"text-sm"})]}),e.jsx("div",{className:"bg-border h-px"}),h.type==="swap"&&(M||A)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.swapFrom")}),e.jsx("span",{className:"text-sm font-medium",children:M?e.jsx(At,{value:se.fromRaw(M.value,M.decimals,M.symbol).toNumber(),symbol:M.symbol,decimals:M.decimals,sign:"never",color:"default",size:"sm"}):"-"})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.swapTo")}),e.jsx("span",{className:"text-sm font-medium",children:A?e.jsx(At,{value:se.fromRaw(A.value,A.decimals,A.symbol).toNumber(),symbol:A.symbol,decimals:A.decimals,sign:"never",color:"default",size:"sm"}):"-"})]}),e.jsx("div",{className:"bg-border h-px"})]}),(h.type==="approve"||h.type==="interaction"||h.type==="swap")&&I&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.contractAddress")}),e.jsx(Pt,{address:I,copyable:!0,className:"text-sm"})]}),(h.type==="approve"||h.type==="interaction")&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.method")}),e.jsx("span",{className:"text-sm font-medium font-mono",children:k||P||r("common:unknown")})]}),h.type==="approve"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.spender")}),e.jsx("span",{className:"text-sm font-medium",children:r("common:unknown")})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.allowance")}),e.jsx("span",{className:"text-sm font-medium",children:r("common:unknown")})]})]})]}),e.jsx("div",{className:"bg-border h-px"})]}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.time")}),e.jsx(Hu,{value:h.timestamp,format:"datetime",className:"text-sm"})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.network")}),e.jsx("span",{className:"text-sm font-medium capitalize",children:h.chain})]}),h.fee&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.fee")}),e.jsx(Ea,{amount:h.fee?.toNumber?.()??0,symbol:h.fee?.symbol??"",className:"text-sm"})]})]}),h.blockNumber&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.blockHeight")}),e.jsx("span",{className:"text-sm font-medium",children:h.blockNumber.toLocaleString()})]})]}),h.confirmations!==void 0&&h.confirmations>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.confirmations")}),e.jsx("span",{className:"text-sm font-medium",children:h.confirmations})]})]})]}),t&&e.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:r("detail.hash")}),e.jsx(fr,{text:t,className:"text-muted-foreground text-xs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:p,disabled:!b,className:R("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:[e.jsx(ia,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.openInExplorer")})]}),e.jsx("button",{onClick:j,disabled:!b,className:R("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:g?e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"text-green-500 size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.copied")})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ms,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.share")})]})})]})]})]})]})}function fd(){const{t}=B(["transaction","common"]),{goBack:s}=ae(),{txId:n,txData:a}=ue(),r=Ae(),o=l.useMemo(()=>ly(n),[n]),c=l.useCallback(()=>{s()},[s]);return r?o?e.jsx(jt,{chainId:o.chainId,fallback:e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("detail.title"),onBack:c}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Chain not supported"})})]}),children:e.jsx(dy,{hash:o.hash,chainId:o.chainId,txData:a,onBack:c})}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("detail.title"),onBack:c}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("detail.notFound")})})]}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("detail.title"),onBack:c}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("history.noWallet")})})]})}fd.__docgenInfo={description:"",methods:[],displayName:"TransactionDetailPage"};const pd=({params:t})=>e.jsx(ne,{children:e.jsx(ce,{params:t,children:e.jsx(fd,{})})});pd.__docgenInfo={description:"",methods:[],displayName:"TransactionDetailActivity"};const uy=150;function hd({onScan:t,className:s}){const{t:n}=B("scanner"),{t:a}=B("common"),{navigate:r,goBack:o}=ae(),{push:c}=Q(),i=Ao(),d=l.useRef(null),u=l.useRef(null),m=l.useRef(null),f=l.useRef(null),h=l.useRef(!1),x=l.useRef(null),b=l.useRef(t),[p,g]=l.useState("idle"),[v,j]=l.useState(null),[N,y]=l.useState(!1);l.useEffect(()=>{b.current=t},[t]);const C=l.useCallback(P=>{if(P===x.current)return;x.current=P,g("success"),h.current=!1,"vibrate"in navigator&&navigator.vibrate(100);const k=ro(P);if(b.current)b.current(P,k);else switch(k.type){case"address":case"payment":r({to:"/send",search:{address:k.address,chain:k.chain,amount:k.type==="payment"?k.amount:void 0}});break;case"deeplink":r({to:k.path,search:k.params});break;case"contact":c("ContactAddConfirmJob",{name:k.name,addresses:JSON.stringify(k.addresses),memo:k.memo,avatar:k.avatar});break;case"unknown":r({to:"/send",search:{address:k.content}});break}},[r,c]),w=l.useCallback(()=>{if(h.current)return;h.current=!0,u.current||(u.current=document.createElement("canvas"));const P=async()=>{if(!(!h.current||!d.current||!f.current)){try{const k=await f.current.scanFromVideo(d.current,u.current??void 0);if(k){C(k.content);return}}catch{}h.current&&setTimeout(P,uy)}};P()},[C]),S=l.useCallback(()=>{h.current=!1,m.current&&(m.current.getTracks().forEach(P=>P.stop()),m.current=null)},[]),M=l.useCallback(async()=>{S(),g("requesting"),x.current=null;try{if(!await i.checkPermission()&&!await i.requestPermission()){g("denied");return}const k=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});m.current=k,d.current&&(d.current.srcObject=k,await d.current.play(),w()),g("scanning")}catch(P){g("error"),j(P instanceof Error?P.message:"Camera initialization failed")}},[i,w,S]);l.useEffect(()=>(f.current=io({useWorker:!0}),M(),()=>{S(),f.current?.destroy(),f.current=null}),[]);const A=l.useCallback(()=>{S(),o()},[S,o]),I=l.useCallback(()=>{const P=document.createElement("input");P.type="file",P.accept="image/*",P.onchange=async k=>{const E=k.target.files?.[0];if(E)try{const z=new Image,D=URL.createObjectURL(E);z.onload=async()=>{URL.revokeObjectURL(D);const L=document.createElement("canvas");L.width=z.width,L.height=z.height;const V=L.getContext("2d");if(!V||!f.current){j(n("noQrFound")),g("error");return}V.drawImage(z,0,0);const _=await f.current.scanFromCanvas(L);_?C(_.content):(j(n("noQrFound")),g("error"))},z.onerror=()=>{URL.revokeObjectURL(D),j(n("noQrFound")),g("error")},z.src=D}catch{j(n("noQrFound")),g("error")}},P.click()},[C,n]),T=l.useCallback(async()=>{if(m.current){const P=m.current.getVideoTracks()[0];if(P)try{await P.applyConstraints({advanced:[{torch:!N}]}),y(!N)}catch{}}},[N]);return e.jsxs("div",{className:R("relative flex h-screen flex-col bg-black",s),children:[e.jsxs("div",{className:"absolute top-0 right-0 left-0 z-10 flex items-center justify-between p-4",children:[e.jsx(q,{variant:"ghost",size:"icon","data-testid":"back-button",onClick:A,className:"text-white","aria-label":a("a11y.back"),children:e.jsx(Us,{className:"size-6"})}),e.jsx("h1",{"data-testid":"page-title",className:"text-lg font-medium text-white",children:n("title")}),e.jsx(q,{variant:"ghost",size:"icon",onClick:T,className:R("text-white",N&&"text-yellow-400"),"aria-label":n(N?"flashOff":"flashOn"),children:e.jsx(jo,{className:"size-6"})})]}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("video",{ref:d,className:R("absolute inset-0 size-full object-cover",p!=="scanning"&&p!=="success"&&"invisible"),playsInline:!0,muted:!0}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"relative size-64",children:[e.jsx("div",{className:R("absolute top-0 left-0 size-8 border-t-4 border-l-4",p==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:R("absolute top-0 right-0 size-8 border-t-4 border-r-4",p==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:R("absolute bottom-0 left-0 size-8 border-b-4 border-l-4",p==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:R("absolute right-0 bottom-0 size-8 border-r-4 border-b-4",p==="success"?"border-green-500":"border-primary")}),p==="scanning"&&e.jsx("div",{className:"animate-scan bg-primary absolute right-2 left-2 h-0.5"})]})}),e.jsxs("div",{className:"absolute inset-x-0 bottom-32 text-center",children:[p==="idle"&&e.jsx("p",{className:"text-white/80",children:n("initializing")}),p==="requesting"&&e.jsx("p",{className:"text-white/80",children:n("requestingPermission")}),p==="scanning"&&e.jsx("p",{className:"text-white/80",children:n("scanPrompt")}),p==="success"&&e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-green-400",children:n("scanSuccess")})}),p==="denied"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-red-400",children:n("permissionDenied")}),e.jsx(q,{variant:"outline","data-testid":"retry-button",onClick:M,children:n("retry")})]}),p==="error"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-red-400",children:v||n("error")}),e.jsx(q,{variant:"outline","data-testid":"retry-button",onClick:M,children:n("retry")})]})]})]}),e.jsxs("div",{className:"absolute inset-x-0 bottom-0 flex justify-center gap-8 pb-8",children:[e.jsxs(q,{variant:"ghost",size:"lg","data-testid":"gallery-button",onClick:I,className:"flex flex-col items-center text-white",children:[e.jsx(vo,{className:"mb-1 size-6"}),e.jsx("span",{className:"text-xs",children:n("gallery")})]}),e.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-white/20",children:e.jsx(af,{className:"size-8 text-white"})}),e.jsx("div",{className:"w-16"})," "]})]})}hd.__docgenInfo={description:"",methods:[],displayName:"ScannerPage",props:{onScan:{required:!1,tsType:{name:"union",raw:"((content: string, parsed: ParsedQRContent) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:"Callback when QR code is scanned"},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"Custom class name"}}};const xd=()=>e.jsx(ne,{children:e.jsx(hd,{})});xd.__docgenInfo={description:"",methods:[],displayName:"ScannerActivity"};const my=300*1e3;function gd(t){if(t)return t}function fy(t){return t.map(s=>({id:s.id,name:s.name,address:s.address,balance:""}))}function py(t,s,n){const a=new Map;for(const r of t)for(const o of r.chainAddresses){const c=gd(o.chain);if(!c)continue;const i=a.get(c)??[];i.push({address:o.address,isDefault:r.id===s}),a.set(c,i)}return Array.from(a.entries()).map(([r,o])=>({chain:r,name:n[r]??r,addresses:o.map(c=>({address:c.address,isDefault:c.isDefault}))}))}function Ri(t){const s=t?.trim().toLowerCase();return s==="true"||s==="1"}function vd(){const{t}=B("authorize"),{t:s}=B("common"),{navigate:n,goBack:a}=ae(),{push:r}=Q(),o=at(),{id:c,type:i,chainName:d,signMessage:u,getMain:m}=ue(),f=we(ke,W=>W.currentWalletId),h=we(ke,W=>W.wallets),x=we(ke,Bs.getCurrentWallet),b=$t(),[p,g]=l.useState(null),[v,j]=l.useState(null),[N,y]=l.useState(!1),C=l.useMemo(()=>fy(h),[h]),w=x?.id??h[0]?.id,[S,M]=l.useState(w),A=l.useMemo(()=>gd(d),[d]),[I,T]=l.useState(A);l.useEffect(()=>T(A),[A]);const[P,k]=l.useState(void 0),[E,z]=l.useState(()=>new Set(h.map(W=>W.id))),[D,L]=l.useState(!1);l.useEffect(()=>{M(w)},[w]),l.useEffect(()=>{z(new Set(h.map(W=>W.id)))},[h]);const V=l.useMemo(()=>{const W=["viewAddress","viewPublicKey"];return u?.trim()&&W.push("signMessage"),Ri(m)&&W.push("getMain"),W},[m,u]),_=l.useMemo(()=>new qf(rs,c),[c]),O=l.useMemo(()=>!!u?.trim(),[u]),G=l.useMemo(()=>Ri(m),[m]),Z=O||G;l.useEffect(()=>{let W=!1;async function ee(){j(null);try{const me=await rs.getCallerAppInfo(c);if(W)return;g(me)}catch{if(W)return;j(t("error.authFailed"))}}return ee(),()=>{W=!0}},[c,t]),l.useEffect(()=>{const W=window.setTimeout(()=>{(async()=>(await _.reject("timeout"),o.show({message:t("error.timeout"),position:"center"}),n({to:"/"})))()},my);return()=>{window.clearTimeout(W)}},[_,n,t,o]);const $=l.useMemo(()=>S?h.find(W=>W.id===S)??null:null,[S,h]),K=l.useMemo(()=>py(h,f,b),[b,f,h]),te=l.useMemo(()=>x?x.chainAddresses.map(W=>W.chain):[],[x]),re=l.useMemo(()=>{if(!(!x||!I))return x.chainAddresses.find(W=>W.chain===I)?.address},[x,I]);l.useEffect(()=>{i==="network"&&(I||T(K[0]?.chain))},[K,I,i]);const Y=l.useMemo(()=>h.length===0?!1:i==="main"?!!$:i==="network"?I?(K.find(W=>W.chain===I)?.addresses.length??0)>0:!1:E.size>0,[K,I,$,E.size,i,h.length]),X=l.useCallback(()=>{a()},[a]),ie=l.useCallback(async()=>{if(!N){y(!0);try{await _.reject("rejected"),n({to:"/"})}finally{y(!1)}}},[_,N,n]),le=l.useCallback(async()=>{if(!(!Y||N)){if(Z){Nt(async W=>{y(!0);try{const ee=u?.trim()??"";let me=[],ye=[];if(i==="main"){if(!$)return!1;me=_.handleMainAddresses($),ye=[$]}else if(i==="network"){if(!I)return!1;me=_.handleNetworkAddresses(h,I),ye=h}else{const he=h.filter(wt=>E.has(wt.id));me=_.handleAllAddresses(he),ye=he}return me=await _.applySensitiveOptions(me,ye,{password:W,signMessage:ee,getMain:G}),await _.approve(me),n({to:"/"}),!0}catch{return!1}finally{y(!1)}}),r("WalletLockConfirmJob",{title:t("passwordConfirm.title")});return}y(!0);try{let W=[];if(i==="main"){if(!$)return;W=_.handleMainAddresses($)}else if(i==="network"){if(!I)return;W=_.handleNetworkAddresses(h,I)}else{const ee=h.filter(me=>E.has(me.id));W=_.handleAllAddresses(ee)}await _.approve(W),n({to:"/"})}finally{y(!1)}}},[_,Y,N,n,Z,G,r,I,$,E,u,t,i,h]);return i==="network"&&d&&!A?e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(U,{title:t("title.address"),onBack:X}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-destructive",children:t("error.unknownChain")}),e.jsx("div",{className:"mt-4",children:e.jsx(q,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]}):v?e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(U,{title:t("title.address"),onBack:X}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-destructive",children:v}),e.jsx("div",{className:"mt-4",children:e.jsx(q,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]}):e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(U,{title:t("title.address"),onBack:X}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[p&&e.jsx(go,{appInfo:p}),e.jsx("div",{className:"px-1 text-sm text-foreground",children:t("address.shareWith")}),e.jsx(Lm,{permissions:V}),e.jsx("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:[i==="main"&&t("address.scope.main"),i==="network"&&t("address.scope.network",{chainName:(I?b[I]:void 0)??I??""}),i==="all"&&t("address.scope.all")]})}),e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[i==="main"&&e.jsx(zm,{wallets:C,...S?{selectedId:S}:{},onSelect:W=>M(W.id)}),i==="network"&&x&&I&&e.jsx("div",{className:"aspect-[1.6/1] w-full",children:e.jsx(Hi,{wallet:x,chain:I,chainName:b[I]??I,address:re,priority:"low",onOpenChainSelector:A?void 0:()=>L(!0)})}),i==="all"&&e.jsxs("div",{className:"space-y-2",children:[h.length===0&&e.jsx("div",{className:"py-6 text-center text-sm text-muted-foreground",children:t("address.noWallets")}),h.map(W=>{const ee=E.has(W.id);return e.jsxs("button",{type:"button",onClick:()=>{z(me=>{const ye=new Set(me);return ye.has(W.id)?ye.delete(W.id):ye.add(W.id),ye})},className:R("flex w-full items-center justify-between rounded-lg border px-3 py-2 text-left transition-colors","hover:bg-muted/50",ee?"border-primary bg-primary/5":"border-border bg-background"),"aria-pressed":ee,children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-medium",children:W.name}),e.jsx("div",{className:"truncate font-mono text-xs text-muted-foreground",children:W.address})]}),e.jsx("div",{className:R("flex size-5 items-center justify-center rounded border",ee?"border-primary bg-primary text-primary-foreground":"border-border bg-background"),"aria-hidden":"true",children:ee?"":""})]},W.id)})]})]})]}),e.jsx("div",{className:"sticky bottom-0 border-t border-border bg-background p-4 safe-area-inset-bottom",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(q,{type:"button",variant:"outline",className:"flex-1",onClick:ie,disabled:N,children:t("button.reject")}),e.jsx(q,{type:"button",className:"flex-1",onClick:le,disabled:!Y||N,children:t("button.approve")})]})}),D&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/50",onClick:()=>L(!1),children:e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-background rounded-t-2xl",onClick:W=>W.stopPropagation(),children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("address.selectNetwork")})}),e.jsx("div",{className:"max-h-[60vh] space-y-2 overflow-y-auto p-4",children:te.map(W=>{const ee=x?.chainAddresses.find(me=>me.chain===W);return e.jsxs("button",{onClick:()=>{T(W),L(!1)},className:R("flex w-full items-center gap-3 rounded-xl p-4 transition-colors",W===I?"bg-primary/10 ring-1 ring-primary":"bg-muted/50 hover:bg-muted"),children:[e.jsx(xt,{chain:W,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:b[W]??W}),e.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:ee?.address?hy(ee.address):"---"})]}),W===I&&e.jsx(xe,{className:"size-5 text-primary"})]},W)})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})]})}function hy(t,s=10,n=8){return t.length<=s+n+3?t:`${t.slice(0,s)}...${t.slice(-n)}`}vd.__docgenInfo={description:"",methods:[],displayName:"AddressAuthPage"};const yd=({params:t})=>e.jsx(ne,{children:e.jsx(ce,{params:t,children:e.jsx(vd,{})})});yd.__docgenInfo={description:"",methods:[],displayName:"AuthorizeAddressActivity"};const xy=300*1e3;function Li(t){return typeof t=="object"&&t!==null}function qe(t,s){const n=t[s];if(typeof n=="string")return n;if(typeof n=="number"&&Number.isFinite(n))return String(n)}function gy(t,s,n){const a=qe(t,s)?.trim();return a?{ok:!0,value:a}:{ok:!1,error:`signaturedata missing field: ${n}`}}function Ct(t,s){for(const n of s){const a=qe(t,n.key)?.trim();if(a)return{ok:!0,value:a}}return{ok:!1,error:`signaturedata missing field: ${s.map(n=>n.label).join(" / ")}`}}function vy(t){if(typeof t=="string"){const s=t.trim().toLowerCase();return s==="message"?{ok:!0,value:"message"}:s==="transfer"?{ok:!0,value:"transfer"}:s==="destroy"||s==="destory"?{ok:!0,value:"destory"}:{ok:!1,error:`Unsupported signature type: ${t}`}}return typeof t=="number"&&Number.isInteger(t)?t===0?{ok:!0,value:"message"}:t===1?{ok:!0,value:"transfer"}:t===7?{ok:!0,value:"destory"}:{ok:!1,error:`Unsupported signature type: ${t}`}:{ok:!1,error:"signaturedata.type must be string or number"}}function yy(t){if(t===void 0||t.trim()==="")return{ok:!1,error:"Missing signaturedata parameter"};let s;try{s=JSON.parse(t)}catch{return{ok:!1,error:"signaturedata is not valid JSON"}}if(!Array.isArray(s))return{ok:!1,error:"signaturedata must be a JSON array"};if(s.length===0)return{ok:!1,error:"signaturedata cannot be an empty array"};const n=s[0];if(!Li(n))return{ok:!1,error:"signaturedata[0] must be an object"};const a=vy(n.type);if(!a.ok)return a;const r=Ct(n,[{key:"chainName",label:"chainName"},{key:"chain",label:"chain"}]);if(!r.ok)return r;const o=r.value;if(a.value==="message"){const c=Ct(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!c.ok)return c;const i=gy(n,"message","message");return i.ok?{ok:!0,item:{type:"message",payload:{chainName:o,senderAddress:c.value,message:i.value}}}:i}if(a.value==="transfer"){const c=Ct(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!c.ok)return c;const i=Ct(n,[{key:"receiveAddress",label:"receiveAddress"},{key:"to",label:"to"}]);if(!i.ok)return i;const d=Ct(n,[{key:"balance",label:"balance"},{key:"amount",label:"amount"}]);if(!d.ok)return d;const u=qe(n,"fee")?.trim(),m=qe(n,"assetType")?.trim();let f;const h=n.contractInfo;if(Li(h)){const x=qe(h,"assetType")?.trim(),b=h.decimals,p=qe(h,"contractAddress")?.trim(),g=typeof b=="number"&&Number.isFinite(b)?b:typeof b=="string"&&b.trim()!==""?Number(b):void 0;x&&p&&typeof g=="number"&&Number.isFinite(g)&&(f={assetType:x,contractAddress:p,decimals:g})}return{ok:!0,item:{type:"transfer",payload:{chainName:o,senderAddress:c.value,receiveAddress:i.value,balance:d.value,...u?{fee:u}:{},...m?{assetType:m}:{},...f?{contractInfo:f}:{}}}}}{const c=Ct(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!c.ok)return c;const i=Ct(n,[{key:"destoryAmount",label:"destoryAmount"},{key:"amount",label:"amount"}]);if(!i.ok)return i;const d=qe(n,"destoryAddress")?.trim()??qe(n,"to")?.trim()??c.value,u=qe(n,"fee")?.trim(),m=qe(n,"assetType")?.trim();return{ok:!0,item:{type:"destory",payload:{chainName:o,senderAddress:c.value,destoryAddress:d,destoryAmount:i.value,...u?{fee:u}:{},...m?{assetType:m}:{}}}}}}function by(t){return typeof t=="object"&&t!==null&&"senderAddress"in t&&"receiveAddress"in t&&"balance"in t}function jy(t){return typeof t=="object"&&t!==null&&"senderAddress"in t&&"message"in t&&!("receiveAddress"in t)}function Ny(t){return typeof t=="object"&&t!==null&&"senderAddress"in t&&"destoryAddress"in t&&"destoryAmount"in t}function zi(t){return t.contractInfo?.assetType?t.contractInfo.assetType.toUpperCase():t.assetType?t.assetType.toUpperCase():{ethereum:"ETH",bitcoin:"BTC",tron:"TRX",binance:"BNB",bsc:"BNB"}[t.chainName?.toLowerCase()??""]??"TOKEN"}function wy(t,s,n){const a=parseFloat(t)||0,r=parseFloat(s)||0,o=parseFloat(n??"0")||0,c=r+o;return{sufficient:a>=c,required:c.toString()}}function bd(){const{t}=B("authorize"),{t:s}=B("common"),{navigate:n,goBack:a}=ae(),{push:r}=Q(),o=at(),{id:c,signaturedata:i}=ue(),d=we(ke,Bs.getCurrentWallet),[u,m]=l.useState(null),[f,h]=l.useState(null),[x,b]=l.useState(null),[p,g]=l.useState(!1),v=l.useMemo(()=>new Wa(rs,c),[c]);l.useEffect(()=>{let T=!1;async function P(){b(null);try{const k=yy(i);if(!k.ok){b(k.error);return}const E=await rs.getCallerAppInfo(c);if(T)return;m(E);const z={eventId:c,type:k.item.type,payload:k.item.payload,appName:E.appName,appHome:E.origin,appLogo:E.appIcon};h(z)}catch{if(T)return;b(t("error.authFailed"))}}return P(),()=>{T=!0}},[c,i,t]),l.useEffect(()=>{const T=window.setTimeout(()=>{(async()=>(await v.reject("timeout"),o.show({message:t("error.timeout"),position:"center"}),n({to:"/"})))()},xy);return()=>{window.clearTimeout(T)}},[v,n,t,o]);const j=l.useMemo(()=>!f||!by(f.payload)?null:f.payload,[f]),N=l.useMemo(()=>!f||!jy(f.payload)?null:f.payload,[f]),y=l.useMemo(()=>!f||!Ny(f.payload)?null:f.payload,[f]),C=l.useMemo(()=>{if(!d)return{sufficient:!0,required:"0",walletBalance:"0"};const T=j?{chainName:j.chainName,amount:j.balance,fee:j.fee}:y?{chainName:y.chainName,amount:y.destoryAmount,fee:y.fee}:null;if(!T)return{sufficient:!0,required:"0",walletBalance:"0"};const k=d.chainAddresses.find(z=>z.chain.toLowerCase()===T.chainName?.toLowerCase())?"1.0":"0";return{...wy(k,T.amount,T.fee),walletBalance:k}},[d,y,j]),w=l.useMemo(()=>j?zi(j):y?zi(y):"TOKEN",[y,j]),S=l.useCallback(()=>{a()},[a]),M=l.useCallback(async()=>{if(!p){g(!0);try{await v.reject(C.sufficient?"rejected":"insufficient_balance"),n({to:"/"})}finally{g(!1)}}},[v,C.sufficient,p,n]),A=l.useCallback(()=>{C.sufficient&&(p||(Nt(async T=>{g(!0);try{const P=d?.encryptedMnemonic;if(!P||!f)return!1;let k="";if(f.type==="message"){if(!N)return!1;const E=await v.handleMessageSign(N,P,T);k=typeof E=="string"?E:E.signature??""}else if(f.type==="transfer"){if(!j)return!1;const E=await v.handleTransferSign(j,P,T);k=typeof E=="string"?E:E.signature??""}else if(f.type==="destory"){if(!y)return!1;const E=await v.handleDestroySign(y,P,T);k=typeof E=="string"?E:E.signature??""}else return!1;return await v.approve(k),n({to:"/"}),!0}catch{return!1}finally{g(!1)}}),r("WalletLockConfirmJob",{title:t("button.confirm")})))},[v,C.sufficient,d?.encryptedMnemonic,y,p,N,n,r,f,t,j]);if(x)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("title.signature"),onBack:S}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsx("p",{className:"text-destructive text-sm",children:x}),e.jsx("div",{className:"mt-4",children:e.jsx(q,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]});const I=f?.type==="message"?t("signature.type.message"):f?.type==="destory"?t("signature.type.destroy"):t("title.signature");return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:I,onBack:S}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[u&&e.jsx(go,{appInfo:u}),e.jsx("div",{className:"text-foreground px-1 text-sm",children:t("signature.reviewTransaction")}),j&&e.jsxs(e.Fragment,{children:[e.jsx(Sr,{from:j.senderAddress,to:j.receiveAddress,amount:`${j.balance} ${w}`,...j.fee?{fee:`${j.fee} ${w}`}:{},chainId:j.chainName}),!C.sufficient&&e.jsx(Ar,{balance:C.walletBalance,required:C.required,symbol:w})]}),N&&e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-sm",children:t("signature.messageToSign")}),e.jsx("div",{className:R("bg-muted/50 rounded-lg p-3","font-mono text-sm break-all whitespace-pre-wrap","max-h-48 overflow-y-auto"),children:N.message})]}),y&&e.jsxs(e.Fragment,{children:[e.jsx(Sr,{from:y.senderAddress,to:y.destoryAddress,amount:`${y.destoryAmount} ${w}`,...y.fee?{fee:`${y.fee} ${w}`}:{},chainId:y.chainName}),!C.sufficient&&e.jsx(Ar,{balance:C.walletBalance,required:C.required,symbol:w})]}),f&&e.jsx("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:e.jsxs("div",{className:"text-muted-foreground text-sm",children:[f.type==="transfer"&&t("signature.type.transfer"),f.type==="message"&&t("signature.type.message"),f.type==="destory"&&t("signature.type.destroy")]})})]}),e.jsx("div",{className:"border-border bg-background safe-area-inset-bottom sticky bottom-0 border-t p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(q,{type:"button",variant:"outline",className:"flex-1",onClick:M,disabled:p,children:t("button.reject")}),e.jsx(q,{type:"button",className:"flex-1",onClick:A,disabled:p||!C.sufficient,children:t("button.confirm")})]})})]})}bd.__docgenInfo={description:"",methods:[],displayName:"SignatureAuthPage"};const jd=({params:t})=>e.jsx(ne,{children:e.jsx(ce,{params:t,children:e.jsx(bd,{})})});jd.__docgenInfo={description:"",methods:[],displayName:"AuthorizeSignatureActivity"};function Nd({walletName:t,onEnterWallet:s,className:n}){const{t:a}=B("onboarding");return e.jsxs("div",{"data-testid":"import-success-step",className:R("flex min-h-screen flex-col items-center justify-center px-6 py-8",n),children:[e.jsx("div",{className:"mb-6 flex size-20 items-center justify-center rounded-full bg-green-100 dark:bg-green-900/30",children:e.jsx(us,{className:"size-10 text-green-600 dark:text-green-400"})}),e.jsx("h1",{"data-testid":"success-message",className:"mb-2 text-2xl font-bold",children:a("import.success.title")}),e.jsx("p",{className:"text-muted-foreground mb-8 text-center",children:e.jsx(ho,{i18nKey:"import.success.description",ns:"onboarding",values:{name:t},components:{bold:e.jsx("span",{className:"text-foreground font-medium"})}})}),e.jsx("div",{className:"w-full max-w-xs",children:e.jsxs("button",{type:"button","data-testid":"enter-wallet-button",onClick:s,className:R("flex w-full items-center justify-center gap-2 rounded-full py-3 font-medium transition-colors","bg-primary hover:bg-primary/90 text-primary-foreground"),children:[e.jsx("span",{children:a("import.success.enterWallet")}),e.jsx(Te,{className:"size-5"})]})})]})}Nd.__docgenInfo={description:"Success screen shown after wallet import",methods:[],displayName:"ImportWalletSuccess",props:{walletName:{required:!0,tsType:{name:"string"},description:"Wallet name"},onEnterWallet:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback when user chooses to enter wallet"},className:{required:!1,tsType:{name:"string"},description:"Additional class name"}}};ve.t.bind(ve);function ky(t){if(!Vi(t))throw new Error("Invalid mnemonic");return Mu(t.join(" "))}function Cy(t){return new Set(t.map(s=>s.address.toLowerCase()))}const Sy=ve.t.bind(ve),na={isDuplicate:!1,type:"none"};function Ay(t){const[s,n]=l.useState(na),[a,r]=l.useState(!1),[o,c]=l.useState(null),i=l.useCallback(async u=>{r(!0),c(null);try{const m=ky(u),f=Cy(m),h=await t.getAllAddresses();for(const g of h)if(f.has(g.address.toLowerCase())){const v={isDuplicate:!0,type:"address",matchedWallet:{id:g.walletId,name:g.walletName,importType:"mnemonic",matchedAddress:g.address}};return n(v),v}const b=(await t.getAllMainWallets()).filter(g=>g.importType==="privateKey");for(const g of b)for(const v of g.addresses)if(f.has(v.address.toLowerCase())){const j={isDuplicate:!0,type:"privateKey",matchedWallet:{id:g.id,name:g.name,importType:"privateKey",matchedAddress:v.address}};return n(j),j}const p={isDuplicate:!1,type:"none"};return n(p),p}catch(m){const f=m instanceof Error?m.message:Sy("error:duplicate.detectionFailed");return c(f),na}finally{r(!1)}},[t]),d=l.useCallback(()=>{n(na),c(null)},[]);return{result:s,isChecking:a,error:o,check:i,reset:d}}const Iy={getAllAddresses:async()=>[],getAllMainWallets:async()=>[],findWalletByAddress:async()=>null};function wd(){const{navigate:t,goBack:s}=ae(),{push:n}=Q(),{t:a}=B(["onboarding","common","wallet"]),r=Os(),o=st().snapshot,c=hu(),i=Ft(),[d,u]=l.useState("keyType"),[m,f]=l.useState("mnemonic"),[h,x]=l.useState(!1),[b,p]=l.useState([]),[g,v]=l.useState(""),[j,N]=l.useState(null),[y,C]=l.useState([]),[w,S]=l.useState(!1),[M,A]=l.useState(""),[I,T]=l.useState(null),[P,k]=l.useState([]),[E,z]=l.useState(!1);l.useEffect(()=>{!E&&r.length>0&&(k(lo(r)),z(!0))},[r,E]);const D=Ay(Iy),L=(()=>{switch(d){case"keyType":return 1;case"mnemonic":case"arbitrary":return 2;case"collision":return 2;case"pattern":return 3;case"chains":return 4;case"theme":return 5;case"success":return 5;default:return 1}})(),V=l.useCallback(()=>{switch(d){case"keyType":s();break;case"mnemonic":case"arbitrary":u("keyType"),D.reset();break;case"collision":u("mnemonic"),D.reset();break;case"pattern":u(m==="arbitrary"?"arbitrary":"mnemonic");break;case"chains":u("pattern");break;case"theme":u("chains");break}},[d,s,D,m]),_=l.useCallback(()=>{u("pattern")},[]),O=l.useCallback(le=>{A(le),u("chains")},[]),G=l.useCallback(()=>{if(m==="mnemonic"){u("mnemonic");return}if(h){u("arbitrary");return}ov(()=>{x(!0),u("arbitrary")}),n("SecurityWarningJob",{})},[m,h,n]),Z=l.useCallback(async le=>{p(le.mnemonic);const W=await D.check(le.mnemonic);if(W.isDuplicate){if(W.type==="address")return;if(W.type==="privateKey"){u("collision");return}}_()},[D,_]),$=l.useCallback(async()=>{_()},[_]),K=l.useCallback(()=>{u("mnemonic"),D.reset()},[D]),te=l.useCallback(async(le,W)=>{S(!0);try{const ee=le.join(" "),ye=(await uo({mnemonic:ee,selectedChainIds:P,chainConfigs:r})).map(({chainId:eu,address:tu,publicKey:su})=>({chain:eu,address:tu,publicKey:su??"",tokens:[]})),he=ye[0];if(!he)throw new Error("No chain addresses derived");const wt=ra(he.address),Zd=await pe.createWallet({name:a("onboarding:create.generatedNamePattern",{word:gn(i),suffix:a("onboarding:create.walletSuffix")}),keyType:"mnemonic",address:he.address,chain:he.chain,chainAddresses:ye,themeHue:wt},ee,W,wt);T(Zd.id),u("theme")}catch{}finally{S(!1)}},[r,P,a]),re=l.useCallback(async le=>{const W=g.trim();if(W&&y.length!==0){S(!0);try{const ee=y[0];if(!ee)throw new Error("No enabled bioforest chains");const me=ra(ee.address),ye=y.map(wt=>({chain:wt.chainId,address:wt.address,publicKey:"",tokens:[]})),he=await pe.createWallet({name:a("onboarding:create.generatedNamePattern",{word:gn(i),suffix:a("onboarding:create.walletSuffix")}),keyType:"arbitrary",address:ee.address,chain:ee.chainId,chainAddresses:ye,themeHue:me},W,le,me);T(he.id),u("theme")}catch{}finally{S(!1)}}},[y,g,a]),Y=l.useCallback(()=>{t({to:"/",replace:!0})},[t]),X=l.useCallback(async()=>{if(!w){if(m==="arbitrary"){await re(M);return}b.length!==0&&await te(b,M)}},[re,te,w,m,b,M]),ie=l.useCallback(()=>{t({to:"/"})},[t]);return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[d==="keyType"&&e.jsxs(e.Fragment,{children:[e.jsx(U,{title:a("onboarding:keyType.title"),onBack:V}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(ct,{total:5,current:L})}),e.jsxs("div",{"data-testid":"key-type-step",className:"flex-1 space-y-6 p-4",children:[e.jsx(Dm,{value:m,onChange:le=>{f(le),le==="mnemonic"&&(v(""),C([]))}}),e.jsx(q,{type:"button","data-testid":"continue-button",onClick:G,className:"w-full",children:a("common:continue")})]})]}),d==="mnemonic"&&e.jsxs(e.Fragment,{children:[e.jsx(U,{title:a("onboarding:recover.title"),onBack:V}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(ct,{total:5,current:L})}),e.jsx("div",{"data-testid":"mnemonic-step",className:"flex-1 p-4",children:e.jsx(ju,{onSubmit:Z,isSubmitting:D.isChecking})})]}),d==="arbitrary"&&e.jsxs(e.Fragment,{children:[e.jsx(U,{title:a("onboarding:keyType.arbitrary"),onBack:V}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(ct,{total:5,current:L})}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx(Bm,{value:g,onChange:le=>{N(null),v(le)},disabled:w}),j&&e.jsxs("div",{className:"bg-destructive/10 text-destructive flex items-start gap-2 rounded-lg px-3 py-2 text-sm",children:[e.jsx(vt,{className:"mt-0.5 size-4 shrink-0"}),e.jsx("span",{children:j})]}),e.jsx(Om,{secret:g,enabledBioforestChainConfigs:o?c:void 0,onDerived:C}),e.jsxs(q,{type:"button",className:"w-full",disabled:w||g.trim()!==""&&y.length===0,onClick:()=>{if(!g.trim()){N(a("onboarding:arbitraryKey.required"));return}_()},children:[w&&e.jsx(Ce,{className:"size-4 animate-spin"}),a("common:continue")]})]})]}),d==="collision"&&e.jsxs(e.Fragment,{children:[e.jsx(U,{title:a("onboarding:recover.addressConflict"),onBack:V}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(ct,{total:5,current:L})}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(Wm,{result:D.result,onConfirm:$,onCancel:K,isLoading:w})})]}),d==="pattern"&&e.jsxs(e.Fragment,{children:[e.jsx(U,{title:a("onboarding:recover.setWalletLock"),onBack:V}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(ct,{total:5,current:L})}),e.jsx("div",{"data-testid":"pattern-step",className:"flex-1 p-4",children:e.jsx(za,{onComplete:O,minPoints:4})})]}),d==="chains"&&e.jsxs(e.Fragment,{children:[e.jsx(U,{title:a("onboarding:chainSelector.title"),onBack:V}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(ct,{total:5,current:L})}),e.jsx("div",{"data-testid":"chains-step",className:"flex-1 p-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Fs,{icon:e.jsx(us,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:a("onboarding:chainSelector.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:a("onboarding:chainSelector.subtitle")})]}),r.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(Se,{})}):e.jsx(Da,{"data-testid":"chain-selector",chains:r,selectedChains:P,onSelectionChange:k}),e.jsx(ze,{variant:"mint",className:"w-full","data-testid":"chains-continue-button",disabled:P.length===0,onClick:X,children:a("common:next")})]})})]}),d==="theme"&&I&&e.jsxs(e.Fragment,{children:[e.jsx(U,{title:a("onboarding:create.themeTitle")}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(ct,{total:5,current:L})}),e.jsx("div",{"data-testid":"theme-step",className:"flex-1 p-4",children:e.jsx(Fn,{mode:"edit-only",walletId:I,onEditOnlyComplete:Y})})]}),d==="success"&&e.jsx(Nd,{walletName:a("wallet:defaultName"),onEnterWallet:ie})]})}wd.__docgenInfo={description:`Onboarding recover wallet page
Implements wallet recovery with duplicate detection per openspec/changes/add-wallet-recover-duplicate-guards`,methods:[],displayName:"OnboardingRecoverPage"};const kd=()=>e.jsx(ne,{children:e.jsx(wd,{})});kd.__docgenInfo={description:"",methods:[],displayName:"OnboardingRecoverActivity"};const rn={symbol:"USDT",balance:1234.56,fiatValue:"1234.56"},Ty=[{id:"1",type:"send",status:"confirmed",amount:se.fromFormatted("100",6,"USDT"),symbol:"USDT",address:"0xabcd...1234",timestamp:new Date(Date.now()-36e5)},{id:"2",type:"receive",status:"confirmed",amount:se.fromFormatted("500",6,"USDT"),symbol:"USDT",address:"0x1234...abcd",timestamp:new Date(Date.now()-864e5)}];function Cd(){const{t}=B("token"),{navigate:s,goBack:n}=ae();return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(U,{title:rn.symbol,onBack:n}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsx("div",{className:"text-center",children:e.jsx(Pm,{value:rn.balance,symbol:rn.symbol,fiatValue:rn.fiatValue,size:"lg"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(ze,{variant:"mint",className:"flex-1",onClick:()=>s({to:"/send",search:{address:void 0,chain:void 0,amount:void 0}}),children:[e.jsx(Wu,{className:"mr-2 size-4"}),t("detail.send")]}),e.jsxs(ze,{variant:"blue",className:"flex-1",onClick:()=>s({to:"/receive"}),children:[e.jsx(Dn,{className:"mr-2 size-4"}),t("detail.receive")]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold",children:t("detail.transactionHistory")}),e.jsx(xo,{transactions:Ty,emptyTitle:t("detail.noTransactions"),emptyDescription:t("detail.noTransactionsDesc")})]})]})]})}Cd.__docgenInfo={description:"",methods:[],displayName:"TokenDetailPage"};const Sd=({params:t})=>e.jsx(ne,{children:e.jsx(ce,{params:t,children:e.jsx(Cd,{})})});Sd.__docgenInfo={description:"",methods:[],displayName:"TokenDetailActivity"};function Ad(){const{t}=B("common"),{goBack:s}=ae(),{push:n}=Q(),r=we(Cs).contacts,o=we(ke,Bs.getCurrentWallet),[c,i]=l.useState(""),d=l.useRef(null),u=l.useMemo(()=>c.trim()?ja.searchContacts(Cs.state,c.trim()):r,[r,c]),m=l.useCallback(()=>{s()},[s]),f=l.useCallback(()=>{n("ContactEditJob",{})},[n]),h=l.useCallback(p=>{n("ContactEditJob",{contactId:p.id})},[n]),x=l.useCallback(p=>{n("ContactShareJob",{name:p.name,addresses:JSON.stringify(p.addresses.map(g=>({address:g.address,label:g.label}))),memo:p.memo,avatar:p.avatar})},[n]),b=l.useCallback(p=>{d.current=p,o?.encryptedMnemonic?(Nt(async g=>{try{return await Mt(o.encryptedMnemonic,g)?(Ss.deleteContact(p.id),d.current=null,!0):!1}catch{return!1}}),n("WalletLockConfirmJob",{title:t("addressBook.deleteTitle"),description:t("addressBook.deleteConfirm",{name:p.name})})):(Ss.deleteContact(p.id),d.current=null)},[o?.encryptedMnemonic,n,t]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("addressBook.title"),onBack:m,rightAction:e.jsx("button",{onClick:f,className:R("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":t("a11y.addContact"),"data-testid":"address-book-add-button",children:e.jsx(nt,{className:"size-5"})})}),e.jsx("div",{className:"px-4 py-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(qs,{className:"text-muted-foreground absolute top-1/2 left-3 size-4 -translate-y-1/2"}),e.jsx("input",{type:"text",value:c,onChange:p=>i(p.target.value),placeholder:t("addressBook.searchPlaceholder"),className:R("border-border bg-background w-full rounded-xl border py-2.5 pr-4 pl-10","focus:ring-primary focus:ring-2 focus:outline-none")})]})}),e.jsx("div",{className:"flex-1 p-4",children:u.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[e.jsx(rm,{className:"text-muted-foreground/50 size-12"}),e.jsx("p",{className:"text-muted-foreground",children:t(c?"addressBook.noResults":"addressBook.noContacts")}),!c&&e.jsx("button",{onClick:f,className:R("bg-primary rounded-full px-6 py-2.5 text-sm font-medium text-primary-foreground","hover:bg-primary/90 active:bg-primary/80"),children:t("contact.addTitle")})]}):e.jsx("div",{className:"space-y-2",children:u.map(p=>e.jsx(Py,{contact:p,onShare:()=>x(p),onEdit:()=>h(p),onDelete:()=>b(p)},p.id))})})]})}function Py({contact:t,onEdit:s,onDelete:n,onShare:a}){const{t:r}=B("common"),[o,c]=l.useState(!1);return e.jsx("div",{className:R("bg-card rounded-xl p-4 shadow-sm","transition-colors"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ds,{src:t.avatar||(t.addresses[0]?.address?Rt(t.addresses[0].address):void 0),size:40}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"truncate font-medium",children:t.name}),t.addresses.length>0&&e.jsxs("p",{className:"text-muted-foreground truncate font-mono text-xs",children:[t.addresses[0]?.address,t.addresses.length>1&&` (+${t.addresses.length-1})`]}),t.memo&&e.jsx("p",{className:"text-muted-foreground mt-1 truncate text-xs",children:t.memo})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>c(!o),className:R("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":r("a11y.moreActions"),children:e.jsx(Fm,{className:"text-muted-foreground size-4"})}),o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>c(!1)}),e.jsxs("div",{className:"bg-popover border-border absolute top-full right-0 z-20 mt-1 w-32 rounded-lg border py-1 shadow-lg",children:[e.jsx("button",{onClick:()=>{c(!1),a()},className:"hover:bg-muted w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.shareContact")}),e.jsx("button",{onClick:()=>{c(!1),s()},className:"hover:bg-muted w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.edit")}),e.jsx("button",{onClick:()=>{c(!1),n()},className:"text-destructive hover:bg-destructive/10 w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.delete")})]})]})]})]})})}Ad.__docgenInfo={description:"",methods:[],displayName:"AddressBookPage"};const Id=()=>e.jsx(ne,{children:e.jsx(Ad,{})});Id.__docgenInfo={description:"",methods:[],displayName:"AddressBookActivity"};function Td({open:t,onOpenChange:s}){const{t:n}=B("common"),a=yt(),r=ka(),o=cu(),c=lu(),i=$t(),d=l.useCallback(u=>{!o.includes(u)&&!c||Xt.toggleWalletSelection(u)},[o,c]);return e.jsx(ut,{open:t,onOpenChange:s,children:e.jsxs(mt,{side:"bottom",className:"rounded-t-2xl",children:[e.jsx(ft,{className:"pb-4",children:e.jsx(pt,{children:n("myCard.selectWallets")})}),e.jsxs("div",{className:"max-h-[50vh] overflow-y-auto pb-[env(safe-area-inset-bottom)]",children:[a.map(u=>{const m=r[u.id]||u.chain,f=u.chainAddresses.find(b=>b.chain===m),h=o.includes(u.id),x=!h&&!c;return e.jsxs("button",{type:"button",onClick:()=>d(u.id),disabled:x,className:R("flex w-full items-center gap-3 rounded-lg p-3 text-left transition-colors",h&&"bg-primary/10",!x&&"hover:bg-muted",x&&"cursor-not-allowed opacity-50"),children:[e.jsx(xt,{chain:m,size:"md"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium",children:u.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{children:i[m]||m}),e.jsxs("span",{className:"truncate font-mono text-xs",children:[f?.address.slice(0,8),"...",f?.address.slice(-6)]})]})]}),h&&e.jsx("div",{className:"flex size-6 items-center justify-center rounded-full bg-primary",children:e.jsx(xe,{className:"size-4 text-primary-foreground"})})]},u.id)}),a.length===0&&e.jsx("div",{className:"py-8 text-center text-muted-foreground",children:n("noAssets")})]}),e.jsx("p",{className:"py-4 text-center text-xs text-muted-foreground",children:n("myCard.maxWallets",{max:3})})]})})}Td.__docgenInfo={description:"",methods:[],displayName:"WalletPickerSheet",props:{open:{required:!0,tsType:{name:"boolean"},description:""},onOpenChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(open: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"open"}],return:{name:"void"}}},description:""}}};function Ey(t,s){const[n,a]=l.useState(!1),{filename:r,shareTitle:o,shareText:c}=s,i=l.useCallback(async()=>{const u=t.current;if(!(!u||n)){a(!0);try{const{snapdom:m}=await ht(async()=>{const{snapdom:f}=await import("./snapdom-CO8q8LPW.js").then(h=>h.s);return{snapdom:f}},__vite__mapDeps([0,1]),import.meta.url);await m.download(u,{type:"png",filename:`${r}.png`,scale:2,quality:1})}catch(m){console.error("Download failed:",m)}finally{a(!1)}}},[t,r,n]),d=l.useCallback(async()=>{const u=t.current;if(!(!u||!navigator.share||n)){a(!0);try{const{snapdom:m}=await ht(async()=>{const{snapdom:b}=await import("./snapdom-CO8q8LPW.js").then(p=>p.s);return{snapdom:b}},__vite__mapDeps([0,1]),import.meta.url),h=await(await m(u,{scale:2})).toBlob(),x=new File([h],`${r}.png`,{type:"image/png"});await navigator.share({title:o,text:c,files:[x]})}catch{}finally{a(!1)}}},[t,r,o,c,n]);return{isProcessing:n,download:i,share:d,canShare:typeof navigator<"u"&&"share"in navigator}}function Pd(){const{t}=B(["common","settings"]),{goBack:s}=ae(),n=l.useRef(null),a=l.useRef(null),r=Na(),o=yt(),c=ka(),i=$t(),[d,u]=l.useState(!1),[m,f]=l.useState(r.username),[h,x]=l.useState(!1);l.useEffect(()=>{if(!r.avatar&&o.length>0){const A=o[0]?.chainAddresses[0]?.address;A&&Xt.initializeDefaultAvatar(A)}},[r.avatar,o]),l.useEffect(()=>{if(r.selectedWalletIds.length===0&&o.length>0){const A=o[0];A&&Xt.toggleWalletSelection(A.id)}},[r.selectedWalletIds,o]);const b=l.useMemo(()=>r.selectedWalletIds.map(A=>o.find(I=>I.id===A)).filter(A=>!!A).map(A=>{const I=c[A.id]||A.chain,T=A.chainAddresses.find(P=>P.chain===I);return{wallet:A,chain:I,address:T?.address}}).filter(A=>A.address),[r.selectedWalletIds,o,c]),p=l.useMemo(()=>b.filter(A=>!!A.address).map(({wallet:A,address:I})=>({address:I,label:A.name})),[b]),g=l.useMemo(()=>p.length===0?"":_a({name:r.username||t("myCard.defaultName"),addresses:p,avatar:r.avatar}),[r.username,r.avatar,p,t]),v=l.useCallback(()=>{Xt.randomizeAvatar()},[]),j=l.useCallback(()=>{f(r.username),u(!0)},[r.username]),N=l.useCallback(()=>{Xt.setUsername(m),u(!1)},[m]),y=l.useCallback(A=>{A.key==="Enter"?N():A.key==="Escape"&&u(!1)},[N]);l.useEffect(()=>{d&&n.current?.focus()},[d]);const{isProcessing:C,download:w,share:S}=Ey(a,{filename:`my-card-${Date.now()}`,shareTitle:t("myCard.title"),shareText:r.username||t("myCard.defaultName")}),M=r.username||t("myCard.defaultName");return e.jsxs("div",{className:"flex min-h-screen flex-col bg-background",children:[e.jsx(U,{title:t("myCard.title"),onBack:s}),e.jsxs("div",{className:"flex flex-1 flex-col items-center p-6",children:[e.jsxs("button",{type:"button",onClick:v,className:"group relative mb-4 cursor-pointer transition-transform hover:scale-105","aria-label":t("myCard.changeAvatar"),children:[e.jsx(ds,{src:r.avatar,size:80}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center rounded-full bg-black/50 opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx("span",{className:"text-xs text-white",children:t("myCard.changeAvatar")})})]}),d?e.jsx("div",{className:"mb-6 flex items-center gap-2",children:e.jsx(De,{ref:n,value:m,onChange:A=>f(A.target.value),onBlur:N,onKeyDown:y,placeholder:t("myCard.usernamePlaceholder"),className:"w-48 text-center"})}):e.jsxs("button",{type:"button",onClick:j,className:"group mb-6 flex items-center gap-2 text-xl font-semibold",children:[e.jsx("span",{children:M}),e.jsx($m,{className:"size-4 text-muted-foreground opacity-50 group-hover:opacity-100"})]}),p.length>0?e.jsx("div",{ref:a,className:"mb-6",children:e.jsx(Ra,{name:M,avatar:r.avatar,addresses:p,qrContent:g})}):e.jsx("div",{className:"mb-6 flex h-[300px] w-[320px] items-center justify-center rounded-3xl bg-muted",children:e.jsx("p",{className:"text-muted-foreground",children:t("myCard.noWalletsSelected")})}),e.jsxs("div",{className:"mb-6 w-full max-w-[320px]",children:[e.jsx("h3",{className:"mb-2 text-sm font-medium text-muted-foreground",children:t("myCard.selectWallets")}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[b.map(({wallet:A,chain:I})=>{const{c0:T}=bm(A.themeHue);return e.jsxs("div",{className:"flex items-center gap-1.5 rounded-full px-3 py-1.5 text-sm font-medium",style:{backgroundColor:T,color:"#FFFFFF"},children:[e.jsx("span",{children:A.name}),e.jsx("span",{style:{opacity:.8},children:t("myCard.chainLabel",{chain:i[I]||I})}),e.jsx("button",{type:"button",onClick:()=>Xt.toggleWalletSelection(A.id),className:"ml-0.5 rounded-full p-0.5 transition-colors hover:bg-white/20","aria-label":t("myCard.removeWallet",{name:A.name}),children:e.jsx(Us,{className:"size-3"})})]},A.id)}),r.selectedWalletIds.length<3&&e.jsxs("button",{type:"button",onClick:()=>x(!0),className:"flex items-center gap-1 rounded-full border border-dashed border-muted-foreground/50 px-3 py-1 text-sm text-muted-foreground hover:border-primary hover:text-primary",children:[e.jsx(nt,{className:"size-3"}),t("myCard.addWallet")]})]}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:t("myCard.maxWallets",{max:3})})]}),e.jsxs("div",{className:"flex w-full max-w-[320px] gap-3",children:[e.jsxs(q,{variant:"outline",onClick:w,disabled:C||p.length===0,className:"flex-1",children:[C?e.jsx(Ce,{className:"mr-2 size-4 animate-spin"}):e.jsx(Hs,{className:"mr-2 size-4"}),t("download")]}),"share"in navigator&&e.jsxs(q,{onClick:S,disabled:C||p.length===0,className:"flex-1",children:[C?e.jsx(Ce,{className:"mr-2 size-4 animate-spin"}):e.jsx(Ms,{className:"mr-2 size-4"}),t("share")]})]}),e.jsx("p",{className:"mt-6 text-center text-sm text-muted-foreground",children:t("myCard.scanToAdd")})]}),e.jsx(Td,{open:h,onOpenChange:x})]})}Pd.__docgenInfo={description:"",methods:[],displayName:"MyCardPage"};const Ed=()=>e.jsx(ne,{children:e.jsx(Pd,{})});Ed.__docgenInfo={description:"",methods:[],displayName:"MyCardActivity"};const _y={transaction:{icon:"",bg:"bg-blue-100 dark:bg-blue-900/30"},security:{icon:"",bg:"bg-red-100 dark:bg-red-900/30"},system:{icon:"",bg:"bg-gray-100 dark:bg-gray-800/30"}};function My(){const{t}=B("notification"),s=Ft();return l.useCallback(n=>{const r=Date.now()-n,o=Math.floor(r/6e4),c=Math.floor(r/36e5),i=Math.floor(r/864e5);return o<1?t("time.justNow"):o<60?t("time.minutesAgo",{count:o}):c<24?t("time.hoursAgo",{count:c}):i<7?t("time.daysAgo",{count:i}):new Date(n).toLocaleDateString(s)},[t,s])}function Ry({notification:t,onRead:s,onRemove:n,onNavigate:a,formatRelativeTime:r,t:o}){const c=_y[t.type],i=t.type==="transaction"&&!!t.data?.pendingTxId,d=l.useCallback(()=>{t.read||s(t.id),i&&a&&a(t)},[t,s,a,i]);return e.jsxs("div",{onClick:d,className:R("flex cursor-pointer items-start gap-3 rounded-xl p-4 transition-colors",t.read?"bg-muted/30":"bg-card shadow-sm"),children:[e.jsx("div",{className:R("flex size-10 shrink-0 items-center justify-center rounded-full",c.bg),children:e.jsx("span",{className:"text-lg",children:c.icon})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h4",{className:R("font-medium",t.read&&"text-muted-foreground"),children:t.title}),e.jsx("span",{className:"text-muted-foreground shrink-0 text-xs",children:r(t.timestamp)})]}),e.jsx("p",{className:R("mt-1 text-sm",t.read?"text-muted-foreground":"text-foreground/80"),children:t.message}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[!t.read&&e.jsx("div",{className:"bg-primary flex size-2 rounded-full","aria-label":o("unread")}),i&&e.jsxs("span",{className:"text-primary flex items-center gap-0.5 text-xs",children:[o("viewDetails"),e.jsx(Te,{className:"size-3"})]})]})]}),e.jsx("button",{onClick:u=>{u.stopPropagation(),n(t.id)},className:"text-muted-foreground hover:text-destructive shrink-0 p-1","aria-label":o("delete"),children:e.jsx(qt,{className:"size-4"})})]})}function Ly({notifications:t,onRead:s,onRemove:n,onNavigate:a,formatRelativeTime:r,t:o,language:c}){const i=l.useMemo(()=>{const d=new Map,u=new Date().toLocaleDateString(c),m=new Date(Date.now()-864e5).toLocaleDateString(c);for(const f of t){const h=new Date(f.timestamp).toLocaleDateString(c);let x=h;h===u?x=o("time.today"):h===m&&(x=o("time.yesterday"));const b=d.get(x)||[];d.set(x,[...b,f])}return d},[t,c,o]);return t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx("div",{className:"bg-muted mb-4 flex size-16 items-center justify-center rounded-full",children:e.jsx(qm,{className:"text-muted-foreground size-8"})}),e.jsx("h3",{className:"text-lg font-medium",children:o("empty.title")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:o("empty.desc")})]}):e.jsx("div",{className:"space-y-6",children:Array.from(i.entries()).map(([d,u])=>e.jsxs("div",{children:[e.jsx("h3",{className:"text-muted-foreground mb-2 text-sm font-medium",children:d}),e.jsx("div",{className:"space-y-2",children:u.map(m=>e.jsx(Ry,{notification:m,onRead:s,onRemove:n,onNavigate:a,formatRelativeTime:r,t:o},m.id))})]},d))})}function _d(){const{t}=B("notification"),s=Ft(),n=My(),{goBack:a,navigate:r}=ae(),o=we(Ru);l.useEffect(()=>{o.isInitialized||ms.initialize()},[o.isInitialized]);const c=l.useCallback(f=>{ms.markRead(f)},[]),i=l.useCallback(f=>{ms.remove(f)},[]),d=l.useCallback(()=>{ms.markAllRead()},[]),u=l.useCallback(()=>{ms.clearAll()},[]),m=l.useCallback(f=>{f.type==="transaction"&&f.data?.pendingTxId&&r({to:`/pending-tx/${f.data.pendingTxId}`})},[r]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("title"),onBack:a,rightAction:o.unreadCount>0?e.jsxs("button",{onClick:d,className:"text-primary hover:bg-primary/10 flex items-center gap-1 rounded-full px-3 py-1.5 text-sm","aria-label":t("markAllRead"),children:[e.jsx(xe,{className:"size-4"}),t("markAllRead")]}):void 0}),e.jsx("div",{className:"bg-card border-b px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:o.unreadCount>0?t("unreadCount",{count:o.unreadCount}):t("noUnread")}),o.notifications.length>0&&e.jsxs(q,{variant:"ghost",size:"sm",onClick:u,className:"text-destructive",children:[e.jsx(qt,{className:"mr-1 size-4"}),t("clear")]})]})}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(Ly,{notifications:o.notifications,onRead:c,onRemove:i,onNavigate:m,formatRelativeTime:n,t,language:s})})]})}_d.__docgenInfo={description:"",methods:[],displayName:"NotificationCenterPage"};const Md=()=>e.jsx(ne,{children:e.jsx(_d,{})});Md.__docgenInfo={description:"",methods:[],displayName:"NotificationsActivity"};function zy(t){const s=t.toNumber();return s>=1e9?`${(s/1e9).toFixed(2)}B`:s>=1e6?`${(s/1e6).toFixed(2)}M`:s>=1e3?`${(s/1e3).toFixed(2)}K`:s.toFixed(Math.min(5,8))}function Rd({item:t,onMint:s,className:n}){const{t:a}=B("staking"),r=[{label:a("totalMinted",{asset:t.assetType}),value:t.totalMinted},{label:a("totalCirculation",{asset:t.assetType}),value:t.totalCirculation},{label:a("totalBurned",{asset:t.assetType}),value:t.totalBurned},{label:a("totalStaked",{asset:t.externalAssetType}),value:t.totalStaked}];return e.jsxs("div",{className:R("overflow-hidden rounded-xl shadow-md","bg-gradient-to-b from-primary/90 to-primary",n),children:[e.jsxs("div",{className:"relative grid grid-cols-2 gap-3 p-4",children:[r.map((o,c)=>e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("span",{className:"text-lg font-semibold text-amber-300",children:zy(o.value)}),e.jsx("span",{className:"text-xs text-primary-foreground/70",children:o.label})]},c)),e.jsx("div",{className:"pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 opacity-20",children:e.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-white/20 text-2xl font-bold text-white",children:t.chain.charAt(0)})})]}),e.jsxs("div",{className:"flex items-center justify-between bg-card px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(et,{symbol:t.externalAssetType,size:"sm"}),e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"font-medium text-foreground",children:t.externalAssetType}),e.jsx("div",{className:"text-muted-foreground",children:t.externalChain})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(et,{symbol:t.assetType,size:"sm"}),e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"font-medium text-foreground",children:t.assetType}),e.jsx("div",{className:"text-muted-foreground",children:t.chain})]})]}),e.jsx(q,{size:"sm",variant:"default",className:"rounded-full px-4",onClick:()=>s?.(t),children:a("mint")})]})]})]})}Rd.__docgenInfo={description:"Staking pool card component",methods:[],displayName:"StakingPoolCard",props:{item:{required:!0,tsType:{name:"StakingOverviewItem"},description:""},onMint:{required:!1,tsType:{name:"union",raw:"((item: StakingOverviewItem) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Dy=[{value:"all",label:"allNetworks"},{value:"ETH",label:"Ethereum"},{value:"BSC",label:"BNB Chain"},{value:"TRON",label:"Tron"},{value:"BFMeta",label:"BFMeta"},{value:"BFChain",label:"BFChain"}];function Ld({onMint:t,className:s}){const{t:n}=B("staking"),[a,r]=l.useState(""),[o,c]=l.useState("all"),[i,d]=l.useState(!1),[u,m]=l.useState([]),[f,h]=l.useState(!0);l.useEffect(()=>{let p=!0;return h(!0),Lt.getOverview().then(g=>{p&&(m(g),h(!1))}),()=>{p=!1}},[]);const x=l.useMemo(()=>{let p=u;if(a.trim()){const g=a.toLowerCase();p=p.filter(v=>v.assetType.toLowerCase().includes(g)||v.externalAssetType.toLowerCase().includes(g)||v.chain.toLowerCase().includes(g)||v.externalChain.toLowerCase().includes(g))}return o!=="all"&&(p=p.filter(g=>g.chain===o||g.externalChain===o)),p},[u,a,o]),b=p=>{c(p),d(!1)};return f?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[e.jsx(Se,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):e.jsxs("div",{className:R("space-y-4",s),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(qs,{className:"text-muted-foreground absolute top-1/2 left-3 size-4 -translate-y-1/2"}),e.jsx(De,{type:"text",placeholder:n("searchPlaceholder"),value:a,onChange:p=>r(p.target.value),className:"pl-9"})]}),e.jsxs(ut,{open:i,onOpenChange:d,children:[e.jsx(xm,{render:e.jsxs(q,{variant:"outline",size:"icon",className:"relative",children:[e.jsx(wo,{className:"size-4"}),o!=="all"&&e.jsx("span",{className:"bg-primary absolute -top-1 -right-1 size-2 rounded-full"})]})}),e.jsxs(mt,{side:"bottom",className:"h-[60vh]",children:[e.jsx(ft,{children:e.jsx(pt,{children:n("selectNetwork")})}),e.jsx("div",{className:"mt-4 space-y-2",children:Dy.map(p=>e.jsxs("button",{onClick:()=>b(p.value),className:R("flex w-full items-center justify-between rounded-lg px-4 py-3 text-left transition-colors",o===p.value?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("span",{children:p.value==="all"?n("allNetworks"):p.label}),o===p.value&&e.jsx("span",{className:"text-primary",children:""})]},p.value))})]})]})]}),x.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-20",children:e.jsx("p",{className:"text-muted-foreground",children:n("noResults")})}):e.jsx("div",{className:"space-y-4",children:x.map((p,g)=>e.jsx(Rd,{item:p,onMint:t},`${p.chain}-${p.assetType}-${g}`))})]})}Ld.__docgenInfo={description:"Staking overview panel with search and filter",methods:[],displayName:"StakingOverviewPanel",props:{onMint:{required:!1,tsType:{name:"signature",type:"function",raw:"(item: StakingOverviewItem) => void",signature:{arguments:[{type:{name:"StakingOverviewItem"},name:"item"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const By=["ETH","BSC","TRON"],Oy={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron"},Di={ETH:{BFM:"1000.00",USDT:"5000.00"},BSC:{BFM:"2500.00",USDT:"10000.00",BFC:"500.00"},TRON:{USDT:"8000.00"}};function Wy(t,s){if(!t)return[];const n=[];for(const[a,r]of Object.entries(t))for(const[o,c]of Object.entries(r)){const i=c.supportChain[s];i&&n.push({asset:i.assetType,targetChain:a,targetAsset:o})}return n}function zd({onSuccess:t,className:s}){const{t:n}=B("staking"),a=$t(),[r,o]=l.useState("BSC"),[c,i]=l.useState(""),[d,u]=l.useState(""),[m,f]=l.useState(""),[h,x]=l.useState(""),[b,p]=l.useState(!1),[g,v]=l.useState(!1),[j,N]=l.useState(!0),[y,C]=l.useState(!1),[w,S]=l.useState(null);l.useEffect(()=>{let L=!0;return Lt.getRechargeConfig().then(V=>{L&&(S(V),N(!1))}),()=>{L=!1}},[]);const M=l.useMemo(()=>Wy(w,r),[w,r]),A=l.useCallback(L=>{const V=Oy[L];if(V)return V;const _=L.toLowerCase();return a[_]??a[L]??L},[a]);l.useEffect(()=>{const L=M[0];L&&!c&&(i(L.asset),u(L.targetChain),f(L.targetAsset))},[M,c]);const I=l.useCallback(L=>{o(L),i(""),u(""),f(""),x(""),p(!1)},[]),T=l.useCallback(L=>{i(L.asset),u(L.targetChain),f(L.targetAsset),v(!1)},[]),P=l.useMemo(()=>Di[r]?.[c]??"0.00",[r,c]),k=l.useCallback(()=>{x(P.replace(/,/g,""))},[P]),E=l.useMemo(()=>{if(!h)return null;const L=parseFloat(h);if(isNaN(L)||L<=0)return n("invalidAmount");const V=parseFloat(P.replace(/,/g,""));return L>V?n("insufficientBalance"):null},[h,P,n]),z=l.useMemo(()=>r&&c&&d&&m&&h&&!E&&!y,[r,c,d,m,h,E,y]),D=l.useCallback(async()=>{if(z){C(!0);try{const L=h.replace(/,/g,""),V={sourceChain:r,sourceAsset:c,amount:se.fromFormatted(L,18,c),targetChain:d,targetAsset:m},_=await Lt.submitMint(V);t?.(_.id)}finally{C(!1)}}},[z,r,c,h,d,m,t]);return j?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Se,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):e.jsxs("div",{className:R("space-y-4",s),children:[e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("sourceChain")}),e.jsxs("button",{type:"button",onClick:()=>p(!0),className:"bg-background mb-3 flex w-full items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-muted flex size-6 items-center justify-center rounded-full text-xs font-bold",children:r.charAt(0)}),e.jsx("span",{className:"font-medium",children:A(r)})]}),e.jsx(Te,{className:"text-muted-foreground size-4"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>v(!0),className:"bg-background flex shrink-0 items-center gap-2 rounded-lg px-3 py-2",children:[e.jsx(et,{symbol:c||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:c||n("selectToken")}),e.jsx(Te,{className:"text-muted-foreground size-4"})]}),e.jsx("div",{className:"flex-1",children:e.jsx(De,{type:"text",inputMode:"decimal",placeholder:"0.00",value:h,onChange:L=>x(L.target.value),className:"border-0 bg-transparent text-right text-lg font-semibold"})})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-muted-foreground",children:[n("availableBalance"),": ",P]}),e.jsx(q,{type:"button",variant:"ghost",size:"sm",className:"text-primary h-auto px-2 py-1 text-xs",onClick:k,children:n("max")})]}),E&&e.jsx("div",{className:"text-destructive mt-2 text-xs",children:E})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-muted rounded-full p-2",children:e.jsx(Dn,{className:"text-muted-foreground size-4"})})}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("targetChain")}),e.jsxs("div",{className:"bg-background flex items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-primary/20 text-primary flex size-6 items-center justify-center rounded-full text-xs font-bold",children:d.charAt(0)||"?"}),e.jsx("span",{className:"font-medium",children:d?A(d):n("selectToken")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(et,{symbol:m||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:m||"-"})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:n("amount")}),e.jsxs("span",{className:"font-semibold",children:[h||"0.00"," ",m]})]})]}),e.jsx(q,{type:"button",size:"lg",className:"w-full",disabled:!z,onClick:D,children:y?e.jsxs(e.Fragment,{children:[e.jsx(Se,{size:"sm"}),e.jsx("span",{className:"ml-2",children:n("confirm")})]}):n("confirm")}),e.jsx(ut,{open:b,onOpenChange:p,children:e.jsxs(mt,{side:"bottom",className:"h-[50vh]",children:[e.jsx(ft,{children:e.jsx(pt,{children:n("selectChain")})}),e.jsx("div",{className:"mt-4 space-y-2",children:By.map(L=>e.jsxs("button",{onClick:()=>I(L),className:R("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",r===L?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("div",{className:"bg-muted flex size-8 items-center justify-center rounded-full text-sm font-bold",children:L.charAt(0)}),e.jsx("span",{className:"font-medium",children:A(L)}),r===L&&e.jsx("span",{className:"text-primary ml-auto",children:""})]},L))})]})}),e.jsx(ut,{open:g,onOpenChange:v,children:e.jsxs(mt,{side:"bottom",className:"h-[60vh]",children:[e.jsx(ft,{children:e.jsx(pt,{children:n("selectToken")})}),e.jsx("div",{className:"mt-4 space-y-2",children:M.length===0?e.jsx("p",{className:"text-muted-foreground py-8 text-center",children:n("noResults")}):M.map(L=>e.jsxs("button",{onClick:()=>T(L),className:R("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",c===L.asset?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx(et,{symbol:L.asset,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:L.asset}),e.jsx("div",{className:"text-muted-foreground text-xs",children:n("targetChainLabel",{chain:A(L.targetChain),asset:L.targetAsset})})]}),e.jsx("div",{className:"text-muted-foreground text-right text-sm",children:Di[r]?.[L.asset]??"0.00"}),c===L.asset&&e.jsx("span",{className:"text-primary",children:""})]},`${L.targetChain}-${L.asset}`))})]})})]})}zd.__docgenInfo={description:"Mint form component",methods:[],displayName:"MintForm",props:{onSuccess:{required:!1,tsType:{name:"signature",type:"function",raw:"(txId: string) => void",signature:{arguments:[{type:{name:"string"},name:"txId"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Fy=["BFMeta","BFChain","CCChain","PMChain"],$y={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron"},Bi={BFMeta:{BFM:"5000.00",USDT:"2500.00"},BFChain:{BFC:"1000.00"},CCChain:{},PMChain:{}};function qy(t,s){if(!t)return[];const n=s.toLowerCase(),a=t[n];if(!a)return[];const r=[];for(const[o,c]of Object.entries(a)){const i=[];c.supportChain.ETH&&i.push("ETH"),c.supportChain.BSC&&i.push("BSC"),c.supportChain.TRON&&i.push("TRON"),i.length>0&&r.push({asset:o,targetChains:i})}return r}function Dd({onSuccess:t,className:s}){const{t:n}=B("staking"),a=$t(),[r,o]=l.useState("BFMeta"),[c,i]=l.useState(""),[d,u]=l.useState(""),[m,f]=l.useState(""),[h,x]=l.useState(!1),[b,p]=l.useState(!1),[g,v]=l.useState(!1),[j,N]=l.useState(!0),[y,C]=l.useState(!1),[w,S]=l.useState(null);l.useEffect(()=>{let _=!0;return Lt.getRechargeConfig().then(O=>{_&&(S(O),N(!1))}),()=>{_=!1}},[]);const M=l.useMemo(()=>qy(w,r),[w,r]),A=l.useCallback(_=>{const O=$y[_];if(O)return O;const G=_.toLowerCase();return a[G]??a[_]??_},[a]),I=l.useMemo(()=>c?M.find(O=>O.asset===c)?.targetChains??[]:[],[M,c]);l.useEffect(()=>{const _=M[0];if(_&&!c){i(_.asset);const O=_.targetChains[0];O&&u(O)}},[M,c]);const T=l.useCallback(_=>{o(_),i(""),u(""),f(""),x(!1)},[]),P=l.useCallback(_=>{i(_.asset);const O=_.targetChains[0];O&&u(O),p(!1)},[]),k=l.useCallback(_=>{u(_),v(!1)},[]),E=l.useMemo(()=>Bi[r]?.[c]??"0.00",[r,c]),z=l.useCallback(()=>{f(E.replace(/,/g,""))},[E]),D=l.useMemo(()=>{if(!m)return null;const _=parseFloat(m);if(isNaN(_)||_<=0)return n("invalidAmount");const O=parseFloat(E.replace(/,/g,""));return _>O?n("insufficientBalance"):null},[m,E,n]),L=l.useMemo(()=>r&&c&&d&&m&&!D&&!y,[r,c,d,m,D,y]),V=l.useCallback(async()=>{if(!(!L||!d)){C(!0);try{const _=m.replace(/,/g,""),O={sourceChain:r,sourceAsset:c,amount:se.fromFormatted(_,8,c),targetChain:d,targetAsset:c},G=await Lt.submitBurn(O);t?.(G.id)}finally{C(!1)}}},[L,r,c,m,d,t]);return j?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Se,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):e.jsxs("div",{className:R("space-y-4",s),children:[e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("sourceChain")}),e.jsxs("button",{type:"button",onClick:()=>x(!0),className:"bg-background mb-3 flex w-full items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-primary/20 text-primary flex size-6 items-center justify-center rounded-full text-xs font-bold",children:r.charAt(0)}),e.jsx("span",{className:"font-medium",children:A(r)})]}),e.jsx(Te,{className:"text-muted-foreground size-4"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>p(!0),className:"bg-background flex shrink-0 items-center gap-2 rounded-lg px-3 py-2",children:[e.jsx(et,{symbol:c||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:c||n("selectToken")}),e.jsx(Te,{className:"text-muted-foreground size-4"})]}),e.jsx("div",{className:"flex-1",children:e.jsx(De,{type:"text",inputMode:"decimal",placeholder:"0.00",value:m,onChange:_=>f(_.target.value),className:"border-0 bg-transparent text-right text-lg font-semibold"})})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-muted-foreground",children:[n("availableBalance"),": ",E]}),e.jsx(q,{type:"button",variant:"ghost",size:"sm",className:"text-primary h-auto px-2 py-1 text-xs",onClick:z,children:n("max")})]}),D&&e.jsx("div",{className:"text-destructive mt-2 text-xs",children:D})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-muted rounded-full p-2",children:e.jsx(Dn,{className:"text-muted-foreground size-4"})})}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("targetChain")}),e.jsxs("button",{type:"button",onClick:()=>v(!0),disabled:I.length===0,className:"bg-background flex w-full items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-muted flex size-6 items-center justify-center rounded-full text-xs font-bold",children:d?d.charAt(0):"?"}),e.jsx("span",{className:"font-medium",children:d?A(d):n("selectChain")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(et,{symbol:c||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:c||"-"}),e.jsx(Te,{className:"text-muted-foreground size-4"})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:n("amount")}),e.jsxs("span",{className:"font-semibold",children:[m||"0.00"," ",c]})]})]}),e.jsx(q,{type:"button",size:"lg",className:"w-full",disabled:!L,onClick:V,children:y?e.jsxs(e.Fragment,{children:[e.jsx(Se,{size:"sm"}),e.jsx("span",{className:"ml-2",children:n("confirm")})]}):n("confirm")}),e.jsx(ut,{open:h,onOpenChange:x,children:e.jsxs(mt,{side:"bottom",className:"h-[50vh]",children:[e.jsx(ft,{children:e.jsx(pt,{children:n("selectChain")})}),e.jsx("div",{className:"mt-4 space-y-2",children:Fy.map(_=>e.jsxs("button",{onClick:()=>T(_),className:R("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",r===_?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("div",{className:"bg-primary/20 text-primary flex size-8 items-center justify-center rounded-full text-sm font-bold",children:_.charAt(0)}),e.jsx("span",{className:"font-medium",children:A(_)}),r===_&&e.jsx("span",{className:"text-primary ml-auto",children:""})]},_))})]})}),e.jsx(ut,{open:b,onOpenChange:p,children:e.jsxs(mt,{side:"bottom",className:"h-[60vh]",children:[e.jsx(ft,{children:e.jsx(pt,{children:n("selectToken")})}),e.jsx("div",{className:"mt-4 space-y-2",children:M.length===0?e.jsx("p",{className:"text-muted-foreground py-8 text-center",children:n("noResults")}):M.map(_=>e.jsxs("button",{onClick:()=>P(_),className:R("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",c===_.asset?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx(et,{symbol:_.asset,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:_.asset}),e.jsxs("div",{className:"text-muted-foreground text-xs",children:[" ",_.targetChains.join(", ")]})]}),e.jsx("div",{className:"text-muted-foreground text-right text-sm",children:Bi[r]?.[_.asset]??"0.00"}),c===_.asset&&e.jsx("span",{className:"text-primary",children:""})]},_.asset))})]})}),e.jsx(ut,{open:g,onOpenChange:v,children:e.jsxs(mt,{side:"bottom",className:"h-[50vh]",children:[e.jsx(ft,{children:e.jsx(pt,{children:n("selectChain")})}),e.jsx("div",{className:"mt-4 space-y-2",children:I.map(_=>e.jsxs("button",{onClick:()=>k(_),className:R("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",d===_?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("div",{className:"bg-muted flex size-8 items-center justify-center rounded-full text-sm font-bold",children:_.charAt(0)}),e.jsx("span",{className:"font-medium",children:A(_)}),d===_&&e.jsx("span",{className:"text-primary ml-auto",children:""})]},_))})]})})]})}Dd.__docgenInfo={description:"Burn form component",methods:[],displayName:"BurnForm",props:{onSuccess:{required:!1,tsType:{name:"signature",type:"function",raw:"(txId: string) => void",signature:{arguments:[{type:{name:"string"},name:"txId"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Hy={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron"};function Uy({status:t}){switch(t){case"pending":return e.jsx(Um,{className:"size-4 text-yellow-500"});case"confirming":return e.jsx(Ce,{className:"size-4 animate-spin text-blue-500"});case"confirmed":return e.jsx(us,{className:"size-4 text-green-500"});case"failed":return e.jsx(Hm,{className:"text-destructive size-4"})}}function Vy(t){const n=Date.now()-t;return n<6e4?"Just now":n<36e5?`${Math.floor(n/6e4)}m ago`:n<864e5?`${Math.floor(n/36e5)}h ago`:new Date(t).toLocaleDateString()}function Jy(t){const s=t.toNumber();return s>=1e6?`${(s/1e6).toFixed(2)}M`:s>=1e3?`${(s/1e3).toFixed(2)}K`:s.toFixed(4)}function Oi(t,s){const n=Hy[t];if(n)return n;const a=t.toLowerCase();return s[a]??s[t]??t}function Ky({record:t,onClick:s}){const{t:n}=B("staking"),a=$t(),r=Oi(t.sourceChain,a),o=Oi(t.targetChain,a),c=t.type==="mint",i=c?Zm:bo;return e.jsxs("button",{type:"button",onClick:s,className:"bg-card hover:bg-muted/50 flex w-full items-center gap-3 rounded-lg p-3 text-left transition-colors",children:[e.jsx("div",{className:R("flex size-10 items-center justify-center rounded-full",c?"bg-green-500/10":"bg-orange-500/10"),children:e.jsx(i,{className:R("size-5",c?"text-green-500":"text-orange-500")})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:n(c?"mint":"burn")}),e.jsx(Uy,{status:t.status})]}),e.jsxs("div",{className:"text-muted-foreground flex items-center gap-1 text-xs",children:[e.jsx("span",{children:r}),e.jsx("span",{children:""}),e.jsx("span",{children:o})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(et,{symbol:t.sourceAsset,size:"sm"}),e.jsx("span",{className:"font-medium",children:Jy(t.sourceAmount)})]}),e.jsx("div",{className:"text-muted-foreground text-xs",children:Vy(t.createdAt)})]})]})}function Bd({filterType:t="all",onRecordClick:s,className:n}){const{t:a}=B("staking"),[r,o]=l.useState([]),[c,i]=l.useState(!0),[d,u]=l.useState(t==="all"?"all":t);l.useEffect(()=>{let x=!0;return i(!0),Lt.getTransactions().then(b=>{x&&(o(b),i(!1))}),()=>{x=!1}},[]);const m=l.useMemo(()=>d==="all"?r:r.filter(x=>x.type===d),[r,d]),f=[{id:"all",label:a("history")},{id:"mint",label:a("mint")},{id:"burn",label:a("burn")}],h=l.useCallback(()=>{i(!0),Lt.getTransactions().then(x=>{o(x),i(!1)})},[]);return c?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Se,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:a("loading")})]}):e.jsxs("div",{className:R("space-y-4",n),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[f.map(x=>e.jsx(q,{type:"button",variant:d===x.id?"default":"outline",size:"sm",onClick:()=>u(x.id),children:x.label},x.id)),e.jsx(q,{type:"button",variant:"ghost",size:"sm",className:"ml-auto",onClick:h,children:a("refresh")})]}),m.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:a("noTransactions")})}):e.jsx("div",{className:"space-y-2",children:m.map(x=>e.jsx(Ky,{record:x,onClick:()=>s?.(x)},x.id))})]})}Bd.__docgenInfo={description:"Staking record list component",methods:[],displayName:"StakingRecordList",props:{filterType:{required:!1,tsType:{name:"union",raw:"StakingTxType | 'all'",elements:[{name:"StakingTxType"},{name:"literal",value:"'all'"}]},description:"Filter by transaction type",defaultValue:{value:"'all'",computed:!1}},onRecordClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(record: StakingTransaction) => void",signature:{arguments:[{type:{name:"StakingTransaction"},name:"record"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};function Od(){const{t}=B("staking"),{goBack:s}=ae(),[n,a]=l.useState("overview"),r=[{id:"overview",label:t("overview")},{id:"mint",label:t("mint")},{id:"burn",label:t("burn")},{id:"history",label:t("history")}],o=c=>{a("mint")};return e.jsxs("div",{className:"flex min-h-screen flex-col bg-background",children:[e.jsx(U,{title:t("title"),onBack:s}),e.jsx("div",{className:"flex border-b border-border px-4",children:r.map(c=>e.jsx("button",{onClick:()=>a(c.id),className:R("flex-1 py-3 text-sm font-medium transition-colors",n===c.id?"border-b-2 border-primary text-primary":"text-muted-foreground hover:text-foreground"),children:c.label},c.id))}),e.jsxs("div",{className:"flex-1 p-4",children:[n==="overview"&&e.jsx(Ld,{onMint:o}),n==="mint"&&e.jsx(Gy,{}),n==="burn"&&e.jsx(Qy,{}),n==="history"&&e.jsx(Bd,{})]})]})}function Gy(){const{t}=B("staking"),s=n=>{};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:t("mintDescription")}),e.jsx(zd,{onSuccess:s})]})}function Qy(){const{t}=B("staking"),s=n=>{};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:t("burnDescription")}),e.jsx(Dd,{onSuccess:s})]})}Od.__docgenInfo={description:"Staking page with tab navigation",methods:[],displayName:"StakingPage"};const Wd=()=>e.jsx(ne,{children:e.jsx(Od,{})});Wd.__docgenInfo={description:"",methods:[],displayName:"StakingActivity"};const Yy=ls({assetType:H(),decimals:Ot(),amount:H().optional(),useDefaultDecimals:Ze().optional(),logoUrl:H().optional(),contractAddress:H().optional()}),Xy=ls({address:H(),symbol:H(),addressKey:H(),mainWalletId:H(),chain:H(),mnemonic:H().optional(),privateKey:H(),publicKey:H().optional(),isCustomAssets:Ze().optional(),isFreezed:Ze().optional(),assets:Xe(Yy),name:H(),prohibitChangeName:Ze().optional(),index:Ot().optional(),purpose:Ta([Ye(44),Ye(49),Ye(84),Ye(86)]).optional()}),Zy=ls({chainName:H(),addressKey:H(),address:H(),symbol:H(),mainWalletId:H(),index:Ot().optional(),purpose:Ta([Ye(44),Ye(49),Ye(84),Ye(86)]).optional()});ls({name:H(),skipBackup:Ze().optional(),importPhrase:H(),importType:H(),addressKeyList:Xe(Zy),mainWalletId:H(),headSculpture:H(),createTimestamp:Ot(),lastBitcoinAddressKey:H().optional()});ls({addressBookId:H(),name:H(),address:H(),chainList:Xe(H()).optional(),remarks:H().optional(),iconName:H().optional(),symbol:H().optional()});ls({password:H(),passwordTips:H().optional(),lastWalletActivate:Xy.optional(),walletLock:Ze().optional(),fingerprintLock:Ze().optional(),fingerprintPay:Ze().optional()});const eb=l.createContext(null);function tb(){return l.useContext(eb)}const sb="keyapp_welcome_shown";function on(){localStorage.setItem(sb,"1")}function Fd(){const{t}=B("guide"),{navigate:s}=ae(),[n,a]=l.useState(0),r=tb(),o=l.useMemo(()=>[{icon:e.jsx(Co,{className:"text-primary size-16"}),title:t("welcome.slides.transfer.title"),description:t("welcome.slides.transfer.description")},{icon:e.jsx(ko,{className:"text-primary size-16"}),title:t("welcome.slides.multichain.title"),description:t("welcome.slides.multichain.description")},{icon:e.jsx(Vm,{className:"text-primary size-16"}),title:t("welcome.slides.security.title"),description:t("welcome.slides.security.description")}],[t]),c=o[n];if(!c)return null;const i=l.useCallback(()=>{on(),s({to:"/wallet/create"})},[s]),d=l.useCallback(()=>{on(),s({to:"/onboarding/recover"})},[s]),u=l.useCallback(()=>{on(),s({to:"/onboarding/migrate"})},[s]),m=l.useCallback(()=>{on(),s({to:"/"})},[s]),f=l.useCallback(()=>{n<o.length-1&&a(b=>b+1)},[n,o.length]),h=n===o.length-1,x=r?.shouldPromptMigration;return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx("div",{className:"flex justify-end p-4",children:e.jsx(q,{variant:"ghost",size:"sm","data-testid":"skip-button",onClick:m,children:t("welcome.skip")})}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center px-8",children:[e.jsx("div",{className:"bg-primary/10 mb-8 flex size-32 items-center justify-center rounded-full",children:c.icon}),e.jsx("h1",{className:"mb-4 text-center text-2xl font-bold",children:c.title}),e.jsx("p",{className:"text-muted-foreground mb-8 max-w-sm text-center",children:c.description}),e.jsx("div",{className:"mb-8 flex gap-2",children:o.map((b,p)=>e.jsx("button",{"data-testid":`slide-dot-${p}`,onClick:()=>a(p),className:R("size-2 rounded-full transition-colors",p===n?"bg-primary":"bg-muted-foreground/30"),"aria-label":t("welcome.goToSlide",{number:p+1})},p))})]}),e.jsx("div",{className:"p-6",children:h?e.jsxs("div",{className:"flex flex-col gap-3",children:[x&&e.jsxs(q,{"data-testid":"migrate-button",onClick:u,className:"w-full",size:"lg",variant:"default",children:[e.jsx(Hs,{className:"mr-2 size-4"}),t("welcome.migrateFromMpay")]}),e.jsx(q,{"data-testid":"get-started-button",onClick:i,className:"w-full",size:"lg",variant:x?"outline":"default",children:t("welcome.getStarted")}),e.jsx(q,{"data-testid":"have-wallet-button",onClick:d,variant:"outline",className:"w-full",size:"lg",children:t("welcome.haveWallet")})]}):e.jsxs(q,{"data-testid":"next-button",onClick:f,className:"w-full",size:"lg",children:[t("welcome.next"),e.jsx(Te,{className:"ml-2 size-4"})]})})]})}Fd.__docgenInfo={description:"",methods:[],displayName:"WelcomeScreen"};const $d=()=>e.jsx(ne,{children:e.jsx(Fd,{})});$d.__docgenInfo={description:"",methods:[],displayName:"WelcomeActivity"};function qd(){const{t}=B(["wallet","onboarding","security","common"]),{goBack:s}=ae(),n=Ae(),a=Os(),r=Be(),[o,c]=l.useState("select"),[i,d]=l.useState([]),[u,m]=l.useState([]),[f,h]=l.useState(!1),x=l.useRef(!1);l.useEffect(()=>{!x.current&&n&&(d(n.chainAddresses.map(v=>v.chain)),x.current=!0)},[n]);const b=l.useCallback(()=>{if(!n)return!1;const v=new Set(n.chainAddresses.map(j=>j.chain));return v.size!==i.length?!0:i.some(j=>!v.has(j))},[n,i]),p=l.useCallback(()=>{if(!b()){s();return}c("verify")},[b,s]),g=l.useCallback(async v=>{if(!(!n||v.length<4)){h(!1),c("saving");try{const j=gt(v);await pe.updateWalletChainAddresses(n.id,i,j,a),!i.includes(r)&&i.length>0&&pe.setSelectedChain(i[0]),c("success"),setTimeout(()=>{s()},1500)}catch(j){j instanceof Error&&j.message.includes("decrypt")?(h(!0),m([]),c("verify"),setTimeout(()=>{h(!1)},1500)):c("select")}}},[n,i,a,s]);return n?o==="saving"?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(U,{title:t("wallet:chains.title")}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx(Se,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground",children:t("wallet:chains.saving")})]})]}):o==="success"?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(U,{title:t("wallet:chains.title")}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-green-500/10",children:e.jsx(xe,{className:"size-8 text-green-500"})}),e.jsx("p",{className:"font-medium",children:t("wallet:chains.success")})]})]}):o==="verify"?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(U,{title:t("wallet:chains.verifyTitle"),onBack:()=>{c("select"),m([])}}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:t("wallet:chains.verifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("wallet:chains.verifyDesc")})]}),e.jsx(Ut,{value:u,onChange:m,onComplete:g,minPoints:4,error:f,"data-testid":"wallet-chains-pattern"})]})]}):e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(U,{title:t("wallet:chains.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Fs,{icon:e.jsx(us,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:t("onboarding:chainSelector.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("onboarding:chainSelector.subtitle")})]}),a.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(Se,{})}):e.jsx(Da,{"data-testid":"wallet-chains-selector",chains:a,selectedChains:i,onSelectionChange:d}),e.jsx(ze,{variant:"mint",className:"w-full","data-testid":"wallet-chains-save",disabled:i.length===0,onClick:p,children:b()?t("common:save"):t("common:done")})]})]}):e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(U,{title:t("wallet:chains.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx(zt,{variant:"warning",children:t("wallet:chains.noWallet")})})]})}qd.__docgenInfo={description:"",methods:[],displayName:"WalletChainsPage"};const Hd=()=>e.jsx(ne,{children:e.jsx(qd,{})});Hd.__docgenInfo={description:"",methods:[],displayName:"SettingsWalletChainsActivity"};function aa(t){if(t===0)return"0 B";const s=1024,n=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(s));return`${parseFloat((t/Math.pow(s,a)).toFixed(2))} ${n[a]}`}function Ud(){const{t}=B(["settings","common"]),{goBack:s}=ae(),{push:n}=Q(),[a,r]=l.useState(null),[o,c]=l.useState(!0),i=l.useCallback(async()=>{c(!0);try{if(navigator.storage&&navigator.storage.estimate){const u=await navigator.storage.estimate();r({usage:u.usage??0,quota:u.quota??0})}}catch{}finally{c(!1)}},[]);l.useEffect(()=>{i()},[i]);const d=a?a.usage/a.quota*100:0;return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(U,{title:t("settings:storage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"bg-primary/10 flex size-10 items-center justify-center rounded-full",children:e.jsx(No,{className:"text-primary size-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:t("settings:storage.usage")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:t("settings:storage.basedOn")})]})]}),o?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(Ce,{className:"text-muted-foreground size-6 animate-spin"})}):a?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"bg-muted h-3 w-full overflow-hidden rounded-full",children:e.jsx("div",{className:"bg-primary h-full rounded-full transition-all",style:{width:`${Math.min(d,100)}%`}})}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[t("settings:storage.used"),": ",aa(a.usage)]}),e.jsxs("span",{className:"text-muted-foreground",children:[t("settings:storage.total"),": ",aa(a.quota)]})]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:t("settings:storage.usagePercent")}),e.jsxs("span",{className:"font-medium",children:[d.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:t("settings:storage.available")}),e.jsx("span",{className:"font-medium",children:aa(a.quota-a.usage)})]})]})]}):e.jsx("p",{className:"text-muted-foreground text-center py-4",children:t("settings:storage.unavailable")})]}),e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"font-medium mb-2",children:t("settings:storage.clearTitle")}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:t("settings:storage.clearDesc")}),e.jsxs(q,{variant:"destructive",className:"w-full",onClick:()=>n("ClearDataConfirmJob",{}),children:[e.jsx(qt,{className:"size-4 mr-2"}),t("settings:items.clearData")]})]})]})]})}Ud.__docgenInfo={description:"",methods:[],displayName:"SettingsStoragePage"};const Vd=()=>e.jsx(ne,{children:e.jsx(Ud,{})});Vd.__docgenInfo={description:"",methods:[],displayName:"SettingsStorageActivity"};const Jd=()=>{const{t}=B("common"),{pop:s}=Q(),n=we(Bt),[a,r]=l.useState(!1),[o,c]=l.useState(""),[i,d]=l.useState(""),[u,m]=l.useState(!1),[f,h]=l.useState(null),x=async()=>{if(!o.trim()){h(t("sources.enterUrl"));return}let v;try{v=new URL(o).toString()}catch{h(t("sources.invalidUrl"));return}if(n.sources.some(j=>j.url===v)){h(t("sources.alreadyExists"));return}je.addSource(v,i||t("sources.customSource")),c(""),d(""),r(!1),h(null),wg(v)},b=v=>{je.removeSource(v)},p=v=>{je.toggleSource(v)},g=async()=>{m(!0);try{await or()}catch{}m(!1)};return e.jsx(ne,{children:e.jsxs("div",{className:"bg-background flex min-h-full flex-col",children:[e.jsx("div",{className:"bg-background sticky top-0 z-10 border-b",children:e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[e.jsx("button",{onClick:()=>s(),className:"hover:bg-muted rounded-full p-1.5 transition-colors","aria-label":t("back"),children:e.jsx(po,{className:"size-5",stroke:1.5})}),e.jsx("h1",{className:"flex-1 text-lg font-semibold",children:t("sources.title")}),e.jsx("button",{onClick:g,disabled:u,className:"hover:bg-muted rounded-full p-1.5 transition-colors","aria-label":t("refresh"),children:e.jsx(Vt,{className:R("size-5",u&&"animate-spin"),stroke:1.5})})]})}),e.jsxs("div",{className:"flex-1 space-y-3 p-4",children:[n.sources.map(v=>e.jsx(nb,{source:v,onToggle:()=>p(v.url),onRemove:()=>b(v.url)},v.url)),n.sources.length===0&&e.jsx("div",{className:"text-muted-foreground py-12 text-center",children:t("sources.noSources")})]}),a?e.jsxs("div",{className:"bg-background space-y-3 border-t p-4",children:[e.jsx("input",{type:"url",value:o,onChange:v=>{c(v.target.value),h(null)},placeholder:t("sources.urlPlaceholder"),className:"bg-background focus:ring-primary w-full rounded-lg border px-3 py-2 focus:ring-2 focus:outline-none"}),e.jsx("input",{type:"text",value:i,onChange:v=>d(v.target.value),placeholder:t("sources.namePlaceholder"),className:"bg-background focus:ring-primary w-full rounded-lg border px-3 py-2 focus:ring-2 focus:outline-none"}),f&&e.jsx("p",{className:"text-destructive text-sm",children:f}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{r(!1),c(""),d(""),h(null)},className:"bg-muted hover:bg-muted/80 flex-1 rounded-lg py-2 font-medium",children:t("cancel")}),e.jsx("button",{onClick:x,className:"bg-primary text-primary-foreground hover:bg-primary/90 flex-1 rounded-lg py-2 font-medium",children:t("add")})]})]}):e.jsx("div",{className:"border-t p-4",children:e.jsxs("button",{onClick:()=>r(!0),className:"border-muted-foreground/30 hover:border-primary hover:bg-primary/5 text-muted-foreground hover:text-primary flex w-full items-center justify-center gap-2 rounded-xl border-2 border-dashed py-3 transition-colors",children:[e.jsx(nt,{className:"size-5",stroke:1.5}),e.jsx("span",{children:t("sources.addSource")})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};function nb({source:t,onToggle:s,onRemove:n}){const{t:a}=B("common"),r=t.url.includes("ecosystem.json"),o={idle:null,loading:e.jsx(Ce,{className:"text-muted-foreground size-3 animate-spin"}),success:e.jsx(xe,{className:"size-3 text-green-500"}),error:e.jsx(vt,{className:"size-3 text-red-500"})}[t.status];return e.jsx("div",{className:R("rounded-xl border p-4 transition-colors",t.enabled?"bg-card":"bg-muted/30 opacity-60"),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/10 shrink-0 rounded-full p-2",children:e.jsx(So,{className:"text-primary size-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"truncate font-medium",children:t.name}),r&&e.jsx("span",{className:"bg-primary/10 text-primary rounded px-1.5 py-0.5 text-xs",children:a("sources.official")}),o]}),e.jsx("p",{className:"text-muted-foreground mt-0.5 truncate text-sm",children:t.url}),e.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:a("sources.updatedAt",{date:new Date(t.lastUpdated).toLocaleString()})}),t.status==="error"&&t.errorMessage&&e.jsx("p",{className:"truncate text-xs text-red-500",children:t.errorMessage})]})]}),e.jsxs("div",{className:"flex shrink-0 items-center gap-1",children:[e.jsx("button",{onClick:s,className:R("rounded-full p-2 transition-colors",t.enabled?"bg-green-100 text-green-600 hover:bg-green-200":"bg-muted text-muted-foreground hover:bg-muted/80"),"aria-label":t.enabled?a("disable"):a("enable"),children:t.enabled?e.jsx(xe,{className:"size-4",stroke:2}):e.jsx(Us,{className:"size-4",stroke:2})}),!r&&e.jsx("button",{onClick:n,className:"text-muted-foreground hover:text-destructive hover:bg-destructive/10 rounded-full p-2 transition-colors","aria-label":a("delete"),children:e.jsx(qt,{className:"size-4",stroke:1.5})})]})]})})}Jd.__docgenInfo={description:"",methods:[],displayName:"SettingsSourcesActivity"};function ab({permission:t,isLast:s}){const a=em[t]?.risk??"medium",r=tm(t),o=a==="high"?_e:oo,c=a==="high"?"text-red-500":a==="medium"?"text-amber-500":"text-green-500";return e.jsxs("div",{className:R("flex items-start gap-3 py-3",!s&&"border-border/50 border-b"),children:[e.jsx(o,{className:R("mt-0.5 size-5 shrink-0",c),stroke:1.5}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:r.label}),e.jsx("p",{className:"text-muted-foreground mt-0.5 text-xs",children:r.description})]})]})}function Yt({label:t,value:s,isLink:n=!1,href:a}){const r=e.jsxs("div",{className:"border-border/50 flex items-center justify-between border-b py-3 last:border-0",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t}),e.jsxs("span",{className:R("text-sm font-medium",n&&"text-primary flex items-center gap-1"),children:[s,n&&e.jsx(Te,{className:"size-4"})]})]});return n&&a?e.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",children:r}):r}const Kd=({params:t})=>{const{pop:s}=Q(),{t:n}=B("ecosystem"),[a,r]=l.useState(null),[o,c]=l.useState(!0),[i,d]=l.useState(!1),u=we(Bt,p=>Aa.isAppInstalled(p,t.appId));l.useEffect(()=>{let p=!1;return(async()=>{c(!0),await Uc();let v=bi(t.appId);v||(await or({force:!1}),v=bi(t.appId)),!p&&(r(v??null),c(!1))})(),()=>{p=!0}},[t.appId]);const m=l.useCallback(()=>{a&&je.installApp(a.id)},[a]),f=l.useCallback(()=>{a&&(je.updateAppLastUsed(a.id),je.setActiveSubPage("mine"),Zi(a.id,{...a,targetDesktop:"mine"}),s())},[a,s]);if(o)return e.jsx(ne,{children:e.jsx("div",{className:"bg-background flex min-h-screen items-center justify-center",children:e.jsx(Se,{size:"lg"})})});if(!a)return e.jsx(ne,{children:e.jsxs("div",{className:"bg-background flex min-h-screen flex-col items-center justify-center gap-4",children:[e.jsx("p",{className:"text-muted-foreground",children:n("detail.notFound")}),e.jsx("button",{onClick:()=>s(),className:"bg-primary text-primary-foreground rounded-full px-4 py-2 text-sm font-medium",children:n("detail.back")})]})});const h=a.longDescription??a.description,x=h.length>150,b=i||!x?h:h.slice(0,150)+"...";return e.jsx(ne,{children:e.jsxs("div",{className:"bg-background detail-scroll-container flex min-h-screen flex-col",children:[e.jsx("div",{className:"bg-background/80 border-border/50 sticky top-0 z-20 border-b backdrop-blur-xl",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[e.jsx("button",{onClick:()=>s(),className:"hover:bg-muted -ml-1.5 rounded-full p-1.5 transition-colors",children:e.jsx(po,{className:"size-5",stroke:1.5})}),e.jsx("span",{className:"detail-header-title max-w-[200px] truncate font-semibold",children:a.name}),e.jsx("button",{className:"hover:bg-muted -mr-1.5 rounded-full p-1.5 transition-colors",children:e.jsx(Ms,{className:"size-5",stroke:1.5})})]})}),e.jsxs("div",{className:"detail-scroller flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"px-5 pt-4 pb-5",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(nm,{src:a.icon,name:a.name,size:"2xl",shadow:"lg",className:"shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1 pt-1",children:[e.jsx("h1",{className:"truncate text-xl font-bold",children:a.name}),e.jsx("p",{className:"text-muted-foreground mt-0.5 truncate text-sm",children:a.author??n("detail.unknownDeveloper")}),u?e.jsx("button",{onClick:f,className:"bg-primary text-primary-foreground mt-4 rounded-full px-8 py-2 text-sm font-semibold",children:n("detail.open")}):e.jsx("button",{onClick:m,className:"bg-primary text-primary-foreground mt-4 rounded-full px-8 py-2 text-sm font-semibold",children:n("detail.get")})]})]}),e.jsxs("div",{className:"text-muted-foreground mt-5 flex items-center gap-4 text-xs",children:[a.category&&e.jsx("span",{className:"text-foreground font-medium",children:n(`detail.categories.${a.category}`,{defaultValue:a.category})}),a.beta&&e.jsx("span",{className:"rounded-full bg-amber-100 px-2 py-0.5 font-medium text-amber-700 dark:bg-amber-900/30 dark:text-amber-400",children:n("detail.beta")}),e.jsxs("span",{children:["v",a.version]})]})]}),a.screenshots&&a.screenshots.length>0&&e.jsx("div",{className:"border-border/50 border-t",children:e.jsxs("div",{className:"px-5 py-4",children:[e.jsx("h2",{className:"mb-4 text-lg font-bold",children:n("detail.preview")}),e.jsx("div",{className:"-mx-5 flex snap-x snap-mandatory gap-3 overflow-x-auto px-5 pb-2",style:{scrollbarWidth:"none"},children:a.screenshots.map((p,g)=>e.jsx("div",{className:"bg-muted aspect-[9/19.5] w-[220px] shrink-0 snap-center overflow-hidden rounded-2xl shadow-lg ring-1 ring-black/5",children:e.jsx("img",{src:p,alt:`${a.name} screenshot ${g+1}`,className:"h-full w-full object-cover",loading:"lazy",onError:v=>{const j=v.currentTarget.parentElement;j&&(j.style.display="none")}})},p))})]})}),e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:b}),x&&e.jsxs("button",{onClick:()=>d(!i),className:"text-primary mt-2 flex items-center gap-1 text-sm font-medium",children:[n(i?"detail.collapse":"detail.more"),i?e.jsx(so,{className:"size-4"}):e.jsx(ao,{className:"size-4"})]})]}),a.chains&&a.chains.length>0&&e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("h2",{className:"mb-3 text-lg font-bold",children:n("detail.supportedChains")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.chains.map(p=>e.jsx("span",{className:"bg-muted rounded-full px-3 py-1.5 text-sm font-medium",children:p},p))})]}),a.permissions&&a.permissions.length>0&&e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("h2",{className:"mb-1 text-lg font-bold",children:n("detail.privacy")}),e.jsx("p",{className:"text-muted-foreground mb-4 text-xs",children:n("detail.privacyHint")}),e.jsx("div",{className:"bg-muted/50 rounded-2xl px-4",children:a.permissions.map((p,g)=>e.jsx(ab,{permission:p,isLast:g===a.permissions.length-1},p))})]}),a.tags&&a.tags.length>0&&e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("h2",{className:"mb-3 text-lg font-bold",children:n("detail.tags")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.tags.map(p=>e.jsx("span",{className:"bg-primary/10 text-primary rounded-full px-3 py-1.5 text-sm font-medium",children:n("detail.tagLabel",{tag:p})},p))})]}),e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("h2",{className:"mb-2 text-lg font-bold",children:n("detail.info")}),e.jsxs("div",{className:"bg-muted/50 rounded-2xl px-4",children:[a.author&&e.jsx(Yt,{label:n("detail.developer"),value:a.author}),e.jsx(Yt,{label:n("detail.version"),value:a.version}),a.category&&e.jsx(Yt,{label:n("detail.category"),value:n(`detail.categories.${a.category}`,{defaultValue:a.category})}),a.publishedAt&&e.jsx(Yt,{label:n("detail.publishedAt"),value:a.publishedAt}),a.updatedAt&&e.jsx(Yt,{label:n("detail.updatedAt"),value:a.updatedAt}),a.website&&e.jsx(Yt,{label:n("detail.website"),value:n("detail.visit"),isLink:!0,href:a.website})]})]}),e.jsx("div",{className:"h-8"})]})]})})};Kd.__docgenInfo={description:"",methods:[],displayName:"MiniappDetailActivity"};function Ds({className:t,...s}){return e.jsx("label",{"data-slot":"label",className:R("gap-2 text-sm leading-none font-medium group-data-[disabled=true]:opacity-50 peer-disabled:opacity-50 flex items-center select-none group-data-[disabled=true]:pointer-events-none peer-disabled:cursor-not-allowed",t),...s})}Ds.__docgenInfo={description:"",methods:[],displayName:"Label"};function Qs({className:t,size:s="default",...n}){return e.jsx("div",{"data-slot":"card","data-size":s,className:R("ring-foreground/10 bg-card text-card-foreground gap-4 overflow-hidden rounded-xl py-4 text-sm ring-1 has-data-[slot=card-footer]:pb-0 has-[>img:first-child]:pt-0 data-[size=sm]:gap-3 data-[size=sm]:py-3 data-[size=sm]:has-data-[slot=card-footer]:pb-0 *:[img:first-child]:rounded-t-xl *:[img:last-child]:rounded-b-xl group/card flex flex-col",t),...n})}function Ys({className:t,...s}){return e.jsx("div",{"data-slot":"card-content",className:R("px-4 group-data-[size=sm]/card:px-3",t),...s})}Qs.__docgenInfo={description:"",methods:[],displayName:"Card",props:{size:{required:!1,tsType:{name:"union",raw:'"default" | "sm"',elements:[{name:"literal",value:'"default"'},{name:"literal",value:'"sm"'}]},description:"",defaultValue:{value:'"default"',computed:!1}}}};Ys.__docgenInfo={description:"",methods:[],displayName:"CardContent"};function rb({queryAddress:t,queryChain:s}){const{t:n}=B(["common"]),a=Ws(),r=Kt(),{data:o,isLoading:c,error:i}=r.nativeBalance.useState({address:t},{enabled:!!t});return e.jsx(Qs,{className:R("transition-all",c&&"opacity-50"),children:e.jsx(Ys,{className:"pt-6",children:i?e.jsxs("div",{className:"flex items-center gap-3 text-destructive",children:[e.jsx(vt,{className:"size-5 shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:n("common:addressLookup.error")}),e.jsx("div",{className:"text-sm opacity-80",children:i.message})]})]}):o?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-primary/10 flex size-12 items-center justify-center rounded-full",children:e.jsx(mf,{className:"text-primary size-6"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[o.amount.toFormatted()," ",o.symbol]}),e.jsx("div",{className:"text-muted-foreground text-sm",children:n("common:addressLookup.onChain",{chain:a.find(d=>d.id===s)?.name??s})})]})]}):c?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx(Se,{size:"lg"})}):null})})}function Gd(){const{t}=B(["common","wallet"]),{goBack:s}=ae(),n=Ws(),[a,r]=l.useState("ethereum"),[o,c]=l.useState(""),[i,d]=l.useState(""),[u,m]=l.useState(""),[f,h]=l.useState(!1),x=l.useCallback(()=>{o.trim()&&(h(!0),d(o.trim()),m(a),setTimeout(()=>h(!1),100))},[o,a]),b=l.useCallback(v=>{v.key==="Enter"&&x()},[x]),p=n.filter(v=>v.chainKind==="evm"),g=n.filter(v=>v.chainKind!=="evm");return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(U,{title:t("common:addressLookup.balanceTitle"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ds,{children:t("common:addressLookup.chain")}),e.jsxs(Ts,{value:a,onValueChange:v=>v&&r(v),children:[e.jsx(Ps,{children:e.jsx(Es,{})}),e.jsxs(_s,{children:[p.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:"EVM"}),p.map(v=>e.jsx(Wt,{value:v.id,children:v.name},v.id))]}),g.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:t("common:addressLookup.otherChains")}),g.map(v=>e.jsx(Wt,{value:v.id,children:v.name},v.id))]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ds,{children:t("common:addressLookup.address")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(De,{placeholder:t("common:addressLookup.addressPlaceholder"),value:o,onChange:v=>c(v.target.value),onKeyDown:b,className:"flex-1 font-mono text-sm"}),e.jsx(q,{onClick:x,disabled:!o.trim()||f,children:f?e.jsx(Se,{size:"sm"}):e.jsx(qs,{className:"size-4"})})]})]}),i&&u&&e.jsx(jt,{chainId:u,fallback:e.jsx(Qs,{children:e.jsx(Ys,{className:"pt-6",children:e.jsx("p",{className:"text-muted-foreground text-center",children:"Chain not supported"})})}),children:e.jsx(rb,{queryAddress:i,queryChain:u})}),!1]})]})}Gd.__docgenInfo={description:"",methods:[],displayName:"AddressBalancePage"};const Qd=()=>e.jsx(ne,{children:e.jsx(Gd,{})});Qd.__docgenInfo={description:"",methods:[],displayName:"AddressBalanceActivity"};function ib(t,s){return(parseFloat(t)/Math.pow(10,s)).toLocaleString(void 0,{maximumFractionDigits:6})}function ob(t){return new Date(t).toLocaleString()}function cb({tx:t,address:s}){const{t:n}=B("common"),a=t.direction==="out"||t.from.toLowerCase()===s.toLowerCase(),r=t.assets.find(m=>m.assetType==="native"||m.assetType==="token"),o=r?r.value:"0",c=r?r.symbol:"",i=r?r.decimals:0,d=n(a?"signSymbol.minus":"signSymbol.plus"),u=n(a?"addressLookup.toLabel":"addressLookup.fromLabel");return e.jsxs("div",{className:"flex items-center gap-3 py-3 border-b last:border-b-0",children:[e.jsx("div",{className:`p-2 rounded-full ${a?"bg-red-100 text-red-600":"bg-green-100 text-green-600"}`,children:a?e.jsx(bo,{className:"size-4"}):e.jsx(Ym,{className:"size-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"text-sm font-medium truncate",children:[u," ",a?t.to:t.from]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:ob(t.timestamp)})]}),e.jsxs("div",{className:`text-sm font-medium ${a?"text-red-600":"text-green-600"}`,children:[d,ib(o,i)," ",c]})]})}function lb({searchAddress:t,selectedChain:s,explorerUrl:n,onOpenExplorer:a}){const{t:r}=B(["common"]),o=Ws(),c=l.useMemo(()=>o.find(h=>h.id===s),[o,s]),i=Kt(),{data:d,isLoading:u,error:m}=i.transactionHistory.useState({address:t,limit:50},{enabled:!!t}),f=!(m instanceof Gi);return e.jsx(Qs,{children:e.jsxs(Ys,{className:"pt-6",children:[u?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(Ce,{className:"size-6 animate-spin text-muted-foreground"})}):m?e.jsx("div",{className:"text-center py-8 text-destructive",children:r("common:addressLookup.queryError")}):d&&d.length>0?e.jsx("div",{className:"divide-y",children:d.map(h=>e.jsx(cb,{tx:h,address:t},h.hash))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:f?e.jsx("p",{children:r("common:addressLookup.noTransactions")}):e.jsx("p",{children:r("common:addressLookup.useExplorerHint")})}),n&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs(q,{variant:f?"outline":"default",size:"sm",className:"w-full gap-2",onClick:a,children:[e.jsx(ia,{className:"size-4"}),r("common:addressLookup.viewOnExplorer",{name:c?.name??s})]})})]})})}function Yd(){const{t}=B(["common","wallet"]),{goBack:s}=ae(),n=Ws(),[a,r]=l.useState("bfmeta"),[o,c]=l.useState(""),[i,d]=l.useState(""),[u,m]=l.useState(""),f=l.useMemo(()=>n.find(j=>j.id===u),[n,u]),h=l.useMemo(()=>{if(!f?.explorer||!i.trim())return null;const{queryAddress:j,url:N}=f.explorer;return j?j.replace(":address",i.trim()):`${N}/address/${i.trim()}`},[f,i]),x=l.useCallback(()=>{o.trim()&&(d(o.trim()),m(a))},[o,a]),b=l.useCallback(j=>{j.key==="Enter"&&x()},[x]),p=l.useCallback(()=>{h&&window.open(h,"_blank","noopener,noreferrer")},[h]),g=n.filter(j=>j.chainKind==="evm"),v=n.filter(j=>j.chainKind!=="evm");return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(U,{title:t("common:addressLookup.transactionsTitle"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ds,{children:t("common:addressLookup.chain")}),e.jsxs(Ts,{value:a,onValueChange:j=>j&&r(j),children:[e.jsx(Ps,{children:e.jsx(Es,{})}),e.jsxs(_s,{children:[g.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:"EVM"}),g.map(j=>e.jsx(Wt,{value:j.id,children:j.name},j.id))]}),v.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:t("common:addressLookup.otherChains")}),v.map(j=>e.jsx(Wt,{value:j.id,children:j.name},j.id))]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ds,{children:t("common:addressLookup.address")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(De,{placeholder:t("common:addressLookup.addressPlaceholder"),value:o,onChange:j=>c(j.target.value),onKeyDown:b,className:"flex-1 font-mono text-sm"}),e.jsx(q,{onClick:x,disabled:!o.trim(),children:e.jsx(qs,{className:"size-4"})})]})]}),i&&u&&e.jsx(jt,{chainId:u,fallback:e.jsx(Qs,{children:e.jsx(Ys,{className:"pt-6",children:e.jsx("p",{className:"text-muted-foreground text-center",children:"Chain not supported"})})}),children:e.jsx(lb,{searchAddress:i,selectedChain:u,explorerUrl:h,onOpenExplorer:p})})]})]})}Yd.__docgenInfo={description:"",methods:[],displayName:"AddressTransactionsPage"};const Xd=()=>e.jsx(ne,{children:e.jsx(Yd,{})});Xd.__docgenInfo={description:"",methods:[],displayName:"AddressTransactionsActivity"};const{useFlow:Q}=lh({transitionDuration:350,plugins:[dh(),zh({theme:"cupertino"}),Yx({routes:{MainTabsActivity:"/",WalletListActivity:"/wallet/list",WalletConfigActivity:"/wallet/:walletId",WalletCreateActivity:"/wallet/create",SendActivity:"/send",DestroyActivity:"/destroy",ReceiveActivity:"/receive",SettingsActivity:"/settings",SettingsLanguageActivity:"/settings/language",SettingsCurrencyActivity:"/settings/currency",SettingsChainsActivity:"/settings/chains",SettingsMnemonicActivity:"/settings/mnemonic",SettingsWalletLockActivity:"/settings/wallet-lock",SettingsWalletChainsActivity:"/settings/wallet-chains",SettingsStorageActivity:"/settings/storage",HistoryActivity:"/history",TransactionDetailActivity:"/transaction/:txId",ScannerActivity:"/scanner",AuthorizeAddressActivity:"/authorize/address/:id",AuthorizeSignatureActivity:"/authorize/signature/:id",OnboardingRecoverActivity:"/onboarding/recover",TokenDetailActivity:"/token/:tokenId",AddressBookActivity:"/address-book",MyCardActivity:"/my-card",NotificationsActivity:"/notifications",StakingActivity:"/staking",WelcomeActivity:"/welcome",SettingsSourcesActivity:"/settings/sources",MiniappDetailActivity:"/miniapp/:appId/detail",AddressBalanceActivity:"/address-balance",AddressTransactionsActivity:"/address-transactions",ChainSelectorJob:"/job/chain-selector",WalletRenameJob:"/job/wallet-rename/:walletId",WalletDeleteJob:"/job/wallet-delete/:walletId",WalletLockConfirmJob:"/job/wallet-lock-confirm",TwoStepSecretConfirmJob:"/job/two-step-secret-confirm",SetTwoStepSecretJob:"/job/set-two-step-secret",MnemonicOptionsJob:"/job/mnemonic-options",ContactEditJob:"/job/contact-edit",ContactPickerJob:"/job/contact-picker",WalletAddJob:"/job/wallet-add",WalletListJob:"/job/wallet-list",SecurityWarningJob:"/job/security-warning",TransferConfirmJob:"/job/transfer-confirm",TransferWalletLockJob:"/job/transfer-wallet-lock",FeeEditJob:"/job/fee-edit",ScannerJob:"/job/scanner",ContactAddConfirmJob:"/job/contact-add-confirm",ContactShareJob:"/job/contact-share",ClearDataConfirmJob:"/job/clear-data-confirm",WalletPickerJob:"/job/wallet-picker",SigningConfirmJob:"/job/signing-confirm",PermissionRequestJob:"/job/permission-request",MiniappTransferConfirmJob:"/job/miniapp-transfer-confirm",MiniappDestroyConfirmJob:"/job/miniapp-destroy-confirm",MiniappSignTransactionJob:"/job/miniapp-sign-transaction",ChainSwitchConfirmJob:"/job/chain-switch-confirm",CryptoAuthorizeJob:"/job/crypto-authorize"},fallbackActivity:()=>"MainTabsActivity",useHash:!0,urlPatternOptions:{segmentValueCharset:"a-zA-Z0-9-._~ %"}})],activities:{MainTabsActivity:Tl,WalletListActivity:El,WalletConfigActivity:_l,WalletCreateActivity:Rl,SendActivity:Ol,DestroyActivity:Fl,ReceiveActivity:ql,SettingsActivity:Hl,SettingsLanguageActivity:Vl,SettingsCurrencyActivity:Kl,SettingsChainsActivity:id,SettingsMnemonicActivity:cd,SettingsWalletLockActivity:dd,SettingsWalletChainsActivity:Hd,SettingsStorageActivity:Vd,HistoryActivity:md,TransactionDetailActivity:pd,ScannerActivity:xd,AuthorizeAddressActivity:yd,AuthorizeSignatureActivity:jd,OnboardingRecoverActivity:kd,TokenDetailActivity:Sd,AddressBookActivity:Id,MyCardActivity:Ed,NotificationsActivity:Md,StakingActivity:Wd,WelcomeActivity:$d,SettingsSourcesActivity:Jd,MiniappDetailActivity:Kd,AddressBalanceActivity:Qd,AddressTransactionsActivity:Xd,ChainSelectorJob:Gc,WalletRenameJob:Yc,WalletDeleteJob:Xc,WalletLockConfirmJob:Zc,TwoStepSecretConfirmJob:el,SetTwoStepSecretJob:nl,MnemonicOptionsJob:al,ContactEditJob:rl,ContactPickerJob:il,WalletAddJob:ol,WalletListJob:cl,SecurityWarningJob:ll,TransferConfirmJob:ul,TransferWalletLockJob:fl,FeeEditJob:sl,ScannerJob:pl,ContactAddConfirmJob:hl,ContactShareJob:xl,ClearDataConfirmJob:gl,WalletPickerJob:vl,SigningConfirmJob:yl,PermissionRequestJob:bl,MiniappTransferConfirmJob:jl,MiniappDestroyConfirmJob:kl,MiniappSignTransactionJob:Cl,ChainSwitchConfirmJob:Sl,CryptoAuthorizeJob:Al}});function db(t,s){const n=Math.abs(t-s);return Math.min(n,360-n)}function ub(t,s,n=30){if(s.length===0)return 1;let a=180;for(const r of s){const o=db(t,r);o<a&&(a=o)}return a<n?a/n:1}function mb(t){return iu.map(s=>({...s,weight:ub(s.hue,t)}))}const fb="wallet-config-preview-name";function Fn({mode:t,walletId:s,onEditOnlyComplete:n,className:a}){const{t:r}=B(["wallet","onboarding","common"]),{push:o}=Q(),c=yt(),i=c.find(_=>_.id===s),d=Be(),u=qi(),m=Ft(),[f,h]=l.useState(t==="edit-only"?"edit":t),[x,b]=l.useState(""),[p,g]=l.useState(0),v=l.useRef(null),[j,N]=l.useState(!1),y=l.useMemo(()=>c.filter(_=>_.id!==s).map(_=>_.themeHue),[c,s]),C=l.useMemo(()=>mb(y),[y]);l.useEffect(()=>{i&&(b(i.name),g(i.themeHue))},[i]);const w=l.useMemo(()=>i?.chainAddresses.find(_=>_.chain===d)??i?.chainAddresses[0],[i,d]),S=l.useCallback(_=>{if(!v.current)return;const O=v.current.getBoundingClientRect(),Z=Math.max(0,Math.min(_-O.left,O.width))/O.width,$=Math.round(Z*3600)/10;g($)},[]),M=_=>{_.stopPropagation(),N(!0),S(_.clientX)},A=_=>{_.stopPropagation(),N(!0),_.touches[0]&&S(_.touches[0].clientX)};l.useEffect(()=>{if(!j)return;const _=Z=>S(Z.clientX),O=Z=>{Z.touches[0]&&S(Z.touches[0].clientX)},G=()=>N(!1);return document.addEventListener("mousemove",_),document.addEventListener("mouseup",G),document.addEventListener("touchmove",O),document.addEventListener("touchend",G),()=>{document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",G),document.removeEventListener("touchmove",O),document.removeEventListener("touchend",G)}},[j,S]);const I=l.useCallback(()=>{o("ChainSelectorJob",{})},[o]),T=l.useCallback(()=>{i&&(b(i.name),g(i.themeHue)),h("edit")},[i]),P=l.useCallback(async()=>{if(!i)return;const _=x.trim();_&&_!==i.name&&await pe.updateWalletName(i.id,_),p!==i.themeHue&&await pe.updateWalletThemeHue(i.id,p),h("default")},[i,x,p]),k=l.useCallback(()=>{i&&(b(i.name),g(i.themeHue)),h("default")},[i]),E=l.useCallback(async()=>{if(!i)return;const _=x.trim();_&&_!==i.name&&await pe.updateWalletName(i.id,_),p!==i.themeHue&&await pe.updateWalletThemeHue(i.id,p),n?.()},[i,x,p,n]),z=l.useCallback(async()=>{i&&(await pe.setCurrentWallet(i.id),o("SettingsMnemonicActivity",{}))},[i,o]),D=l.useCallback(()=>{i&&o("WalletDeleteJob",{walletId:i.id})},[i,o]);if(!i)return e.jsx("div",{className:R("text-muted-foreground p-4 text-center",a),children:r("wallet:detail.notFound")});const L=f==="edit"||t==="edit-only"?p:i.themeHue,V=f==="edit"||t==="edit-only";return e.jsxs("div",{className:R("space-y-6",a),children:[e.jsx("div",{className:"flex justify-center px-4",children:e.jsx("div",{className:"aspect-[1.6/1] w-full max-w-[360px]",children:e.jsx(Hi,{wallet:{...i,name:V?x:i.name,themeHue:L},themeHue:L,walletNameTestId:fb,chain:w?.chain,chainName:w?.chain||"",address:w?.address||i.address,chainIconUrl:u[w?.chain??""],onOpenChainSelector:I})})}),V?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm",children:r("onboarding:theme.walletName")}),e.jsxs(Nu,{children:[e.jsx(wu,{value:x,onChange:_=>b(_.target.value),placeholder:r("wallet:defaultName"),maxLength:20,className:"text-center"}),e.jsx(ku,{align:"inline-end",children:e.jsx(Cu,{size:"icon-xs",variant:"ghost",onClick:()=>b(r("onboarding:create.generatedNamePattern",{word:gn(m),suffix:r("onboarding:create.walletSuffix")})),title:r("wallet:randomName"),children:e.jsx(gf,{className:"size-4"})})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:r("onboarding:theme.customColor")}),e.jsxs("span",{className:"text-muted-foreground font-mono",children:[p.toFixed(1),""]})]}),e.jsxs("div",{ref:v,className:"relative h-8 cursor-pointer touch-none rounded-full",style:{background:"linear-gradient(to right, oklch(0.6 0.25 0), oklch(0.6 0.25 60), oklch(0.6 0.25 120), oklch(0.6 0.25 180), oklch(0.6 0.25 240), oklch(0.6 0.25 300), oklch(0.6 0.25 360))"},onMouseDown:M,onTouchStart:A,children:[y.map((_,O)=>e.jsx("div",{className:"absolute top-0 h-full w-0.5 bg-black/30",style:{left:`${_/360*100}%`},title:r("onboarding:theme.usedColor")},O)),e.jsx("div",{className:"absolute top-1/2 -translate-x-1/2 -translate-y-1/2",style:{left:`${p/360*100}%`},children:e.jsx("div",{className:"size-6 rounded-full border-2 border-white shadow-md",style:{backgroundColor:`oklch(0.6 0.25 ${p})`}})})]})]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-3",children:C.map(_=>{const O=Math.abs(p-_.hue)<.5,G=_.weight<.5;return e.jsx("button",{type:"button",onClick:()=>g(_.hue),className:R("relative size-10 rounded-full transition-all","ring-offset-background focus-visible:ring-ring focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:outline-none",O&&"ring-primary ring-2 ring-offset-2",G&&"opacity-50"),style:{backgroundColor:_.color},title:r(_.nameKey),children:O&&e.jsx(xe,{className:"absolute inset-0 m-auto size-5 text-white drop-shadow-md"})},_.hue)})})]}),t==="edit-only"?e.jsx(q,{className:"w-full",onClick:E,disabled:!x.trim(),"data-testid":"theme-complete-button",style:{"--primary-hue":p,"--primary":`oklch(var(--primary-lightness) var(--primary-saturation) ${p})`},children:r("common:confirm")}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx(q,{variant:"outline",className:"flex-1",onClick:k,children:r("common:cancel")}),e.jsx(q,{className:"flex-1",onClick:P,disabled:!x.trim(),style:{"--primary-hue":p,"--primary":`oklch(var(--primary-lightness) var(--primary-saturation) ${p})`},children:r("common:save")})]})]}):e.jsxs("div",{className:"flex justify-center gap-8",children:[e.jsxs("button",{onClick:T,className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"bg-primary/10 text-primary group-hover:bg-primary/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:e.jsx(Mf,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:r("wallet:detail.editName")})]}),e.jsxs("button",{onClick:z,className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"bg-primary/10 text-primary group-hover:bg-primary/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:e.jsx(Ba,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:r("wallet:detail.exportMnemonic")})]}),e.jsxs("button",{onClick:D,className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"bg-destructive/10 text-destructive group-hover:bg-destructive/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:e.jsx(qt,{className:"size-5"})}),e.jsx("span",{className:"text-destructive text-xs font-medium",children:r("wallet:detail.deleteWallet")})]})]})]})}Fn.__docgenInfo={description:`
- default: + edit
- edit:  default  default
- edit-only: / onEditOnlyComplete`,methods:[],displayName:"WalletConfig",props:{mode:{required:!0,tsType:{name:"union",raw:"'edit-only' | 'default' | 'edit'",elements:[{name:"literal",value:"'edit-only'"},{name:"literal",value:"'default'"},{name:"literal",value:"'edit'"}]},description:""},walletId:{required:!0,tsType:{name:"string"},description:""},onEditOnlyComplete:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};export{Ad as A,rd as C,Wl as D,kf as I,Ul as L,Pd as M,_d as N,$l as R,Ne as S,fd as T,od as V,Fn as W,Yd as a,ud as b,ld as c,Jl as d,vs as e,lr as f,Pl as g};
