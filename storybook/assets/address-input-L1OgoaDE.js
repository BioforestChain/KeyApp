import{r as n,u as H,j as e}from"./iframe-BuDZgClS.js";import{c as g}from"./utils-4perknFd.js";import{C as _}from"./contact-avatar-D4BM-nrZ.js";import{c as J}from"./web-DI_ANFt8.js";import{i as Y,b as Z}from"./avatar-codec-DtksUyoH.js";import{b as P,c as ee}from"./user-profile-6LXEY8Dx.js";import"./service-Djioy5S5.js";import{A as te}from"./address-display-BD-jr4tD.js";import{u as se}from"./useTranslation-CwjW3P5e.js";import{I as ne}from"./IconX-viUyieuq.js";import{I as ae}from"./IconWallet-QkgljjQk.js";import{I as re}from"./IconPencil-5j4BDSoD.js";import{c as A}from"./createReactComponent-CCT_KxSw.js";const oe=[["path",{d:"M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h3m9 -9v-5a2 2 0 0 0 -2 -2h-2",key:"svg-0"}],["path",{d:"M13 17v-1a1 1 0 0 1 1 -1h1m3 0h1a1 1 0 0 1 1 1v1m0 3v1a1 1 0 0 1 -1 1h-1m-3 0h-1a1 1 0 0 1 -1 -1v-1",key:"svg-1"}],["path",{d:"M9 3m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v0a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z",key:"svg-2"}]],ie=A("outline","clipboard-copy","ClipboardCopy",oe);const de=[["path",{d:"M4 8v-2a2 2 0 0 1 2 -2h2",key:"svg-0"}],["path",{d:"M4 16v2a2 2 0 0 0 2 2h2",key:"svg-1"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v2",key:"svg-2"}],["path",{d:"M16 20h2a2 2 0 0 0 2 -2v-2",key:"svg-3"}],["path",{d:"M7 12h10",key:"svg-4"}]],ce=A("outline","line-scan","LineScan",de);const le=[["path",{d:"M9 7m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2",key:"svg-1"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"svg-2"}],["path",{d:"M21 21v-2a4 4 0 0 0 -3 -3.85",key:"svg-3"}]],ue=A("outline","users","Users",le);function R(a){return a.label||""}function me(a){return!!(!a||a.startsWith("0x")&&a.length===42||a.startsWith("T")&&a.length===34||(a.startsWith("1")||a.startsWith("3")||a.startsWith("bc1"))&&a.length>=26||a.length>=20)}const W=n.forwardRef(({value:a="",onChange:l,onScan:I,onPaste:$,onContactPicker:T,error:M,label:S,className:B,chainType:j,showSuggestions:b=!0,maxSuggestions:D=5,...L},p)=>{const[y,u]=n.useState(!1),[K,k]=n.useState(a),[w,m]=n.useState(!1),[i,N]=n.useState(-1),C=n.useRef(null),d=n.useRef(null),{t:c}=se("common"),V=n.useId(),z=n.useId(),f=H(ee),E=f.contacts.length>0,r=a||K,U=me(r),h=!!(M||!U&&r),q=!y&&r&&!h;n.useEffect(()=>{typeof p=="function"?p(d.current):p&&(p.current=d.current)},[p]);const x=n.useMemo(()=>r?P.getContactByAddress(f,r):null,[f,r]),o=n.useMemo(()=>b?P.suggestContacts(f,r||"",D).map(s=>({...s,isValidForCurrentChain:j?Y(s.matchedAddress.address,j):!0})):[],[f,r,j,b,D]);n.useEffect(()=>{y&&b&&(o.length>0||E)?(m(!0),N(-1)):m(!1)},[y,o.length,E,b]),n.useEffect(()=>{const t=s=>{C.current&&!C.current.contains(s.target)&&m(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const O=t=>{const s=t.target.value.trim();k(s),l?.(s)},Q=async()=>{try{const s=(await J.read()).trim();k(s),l?.(s),$?.(),d.current?.focus()}catch{}},F=n.useCallback(t=>{k(t.matchedAddress.address),l?.(t.matchedAddress.address),m(!1),u(!1)},[l]),X=n.useCallback(()=>{k(""),l?.(""),d.current?.focus()},[l]),G=t=>{if(!(!w||o.length===0))switch(t.key){case"ArrowDown":t.preventDefault(),N(s=>s<o.length-1?s+1:s);break;case"ArrowUp":t.preventDefault(),N(s=>s>0?s-1:-1);break;case"Enter":i>=0&&o[i]&&o[i].isValidForCurrentChain&&(t.preventDefault(),F(o[i]));break;case"Escape":m(!1);break}};return e.jsxs("div",{ref:C,className:g("@container space-y-2",B),children:[S&&e.jsx("label",{className:"block text-sm font-medium",children:S}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:g("bg-background relative flex items-center gap-2 rounded-xl border p-2 transition-colors @xs:gap-3 @xs:p-3",y?"border-primary ring-primary/20 ring-2":"border-input",h&&"border-destructive ring-destructive/20 ring-2"),onClick:()=>{q&&(u(!0),setTimeout(()=>d.current?.focus(),0))},children:x?e.jsxs(e.Fragment,{children:[e.jsx(_,{src:x.contact.avatar||Z(x.matchedAddress.address),size:40,className:"shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"truncate text-sm font-medium",children:x.contact.name}),e.jsx("p",{className:"text-muted-foreground truncate font-mono text-xs",children:x.matchedAddress.address})]}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),X()},className:"text-muted-foreground hover:text-foreground hover:bg-muted/50 shrink-0 rounded-lg p-1.5 transition-colors","aria-label":c("a11y.clear"),children:e.jsx(ne,{className:"size-5"})})]}):q?e.jsxs("div",{className:"group flex h-10 w-full cursor-text items-center justify-between gap-2 overflow-hidden hover:opacity-80 transition-opacity",tabIndex:0,role:"button",onFocus:()=>{u(!0),setTimeout(()=>d.current?.focus(),0)},onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&(u(!0),setTimeout(()=>d.current?.focus(),0))},children:[e.jsx("div",{className:"bg-muted flex size-10 shrink-0 items-center justify-center rounded-full",children:e.jsx(ae,{className:"text-muted-foreground size-5"})}),e.jsx("div",{className:"min-w-0 flex-1",children:e.jsx(te,{address:r,copyable:!1,className:"w-full text-sm"})}),e.jsx(re,{className:"text-muted-foreground/50 group-hover:text-muted-foreground size-4 shrink-0 transition-colors"})]}):e.jsxs(e.Fragment,{children:[e.jsx("input",{ref:d,type:"text","data-testid":"address-input",value:r,onChange:O,onFocus:()=>u(!0),onBlur:()=>setTimeout(()=>u(!1),200),onKeyDown:G,className:"placeholder:text-muted-foreground min-w-0 flex-1 bg-transparent font-mono text-sm outline-none",placeholder:c("addressPlaceholder"),autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1,"aria-invalid":h,"aria-describedby":h?V:void 0,"aria-expanded":w,"aria-controls":w?z:void 0,"aria-activedescendant":i>=0?`suggestion-${i}`:void 0,role:"combobox",...L}),e.jsxs("div",{className:"flex items-center",children:[I&&e.jsx("button",{type:"button","data-testid":"scan-address-button",onClick:t=>{t.stopPropagation(),I()},className:"text-muted-foreground hover:text-foreground hover:bg-muted/50 rounded-lg p-1.5 transition-colors @xs:p-2","aria-label":c("a11y.scanQrCode"),children:e.jsx(ce,{className:"size-5"})}),e.jsxs("button",{type:"button",onClick:t=>{t.stopPropagation(),Q()},className:"text-muted-foreground hover:text-foreground hover:bg-muted/50 @xs:text-primary @xs:hover:text-primary/80 rounded-lg p-1.5 transition-colors @xs:px-3 @xs:py-1.5 @xs:text-sm @xs:font-medium @xs:hover:bg-transparent","aria-label":c("a11y.paste"),children:[e.jsx(ie,{className:"size-5 @xs:hidden"}),e.jsx("span",{className:"hidden @xs:inline",children:c("paste")})]})]})]})}),w&&e.jsxs("div",{id:z,className:"bg-popover border-border absolute z-50 mt-1 w-full overflow-hidden rounded-xl border shadow-lg",children:[o.length>0?e.jsx("ul",{role:"listbox",children:o.map((t,s)=>{const v=!t.isValidForCurrentChain;return e.jsxs("li",{id:`suggestion-${s}`,role:"option","aria-selected":s===i,"aria-disabled":v,className:g("flex items-center gap-3 px-3 py-2 transition-colors",v?"opacity-50 cursor-not-allowed":s===i?"bg-accent cursor-pointer":"hover:bg-muted/50 cursor-pointer"),onClick:()=>!v&&F(t),children:[e.jsx(_,{src:t.contact.avatar,size:32,className:"shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"truncate text-sm font-medium",children:t.contact.name}),e.jsx("p",{className:g("truncate font-mono text-xs",v?"text-muted-foreground/50":"text-muted-foreground"),children:t.matchedAddress.address})]}),R(t.matchedAddress)&&e.jsx("span",{className:g("max-w-[4rem] shrink-0 truncate text-xs",v?"text-muted-foreground/50":"text-muted-foreground"),children:R(t.matchedAddress)})]},`${t.contact.id}-${t.matchedAddress.id}`)})}):e.jsx("div",{className:"text-muted-foreground px-3 py-4 text-center text-sm",children:c("contact.noContacts")}),T&&e.jsxs("button",{type:"button",onClick:()=>{m(!1),T()},className:"text-primary hover:bg-muted/50 border-border flex w-full items-center justify-center gap-2 border-t px-3 py-2.5 text-sm font-medium transition-colors",children:[e.jsx(ue,{className:"size-4"}),c("contact.viewAll")]})]})]}),h&&e.jsx("p",{id:V,className:"text-destructive -mt-0.5 text-xs",role:"alert","aria-live":"polite","aria-atomic":"true",children:M||c("a11y.invalidAddress")})]})});W.displayName="AddressInput";W.__docgenInfo={description:"",methods:[],displayName:"AddressInput",props:{value:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"",defaultValue:{value:"''",computed:!1}},onChange:{required:!1,tsType:{name:"union",raw:"((value: string) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},onScan:{required:!1,tsType:{name:"union",raw:"(() => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},onPaste:{required:!1,tsType:{name:"union",raw:"(() => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},onContactPicker:{required:!1,tsType:{name:"union",raw:"(() => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:"Callback to open contact picker"},error:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},label:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},chainType:{required:!1,tsType:{name:"union",raw:"ChainType | undefined",elements:[{name:"ChainType"},{name:"undefined"}]},description:"Chain type to filter contact addresses"},showSuggestions:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"Enable contact suggestions dropdown",defaultValue:{value:"true",computed:!1}},maxSuggestions:{required:!1,tsType:{name:"union",raw:"number | undefined",elements:[{name:"number"},{name:"undefined"}]},description:"Maximum suggestions to show (default: 5)",defaultValue:{value:"5",computed:!1}}},composes:["Omit"]};export{W as A,ce as I,me as i};
