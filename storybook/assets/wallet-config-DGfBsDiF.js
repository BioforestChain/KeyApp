const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./snapdom-CO8q8LPW.js","./preload-helper-PPVm8Dsz.js","./index-CkyK164j.js","./iframe-CtUqWLzc.js","./iframe-DDLhkRVc.css","./service-0SsM670I.js","./schemas-CO8_C8zP.js","./index-D0E7N0oa.js","./derivation-L4TIyYgn.js","./amount-BQsqQYGO.js","./bioforest-Dm8Qyfpp.js"])))=>i.map(i=>d[i]);
import{g as au,r as d,j as e,R as ja,u as we,S as ru,aj as Fi,ak as _n,q as ge,al as Ft,w as $i,am as iu,x as ur}from"./iframe-CtUqWLzc.js";import{a as Mn,c as R}from"./utils-4perknFd.js";import{u as qi,d as ia,W as ou}from"./useWalletTheme-DGpimilr.js";import{W as cu,u as Hi}from"./wallet-card-carousel-Eu_tbptX.js";import{W as Ui}from"./wallet-card-yQJkXuEU.js";import{B as q}from"./button-BNQv8uul.js";import{f as fe,e as as,W as Rn,g as Ln,c as ks,a as Ss,b as Na,w as Ce,d as Bs,u as wa,h as lu,i as du,j as Xt}from"./user-profile-CDRPtg6G.js";import{h as uu,u as st,a as Je,c as As,j as $t,d as Os,e as mr,k as Ca,l as mu,m as fu,n as pu,o as hu,f as Gt,p as Ws,q as xu}from"./service-0SsM670I.js";import{u as gu,a as vu,b as yt,c as Ae,d as zn,e as Be,f as ka,g as Vi,p as yu,T as bu}from"./TabBar-0eoFFSL1.js";import{s as gs}from"./index-D0E7N0oa.js";import{g as ju,v as Ji,R as Nu,I as wu,a as Cu,b as ku,c as Su}from"./recover-wallet-form-D2a18VOn.js";import{S as Au}from"./swiper-sync-context-B9nB41DG.js";import{h as Iu,c as Tu,W as Pu,C as Sa,s as Lt}from"./token-item-ikzMpb0D.js";import{L as Se,G as ze,A as zt,P as ct,I as Fs,b as $n}from"./LoadingSpinner-CThpDbO_.js";import{u as B}from"./useTranslation-CJoXfpZJ.js";import{I as _e}from"./IconAlertTriangle-BND1G0Ll.js";import{I as qt}from"./IconTrash-_4YC5v1V.js";import{c as Aa,I as Ki}from"./web-Iwva3Zqr.js";import{t as Eu}from"./web-Cd0V0FW-.js";import{B as ss,k as Re,E as Mt,q as Ge,F as _u,G as Mu,H as Ru}from"./derivation-L4TIyYgn.js";import{p as dt,g as Gi,n as ms,a as Lu}from"./notification-C9xz3Xlc.js";import{g as Pe,N as Qi,o as zu,q as Dt,u as fr,I as Du}from"./index-CkyK164j.js";import"./breakpoint-DQ_qwb34.js";import{T as Yi}from"./transaction-item-DMR7S8_p.js";import{A as ne}from"./amount-BQsqQYGO.js";import{I as nt}from"./IconPlus-BleJRwB_.js";import{c as ie}from"./createReactComponent-CBZhxdaG.js";import{I as pn,b as Xi,c as qn,d as Dn,e as Bu,g as Ou,f as Wu,h as Fu}from"./transaction-meta-D3FPUGD3.js";import{I as $u,i as qu,A as Hu}from"./address-input-ClyiJy6Y.js";import{A as At}from"./amount-display-BX679Aq3.js";import"./animated-number-bOZEnqkR.js";import{T as Uu}from"./time-display-nV7u3_kH.js";import{F as Vu,E as Zi,S as Ju,C as pr}from"./service-status-alert-C4f18H5D.js";import{e as Bt,I as Ia,H as je,u as Ku,l as eo,J as Gu,K as Qu,T as Yu,L as Xu,M as Zu,N as hr,d as em,O as xr,P as gr,Q as vr,R as yr,S as br,U as jr,V as Nr,W as wr,X as Cr,Y as kr,Z as Sr,_ as tm,$ as sm}from"./index-DZbFmOUq.js";import{b as Ta,i as Pa,l as Ye,o as Is,n as Ot,s as U,c as Ze,a as Xe,j as ls}from"./schemas-CO8_C8zP.js";import{I as nm,a as am}from"./my-apps-page-3SFnZdEU.js";import{E as rm,c as Ht}from"./ecosystem-desktop-g_td3mB2.js";import"./miniapp-splash-screen-CzBYpw_t.js";import"./swiper-fJnGXoiL.js";/* empty css                     */import{_ as ht}from"./preload-helper-PPVm8Dsz.js";import{P as V}from"./page-header-DTWGpH2G.js";import{C as ds,I as im}from"./contact-avatar-CtkeeEIA.js";import{I as Te}from"./IconChevronRight-B_xrgHC2.js";import{S as ut,a as mt,b as ft,c as pt,u as om,f as cm,D as lm,g as dm,h as um,i as mm,j as fm,k as pm,l as hm,m as xm,n as gm}from"./sheet-Cs2YKeBv.js";import{I as he}from"./IconCheck-D8ZutlgY.js";import{C as xt,a as Ea}from"./chain-icon-CtTU1ZV5.js";import{p as gt,P as Ut}from"./pattern-lock-D9VgjZUs.js";import{P as hn}from"./password-input-6Rh-tLAZ.js";import{I as $s}from"./IconLock-Dly7oz8K.js";import{I as vt}from"./IconAlertCircle-C-FqCuW5.js";import{F as _a}from"./fee-display-Cf03TBlc.js";import{T as to}from"./tx-status-display-gJZr2IBR.js";import{I as De}from"./input-DXYnnL41.js";import{b as Rt,i as vm,d as ym}from"./avatar-codec-Bct8CGiW.js";import{I as Vt}from"./IconRefresh-7igsIl24.js";import{I as qs}from"./IconSearch-BnTCm2Rz.js";import{I as Hs}from"./IconDownload--rI8aVuE.js";import{W as bm,r as jm}from"./wallet-mini-card-BuC7v--x.js";import{I as Nm,W as wm}from"./wallet-list-P7bGLbzI.js";import{C as so}from"./checkbox-C59SNW_M.js";import{I as no,S as Ts,a as Ps,b as Es,c as _s,d as Wt,A as ao}from"./asset-selector-Cn5FV0-4.js";import{I as ro}from"./IconChevronDown-DVUyIil7.js";import{p as io,g as Ma}from"./qr-parser-C9_uOjrS.js";import{c as oo}from"./index-hhSMNAxF.js";import{g as Cm,a as km,b as Sm}from"./scanner-validators-YRGmuXyx.js";import{I as Us}from"./IconX-y3Cbcg2d.js";import{I as Ra}from"./IconWallet-BqhX2hS0.js";import{C as La}from"./contact-card-CKVZSpcM.js";import{I as ke}from"./IconLoader2-BJ5D5p7D.js";import{g as Bn,n as Am,p as Im}from"./index-DRQXAVdd.js";import{a as cn,c as ln,s as dn,i as Tm}from"./bioforest-Dm8Qyfpp.js";import{I as Pm}from"./IconApps-CVPLLe8h.js";import{I as co}from"./IconShieldCheck-DMDjPVGe.js";import{A as Pt}from"./address-display-CVYA6ti-.js";import{I as za}from"./IconEye-A8hJnH13.js";import{M as lo}from"./mnemonic-display-DM-xl5xu.js";import{P as Da}from"./pattern-lock-setup-E-RP0lAY.js";import{g as uo,C as Ba}from"./chain-selector-CmH5zyvk.js";import{deriveWalletChainAddresses as mo}from"./index-URPNapM4.js";import{I as fo}from"./IconEyeOff-B1K4B_9z.js";import{I as us}from"./IconCircleCheck-DgSDZ9qj.js";import"./asset-item-CqHeGWQn.js";import"./asset-list-Cl-YyTbJ.js";import{A as po}from"./amount-input-tJHmmnTj.js";import{B as Em}from"./balance-display-Dc8aIYXD.js";import{S as _m,I as ho}from"./send-result-Dp4L0sKF.js";import{d as Mm}from"./useRenderElement-BsBJydIk.js";import{T as xo}from"./Trans-D9fHLTBV.js";import{M as Rm}from"./mnemonic-input-ZXTuayYe.js";import{T as go}from"./transaction-list-D0q8Ho_2.js";import{T as Lm}from"./transaction-status-BFLEM1Im.js";import{I as oa}from"./IconExternalLink-C4UV5a3N.js";import{A as vo}from"./AppInfoCard-BJ9ISTPU.js";import{P as zm}from"./PermissionList-B801GOSW.js";import{W as Dm}from"./wallet-selector-BybYdlR3.js";import{T as et}from"./token-icon-BbM1PrEB.js";import{T as Ar}from"./TransactionDetails-C4YP63yF.js";import{B as Ir}from"./BalanceWarning-BHN2QjDw.js";import{K as Bm}from"./key-type-selector-DN_7EWyV.js";import{A as Om}from"./arbitrary-key-input-BZ_z1gbZ.js";import{C as Wm}from"./chain-address-preview-DOTc56Uw.js";import{C as Fm}from"./collision-confirm-dialog-Chgs4QW0.js";import{I as $m}from"./dropdown-menu-BclVMdcg.js";import"./hologram-canvas-DIagU4Re.js";import{I as qm}from"./IconPencil-BdCVl-2h.js";import{I as Hm}from"./IconBell-GbtZ-QGh.js";import{I as Um}from"./IconCircleX-BUfWgV8K.js";import{I as Vm}from"./IconClock-BYESEJyJ.js";import{I as Jm}from"./IconShield-CJoAx5u0.js";const Km=[["path",{d:"M20 6v12a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2z",key:"svg-0"}],["path",{d:"M10 16h6",key:"svg-1"}],["path",{d:"M13 11m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-2"}],["path",{d:"M4 8h3",key:"svg-3"}],["path",{d:"M4 12h3",key:"svg-4"}],["path",{d:"M4 16h3",key:"svg-5"}]],Gm=ie("outline","address-book","AddressBook",Km);const Qm=[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 15h10.55",key:"svg-1"}],["path",{d:"M6.551 4.938l3.26 10.034",key:"svg-2"}],["path",{d:"M17.032 4.636l-8.535 6.201",key:"svg-3"}],["path",{d:"M20.559 14.51l-8.535 -6.201",key:"svg-4"}],["path",{d:"M12.257 20.916l3.261 -10.034",key:"svg-5"}]],yo=ie("outline","aperture","Aperture",Qm);const Ym=[["path",{d:"M17 7l-10 10",key:"svg-0"}],["path",{d:"M16 17l-9 0l0 -9",key:"svg-1"}]],Xm=ie("outline","arrow-down-left","ArrowDownLeft",Ym);const Zm=[["path",{d:"M7 7l10 10",key:"svg-0"}],["path",{d:"M17 8l0 9l-9 0",key:"svg-1"}]],ef=ie("outline","arrow-down-right","ArrowDownRight",Zm);const tf=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M13 18l6 -6",key:"svg-1"}],["path",{d:"M13 6l6 6",key:"svg-2"}]],bo=ie("outline","arrow-right","ArrowRight",tf);const sf=[["path",{d:"M17 7l-10 10",key:"svg-0"}],["path",{d:"M8 7l9 0l0 9",key:"svg-1"}]],jo=ie("outline","arrow-up-right","ArrowUpRight",sf);const nf=[["path",{d:"M3 12h1m8 -9v1m8 8h1m-15.4 -6.4l.7 .7m12.1 -.7l-.7 .7",key:"svg-0"}],["path",{d:"M9 16a5 5 0 1 1 6 0a3.5 3.5 0 0 0 -1 3a2 2 0 0 1 -4 0a3.5 3.5 0 0 0 -1 -3",key:"svg-1"}],["path",{d:"M9.7 17l4.6 0",key:"svg-2"}]],No=ie("outline","bulb","Bulb",nf);const af=[["path",{d:"M5 7h1a2 2 0 0 0 2 -2a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1a2 2 0 0 0 2 2h1a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-9a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M9 13a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-1"}]],rf=ie("outline","camera","Camera",af);const of=[["path",{d:"M14 10m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-0"}],["path",{d:"M21 12a9 9 0 1 1 -18 0a9 9 0 0 1 18 0z",key:"svg-1"}],["path",{d:"M12.5 11.5l-4 4l1.5 1.5",key:"svg-2"}],["path",{d:"M12 15l-1.5 -1.5",key:"svg-3"}]],Oa=ie("outline","circle-key","CircleKey",of);const cf=[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M14.8 9a2 2 0 0 0 -1.8 -1h-2a2 2 0 1 0 0 4h2a2 2 0 1 1 0 4h-2a2 2 0 0 1 -1.8 -1",key:"svg-1"}],["path",{d:"M12 7v10",key:"svg-2"}]],lf=ie("outline","coin","Coin",cf);const df=[["path",{d:"M16.7 8a3 3 0 0 0 -2.7 -2h-4a3 3 0 0 0 0 6h4a3 3 0 0 1 0 6h-4a3 3 0 0 1 -2.7 -2",key:"svg-0"}],["path",{d:"M12 3v3m0 12v3",key:"svg-1"}]],uf=ie("outline","currency-dollar","CurrencyDollar",df);const mf=[["path",{d:"M6 12l6 -9l6 9l-6 9z",key:"svg-0"}],["path",{d:"M6 12l6 -3l6 3l-6 2z",key:"svg-1"}]],ff=ie("outline","currency-ethereum","CurrencyEthereum",mf);const pf=[["path",{d:"M12 6m-8 0a8 3 0 1 0 16 0a8 3 0 1 0 -16 0",key:"svg-0"}],["path",{d:"M4 6v6a8 3 0 0 0 16 0v-6",key:"svg-1"}],["path",{d:"M4 12v6a8 3 0 0 0 16 0v-6",key:"svg-2"}]],wo=ie("outline","database","Database",pf);const hf=[["path",{d:"M3 5a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v10a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1v-10z",key:"svg-0"}],["path",{d:"M7 20h10",key:"svg-1"}],["path",{d:"M9 16v4",key:"svg-2"}],["path",{d:"M15 16v4",key:"svg-3"}]],xf=ie("outline","device-desktop","DeviceDesktop",hf);const gf=[["path",{d:"M3 3m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["circle",{cx:"8.5",cy:"8.5",r:".5",fill:"currentColor",key:"svg-1"}],["circle",{cx:"15.5",cy:"8.5",r:".5",fill:"currentColor",key:"svg-2"}],["circle",{cx:"15.5",cy:"15.5",r:".5",fill:"currentColor",key:"svg-3"}],["circle",{cx:"8.5",cy:"15.5",r:".5",fill:"currentColor",key:"svg-4"}],["circle",{cx:"12",cy:"12",r:".5",fill:"currentColor",key:"svg-5"}]],vf=ie("outline","dice-5","Dice5",gf);const yf=[["path",{d:"M4 4h16v2.172a2 2 0 0 1 -.586 1.414l-4.414 4.414v7l-6 2v-8.5l-4.48 -4.928a2 2 0 0 1 -.52 -1.345v-2.227z",key:"svg-0"}]],Co=ie("outline","filter","Filter",yf);const bf=[["path",{d:"M18.9 7a8 8 0 0 1 1.1 5v1a6 6 0 0 0 .8 3",key:"svg-0"}],["path",{d:"M8 11a4 4 0 0 1 8 0v1a10 10 0 0 0 2 6",key:"svg-1"}],["path",{d:"M12 11v2a14 14 0 0 0 2.5 8",key:"svg-2"}],["path",{d:"M8 15a18 18 0 0 0 1.8 6",key:"svg-3"}],["path",{d:"M4.9 19a22 22 0 0 1 -.9 -7v-1a8 8 0 0 1 12 -6.95",key:"svg-4"}]],jf=ie("outline","fingerprint","Fingerprint",bf);const Nf=[["path",{d:"M7 12h3v4h-3z",key:"svg-0"}],["path",{d:"M10 6h-6a1 1 0 0 0 -1 1v12a1 1 0 0 0 1 1h16a1 1 0 0 0 1 -1v-12a1 1 0 0 0 -1 -1h-6",key:"svg-1"}],["path",{d:"M10 3m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v3a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M14 16h2",key:"svg-3"}],["path",{d:"M14 12h4",key:"svg-4"}]],wf=ie("outline","id-badge-2","IdBadge2",Nf);const Cf=[["path",{d:"M9 6.371c0 4.418 -2.239 6.629 -5 6.629",key:"svg-0"}],["path",{d:"M4 6.371h7",key:"svg-1"}],["path",{d:"M5 9c0 2.144 2.252 3.908 6 4",key:"svg-2"}],["path",{d:"M12 20l4 -9l4 9",key:"svg-3"}],["path",{d:"M19.1 18h-6.2",key:"svg-4"}],["path",{d:"M6.694 3l.793 .582",key:"svg-5"}]],kf=ie("outline","language","Language",Cf);const Sf=[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]],ko=ie("outline","link","Link",Sf);const Af=[["path",{d:"M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z",key:"svg-0"}]],If=ie("outline","moon","Moon",Af);const Tf=[["path",{d:"M6 9a6 6 0 1 0 12 0a6 6 0 0 0 -12 0",key:"svg-0"}],["path",{d:"M12 3c1.333 .333 2 2.333 2 6s-.667 5.667 -2 6",key:"svg-1"}],["path",{d:"M12 3c-1.333 .333 -2 2.333 -2 6s.667 5.667 2 6",key:"svg-2"}],["path",{d:"M6 9h12",key:"svg-3"}],["path",{d:"M3 20h7",key:"svg-4"}],["path",{d:"M14 20h7",key:"svg-5"}],["path",{d:"M10 20a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-6"}],["path",{d:"M12 15v3",key:"svg-7"}]],Pf=ie("outline","network","Network",Tf);const Ef=[["path",{d:"M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25",key:"svg-0"}],["path",{d:"M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}],["path",{d:"M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-3"}]],_f=ie("outline","palette","Palette",Ef);const Mf=[["path",{d:"M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4",key:"svg-0"}],["path",{d:"M13.5 6.5l4 4",key:"svg-1"}],["path",{d:"M16 19h6",key:"svg-2"}]],Rf=ie("outline","pencil-minus","PencilMinus",Mf);const Lf=[["path",{d:"M4 4m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M7 17l0 .01",key:"svg-1"}],["path",{d:"M14 4m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M7 7l0 .01",key:"svg-3"}],["path",{d:"M4 14m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-4"}],["path",{d:"M17 7l0 .01",key:"svg-5"}],["path",{d:"M14 14l3 0",key:"svg-6"}],["path",{d:"M20 14l0 .01",key:"svg-7"}],["path",{d:"M14 14l0 3",key:"svg-8"}],["path",{d:"M14 20l3 0",key:"svg-9"}],["path",{d:"M17 17l3 0",key:"svg-10"}],["path",{d:"M20 17l0 3",key:"svg-11"}]],zf=ie("outline","qrcode","Qrcode",Lf);const Df=[["path",{d:"M10 14l11 -11",key:"svg-0"}],["path",{d:"M21 3l-6.5 18a.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a.55 .55 0 0 1 0 -1l18 -6.5",key:"svg-1"}]],So=ie("outline","send","Send",Df);const Bf=[["path",{d:"M8 9h-1a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-8a2 2 0 0 0 -2 -2h-1",key:"svg-0"}],["path",{d:"M12 14v-11",key:"svg-1"}],["path",{d:"M9 6l3 -3l3 3",key:"svg-2"}]],Of=ie("outline","share-2","Share2",Bf);const Wf=[["path",{d:"M6 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-0"}],["path",{d:"M18 6m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-1"}],["path",{d:"M18 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-2"}],["path",{d:"M8.7 10.7l6.6 -3.4",key:"svg-3"}],["path",{d:"M8.7 13.3l6.6 3.4",key:"svg-4"}]],Ms=ie("outline","share","Share",Wf);const Ff=[["path",{d:"M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7",key:"svg-1"}]],$f=ie("outline","sun","Sun",Ff);const qf=[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 9h16.8",key:"svg-1"}],["path",{d:"M3.6 15h16.8",key:"svg-2"}],["path",{d:"M11.5 3a17 17 0 0 0 0 18",key:"svg-3"}],["path",{d:"M12.5 3a17 17 0 0 1 0 18",key:"svg-4"}]],Ao=ie("outline","world","World",qf);function Wa(){return Aa}function at(){return Eu}function Vs(){return Iu}function Io(){return Tu}const xn={authorizeAddress:"/wallet/authorize/address",authorizeSignature:"/wallet/authorize/signature"};class Hf{constructor(s,n){this.adapter=s,this.eventId=n}hasResponded=!1;handleNetworkAddresses(s,n){const a=n.trim().toLowerCase();if(!a)return[];const r=[];for(const o of s)for(const c of o.chainAddresses)String(c.chain).toLowerCase()===a&&r.push({name:o.name,address:c.address,chainName:c.chain,publicKey:"",magic:`${o.id}:${c.chain}`,signMessage:""});return r}handleMainAddresses(s){return s.chainAddresses.map(n=>({name:s.name,address:n.address,chainName:n.chain,publicKey:"",magic:`${s.id}:${n.chain}`,signMessage:""}))}async handleMainAddressesSigned(s,n){const a=this.handleMainAddresses(s);return await this.applySensitiveOptions(a,[s],{password:n.password,signMessage:n.signMessage,getMain:!1})}handleAllAddresses(s){const n=[];for(const a of s)n.push(...this.handleMainAddresses(a));return n}async handleAllAddressesSigned(s,n){const a=this.handleAllAddresses(s);return await this.applySensitiveOptions(a,s,{password:n.password,signMessage:n.signMessage,getMain:!1})}async handleNetworkAddressesSigned(s,n,a){const r=this.handleNetworkAddresses(s,n);return await this.applySensitiveOptions(r,s,{password:a.password,signMessage:a.signMessage,getMain:!1})}async applySensitiveOptions(s,n,a){return await this.applyPasswordProtectedFields(s,n,a)}async approve(s){await this.respondOnce(xn.authorizeAddress,s)}async reject(s){await this.respondOnce(xn.authorizeAddress,null)}async respondOnce(s,n){if(!this.hasResponded){this.hasResponded=!0;try{await this.adapter.respondWith(this.eventId,s,n)}finally{await this.adapter.removeEventId(this.eventId)}}}async applyPasswordProtectedFields(s,n,a){const r=a.signMessage?.trim()??"",o=!!r,c=!!a.getMain;if(!o&&!c)return s;const i=new Map;for(const u of n)i.set(u.id,u);const l=new Map,m=new Set;for(const u of s){const f=this.getWalletIdFromMagic(u.magic),h=i.get(f),v=h?.encryptedMnemonic;if(!h||!v)throw new Error("Missing secret");const y=u.chainName.trim().toLowerCase();if(c){let p=l.get(f);if(!p){try{p=await ss(v,a.password)}catch{throw new Error("Invalid password")}l.set(f,p)}u.main=p}if(o){if(cn(y)){let p=l.get(f);if(!p){try{p=await ss(v,a.password)}catch{throw new Error("Invalid password")}l.set(f,p)}const x=ln(p),g=dn(r,x.secretKey);u.signMessage=`0x${Re(g)}`,u.publicKey=Re(x.publicKey);continue}if(!m.has(f))if(l.has(f))m.add(f);else{if(!await Mt(v,a.password))throw new Error("Invalid password");m.add(f)}u.signMessage=this.createDeterministicMockSignature({message:r,address:u.address,chainName:u.chainName})}}return s}getWalletIdFromMagic(s){const n=s.indexOf(":");return n===-1?s:s.slice(0,n)}createDeterministicMockSignature({message:s,address:n,chainName:a}){const r=new TextEncoder,o=Ge(r.encode(`address:${n}|chain:${a}|message:${s}`)),c=Ge(r.encode(`event:${this.eventId}`)),i=new Uint8Array(64);return i.set(o,0),i.set(c,32),`0x${Re(i)}`}}class Fa{constructor(s,n){this.adapter=s,this.eventId=n}hasResponded=!1;async approve(s){await this.respondOnce(xn.authorizeSignature,s)}async reject(s){await this.respondOnce(xn.authorizeSignature,null)}async handleMessageSign(s,n,a){const r=s.chainName.trim().toLowerCase();if(cn(r)){let c;try{c=await ss(n,a)}catch{throw new Error("Invalid password")}const i=ln(c),l=dn(s.message,i.secretKey);return{signature:`0x${Re(l)}`,publicKey:Re(i.publicKey)}}if(!await Mt(n,a))throw new Error("Invalid password");{const c=new TextEncoder,i=Ge(c.encode(`message:${s.message}`)),l=Ge(c.encode(`event:${this.eventId}`)),m=new Uint8Array(64);m.set(i,0),m.set(l,32);const u=Ge(c.encode(`pubkey:${s.senderAddress}`));return{signature:`0x${Re(m)}`,publicKey:Re(u)}}}async handleTransferSign(s,n,a){const r=s.chainName.trim().toLowerCase(),o=["transfer",r,s.senderAddress,s.receiveAddress,s.balance,s.fee??"",s.contractInfo?.assetType??s.assetType??"",s.contractInfo?.contractAddress??"",s.contractInfo?.decimals?.toString()??""].join("|");if(cn(r)){let f;try{f=await ss(n,a)}catch{throw new Error("Invalid password")}const h=ln(f),v=dn(o,h.secretKey);return`0x${Re(v)}`}if(!await Mt(n,a))throw new Error("Invalid password");const i=new TextEncoder,l=Ge(i.encode(o)),m=Ge(i.encode(`event:${this.eventId}`)),u=new Uint8Array(64);return u.set(l,0),u.set(m,32),`0x${Re(u)}`}async handleDestroySign(s,n,a){const r=s.chainName.trim().toLowerCase(),o=["destory",r,s.senderAddress,s.destoryAddress,s.destoryAmount,s.fee??"",s.assetType??""].join("|");if(cn(r)){let f;try{f=await ss(n,a)}catch{throw new Error("Invalid password")}const h=ln(f),v=dn(o,h.secretKey);return`0x${Re(v)}`}if(!await Mt(n,a))throw new Error("Invalid password");const i=new TextEncoder,l=Ge(i.encode(o)),m=Ge(i.encode(`event:${this.eventId}`)),u=new Uint8Array(64);return u.set(l,0),u.set(m,32),`0x${Re(u)}`}async respondOnce(s,n){if(!this.hasResponded){this.hasResponded=!0;try{await this.adapter.respondWith(this.eventId,s,n)}finally{await this.adapter.removeEventId(this.eventId)}}}}class Uf{async getCallerAppInfo(s){throw new Error("DWEB runtime not available in web environment")}async respondWith(s,n,a){throw new Error("DWEB runtime not available in web environment")}async removeEventId(s){}isAvailable(){return!1}}const rs=new Uf,Vf={"zh-CN":gs.wordlists.chinese_simplified,"zh-TW":gs.wordlists.chinese_traditional,ja:gs.wordlists.japanese,ko:gs.wordlists.korean},Jf=["zh-CN","zh-TW","ja","ko"];function gn(t){const s=Vf[t]??gs.wordlists.english,n=s[Math.floor(Math.random()*s.length)];return Jf.includes(t)?n:n.charAt(0).toUpperCase()+n.slice(1)}function Kf(){return typeof window>"u"}function Xs(){return!Kf()}function Gf(){const t={value:null};function s(){return t.value}function n(a){t.value=a}return[s,n]}var Hn,Tr;function Qf(){if(Tr)return Hn;Tr=1;var t=typeof Element<"u",s=typeof Map=="function",n=typeof Set=="function",a=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function r(o,c){if(o===c)return!0;if(o&&c&&typeof o=="object"&&typeof c=="object"){if(o.constructor!==c.constructor)return!1;var i,l,m;if(Array.isArray(o)){if(i=o.length,i!=c.length)return!1;for(l=i;l--!==0;)if(!r(o[l],c[l]))return!1;return!0}var u;if(s&&o instanceof Map&&c instanceof Map){if(o.size!==c.size)return!1;for(u=o.entries();!(l=u.next()).done;)if(!c.has(l.value[0]))return!1;for(u=o.entries();!(l=u.next()).done;)if(!r(l.value[1],c.get(l.value[0])))return!1;return!0}if(n&&o instanceof Set&&c instanceof Set){if(o.size!==c.size)return!1;for(u=o.entries();!(l=u.next()).done;)if(!c.has(l.value[0]))return!1;return!0}if(a&&ArrayBuffer.isView(o)&&ArrayBuffer.isView(c)){if(i=o.length,i!=c.length)return!1;for(l=i;l--!==0;)if(o[l]!==c[l])return!1;return!0}if(o.constructor===RegExp)return o.source===c.source&&o.flags===c.flags;if(o.valueOf!==Object.prototype.valueOf&&typeof o.valueOf=="function"&&typeof c.valueOf=="function")return o.valueOf()===c.valueOf();if(o.toString!==Object.prototype.toString&&typeof o.toString=="function"&&typeof c.toString=="function")return o.toString()===c.toString();if(m=Object.keys(o),i=m.length,i!==Object.keys(c).length)return!1;for(l=i;l--!==0;)if(!Object.prototype.hasOwnProperty.call(c,m[l]))return!1;if(t&&o instanceof Element)return!1;for(l=i;l--!==0;)if(!((m[l]==="_owner"||m[l]==="__v"||m[l]==="__o")&&o.$$typeof)&&!r(o[m[l]],c[m[l]]))return!1;return!0}return o!==o&&c!==c}return Hn=function(c,i){try{return r(c,i)}catch(l){if((l.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw l}},Hn}var Yf=Qf();const ys=au(Yf);function To(t){const s=d.useRef(t),n=s.current,a=ys(n,t);return d.useEffect(()=>{a||(s.current=t)},[t]),a?n:t}var $a=d.createContext(null),Po=({children:t,value:s})=>e.jsx($a.Provider,{value:To(s),children:t});Po.displayName="ActivityProvider";var Xf=()=>d.useContext($a);function Zf(){return d.useContext($a).params}var Eo=d.createContext(null),_o=({children:t,value:s})=>e.jsx(Eo.Provider,{value:To(s),children:t});_o.displayName="StackProvider";var ep=()=>d.useContext(Eo),tp=Object.defineProperty,sp=Object.defineProperties,np=Object.getOwnPropertyDescriptors,vn=Object.getOwnPropertySymbols,Mo=Object.prototype.hasOwnProperty,Ro=Object.prototype.propertyIsEnumerable,Pr=(t,s,n)=>s in t?tp(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,me=(t,s)=>{for(var n in s||(s={}))Mo.call(s,n)&&Pr(t,n,s[n]);if(vn)for(var n of vn(s))Ro.call(s,n)&&Pr(t,n,s[n]);return t},xe=(t,s)=>sp(t,np(s)),ap=(t,s)=>{var n={};for(var a in t)Mo.call(t,a)&&s.indexOf(a)<0&&(n[a]=t[a]);if(t!=null&&vn)for(var a of vn(t))s.indexOf(a)<0&&Ro.call(t,a)&&(n[a]=t[a]);return n};function rp(t,s,n){const a=n(t),r=n(s);return a<r?-1:a===r?0:1}var ip=(t,s)=>{const n=[],a=[];return t.forEach(r=>{s(r)?n.push(r):a.push(r)}),[n,a]};function Lo(t,s){return t.map((n,a)=>s(n)?a:void 0).filter(n=>typeof n=="number")}var Un=0,Er=0,zo=()=>{const t=new Date().getTime();return Er===t?Un+=1:(Er=t,Un=0),(t*1e3+Un)/1e3};function Qe(){return(zo()*1e3).toString(16)}function On(t){return t.length===0?void 0:t[t.length-1]}function _r(t,s){const n=me({},t);return s.forEach(a=>{delete n[a]}),n}function op(t){let s=!1;return()=>{s||(s=!0,t())}}function cp(t,s){const n=new Map;return[...t].reverse().filter(a=>{const r=s(a);if(r===null)return!0;const o=!!n.get(r);return n.set(r,!0),!o}).reverse()}function ca(t){return!t.exitedBy}function la(t,s){return s.enteredBy.eventDate-t.enteredBy.eventDate}function Mr(t){return t.filter(ca).sort(la)[0]}function lp(t,s,n){const a=[];switch(s.name){case"Replaced":{if(On(Lo(t,l=>l.id===s.activityId))!==void 0)break;const o=t.slice().sort(la).filter(ca),c=n.now-s.eventDate>=n.transitionDuration;if((s.skipEnterActiveState||c?"enter-done":"enter-active")==="enter-done"){const l=o.findIndex(m=>!(s.skipEnterActiveState&&m.enteredBy.name==="Replaced"&&m.transitionState==="enter-active"));return o.slice(0,l+1).map(m=>t.indexOf(m))}break}case"Popped":{const r=t.filter(ca).sort(la),o=r.slice(0,r.length-1)[0];o&&a.push(t.indexOf(o));break}case"StepPushed":case"StepReplaced":{const r=Mr(t);if(r){if(s.targetActivityId&&s.targetActivityId!==r.id)break;a.push(t.indexOf(r))}break}case"StepPopped":{const r=Mr(t);if(r&&r.steps.length>1){if(s.targetActivityId&&s.targetActivityId!==r.id)break;a.push(t.indexOf(r))}break}}return a}function Rr(t,s){switch(s.name){case"Pushed":case"Replaced":{const n=On(Lo(t,a=>a.id===s.activityId));return n??t.length}default:return-1}}function Lr(t,s){return{id:t.activityId,name:t.activityName,transitionState:s,params:t.activityParams,context:t.activityContext,steps:[{id:t.activityId,params:t.activityParams,enteredBy:t,zIndex:-1}],enteredBy:t,isTop:!1,isActive:!1,isRoot:!1,zIndex:-1}}function qa(t){return(s,n)=>{const a=t[n.name].bind(t);if(a)return a(s,n);throw new Error(`No reducer for event ${JSON.stringify(n)}`)}}function rt(t){return t}function dp({transitionDuration:t,now:s,resumedAt:n}){return qa({Pushed(a,r){const o=s-(n??r.eventDate)>=t,c=r.skipEnterActiveState||o?"enter-done":"enter-active",i=Rr(a,r);return[...a.slice(0,i),Lr(r,c),...a.slice(i+1)]},Replaced(a,r){var o,c;const i=s-(n??r.eventDate)>=t,l=Rr(a,r),m=(c=(o=a[l])==null?void 0:o.transitionState)!=null?c:r.skipEnterActiveState||i?"enter-done":"enter-active";return[...a.slice(0,l),Lr(r,m),...a.slice(l+1)]},Initialized:rt,ActivityRegistered:rt,Popped:rt,StepPushed:rt,StepReplaced:rt,StepPopped:rt,Paused:rt,Resumed:rt})}function fs(t){return t}function up(t){return qa({Replaced:(s,n)=>xe(me({},s),{exitedBy:n,transitionState:"exit-done"}),Popped:(s,n)=>{var a;const r=t.now-((a=t.resumedAt)!=null?a:n.eventDate)>=t.transitionDuration,o=n.skipExitActiveState||r?"exit-done":"exit-active";return xe(me({},s),{exitedBy:n,transitionState:o,params:o==="exit-done"?s.steps[0].params:s.params,steps:o==="exit-done"?[s.steps[0]]:s.steps})},StepPushed:(s,n)=>{var a;const r={id:n.stepId,params:n.stepParams,enteredBy:n,zIndex:s.zIndex,hasZIndex:(a=n.hasZIndex)!=null?a:!1};return xe(me({},s),{params:n.stepParams,steps:[...s.steps,r]})},StepReplaced:(s,n)=>{var a;const r={id:n.stepId,params:n.stepParams,enteredBy:n,zIndex:s.zIndex,hasZIndex:(a=n.hasZIndex)!=null?a:!1};return xe(me({},s),{params:n.stepParams,steps:[...s.steps.slice(0,s.steps.length-1),r]})},StepPopped:(s,n)=>{var a;s.steps.pop();const r=(a=On(s.steps))==null?void 0:a.params;return xe(me({},s),{params:r??s.params})},Initialized:fs,ActivityRegistered:fs,Pushed:fs,Paused:fs,Resumed:fs})}function Ke(t){return(s,n)=>s.globalTransitionState==="paused"?xe(me({},s),{pausedEvents:s.pausedEvents?[...s.pausedEvents,n]:[n]}):t(s,n)}function Oe(t,s){return(n,a)=>{const r=dp({transitionDuration:n.transitionDuration,now:s.now,resumedAt:s.resumedAt}),o=up({transitionDuration:n.transitionDuration,now:s.now,resumedAt:s.resumedAt}),c=r(n.activities,a),i=lp(n.activities,a,{transitionDuration:n.transitionDuration,now:s.now});for(const u of i)c[u]=o(c[u],a);const l=c.find(u=>u.transitionState==="enter-active"||u.transitionState==="exit-active"),m=n.globalTransitionState==="paused"?"paused":l?"loading":"idle";return t(xe(me({},n),{activities:c,globalTransitionState:m}),a)}}function Qt(t,s){return xe(me({},t),{events:[...t.events,s]})}function Do(t){return qa({Initialized:Ke(Oe((s,n)=>xe(me({},s),{transitionDuration:n.transitionDuration,events:[...s.events,n]}),t)),ActivityRegistered:Ke(Oe((s,n)=>xe(me({},s),{registeredActivities:[...s.registeredActivities,me({name:n.activityName},n.activityParamsSchema?{paramsSchema:n.activityParamsSchema}:null)],events:[...s.events,n]}),t)),Paused:Ke(Oe((s,n)=>xe(me({},s),{globalTransitionState:"paused",events:[...s.events,n]}),t)),Resumed:Oe((s,n)=>{if(s.globalTransitionState!=="paused"||!s.pausedEvents)return xe(me({},s),{events:[...s.events,n]});const a=Do({now:t.now,resumedAt:n.eventDate}),r=s,{pausedEvents:o}=r,c=ap(r,["pausedEvents"]),i=o.reduce(a,xe(me({},c),{globalTransitionState:"idle"}));return xe(me({},i),{events:[...i.events,n]})},t),Pushed:Ke(Oe(Qt,t)),Replaced:Ke(Oe(Qt,t)),Popped:Ke(Oe(Qt,t)),StepPushed:Ke(Oe(Qt,t)),StepReplaced:Ke(Oe(Qt,t)),StepPopped:Ke(Oe(Qt,t))})}function Vn(t,s){return t.filter(n=>n.name===s)}function un(t,s){return xe(me({id:Qe(),eventDate:zo()},s),{name:t})}function mp(t){if(t.length===0)throw new Error("events parameter is empty");if(Vn(t,"Initialized").length>1)throw new Error("InitializedEvent can only exist once");const n=Vn(t,"ActivityRegistered"),a=new Set(n.map(o=>o.activityName));if(Vn(t,"Pushed").some(o=>!a.has(o.activityName)))throw new Error("the corresponding activity does not exist")}function Jn(t,s){const n=cp([...t].sort((u,f)=>u.eventDate-f.eventDate),u=>u.id);mp(n);const a=Do({now:s}),r=n.reduce(a,{activities:[],globalTransitionState:"idle",registeredActivities:[],transitionDuration:0,events:[]}),o=r.activities.filter(u=>u.transitionState==="enter-active"||u.transitionState==="enter-done"||u.transitionState==="exit-active"),c=o.filter(u=>u.transitionState==="enter-active"||u.transitionState==="enter-done"),i=o[o.length-1],l=c[c.length-1];return xe(me({},r),{activities:r.activities.map(u=>{let f=o.findIndex(({id:y})=>y===u.id);const h=o.slice(0,f);for(const y of h)for(const p of y.steps)p.hasZIndex&&(f+=1);const v=u.steps.reduce((y,p)=>{var x;const g=On(y),j=(x=g?.zIndex)!=null?x:f;return[...y,xe(me({},p),{zIndex:j+(p.hasZIndex?1:0)})]},[]);return me(me({id:u.id,name:u.name,transitionState:u.transitionState,params:u.params,steps:v,enteredBy:u.enteredBy,zIndex:f,isTop:i?.id===u.id,isActive:l?.id===u.id,isRoot:f===0||f===1&&u.transitionState==="enter-active"&&u.enteredBy.name==="Replaced"},u.exitedBy?{exitedBy:u.exitedBy}:null),u.context?{context:u.context}:null)}).sort((u,f)=>rp(u,f,h=>h.id))})}function fp(t,s){var n,a,r,o,c,i,l,m;const u=[];!ys(t,s)&&u.push({_TAG:"%SOMETHING_CHANGED%"});const h=t.globalTransitionState!=="paused"&&s.globalTransitionState==="paused",v=t.globalTransitionState==="paused"&&s.globalTransitionState!=="paused";h&&u.push({_TAG:"PAUSED"}),v&&u.push({_TAG:"RESUMED"});for(let y=0;y<Math.max(t.activities.length,s.activities.length);y+=1){const p=t.activities[y],x=s.activities[y],g=p?.transitionState==="exit-done"||p?.transitionState==="exit-active",j=x?.transitionState==="enter-active"||x?.transitionState==="enter-done";if(p&&x&&p.id===x.id)for(let N=0;N<Math.max(((n=p.steps)!=null?n:[]).length,((a=x.steps)!=null?a:[]).length);N+=1){const b=p.steps[N],S=x.steps[N];!b&&S?u.push({_TAG:"STEP_PUSHED",activity:x,step:S}):b&&!S?u.push({_TAG:"STEP_POPPED",activity:x}):p.steps.length===x.steps.length&&b.id!==S.id&&u.push({_TAG:"STEP_REPLACED",activity:x,step:S})}!p&&x?u.push({_TAG:x.enteredBy.name==="Pushed"?"PUSHED":"REPLACED",activity:x}):g&&j?u.push({_TAG:x.enteredBy.name==="Pushed"?"PUSHED":"REPLACED",activity:x}):p&&x&&p.id===x.id&&!ys(_r(p,["isActive","isTop","isRoot","transitionState","zIndex"]),_r(x,["isActive","isTop","isRoot","transitionState","zIndex"]))&&x.enteredBy.name==="Replaced"&&!ys(p.enteredBy,x.enteredBy)&&u.push({_TAG:"REPLACED",activity:x})}for(let y=Math.max(t.activities.length,s.activities.length)-1;y>=0;y-=1){const p=((r=t.activities[y])==null?void 0:r.transitionState)==="enter-done"||((o=t.activities[y])==null?void 0:o.transitionState)==="enter-active",x=((c=s.activities[y])==null?void 0:c.transitionState)==="exit-active"||((i=s.activities[y])==null?void 0:i.transitionState)==="exit-done",g=((l=s.activities[y+1])==null?void 0:l.enteredBy.name)==="Replaced"&&((m=s.activities[y+1])==null?void 0:m.transitionState)==="enter-done";p&&x&&!g&&u.push({_TAG:"POPPED",activity:s.activities[y]})}return u}var pp={Pushed:"onBeforePush",Replaced:"onBeforeReplace",Popped:"onBeforePop",StepPushed:"onBeforeStepPush",StepReplaced:"onBeforeStepReplace",StepPopped:"onBeforeStepPop",Paused:"onBeforePause",Resumed:"onBeforeResume"};function it(t,s,n,a){let r=!1,o=me({},s);for(const c of n){const i=c[pp[t]];i&&i({actionParams:me({},o),actions:xe(me({},a),{preventDefault:()=>{r=!0},overrideActionParams:l=>{o=me(me({},o),l)}})})}return{isPrevented:r,nextActionParams:o}}function hp({dispatchEvent:t,pluginInstances:s,actions:n}){return{push(a){const{isPrevented:r,nextActionParams:o}=it("Pushed",a,s,n);r||t("Pushed",o)},replace(a){const{isPrevented:r,nextActionParams:o}=it("Replaced",a,s,n);r||t("Replaced",o)},pop(a={}){const{isPrevented:r,nextActionParams:o}=it("Popped",a,s,n);r||t("Popped",o)},stepPush(a){const{isPrevented:r,nextActionParams:o}=it("StepPushed",a,s,n);r||t("StepPushed",o)},stepReplace(a){const{isPrevented:r,nextActionParams:o}=it("StepReplaced",a,s,n);r||t("StepReplaced",o)},stepPop(a={}){const{isPrevented:r,nextActionParams:o}=it("StepPopped",a,s,n);r||t("StepPopped",o)},pause(a={}){const{isPrevented:r,nextActionParams:o}=it("Paused",a,s,n);r||t("Paused",o)},resume(a={}){const{isPrevented:r,nextActionParams:o}=it("Resumed",a,s,n);r||t("Resumed",o)}}}function xp(t,s,n){t.forEach(a=>{s.forEach(r=>{var o,c,i,l,m,u,f,h,v;switch(a._TAG){case"PUSHED":(o=r.onPushed)==null||o.call(r,{actions:n,effect:a});break;case"REPLACED":(c=r.onReplaced)==null||c.call(r,{actions:n,effect:a});break;case"POPPED":(i=r.onPopped)==null||i.call(r,{actions:n,effect:a});break;case"STEP_PUSHED":(l=r.onStepPushed)==null||l.call(r,{actions:n,effect:a});break;case"STEP_REPLACED":(m=r.onStepReplaced)==null||m.call(r,{actions:n,effect:a});break;case"STEP_POPPED":(u=r.onStepPopped)==null||u.call(r,{actions:n,effect:a});break;case"PAUSED":(f=r.onPaused)==null||f.call(r,{actions:n,effect:a});break;case"RESUMED":(h=r.onResumed)==null||h.call(r,{actions:n,effect:a});break;case"%SOMETHING_CHANGED%":(v=r.onChanged)==null||v.call(r,{actions:n,effect:a});break}})})}var gp=1e3,vp=gp/60;function zr(t){var s,n,a,r;const o=[],i=[{key:"@stackflow/core",onChanged(){o.forEach(x=>x())}},...t.plugins.map(x=>x())],[l,m]=ip(t.initialEvents,x=>x.name==="Pushed"||x.name==="StepPushed"),u=i.reduce((x,g)=>{var j,N,b;return(b=(N=g.overrideInitialEvents)==null?void 0:N.call(g,{initialEvents:x,initialContext:(j=t.initialContext)!=null?j:{}}))!=null?b:x},l);u.length>0&&l.length>0&&u!==l&&((n=(s=t.handlers)==null?void 0:s.onInitialActivityIgnored)==null||n.call(s,u)),u.length===0&&((r=(a=t.handlers)==null?void 0:a.onInitialActivityNotFound)==null||r.call(a));const h={value:[...m,...u]},v={value:Jn(h.value,new Date().getTime())},y={getStack(){return v.value},dispatchEvent(x,g){const j=un(x,g),N=Jn([...h.value,j],new Date().getTime());h.value.push(j),p(N);const b=setInterval(()=>{const S=Jn(h.value,new Date().getTime());ys(v.value,S)||p(S),S.globalTransitionState==="idle"&&clearInterval(b)},vp)},push:()=>{},replace:()=>{},pop:()=>{},stepPush:()=>{},stepReplace:()=>{},stepPop:()=>{},pause:()=>{},resume:()=>{}},p=x=>{const g=fp(v.value,x);v.value=x,xp(g,i,y)};return Object.assign(y,hp({dispatchEvent:y.dispatchEvent,pluginInstances:i,actions:y})),{actions:y,init:op(()=>{i.forEach(x=>{var g;(g=x.onInit)==null||g.call(x,{actions:y})})}),pullEvents:()=>h.value,subscribe(x){return o.push(x),function(){const j=o.findIndex(N=>N===x);j>-1&&o.splice(j,1)}},pluginInstances:i}}var Bo=d.createContext(null);function yp(){const t=d.useContext(Bo);if(t===null)throw new Error("useActivityComponentMap must be used within ActivityComponentMapProvider");return t}function bp({children:t,value:s}){return e.jsx(Bo.Provider,{value:s,children:t})}var yn=t=>s=>s.find(({id:n})=>n===t);function jp(t){return!t.exitedBy}function Np(t,s){return s.enteredBy.eventDate-t.enteredBy.eventDate}function bn(t){return t.filter(jp).sort(Np)[0]}function Et(){return Qe()}function jn(){return Qe()}var Dr,wp=(Dr=ja.useDeferredValue)!=null?Dr:t=>t,Br,Cp=(Br=ja.useSyncExternalStore)!=null?Br:(t,s)=>{const[n,a]=d.useState(()=>s());return d.useEffect(()=>t(()=>{a(()=>s())})),n},Or,Oo=(Or=ja.useTransition)!=null?Or:()=>[!1,t=>t()],Wo=d.createContext(null),Fo=d.createContext(null),$o=({coreStore:t,children:s})=>{const n=Cp(t.subscribe,t.actions.getStack,t.actions.getStack),a=wp(n);return e.jsx(Fo.Provider,{value:a,children:e.jsx(Wo.Provider,{value:t.actions,children:s})})};$o.displayName="CoreProvider";var qo=()=>d.useContext(Wo),Ho=()=>d.useContext(Fo),Uo=d.createContext(null),Vo=({children:t,value:s})=>e.jsx(Uo.Provider,{value:s,children:t});Vo.displayName="PluginsProvider";function Jo(){return d.useContext(Uo)}function kp(t){return typeof t=="object"&&t!==null&&"then"in t&&typeof t.then=="function"}var be={PENDING:"pending",FULFILLED:"fulfilled",REJECTED:"rejected"};function Ha(t){if(t.status===be.PENDING)return{status:be.PENDING};if(t.status===be.FULFILLED&&"value"in t)return{status:be.FULFILLED,value:t.value};if(t.status===be.REJECTED&&"reason"in t)return{status:be.REJECTED,reason:t.reason};throw new Error("Invalid promise state")}function Sp(t){if("status"in t&&Object.values(be).some(n=>n===t.status))return t;const s=Object.assign(t,{status:be.PENDING});return s.then(n=>{s.status=be.FULFILLED,s.value=n},n=>{s.status=be.REJECTED,s.reason=n}),s}function mn(t){return kp(t)?Sp(t instanceof Promise?t:Promise.resolve(t)):Object.assign(Promise.resolve(t),{status:be.FULFILLED,value:t})}function Ap(t){return Object.assign(Promise.reject(t),{status:be.REJECTED,reason:t})}function Ip(t){const s=mn(t),n=Ha(s);if(n.status===be.FULFILLED)return n.value;throw n.status===be.REJECTED?n.reason:s}var Tp=Object.defineProperty,Wr=Object.getOwnPropertySymbols,Pp=Object.prototype.hasOwnProperty,Ep=Object.prototype.propertyIsEnumerable,Fr=(t,s,n)=>s in t?Tp(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,_p=(t,s)=>{for(var n in s||(s={}))Pp.call(s,n)&&Fr(t,n,s[n]);if(Wr)for(var n of Wr(s))Ep.call(s,n)&&Fr(t,n,s[n]);return t},Mp=(t,s,n)=>new Promise((a,r)=>{var o=l=>{try{i(n.next(l))}catch(m){r(m)}},c=l=>{try{i(n.throw(l))}catch(m){r(m)}},i=l=>l.done?a(l.value):Promise.resolve(l.value).then(o,c);i((n=n.apply(t,s)).next())});function Rp(t){let s=null;const n=()=>((!s||Ha(s).status===be.REJECTED)&&(s=t()),s);return{Component:r=>{const{default:o}=Ip(n());return e.jsx(o,_p({},r))},preload:()=>Mp(this,null,function*(){yield n()})}}var Lp=Symbol("STRUCTURED_ACTIVITY_COMPONENT_TYPE");function zp(t){return t!==null&&typeof t=="object"&&Lp in t}var Kn=new WeakMap;function Dp(t){if(Kn.has(t))return Kn.get(t);const{Component:s}=Rp(()=>{const n=t.content,a=mn(typeof n=="function"?n():{default:n}),r=Ha(a);return r.status===be.FULFILLED?mn({default:r.value.default.component}):r.status===be.REJECTED?Ap(r.reason):mn(a.then(o=>({default:o.default.component})))});return Kn.set(t,s),s}var Bp=Object.defineProperty,Op=Object.defineProperties,Wp=Object.getOwnPropertyDescriptors,$r=Object.getOwnPropertySymbols,Fp=Object.prototype.hasOwnProperty,$p=Object.prototype.propertyIsEnumerable,da=(t,s,n)=>s in t?Bp(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Ct=(t,s)=>{for(var n in s||(s={}))Fp.call(s,n)&&da(t,n,s[n]);if($r)for(var n of $r(s))$p.call(s,n)&&da(t,n,s[n]);return t},Gn=(t,s)=>Op(t,Wp(s)),qr=(t,s,n)=>da(t,typeof s!="symbol"?s+"":s,n),Ko=({plugin:t,initialContext:s})=>{const n=yp(),a=Ho(),r=Jo();return t.render({stack:Gn(Ct({},a),{render(o){return{activities:Ct(Ct({},a),o).activities.map(i=>Gn(Ct({},i),{key:i.id,render(l){const m=n[i.name];let u=zp(m)?Hp(m,i.params):e.jsx(m,{params:i.params});return r.forEach(f=>{var h,v;u=(v=(h=f.wrapActivity)==null?void 0:h.call(f,{activity:Gn(Ct({},i),{render:()=>u}),initialContext:s}))!=null?v:u}),e.jsx(Po,{value:Ct(Ct({},i),l),children:u},i.id)}}))}}}),initialContext:s})};Ko.displayName="PluginRenderer";var qp=Ko;function Hp(t,s){const{layout:n,loading:a,errorHandler:r}=t,o=Dp(t);return[i=>a?.component?e.jsx(d.Suspense,{fallback:e.jsx(a.component,{params:s}),children:i}):i,i=>{var l;if(!r)return i;const m=(l=r.boundary)!=null?l:Up;return e.jsx(m,{renderFallback:(u,f)=>e.jsx(r.component,{params:s,error:u,reset:f}),children:i})},i=>n?.component?e.jsx(n.component,{params:s,children:i}):i].reduce((i,l)=>l(i),e.jsx(o,{params:s}))}var Up=class extends d.Component{constructor(){super(...arguments),qr(this,"state",{hasError:!1,error:null}),qr(this,"reset",()=>this.setState({hasError:!1,error:null}))}render(){return this.state.hasError?this.props.renderFallback(this.state.error,this.reset):this.props.children}static getDerivedStateFromError(t){return{hasError:!0,error:t}}},Vp=Object.defineProperty,Jp=Object.defineProperties,Kp=Object.getOwnPropertyDescriptors,Hr=Object.getOwnPropertySymbols,Gp=Object.prototype.hasOwnProperty,Qp=Object.prototype.propertyIsEnumerable,Ur=(t,s,n)=>s in t?Vp(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Yp=(t,s)=>{for(var n in s||(s={}))Gp.call(s,n)&&Ur(t,n,s[n]);if(Hr)for(var n of Hr(s))Qp.call(s,n)&&Ur(t,n,s[n]);return t},Xp=(t,s)=>Jp(t,Kp(s)),Go=({initialContext:t})=>{const s=Ho(),n=Jo(),a=n.filter(o=>!!o.render);d.useEffect(()=>{a.length===0&&console.warn(`Stackflow - There is no rendering plugin, so "<Stack />" doesn't render anything. If you want to render some UI, use "@stackflow/plugin-renderer-basic" or add another rendering plugin.`)},[a]);let r=e.jsx(e.Fragment,{children:a.map(o=>e.jsx(qp,{plugin:o,initialContext:t},o.key))});return n.forEach(o=>{var c,i;r=(i=(c=o.wrapStack)==null?void 0:c.call(o,{stack:Xp(Yp({},s),{render(){return r}}),initialContext:t}))!=null?i:r}),e.jsx(_o,{value:s,children:r})};Go.displayName="MainRenderer";var Zp=Go,eh=Object.defineProperty,Vr=Object.getOwnPropertySymbols,th=Object.prototype.hasOwnProperty,sh=Object.prototype.propertyIsEnumerable,Jr=(t,s,n)=>s in t?eh(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Kr=(t,s)=>{for(var n in s||(s={}))th.call(s,n)&&Jr(t,n,s[n]);if(Vr)for(var n of Vr(s))sh.call(s,n)&&Jr(t,n,s[n]);return t};function Qn(t){return t?t.animate==null?{skipActiveState:!1}:{skipActiveState:!t.animate}:{skipActiveState:!1}}function Js(){const t=qo(),[s]=Oo();return d.useMemo(()=>({pending:s,push(n,a,r){const o=Et();return t?.push({activityId:o,activityName:n,activityParams:a,skipEnterActiveState:Qn(r).skipActiveState}),{activityId:o}},replace(n,a,r){var o;const c=Et();return t?.replace({activityId:(o=r?.activityId)!=null?o:Et(),activityName:n,activityParams:a,skipEnterActiveState:Qn(r).skipActiveState}),{activityId:c}},pop(n,a){let r=1,o={};typeof n=="object"&&(o=Kr({},n)),typeof n=="number"&&(r=n),a&&(o=Kr({},a));for(let c=0;c<r;c+=1)t?.pop({skipExitActiveState:c===0?Qn(o).skipActiveState:!0})}}),[t?.push,t?.replace,t?.pop,s])}var nh=()=>{const t=qo(),[s]=Oo();return d.useMemo(()=>({pending:s,stepPush(n,a){const r=t?.getStack().activities,o=a?.targetActivityId?yn(a.targetActivityId):bn,c=r&&o(r);if(!c)throw new Error("The target activity is not found.");const i=typeof n=="function"?n(c.params):n,l=jn();t?.stepPush({stepId:l,stepParams:i,targetActivityId:a?.targetActivityId})},stepReplace(n,a){const r=t?.getStack().activities,o=a?.targetActivityId?yn(a.targetActivityId):bn,c=r&&o(r);if(!c)throw new Error("The target activity is not found.");const i=typeof n=="function"?n(c.params):n,l=jn();t?.stepReplace({stepId:l,stepParams:i,targetActivityId:a?.targetActivityId})},stepPop(n){t?.stepPop({targetActivityId:n?.targetActivityId})}}),[t?.stepPush,t?.stepReplace,t?.stepPop,t?.getStack,s])},ah=Object.defineProperty,rh=Object.defineProperties,ih=Object.getOwnPropertyDescriptors,Gr=Object.getOwnPropertySymbols,oh=Object.prototype.hasOwnProperty,ch=Object.prototype.propertyIsEnumerable,Qr=(t,s,n)=>s in t?ah(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Zs=(t,s)=>{for(var n in s||(s={}))oh.call(s,n)&&Qr(t,n,s[n]);if(Gr)for(var n of Gr(s))ch.call(s,n)&&Qr(t,n,s[n]);return t},lh=(t,s)=>rh(t,ih(s));function Yn(t){return t?t.animate==null?{skipActiveState:!1}:{skipActiveState:!t.animate}:{skipActiveState:!1}}function dh(t){var s;const n=((s=t.plugins)!=null?s:[]).flat(Number.POSITIVE_INFINITY).map(m=>m),a=Object.entries(t.activities).reduce((m,[u,f])=>lh(Zs({},m),{[u]:"component"in f?f.component:f}),{}),r=()=>new Date().getTime()-t.transitionDuration*2,o=zr({initialEvents:[un("Initialized",{transitionDuration:t.transitionDuration,eventDate:r()}),...Object.entries(t.activities).map(([m,u])=>un("ActivityRegistered",Zs({activityName:m,eventDate:r()},"component"in u?{activityParamsSchema:u.paramsSchema}:null)))],plugins:[]}),[c,i]=Gf(),l=d.memo(m=>{const u=d.useMemo(()=>{const f=c();if(Xs()&&f)return f;const h=t.initialActivity?[un("Pushed",{activityId:Et(),activityName:t.initialActivity(),activityParams:{},eventDate:r(),skipEnterActiveState:!1})]:[],v=zr({initialEvents:[...o.pullEvents(),...h],initialContext:m.initialContext,plugins:n,handlers:{onInitialActivityIgnored:y=>{Xs()&&console.warn(`Stackflow - Some plugin overrides an "initialActivity" option. The "initialActivity" option you set to "${y[0].activityName}" in the "stackflow" is ignored.`)},onInitialActivityNotFound:()=>{Xs()&&console.warn("Stackflow - There is no initial activity. If you want to set the initial activity, add the `initialActivity` option of the `stackflow()` function or add a plugin that sets the initial activity. (e.g. `@stackflow/plugin-history-sync`)")}}});return Xs()&&(v.init(),i(v)),v},[]);return e.jsx(Vo,{value:u.pluginInstances,children:e.jsx($o,{coreStore:u,children:e.jsx(bp,{value:a,children:e.jsx(Zp,{initialContext:m.initialContext})})})})});return l.displayName="Stack",{activities:t.activities,Stack:l,useFlow:Js,useStepFlow:nh,addActivity(m){if(c()){console.warn("Stackflow - `addActivity()` API cannot be called after a `<Stack />` component has been rendered");return}a[m.name]=d.memo(m.component),o.actions.dispatchEvent("ActivityRegistered",{activityName:m.name,activityParamsSchema:m.paramsSchema,eventDate:r()})},addPlugin(m){if(c()){console.warn("Stackflow - `addPlugin()` API cannot be called after a `<Stack />` component has been rendered");return}[m].flat(Number.POSITIVE_INFINITY).map(u=>u).forEach(u=>{n.push(u)})},actions:{getStack(){var m,u;return(u=(m=c())==null?void 0:m.actions.getStack())!=null?u:o.actions.getStack()},dispatchEvent(m,u){var f;return(f=c())==null?void 0:f.actions.dispatchEvent(m,u)},push(m,u,f){var h;const v=Et();return(h=c())==null||h.actions.push({activityId:v,activityName:m,activityParams:u,skipEnterActiveState:Yn(f).skipActiveState}),{activityId:v}},replace(m,u,f){var h,v,y;const p=(h=f?.activityId)!=null?h:Et();return(y=c())==null||y.actions.replace({activityId:(v=f?.activityId)!=null?v:Et(),activityName:m,activityParams:u,skipEnterActiveState:Yn(f).skipActiveState}),{activityId:p}},pop(m,u){var f;let h=1,v={};typeof m=="object"&&(v=Zs({},m)),typeof m=="number"&&(h=m),u&&(v=Zs({},u));for(let y=0;y<h;y+=1)(f=c())==null||f.actions.pop({skipExitActiveState:y===0?Yn(v).skipActiveState:!0})},stepPush(m,u){var f,h;const v=(f=c())==null?void 0:f.actions.getStack().activities,y=u?.targetActivityId?yn(u.targetActivityId):bn,p=v&&y(v);if(!p)throw new Error("The target activity is not found.");const x=typeof m=="function"?m(p.params):m,g=jn();return(h=c())==null?void 0:h.actions.stepPush({stepId:g,stepParams:x,targetActivityId:u?.targetActivityId})},stepReplace(m,u){var f,h;const v=(f=c())==null?void 0:f.actions.getStack().activities,y=u?.targetActivityId?yn(u.targetActivityId):bn,p=v&&y(v);if(!p)throw new Error("The target activity is not found.");const x=typeof m=="function"?m(p.params):m,g=jn();return(h=c())==null?void 0:h.actions.stepReplace({stepId:g,stepParams:x,targetActivityId:u?.targetActivityId})},stepPop(m){var u;return(u=c())==null?void 0:u.actions.stepPop({targetActivityId:m?.targetActivityId})}}}}function uh(){return()=>({key:"plugin-renderer-basic",render({stack:t}){return e.jsx(e.Fragment,{children:t.render().activities.filter(s=>s.transitionState!=="exit-done").map(s=>e.jsx(d.Fragment,{children:s.render()},s.key))})}})}function mh(t){var s=t.match(/^var\((.*)\)$/);return s?s[1]:t}function Ks(t,s){var n={};{var a=t;for(var r in a){var o=a[r];o!=null&&(n[mh(r)]=o)}}return Object.defineProperty(n,"toString",{value:function(){return Object.keys(this).map(i=>"".concat(i,":").concat(this[i])).join(";")},writable:!1}),n}function fh(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function ph(t){var s=fh(t,"string");return typeof s=="symbol"?s:String(s)}function hh(t,s,n){return s=ph(s),s in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function Yr(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,a)}return n}function Xr(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?Yr(Object(n),!0).forEach(function(a){hh(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Yr(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function Zr(t,s){var n={};for(var a in t)n[a]=s(t[a],a);return n}var xh=(t,s,n)=>{for(var a of Object.keys(t)){var r;if(t[a]!==((r=s[a])!==null&&r!==void 0?r:n[a]))return!1}return!0},bt=t=>{var s=n=>{var a=t.defaultClassName,r=Xr(Xr({},t.defaultVariants),n);for(var o in r){var c,i=(c=r[o])!==null&&c!==void 0?c:t.defaultVariants[o];if(i!=null){var l=i;typeof l=="boolean"&&(l=l===!0?"true":"false");var m=t.variantClassNames[o][l];m&&(a+=" "+m)}}for(var[u,f]of t.compoundVariants)xh(u,r,t.defaultVariants)&&(a+=" "+f);return a};return s.variants=()=>Object.keys(t.variantClassNames),s.classNames={get base(){return t.defaultClassName.split(" ")[0]},get variants(){return Zr(t.variantClassNames,n=>Zr(n,a=>a.split(" ")[0]))}},s},gh=Object.defineProperty,ei=Object.getOwnPropertySymbols,vh=Object.prototype.hasOwnProperty,yh=Object.prototype.propertyIsEnumerable,ti=(t,s,n)=>s in t?gh(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,bh=(t,s)=>{for(var n in s||(s={}))vh.call(s,n)&&ti(t,n,s[n]);if(ei)for(var n of ei(s))yh.call(s,n)&&ti(t,n,s[n]);return t};function Ua(){const[t,s]=d.useReducer(()=>!0,!1);return d.useEffect(()=>{s()},[]),t}function Jt(){return Xf()}function Qo(){const t=Jt(),s=Ua();return bh({},s?{"data-stackflow-activity-id":t?.id,"data-stackflow-activity-is-active":t?.isActive,"data-stackflow-activity-transition-state":t?.transitionState}:null)}function Yo(t,s,n){const a=()=>{s.forEach(r=>{t.removeEventListener(r,a)}),n()};s.forEach(r=>{t.addEventListener(r,a)})}var jh=t=>(t(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}),Ve=()=>{};function ua(t){requestAnimationFrame(()=>{requestAnimationFrame(()=>{t()})})}function Nh({outerRef:t,innerRef:s,enable:n}){const[a,r]=d.useState(void 0);return d.useEffect(()=>{const o=t&&"current"in t&&t.current,c=s.current;return!n||!o||!c?Ve:jh(()=>{const l=o.clientWidth,m=c.offsetLeft,u=c.clientWidth,f=l-m-u,h=Math.max(m,f);r(l-2*h)})}),{maxWidth:a}}function Va(t){const[s,n]=d.useState(void 0);return d.useEffect(()=>{ua(()=>{n(t)})},[t]),s}function wh(){return ep()}function Ja({ref:t}){const s=wh();d.useEffect(()=>{if(!s)return;const n=t.current;if(!n||s.globalTransitionState==="idle")return;const a=r=>{r.preventDefault(),r.stopPropagation()};return n.addEventListener("touchstart",a,{capture:!0}),n.addEventListener("touchmove",a,{capture:!0}),n.addEventListener("touchend",a,{capture:!0}),n.addEventListener("touchcancel",a,{capture:!0}),()=>{n.removeEventListener("touchstart",a,{capture:!0}),n.removeEventListener("touchmove",a,{capture:!0}),n.removeEventListener("touchend",a,{capture:!0}),n.removeEventListener("touchcancel",a,{capture:!0})}},[s?.globalTransitionState])}var ps={};function tt({styleName:t,refs:s,effect:n,effectDeps:a}){const r=Jt();d.useEffect(()=>r?(ps[t]||(ps[t]=new Map),ps[t].set(r.zIndex,{refs:s,hasEffect:!!n}),()=>{ps[t].delete(r.zIndex)}):Ve,[r?.id,s,n]),d.useEffect(()=>{if(!r||!n)return Ve;const o=(()=>{let i=[];for(let l=1;l<=r.zIndex;l+=1){const m=ps[t].get(r.zIndex-l);if(m?.refs&&(i=[...i,...m.refs]),m?.hasEffect)break}return i})(),c=n({activityTransitionState:r.transitionState,refs:o});return()=>{c?.()}},[r?.transitionState,...a??[]])}function Ch({refs:t}){tt({styleName:"hide",refs:t,effect:({activityTransitionState:s,refs:n})=>{const a=()=>{n.forEach(r=>{if(!r.current)return;const o=r.current;o.style.display=""})};return s==="enter-done"?(n.forEach(r=>{if(!r.current)return;const o=r.current;o.style.display="none"}),()=>{a()}):(a(),Ve)}})}function kh({refs:t,transitionDuration:s,offsetStyles:n,hasEffect:a=!1}){tt({styleName:"offset",refs:t,effect:a?({activityTransitionState:r,refs:o})=>{const c=()=>{ua(()=>{o.forEach(i=>{if(!i.current)return;const l=i.current;l.style.transform="",l.style.opacity="",Yo(l,["transitionend","transitioncancel"],()=>{l.style.transition=""})})})};switch(r){case"enter-active":case"enter-done":return o.forEach(i=>{i.current&&(i.current.style.transition=s,i.current.style.transform=n.transform,i.current.style.opacity=n.opacity)}),r==="enter-done"?()=>{c()}:Ve;case"exit-active":case"exit-done":return ua(()=>{c()}),Ve;default:return Ve}}:void 0})}var en="--stackflow-swipe-back-ratio";function Sh({dimRef:t,edgeRef:s,paperRef:n,appBarRef:a,offset:r,transitionDuration:o,preventSwipeBack:c,moveAppBarTogether:i,getActivityTransitionState:l,onSwipeStart:m,onSwipeMove:u,onSwipeEnd:f,onTransitionEnd:h}){tt({styleName:"swipe-back",refs:i&&a?[n,a]:[n],effect:({refs:v})=>{if(c||!t.current||!s.current||!n.current)return Ve;const y=t.current,p=s.current,x=n.current,g=a?.current;let j=null,N=null,b=null,S=[];const w=()=>{j=null,N=null,b=null,S=[]};let I=!1;function E({dx:C,ratio:_}){I||(I=!0,requestAnimationFrame(()=>{y.style.opacity=`${1-_}`,y.style.transition="0s",x.style.overflowY="hidden",x.style.transform=`translate3d(${C}px, 0, 0)`,x.style.transition="0s",i&&g&&(g.style.overflowY="hidden",g.style.transform=`translate3d(${C}px, 0, 0)`,g.style.transition="0s"),g?.style.setProperty(en,String(_)),v.forEach(z=>{var D,L;z.current&&(z.current.style.transform=`translate3d(${-1*(1-_)*r}px, 0, 0)`,z.current.style.transition="0s",((D=z.current.parentElement)==null?void 0:D.style.display)==="none"&&(z.current.parentElement.style.display="block"),(L=z.current.parentElement)==null||L.style.setProperty(en,String(_)))}),I=!1}))}function A({swiped:C}){return new Promise(_=>{requestAnimationFrame(()=>{y.style.opacity=`${C?0:1}`,y.style.transition=o,x.style.overflowY="hidden",x.style.transform=`translateX(${C?"100%":"0"})`,x.style.transition=o,i&&g&&(g.style.overflowY="hidden",g.style.transform=`translateX(${C?"100%":"0"})`,g.style.transition=o),v.forEach(D=>{D.current&&(D.current.style.transition=o,D.current.style.transform=`translate3d(${C?"0":`-${r/16}rem`}, 0, 0)`)});const z=[...S];_(),Yo(x,["transitionend","transitioncancel"],()=>{const D=C||l()==="exit-active"||l()==="exit-done";y.style.opacity="",x.style.overflowY="",x.style.transform="",i&&g&&(g.style.overflowY="",g.style.transform="",g.style.removeProperty("transition")),g?.style.removeProperty(en),v.forEach((L,J)=>{var M;if(!L.current)return;const O=z[J];D?(L.current.style.transition="",L.current.style.transform="",L.current.parentElement&&(L.current.parentElement.style.display="")):O&&(L.current.style.transition=O.style.transition,L.current.style.transform=O.style.transform,L.current.parentElement&&O.parentElement&&(L.current.parentElement.style.display=O.parentElement.style.display)),(M=L.current.parentElement)==null||M.style.removeProperty(en)}),h?.({swiped:C})})})})}const P=C=>{var _;const{activeElement:z}=document;(_=z?.blur)==null||_.call(z),j=b=C.touches[0].clientX,N=Date.now(),S=v.map(D=>D.current?{style:{transform:D.current.style.transform,transition:D.current.style.transition},parentElement:D.current.parentElement?{style:{display:D.current.parentElement.style.display}}:void 0}:{style:{transform:"",transition:""}}),m?.()},k=C=>{if(!j){w();return}b=C.touches[0].clientX;const _=b-j,z=_/x.clientWidth;E({dx:_,ratio:z}),u?.({dx:_,ratio:z})},T=()=>{if(!j||!N||!b){w();return}const C=Date.now(),z=(b-j)/(C-N)>1||b/x.clientWidth>.4;f?.({swiped:z}),Promise.resolve().then(()=>A({swiped:z})).then(()=>w())};return p.addEventListener("touchstart",P,{passive:!0}),p.addEventListener("touchmove",k,{passive:!0}),p.addEventListener("touchend",T,{passive:!0}),p.addEventListener("touchcancel",T,{passive:!0}),()=>{p.removeEventListener("touchstart",P),p.removeEventListener("touchmove",k),p.removeEventListener("touchend",T),p.removeEventListener("touchcancel",T)}},effectDeps:[c]})}function Rs(){var t;const s=Jt();return((t=s?.zIndex)!=null?t:0)*5}var Ah=Object.defineProperty,Ih=Object.defineProperties,Th=Object.getOwnPropertyDescriptors,si=Object.getOwnPropertySymbols,Ph=Object.prototype.hasOwnProperty,Eh=Object.prototype.propertyIsEnumerable,ni=(t,s,n)=>s in t?Ah(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,It=(t,s)=>{for(var n in s||(s={}))Ph.call(s,n)&&ni(t,n,s[n]);if(si)for(var n of si(s))Eh.call(s,n)&&ni(t,n,s[n]);return t},bs=(t,s)=>Ih(t,Th(s)),_h=t=>e.jsx("svg",{className:t.className,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.7241 2.76052C17.105 3.16043 17.0896 3.79341 16.6897 4.17431L8.45 12.0222L16.6896 19.8689C17.0896 20.2498 17.105 20.8827 16.7242 21.2827C16.3433 21.6826 15.7103 21.6981 15.3104 21.3172L6.31037 12.7464C6.11218 12.5576 6.00001 12.2959 6 12.0222C5.99999 11.7486 6.11215 11.4868 6.31032 11.2981L15.3103 2.72608C15.7102 2.34518 16.3432 2.3606 16.7241 2.76052Z",fill:"currentColor"})}),ai=_h,Mh=t=>e.jsx("svg",{className:t.className,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M20.7071 4.70711C21.0976 4.31658 21.0976 3.68342 20.7071 3.29289C20.3166 2.90237 19.6834 2.90237 19.2929 3.29289L12 10.5858L4.70711 3.29289C4.31658 2.90237 3.68342 2.90237 3.29289 3.29289C2.90237 3.68342 2.90237 4.31658 3.29289 4.70711L10.5858 12L3.29289 19.2929C2.90237 19.6834 2.90237 20.3166 3.29289 20.7071C3.68342 21.0976 4.31658 21.0976 4.70711 20.7071L12 13.4142L19.2929 20.7071C19.6834 21.0976 20.3166 21.0976 20.7071 20.7071C21.0976 20.3166 21.0976 19.6834 20.7071 19.2929L13.4142 12L20.7071 4.70711Z",fill:"currentColor"})}),ri=Mh,$={backgroundColor:"var(--stackflow-plugin-basic-ui-background-color)",backgroundImage:"var(--stackflow-plugin-basic-ui-background-image)",dimBackgroundColor:"var(--stackflow-plugin-basic-ui-dim-background-color)",dimHeight:"var(--stackflow-plugin-basic-ui-dim-height)",transitionDuration:"var(--stackflow-plugin-basic-ui-transition-duration)",computedTransitionDuration:"var(--stackflow-plugin-basic-ui-computed-transition-duration)",defaultTransitionOffSet:"var(--stackflow-plugin-basic-ui-default-transition-off-set)",appBar:{borderColor:"var(--stackflow-plugin-basic-ui-app-bar-border-color)",borderColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-border-color-transition-duration)",borderSize:"var(--stackflow-plugin-basic-ui-app-bar-border-size)",height:"var(--stackflow-plugin-basic-ui-app-bar-height)",heightTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-height-transition-duration)",minHeight:"var(--stackflow-plugin-basic-ui-app-bar-min-height)",iconColor:"var(--stackflow-plugin-basic-ui-app-bar-icon-color)",iconColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-icon-color-transition-duration)",textColor:"var(--stackflow-plugin-basic-ui-app-bar-text-color)",textColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-text-color-transition-duration)",backgroundColor:"var(--stackflow-plugin-basic-ui-app-bar-background-color)",backgroundColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-background-color-transition-duration)",backgroundImage:"var(--stackflow-plugin-basic-ui-app-bar-background-image)",backgroundImageTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-background-image-transition-duration)",overflow:"var(--stackflow-plugin-basic-ui-app-bar-overflow)",minSafeAreaInsetTop:"var(--stackflow-plugin-basic-ui-app-bar-min-safe-area-inset-top)",containerPadding:"var(--stackflow-plugin-basic-ui-app-bar-container-padding)",itemGap:"var(--stackflow-plugin-basic-ui-app-bar-item-gap)",fontSize:"var(--stackflow-plugin-basic-ui-app-bar-font-size)",lineHeight:"var(--stackflow-plugin-basic-ui-app-bar-line-height)",hitSlop:"var(--stackflow-plugin-basic-ui-app-bar-hit-slop)"},bottomSheet:{borderRadius:"var(--stackflow-plugin-basic-ui-bottom-sheet-border-radius)"},modal:{borderRadius:"var(--stackflow-plugin-basic-ui-modal-border-radius)",maxWidth:"var(--stackflow-plugin-basic-ui-modal-max-width)"},edge:{width:"var(--stackflow-plugin-basic-ui-edge-width)"}},Rh=bt({defaultClassName:"_1q6dj2j2",variantClassNames:{theme:{android:"_1q6dj2j0",cupertino:"_1q6dj2j1"}},defaultVariants:{},compoundVariants:[]});function Lh(t){return t.filter(s=>s!=null)}function Gs(t){return Object.entries(t).reduce((s,[n,a])=>(a!=null&&(s[n]=a),s),{})}var Xo=d.createContext({theme:"android"}),zh=Xo.Provider;function Zo(){return d.useContext(Xo)}var Dh=t=>()=>({key:"basic-ui",wrapStack({stack:s,initialContext:n}){var a,r,o,c,i,l,m,u,f,h,v,y,p,x,g,j,N;const b=typeof t=="function"?t({initialContext:n}):t;return e.jsx(zh,{value:bs(It({},b),{theme:(a=n?.theme)!=null?a:b.theme}),children:e.jsx("div",{className:Lh([Rh({theme:(r=n?.theme)!=null?r:b.theme}),b.rootClassName]).join(" "),style:Ks(Gs({[$.backgroundColor]:b.backgroundColor,[$.backgroundImage]:b.backgroundImage,[$.dimBackgroundColor]:b.dimBackgroundColor,[$.dimHeight]:b.dimHeight,[$.transitionDuration]:`${s.transitionDuration}ms`,[$.computedTransitionDuration]:s.globalTransitionState==="loading"?`${s.transitionDuration}ms`:"0ms",[$.defaultTransitionOffSet]:b.defaultTransitionOffSet,[$.appBar.borderColor]:(o=b.appBar)==null?void 0:o.borderColor,[$.appBar.borderSize]:(c=b.appBar)==null?void 0:c.borderSize,[$.appBar.height]:(i=b.appBar)==null?void 0:i.height,[$.appBar.minHeight]:(l=b.appBar)==null?void 0:l.minHeight,[$.appBar.iconColor]:(m=b.appBar)==null?void 0:m.iconColor,[$.appBar.textColor]:(u=b.appBar)==null?void 0:u.textColor,[$.appBar.minSafeAreaInsetTop]:(f=b.appBar)==null?void 0:f.minSafeAreaInsetTop,[$.bottomSheet.borderRadius]:(h=b.bottomSheet)==null?void 0:h.borderRadius,[$.modal.borderRadius]:(v=b.modal)==null?void 0:v.borderRadius,[$.appBar.containerPadding]:(y=b.appBar)==null?void 0:y.containerPadding,[$.appBar.fontSize]:(p=b.appBar)==null?void 0:p.fontSize,[$.appBar.lineHeight]:(x=b.appBar)==null?void 0:x.lineHeight,[$.appBar.hitSlop]:(g=b.appBar)==null?void 0:g.hitSlop,[$.appBar.itemGap]:(j=b.appBar)==null?void 0:j.itemGap,[$.edge.width]:(N=b.edge)==null?void 0:N.width})),children:s.render()})})}}),Bh=bt({defaultClassName:"_1yk3a452 dhthxq4 dhthxq0 dhthxqh _1yk3a451",variantClassNames:{activityEnterStyle:{slideInLeft:"_1yk3a453"},enterStyle:{cover:"_1yk3a454"},border:{true:"_1yk3a455"},modalPresentationStyle:{fullScreen:"_1yk3a456"}},defaultVariants:{},compoundVariants:[[{activityEnterStyle:"slideInLeft",enterStyle:"cover"},"_1yk3a457"]]}),ii="_1yk3a45b dhthxq9 dhthxq7 dhthxqb dhthxqf dhthxqi",Oh="dhthxq9 dhthxq7 dhthxq8 _1yk3a450",Wh="_1yk3a45e",Fh="_1yk3a45f dhthxqi dhthxq4 dhthxq2 dhthxqf",$h="_1yk3a45g dhthxqc dhthxqd dhthxq0",qh="_1yk3a45b dhthxq9 dhthxq7 dhthxqb dhthxqf dhthxqi",Hh="_1yk3a459 dhthxqa dhthxq7 _1yk3a451",Uh="_1yk3a45a dhthxq9 dhthxq7 dhthxq1 _1yk3a450",Vh="_1yk3a45h dhthxq9 dhthxq7 dhthxq1 dhthxq5 _1yk3a450",Jh="_1yk3a458",Kh=bt({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_1dlf434a","enter-done":"_1dlf434b","exit-active":"_1dlf434c","exit-done":"_1dlf434d"},hasAppBar:{true:"_1dlf434j"}},defaultVariants:{},compoundVariants:[]}),Gh="_1dlf434k dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 _1dlf4347 _1dlf4349",Qh=bt({defaultClassName:"_1dlf434r dhthxq4 dhthxq2 dhthxq3 dhthxq1",variantClassNames:{hasAppBar:{true:"_1dlf434s"}},defaultVariants:{},compoundVariants:[]}),Yh="_1dlf434a",Xh="_1dlf434b",Zh="_1dlf434c",ex="_1dlf434d",tx=bt({defaultClassName:"_1dlf434l dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 _1dlf4348 _1dlf4349",variantClassNames:{hasAppBar:{true:"_1dlf434m dhthxqg"},modalPresentationStyle:{fullScreen:"_1dlf434n"},activityEnterStyle:{slideInLeft:"_1dlf434o"}},defaultVariants:{},compoundVariants:[]}),sx=bt({defaultClassName:"_1dlf434p dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3",variantClassNames:{hasAppBar:{true:"_1dlf434q"}},defaultVariants:{},compoundVariants:[]}),Zt={transitionDuration:"var(--_1dlf4340)",zIndexes:{dim:"var(--_1dlf4341)",paper:"var(--_1dlf4342)",edge:"var(--_1dlf4343)",appBar:"var(--_1dlf4344)"},appBar:{center:{mainWidth:"var(--_1dlf4346)"}}},ec=d.forwardRef(({title:t,renderLeft:s,renderRight:n,backButton:a,closeButton:r,closeButtonLocation:o="left",border:c=!0,modalPresentationStyle:i,activityEnterStyle:l,iconColor:m,iconColorTransitionDuration:u,textColor:f,textColorTransitionDuration:h,borderColor:v,borderColorTransitionDuration:y,borderSize:p,height:x,heightTransitionDuration:g,overflow:j,backgroundColor:N,backgroundColorTransitionDuration:b,backgroundImage:S,backgroundImageTransitionDuration:w,onTopClick:I,enterStyle:E,className:A,minHeight:P,fontSize:k,lineHeight:T,hitSlop:C,containerPadding:_,itemGap:z},D)=>{var L,J;const M=Js(),O=Jt(),Q=Qo();Ua();const te=Zo(),W=(L=te.appBar)==null?void 0:L.closeButton,G=(J=te.appBar)==null?void 0:J.backButton,ve=d.useRef(null),{maxWidth:se}=Nh({outerRef:D,innerRef:ve,enable:te.theme==="cupertino"}),H=(te.theme==="cupertino"&&i!=="fullScreen"||l==="slideInLeft")&&E!=="cover",Z=ee=>{a&&"onClick"in a&&a.onClick&&a.onClick(ee),ee.defaultPrevented||M.pop()},X=()=>{var ee,ue;return!O||O.isRoot?null:!a&&!G?e.jsx("button",{type:"button","aria-label":"Go Back",className:ii,onClick:Z,children:e.jsx(ai,{})}):a&&"render"in a&&a.render?(ee=a.render)==null?void 0:ee.call(a):G&&"render"in G&&G.render?(ue=G.render)==null?void 0:ue.call(G):e.jsx("button",{type:"button",className:ii,"aria-label":a&&"ariaLabel"in a?a.ariaLabel:G&&"ariaLabel"in G?G.ariaLabel:void 0,onClick:Z,children:a&&"renderIcon"in a&&a.renderIcon?a.renderIcon():G&&"renderIcon"in G&&G.renderIcon?G.renderIcon():i==="fullScreen"?e.jsx(ri,{}):e.jsx(ai,{})})},le=ee=>{var ue;r&&"onClick"in r&&r.onClick&&r.onClick(ee),!ee.defaultPrevented&&W&&"onClick"in W&&((ue=W.onClick)==null||ue.call(W,ee))},F=()=>{var ee;const ue=!O||O.isRoot,ye=pe=>pe&&"render"in pe&&pe.render||pe&&"renderIcon"in pe&&pe.renderIcon||pe&&"onClick"in pe&&pe.onClick;return!(ye(r)||ye((ee=te.appBar)==null?void 0:ee.closeButton))||!ue?null:r&&"render"in r&&r.render?r.render():W&&"render"in W&&W.render?W.render():e.jsx("button",{type:"button",className:qh,"aria-label":r&&"ariaLabel"in r?r.ariaLabel:W&&"ariaLabel"in W?W.ariaLabel:void 0,onClick:le,children:r&&"renderIcon"in r&&r.renderIcon?r.renderIcon():W&&"renderIcon"in W&&W.renderIcon?W.renderIcon():e.jsx(ri,{})})};return e.jsxs("div",bs(It({ref:D,className:Mn(Bh({border:c,modalPresentationStyle:i,activityEnterStyle:l,enterStyle:E}),A),style:Ks(Gs({[$.appBar.iconColor]:m,[$.appBar.iconColorTransitionDuration]:u,[$.appBar.textColor]:f,[$.appBar.textColorTransitionDuration]:h,[$.appBar.borderColor]:v,[$.appBar.borderColorTransitionDuration]:y,[$.appBar.borderSize]:p,[$.appBar.height]:x,[$.appBar.heightTransitionDuration]:g,[$.appBar.overflow]:j,[$.appBar.backgroundColor]:N??(H?$.backgroundColor:"transparent"),[$.appBar.backgroundColorTransitionDuration]:b,[$.appBar.backgroundImage]:S??(H?$.appBar.backgroundImage:"none"),[$.appBar.backgroundImageTransitionDuration]:w,[Zt.appBar.center.mainWidth]:`${se}px`,[$.appBar.minHeight]:P,[$.appBar.containerPadding]:_,[$.appBar.fontSize]:k,[$.appBar.hitSlop]:C,[$.appBar.lineHeight]:T,[$.appBar.itemGap]:z})),"data-part":"appBar"},Q),{children:[e.jsx("div",{className:Jh}),e.jsxs("div",{className:Hh,children:[e.jsxs("div",{className:Uh,children:[o==="left"&&F(),X(),s?.()]}),e.jsx("div",{ref:ve,className:Oh,children:e.jsxs("div",{className:Wh,children:[typeof t=="string"?e.jsx("div",{className:$h,children:t}):t,e.jsx("button",{className:Fh,type:"button",onClick:I})]})}),e.jsxs("div",{className:Vh,children:[n?.(),o==="right"&&F()]})]})]}))});ec.displayName="AppBar";var nx=ec,ax=32,oi=80,rx=d.createContext(null),ix=({backgroundColor:t,backgroundImage:s,dimBackgroundColor:n,appBar:a,preventSwipeBack:r,CUPERTINO_ONLY_modalPresentationStyle:o,ANDROID_ONLY_activityEnterStyle:c,className:i,children:l})=>{var m;const u=Zo(),f=Jt(),h=Qo();Ua();const{pop:v}=Js(),y=d.useRef(null),p=d.useRef(null),x=d.useRef(null),g=d.useRef(null),j=d.useRef(null),N=d.useRef(null),b=u.theme==="cupertino"?o:void 0,S=u.theme==="android"?c:void 0,w=r||b==="fullScreen",I=!!a,E=Rs();let A,P,k,T;u.theme==="cupertino"?(A=E+(b==="fullScreen"?2:0),P=E+(I&&b!=="fullScreen"?a.enterStyle==="cover"?2:1:3),k=E+4,T=E+7):(A=E,P=E+(S==="slideInLeft"&&a?.enterStyle!=="cover"?0:2),k=E+4,T=E+(S==="slideInLeft"?6:4));const C=(m=f?.transitionState)!=null?m:"enter-done",_=Va(C);Ch({refs:[y]}),kh({refs:(u.theme==="cupertino"||S==="slideInLeft")&&a?.enterStyle!=="cover"?[x]:[x,j],offsetStyles:u.theme==="cupertino"?{transform:`translate3d(-${oi/16}rem, 0, 0)`,opacity:"1"}:S==="slideInLeft"?{transform:"translate3d(-50%, 0, 0)",opacity:"0"}:{transform:`translate3d(0, -${ax/16}rem, 0)`,opacity:"1"},transitionDuration:$.computedTransitionDuration,hasEffect:b!=="fullScreen"}),Sh({dimRef:p,edgeRef:g,paperRef:x,appBarRef:j,offset:oi,transitionDuration:$.transitionDuration,moveAppBarTogether:a?.enterStyle==="cover",preventSwipeBack:w||u.theme!=="cupertino",getActivityTransitionState(){const D=x.current,L=D?.parentElement;return L?L.classList.contains(Yh)?"enter-active":L.classList.contains(Xh)?"enter-done":L.classList.contains(Zh)?"exit-active":L.classList.contains(ex)?"exit-done":null:null},onSwipeEnd({swiped:D}){D&&v()}});const z=D=>{var L,J;(L=a?.onTopClick)==null||L.call(a,D),D.defaultPrevented||(J=N.current)==null||J.scroll({top:0,behavior:"smooth"})};return Ja({ref:y}),e.jsx(rx.Provider,{value:d.useMemo(()=>({scroll({top:D}){var L;(L=N?.current)==null||L.scroll({top:D,behavior:"smooth"})},zIndices:{dim:A,paper:P,edge:k,appBar:T}}),[N,A,P,k,T]),children:e.jsxs("div",bs(It({ref:y,className:Mn(Kh({hasAppBar:I,transitionState:C==="enter-done"||C==="exit-done"?C:_}),i),style:Ks(Gs({[$.backgroundColor]:t,[$.backgroundImage]:s,[$.dimBackgroundColor]:n,[$.appBar.height]:a?.height,[$.appBar.heightTransitionDuration]:a?.heightTransitionDuration,[Zt.zIndexes.dim]:`${A}`,[Zt.zIndexes.paper]:`${P}`,[Zt.zIndexes.edge]:`${k}`,[Zt.zIndexes.appBar]:`${T}`,[Zt.transitionDuration]:C==="enter-active"||C==="exit-active"?$.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"AppScreen"},h),{children:[S!=="slideInLeft"&&e.jsx("div",It({ref:p,className:Gh,"data-part":"dim"},h)),a&&e.jsx(nx,bs(It({},a),{ref:j,modalPresentationStyle:b,activityEnterStyle:S,onTopClick:z})),e.jsx("div",bs(It({ref:x,className:tx({hasAppBar:I,modalPresentationStyle:b,activityEnterStyle:S}),"data-part":"paper"},h),{children:e.jsx("div",{ref:N,className:sx({hasAppBar:I}),children:l})}),f?.id),!f?.isRoot&&u.theme==="cupertino"&&!w&&e.jsx("div",It({ref:g,className:Qh({hasAppBar:I}),"data-part":"edge"},h))]}))})},ae=ix,ox=bt({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_1ht38h04","enter-done":"_1ht38h05","exit-active":"_1ht38h06","exit-done":"_1ht38h07"}},defaultVariants:{},compoundVariants:[]}),cx="_1ht38h0d dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc dhthxqa dhthxq7 _1ht38h03",lx="_1ht38h0e dhthxqc _1ht38h03",Xn={transitionDuration:"var(--_1ht38h00)",zIndexes:{dim:"var(--_1ht38h01)",paper:"var(--_1ht38h02)"}},tc=({borderRadius:t="1rem",backgroundColor:s,backgroundImage:n,dimBackgroundColor:a,paperRef:r,onOutsideClick:o,children:c,className:i})=>{var l;const m=Jt(),{pop:u}=Js(),f=d.useRef(null),h=d.useRef(null);tt({styleName:"hide",refs:[f]}),tt({styleName:"offset",refs:[h]}),tt({styleName:"swipe-back",refs:[h]});const v=d.useRef(!1),y=N=>{o?.(N),!N.defaultPrevented&&(v.current||(v.current=!0,u()))},p=N=>{N.stopPropagation()},x=Rs()+3,g=Rs()+4,j=(l=m?.transitionState)!=null?l:"enter-done";return Ja({ref:f}),e.jsx("div",{className:Mn(ox({transitionState:Va(j)}),i),ref:f,style:Ks(Gs({[$.bottomSheet.borderRadius]:t,[$.backgroundColor]:s,[$.backgroundImage]:n,[$.dimBackgroundColor]:a,[Xn.zIndexes.dim]:`${x}`,[Xn.zIndexes.paper]:`${g}`,[Xn.transitionDuration]:j==="enter-active"||j==="exit-active"?$.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"BottomSheet","data-stackflow-activity-id":m?.id,"data-stackflow-activity-is-active":m?.isActive,children:e.jsx("div",{className:cx,ref:h,onClick:y,children:e.jsx("div",{className:lx,ref:r,onClick:p,children:c})})})};tc.displayName="BottomSheet";var dx=tc,ux=bt({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_5ozg8c4","enter-done":"_5ozg8c5","exit-active":"_5ozg8c6","exit-done":"_5ozg8c7"}},defaultVariants:{},compoundVariants:[]}),mx="_5ozg8cd dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc dhthxq9 dhthxq7 dhthxqb _5ozg8c3",fx="_5ozg8ce dhthxqc _5ozg8c3",Zn={transitionDuration:"var(--_5ozg8c0)",zIndexes:{dim:"var(--_5ozg8c1)",paper:"var(--_5ozg8c2)"}},sc=({backgroundColor:t,backgroundImage:s,dimBackgroundColor:n,borderRadius:a="1rem",maxWidth:r,onOutsideClick:o,children:c,className:i})=>{var l;const m=Jt(),{pop:u}=Js(),f=d.useRef(null),h=d.useRef(null);tt({styleName:"hide",refs:[f]}),tt({styleName:"offset",refs:[h]}),tt({styleName:"swipe-back",refs:[h]});const v=d.useRef(!1),y=N=>{o?.(N),!N.defaultPrevented&&(v.current||(v.current=!0,u()))},p=N=>{N.stopPropagation()},x=Rs()+3,g=Rs()+4,j=(l=m?.transitionState)!=null?l:"enter-done";return Ja({ref:f}),e.jsx("div",{className:Mn(ux({transitionState:Va(j)}),i),ref:f,style:Ks(Gs({[$.backgroundColor]:t,[$.backgroundImage]:s,[$.dimBackgroundColor]:n,[$.modal.borderRadius]:a,[$.modal.maxWidth]:r,[Zn.zIndexes.dim]:`${x}`,[Zn.zIndexes.paper]:`${g}`,[Zn.transitionDuration]:j==="enter-active"||j==="exit-active"?$.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"Modal","data-stackflow-activity-id":m?.id,"data-stackflow-activity-is-active":m?.isActive,children:e.jsx("div",{className:mx,ref:h,onClick:y,children:e.jsx("div",{className:fx,onClick:p,children:c})})})};sc.displayName="Modal";var px=sc,hx=Object.defineProperty,K=(t,s)=>hx(t,"name",{value:s,configurable:!0}),ns=class{type=3;name="";prefix="";value="";suffix="";modifier=3;constructor(t,s,n,a,r,o){this.type=t,this.name=s,this.prefix=n,this.value=a,this.suffix=r,this.modifier=o}hasCustomName(){return this.name!==""&&typeof this.name!="number"}};K(ns,"Part");var xx=/[$_\p{ID_Start}]/u,gx=/[$_\u200C\u200D\p{ID_Continue}]/u,ma=".*";function nc(t,s){return(s?/^[\x00-\xFF]*$/:/^[\x00-\x7F]*$/).test(t)}K(nc,"isASCII");function Ka(t,s=!1){let n=[],a=0;for(;a<t.length;){let r=t[a],o=K(function(c){if(!s)throw new TypeError(c);n.push({type:"INVALID_CHAR",index:a,value:t[a++]})},"ErrorOrInvalid");if(r==="*"){n.push({type:"ASTERISK",index:a,value:t[a++]});continue}if(r==="+"||r==="?"){n.push({type:"OTHER_MODIFIER",index:a,value:t[a++]});continue}if(r==="\\"){n.push({type:"ESCAPED_CHAR",index:a++,value:t[a++]});continue}if(r==="{"){n.push({type:"OPEN",index:a,value:t[a++]});continue}if(r==="}"){n.push({type:"CLOSE",index:a,value:t[a++]});continue}if(r===":"){let c="",i=a+1;for(;i<t.length;){let l=t.substr(i,1);if(i===a+1&&xx.test(l)||i!==a+1&&gx.test(l)){c+=t[i++];continue}break}if(!c){o(`Missing parameter name at ${a}`);continue}n.push({type:"NAME",index:a,value:c}),a=i;continue}if(r==="("){let c=1,i="",l=a+1,m=!1;if(t[l]==="?"){o(`Pattern cannot start with "?" at ${l}`);continue}for(;l<t.length;){if(!nc(t[l],!1)){o(`Invalid character '${t[l]}' at ${l}.`),m=!0;break}if(t[l]==="\\"){i+=t[l++]+t[l++];continue}if(t[l]===")"){if(c--,c===0){l++;break}}else if(t[l]==="("&&(c++,t[l+1]!=="?")){o(`Capturing groups are not allowed at ${l}`),m=!0;break}i+=t[l++]}if(m)continue;if(c){o(`Unbalanced pattern at ${a}`);continue}if(!i){o(`Missing pattern at ${a}`);continue}n.push({type:"REGEX",index:a,value:i}),a=l;continue}n.push({type:"CHAR",index:a,value:t[a++]})}return n.push({type:"END",index:a,value:""}),n}K(Ka,"lexer");function Ga(t,s={}){let n=Ka(t);s.delimiter??="/#?",s.prefixes??="./";let a=`[^${Ie(s.delimiter)}]+?`,r=[],o=0,c=0,i=new Set,l=K(j=>{if(c<n.length&&n[c].type===j)return n[c++].value},"tryConsume"),m=K(()=>l("OTHER_MODIFIER")??l("ASTERISK"),"tryConsumeModifier"),u=K(j=>{let N=l(j);if(N!==void 0)return N;let{type:b,index:S}=n[c];throw new TypeError(`Unexpected ${b} at ${S}, expected ${j}`)},"mustConsume"),f=K(()=>{let j="",N;for(;N=l("CHAR")??l("ESCAPED_CHAR");)j+=N;return j},"consumeText"),h=K(j=>j,"DefaultEncodePart"),v=s.encodePart||h,y="",p=K(j=>{y+=j},"appendToPendingFixedValue"),x=K(()=>{y.length&&(r.push(new ns(3,"","",v(y),"",3)),y="")},"maybeAddPartFromPendingFixedValue"),g=K((j,N,b,S,w)=>{let I=3;switch(w){case"?":I=1;break;case"*":I=0;break;case"+":I=2;break}if(!N&&!b&&I===3){p(j);return}if(x(),!N&&!b){if(!j)return;r.push(new ns(3,"","",v(j),"",I));return}let E;b?b==="*"?E=ma:E=b:E=a;let A=2;E===a?(A=1,E=""):E===ma&&(A=0,E="");let P;if(N?P=N:b&&(P=o++),i.has(P))throw new TypeError(`Duplicate name '${P}'.`);i.add(P),r.push(new ns(A,P,v(j),E,v(S),I))},"addPart");for(;c<n.length;){let j=l("CHAR"),N=l("NAME"),b=l("REGEX");if(!N&&!b&&(b=l("ASTERISK")),N||b){let w=j??"";s.prefixes.indexOf(w)===-1&&(p(w),w=""),x();let I=m();g(w,N,b,"",I);continue}let S=j??l("ESCAPED_CHAR");if(S){p(S);continue}if(l("OPEN")){let w=f(),I=l("NAME"),E=l("REGEX");!I&&!E&&(E=l("ASTERISK"));let A=f();u("CLOSE");let P=m();g(w,I,E,A,P);continue}x(),u("END")}return r}K(Ga,"parse");function Ie(t){return t.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}K(Ie,"escapeString");function fa(t){return t&&t.ignoreCase?"ui":"u"}K(fa,"flags");function ac(t,s,n){return Qa(Ga(t,n),s,n)}K(ac,"stringToRegexp");function _t(t){switch(t){case 0:return"*";case 1:return"?";case 2:return"+";case 3:return""}}K(_t,"modifierToString");function Qa(t,s,n={}){n.delimiter??="/#?",n.prefixes??="./",n.sensitive??=!1,n.strict??=!1,n.end??=!0,n.start??=!0,n.endsWith="";let a=n.start?"^":"";for(let i of t){if(i.type===3){i.modifier===3?a+=Ie(i.value):a+=`(?:${Ie(i.value)})${_t(i.modifier)}`;continue}s&&s.push(i.name);let l=`[^${Ie(n.delimiter)}]+?`,m=i.value;if(i.type===1?m=l:i.type===0&&(m=ma),!i.prefix.length&&!i.suffix.length){i.modifier===3||i.modifier===1?a+=`(${m})${_t(i.modifier)}`:a+=`((?:${m})${_t(i.modifier)})`;continue}if(i.modifier===3||i.modifier===1){a+=`(?:${Ie(i.prefix)}(${m})${Ie(i.suffix)})`,a+=_t(i.modifier);continue}a+=`(?:${Ie(i.prefix)}`,a+=`((?:${m})(?:`,a+=Ie(i.suffix),a+=Ie(i.prefix),a+=`(?:${m}))*)${Ie(i.suffix)})`,i.modifier===0&&(a+="?")}let r=`[${Ie(n.endsWith)}]|$`,o=`[${Ie(n.delimiter)}]`;if(n.end)return n.strict||(a+=`${o}?`),n.endsWith.length?a+=`(?=${r})`:a+="$",new RegExp(a,fa(n));n.strict||(a+=`(?:${o}(?=${r}))?`);let c=!1;if(t.length){let i=t[t.length-1];i.type===3&&i.modifier===3&&(c=n.delimiter.indexOf(i)>-1)}return c||(a+=`(?=${o}|${r})`),new RegExp(a,fa(n))}K(Qa,"partsToRegexp");var lt={delimiter:"",prefixes:"",sensitive:!0,strict:!0},vx={delimiter:".",prefixes:"",sensitive:!0,strict:!0},yx={delimiter:"/",prefixes:"/",sensitive:!0,strict:!0};function rc(t,s){return t.length?t[0]==="/"?!0:!s||t.length<2?!1:(t[0]=="\\"||t[0]=="{")&&t[1]=="/":!1}K(rc,"isAbsolutePathname");function Ya(t,s){return t.startsWith(s)?t.substring(s.length,t.length):t}K(Ya,"maybeStripPrefix");function ic(t,s){return t.endsWith(s)?t.substr(0,t.length-s.length):t}K(ic,"maybeStripSuffix");function Xa(t){return!t||t.length<2?!1:t[0]==="["||(t[0]==="\\"||t[0]==="{")&&t[1]==="["}K(Xa,"treatAsIPv6Hostname");var oc=["ftp","file","http","https","ws","wss"];function Za(t){if(!t)return!0;for(let s of oc)if(t.test(s))return!0;return!1}K(Za,"isSpecialScheme");function cc(t,s){if(t=Ya(t,"#"),s||t==="")return t;let n=new URL("https://example.com");return n.hash=t,n.hash?n.hash.substring(1,n.hash.length):""}K(cc,"canonicalizeHash");function lc(t,s){if(t=Ya(t,"?"),s||t==="")return t;let n=new URL("https://example.com");return n.search=t,n.search?n.search.substring(1,n.search.length):""}K(lc,"canonicalizeSearch");function dc(t,s){return s||t===""?t:Xa(t)?sr(t):tr(t)}K(dc,"canonicalizeHostname");function uc(t,s){if(s||t==="")return t;let n=new URL("https://example.com");return n.password=t,n.password}K(uc,"canonicalizePassword");function mc(t,s){if(s||t==="")return t;let n=new URL("https://example.com");return n.username=t,n.username}K(mc,"canonicalizeUsername");function fc(t,s,n){if(n||t==="")return t;if(s&&!oc.includes(s))return new URL(`${s}:${t}`).pathname;let a=t[0]=="/";return t=new URL(a?t:"/-"+t,"https://example.com").pathname,a||(t=t.substring(2,t.length)),t}K(fc,"canonicalizePathname");function pc(t,s,n){return er(s)===t&&(t=""),n||t===""?t:nr(t)}K(pc,"canonicalizePort");function hc(t,s){return t=ic(t,":"),s||t===""?t:Wn(t)}K(hc,"canonicalizeProtocol");function er(t){switch(t){case"ws":case"http":return"80";case"wws":case"https":return"443";case"ftp":return"21";default:return""}}K(er,"defaultPortForProtocol");function Wn(t){if(t==="")return t;if(/^[-+.A-Za-z0-9]*$/.test(t))return t.toLowerCase();throw new TypeError(`Invalid protocol '${t}'.`)}K(Wn,"protocolEncodeCallback");function xc(t){if(t==="")return t;let s=new URL("https://example.com");return s.username=t,s.username}K(xc,"usernameEncodeCallback");function gc(t){if(t==="")return t;let s=new URL("https://example.com");return s.password=t,s.password}K(gc,"passwordEncodeCallback");function tr(t){if(t==="")return t;if(/[\t\n\r #%/:<>?@[\]^\\|]/g.test(t))throw new TypeError(`Invalid hostname '${t}'`);let s=new URL("https://example.com");return s.hostname=t,s.hostname}K(tr,"hostnameEncodeCallback");function sr(t){if(t==="")return t;if(/[^0-9a-fA-F[\]:]/g.test(t))throw new TypeError(`Invalid IPv6 hostname '${t}'`);return t.toLowerCase()}K(sr,"ipv6HostnameEncodeCallback");function nr(t){if(t===""||/^[0-9]*$/.test(t)&&parseInt(t)<=65535)return t;throw new TypeError(`Invalid port '${t}'.`)}K(nr,"portEncodeCallback");function vc(t){if(t==="")return t;let s=new URL("https://example.com");return s.pathname=t[0]!=="/"?"/-"+t:t,t[0]!=="/"?s.pathname.substring(2,s.pathname.length):s.pathname}K(vc,"standardURLPathnameEncodeCallback");function yc(t){return t===""?t:new URL(`data:${t}`).pathname}K(yc,"pathURLPathnameEncodeCallback");function bc(t){if(t==="")return t;let s=new URL("https://example.com");return s.search=t,s.search.substring(1,s.search.length)}K(bc,"searchEncodeCallback");function jc(t){if(t==="")return t;let s=new URL("https://example.com");return s.hash=t,s.hash.substring(1,s.hash.length)}K(jc,"hashEncodeCallback");var Nc=class{#r;#n=[];#t={};#e=0;#a=1;#l=0;#o=0;#f=0;#p=0;#h=!1;constructor(t){this.#r=t}get result(){return this.#t}parse(){for(this.#n=Ka(this.#r,!0);this.#e<this.#n.length;this.#e+=this.#a){if(this.#a=1,this.#n[this.#e].type==="END"){if(this.#o===0){this.#y(),this.#d()?this.#s(9,1):this.#u()?this.#s(8,1):this.#s(7,0);continue}else if(this.#o===2){this.#m(5);continue}this.#s(10,0);break}if(this.#f>0)if(this.#S())this.#f-=1;else continue;if(this.#k()){this.#f+=1;continue}switch(this.#o){case 0:this.#b()&&this.#m(1);break;case 1:if(this.#b()){this.#T();let t=7,s=1;this.#N()?(t=2,s=3):this.#h&&(t=2),this.#s(t,s)}break;case 2:this.#g()?this.#m(3):(this.#v()||this.#u()||this.#d())&&this.#m(5);break;case 3:this.#w()?this.#s(4,1):this.#g()&&this.#s(5,1);break;case 4:this.#g()&&this.#s(5,1);break;case 5:this.#A()?this.#p+=1:this.#I()&&(this.#p-=1),this.#C()&&!this.#p?this.#s(6,1):this.#v()?this.#s(7,0):this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 6:this.#v()?this.#s(7,0):this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 7:this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 8:this.#d()&&this.#s(9,1);break}}this.#t.hostname!==void 0&&this.#t.port===void 0&&(this.#t.port="")}#s(t,s){switch(this.#o){case 0:break;case 1:this.#t.protocol=this.#c();break;case 2:break;case 3:this.#t.username=this.#c();break;case 4:this.#t.password=this.#c();break;case 5:this.#t.hostname=this.#c();break;case 6:this.#t.port=this.#c();break;case 7:this.#t.pathname=this.#c();break;case 8:this.#t.search=this.#c();break;case 9:this.#t.hash=this.#c();break}this.#o!==0&&t!==10&&([1,2,3,4].includes(this.#o)&&[6,7,8,9].includes(t)&&(this.#t.hostname??=""),[1,2,3,4,5,6].includes(this.#o)&&[8,9].includes(t)&&(this.#t.pathname??=this.#h?"/":""),[1,2,3,4,5,6,7].includes(this.#o)&&t===9&&(this.#t.search??="")),this.#j(t,s)}#j(t,s){this.#o=t,this.#l=this.#e+s,this.#e+=s,this.#a=0}#y(){this.#e=this.#l,this.#a=0}#m(t){this.#y(),this.#o=t}#x(t){return t<0&&(t=this.#n.length-t),t<this.#n.length?this.#n[t]:this.#n[this.#n.length-1]}#i(t,s){let n=this.#x(t);return n.value===s&&(n.type==="CHAR"||n.type==="ESCAPED_CHAR"||n.type==="INVALID_CHAR")}#b(){return this.#i(this.#e,":")}#N(){return this.#i(this.#e+1,"/")&&this.#i(this.#e+2,"/")}#g(){return this.#i(this.#e,"@")}#w(){return this.#i(this.#e,":")}#C(){return this.#i(this.#e,":")}#v(){return this.#i(this.#e,"/")}#u(){if(this.#i(this.#e,"?"))return!0;if(this.#n[this.#e].value!=="?")return!1;let t=this.#x(this.#e-1);return t.type!=="NAME"&&t.type!=="REGEX"&&t.type!=="CLOSE"&&t.type!=="ASTERISK"}#d(){return this.#i(this.#e,"#")}#k(){return this.#n[this.#e].type=="OPEN"}#S(){return this.#n[this.#e].type=="CLOSE"}#A(){return this.#i(this.#e,"[")}#I(){return this.#i(this.#e,"]")}#c(){let t=this.#n[this.#e],s=this.#x(this.#l).index;return this.#r.substring(s,t.index)}#T(){let t={};Object.assign(t,lt),t.encodePart=Wn;let s=ac(this.#c(),void 0,t);this.#h=Za(s)}};K(Nc,"Parser");var ea=["protocol","username","password","hostname","port","pathname","search","hash"],ot="*";function pa(t,s){if(typeof t!="string")throw new TypeError("parameter 1 is not of type 'string'.");let n=new URL(t,s);return{protocol:n.protocol.substring(0,n.protocol.length-1),username:n.username,password:n.password,hostname:n.hostname,port:n.port,pathname:n.pathname,search:n.search!==""?n.search.substring(1,n.search.length):void 0,hash:n.hash!==""?n.hash.substring(1,n.hash.length):void 0}}K(pa,"extractValues");function Fe(t,s){return s?ts(t):t}K(Fe,"processBaseURLString");function es(t,s,n){let a;if(typeof s.baseURL=="string")try{a=new URL(s.baseURL),s.protocol===void 0&&(t.protocol=Fe(a.protocol.substring(0,a.protocol.length-1),n)),!n&&s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.username===void 0&&(t.username=Fe(a.username,n)),!n&&s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.username===void 0&&s.password===void 0&&(t.password=Fe(a.password,n)),s.protocol===void 0&&s.hostname===void 0&&(t.hostname=Fe(a.hostname,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&(t.port=Fe(a.port,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&(t.pathname=Fe(a.pathname,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&s.search===void 0&&(t.search=Fe(a.search.substring(1,a.search.length),n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&s.search===void 0&&s.hash===void 0&&(t.hash=Fe(a.hash.substring(1,a.hash.length),n))}catch{throw new TypeError(`invalid baseURL '${s.baseURL}'.`)}if(typeof s.protocol=="string"&&(t.protocol=hc(s.protocol,n)),typeof s.username=="string"&&(t.username=mc(s.username,n)),typeof s.password=="string"&&(t.password=uc(s.password,n)),typeof s.hostname=="string"&&(t.hostname=dc(s.hostname,n)),typeof s.port=="string"&&(t.port=pc(s.port,t.protocol,n)),typeof s.pathname=="string"){if(t.pathname=s.pathname,a&&!rc(t.pathname,n)){let r=a.pathname.lastIndexOf("/");r>=0&&(t.pathname=Fe(a.pathname.substring(0,r+1),n)+t.pathname)}t.pathname=fc(t.pathname,t.protocol,n)}return typeof s.search=="string"&&(t.search=lc(s.search,n)),typeof s.hash=="string"&&(t.hash=cc(s.hash,n)),t}K(es,"applyInit");function ts(t){return t.replace(/([+*?:{}()\\])/g,"\\$1")}K(ts,"escapePatternString");function wc(t){return t.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}K(wc,"escapeRegexpString");function Cc(t,s){s.delimiter??="/#?",s.prefixes??="./",s.sensitive??=!1,s.strict??=!1,s.end??=!0,s.start??=!0,s.endsWith="";let n=".*",a=`[^${wc(s.delimiter)}]+?`,r=/[$_\u200C\u200D\p{ID_Continue}]/u,o="";for(let c=0;c<t.length;++c){let i=t[c];if(i.type===3){if(i.modifier===3){o+=ts(i.value);continue}o+=`{${ts(i.value)}}${_t(i.modifier)}`;continue}let l=i.hasCustomName(),m=!!i.suffix.length||!!i.prefix.length&&(i.prefix.length!==1||!s.prefixes.includes(i.prefix)),u=c>0?t[c-1]:null,f=c<t.length-1?t[c+1]:null;if(!m&&l&&i.type===1&&i.modifier===3&&f&&!f.prefix.length&&!f.suffix.length)if(f.type===3){let h=f.value.length>0?f.value[0]:"";m=r.test(h)}else m=!f.hasCustomName();if(!m&&!i.prefix.length&&u&&u.type===3){let h=u.value[u.value.length-1];m=s.prefixes.includes(h)}m&&(o+="{"),o+=ts(i.prefix),l&&(o+=`:${i.name}`),i.type===2?o+=`(${i.value})`:i.type===1?l||(o+=`(${a})`):i.type===0&&(!l&&(!u||u.type===3||u.modifier!==3||m||i.prefix!=="")?o+="*":o+=`(${n})`),i.type===1&&l&&i.suffix.length&&r.test(i.suffix[0])&&(o+="\\"),o+=ts(i.suffix),m&&(o+="}"),i.modifier!==3&&(o+=_t(i.modifier))}return o}K(Cc,"partsToPattern");var kc=class{#r;#n={};#t={};#e={};#a={};#l=!1;constructor(t={},s,n){try{let a;if(typeof s=="string"?a=s:n=s,typeof t=="string"){let i=new Nc(t);if(i.parse(),t=i.result,a===void 0&&typeof t.protocol!="string")throw new TypeError("A base URL must be provided for a relative constructor string.");t.baseURL=a}else{if(!t||typeof t!="object")throw new TypeError("parameter 1 is not of type 'string' and cannot convert to dictionary.");if(a)throw new TypeError("parameter 1 is not of type 'string'.")}typeof n>"u"&&(n={ignoreCase:!1});let r={ignoreCase:n.ignoreCase===!0},o={pathname:ot,protocol:ot,username:ot,password:ot,hostname:ot,port:ot,search:ot,hash:ot};this.#r=es(o,t,!0),er(this.#r.protocol)===this.#r.port&&(this.#r.port="");let c;for(c of ea){if(!(c in this.#r))continue;let i={},l=this.#r[c];switch(this.#t[c]=[],c){case"protocol":Object.assign(i,lt),i.encodePart=Wn;break;case"username":Object.assign(i,lt),i.encodePart=xc;break;case"password":Object.assign(i,lt),i.encodePart=gc;break;case"hostname":Object.assign(i,vx),Xa(l)?i.encodePart=sr:i.encodePart=tr;break;case"port":Object.assign(i,lt),i.encodePart=nr;break;case"pathname":Za(this.#n.protocol)?(Object.assign(i,yx,r),i.encodePart=vc):(Object.assign(i,lt,r),i.encodePart=yc);break;case"search":Object.assign(i,lt,r),i.encodePart=bc;break;case"hash":Object.assign(i,lt,r),i.encodePart=jc;break}try{this.#a[c]=Ga(l,i),this.#n[c]=Qa(this.#a[c],this.#t[c],i),this.#e[c]=Cc(this.#a[c],i),this.#l=this.#l||this.#a[c].some(m=>m.type===2)}catch{throw new TypeError(`invalid ${c} pattern '${this.#r[c]}'.`)}}}catch(a){throw new TypeError(`Failed to construct 'URLPattern': ${a.message}`)}}get[Symbol.toStringTag](){return"URLPattern"}test(t={},s){let n={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof t!="string"&&s)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof t>"u")return!1;try{typeof t=="object"?n=es(n,t,!1):n=es(n,pa(t,s),!1)}catch{return!1}let a;for(a of ea)if(!this.#n[a].exec(n[a]))return!1;return!0}exec(t={},s){let n={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof t!="string"&&s)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof t>"u")return;try{typeof t=="object"?n=es(n,t,!1):n=es(n,pa(t,s),!1)}catch{return null}let a={};s?a.inputs=[t,s]:a.inputs=[t];let r;for(r of ea){let o=this.#n[r].exec(n[r]);if(!o)return null;let c={};for(let[i,l]of this.#t[r].entries())if(typeof l=="string"||typeof l=="number"){let m=o[i+1];c[l]=m}a[r]={input:n[r]??"",groups:c}}return a}static compareComponent(t,s,n){let a=K((i,l)=>{for(let m of["type","modifier","prefix","value","suffix"]){if(i[m]<l[m])return-1;if(i[m]!==l[m])return 1}return 0},"comparePart"),r=new ns(3,"","","","",3),o=new ns(0,"","","","",3),c=K((i,l)=>{let m=0;for(;m<Math.min(i.length,l.length);++m){let u=a(i[m],l[m]);if(u)return u}return i.length===l.length?0:a(i[m]??r,l[m]??r)},"comparePartList");return!s.#e[t]&&!n.#e[t]?0:s.#e[t]&&!n.#e[t]?c(s.#a[t],[o]):!s.#e[t]&&n.#e[t]?c([o],n.#a[t]):c(s.#a[t],n.#a[t])}get protocol(){return this.#e.protocol}get username(){return this.#e.username}get password(){return this.#e.password}get hostname(){return this.#e.hostname}get port(){return this.#e.port}get pathname(){return this.#e.pathname}get search(){return this.#e.search}get hash(){return this.#e.hash}get hasRegExpGroups(){return this.#l}};K(kc,"URLPattern");globalThis.URLPattern||(globalThis.URLPattern=kc);const bx=d.createContext({requestHistoryTick:()=>{}}),Sc=({children:t,requestHistoryTick:s})=>{const n=d.useMemo(()=>({requestHistoryTick:s}),[s]);return e.jsx(bx.Provider,{value:n,children:t})};Sc.__docgenInfo={description:"",methods:[],displayName:"HistoryQueueProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},requestHistoryTick:{required:!0,tsType:{name:"signature",type:"function",raw:"(cb: (resolve: () => void) => void) => void",signature:{arguments:[{type:{name:"signature",type:"function",raw:"(resolve: () => void) => void",signature:{arguments:[{type:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},name:"resolve"}],return:{name:"void"}}},name:"cb"}],return:{name:"void"}}},description:""}}};function is(){return is=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},is.apply(null,arguments)}var He;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(He||(He={}));var Nn=function(t){return t},ci="beforeunload",jx="popstate";function Nx(t){t===void 0&&(t={});var s=t,n=s.window,a=n===void 0?document.defaultView:n,r=a.history;function o(){var I=a.location,E=I.pathname,A=I.search,P=I.hash,k=r.state||{};return[k.idx,Nn({pathname:E,search:A,hash:P,state:k.usr||null,key:k.key||"default"})]}var c=null;function i(){if(c)v.call(c),c=null;else{var I=He.Pop,E=o(),A=E[0],P=E[1];if(v.length){if(A!=null){var k=u-A;k&&(c={action:I,location:P,retry:function(){S(k*-1)}},S(k))}}else j(I)}}a.addEventListener(jx,i);var l=He.Pop,m=o(),u=m[0],f=m[1],h=wn(),v=wn();u==null&&(u=0,r.replaceState(is({},r.state,{idx:u}),""));function y(I){return typeof I=="string"?I:Ac(I)}function p(I,E){return E===void 0&&(E=null),Nn(is({pathname:f.pathname,hash:"",search:""},typeof I=="string"?xa(I):I,{state:E,key:ha()}))}function x(I,E){return[{usr:I.state,key:I.key,idx:E},y(I)]}function g(I,E,A){return!v.length||(v.call({action:I,location:E,retry:A}),!1)}function j(I){l=I;var E=o();u=E[0],f=E[1],h.call({action:l,location:f})}function N(I,E){var A=He.Push,P=p(I,E);function k(){N(I,E)}if(g(A,P,k)){var T=x(P,u+1),C=T[0],_=T[1];try{r.pushState(C,"",_)}catch{a.location.assign(_)}j(A)}}function b(I,E){var A=He.Replace,P=p(I,E);function k(){b(I,E)}if(g(A,P,k)){var T=x(P,u),C=T[0],_=T[1];r.replaceState(C,"",_),j(A)}}function S(I){r.go(I)}var w={get action(){return l},get location(){return f},createHref:y,push:N,replace:b,go:S,back:function(){S(-1)},forward:function(){S(1)},listen:function(E){return h.push(E)},block:function(E){var A=v.push(E);return v.length===1&&a.addEventListener(ci,di),function(){A(),v.length||a.removeEventListener(ci,di)}}};return w}function wx(t){t===void 0&&(t={});var s=t,n=s.initialEntries,a=n===void 0?["/"]:n,r=s.initialIndex,o=a.map(function(N){var b=Nn(is({pathname:"/",search:"",hash:"",state:null,key:ha()},typeof N=="string"?xa(N):N));return b}),c=li(r??o.length-1,0,o.length-1),i=He.Pop,l=o[c],m=wn(),u=wn();function f(N){return typeof N=="string"?N:Ac(N)}function h(N,b){return b===void 0&&(b=null),Nn(is({pathname:l.pathname,search:"",hash:""},typeof N=="string"?xa(N):N,{state:b,key:ha()}))}function v(N,b,S){return!u.length||(u.call({action:N,location:b,retry:S}),!1)}function y(N,b){i=N,l=b,m.call({action:i,location:l})}function p(N,b){var S=He.Push,w=h(N,b);function I(){p(N,b)}v(S,w,I)&&(c+=1,o.splice(c,o.length,w),y(S,w))}function x(N,b){var S=He.Replace,w=h(N,b);function I(){x(N,b)}v(S,w,I)&&(o[c]=w,y(S,w))}function g(N){var b=li(c+N,0,o.length-1),S=He.Pop,w=o[b];function I(){g(N)}v(S,w,I)&&(c=b,y(S,w))}var j={get index(){return c},get action(){return i},get location(){return l},createHref:f,push:p,replace:x,go:g,back:function(){g(-1)},forward:function(){g(1)},listen:function(b){return m.push(b)},block:function(b){return u.push(b)}};return j}function li(t,s,n){return Math.min(Math.max(t,s),n)}function di(t){t.preventDefault(),t.returnValue=""}function wn(){var t=[];return{get length(){return t.length},push:function(n){return t.push(n),function(){t=t.filter(function(a){return a!==n})}},call:function(n){t.forEach(function(a){return a&&a(n)})}}}function ha(){return Math.random().toString(36).substr(2,8)}function Ac(t){var s=t.pathname,n=s===void 0?"/":s,a=t.search,r=a===void 0?"":a,o=t.hash,c=o===void 0?"":o;return r&&r!=="?"&&(n+=r.charAt(0)==="?"?r:"?"+r),c&&c!=="#"&&(n+=c.charAt(0)==="#"?c:"#"+c),n}function xa(t){var s={};if(t){var n=t.indexOf("#");n>=0&&(s.hash=t.substr(n),t=t.substr(0,n));var a=t.indexOf("?");a>=0&&(s.search=t.substr(a),t=t.substr(0,a)),t&&(s.pathname=t)}return s}const Cx=d.createContext([]);function Ic(t){return t.name==="Pushed"||t.name==="Popped"||t.name==="Replaced"}function kx(t){return t.name==="StepPushed"||t.name==="StepPopped"||t.name==="StepReplaced"}function Sx(t){return Ic(t)||kx(t)}const Tt={IDLE:"idle",PROGRESS:"progress",SUCCEEDED:"succeeded",FAILED:"failed"};function Tc(t){return t===Tt.SUCCEEDED||t===Tt.FAILED}class Ax{targetId;initialSetupProcess;focusCount;previousActivationTrigger;constructor(s,n){this.targetId=s,this.initialSetupProcess=n,this.focusCount=0,this.previousActivationTrigger=null}captureStackChange(s){const n=this.initialSetupProcess.getStatus();if(!Tc(n))return;const a=s.activities.find(o=>o.id===this.targetId);if(!a||!a.isActive)return;const r=s.events.findLast(Ic);!r||this.previousActivationTrigger&&r.eventDate<=this.previousActivationTrigger.eventDate||(this.focusCount++,this.previousActivationTrigger=r)}getActivationCount(){return this.focusCount}getTargetId(){return this.targetId}}const{parse:Ix,stringify:Tx}=JSON,{keys:Px}=Object,Ls=String,Pc="string",ui={},ar="object",Ec=(t,s)=>s,Ex=t=>t instanceof Ls?Ls(t):t,_x=(t,s)=>typeof s===Pc?new Ls(s):s,_c=(t,s,n,a)=>{const r=[];for(let o=Px(n),{length:c}=o,i=0;i<c;i++){const l=o[i],m=n[l];if(m instanceof Ls){const u=t[m];typeof u===ar&&!s.has(u)?(s.add(u),n[l]=ui,r.push({k:l,a:[t,s,u,a]})):n[l]=a.call(n,l,u)}else n[l]!==ui&&(n[l]=a.call(n,l,m))}for(let{length:o}=r,c=0;c<o;c++){const{k:i,a:l}=r[c];n[i]=a.call(n,i,_c.apply(null,l))}return n},mi=(t,s,n)=>{const a=Ls(s.push(n)-1);return t.set(n,a),a},Mx=(t,s)=>{const n=Ix(t,_x).map(Ex),a=n[0],r=s||Ec,o=typeof a===ar&&a?_c(n,new Set,a,r):a;return r.call({"":o},"",o)},Rx=(t,s,n)=>{const a=Ec,r=new Map,o=[],c=[];let i=+mi(r,o,a.call({"":t},"",t)),l=!i;for(;i<o.length;)l=!0,c[i]=Tx(o[i++],m,n);return"["+c.join(",")+"]";function m(u,f){if(l)return l=!l,f;const h=a.call(this,u,f);switch(typeof h){case ar:if(h===null)return h;case Pc:return r.get(h)||mi(r,o,h)}return h}},Mc="@biochain/plugin-navigation-sync";function Rc(t){return{_TAG:Mc,flattedState:Rx({activity:t.activity,step:t.step})}}function Lx(t){return typeof t=="object"&&t!==null&&"_TAG"in t&&"flattedState"in t&&typeof t._TAG=="string"&&t._TAG===Mc&&typeof t.flattedState=="string"}function tn(t){try{return Lx(t)?Mx(t.flattedState):null}catch{return null}}function fi({history:t,pathname:s,state:n,useHash:a}){const r=a?`${t.location.pathname}#${s}`:s;t.push(r,Rc(n))}function ta({history:t,pathname:s,state:n,useHash:a}){const r=a?`${t.location.pathname}#${s}`:s;t.replace(r,Rc(n))}function pi(t){return t.length===0?void 0:t[t.length-1]}const zx=t=>{let s=Promise.resolve();return{requestHistoryTick:a=>{s=s.then(()=>new Promise(r=>{const o=t.listen(()=>{o(),r()});a(()=>{o(),r()})}))}}};function Lc(t){return new URL(t,"file://")}function ga(t){const s={};return t.forEach((n,a)=>{s[a]=n}),s}function sn(t){return t.endsWith("/")?t:`${t}/`}function hi(t){return t.toString().length>0?`?${t}`:t}function Me({path:t,decode:s},n){const a=t==="*"||t==="/*",r=a?[]:Array.from(t.matchAll(/:([A-Za-z0-9_]+)/g)).map(m=>m[1]).filter(Boolean),o=Array.from(new Set(r)),c=a?Number.POSITIVE_INFINITY:o.length,i=a?"*":sn(t),l=a?null:new URLPattern({pathname:i});return{fill(m){if(a){const v=new URLSearchParams(Object.entries(m).reduce((y,[p,x])=>x?{...y,[p]:x}:y,{}));return sn("/")+hi(v)}let u=t;for(const v of o){const y=m[v];if(y===void 0)throw new Error(`Missing route param: ${v}`);u=u.replace(`:${v}`,encodeURIComponent(y))}u=sn(u);const f={...m};o.forEach(v=>{delete f[v]});const h=new URLSearchParams(Object.entries(f).reduce((v,[y,p])=>({...v,...p?{[y]:p}:null}),{}));return u+hi(h)},parse(m){const u=Lc(m);if(a){const g={...ga(u.searchParams)};return s?s(g):g}if(!l)return null;const f=sn(u.pathname),h=l.exec({pathname:f}),v=ga(u.searchParams);if(!h)return null;const y=h.pathname.groups,p={...v};for(const[x,g]of Object.entries(y))g!==void 0&&(p[x]=g);return s?s(p):p},variableCount:c}}class Dx{status;pendingNavigations;dispatchedEvents;baseNavigationEvents;constructor(s,n=[]){this.status=s.length>0?Tt.IDLE:Tt.SUCCEEDED,this.pendingNavigations=s.slice(),this.dispatchedEvents=[],this.baseNavigationEvents=n}captureNavigationOpportunity(s){if(Tc(this.status))return[];if(s&&s.globalTransitionState!=="idle")return[];if(this.pendingNavigations.length===0)return this.status=Tt.SUCCEEDED,[];const n=s?s.events.filter(Sx):[];if(!(this.verifyAllDispatchedEventsAreInNavigationHistory(n)&&this.verifyNoUnknownNavigationEvents(n)))return this.pendingNavigations=[],this.status=Tt.FAILED,[];const a=this.pendingNavigations.shift();if(!a)return[];const r=a();return this.dispatchedEvents.push(...r),this.status=Tt.PROGRESS,r}getStatus(){return this.status}verifyAllDispatchedEventsAreInNavigationHistory(s){const n=new Set(s.map(a=>a.id));return this.dispatchedEvents.every(a=>n.has(a.id))}verifyNoUnknownNavigationEvents(s){const n=new Set([...this.baseNavigationEvents,...this.dispatchedEvents].map(a=>a.id));return s.every(a=>n.has(a.id))}}function Bx(t){return typeof t=="string"?{path:t}:t}function Ox(t){return(Array.isArray(t)?t:[t]).map(Bx)}function Wx(t){return Object.keys(t).flatMap(n=>{const a=t[n];return a?Ox(a).map(r=>({activityName:n,...r})):[]})}class Fx{latestlyBookedSession=Promise.resolve();acquire(){return new Promise(s=>{this.latestlyBookedSession=this.latestlyBookedSession.then(()=>new Promise(n=>s({release:()=>n()})))})}async runExclusively(s){const{release:n}=await this.acquire();try{return await s()}finally{n()}}}class $x{subscribers=[];publishLock=new Fx;subscribe(s){return this.subscribers.push(s),()=>{this.subscribers=this.subscribers.filter(n=>n!==s)}}publish(s){const n=this.subscribers.slice();return this.publishLock.runExclusively(()=>Promise.allSettled(n.map(a=>a(s))))}}const qx=d.createContext([]),rr=t=>e.jsx(qx.Provider,{value:t.routes,children:t.children});rr.displayName="RoutesProvider";rr.__docgenInfo={description:"",methods:[],displayName:"RoutesProvider",props:{routes:{required:!0,tsType:{name:"Array",elements:[{name:"ActivityRoute",elements:[{name:"T"}],raw:"ActivityRoute<T>"}],raw:"ActivityRoute<T>[]"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const Hx=/^:[\w-]+$/,Ux=3,Vx=1,Jx=10,Kx=-2,xi=t=>t==="*";function gi(t){const s=t.split("/");let n=s.length;return s.some(xi)&&(n+=Kx),s.filter(a=>!xi(a)).reduce((a,r)=>a+(Hx.test(r)?Ux:r===""?Vx:Jx),n)}function Gx(t){return[...t].toSorted((s,n)=>gi(n.path)-gi(s.path))}const Qx=1e3,Yx=60*Qx;function Xx(t){"config"in t&&t.config.decorate("historySync",{makeTemplate:Me,urlPatternOptions:t.urlPatternOptions});const s=t.history??(typeof window>"u"?wx({}):Nx({window})),{location:n}=s,a="routes"in t?t.routes:t.config.activities.reduce((o,c)=>({...o,[c.name]:c.route}),{}),r=Gx(Wx(a));return()=>{let o=0,c=!1,i=null;const l=[],m=new $x,{requestHistoryTick:u}=zx(s),f=p=>m.subscribe(async()=>p());let h=null;const v=()=>{const p=l.map(x=>({activityId:x.getTargetId(),activationCount:x.getActivationCount()}));return(!h||h.length!==p.length||h.some(({activityId:x,activationCount:g})=>p.some(({activityId:j,activationCount:N})=>j===x&&N!==g)))&&(h=p),h},y=p=>{let x=!1;for(const g of l){const j=g.getActivationCount();g.captureStackChange(p),j!==g.getActivationCount()&&(x=!0)}x&&m.publish()};return{key:"plugin-history-sync",wrapStack({stack:p}){const x=d.useSyncExternalStore(f,v,v);return e.jsx(Sc,{requestHistoryTick:u,children:e.jsx(rr,{routes:r,children:e.jsx(Cx.Provider,{value:x,children:p.render()})})})},overrideInitialEvents({initialContext:p}){const x=tn(s.location.state);if(x)return[{...x.activity.enteredBy,name:"Pushed"},...x.step?.enteredBy.name==="StepPushed"||x.step?.enteredBy.name==="StepReplaced"?[{...x.step.enteredBy,name:"StepPushed"}]:[]];function g(){return p?.req?.path&&typeof p.req.path=="string"?p.req.path:t.useHash?n.hash.split("#")[1]??"/":n.pathname+n.search}const j=g(),N=t.fallbackActivity({initialContext:p}),b=r.find(A=>Me(A,t.urlPatternOptions).parse(j)!==null)??r.find(A=>A.activityName===N),w=Me(b,t.urlPatternOptions).parse(j)??{},I=Object.entries(w).reduce((A,[P,k])=>(typeof k=="string"&&(A[P]=k),A),{}),E=b.defaultHistory?.(I)??[];return i=new Dx([...E.map(({activityName:A,activityParams:P,additionalSteps:k=[]})=>()=>{const T=[{name:"Pushed",id:Qe(),activityId:Qe(),activityName:A,activityParams:{...P},activityContext:{path:j,lazyActivityComponentRenderContext:{shouldRenderImmediately:!0}}},...k.map(({stepParams:C,hasZIndex:_})=>({name:"StepPushed",id:Qe(),stepId:Qe(),stepParams:C,hasZIndex:_}))];for(const C of T)C.name==="Pushed"&&l.push(new Ax(C.activityId,i));return T}),()=>[{name:"Pushed",id:Qe(),activityId:Qe(),activityName:b.activityName,activityParams:Me(b,t.urlPatternOptions).parse(j)??ga(Lc(j).searchParams),activityContext:{path:j,lazyActivityComponentRenderContext:{shouldRenderImmediately:!0}}}]]),i.captureNavigationOpportunity(null).map(A=>({...A,eventDate:Date.now()-Yx}))},onInit({actions:{getStack:p,dispatchEvent:x,push:g,stepPush:j}}){const N=p(),b=N.activities[0],S=r.find(A=>A.activityName===b.name),w=Me(S,t.urlPatternOptions),I=pi(b.steps);u(()=>{c=!0,ta({history:s,pathname:w.fill(b.params),state:{activity:b,step:I},useHash:t.useHash})});const E=A=>{if(c){c=!1;return}const P=tn(A.location.state);if(!P)return;const k=P.activity,T=P.activity.id,C=P.step,{activities:_}=p(),z=_.find(G=>G.isActive);if(!z)return;const D=pi(z.steps),L=_.find(G=>G.id===T),J=z.steps.find(G=>G.id===C?.id),M=()=>z.id>T,O=()=>z.id<T,Q=()=>z.id===T,te=()=>Q()?!!(!C||D&&D.id>C.id):!1,W=()=>Q()?!!(!D||C&&D.id<C.id):!1;if(M()&&(x("Popped",{}),!L&&(o+=1,g({...k.enteredBy}),C?.enteredBy.name==="StepPushed"||C?.enteredBy.name==="StepReplaced"))){const{enteredBy:G}=C;o+=1,j({...G})}if(te()){if(!J&&C&&(C?.enteredBy.name==="StepPushed"||C?.enteredBy.name==="StepReplaced")){const{enteredBy:G}=C;o+=1,j({...G})}x("StepPopped",{})}if(O()&&(o+=1,g({activityId:k.id,activityName:k.name,activityParams:k.params})),W()){if(!C)return;o+=1,j({stepId:C.id,stepParams:C.params})}};s.listen(E),i?.captureNavigationOpportunity(N).forEach(A=>A.name==="Pushed"?g(A):j(A)),y(N)},onPushed({effect:{activity:p}}){if(o){o-=1;return}const x=r.find(j=>j.activityName===p.name),g=Me(x,t.urlPatternOptions);u(()=>{c=!0,fi({history:s,pathname:g.fill(p.params),state:{activity:p},useHash:t.useHash})})},onStepPushed({effect:{activity:p,step:x}}){if(o){o-=1;return}const g=r.find(N=>N.activityName===p.name),j=Me(g,t.urlPatternOptions);u(()=>{c=!0,fi({history:s,pathname:j.fill(p.params),state:{activity:p,step:x},useHash:t.useHash})})},onReplaced({effect:{activity:p}}){if(!p.isActive)return;const x=r.find(j=>j.activityName===p.name),g=Me(x,t.urlPatternOptions);u(()=>{c=!0,ta({history:s,pathname:g.fill(p.params),state:{activity:p},useHash:t.useHash})})},onStepReplaced({effect:{activity:p,step:x}}){if(!p.isActive)return;const g=r.find(N=>N.activityName===p.name),j=Me(g,t.urlPatternOptions);u(()=>{c=!0,ta({history:s,pathname:j.fill(p.params),state:{activity:p,step:x},useHash:t.useHash})})},onBeforePush({actionParams:p,actions:{overrideActionParams:x}}){if(!p.activityContext||!("path"in p.activityContext)){const g=r.find(b=>b.activityName===p.activityName),N=Me(g,t.urlPatternOptions).fill(p.activityParams);x({...p,activityContext:{...p.activityContext,path:N}})}},onBeforeReplace({actionParams:p,actions:{overrideActionParams:x,getStack:g}}){if(!p.activityContext||!("path"in p.activityContext)){const S=r.find(E=>E.activityName===p.activityName),I=Me(S,t.urlPatternOptions).fill(p.activityParams);x({...p,activityContext:{...p.activityContext,path:I}})}const{activities:j}=g(),N=j.filter(S=>S.transitionState==="enter-active"||S.transitionState==="enter-done"),b=N.length>0?N[N.length-1]:null;if(b)for(let S=0;S<b.steps.length-1;S+=1)u(w=>{tn(s.location.state)?w():(c=!0,s.back())}),u(()=>{c=!0,s.back()})},onBeforeStepPop({actions:{getStack:p}}){const{activities:x}=p();(x.find(j=>j.isActive)?.steps.length??0)>1&&u(()=>{c=!0,s.back()})},onBeforePop({actions:{getStack:p}}){const{activities:x}=p(),g=x.find(j=>j.isActive);if(g){const{isRoot:j,steps:N}=g,b=j?0:N.length;for(let S=0;S<b;S+=1)u(w=>{tn(s.location.state)?w():(c=!0,s.back())}),u(()=>{c=!0,s.back()})}},onChanged({actions:{getStack:p,push:x,stepPush:g}}){const j=p();i?.captureNavigationOpportunity(j).forEach(N=>N.name==="Pushed"?x(N):g(N)),y(j)}}}}function zc(){const{t}=B(["settings","common"]),[s,n]=d.useState(!1),a=()=>{n(!0);const r="./";window.location.href=`${r}clear.html`};return e.jsx("div",{className:"bg-background flex min-h-screen flex-col items-center justify-center p-6",children:e.jsxs("div",{className:"flex max-w-sm flex-col items-center gap-6 text-center",children:[e.jsx("div",{className:"bg-destructive/10 flex size-20 items-center justify-center rounded-full",children:e.jsx(_e,{className:"text-destructive size-10"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-xl font-bold",children:t("settings:storage.migrationRequired")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:t("settings:storage.migrationDesc")})]}),e.jsx("div",{className:"bg-destructive/5 w-full rounded-lg p-4",children:e.jsxs("ul",{className:"text-destructive space-y-2 text-left text-sm",children:[e.jsxs("li",{children:[" ",t("settings:clearData.item1")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item2")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item3")]})]})}),e.jsxs(q,{variant:"destructive",onClick:a,className:"w-full gap-2",disabled:s,children:[e.jsx(qt,{className:"size-4"}),t("settings:clearData.confirm")]})]})})}zc.__docgenInfo={description:`


 Stackflow context  useFlow()`,methods:[],displayName:"MigrationRequiredView"};function Zx(t){switch(t){case"confirmed":return"confirmed";case"failed":return"failed";default:return"pending"}}function Dc(t,s){const n=t.meta?.displayAmount??"0",a=t.meta?.displaySymbol??"",r=ne.fromFormatted(n,s,a);return{id:`${t.chainId}--${t.txHash}`,type:t.meta?.type??"other",status:Zx(t.status),amount:r,symbol:a,address:t.meta?.displayToAddress??t.fromAddress,timestamp:new Date(t.createdAt),hash:t.txHash,chain:t.chainId}}const Bc=d.createContext(null);function jt({chainId:t,children:s,fallback:n=null}){const a=d.useMemo(()=>t?Pe(t):null,[t]);return a?e.jsx(Bc.Provider,{value:a,children:s},t):e.jsx(e.Fragment,{children:n})}function Kt(){const t=d.useContext(Bc);if(!t)throw new Error("useChainProvider must be used within ChainProviderGate. Make sure to wrap your component with <ChainProviderGate chainId={...}>.");return t}jt.__docgenInfo={description:`ChainProvider 

 ChainProvider 
 chainId  fallback  null

@example
\`\`\`tsx
<ChainProviderGate chainId={selectedChain} fallback={<ChainNotSupported />}>
  <WalletContent />
</ChainProviderGate>
\`\`\``,methods:[],displayName:"ChainProviderGate",props:{chainId:{required:!0,tsType:{name:"union",raw:"string | null | undefined",elements:[{name:"string"},{name:"null"},{name:"undefined"}]},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},fallback:{required:!1,tsType:{name:"ReactNode"},description:" provider ",defaultValue:{value:"null",computed:!1}}}};function va(t,s){return d.useMemo(()=>t?t instanceof Qi?{supported:!1,limited:!1,type:"notSupported",reason:s("common:service.notSupported")}:t instanceof zu?{supported:!0,limited:!0,type:"limited",reason:s("common:service.limited")}:{supported:!0,limited:!1,type:"error",error:t,reason:t.message}:{supported:!0,limited:!1,type:"ok"},[t,s])}function eg(t,s){return t==="transfer"?s==="in"?"receive":"send":{swap:"swap",exchange:"exchange",approve:"approve",stake:"stake",unstake:"unstake",mint:"mint",burn:"destroy",gift:"gift",grab:"grab",trust:"trust",signFor:"signFor",emigrate:"emigrate",immigrate:"immigrate",issueAsset:"issueAsset",increaseAsset:"increaseAsset",destroyAsset:"destroy",issueEntity:"issueEntity",destroyEntity:"destroyEntity",locationName:"locationName",dapp:"dapp",certificate:"certificate",mark:"mark",signature:"signature"}[t]??"other"}function tg(t,s){const n=l=>l?s?`${s}--${l}`:l:"unknown";if(!t||!t.hash||!t.assets||t.assets.length===0)return{id:n(t?.hash),type:"other",status:"pending",amount:ne.fromRaw("0",8,""),symbol:"",address:t?.from??t?.to??"",timestamp:new Date,hash:t?.hash,chain:s};const a=t.assets[0],r=t.direction==="in"?t.from:t.to;let o=8,c="0",i="";return(a.assetType==="native"||a.assetType==="token")&&(o=a.decimals??8,c=a.value??"0",i=a.symbol??""),{id:n(t.hash),type:eg(t.action,t.direction),status:t.status,amount:ne.fromRaw(c,o,i),symbol:i,address:r,timestamp:new Date(t.timestamp),hash:t.hash,chain:s}}function Oc(t,s){return!t||!Array.isArray(t)?[]:t.filter(n=>n!=null).map(n=>{try{return tg(n,s)}catch(a){return console.warn("[toTransactionInfoList] Failed to convert transaction:",n,a),{id:s?`${s}--${n?.hash??"error"}`:n?.hash??"error",type:"other",status:"pending",amount:ne.fromRaw("0",8,""),symbol:"",address:"",timestamp:new Date,chain:s}}})}function sg({address:t,selectedChain:s,selectedChainName:n,mainAssetSymbol:a,wallets:r,currentWalletId:o,chainPreferences:c,onWalletChange:i,onCopyAddress:l,onOpenChainSelector:m,onOpenSettings:u,onOpenWalletList:f,onAddWallet:h,onOpenAddressBalance:v,onOpenAddressTransactions:y}){const{push:p}=Y(),x=Vs(),{t:g}=B(["home","wallet","common","transaction"]),j=st(),N=j.snapshot?Je.getChainById(j,s):void 0,b=Kt(),{data:S=[],isLoading:w,isFetching:I,error:E}=b.allBalances.useState({address:t},{enabled:!!t}),{data:A,isLoading:P,isFetching:k,error:T}=b.transactionHistory.useState({address:t,limit:50},{enabled:!!t}),C=w||I&&S.length===0,_=va(E,g),z=va(T,g),{transactions:D,deleteTransaction:L,retryTransaction:J}=Vi(o??void 0,s,t,A),M=d.useMemo(()=>A?Oc(A,s):[],[A,s]),O=P||k&&M.length===0,Q=d.useCallback(W=>{if(W.id){const G=A?.find(se=>se.hash===W.hash),ve=G?Dt.stringify(G):void 0;p("TransactionDetailActivity",{txId:W.id,txData:ve})}},[p,A]),te=d.useCallback((W,G)=>[{label:g("home:wallet.transfer"),icon:e.jsx(bo,{className:"size-4"}),onClick:()=>{x.impact("light"),p("SendActivity",{assetType:W.symbol})}},{label:g("home:wallet.destroy"),icon:e.jsx(pn,{className:"size-4"}),onClick:()=>{x.impact("light"),p("DestroyActivity",{assetType:W.symbol,assetLocked:"true"})},variant:"destructive",show:G.canDestroy}],[x,p,g]);return e.jsxs("div",{"data-testid":"wallet-home",className:"flex h-full flex-col overflow-y-auto bg-background",children:[e.jsxs("div",{className:"pt-2 pb-1",children:[e.jsx(cu,{wallets:r,currentWalletId:o,selectedChain:s,chainPreferences:c,onWalletChange:i,onCopyAddress:l,onOpenChainSelector:m,onOpenSettings:u,onOpenWalletList:f,onAddWallet:h,onOpenAddressBalance:v,onOpenAddressTransactions:y}),e.jsxs("div",{className:"mt-2 flex justify-center gap-8 px-6",children:[e.jsxs("button",{onClick:()=>p("SendActivity",{}),"data-testid":"wallet-home-send-button",className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:e.jsx(So,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:g("home:wallet.send")})]}),e.jsxs("button",{onClick:()=>p("ReceiveActivity",{}),"data-testid":"wallet-home-receive-button",className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:e.jsx(zf,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:g("home:wallet.receive")})]}),e.jsxs("button",{onClick:()=>p("ScannerActivity",{}),"data-testid":"wallet-home-scan-button",className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:e.jsx($u,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:g("common:a11y.scan")})]})]})]}),D.length>0&&e.jsxs("div",{className:"px-4 pt-2 space-y-2",children:[e.jsx("h3",{className:"text-muted-foreground text-xs font-medium uppercase tracking-wider px-1",children:g("transaction:pendingTx.title")}),e.jsx("div",{className:"space-y-1",children:D.slice(0,3).map(W=>{const G=Dc(W,N?.decimals??8);return e.jsx(Yi,{transaction:G,onClick:()=>p("TransactionDetailActivity",{txId:G.id}),onRetry:W.status==="failed"?()=>J(W):void 0,onDelete:()=>L(W)},W.id)})}),D.length>3&&e.jsx("button",{onClick:()=>p("HistoryActivity",{chain:s}),className:"mt-2 w-full rounded-lg bg-muted/60 py-2 text-xs font-medium text-muted-foreground transition-colors hover:bg-muted",children:g("transaction:pendingTx.viewAll",{count:D.length})})]}),e.jsx("div",{className:"flex-1 pt-3",children:e.jsx(Pu,{chainId:s,chainName:n,tokens:S.map(W=>({symbol:W.symbol,name:W.name,chain:s,balance:W.amount.toFormatted(),decimals:W.decimals,fiatValue:void 0,change24h:0,icon:W.icon})),transactions:M.slice(0,5),tokensLoading:C,tokensRefreshing:I&&S.length>0,transactionsLoading:O,transactionsRefreshing:k&&M.length>0,tokensSupported:_.type!=="notSupported",tokensFallbackReason:_.type!=="ok"?_.reason:void 0,transactionsSupported:z.type!=="notSupported"&&z.type!=="limited",transactionsFallbackReason:z.type!=="ok"?z.reason:void 0,onTokenClick:W=>{},onTransactionClick:Q,mainAssetSymbol:a,tokenMenuItems:te,renderTransactionFooter:()=>e.jsx("button",{onClick:()=>p("HistoryActivity",{chain:M.length>0?s:"all"}),className:"mt-3 w-full rounded-lg bg-muted/60 py-2.5 text-sm font-medium text-muted-foreground transition-colors hover:bg-muted",children:M.length>0?g("transaction:history.viewAll",{count:M.length}):g("transaction:history.viewAllChains")}),testId:"wallet-home"})}),e.jsx("div",{className:"shrink-0 h-[var(--tab-bar-height)]"})]})}function Wc(){const{push:t}=Y(),s=Wa(),n=at(),a=Vs(),{t:r}=B(["home","wallet","common","transaction"]),o=uu(),c=gu(),i=vu(),l=yt(),m=Ae(),u=zn(),f=m?.id??null,h=Be(),v=ka(),y=r(`common:chains.${h}`,{defaultValue:h}),p=st(),g=(p.snapshot?Je.getChainById(p,h):null)?.symbol;qi();const j=u?.address??"",N=d.useCallback(async k=>{await s.write({text:k}),await a.impact("light"),n.show(r("home:wallet.addressCopied"))},[s,a,n,r]),b=d.useCallback(k=>{k!==f&&fe.setCurrentWallet(k),t("ChainSelectorJob",{})},[t,f]),S=d.useCallback(k=>{const T=l.find(C=>C.id===k);T&&t("WalletConfigActivity",{walletId:k,walletName:T.name})},[t,l]),w=d.useCallback(k=>{fe.setCurrentWallet(k)},[]),I=d.useCallback(()=>{t("WalletAddJob",{})},[t]),E=d.useCallback(()=>{t("WalletListJob",{})},[t]),A=d.useCallback(()=>{t("AddressBalanceActivity",{})},[t]),P=d.useCallback(()=>{t("AddressTransactionsActivity",{})},[t]);return o?e.jsx(zc,{}):c?!i||!m?e.jsx(ng,{}):e.jsx(jt,{chainId:h,fallback:e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:r("common:ecosystem.chainNotSupported")})}),children:e.jsx(sg,{address:j,selectedChain:h,selectedChainName:y,mainAssetSymbol:g,wallets:l,currentWalletId:f,chainPreferences:v,onWalletChange:w,onCopyAddress:N,onOpenChainSelector:b,onOpenSettings:S,onOpenWalletList:E,onAddWallet:I,onOpenAddressBalance:A,onOpenAddressTransactions:P})}):e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(Se,{size:"lg"})})}function ng(){const{push:t}=Y(),{t:s}=B("home");return e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-6 p-6 text-center",children:[e.jsx("div",{className:"bg-primary/10 rounded-full p-6",children:e.jsx(nt,{className:"text-primary size-12"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:s("welcome.title")}),e.jsx("p",{className:"text-muted-foreground mt-2",children:s("welcome.subtitle")})]}),e.jsxs("div",{className:"flex w-full max-w-xs flex-col gap-3",children:[e.jsx(ze,{variant:"mint",className:"w-full","data-testid":"create-wallet-button",onClick:()=>t("WalletCreateActivity",{}),children:s("welcome.createWallet")}),e.jsx(q,{variant:"outline",className:"w-full","data-testid":"import-wallet-button",onClick:()=>t("OnboardingRecoverActivity",{}),children:s("welcome.importWallet")})]})]})}Wc.__docgenInfo={description:"",methods:[],displayName:"WalletTab"};const ag=Ta(["defi","nft","tools","games","social","exchange","other"]),rg=Pa([Ye(!0),Is({timeout:Ot().int().positive().optional()}).passthrough()]),ig=Ta(["auto","dark","light"]),og=Ta(["stack","mine"]),Fc=Is({id:U(),name:U(),description:U(),longDescription:U().optional(),icon:U(),url:U(),version:U(),author:U().optional(),website:U().optional(),category:ag.optional(),tags:Xe(U()).optional(),permissions:Xe(U()).optional(),chains:Xe(U()).optional(),screenshots:Xe(U()).optional(),minWalletVersion:U().optional(),publishedAt:U().optional(),updatedAt:U().optional(),beta:Ze().optional(),officialScore:Ot().min(0).max(100).optional(),communityScore:Ot().min(0).max(100).optional(),splashScreen:rg.optional(),capsuleTheme:ig.optional(),targetDesktop:og.optional(),themeColor:U().optional(),themeColorFrom:U().optional(),themeColorTo:U().optional()}).passthrough(),cg=Is({name:U(),version:U(),updated:U(),icon:U().optional(),search:Is({urlTemplate:U()}).passthrough().optional(),apps:Xe(Fc)}).passthrough();Is({version:U(),data:Xe(Fc)}).passthrough();const lg=15,dg=1440*60*1e3;function ug(t){return Math.floor(t.getTime()/dg)}function mg(t=new Date){const s=ug(t);return lg*(s+1)%100}function vi(t,s=new Date){const n=typeof t.officialScore=="number"?t.officialScore:0,a=typeof t.communityScore=="number"?t.communityScore:0,r=mg(s),o=100-r;return(n*r+a*o)/100}function fg(t){const s=typeof document<"u"?document.baseURI:"file:///",n=new URL(t,s).toString();return a=>a.startsWith("http://")||a.startsWith("https://")||a.startsWith("data:")?a:new URL(a,n).toString()}const pg="ecosystem-sources",os="sources";async function $c(){return new Promise((t,s)=>{const n=indexedDB.open(pg,1);n.onerror=()=>s(n.error),n.onsuccess=()=>t(n.result),n.onupgradeneeded=()=>{const a=n.result;a.objectStoreNames.contains(os)||a.createObjectStore(os,{keyPath:"url"})}})}async function hg(t){try{const s=await $c();return new Promise((n,a)=>{const c=s.transaction(os,"readonly").objectStore(os).get(t);c.onerror=()=>a(c.error),c.onsuccess=()=>n(c.result??null)})}catch{return null}}async function xg(t){try{const s=await $c();await new Promise(n=>{const r=s.transaction(os,"readwrite").objectStore(os),o=t.url,c=r.keyPath?r.put(t):r.put(t,o);c.onerror=()=>n(),c.onsuccess=()=>n()})}catch{}}const nn=300*1e3,zs=new Map;function gg(t){if(typeof window>"u")return t;const s=t.trim();if(s.length===0)return t;if(/^[a-zA-Z][a-zA-Z\d+.-]*:/.test(s))return s;if(s.startsWith("//"))return`${window.location.protocol}${s}`;try{const n=typeof document<"u"?document.baseURI:window.location.origin;return new URL(s,n).toString()}catch{return t}}function vg(t){const s=zs.get(t);return s?Date.now()>s.expiresAt?(zs.delete(t),null):s.data:null}function an(t,s,n){zs.set(t,{data:s,expiresAt:Date.now()+n})}function qc(t){for(const s of zs.keys())s.startsWith(t)&&zs.delete(s)}async function ir(t){const s=gg(t),n=s,a=vg(`source:${n}`);if(a)return a;const r=await hg(n),o={};r?.etag&&(typeof window>"u"||new URL(s).origin===window.location.origin)&&(o["If-None-Match"]=r.etag);try{const c=await fetch(s,{headers:o});if(c.status===304&&r)return an(`source:${n}`,r.data,nn),r.data;if(!c.ok)return c.status,r?(an(`source:${n}`,r.data,nn),r.data):null;const i=c.headers.get("content-type")??"";let l;try{l=await c.json()}catch(h){return h instanceof Error?h.message:String(h),r?r.data:null}const m=cg.safeParse(l);if(!m.success)return m.error.issues.map(h=>h.path.join(".")),r?r.data:null;const u=m.data,f=c.headers.get("etag")??void 0;return await xg({url:n,data:u,etag:f,cachedAt:Date.now()}),an(`source:${n}`,u,nn),u.apps?.length,u}catch(c){return c instanceof Error?c.message:String(c),r?(an(`source:${n}`,r.data,nn),r.data):null}}let cs=[];const js=new Map,fn=[];function Hc(){const t=[...cs];fn.forEach(s=>s(t))}function yi(t){if(t.length===0)return 0;if(t.length===1)return t[0]??0;const s=t.reduce((l,m)=>l+m,0)/t.length,n=t.reduce((l,m)=>l+Math.pow(m-s,2),0)/Math.max(1,t.length-1),a=Math.sqrt(n),r=a>0?a:1,o=.05;let c=0,i=0;for(const l of t){const m=(l-s)/r,u=Math.exp(-.5*m*m),f=Math.max(o,u);c+=l*f,i+=f}return i===0?s:c/i}function Uc(t,s){const n=[],a=new Map,r=new Map,o=new Map;for(const c of t){const i=s.get(c.url);if(i)for(const l of i.apps??[]){const m=jg(l,c,i);if(!m)continue;const u=m.id;if(a.has(u)||(a.set(u,n.length),n.push(m)),typeof m.officialScore=="number"){const f=r.get(u)??[];f.push(m.officialScore),r.set(u,f)}if(typeof m.communityScore=="number"){const f=o.get(u)??[];f.push(m.communityScore),o.set(u,f)}}}for(const[c,i]of a){const l=n[i];if(!l)continue;const m=r.get(c);m&&m.length>0&&(l.officialScore=yi(m));const u=o.get(c);u&&u.length>0&&(l.communityScore=yi(u))}return t.length,n.length,n}function yg(t){return fn.push(t),()=>{const s=fn.indexOf(t);s>=0&&fn.splice(s,1)}}function bg(t){return/^[a-z0-9]+(?:\.[a-z0-9-]+)+$/i.test(t)}function jg(t,s,n){if(!bg(t.id))return null;const a=fg(s.url);return{...t,icon:a(t.icon),url:a(t.url),screenshots:t.screenshots?.map(a),splashScreen:t.splashScreen,sourceUrl:s.url,sourceName:s.name,sourceIcon:s.icon??(n.icon?a(n.icon):void 0)}}async function Ng(t){return ir(t)}async function or(){const t=Ia.getEnabledSources(Bt.state);t.length,await Promise.all(t.map(async s=>{const n=await Ng(s.url);js.set(s.url,n),cs=Uc(t,js),Hc()}))}function wg(t){return t.map(s=>`${s.url}|${s.enabled?"1":"0"}`).sort().join(",")}let bi="";Bt.subscribe(()=>{const t=wg(Bt.state.sources);t!==bi&&(bi=t,or())});async function Vc(t){await or(),t?.refresh===!0&&cr({force:!1})}async function cr(t){const s=t?.force===!0,n=Ia.getEnabledSources(Bt.state);return n.length,s&&qc("source:"),await Promise.all(n.map(async a=>{je.updateSourceStatus(a.url,"loading");try{const r=await ir(a.url);je.updateSourceStatus(a.url,"success"),js.set(a.url,r)}catch(r){const o=r instanceof Error?r.message:"Unknown error";je.updateSourceStatus(a.url,"error",o),js.set(a.url,null)}finally{cs=Uc(n,js),Hc()}})),[...cs]}async function Cg(t){je.updateSourceStatus(t,"loading");try{qc(`source:${t}`),await ir(t)?(je.updateSourceStatus(t,"success"),await or()):je.updateSourceStatus(t,"error","Failed to fetch source")}catch(s){const n=s instanceof Error?s.message:"Unknown error";je.updateSourceStatus(t,"error",n)}}function kg(){return[...cs]}function ji(t){return cs.find(s=>s.id===t)}function Jc(){const{push:t}=Y(),s=d.useRef(null),[n,a]=d.useState([]),[r,o]=d.useState(!0),c=we(Bt,y=>y.myApps);d.useEffect(()=>{let y=!1;const p=yg(x=>{a(x),y||(y=!0,o(!1))});return Vc({refresh:!0}).then(()=>{y||(a(kg()),o(!1))}),()=>p()},[]),Ku();const i=d.useCallback(y=>{t("MiniappDetailActivity",{appId:encodeURIComponent(y.id)})},[t]),l=d.useCallback(y=>{je.installApp(y.id),je.updateAppLastUsed(y.id),je.setActiveSubPage("mine"),s.current?.slideTo("mine"),requestAnimationFrame(()=>{eo(y.id,{...y,targetDesktop:"mine"})})},[]),m=d.useCallback(y=>{je.uninstallApp(y)},[]),u=d.useMemo(()=>c.map(y=>({...y,app:n.find(p=>p.id===y.appId)})).filter(y=>!!y.app).map(({app:y,lastUsedAt:p})=>({app:y,lastUsed:p})),[c,n]),f=d.useMemo(()=>n.length===0?[]:[...n].toSorted((y,p)=>vi(p)-vi(y)).slice(0,2),[n]),h=d.useMemo(()=>{const y=new Set(f.map(p=>p.id));return[...n].filter(p=>!y.has(p.id)).toSorted((p,x)=>(x.officialScore??0)-(p.officialScore??0)).slice(0,6)},[n,f]),v=d.useMemo(()=>[...n].toSorted((y,p)=>(p.communityScore??0)-(y.communityScore??0)).slice(0,10),[n]);return r?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(Se,{size:"lg"})}):e.jsx(rm,{ref:s,showDiscoverPage:!0,showStackPage:"auto",apps:n,myApps:u,featuredApps:f,recommendedApps:h,hotApps:v,onAppOpen:l,onAppDetail:i,onAppRemove:m})}Jc.__docgenInfo={description:"",methods:[],displayName:"EcosystemTab"};const Sg=/^(\d+)\.(\d+)\.(\d+)(?:-([0-9A-Za-z.-]+))?$/;function Ni(t){const s=t.match(Sg);if(!s)return null;const[,n,a,r,o]=s,c=o&&/^\d+$/.test(o)?Number(o):void 0;return{major:Number(n),minor:Number(a),patch:Number(r),suffix:o??void 0,suffixNumber:c}}function Ag(t,s){const n=Ni(t),a=Ni(s);if(!n||!a)return null;if(n.major!==a.major)return n.major-a.major;if(n.minor!==a.minor)return n.minor-a.minor;if(n.patch!==a.patch)return n.patch-a.patch;const r=n.suffixNumber??(n.suffix?Number.NaN:0),o=a.suffixNumber??(a.suffix?Number.NaN:0);return!Number.isNaN(r)&&!Number.isNaN(o)?r-o:n.suffix&&!a.suffix?1:!n.suffix&&a.suffix?-1:n.suffix&&a.suffix?n.suffix.localeCompare(a.suffix):0}function sa(t){return t.endsWith("/")?t:`${t}/`}function Ig(t){return t.endsWith("/")?t:`${t}/`}function Tg(){const t=sa("https://BioforestChain.github.io");try{const a=new URL(t).pathname;if(a&&a!=="/")return sa(t)}catch{return t}const s=Ig("./");return sa(new URL(s,t).toString())}function Pg(){const t=Tg(),s="dweb/metadata.json";return new URL(s,t).toString()}function Eg(t){return`dweb://install?url=${encodeURIComponent(t)}`}async function _g(t){const s=await fetch(t,{cache:"no-store"});if(!s.ok)throw new Error(`metadata fetch failed: ${s.status}`);const n=await s.json(),a=typeof n.version=="string"?n.version:"",r=typeof n.change_log=="string"?n.change_log:n.changeLog;return{version:a,changeLog:r}}async function Mg(){const t="0.6.3";let s="",n="";try{s=Pg(),n=Eg(s)}catch(a){const r=a instanceof Error?a.message:"invalid site origin";return{status:"error",currentVersion:t,metadataUrl:s,installUrl:n,error:r}}if(!_u())return{status:"not-dweb",currentVersion:t,metadataUrl:s,installUrl:n};try{const a=await _g(s);if(!a.version)return{status:"error",currentVersion:t,metadataUrl:s,installUrl:n,error:"metadata version missing"};const r=Ag(a.version,t);return r===null?{status:"error",currentVersion:t,metadataUrl:s,installUrl:n,error:"version parse failed"}:r>0?{status:"update-available",currentVersion:t,latestVersion:a.version,metadataUrl:s,installUrl:n,changeLog:a.changeLog}:{status:"up-to-date",currentVersion:t,latestVersion:a.version,metadataUrl:s,installUrl:n,changeLog:a.changeLog}}catch(a){const r=a instanceof Error?a.message:"unknown error";return{status:"error",currentVersion:t,metadataUrl:s,installUrl:n,error:r}}}const Rg={status:"idle",currentVersion:"0.6.3",dialogOpen:!1},St=new ru(Rg),Lg={openDialog:()=>{St.setState(t=>({...t,dialogOpen:!0}))},closeDialog:()=>{St.setState(t=>({...t,dialogOpen:!1}))},check:async t=>{const{status:s}=St.state;if(s==="checking")return{status:"error",currentVersion:"0.6.3",metadataUrl:"",installUrl:"",error:"already checking"};St.setState(a=>({...a,status:"checking"}));const n=await Mg();return St.setState(a=>({...a,status:n.status,currentVersion:n.currentVersion,latestVersion:n.latestVersion,changeLog:n.changeLog,metadataUrl:n.metadataUrl,installUrl:n.installUrl,error:n.error,lastCheckedAt:Date.now(),dialogOpen:n.status==="update-available"?!0:a.dialogOpen})),t==="auto"&&n.status!=="update-available"&&St.setState(a=>({...a,dialogOpen:!1})),n}};function zg(){return we(St)}function Ne({icon:t,label:s,value:n,showChevron:a=!0,disabled:r=!1,onClick:o,trailing:c,className:i,testId:l}){const m=o?"button":"div";return e.jsxs(m,{type:o?"button":void 0,onClick:r?void 0:o,disabled:r,"data-testid":l,className:R("bg-background flex w-full items-center gap-3 rounded-xl px-4 py-3.5","transition-colors",o&&!r&&"hover:bg-muted/50 active:bg-muted",r&&"cursor-not-allowed",i),children:[t&&e.jsx("span",{className:"bg-muted text-foreground flex size-8 shrink-0 items-center justify-center rounded-lg",children:t}),e.jsx("span",{className:R("flex-1 text-left text-sm font-medium",r&&"text-muted-foreground"),children:s}),c??e.jsxs(e.Fragment,{children:[n&&e.jsx("span",{className:"text-muted-foreground text-sm",children:n}),a&&o&&e.jsx(Te,{className:"text-muted-foreground/50 size-5"})]})]})}Ne.__docgenInfo={description:"",methods:[],displayName:"SettingsItem",props:{icon:{required:!1,tsType:{name:"union",raw:"ReactNode | undefined",elements:[{name:"ReactNode"},{name:"undefined"}]},description:""},label:{required:!0,tsType:{name:"string"},description:""},value:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},showChevron:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"",defaultValue:{value:"true",computed:!1}},disabled:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"",defaultValue:{value:"false",computed:!1}},onClick:{required:!1,tsType:{name:"union",raw:"(() => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},trailing:{required:!1,tsType:{name:"union",raw:"ReactNode | undefined",elements:[{name:"ReactNode"},{name:"undefined"}]},description:""},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:" className"},testId:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:" ID"}}};function vs({title:t,children:s,className:n,allowContextMenu:a}){return e.jsxs("section",{className:R("space-y-1",n),"data-allow-context-menu":a?"true":void 0,children:[t&&e.jsx("h3",{className:"mb-2 px-1 text-xs font-medium uppercase text-muted-foreground",children:t}),e.jsx("div",{className:"overflow-hidden rounded-xl bg-card shadow-sm",children:s})]})}vs.__docgenInfo={description:"",methods:[],displayName:"SettingsSection",props:{title:{required:!1,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},className:{required:!1,tsType:{name:"string"},description:" className"},allowContextMenu:{required:!1,tsType:{name:"boolean"},description:"DWEB "}}};const Dg=[{value:"system",icon:xf},{value:"light",icon:$f},{value:"dark",icon:If}];function Kc({open:t,onOpenChange:s}){const{t:n}=B("settings"),a=Fi(),r=o=>{_n.setTheme(o),s(!1)};return e.jsx(ut,{open:t,onOpenChange:s,children:e.jsxs(mt,{side:"bottom",className:"rounded-t-2xl",children:[e.jsx(ft,{children:e.jsx(pt,{children:n("appearance.title")})}),e.jsx("div",{className:"mt-4 space-y-2",children:Dg.map(({value:o,icon:c})=>e.jsxs("button",{onClick:()=>r(o),className:R("flex w-full items-center gap-3 rounded-xl p-4 transition-colors",a===o?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx(c,{size:24}),e.jsx("span",{className:"flex-1 text-left font-medium",children:n(`appearance.${o}`)}),a===o&&e.jsx(he,{size:20})]},o))})]})})}Kc.__docgenInfo={description:"",methods:[],displayName:"AppearanceSheet",props:{open:{required:!0,tsType:{name:"boolean"},description:""},onOpenChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(open: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"open"}],return:{name:"void"}}},description:""}}};const Le=ge.t.bind(ge);async function Bg(t,s){const n=Pe(t.id);if(!n.estimateFee||!n.buildTransaction){const r=As.getBiowalletApi(t.id);if(!r)throw new Error(Le("error:transaction.feeEstimateFailed"));const o=await fr(r,t.id,s,"1");return{amount:ne.fromRaw(o,t.decimals,t.symbol),symbol:t.symbol}}const a=await n.buildTransaction({type:"transfer",from:s,to:s,amount:ne.fromRaw("1",t.decimals,t.symbol)});try{return{amount:(await n.estimateFee(a)).standard.amount,symbol:t.symbol}}catch{const r=As.getBiowalletApi(t.id);if(!r)throw new Error(Le("error:transaction.feeEstimateFailed"));const o=await fr(r,t.id,s,"1");return{amount:ne.fromRaw(o,t.decimals,t.symbol),symbol:t.symbol}}}async function wi({chainConfig:t,walletId:s,password:n,fromAddress:a,toAddress:r,amount:o,assetType:c,fee:i,twoStepSecret:l}){let m;try{m=await as.getMnemonic(s,n)}catch(f){return f instanceof Rn&&f.code===Ln.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:f instanceof Error?f.message:Le("error:unknown")}}if(!o.isPositive())return{status:"error",message:Le("error:validation.enterValidAmount")};const u=Pe(t.id);if(!u.supportsFullTransaction)return{status:"error",message:Le("error:transaction.chainNotSupported")};try{let f=null;if(u.bioGetAccountInfo){if(f=(await u.bioGetAccountInfo(a)).secondPublicKey,f&&!l)return{status:"password_required",secondPublicKey:f};if(l&&f&&u.bioVerifyPayPassword&&!await u.bioVerifyPayPassword({mainSecret:m,paySecret:l,publicKey:f}))return{status:"error",message:Le("error:transaction.securityPasswordFailed")}}const h=await u.buildTransaction({type:"transfer",from:a,to:r,amount:o,fee:i,bioAssetType:c}),v=await u.signTransaction(h,{privateKey:new TextEncoder().encode(m),bioSecret:m,bioPaySecret:l}),y=await dt.create({walletId:Gi(t.id,a),chainId:t.id,fromAddress:a,rawTx:v,meta:{type:"send",displayAmount:o.toFormatted(),displaySymbol:c,displayToAddress:r}});await dt.updateStatus({id:y.id,status:"broadcasting"});try{const p=await u.broadcastTransaction(v);return await dt.updateStatus({id:y.id,status:"broadcasted",txHash:p}),{status:"ok",txHash:p,pendingTxId:y.id}}catch(p){const x=p;return await dt.updateStatus({id:y.id,status:"failed",errorCode:"BROADCAST_FAILED",errorMessage:x.message}),{status:"error",message:x.message,pendingTxId:y.id}}}catch(f){return{status:"error",message:(f instanceof Error?f.message:String(f))||Le("error:transaction.failed")}}}async function Og({chainConfig:t,walletId:s,password:n,fromAddress:a,newTwoStepSecret:r}){let o;try{o=await as.getMnemonic(s,n)}catch(i){return i instanceof Rn&&i.code===Ln.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:i instanceof Error?i.message:Le("error:unknown")}}const c=Pe(t.id);if(!c.supportsFullTransaction)return{status:"error",message:Le("error:transaction.chainNotSupported")};try{if(c.bioGetAccountInfo&&(await c.bioGetAccountInfo(a)).secondPublicKey)return{status:"already_set"};const i=await c.buildTransaction({type:"setPayPassword",from:a}),l=await c.signTransaction(i,{privateKey:new TextEncoder().encode(o),bioSecret:o,bioNewPaySecret:r});return{status:"ok",txHash:await c.broadcastTransaction(l)}}catch(i){const l=i instanceof Error?i.message:String(i);return l.includes("fee")||l.includes("")?{status:"error",message:Le("error:insufficientFunds")}:{status:"error",message:l||Le("error:transaction.failed")}}}async function Wg(t){const s=Pe(t.id);if(!s.buildTransaction||!s.estimateFee)return null;try{const n=await s.buildTransaction({type:"setPayPassword",from:"0x0000000000000000000000000000000000000000"});return{amount:(await s.estimateFee(n)).standard.amount,symbol:t.symbol}}catch{return null}}async function Fg(t,s){const n=Pe(t.id);if(!n.bioGetAccountInfo)return!1;try{return!!(await n.bioGetAccountInfo(s)).secondPublicKey}catch{return!1}}function ce({cancelable:t,onCancel:s,onOutsideClick:n,...a}){const r=t??!!s,o=c=>{if(!r){c.preventDefault();return}if(s){s(),c.preventDefault();return}n?.(c)};return e.jsx(dx,{onOutsideClick:o,...a})}const Gc=px;function Cn({title:t,children:s,className:n}){return e.jsxs("div",{className:R("bg-background rounded-t-2xl",n),children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),t&&e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t})}),s,e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}ce.__docgenInfo={description:"Re-export Stackflow BottomSheet",methods:[],displayName:"BottomSheet",props:{cancelable:{required:!1,tsType:{name:"boolean"},description:`Whether the sheet supports cancel (outside click).
Defaults to true to preserve existing behavior.`},onCancel:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:`Cancel handler invoked when outside click happens.
If provided, it is responsible for closing the sheet (call pop).`}}};Cn.__docgenInfo={description:"Standard sheet content wrapper with handle, title, and safe area",methods:[],displayName:"SheetContent",props:{title:{required:!1,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};function $g(t,s=10,n=8){return t.length<=s+n+3?t:`${t.slice(0,s)}...${t.slice(-n)}`}const Qc=()=>{const{t}=B(["home","common"]),{pop:s}=Y(),n=Ae(),a=Be(),r=$t(),o=d.useMemo(()=>n?n.chainAddresses.map(l=>l.chain):[],[n]),c=l=>{fe.setSelectedChain(l),s()},i=()=>{s()};return e.jsx(ce,{onCancel:i,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("home:wallet.selectNetwork")})}),e.jsx("div",{"data-testid":"chain-sheet",className:"max-h-[60vh] space-y-2 overflow-y-auto p-4",children:o.map(l=>{const m=n?.chainAddresses.find(u=>u.chain===l);return e.jsxs("button",{"data-testid":`chain-option-${l}`,onClick:()=>c(l),className:`flex w-full items-center gap-3 rounded-xl p-4 transition-colors ${l===a?"bg-primary/10 ring-1 ring-primary":"bg-muted/50 hover:bg-muted"}`,children:[e.jsx(xt,{chain:l,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:r[l]??l}),e.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:m?.address?$g(m.address):"---"})]}),l===a&&e.jsx(he,{className:"size-5 text-primary"})]},l)})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};Qc.__docgenInfo={description:"",methods:[],displayName:"ChainSelectorJob"};const Ci={"/":"MainTabsActivity","/wallet/list":"WalletListActivity","/wallet/create":"WalletCreateActivity","/send":"SendActivity","/receive":"ReceiveActivity","/settings":"SettingsActivity","/settings/language":"SettingsLanguageActivity","/settings/currency":"SettingsCurrencyActivity","/settings/chains":"SettingsChainsActivity","/settings/mnemonic":"SettingsMnemonicActivity","/settings/wallet-lock":"SettingsWalletLockActivity","/settings/wallet-chains":"SettingsWalletChainsActivity","/settings/storage":"SettingsStorageActivity","/settings/sources":"SettingsSourcesActivity","/history":"HistoryActivity","/scanner":"ScannerActivity","/onboarding/recover":"OnboardingRecoverActivity","/address-book":"AddressBookActivity","/my-card":"MyCardActivity","/notifications":"NotificationsActivity","/staking":"StakingActivity","/welcome":"WelcomeActivity"},qg=[{pattern:/^\/wallet\/([^/]+)$/,activity:"WalletConfigActivity",paramExtractor:t=>({walletId:t[1]??""})},{pattern:/^\/transaction\/([^/]+)$/,activity:"TransactionDetailActivity",paramExtractor:t=>({txId:t[1]??""})},{pattern:/^\/authorize\/address\/([^/]+)$/,activity:"AuthorizeAddressActivity",paramExtractor:t=>({id:t[1]??""})},{pattern:/^\/authorize\/signature\/([^/]+)$/,activity:"AuthorizeSignatureActivity",paramExtractor:t=>({id:t[1]??""})},{pattern:/^\/token\/([^/]+)$/,activity:"TokenDetailActivity",paramExtractor:t=>({tokenId:t[1]??""})}];function Hg(t){if(Ci[t])return{activity:Ci[t],params:{}};for(const{pattern:s,activity:n,paramExtractor:a}of qg){const r=t.match(s);if(r)return{activity:n,params:a(r)}}return null}function re(){const t=Y();return{navigate:a=>{const r=typeof a=="string"?{to:a}:a,o=Hg(r.to);if(!o)return;const c={...o.params,...r.search};r.replace?t.replace(o.activity,c,{animate:!0}):t.push(o.activity,c,{animate:!0})},goBack:()=>{t.pop()}}}const Yc=d.createContext({});function oe({params:t,children:s}){return e.jsx(Yc.Provider,{value:t,children:s})}function de(){return d.useContext(Yc)}oe.__docgenInfo={description:"",methods:[],displayName:"ActivityParamsProvider",props:{params:{required:!0,tsType:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""}}};function Ug(){const{t}=B("wallet"),{pop:s}=Y(),{walletId:n}=de(),r=yt().find(u=>u.id===n),[o,c]=d.useState(r?.name??"");d.useEffect(()=>{r&&c(r.name)},[r]);const i=d.useCallback(()=>{if(!r)return;const u=o.trim();u&&(fe.updateWalletName(r.id,u),s())},[r,o,s]),l=()=>{s()};if(!r)return null;const m=o.trim().length>0&&o.trim()!==r.name;return e.jsx(ce,{onCancel:l,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("editSheet.renameTitle")})}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"wallet-name",className:"text-sm font-medium",children:t("editSheet.walletName")}),e.jsx("input",{id:"wallet-name",type:"text",value:o,onChange:u=>c(u.target.value),placeholder:t("editSheet.walletNamePlaceholder"),maxLength:20,className:R("w-full rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")}),e.jsxs("p",{className:"text-right text-xs text-muted-foreground",children:[o.length,"/20"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:i,disabled:!m,className:R("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t("editSheet.save")}),e.jsx("button",{onClick:l,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("editSheet.cancel")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Xc=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(Ug,{})});Xc.__docgenInfo={description:"",methods:[],displayName:"WalletRenameJob"};function Vg(){const{t}=B("wallet"),{pop:s}=Y(),{navigate:n}=re(),{walletId:a}=de(),o=yt().find(y=>y.id===a),[c,i]=d.useState([]),[l,m]=d.useState(!1),[u,f]=d.useState(!1),h=()=>{s()},v=d.useCallback(async y=>{if(!(!o||y.length<4)){if(!o.encryptedMnemonic){fe.deleteWallet(o.id),n({to:"/"});return}f(!0),m(!1);try{const p=gt(y);if(!await Mt(o.encryptedMnemonic,p)){m(!0),i([]);return}fe.deleteWallet(o.id),n({to:"/"})}catch{m(!0),i([])}finally{f(!1)}}},[o,n]);return o?e.jsx(ce,{onCancel:h,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("editSheet.deleteTitle")})}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsx("p",{className:"text-center text-muted-foreground",children:t("editSheet.deleteWarning",{name:o.name})}),e.jsx(Ut,{value:c,onChange:i,onComplete:v,minPoints:4,error:l,disabled:u}),e.jsx("div",{className:"space-y-3",children:e.jsx("button",{onClick:h,disabled:u,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("editSheet.cancel")})})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}):null}const Zc=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(Vg,{})});Zc.__docgenInfo={description:"",methods:[],displayName:"WalletDeleteJob"};let kn=null,lr=null;function Nt(t,s){kn=t,lr=null}function Jg(){kn=null,lr=null}function Kg(){const{t}=B("security"),{pop:s}=Y(),{title:n,description:a,biometricAvailable:r}=de(),[o,c]=d.useState([]),[i,l]=d.useState(!1),[m,u]=d.useState(null),[f,h]=d.useState(!1),v=d.useRef(null),y=d.useRef(null),p=d.useRef(null),x=d.useRef(!1);!x.current&&kn&&(y.current=kn,p.current=lr,Jg(),x.current=!0);const g=n??t("patternLock.unlockTitle"),j=r==="true"&&p.current,N=d.useCallback(()=>{v.current&&(clearTimeout(v.current),v.current=null),l(!1),u(null)},[]),b=d.useCallback(E=>{i&&E.length>0&&N(),c(E)},[i,N]),S=d.useCallback(async E=>{const A=y.current;if(!(E.length<4||!A)){h(!0),N();try{const P=gt(E);await A(P)?s():(l(!0),u(t("walletLock.error")),c([]),v.current=setTimeout(()=>{l(!1),u(null)},1500))}catch(P){l(!0),u(P instanceof Error?P.message:t("walletLock.error")),c([]),v.current=setTimeout(()=>{l(!1),u(null)},1500)}finally{h(!1)}}},[s,N]),w=d.useCallback(async()=>{const E=p.current;if(E){h(!0),N();try{await E()?s():(l(!0),v.current=setTimeout(()=>{l(!1)},1500))}catch{l(!0),v.current=setTimeout(()=>{l(!1)},1500)}finally{h(!1)}}},[s,N]),I=()=>{s()};return e.jsx(ce,{"data-testid":"wallet-lock-dialog",onCancel:I,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsxs("div",{className:"px-4 pb-4 text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:g}),a&&e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:a})]}),e.jsxs("div",{className:"px-4 pb-4",children:[e.jsx(Ut,{value:o,onChange:b,onComplete:S,minPoints:4,error:i,disabled:f,"data-testid":"wallet-lock-pattern"}),i&&m&&e.jsx("p",{className:"mt-2 text-center text-sm text-destructive",children:m})]}),e.jsxs("div",{className:"space-y-3 px-4 pb-4",children:[j&&e.jsxs("button",{type:"button",onClick:w,disabled:f,className:R("flex w-full items-center justify-center gap-2 rounded-full border border-border py-3 font-medium transition-colors","hover:bg-muted","disabled:cursor-not-allowed disabled:opacity-50"),children:[e.jsx(jf,{className:"size-5"}),e.jsx("span",{children:t("walletLock.biometric")})]}),e.jsx("button",{type:"button",onClick:I,disabled:f,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("walletLock.cancel")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const el=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(Kg,{})});el.__docgenInfo={description:"",methods:[],displayName:"WalletLockConfirmJob"};let Gg=null;function Qg(){const{t}=B(["security","transaction","common"]),{pop:s}=Y(),{title:n,description:a}=de(),[r,o]=d.useState(""),[c,i]=d.useState(),[l,m]=d.useState(!1),u=d.useRef(null);d.useRef(!1).current;const h=n??t("security:twoStepSecret.confirmTitle"),v=a??t("security:twoStepSecret.confirmDesc"),y=d.useCallback(async g=>{g.preventDefault();const j=u.current;if(!(!r.trim()||!j)){m(!0),i(void 0);try{await j(r)?s():i(t("security:twoStepSecret.notMatch"))}catch{i(t("security:twoStepSecret.notMatch"))}finally{m(!1)}}},[r,s,t]),p=r.trim().length>0&&!l,x=()=>{s()};return e.jsx(ce,{"data-testid":"two-step-secret-dialog",onCancel:x,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx($s,{className:"size-5 text-primary"}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:h})]})}),e.jsxs("form",{onSubmit:y,className:"space-y-6 p-4",children:[e.jsx("p",{className:"text-center text-muted-foreground text-sm",children:v}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(hn,{value:r,onChange:g=>o(g.target.value),placeholder:t("security:twoStepSecret.inputPlaceholder"),disabled:l,"aria-describedby":c?"two-step-secret-error":void 0,"data-testid":"two-step-secret-input"}),c&&e.jsxs("div",{id:"two-step-secret-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(vt,{className:"size-4"}),e.jsx("span",{children:c})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{type:"submit",disabled:!p,"data-testid":"two-step-secret-confirm-button",className:R("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(l?"security:walletLock.verifying":"common:confirm")}),e.jsx("button",{type:"button",onClick:x,disabled:l,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("security:walletLock.cancel")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const tl=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(Qg,{})});tl.__docgenInfo={description:"",methods:[],displayName:"TwoStepSecretConfirmJob"};let Ns=null,Sn=null;function sl(t,s){Ns=t,Sn=s}function ki(){Ns=null,Sn=null}function Yg(){const{t}=B(["transaction","common"]),{pop:s}=Y();de();const n=d.useRef(Ns),a=d.useRef(Sn),r=d.useRef(!1);!r.current&&Ns&&(n.current=Ns,a.current=Sn,ki(),r.current=!0);const o=n.current,[c,i]=d.useState(o?.currentFee??""),[l,m]=d.useState();d.useEffect(()=>()=>{ki()},[]);const u=d.useCallback(g=>{if(!o)return;const j=parseFloat(g),N=parseFloat(o.minFee);if(isNaN(j)||j<=0)return t("transaction:feeEdit.invalidFee");if(j<N)return t("transaction:feeEdit.belowMinFee",{minFee:o.minFee,symbol:o.symbol})},[o,t]),f=d.useCallback(g=>{const j=g.target.value;(j===""||/^\d*\.?\d*$/.test(j))&&(i(j),m(void 0))},[]),h=d.useCallback(g=>{i(g),m(void 0)},[]),v=d.useCallback(g=>{g.preventDefault();const j=u(c);if(j){m(j);return}a.current?.({fee:c}),s()},[c,u,s]),y=d.useCallback(()=>{s()},[s]);if(!o)return null;const p=[{label:t("transaction:feeEdit.presetMin"),value:o.minFee}],x=o.presets??p;return e.jsx(Gc,{children:e.jsxs("div",{className:"bg-background rounded-2xl p-4","data-testid":"fee-edit-modal",children:[e.jsx("h2",{className:"mb-4 text-center text-lg font-semibold",children:t("transaction:feeEdit.title")}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 text-sm text-muted-foreground",children:[e.jsxs("p",{children:[t("transaction:feeEdit.currentFee"),": ",o.currentFee," ",o.symbol]}),e.jsxs("p",{children:[t("transaction:feeEdit.minFee"),": ",o.minFee," ",o.symbol]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:x.map(g=>e.jsx("button",{type:"button",onClick:()=>h(g.value),className:R("rounded-full px-3 py-1 text-sm transition-colors",c===g.value?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:g.label},g.value))}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("transaction:feeEdit.customFee")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(De,{type:"text",inputMode:"decimal",value:c,onChange:f,placeholder:o.minFee,className:R(l&&"border-destructive"),"data-testid":"fee-input"}),e.jsx("span",{className:"shrink-0 text-sm text-muted-foreground",children:o.symbol})]}),l&&e.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(vt,{className:"size-4"}),e.jsx("span",{children:l})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(q,{type:"button",variant:"outline",onClick:y,className:"flex-1",children:t("common:cancel")}),e.jsx(q,{type:"submit",className:"flex-1",disabled:!c,children:t("common:confirm")})]})]})]})})}const nl=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(Yg,{})});nl.__docgenInfo={description:"",methods:[],displayName:"FeeEditJob"};let ws=null,An=null,In=null,Tn="";function Xg(t,s,n){ws=t,An=n??null,s&&(In=s.amount,Tn=s.symbol)}function Zg(){ws=null,An=null,In=null,Tn=""}function ev(){const{t}=B(["security","transaction","common"]),{pop:s,push:n}=Y(),{chainId:a,chainIcon:r,chainSymbol:o,address:c,chainName:i}=de(),[l,m]=d.useState(""),[u,f]=d.useState(""),[h,v]=d.useState([]),[y,p]=d.useState(!1),[x,g]=d.useState("input"),[j,N]=d.useState(),[b,S]=d.useState(!1),[w,I]=d.useState("idle"),[E,A]=d.useState(),[P,k]=d.useState(null),T=d.useRef(ws),C=d.useRef(An),_=d.useRef({amount:In,symbol:Tn}),z=P??_.current.amount?.toDisplayString()??"0";d.useEffect(()=>(ws&&!T.current&&(T.current=ws,C.current=An,_.current={amount:In,symbol:Tn}),()=>{Zg()}),[]);const D=d.useCallback(()=>{const O=_.current.amount?.toDisplayString()??"0";sl({currentFee:z,minFee:O,symbol:_.current.symbol},Q=>{k(Q.fee)}),n("FeeEditJob",{})},[z,n]),L=d.useCallback(()=>{if(N(void 0),x==="input"){if(!l.trim())return;g("confirm")}else if(x==="confirm"){if(l!==u){N(t("security:twoStepSecret.notMatch"));return}g("walletLock")}},[x,l,u,t]),J=d.useCallback(()=>{x==="input"?s():x==="confirm"?(g("input"),N(void 0)):(g("confirm"),N(void 0),p(!1),v([]))},[x,s]),M=d.useCallback(async O=>{const Q=T.current;if(O.length<4||!Q)return;S(!0),I("broadcasting"),N(void 0),p(!1);const te=gt(O);try{const W=await Q(l,te);W.success?(A(W.txHash),I("broadcasted")):(I("idle"),p(!0),v([]),N(W.error??t("security:twoStepSecret.setFailed")))}catch{I("idle"),p(!0),v([]),N(t("security:twoStepSecret.setFailed"))}finally{S(!1)}},[l,t]);return w!=="idle"?e.jsx(ce,{onCancel:J,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx(to,{status:w,txHash:E,title:{confirmed:t("security:twoStepSecret.txConfirmed")},description:{confirmed:t("security:twoStepSecret.setSuccessDesc")},checkConfirmed:C.current??void 0,onStatusChange:I,onDone:()=>s()}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}):e.jsx(ce,{onCancel:J,children:e.jsxs("div",{className:"bg-background rounded-t-2xl","data-testid":"set-two-step-secret-dialog",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsxs("div",{className:"border-b border-border px-4 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx($s,{className:"size-5 text-primary"}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("security:twoStepSecret.setTitle")})]}),a&&c?e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(Sa,{chainId:a,chainIcon:r,chainSymbol:o,address:c,size:"sm"})}):i?e.jsx("p",{className:"mt-1 text-center text-sm text-muted-foreground",children:i}):null]}),e.jsxs("div",{className:"space-y-6 p-4",children:[_.current.amount&&e.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-muted/50 p-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:t("security:twoStepSecret.feeInfo")}),e.jsx(_a,{amount:z,symbol:_.current.symbol,editable:!0,onEdit:D})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:R("size-2 rounded-full",x==="input"?"bg-primary":"bg-muted")}),e.jsx("div",{className:R("size-2 rounded-full",x==="confirm"?"bg-primary":"bg-muted")}),e.jsx("div",{className:R("size-2 rounded-full",x==="walletLock"?"bg-primary":"bg-muted")})]}),x==="input"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:t("security:twoStepSecret.inputDesc")}),e.jsx(hn,{value:l,onChange:O=>m(O.target.value),placeholder:t("security:twoStepSecret.inputPlaceholder"),"aria-describedby":j?"two-step-secret-error":void 0,"data-testid":"new-two-step-secret-input"})]}),x==="confirm"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:t("security:twoStepSecret.confirmDesc")}),e.jsx(hn,{value:u,onChange:O=>f(O.target.value),placeholder:t("security:twoStepSecret.confirmPlaceholder"),"aria-describedby":j?"two-step-secret-error":void 0,"data-testid":"confirm-two-step-secret-input"})]}),x==="walletLock"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:t("security:twoStepSecret.walletLockDesc")}),e.jsx(Ut,{value:h,onChange:v,onComplete:M,minPoints:4,error:y,disabled:b,"data-testid":"wallet-lock-pattern"})]}),j&&e.jsxs("div",{id:"two-step-secret-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(vt,{className:"size-4"}),e.jsx("span",{children:j})]}),e.jsxs("div",{className:"space-y-3",children:[x!=="walletLock"&&e.jsx("button",{type:"button",onClick:L,"data-testid":"set-two-step-secret-next-button",className:R("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90"),children:t("common:next")}),e.jsx("button",{type:"button",onClick:J,disabled:b,"data-testid":"set-two-step-secret-cancel-button",className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t(x==="input"?"common:cancel":"common:back")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const al=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(ev,{})});al.__docgenInfo={description:"",methods:[],displayName:"SetTwoStepSecretJob"};let ya=null;function tv(){ya=null}const sv=[{value:"english",label:"English"},{value:"zh-Hans",label:""},{value:"zh-Hant",label:""}],nv=[12,15,18,21,24,36];function av(){const{t}=B("onboarding"),{pop:s}=Y(),{language:n,length:a}=de(),[r,o]=d.useState({language:n||"english",length:Number(a)||12}),c=u=>{o(f=>({...f,language:u}))},i=u=>{o(f=>({...f,length:u}))},l=()=>{ya&&ya(r),tv(),s()},m=()=>{s()};return e.jsx(ce,{onCancel:m,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx("div",{className:"border-border border-b px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("create.mnemonicOptions.title")})}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:t("create.mnemonicOptions.language")}),e.jsx("div",{className:"space-y-1",role:"radiogroup",children:sv.map(u=>e.jsxs("button",{type:"button",role:"radio","aria-checked":r.language===u.value,onClick:()=>c(u.value),className:R("flex w-full items-center justify-between rounded-lg px-4 py-3","hover:bg-muted/50 transition-colors",r.language===u.value&&"bg-muted"),children:[e.jsx("span",{className:"text-sm",children:u.label}),r.language===u.value&&e.jsx(he,{className:"text-primary size-5"})]},u.value))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:t("create.mnemonicOptions.wordCount")}),e.jsx("div",{className:"grid grid-cols-3 gap-2",role:"radiogroup",children:nv.map(u=>e.jsxs("button",{type:"button",role:"radio","aria-checked":r.length===u,onClick:()=>i(u),className:R("flex items-center justify-center rounded-lg py-3 text-sm font-medium","transition-colors",r.length===u?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:[u," ",t("create.mnemonicOptions.words")]},u))})]}),e.jsx("button",{type:"button",onClick:l,className:R("text-primary-foreground w-full rounded-full py-3 font-medium transition-colors","bg-primary hover:bg-primary/90"),children:t("create.mnemonicOptions.confirm")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const rl=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(av,{})});rl.__docgenInfo={description:"",methods:[],displayName:"MnemonicOptionsJob"};const na=3,rv=10;function iv(){const{t}=B("common"),{pop:s}=Y(),{contactId:n}=de(),a=we(ks,k=>k.contacts),r=n?a.find(k=>k.id===n):null,[o,c]=d.useState(""),[i,l]=d.useState([{id:crypto.randomUUID(),label:"",address:""}]),[m,u]=d.useState(""),[f,h]=d.useState(()=>Math.floor(Math.random()*1e4)),[v,y]=d.useState(!1),p=!!r;d.useEffect(()=>{r&&(c(r.name),l(r.addresses.length>0?r.addresses.map(k=>({id:k.id,label:k.label||"",address:k.address})):[{id:crypto.randomUUID(),label:"",address:""}]),u(r.memo??""),y(!1))},[r]);const x=d.useCallback(()=>{h(Math.floor(Math.random()*1e4)),y(!0)},[]),g=i.find(k=>k.address.trim())?.address.trim(),j=!p||v?g?Rt(g,f):void 0:r?.avatar||(g?Rt(g,f):void 0),N=d.useCallback(()=>{i.length>=na||l(k=>[...k,{id:crypto.randomUUID(),label:"",address:""}])},[i.length]),b=d.useCallback(k=>{l(T=>T.length<=1?T:T.filter(C=>C.id!==k))},[]),S=d.useCallback((k,T,C)=>{l(_=>_.map(z=>z.id===k?{...z,[T]:C}:z))},[]),w=d.useCallback(()=>{const k=o.trim(),T=m.trim(),C=i.filter(z=>z.address.trim()).map((z,D)=>({id:z.id,address:z.address.trim(),label:z.label.trim()||void 0,isDefault:D===0}));if(!k||C.length===0)return;const _=!p||v?C[0]?Rt(C[0].address,f):void 0:r?.avatar;p&&r?Ss.updateContact(r.id,{name:k,avatar:_,addresses:C,memo:T||void 0}):Ss.addContact({name:k,addresses:C,avatar:_,memo:T||void 0}),s()},[o,i,m,f,p,r,s]),I=i.some(k=>k.address.trim()),E=o.trim().length>0&&I,A=i.length<na,P=()=>{s()};return e.jsx(ce,{onCancel:P,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t(p?"contact.editTitle":"contact.addTitle")})}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:x,disabled:!g,className:"group relative shrink-0",title:t("addressBook.changeAvatar"),children:[e.jsx(ds,{src:j,size:56}),g&&e.jsx("div",{className:"bg-background/80 absolute inset-0 flex items-center justify-center rounded-full opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx(Vt,{className:"text-primary size-5"})})]}),e.jsx("input",{id:"contact-name",type:"text",value:o,onChange:k=>c(k.target.value),placeholder:t("contact.namePlaceholder"),maxLength:20,className:R("flex-1 rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:t("contact.addresses")}),e.jsx("span",{className:"text-muted-foreground text-xs",children:t("contact.addressCount",{count:i.length,max:na})})]}),i.map((k,T)=>e.jsxs("div",{className:"space-y-2 rounded-xl border border-border p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:k.label,onChange:C=>S(k.id,"label",C.target.value),placeholder:t("contact.addressLabelPlaceholder"),maxLength:rv,className:R("w-24 shrink-0 rounded-lg border border-border bg-muted/50 px-3 py-2 text-sm","focus:outline-none focus:ring-2 focus:ring-primary")}),i.length>1&&e.jsx("button",{type:"button",onClick:()=>b(k.id),className:"text-muted-foreground hover:text-destructive shrink-0 p-1",children:e.jsx(qt,{className:"size-4"})}),T===0&&e.jsx("span",{className:"bg-primary/10 text-primary rounded px-1.5 py-0.5 text-xs",children:t("contact.defaultLabel")})]}),e.jsx("input",{type:"text",value:k.address,onChange:C=>S(k.id,"address",C.target.value),placeholder:t("contact.addressPlaceholder"),className:R("w-full rounded-lg border border-border bg-background px-3 py-2 font-mono text-sm","focus:outline-none focus:ring-2 focus:ring-primary")})]},k.id)),A&&e.jsxs("button",{type:"button",onClick:N,className:"flex w-full items-center justify-center gap-2 rounded-xl border border-dashed border-border py-3 text-sm text-muted-foreground hover:border-primary hover:text-primary",children:[e.jsx(nt,{className:"size-4"}),t("contact.addAddress")]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"contact-memo",className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(Xi,{className:"size-4"}),t("contact.memoOptional")]}),e.jsx("textarea",{id:"contact-memo",value:m,onChange:k=>u(k.target.value),placeholder:t("contact.memoPlaceholder"),maxLength:100,rows:2,className:R("w-full resize-none rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")})]}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsx("button",{onClick:w,disabled:!E,className:R("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(p?"contact.save":"contact.add")}),e.jsx("button",{onClick:P,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("contact.cancel")})]})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const il=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(iv,{})});il.__docgenInfo={description:"",methods:[],displayName:"ContactEditJob"};function ov(t,s=8,n=6){return t.length<=s+n+3?t:`${t.slice(0,s)}...${t.slice(-n)}`}function cv(){const{t}=B("common"),{pop:s}=Y(),{chainType:n}=de(),a=n,[r,o]=d.useState(""),c=we(ks),i=d.useMemo(()=>{let u=c.contacts;return r&&(u=Na.searchContacts(c,r)),u=[...u].toSorted((f,h)=>h.updatedAt-f.updatedAt),u.map(f=>{const h=f.addresses.map(y=>({...y,isValidForCurrentChain:a?vm(y.address,a):!0})),v=h.some(y=>y.isValidForCurrentChain);return{contact:f,addresses:h,hasValidAddress:v}})},[c,r,a]),l=(u,f)=>{const h=new CustomEvent("contact-picker-select",{detail:{contact:u,address:f}});window.dispatchEvent(h),s()},m=()=>{s()};return e.jsx(ce,{onCancel:m,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx("div",{className:"border-border border-b px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("contact.selectAddress")})}),e.jsx("div",{className:"border-border border-b p-4",children:e.jsxs("div",{className:"bg-muted/50 flex items-center gap-2 rounded-xl px-3 py-2",children:[e.jsx(qs,{className:"text-muted-foreground size-4"}),e.jsx("input",{type:"text",value:r,onChange:u=>o(u.target.value),placeholder:t("addressBook.searchPlaceholder"),className:"placeholder:text-muted-foreground min-w-0 flex-1 bg-transparent text-sm outline-none"})]})}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto",children:i.length===0?e.jsx("div",{className:"text-muted-foreground py-12 text-center text-sm",children:t(r?"addressBook.noResults":"contact.noContacts")}):e.jsx("div",{className:"divide-border divide-y",children:i.map(({contact:u,addresses:f,hasValidAddress:h})=>e.jsxs("div",{className:R(!h&&"opacity-50"),children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 pt-3 pb-2",children:[e.jsx(ds,{src:u.avatar||(f[0]?.address?Rt(f[0].address):void 0),size:40,className:"shrink-0"}),e.jsx("p",{className:"min-w-0 flex-1 truncate font-medium",children:u.name})]}),e.jsx("div",{className:"space-y-1 pb-3 pl-[56px] pr-4",children:f.map(v=>{const y=!v.isValidForCurrentChain,p=v.label;return e.jsxs("button",{onClick:()=>!y&&l(u,v),disabled:y,className:R("flex min-h-[44px] w-full items-center gap-3 rounded-xl px-3 py-2.5 transition-colors",y?"cursor-not-allowed opacity-50":"hover:bg-muted/50 active:bg-muted"),children:[e.jsx("p",{className:R("min-w-0 flex-1 truncate text-left font-mono text-sm",y?"text-muted-foreground/50":"text-foreground"),children:ov(v.address)}),e.jsxs("div",{className:"flex shrink-0 items-center gap-2",children:[p&&e.jsx("span",{className:R("max-w-[5rem] truncate rounded-md bg-muted px-2 py-0.5 text-xs",y?"text-muted-foreground/50":"text-muted-foreground"),children:p}),v.isDefault&&e.jsx("span",{className:"bg-primary/10 text-primary rounded-md px-2 py-0.5 text-xs",children:t("contact.defaultLabel")})]})]},v.id)})})]},u.id))})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const ol=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(cv,{})});ol.__docgenInfo={description:"",methods:[],displayName:"ContactPickerJob"};const cl=()=>{const{t}=B(["wallet","home"]),{pop:s}=Y(),{navigate:n}=re(),a=()=>{s(),n({to:"/wallet/create"})},r=()=>{s(),n({to:"/onboarding/recover"})},o=()=>{s()};return e.jsx(ce,{onCancel:o,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("wallet:add")})}),e.jsxs("div",{className:"space-y-3 p-4",children:[e.jsxs("button",{onClick:a,className:R("flex w-full items-center gap-4 rounded-xl p-4 transition-colors","bg-muted/50 hover:bg-muted active:bg-muted/80"),children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10",children:e.jsx(nt,{className:"size-6 text-primary"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-semibold",children:t("home:welcome.createWallet")}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t("wallet:createDesc")})]})]}),e.jsxs("button",{onClick:r,className:R("flex w-full items-center gap-4 rounded-xl p-4 transition-colors","bg-muted/50 hover:bg-muted active:bg-muted/80"),children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10",children:e.jsx(Hs,{className:"size-6 text-primary"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-semibold",children:t("home:welcome.importWallet")}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t("wallet:importDesc")})]})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};cl.__docgenInfo={description:"",methods:[],displayName:"WalletAddJob"};const ll=()=>{const{t}=B(["wallet","common"]),{pop:s,push:n}=Y(),a=yt(),o=Ae()?.id,{getWalletTheme:c}=qi(),i=Hi(),l=f=>{fe.setCurrentWallet(f),s()},m=()=>{s(),n("WalletAddJob",{})},u=()=>{s()};return e.jsx(ce,{onCancel:u,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("common:a11y.tabWallet")})}),e.jsx("div",{className:"max-h-[50vh] space-y-2 overflow-y-auto p-4",children:a.map(f=>{const h=f.id===o,v=f.chainAddresses[0]?.address,y=v?`${v.slice(0,6)}...${v.slice(-4)}`:"---",p=c(f.id);return e.jsxs("button",{onClick:()=>l(f.id),className:R("flex w-full items-center gap-3 rounded-xl p-4 transition-all","active:scale-[0.98]",h?"bg-primary/10 ring-2 ring-primary":"bg-muted/50 hover:bg-muted"),children:[e.jsx(bm,{themeHue:p,size:"md",watermarkIconUrl:i[f.chain]}),e.jsxs("div",{className:"min-w-0 flex-1 text-left",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate font-medium",children:f.name}),h&&e.jsx(Nm,{className:"size-4 shrink-0 text-primary"})]}),e.jsx("p",{className:"truncate font-mono text-xs text-muted-foreground",children:y})]})]},f.id)})}),e.jsx("div",{className:"border-t border-border p-4",children:e.jsxs("button",{onClick:m,className:R("flex w-full items-center justify-center gap-2 rounded-xl p-4","bg-muted/50 hover:bg-muted active:bg-muted/80 transition-colors"),children:[e.jsx(nt,{className:"size-5"}),e.jsx("span",{className:"font-medium",children:t("wallet:add")})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};ll.__docgenInfo={description:"",methods:[],displayName:"WalletListJob"};let ba=null;function lv(t){ba=t}const dl=()=>{const{t}=B(["onboarding","common"]),{pop:s}=Y(),[n,a]=d.useState(!1),r=()=>{s()},o=()=>{n&&(s(),ba?.(),ba=null)};return e.jsx(Gc,{children:e.jsxs("div",{className:"bg-background mx-4 max-w-sm rounded-2xl p-5",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"rounded-full bg-amber-500/15 p-2",children:e.jsx(_e,{className:"size-5 text-amber-600","aria-hidden":"true"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h2",{className:"text-base font-semibold",children:t("onboarding:securityWarning.title")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:t("onboarding:securityWarning.message")})]})]}),e.jsxs("label",{className:"mt-4 flex cursor-pointer items-center gap-2 text-sm",children:[e.jsx(so,{checked:n,onCheckedChange:a}),e.jsx("span",{children:t("onboarding:securityWarning.acknowledge")})]}),e.jsxs("div",{className:"mt-5 flex gap-2",children:[e.jsx(q,{type:"button",variant:"outline",className:"flex-1",onClick:r,children:t("common:cancel")}),e.jsx(q,{type:"button",className:"flex-1",onClick:o,disabled:!n,children:t("common:confirm")})]})]})})};dl.__docgenInfo={description:"",methods:[],displayName:"SecurityWarningJob"};let Cs=null;function ul(t,s){Cs={onConfirm:t,minFee:s?.minFee,onFeeChange:s?.onFeeChange}}function Si(){Cs=null}function dv(t){return t.length<=16?t:`${t.slice(0,10)}...${t.slice(-6)}`}function uv(){const{t}=B("transaction"),{pop:s,push:n}=Y(),a=de(),[r,o]=d.useState(!1),[c,i]=d.useState(!1),[l,m]=d.useState(!1),[u,f]=d.useState(null),h=d.useRef(Cs),v=d.useRef(!1);!v.current&&Cs&&(h.current=Cs,Si(),v.current=!0),d.useEffect(()=>()=>{Si()},[]);const y=a.feeLoading==="true",p=a.feeFiatValue?parseFloat(a.feeFiatValue):void 0,x=u??a.feeAmount,g=!!h.current?.onFeeChange,j=d.useCallback(async()=>{try{await Aa.write({text:a.toAddress}),i(!0),setTimeout(()=>i(!1),2e3)}catch{}},[a.toAddress]),N=d.useCallback(()=>{o(I=>!I)},[]),b=d.useCallback(()=>{const I=h.current;I?.onFeeChange&&(sl({currentFee:x,minFee:I.minFee??a.feeAmount,symbol:a.feeSymbol},E=>{f(E.fee),I.onFeeChange?.(E.fee)}),n("FeeEditJob",{}))},[x,a.feeAmount,a.feeSymbol,n]),S=d.useCallback(async()=>{const I=h.current;if(!(!I?.onConfirm||l)){m(!0);try{s(),await I.onConfirm()}finally{m(!1)}}},[l,s]),w=d.useCallback(()=>{s()},[s]);return e.jsx(ce,{"data-testid":"transfer-confirm-sheet",onCancel:w,children:e.jsx(Cn,{title:t("confirmSheet.title"),children:e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-3xl font-bold",children:[a.amount," ",a.symbol]}),a.fiatValue&&e.jsxs("p",{className:"text-muted-foreground mt-1",children:[" $",a.fiatValue]})]}),e.jsxs("div",{className:"bg-muted/30 space-y-4 rounded-xl p-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:t("confirmSheet.toAddress")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:N,className:"hover:text-primary flex min-w-0 flex-1 items-center gap-1 text-left font-mono text-sm",children:[e.jsx("span",{className:R("min-w-0",r?"break-all":"truncate"),children:r?a.toAddress:dv(a.toAddress)}),r?e.jsx(no,{className:"size-4 shrink-0"}):e.jsx(ro,{className:"size-4 shrink-0"})]}),e.jsx("button",{type:"button",onClick:j,className:"text-muted-foreground hover:text-foreground shrink-0 p-1","aria-label":t(c?"confirmSheet.copied":"confirmSheet.copyAddress"),children:c?e.jsx(he,{className:"size-4 text-green-500"}):e.jsx(Ki,{className:"size-4"})})]})]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:t("confirmSheet.networkFee")}),e.jsx(_a,{amount:x,symbol:a.feeSymbol,...p!==void 0&&{fiatValue:p},isLoading:y,editable:g,onEdit:b})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button","data-testid":"cancel-transfer-button",onClick:w,className:"border-border hover:bg-muted flex-1 rounded-full border py-3 font-medium transition-colors",disabled:l,children:t("confirmSheet.cancel")}),e.jsx("button",{type:"button","data-testid":"confirm-transfer-button",onClick:S,disabled:l||y,className:R("flex-1 rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(l?"confirmSheet.confirming":"confirmSheet.confirm")})]})]})})})}const ml=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(uv,{})});ml.__docgenInfo={description:"",methods:[],displayName:"TransferConfirmJob"};let Pn=null;function fl(t){Pn=t}function mv(){Pn=null}function fv(){const{t}=B(["security","transaction","common"]),{pop:s,push:n}=Y(),{title:a}=de(),r=Wa(),o=at(),c=Be(),i=st(),l=Ae(),[m,u]=d.useState("wallet_lock"),[f,h]=d.useState([]),[v,y]=d.useState(""),[p,x]=d.useState("idle"),[g,j]=d.useState(),[N,b]=d.useState(),[S,w]=d.useState(!1),[I,E]=d.useState(!1),[A,P]=d.useState(),[k,T]=d.useState(null),C=d.useRef(null),_=d.useRef(""),z=d.useRef(!1);!z.current&&Pn&&(C.current=Pn,mv(),z.current=!0),d.useEffect(()=>{if(!g||!c||!l?.address)return;const se=Pe(c);return se?.transaction?se.transaction.subscribe({txHash:g,senderId:l.address},Z=>{Z&&(Z.status==="confirmed"?x("confirmed"):Z.status==="failed"?x("failed"):Z.status==="pending"&&x("broadcasted"))}):void 0},[g,c,l?.address]),d.useEffect(()=>{if(p!=="confirmed"){T(null);return}T(5);const se=setInterval(()=>{T(H=>H===null||H<=1?(clearInterval(se),s(),null):H-1)},1e3);return()=>clearInterval(se)},[p,s]);const D=d.useMemo(()=>Je.getChainById(i,c),[i,c]),L=d.useMemo(()=>{const se=D?.explorer?.queryTx;return!se||!g?null:se.replace(":hash",g).replace(":signature",g)},[D?.explorer?.queryTx,g]),J=d.useCallback(()=>{L&&window.open(L,"_blank","noopener,noreferrer")},[L]),M=m==="wallet_lock"?a??t("security:walletLock.verifyTitle"):t("transaction:sendPage.twoStepSecretTitle"),O=d.useCallback(async se=>{const H=C.current;if(se.length<4||!H)return;E(!0),b(void 0),w(!1),x("broadcasting");const Z=gt(se);_.current=Z;try{const X=await H(Z);if(X.status==="ok"){X.txHash&&j(X.txHash),X.pendingTxId&&P(X.pendingTxId),x("broadcasted");return}if(X.status==="wallet_lock_invalid"){w(!0),h([]),x("idle");return}if(X.status==="two_step_secret_required"){u("two_step_secret"),b(void 0),x("idle");return}if(X.status==="error"){b(X.message??t("transaction:broadcast.unknown")),x("failed"),X.pendingTxId&&P(X.pendingTxId);return}}catch{b(t("transaction:broadcast.unknown")),x("failed")}finally{E(!1)}},[t]),Q=d.useCallback(async()=>{const se=C.current;if(!(!v.trim()||!se)){E(!0),b(void 0);try{const H=await se(_.current,v);if(H.status==="ok"){H.txHash&&j(H.txHash),H.pendingTxId&&P(H.pendingTxId),x("broadcasted");return}(H.status==="two_step_secret_invalid"||H.status==="error")&&(b(H.message??t("transaction:sendPage.twoStepSecretError")),H.pendingTxId&&(P(H.pendingTxId),x("failed")))}catch{b(t("transaction:sendPage.twoStepSecretError"))}finally{E(!1)}}},[v,t]),te=d.useCallback(se=>{se.preventDefault(),m==="two_step_secret"&&Q()},[m,Q]),W=v.trim().length>0&&!I,G=d.useCallback(async()=>{if(A){E(!0),b(void 0);try{await yu.retryBroadcast(A,i),x("broadcasted")}catch(se){b(se instanceof Error?se.message:t("transaction:broadcast.unknown"))}finally{E(!1)}}},[A,i,t]),ve=d.useCallback(()=>{s()},[s]);if(p!=="idle"){const se=p==="failed",H=p==="confirmed";return e.jsx(ce,{onCancel:ve,children:e.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx(to,{status:p,txHash:g,title:{broadcasted:t("transaction:txStatus.broadcasted"),confirmed:t("transaction:sendResult.success"),failed:t("transaction:broadcast.failed")},description:{broadcasted:t("transaction:txStatus.broadcastedDesc"),confirmed:k!==null?t("transaction:txStatus.autoCloseIn",{seconds:k}):t("transaction:txStatus.confirmedDesc"),failed:N},onStatusChange:x,onDone:()=>s(),onViewDetails:()=>{s(),g&&n("TransactionDetailActivity",{txId:g})},onViewExplorer:L?J:void 0,onShare:async()=>{g&&(await r.write({text:g}),o.show(t("common:copied")))}}),e.jsxs("div",{className:"px-4 pb-4 space-y-2",children:[se&&e.jsxs("button",{type:"button",onClick:G,disabled:I,className:R("w-full flex items-center justify-center gap-2 rounded-full py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:[e.jsx(Vt,{className:"size-4"}),t(I?"common:retrying":"transaction:pendingTx.retry")]}),e.jsx("button",{type:"button",onClick:ve,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:H&&k!==null?t("transaction:txStatus.closeIn",{seconds:k}):t("common:close")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})})}return m==="wallet_lock"?e.jsx(ce,{onCancel:ve,children:e.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:e.jsx(Cn,{title:M,children:e.jsxs("div",{className:"p-4",children:[e.jsx(Ut,{value:f,onChange:h,onComplete:O,minPoints:4,error:S,disabled:I,"data-testid":"transfer-wallet-lock-pattern"}),N&&e.jsxs("div",{className:"flex items-start justify-center gap-1.5 text-sm text-destructive mt-3",children:[e.jsx(vt,{className:"size-4 shrink-0 mt-0.5"}),e.jsx("pre",{className:"overflow-auto whitespace-break-spaces",children:N})]}),e.jsx("button",{type:"button",onClick:ve,disabled:I,className:"mt-4 w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("common:cancel")})]})})})}):e.jsx(ce,{onCancel:ve,children:e.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:e.jsx(Cn,{title:M,children:e.jsxs("form",{onSubmit:te,className:"space-y-6 p-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-primary mb-2",children:[e.jsx($s,{className:"size-5"}),e.jsx("span",{className:"text-sm",children:t("transaction:sendPage.twoStepSecretDescription")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(hn,{value:v,onChange:se=>y(se.target.value),placeholder:t("transaction:sendPage.twoStepSecretPlaceholder"),disabled:I,"aria-describedby":N?"two-step-error":void 0,"data-testid":"two-step-secret-input"}),v.length>0&&v.length<6&&e.jsx("div",{className:"absolute right-10 top-1/2 -translate-y-1/2",children:e.jsx("span",{className:"text-xs text-amber-500",children:t("security:twoStepSecret.lengthHint",{count:v.length})})})]}),N&&e.jsxs("div",{id:"two-step-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(vt,{className:"size-4"}),e.jsx("span",{children:N})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{type:"submit","data-testid":"two-step-confirm-button",disabled:!W,className:R("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(I?"common:verifying":"common:confirm")}),e.jsx("button",{type:"button",onClick:()=>s(),disabled:I,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("common:cancel")})]})]})})})})}const pl=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(fv,{})});pl.__docgenInfo={description:"",methods:[],displayName:"TransferWalletLockJob"};const pv=150;function hv(){const{t}=B("scanner"),{pop:s}=Y(),n=Io(),{chainType:a,title:r,hint:o}=de(),c=d.useRef(null),i=d.useRef(null),l=d.useRef(null),m=d.useRef(null),u=d.useRef(!1),f=d.useRef(!1),h=d.useRef(!1),[v,y]=d.useState(!1),[p,x]=d.useState(!1),[g,j]=d.useState(null),[N,b]=d.useState(null),S=Cm(a),w=d.useCallback(C=>{if(C===N)return;b(C);const _=io(C),z=S(C,_);if(z===!0){j({type:"success",text:t("scanSuccess")}),"vibrate"in navigator&&navigator.vibrate(100),u.current=!1;const D=km();setTimeout(()=>{s(),setTimeout(()=>{D?.({content:C,parsed:_})},100)},300)}else j({type:"error",text:t(z,{defaultValue:z})}),setTimeout(()=>{j(null),b(null)},3e3)},[N,S,t,s]),I=d.useCallback(()=>{if(u.current)return;u.current=!0,i.current||(i.current=document.createElement("canvas"));const C=async()=>{if(!(!u.current||!c.current||!m.current)){try{const _=await m.current.scanFromVideo(c.current,i.current??void 0);_&&w(_.content)}catch{}u.current&&setTimeout(C,pv)}};C()},[w]),E=d.useCallback(()=>{u.current=!1,l.current&&(l.current.getTracks().forEach(C=>C.stop()),l.current=null),y(!1)},[]),A=d.useCallback(async()=>{if(!h.current){if(h.current=!0,!navigator.mediaDevices?.getUserMedia){j({type:"error",text:t("error")}),h.current=!1;return}try{try{if(!await n.checkPermission()&&!await n.requestPermission()){j({type:"error",text:t("permissionDenied")}),h.current=!1;return}}catch{}if(!f.current){h.current=!1;return}const C=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});if(!f.current){C.getTracks().forEach(_=>_.stop()),h.current=!1;return}if(l.current=C,c.current){c.current.srcObject=C;try{await c.current.play(),f.current&&(y(!0),I())}catch(_){if(!(_ instanceof DOMException&&_.name==="AbortError"))throw _}}}catch(C){if(!f.current){h.current=!1;return}C instanceof DOMException?C.name==="NotAllowedError"?j({type:"error",text:t("permissionDenied")}):C.name==="NotFoundError"?j({type:"error",text:t("noCameraFound",{defaultValue:t("error")})}):C.name==="AbortError"||j({type:"error",text:t("error")}):j({type:"error",text:t("error")})}finally{h.current=!1}}},[n,I,t]);d.useEffect(()=>(f.current=!0,m.current=oo({useWorker:!0}),A(),()=>{f.current=!1,E(),m.current?.destroy(),m.current=null}),[]);const P=d.useCallback(()=>{const C=document.createElement("input");C.type="file",C.accept="image/*",C.onchange=async _=>{const z=_.target.files?.[0];if(!(!z||!m.current))try{const D=new Image,L=URL.createObjectURL(z);D.onload=async()=>{URL.revokeObjectURL(L);const J=document.createElement("canvas");J.width=D.width,J.height=D.height;const M=J.getContext("2d");if(!M||!m.current){j({type:"error",text:t("noQrFound")});return}M.drawImage(D,0,0);const O=await m.current.scanFromCanvas(J);O?w(O.content):j({type:"error",text:t("noQrFound")})},D.onerror=()=>{URL.revokeObjectURL(L),j({type:"error",text:t("noQrFound")})},D.src=L}catch{j({type:"error",text:t("noQrFound")})}},C.click()},[w,t]),k=d.useCallback(async()=>{if(l.current){const C=l.current.getVideoTracks()[0];if(C)try{await C.applyConstraints({advanced:[{torch:!p}]}),x(!p)}catch{}}},[p]),T=d.useCallback(()=>{E(),s()},[E,s]);return e.jsx(ce,{onCancel:T,children:e.jsxs("div",{className:"flex h-[80vh] flex-col overflow-hidden rounded-t-2xl bg-black",children:[e.jsx("div",{className:"flex justify-center py-2",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-white/30"})}),e.jsxs("div",{className:"flex items-center justify-between px-4 pb-2",children:[e.jsx(q,{variant:"ghost",size:"icon",onClick:T,className:"text-white hover:bg-white/20","data-testid":"scanner-close-button",children:e.jsx(Us,{className:"size-6"})}),e.jsx("h2",{className:"text-lg font-medium text-white","data-testid":"scanner-title",children:r??t("title")}),e.jsx(q,{variant:"ghost",size:"icon",onClick:k,className:R("text-white hover:bg-white/20",p&&"text-yellow-400"),"data-testid":"scanner-flash-button",children:e.jsx(No,{className:"size-6"})})]}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("video",{ref:c,className:R("absolute inset-0 size-full object-cover",!v&&"hidden"),playsInline:!0,muted:!0,"data-testid":"scanner-video"}),!v&&!g&&e.jsx("div",{className:"flex size-full items-center justify-center",children:e.jsx("p",{className:"text-white/60",children:t("initializing")})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"relative size-64","data-testid":"scanner-viewfinder",children:[e.jsx("div",{className:R("absolute top-0 left-0 size-8 border-t-4 border-l-4",g?.type==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:R("absolute top-0 right-0 size-8 border-t-4 border-r-4",g?.type==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:R("absolute bottom-0 left-0 size-8 border-b-4 border-l-4",g?.type==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:R("absolute right-0 bottom-0 size-8 border-r-4 border-b-4",g?.type==="success"?"border-green-500":"border-primary")}),v&&!g&&e.jsx("div",{className:"animate-scan bg-primary absolute right-2 left-2 h-0.5"})]})}),e.jsx("div",{className:"absolute inset-x-0 bottom-24 px-4 text-center",children:g?e.jsx("div",{className:R("inline-block rounded-lg px-4 py-2",g.type==="error"&&"bg-red-500/80 text-white",g.type==="success"&&"bg-green-500/80 text-white",g.type==="info"&&"bg-black/50 text-white"),"data-testid":"scanner-message",children:g.text}):v?e.jsx("p",{className:"text-white/80","data-testid":"scanner-hint",children:o??(a?t("scanPromptChain",{chain:a}):t("scanPrompt"))}):null})]}),e.jsx("div",{className:"flex justify-center gap-8 bg-black/50 py-6",children:e.jsxs(q,{variant:"ghost",size:"lg",onClick:P,className:"flex flex-col items-center text-white hover:bg-white/20","data-testid":"scanner-gallery-button",children:[e.jsx(yo,{className:"mb-1 size-6"}),e.jsx("span",{className:"text-xs",children:t("gallery")})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)] bg-black"})]})})}const hl=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(hv,{})});hl.__docgenInfo={description:"",methods:[],displayName:"ScannerJob"};function xv(){const{t}=B("common"),{pop:s}=Y(),n=de(),[a,r]=d.useState(n.name||""),[o,c]=d.useState(n.memo||""),[i,l]=d.useState(0),[m,u]=d.useState(!1),[f,h]=d.useState(!1),v=(()=>{try{return JSON.parse(n.addresses||"[]")}catch{return[]}})(),y=d.useCallback(()=>{l(g=>g+1)},[]),p=d.useCallback(async()=>{if(!(!a.trim()||v.length===0)){u(!0);try{const g=n.avatar||(v[0]?.address?Rt(v[0].address,i):void 0);Ss.addContact({name:a.trim(),addresses:v.map((j,N)=>({id:`addr-${N}`,address:j.address,label:j.label,isDefault:N===0})),memo:o.trim()||void 0,avatar:g}),h(!0),setTimeout(()=>s(),500)}catch{}finally{u(!1)}}},[a,o,v,n.avatar,i,s]),x=d.useCallback(()=>{s()},[s]);return e.jsx(ce,{onCancel:x,children:e.jsxs("div",{className:"bg-background rounded-t-2xl pb-[env(safe-area-inset-bottom)]",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx("div",{className:"border-border border-b px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("addressBook.addContact")})}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:y,className:"group relative",title:t("addressBook.changeAvatar"),children:[e.jsx(ds,{src:n.avatar||(v[0]?.address?Rt(v[0].address,i):void 0),size:48}),!n.avatar&&e.jsx("div",{className:"bg-background/80 absolute inset-0 flex items-center justify-center rounded-full opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx(Vt,{className:"text-primary size-5"})})]}),e.jsx(De,{value:a,onChange:g=>r(g.target.value),placeholder:t("addressBook.namePlaceholder"),className:"flex-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm",children:t("addressBook.addresses")}),e.jsx("div",{className:"space-y-2",children:v.map((g,j)=>{const N=ym(g.address),b=g.label||N.chainType?.toUpperCase()||"";return e.jsxs("div",{className:"bg-muted/50 flex items-center gap-3 rounded-lg p-3",children:[e.jsx(Ra,{className:"text-muted-foreground size-5 shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[b&&e.jsx("div",{className:"text-muted-foreground text-xs",children:b}),e.jsx("div",{className:"truncate font-mono text-sm",children:g.address})]})]},j)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm",children:t("addressBook.memo")}),e.jsx(De,{value:o,onChange:g=>c(g.target.value),placeholder:t("addressBook.memoPlaceholder")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx(q,{variant:"outline",onClick:x,disabled:m||f,className:"flex-1",children:t("cancel")}),e.jsx(q,{onClick:p,disabled:!a.trim()||v.length===0||m||f,className:R("flex-1",f&&"bg-green-500"),children:f?e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"mr-1 size-4"}),t("saved")]}):t(m?"saving":"save")})]})]})})}const xl=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(xv,{})});xl.__docgenInfo={description:"",methods:[],displayName:"ContactAddConfirmJob"};function gv(){const{t}=B("common"),{pop:s}=Y(),n=de(),a=d.useRef(null),[r,o]=d.useState(!1),c=d.useMemo(()=>{try{return JSON.parse(n.addresses||"[]")}catch{return[]}},[n.addresses]),i=d.useMemo(()=>Ma({name:n.name,addresses:c,avatar:n.avatar}),[n.name,c,n.avatar]),l=d.useCallback(async()=>{const f=a.current;if(!(!f||r)){o(!0);try{const{snapdom:h}=await ht(async()=>{const{snapdom:v}=await import("./snapdom-CO8q8LPW.js").then(y=>y.s);return{snapdom:v}},__vite__mapDeps([0,1]),import.meta.url);await h.download(f,{type:"png",filename:`contact-${n.name}.png`,scale:2,quality:1})}catch{}finally{o(!1)}}},[n.name,r]),m=d.useCallback(async()=>{const f=a.current;if(!(!f||!navigator.share)){o(!0);try{const{snapdom:h}=await ht(async()=>{const{snapdom:x}=await import("./snapdom-CO8q8LPW.js").then(g=>g.s);return{snapdom:x}},__vite__mapDeps([0,1]),import.meta.url),y=await(await h(f,{scale:2})).toBlob(),p=new File([y],`contact-${n.name}.png`,{type:"image/png"});await navigator.share({title:t("addressBook.shareContact"),text:`${n.name} - ${c.map(x=>`${x.label||""}: ${x.address}`).join(", ")}`,files:[p]})}catch{}finally{o(!1)}}},[n.name,c,t,r]),u=()=>{s()};return e.jsx(ce,{onCancel:u,children:e.jsxs("div",{className:"bg-background rounded-t-2xl pb-[env(safe-area-inset-bottom)]",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"flex items-center justify-between border-b px-4 pb-4",children:[e.jsx(q,{variant:"ghost",size:"icon",onClick:u,children:e.jsx(Us,{className:"size-5"})}),e.jsx("h2",{className:"text-lg font-semibold",children:t("addressBook.shareContact")}),e.jsx("div",{className:"w-10"})]}),e.jsxs("div",{className:"flex flex-col items-center p-6",children:[e.jsx("div",{ref:a,children:e.jsx(La,{name:n.name,avatar:n.avatar,addresses:c,qrContent:i})}),e.jsx("p",{className:"text-muted-foreground mt-4 text-center text-sm",children:t("addressBook.scanToAdd")})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsxs(q,{variant:"outline",onClick:l,disabled:r,className:"flex-1",children:[r?e.jsx(ke,{className:"mr-2 size-4 animate-spin"}):e.jsx(Hs,{className:"mr-2 size-4"}),t("download")]}),"share"in navigator&&e.jsxs(q,{onClick:m,disabled:r,className:"flex-1",children:[r?e.jsx(ke,{className:"mr-2 size-4 animate-spin"}):e.jsx(Ms,{className:"mr-2 size-4"}),t("share")]})]})]})})}const gl=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(gv,{})});gl.__docgenInfo={description:"",methods:[],displayName:"ContactShareJob"};function vv(){const{t}=B(["settings","common"]),{pop:s}=Y(),[n,a]=d.useState(!1),r=d.useCallback(()=>{a(!0);const c="./";window.location.href=`${c}clear.html`},[]),o=()=>{s()};return e.jsx(ce,{onCancel:o,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-destructive/10 flex size-16 items-center justify-center rounded-full",children:e.jsx(_e,{className:"text-destructive size-8"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:t("settings:clearData.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("settings:clearData.warning")})]}),e.jsx("div",{className:"bg-destructive/5 rounded-lg p-4",children:e.jsxs("ul",{className:"text-destructive space-y-2 text-sm",children:[e.jsxs("li",{children:[" ",t("settings:clearData.item1")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item2")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item3")]})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(q,{variant:"outline",className:"flex-1",onClick:o,disabled:n,children:t("common:cancel")}),e.jsx(q,{variant:"destructive",className:"flex-1",onClick:r,disabled:n,children:t("settings:clearData.confirm")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const vl=()=>e.jsx(vv,{});vl.__docgenInfo={description:"",methods:[],displayName:"ClearDataConfirmJob"};function yv(t){if(!t)return;if(t.startsWith("0x")){const n=Bn(t);if(n)return n}const s=Am(t);return As.getConfig(s),s}function bv(){const{t}=B("common"),{pop:s}=Y(),{chain:n,exclude:a,appName:r,appIcon:o}=de(),c=Os(),i=d.useMemo(()=>yv(n),[n]),l=d.useMemo(()=>i?c.find(x=>x.id===i):null,[i,c]),m=i?As.getName(i):void 0,u=we(Ce),f=Bs.getCurrentWallet(u),h=d.useMemo(()=>{const x=a?.toLowerCase(),g=[];for(const j of u.wallets){const N=i?j.chainAddresses.find(b=>b.chain===i):j.chainAddresses[0];N&&(x&&N.address.toLowerCase()===x||g.push({id:j.id,name:j.name,address:N.address,themeHue:j.themeHue,chainIconUrl:l?.icon}))}return g},[u.wallets,i,a]),v=d.useMemo(()=>{const x=new Map;return u.wallets.forEach(g=>{const j=i?g.chainAddresses.find(N=>N.chain===i):g.chainAddresses[0];j&&x.set(g.id,{wallet:g,chainAddress:j})}),x},[u.wallets,i]),y=x=>{const g=v.get(x);if(!g)return;const j=new CustomEvent("wallet-picker-select",{detail:{address:g.chainAddress.address,chain:g.chainAddress.chain,name:g.wallet.name,publicKey:g.chainAddress.publicKey}});window.dispatchEvent(j),s()},p=x=>{x?.preventDefault?.();const g=new CustomEvent("wallet-picker-cancel");window.dispatchEvent(g),s()};return e.jsx(ce,{onCancel:p,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Ht,{title:i?t("selectChainWallet",{chain:m}):t("selectWallet"),description:`${r||t("unknownDApp")} ${t("requestsAccess")}`,appName:r,appIcon:o,chainId:i}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto p-4",children:h.length===0?e.jsx("div",{className:"text-muted-foreground py-12 text-center text-sm",children:i?t("noWalletsForChain",{chain:i}):t("noWallets")}):e.jsx(wm,{wallets:h,currentWalletId:f?.id,onSelect:y,showAddButton:!1})}),e.jsx("div",{className:"border-border border-t p-4",children:e.jsx("button",{onClick:p,className:"bg-muted hover:bg-muted/80 w-full rounded-xl py-3 font-medium transition-colors",children:t("cancel")})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const yl=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(bv,{})});yl.__docgenInfo={description:"",methods:[],displayName:"WalletPickerJob"};function jv(){const{t}=B("common"),{pop:s,push:n}=Y(),{message:a,address:r,appName:o,appIcon:c,chainName:i}=de(),l=Ae(),[m,u]=d.useState(!1),f=Ce.state.wallets.find(x=>x.chainAddresses.some(g=>g.address===r)),h=f?.name||t("unknownWallet"),v=d.useCallback(()=>{m||(Nt(async x=>{u(!0);try{const g=f?.encryptedMnemonic??l?.encryptedMnemonic;if(!g||!f)throw new Error(t("signingAddressNotFound"));const j=`miniapp_sign_${Date.now()}`,b=await new Fa(rs,j).handleMessageSign({chainName:i||"bioforest",senderAddress:r,message:a},g,x),S=new CustomEvent("signing-confirm",{detail:{confirmed:!0,signature:b.signature,publicKey:b.publicKey}});return window.dispatchEvent(S),s(),!0}catch(g){throw g instanceof Error?g:new Error(t("walletLock.error"))}finally{u(!1)}}),n("WalletLockConfirmJob",{title:t("sign")}))},[m,l,i,r,a,s,n,t,f]),y=d.useCallback(()=>{const x=new CustomEvent("signing-confirm",{detail:{confirmed:!1}});window.dispatchEvent(x),s()},[s]),p=a.startsWith("0x")&&/^0x[0-9a-fA-F]+$/.test(a);return e.jsx(ce,{onCancel:y,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Ht,{title:t("signMessage"),description:o||t("unknownDApp"),appName:o,appIcon:c,walletInfo:{name:h,address:r,chainId:i||"bfmeta"}}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsxs("p",{className:"text-muted-foreground mb-1 text-xs",children:[" ",t("message")]}),e.jsx("div",{className:"max-h-40 overflow-y-auto",children:e.jsx("pre",{className:"font-mono text-sm break-all whitespace-pre-wrap",children:a})})]}),p&&e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[e.jsx(_e,{className:"size-5 shrink-0 text-amber-600"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:t("hexDataWarning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:y,disabled:m,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("cancel")}),e.jsx("button",{onClick:v,disabled:m,className:R("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","flex items-center justify-center gap-2 disabled:opacity-50"),children:m?e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"size-4 animate-spin"}),t("signing")]}):t("sign")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const bl=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(jv,{})});bl.__docgenInfo={description:"",methods:[],displayName:"SigningConfirmJob"};const Nv={bio_requestAccounts:Ra,bio_createTransaction:Xi,bio_signMessage:qn,bio_signTypedData:qn,bio_signTransaction:qn,bio_sendTransaction:uf};function wv(){const{t}=B("permission"),{pop:s}=Y(),{appName:n,appIcon:a,permissions:r}=de(),o=(()=>{try{return JSON.parse(r)}catch{return[]}})(),c=()=>{const u=new CustomEvent("permission-request",{detail:{approved:!0,permissions:o}});window.dispatchEvent(u),s()},i=()=>{const u=new CustomEvent("permission-request",{detail:{approved:!1}});window.dispatchEvent(u),s()},l=u=>{const f=`${u}.label`;return String(t(f))},m=u=>{const f=`${u}.description`;return String(t(f))};return e.jsx(ce,{onCancel:i,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"border-border border-b px-4 pb-4",children:[e.jsx("div",{className:"bg-primary/10 mx-auto mb-3 flex size-14 items-center justify-center rounded-2xl",children:a?e.jsx("img",{src:a,alt:n,className:"size-10 rounded-xl"}):e.jsx(Pm,{className:"text-primary size-8"})}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:n}),e.jsx("p",{className:"text-muted-foreground mt-1 text-center text-sm",children:String(t("requestsPermissions"))})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"space-y-3",children:o.map(u=>{const f=Nv[u];return f?e.jsxs("div",{className:"bg-muted/50 flex items-center gap-3 rounded-xl p-3",children:[e.jsx("div",{className:"bg-primary/10 flex size-10 shrink-0 items-center justify-center rounded-full",children:e.jsx(f,{className:"text-primary size-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium",children:l(u)}),e.jsx("p",{className:"text-muted-foreground text-sm",children:m(u)})]})]},u):null})}),e.jsxs("div",{className:"text-muted-foreground mt-4 flex items-center gap-2 text-sm",children:[e.jsx(co,{className:"size-4"}),e.jsx("span",{children:String(t("permissionNote"))})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:i,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("reject")}),e.jsx("button",{onClick:c,className:R("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90"),children:t("approve")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const jl=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(wv,{})});jl.__docgenInfo={description:"",methods:[],displayName:"PermissionRequestJob"};function Cv(){const{t}=B("common"),{pop:s,push:n}=Y(),a=de(),{appName:r,appIcon:o,from:c,to:i,amount:l,chain:m,asset:u}=a,f=Ae(),[h,v]=d.useState(!1),p=Ce.state.wallets.find(N=>N.chainAddresses.some(b=>b.address===c))?.name||t("unknownWallet"),x=d.useCallback(()=>{h||(Nt(async N=>{v(!0);try{const b=f?.encryptedMnemonic;if(!b)return!1;const S=`miniapp_transfer_${Date.now()}`,w=new Fa(rs,S),I={chainName:m,senderAddress:c,receiveAddress:i,balance:l};u&&(I.assetType=u);const A=await w.handleTransferSign(I,b,N),P=new CustomEvent("miniapp-transfer-confirm",{detail:{confirmed:!0,txHash:A}});return window.dispatchEvent(P),s(),!0}catch{return!1}finally{v(!1)}}),n("WalletLockConfirmJob",{title:t("confirmTransfer")}))},[h,f,m,c,i,l,u,s,n,t]),g=d.useCallback(()=>{const N=new CustomEvent("miniapp-transfer-confirm",{detail:{confirmed:!1}});window.dispatchEvent(N),s()},[s]),j=u||m.toUpperCase();return e.jsx(ce,{onCancel:g,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Ht,{title:t("confirmTransfer"),description:`${r||t("unknownDApp")} ${t("requestsTransfer")}`,appName:r,appIcon:o,walletInfo:{name:p,address:c,chainId:m}}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx("div",{className:"bg-muted/50 rounded-xl p-4 text-center",children:e.jsx(At,{value:l,symbol:j,size:"xl",weight:"bold",decimals:8,fixedDecimals:!0})}),e.jsxs("div",{className:"bg-muted/50 space-y-3 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-10 shrink-0 text-xs",children:[" ",t("from")]}),e.jsx(Pt,{address:c,copyable:!0,className:"flex-1 text-sm"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(Dn,{className:"text-muted-foreground size-4"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-10 shrink-0 text-xs",children:[" ",t("to")]}),e.jsx(Pt,{address:i,copyable:!0,className:"flex-1 text-sm"})]})]}),e.jsxs("div",{className:"bg-muted/50 flex items-center justify-between rounded-xl p-3",children:[e.jsxs("span",{className:"text-muted-foreground text-sm",children:[" ",t("network")]}),e.jsx(Ea,{chainId:m})]}),e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[e.jsx(_e,{className:"mt-0.5 size-5 shrink-0 text-amber-600"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:t("transferWarning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:g,disabled:h,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("cancel")}),e.jsx("button",{onClick:x,disabled:h,className:R("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","flex items-center justify-center gap-2 disabled:opacity-50"),children:h?e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"size-4 animate-spin"}),t("confirming")]}):t("confirm")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Nl=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(Cv,{})});Nl.__docgenInfo={description:"",methods:[],displayName:"MiniappTransferConfirmJob"};const hs=ge.t.bind(ge);async function wl(t,s,n){const a=Pe(t.id);return a.bioGetAssetDetail?(await a.bioGetAssetDetail(s,n))?.applyAddress??null:null}async function Cl(t,s,n){const a=Pe(t.id);if(!a.buildTransaction||!a.estimateFee)return{amount:ne.fromRaw("1000",t.decimals,t.symbol),symbol:t.symbol};try{const r=await a.buildTransaction({type:"destroy",from:"0x0000000000000000000000000000000000000000",recipientId:"0x0000000000000000000000000000000000000000",bioAssetType:s,amount:ne.fromRaw(n,t.decimals,t.symbol)});return{amount:(await a.estimateFee(r)).standard.amount,symbol:t.symbol}}catch{return{amount:ne.fromRaw("1000",t.decimals,t.symbol),symbol:t.symbol}}}async function En({chainConfig:t,walletId:s,password:n,fromAddress:a,recipientAddress:r,assetType:o,amount:c,fee:i,twoStepSecret:l}){let m;try{m=await as.getMnemonic(s,n)}catch(f){return f instanceof Rn&&f.code===Ln.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:f instanceof Error?f.message:hs("error:unknown")}}if(!c.isPositive())return{status:"error",message:hs("error:validation.enterValidAmount")};const u=Pe(t.id);if(!u.supportsFullTransaction)return{status:"error",message:hs("error:transaction.chainNotSupported")};try{let f=null;if(u.bioGetAccountInfo){if(f=(await u.bioGetAccountInfo(a)).secondPublicKey,f&&!l)return{status:"password_required",secondPublicKey:f};if(l&&f&&u.bioVerifyPayPassword&&!await u.bioVerifyPayPassword({mainSecret:m,paySecret:l,publicKey:f}))return{status:"error",message:hs("error:transaction.securityPasswordFailed")}}const h=await u.buildTransaction({type:"destroy",from:a,recipientId:r,amount:c,bioAssetType:o}),v=await u.signTransaction(h,{privateKey:new TextEncoder().encode(m),bioSecret:m,bioPaySecret:l}),y=await dt.create({walletId:Gi(t.id,a),chainId:t.id,fromAddress:a,rawTx:v,meta:{type:"destroy",displayAmount:c.toFormatted(),displaySymbol:o,displayToAddress:r}});await dt.updateStatus({id:y.id,status:"broadcasting"});try{const p=await u.broadcastTransaction(v);return await dt.updateStatus({id:y.id,status:"broadcasted",txHash:p}),{status:"ok",txHash:p,pendingTxId:y.id}}catch(p){const x=p;return await dt.updateStatus({id:y.id,status:"failed",errorCode:"BROADCAST_FAILED",errorMessage:x.message}),{status:"error",message:x.message,pendingTxId:y.id}}}catch(f){return{status:"error",message:(f instanceof Error?f.message:String(f))||hs("error:transaction.burnFailed")}}}const kv=Object.freeze(Object.defineProperty({__proto__:null,fetchAssetApplyAddress:wl,fetchBioforestBurnFee:Cl,submitBioforestBurn:En},Symbol.toStringTag,{value:"Module"}));function Sv(){const{t}=B(["common","transaction"]),{pop:s,push:n}=Y(),a=de(),{appName:r,appIcon:o,from:c,amount:i,chain:l,asset:m}=a,u=Ae(),f=st(),h=f.snapshot?Je.getChainById(f,l):null,[v,y]=d.useState(!1),x=Ce.state.wallets.find(N=>N.chainAddresses.some(b=>b.address===c))?.name||t("common:unknownWallet"),g=d.useCallback(()=>{v||(Nt(async N=>{y(!0);try{if(!u?.id||!h)return!1;const{fetchAssetApplyAddress:b}=await ht(async()=>{const{fetchAssetApplyAddress:A}=await Promise.resolve().then(()=>kv);return{fetchAssetApplyAddress:A}},void 0,import.meta.url),S=await b(h,m,c);if(!S)return!1;const w=ne.fromFormatted(i,h.decimals,m),I=await En({chainConfig:h,walletId:u.id,password:N,fromAddress:c,recipientAddress:S,assetType:m,amount:w});if(I.status==="password"||I.status==="error")return!1;const E=new CustomEvent("miniapp-destroy-confirm",{detail:{confirmed:!0,txHash:I.status==="ok"?I.txHash:void 0}});return window.dispatchEvent(E),s(),!0}catch{return!1}finally{y(!1)}}),n("WalletLockConfirmJob",{title:t("transaction:destroyPage.title")}))},[v,u,h,m,c,i,s,n,t]),j=d.useCallback(()=>{const N=new CustomEvent("miniapp-destroy-confirm",{detail:{confirmed:!1}});window.dispatchEvent(N),s()},[s]);return e.jsx(ce,{onCancel:j,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Ht,{title:t("transaction:destroyPage.title"),description:`${r||t("common:unknownDApp")} ${t("common:requestsDestroy")}`,appName:r,appIcon:o,walletInfo:{name:x,address:c,chainId:l}}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx("div",{className:"bg-destructive/5 rounded-xl p-4 text-center",children:e.jsx(At,{value:i,symbol:m,size:"xl",weight:"bold",decimals:8,fixedDecimals:!0})}),e.jsx("div",{className:"bg-muted/50 space-y-3 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-10 shrink-0 text-xs",children:[" ",t("common:from")]}),e.jsx(Sa,{chainId:l,address:c,copyable:!0,size:"sm"})]})}),e.jsxs("div",{className:"bg-muted/50 flex items-center justify-between rounded-xl p-3",children:[e.jsxs("span",{className:"text-muted-foreground text-sm",children:[" ",t("common:network")]}),e.jsx(Ea,{chainId:l})]}),e.jsxs("div",{className:"bg-destructive/10 flex items-start gap-2 rounded-xl p-3",children:[e.jsx(_e,{className:"text-destructive mt-0.5 size-5 shrink-0"}),e.jsx("p",{className:"text-destructive text-sm",children:t("transaction:destroyPage.warning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:j,disabled:v,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("common:cancel")}),e.jsx("button",{onClick:g,disabled:v,className:R("flex-1 rounded-xl py-3 font-medium transition-colors","bg-destructive text-destructive-foreground hover:bg-destructive/90","flex items-center justify-center gap-2 disabled:opacity-50"),children:v?e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"size-4 animate-spin"}),t("common:confirming")]}):e.jsxs(e.Fragment,{children:[e.jsx(pn,{className:"size-4"}),t("transaction:destroyPage.confirm")]})})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const kl=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(Sv,{})});kl.__docgenInfo={description:"",methods:[],displayName:"MiniappDestroyConfirmJob"};function Av(t,s){const n=s.startsWith("0x"),a=n?s.toLowerCase():s;for(const r of Ce.state.wallets)if(r.chainAddresses.find(c=>c.chain!==t?!1:n||c.address.startsWith("0x")?c.address.toLowerCase()===a:c.address===a))return r.id;return null}function Iv(){const{t}=B("common"),{pop:s,push:n}=Y(),a=de(),{appName:r,appIcon:o,from:c,chain:i,unsignedTx:l}=a,[m,u]=d.useState(!1),f=d.useMemo(()=>{try{return Dt.parse(l)}catch{return null}},[l]),h=d.useMemo(()=>Av(i,c),[i,c]),y=Ce.state.wallets.find(j=>j.id===h)?.name||t("unknownWallet"),p=d.useCallback(()=>{m||f&&h&&(Nt(async j=>{u(!0);try{const N=await Gu({walletId:h,password:j,from:c,chainId:i,unsignedTx:f}),b=new CustomEvent("miniapp-sign-transaction-confirm",{detail:{confirmed:!0,signedTx:N}});return window.dispatchEvent(b),s(),!0}catch(N){throw console.error("[miniapp-sign-transaction]",N),N instanceof Error?N:new Error("Sign transaction failed")}finally{u(!1)}}),n("WalletLockConfirmJob",{title:t("signTransaction")}))},[i,c,m,s,n,t,f,h]),x=d.useCallback(()=>{const j=new CustomEvent("miniapp-sign-transaction-confirm",{detail:{confirmed:!1}});window.dispatchEvent(j),s()},[s]),g=d.useMemo(()=>{if(!f)return"";try{return JSON.stringify(f.data,null,2)}catch{return String(f.data)}},[f]);return e.jsx(ce,{onCancel:x,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Ht,{title:t("signTransaction"),description:r||t("unknownDApp"),appName:r,appIcon:o,walletInfo:{name:y,address:c,chainId:i}}),e.jsxs("div",{className:"space-y-4 p-4",children:[!f&&e.jsx("div",{className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:t("invalidTransaction")}),f&&!h&&e.jsx("div",{className:"rounded-xl bg-amber-50 p-3 text-sm text-amber-800 dark:bg-amber-950/30 dark:text-amber-200",children:t("signingAddressNotFound")}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("network")}),e.jsx(Ea,{chainId:i})]}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("signingAddress")}),e.jsx(Sa,{chainId:i,address:c,copyable:!1,size:"sm"})]}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("transaction")}),e.jsx("div",{className:"max-h-44 overflow-y-auto",children:e.jsx("pre",{className:"font-mono text-xs break-all whitespace-pre-wrap",children:g})})]}),e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[e.jsx(_e,{className:"mt-0.5 size-5 shrink-0 text-amber-600"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:t("signTxWarning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:x,disabled:m,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("cancel")}),e.jsx("button",{onClick:p,disabled:m||!f||!h,className:R("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","flex items-center justify-center gap-2 disabled:opacity-50"),children:m?e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"size-4 animate-spin"}),t("signing")]}):t("sign")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Sl=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(Iv,{})});Sl.__docgenInfo={description:"",methods:[],displayName:"MiniappSignTransactionJob"};function Ai(t){const s=Bn(t);if(s)return As.getName(s);try{return`Chain ${Im(t)}`}catch{return t}}function Ii(t){return Bn(t)}function Tv(){const{t}=B("common"),{pop:s}=Y(),{fromChainId:n,toChainId:a,appName:r,appIcon:o}=de(),c=Ai(n),i=Ai(a),l=Ii(n),m=Ii(a),u=()=>{const h=new CustomEvent("chain-switch-confirm",{detail:{approved:!0,toChainId:a}});window.dispatchEvent(h),s()},f=()=>{const h=new CustomEvent("chain-switch-confirm",{detail:{approved:!1}});window.dispatchEvent(h),s()};return e.jsx(ce,{onCancel:f,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Ht,{title:t("switchNetwork"),description:`${r||t("unknownDApp")} ${t("requestsNetworkSwitch")}`,appName:r,appIcon:o}),e.jsxs("div",{className:"flex items-center justify-center gap-4 px-6 py-8",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[l?e.jsx(xt,{chain:l,size:"lg"}):e.jsx("div",{className:"bg-muted flex size-12 items-center justify-center rounded-full",children:e.jsx(_e,{className:"text-muted-foreground size-6"})}),e.jsx("span",{className:"text-muted-foreground text-sm",children:c})]}),e.jsx(bo,{className:"text-primary size-8"}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[m?e.jsx(xt,{chain:m,size:"lg"}):e.jsx("div",{className:"bg-muted flex size-12 items-center justify-center rounded-full",children:e.jsx(_e,{className:"text-muted-foreground size-6"})}),e.jsx("span",{className:"font-medium",children:i})]})]}),e.jsx("div",{className:"bg-warning/10 border-warning/20 mx-4 mb-4 rounded-lg border p-3",children:e.jsx("p",{className:"text-warning text-sm",children:t("chainSwitchWarning")})}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:f,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("cancel")}),e.jsx("button",{onClick:u,className:"bg-primary hover:bg-primary/90 text-primary-foreground flex-1 rounded-xl py-3 font-medium transition-colors",children:t("confirm")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Al=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(Tv,{})});Al.__docgenInfo={description:"",methods:[],displayName:"ChainSwitchConfirmJob"};function Pv(){const{t}=B("common"),{pop:s}=Y(),n=de(),a=Dt.parse(n.actions),r=n.duration,{address:o,chainId:c,appName:i,appIcon:l}=n,m=Ce.state.wallets.find(w=>w.chainAddresses.some(I=>I.address===o)),u=m?.name,f=m?.id,[h,v]=d.useState([]),[y,p]=d.useState(!1),[x,g]=d.useState(!1),[j,N]=d.useState(r),b=d.useCallback(async w=>{g(!0),p(!1);try{const I=gt(w),E=await as.getAllWallets();if(E.length===0){p(!0),v([]),g(!1);return}let A=!1;for(const P of E)try{await as.getMnemonic(P.id,I),A=!0;break}catch{}if(A&&f){const P=new CustomEvent("crypto-authorize-confirm",{detail:{approved:!0,patternKey:I,walletId:f,selectedDuration:j}});window.dispatchEvent(P),s()}else p(!0),v([])}catch{p(!0),v([])}finally{g(!1)}},[s,j]),S=d.useCallback(()=>{const w=new CustomEvent("crypto-authorize-confirm",{detail:{approved:!1}});window.dispatchEvent(w),s()},[s]);return e.jsx(ce,{onCancel:S,children:e.jsxs("div",{className:"bg-background flex max-h-[85vh] flex-col rounded-t-2xl",children:[e.jsx("div",{className:"flex flex-shrink-0 justify-center py-2",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Ht,{title:t("cryptoAuthorize"),description:i||t("unknownDApp"),appName:i,appIcon:l,walletInfo:{name:u||t("unknownWallet"),address:o,chainId:c||"bfmeta"}}),e.jsx("div",{className:"min-h-0 flex-1 space-y-3 overflow-y-auto px-4 py-3",children:e.jsxs("div",{className:"bg-muted/50 space-y-2 rounded-xl p-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($s,{className:"text-primary size-4 flex-shrink-0"}),e.jsxs("span",{className:"text-muted-foreground",children:[t("permissions"),""]}),e.jsx("span",{className:"truncate font-medium",children:a.map(w=>Qu[w]?.name||w).join("")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-muted-foreground ml-6",children:[t("duration"),""]}),e.jsxs(Ts,{value:j,onValueChange:w=>N(w),children:[e.jsx(Ps,{className:"h-7 w-24 text-xs",children:e.jsx(Es,{})}),e.jsx(_s,{children:Yu.map(w=>e.jsx(Wt,{value:w,children:Xu[w]},w))})]})]})]})}),e.jsxs("div",{className:"flex-shrink-0 px-4 pb-2",children:[e.jsx("p",{className:"text-muted-foreground mb-2 text-center text-xs",children:t("drawPatternToConfirm")}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-[280px]",children:e.jsx(Ut,{value:h,onChange:v,onComplete:b,error:y,disabled:x})})}),e.jsx("div",{className:"flex h-6 items-center justify-center",children:x&&e.jsxs("div",{className:"text-muted-foreground flex items-center gap-2",children:[e.jsx(ke,{className:"size-4 animate-spin"}),e.jsx("span",{className:"text-xs",children:t("verifying")})]})})]}),e.jsx("div",{className:"flex-shrink-0 px-4 pb-2",children:e.jsx("button",{onClick:S,disabled:x,className:"bg-muted hover:bg-muted/80 w-full rounded-xl py-2.5 text-sm font-medium transition-colors disabled:opacity-50",children:t("cancel")})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)] flex-shrink-0"})]})})}const Il=({params:t})=>e.jsx(oe,{params:t,children:e.jsx(Pv,{})});Il.__docgenInfo={description:"",methods:[],displayName:"CryptoAuthorizeJob"};const Ev={"zh-CN":"","zh-TW":"",en:"English",ja:"",ko:"",ar:""},_v={USD:"USD ($)",CNY:"CNY ()",EUR:"EUR ()",JPY:"JPY ()",KRW:"KRW ()"};function dr(){const{navigate:t}=re(),{push:s}=Y(),{t:n}=B(["settings","common","security","error"]),a=Ae(),r=wa(),o=Ft(),c=$i(),i=Fi(),l=at(),m=zg(),[u,f]=d.useState(!1),[h,v]=d.useState("loading");d.useEffect(()=>{async function N(){if(!a){v("unavailable");return}const b=a.chainAddresses.find(S=>S.chain==="bfmeta"||S.chain==="bfm");if(!b){v("unavailable");return}try{const S=Je.getChainById(mr.state,"bfmeta");if(!S){v("unavailable");return}const w=await Fg(S,b.address);v(w?"set":"not_set")}catch{v("unavailable")}}N()},[a]);const y=()=>n(`settings:appearance.${i}`),p=()=>{switch(m.status){case"checking":return n("settings:update.checking");case"update-available":return n("settings:update.available");case"up-to-date":return n("settings:update.upToDate");case"error":return n("settings:update.failed");case"not-dweb":return n("settings:update.dwebRequired");default:return n("settings:update.notChecked")}},x=async()=>{const N=await Lg.check("manual");if(N.status==="not-dweb"){l.show(n("error:crypto.dwebEnvironmentRequired"));return}if(N.status==="error"){l.show(n("settings:update.failed"));return}N.status==="up-to-date"&&l.show(n("settings:update.upToDate"))},g=()=>{switch(h){case"loading":return"...";case"set":return n("security:twoStepSecret.alreadySet");case"not_set":return n("security:twoStepSecret.notSet");default:return n("settings:notSupported")}},j=async()=>{if(h!=="not_set"||!a)return;const N=a.chainAddresses.find(w=>w.chain==="bfmeta"||w.chain==="bfm");if(!N)return;const b=Je.getChainById(mr.state,"bfmeta");if(!b)return;const S=await Wg(b);Xg(async(w,I)=>{const E=await Og({chainConfig:b,walletId:a.id,password:I,fromAddress:N.address,newTwoStepSecret:w});return E.status==="ok"?(v("set"),{success:!0,txHash:E.txHash}):E.status==="password"?{success:!1,error:n("security:passwordConfirm.verifying")}:E.status==="already_set"?(v("set"),{success:!1,error:n("security:twoStepSecret.alreadySet")}):{success:!1,error:E.message}},S??void 0,async()=>{const{getChainProvider:w}=await ht(async()=>{const{getChainProvider:E}=await import("./index-CkyK164j.js").then(A=>A.x);return{getChainProvider:E}},__vite__mapDeps([2,3,1,4,5,6,7,8,9,10]),import.meta.url),I=w(b.id);if(!I.bioGetAccountInfo)return!1;try{return!!(await I.bioGetAccountInfo(N.address)).secondPublicKey}catch{return!1}}),s("SetTwoStepSecretJob",{chainName:"BioForest Chain"})};return e.jsxs("div",{className:"bg-muted/30 flex h-full flex-col overflow-y-auto",children:[e.jsx(V,{title:n("common:a11y.tabSettings")}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("button",{type:"button",onClick:()=>t({to:"/my-card"}),className:"bg-card hover:bg-accent flex w-full items-center gap-4 rounded-xl p-4 shadow-sm transition-colors","data-testid":"my-card-button",children:[e.jsx(ds,{src:r.avatar,size:56}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("h2",{className:"font-semibold",children:r.username||n("common:myCard.defaultName")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:n("settings:items.myCard")})]}),e.jsx(wf,{size:20,className:"text-muted-foreground"})]}),e.jsxs(vs,{title:n("settings:sections.walletManagement"),children:[e.jsx(Ne,{icon:e.jsx(Ra,{size:20}),label:n("settings:items.walletManagement"),onClick:()=>t({to:`/wallet/${a?.id??""}`})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(ko,{size:20}),label:n("settings:items.walletChains"),onClick:()=>t({to:"/settings/wallet-chains"}),testId:"wallet-chains-button"}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(Gm,{size:20}),label:n("settings:items.addressBook"),onClick:()=>t({to:"/address-book"}),testId:"address-book-button"})]}),e.jsxs(vs,{title:n("settings:sections.security"),children:[e.jsx(Ne,{icon:e.jsx($s,{size:20}),label:n("settings:items.appLock"),value:n("settings:notSupported"),disabled:!0}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(za,{size:20}),label:n("settings:items.viewMnemonic"),onClick:()=>t({to:"/settings/mnemonic"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(Oa,{size:20}),label:n("settings:items.changeWalletLock"),onClick:()=>t({to:"/settings/wallet-lock"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(Bu,{size:20}),label:n("security:twoStepSecret.setup"),value:g(),onClick:j,disabled:h==="set"||h==="unavailable",testId:"set-pay-password-button"})]}),e.jsxs(vs,{title:n("settings:sections.preferences"),children:[e.jsx(Ne,{icon:e.jsx(kf,{size:20}),label:n("settings:items.language"),value:Ev[o],onClick:()=>t({to:"/settings/language"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(lf,{size:20}),label:n("settings:items.currency"),value:_v[c],onClick:()=>t({to:"/settings/currency"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(_f,{size:20}),label:n("settings:items.appearance"),value:y(),onClick:()=>f(!0)}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(Pf,{size:20}),label:n("settings:items.chainConfig"),onClick:()=>t({to:"/settings/chains"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(Ao,{size:20}),label:n("settings:items.miniappSources"),onClick:()=>t({to:"/settings/sources"})})]}),e.jsxs(vs,{title:n("settings:sections.about"),allowContextMenu:!0,children:[e.jsx(Ne,{icon:e.jsx(nm,{size:20}),label:n("settings:items.aboutApp"),value:"v0.6.3",onClick:()=>{}}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(Vt,{size:20}),label:n("settings:update.check"),value:p(),onClick:x}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Ne,{icon:e.jsx(wo,{size:20}),label:n("settings:items.storage"),onClick:()=>t({to:"/settings/storage"}),testId:"storage-button"})]}),e.jsx("div",{className:"h-[var(--tab-bar-height)]"})]}),e.jsx(Kc,{open:u,onOpenChange:f})]})}dr.__docgenInfo={description:"",methods:[],displayName:"SettingsPage"};function Tl(){return e.jsx(dr,{})}Tl.__docgenInfo={description:`SettingsTab - 

 SettingsPage `,methods:[],displayName:"SettingsTab"};function Mv(t,s){let n=t.toString();const a=n.startsWith("-");a&&(n=n.slice(1)),n=n.padStart(s,"0");let[r,o]=[n.slice(0,n.length-s),n.slice(n.length-s)];return o=o.replace(/(0+)$/,""),`${a?"-":""}${r||"0"}${o?`.${o}`:""}`}const Pl=({params:t})=>{const{push:s}=Y(),[n,a]=d.useState(t.tab||"wallet");return d.useEffect(()=>(Zu(),hr().setPermissionRequestCallback(async(r,o,c)=>{const i=em.state.apps.get(r)?.manifest.icon;return new Promise(l=>{const m=window.setTimeout(()=>l(!1),3e4),u=f=>{window.clearTimeout(m);const h=f.detail;l(h?.approved===!0)};window.addEventListener("permission-request",u,{once:!0}),s("PermissionRequestJob",{appName:o,appIcon:i,permissions:JSON.stringify(c)})})}),xr(async r=>{const o=r?.app?.name,c=r?.app?.icon;return new Promise(i=>{const l=window.setTimeout(()=>i(null),3e4),m=()=>{window.clearTimeout(l),window.removeEventListener("wallet-picker-select",u),window.removeEventListener("wallet-picker-cancel",f)},u=h=>{m();const v=h.detail;i({address:v.address,chain:v.chain,name:v.name})},f=()=>{m(),i(null)};window.addEventListener("wallet-picker-select",u),window.addEventListener("wallet-picker-cancel",f),s("WalletPickerJob",{chain:r?.chain,exclude:r?.exclude,...o?{appName:o}:{},...c?{appIcon:c}:{}})})}),gr(()=>{const r=Ce.state,o=Bs.getCurrentWallet(r);return o?o.chainAddresses.map(c=>({address:c.address,chain:c.chain,name:o.name})):[]}),vr(async r=>{const o=Ce.state.wallets.flatMap(c=>c.chainAddresses).find(c=>c.address===r.address)?.chain;return new Promise(c=>{const i=window.setTimeout(()=>c(null),6e4),l=m=>{window.clearTimeout(i);const u=m.detail;if(u?.confirmed&&u.signature&&u.publicKey){c({signature:u.signature,publicKey:u.publicKey});return}c(null)};window.addEventListener("signing-confirm",l,{once:!0}),s("SigningConfirmJob",{message:r.message,address:r.address,appName:r.app.name,appIcon:r.app.icon??"",chainName:o??"bioforest"})})}),yr(async r=>new Promise(o=>{const c=window.setTimeout(()=>o(null),6e4),i=l=>{window.clearTimeout(c);const m=l.detail;if(m?.confirmed&&m.txHash){o({txHash:m.txHash});return}o(null)};window.addEventListener("miniapp-transfer-confirm",i,{once:!0}),s("MiniappTransferConfirmJob",{appName:r.app.name,appIcon:r.app.icon??"",from:r.from,to:r.to,amount:r.amount,chain:r.chain,...r.asset?{asset:r.asset}:{}})})),br(async r=>new Promise(o=>{const c=window.setTimeout(()=>o(null),6e4),i=l=>{window.clearTimeout(c);const m=l.detail;if(m?.confirmed&&m.signedTx){o(m.signedTx);return}o(null)};window.addEventListener("miniapp-sign-transaction-confirm",i,{once:!0}),s("MiniappSignTransactionJob",{appName:r.app.name,appIcon:r.app.icon??"",from:r.from,chain:r.chain,unsignedTx:Dt.stringify(r.unsignedTx)})})),jr(async r=>{const o=r.app?.name,c=r.app?.icon;return new Promise(i=>{const l=window.setTimeout(()=>i(null),3e4),m=()=>{window.clearTimeout(l),window.removeEventListener("wallet-picker-select",u),window.removeEventListener("wallet-picker-cancel",f)},u=h=>{m();const v=h.detail;i({address:v.address,chain:v.chain,name:v.name})},f=()=>{m(),i(null)};window.addEventListener("wallet-picker-select",u),window.addEventListener("wallet-picker-cancel",f),s("WalletPickerJob",{chain:r.chainId,...o?{appName:o}:{},...c?{appIcon:c}:{}})})}),kr(async r=>new Promise(o=>{const c=window.setTimeout(()=>o(!1),3e4),i=l=>{window.clearTimeout(c);const m=l.detail;o(m?.approved===!0)};window.addEventListener("chain-switch-confirm",i,{once:!0}),s("ChainSwitchConfirmJob",{fromChainId:r.fromChainId,toChainId:r.toChainId,appName:r.appName,appIcon:r.appIcon})})),Nr(async r=>new Promise(o=>{const c=window.setTimeout(()=>o(null),6e4),i=l=>{window.clearTimeout(c);const m=l.detail;if(m?.confirmed&&m.signature){o({signature:m.signature});return}o(null)};window.addEventListener("signing-confirm",i,{once:!0}),s("SigningConfirmJob",{message:r.message,address:r.address,appName:r.appName,chainName:"ethereum"})})),wr(async r=>{const{from:o,to:c,value:i,chainId:l}=r.tx;if(!o||!c)return null;const m=BigInt(i??"0x0"),u=Mv(m,18),f=l?Bn(l):null;return new Promise(h=>{const v=window.setTimeout(()=>h(null),6e4),y=p=>{window.clearTimeout(v);const x=p.detail;if(x?.confirmed&&x.txHash){h({txHash:x.txHash});return}h(null)};window.addEventListener("miniapp-transfer-confirm",y,{once:!0}),s("MiniappTransferConfirmJob",{appName:r.appName,from:o,to:c,amount:u,chain:f??"ethereum"})})}),Cr(async r=>{const o=r?.app?.name,c=r?.app?.icon;return new Promise(i=>{const l=window.setTimeout(()=>i(null),3e4),m=()=>{window.clearTimeout(l),window.removeEventListener("wallet-picker-select",u),window.removeEventListener("wallet-picker-cancel",f)},u=h=>{m();const v=h.detail;i({address:v.address,chain:v.chain,name:v.name})},f=()=>{m(),i(null)};window.addEventListener("wallet-picker-select",u),window.addEventListener("wallet-picker-cancel",f),s("WalletPickerJob",{chain:"tron",...o?{appName:o}:{},...c?{appIcon:c}:{}})})}),Sr(r=>async o=>new Promise(c=>{const i=window.setTimeout(()=>c({approved:!1}),6e4),l=m=>{window.clearTimeout(i);const u=m.detail;if(u?.approved&&u.patternKey&&u.walletId){c({approved:!0,patternKey:u.patternKey,walletId:u.walletId,selectedDuration:u.selectedDuration});return}c({approved:!1})};window.addEventListener("crypto-authorize-confirm",l,{once:!0}),s("CryptoAuthorizeJob",{actions:Dt.stringify(o.actions),duration:o.duration,address:o.address,chainId:o.chainId,appName:o.app.name,appIcon:o.app.icon})})),()=>{hr().setPermissionRequestCallback(null),xr(null),jr(null),kr(null),Nr(null),wr(null),Cr(null),Sr(null),gr(null),vr(null),yr(null),br(null)}),[s]),e.jsx(ae,{children:e.jsx(Au,{children:e.jsxs("div",{className:"bg-background relative h-dvh",children:[e.jsx(d.Activity,{mode:n==="wallet"?"visible":"hidden",children:e.jsx(Wc,{})}),e.jsx("div",{style:{display:n==="ecosystem"?"contents":"none"},children:e.jsx(Jc,{})}),e.jsx(d.Activity,{mode:n==="settings"?"visible":"hidden",children:e.jsx(Tl,{})}),e.jsx(bu,{activeTab:n,onTabChange:a})]})})})};Pl.__docgenInfo={description:"",methods:[],displayName:"MainTabsActivity"};function El(){const{t}=B("wallet"),{navigate:s,goBack:n}=re(),{push:a}=Y(),r=we(Ce,u=>u.wallets),o=we(Ce,u=>u.currentWalletId),c=d.useCallback(u=>{fe.setCurrentWallet(u)},[]),i=d.useCallback(u=>{s({to:`/wallet/${u}`})},[s]),l=d.useCallback(()=>{a("WalletAddJob",{})},[a]),m=d.useCallback(()=>{n()},[n]);return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(V,{title:t("list.title"),onBack:m,rightAction:e.jsx("button",{onClick:l,className:R("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":t("add"),children:e.jsx(nt,{className:"size-5"})})}),e.jsx("div",{className:"flex-1 p-4",children:r.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[e.jsx("p",{className:"text-muted-foreground",children:t("list.empty")}),e.jsx("button",{onClick:l,className:R("bg-primary rounded-full px-6 py-2.5 text-sm font-medium text-primary-foreground","hover:bg-primary/90 active:bg-primary/80"),children:t("add")})]}):e.jsx("div",{className:"space-y-3",children:r.map(u=>e.jsx(Rv,{wallet:u,isActive:u.id===o,onSelect:()=>c(u.id),onDetail:()=>i(u.id),t},u.id))})})]})}function Rv({wallet:t,isActive:s,onSelect:n,onDetail:a,t:r}){return e.jsxs("div",{className:R("bg-card rounded-xl p-4 shadow-sm transition-colors",s&&"ring-primary ring-2"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:n,className:R("flex size-12 items-center justify-center rounded-full text-lg font-semibold",s?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),children:t.name.slice(0,1)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"truncate font-semibold",children:t.name}),s&&e.jsxs("span",{className:"text-primary flex items-center gap-1 text-xs",children:[e.jsx(he,{className:"size-3"}),r("list.current")]})]}),e.jsx("p",{className:"text-muted-foreground text-sm",children:r("list.chainAddresses",{count:t.chainAddresses.length})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-semibold",children:["$",0 .toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})}),e.jsx("button",{onClick:a,className:R("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":r("list.viewDetail"),children:e.jsx(Te,{className:"text-muted-foreground size-5"})})]})]}),e.jsx("p",{className:"text-muted-foreground mt-2 truncate font-mono text-xs",children:t.address})]})}El.__docgenInfo={description:"",methods:[],displayName:"WalletListPage"};const _l=()=>e.jsx(ae,{children:e.jsx(El,{})});_l.__docgenInfo={description:"",methods:[],displayName:"WalletListActivity"};function Lv(){const{t}=B("wallet"),{walletId:s,mode:n="default"}=de(),{goBack:a,navigate:r}=re(),c=yt().find(m=>m.id===s),i=()=>{r({to:"/",replace:!0})};if(!c)return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(V,{title:t("detail.title"),onBack:a}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(zt,{variant:"error",children:t("detail.notFound")})})]});const l=t(n==="edit-only"?"detail.editTitle":"detail.title");return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(V,{title:l,...n!=="edit-only"&&{onBack:a}}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsx(Fn,{mode:n,walletId:s,onEditOnlyComplete:i}),n==="default"&&e.jsx("div",{className:"mt-6",children:e.jsx(zt,{variant:"warning",children:t("detail.securityWarning")})})]})]})}const Ml=({params:t})=>e.jsx(ae,{children:e.jsx(oe,{params:t,children:e.jsx(Lv,{})})});Ml.__docgenInfo={description:"",methods:[],displayName:"WalletConfigActivity"};const zv=["pattern","mnemonic","verify","chains","theme"];function Rl(){const{goBack:t,navigate:s}=re(),{t:n}=B("onboarding"),a=Os(),r=Ft(),[o,c]=d.useState("pattern"),[i,l]=d.useState(""),[m]=d.useState(()=>{if(typeof window<"u"){const C=window.__E2E_MNEMONIC__;if(typeof C=="string"&&C.trim())return C.trim().split(/\s+/);if(Array.isArray(C)&&C.every(_=>typeof _=="string"))return C}return ju()}),[u,f]=d.useState(!0),[h,v]=d.useState(!1),[y,p]=d.useState([]),[x,g]=d.useState(!1),[j,N]=d.useState(!1),[b,S]=d.useState(null),w=zv.indexOf(o)+1;d.useEffect(()=>{!x&&a.length>0&&(p(uo(a)),g(!0))},[a,x]);const I=()=>{o==="mnemonic"?(c("pattern"),l("")):o==="verify"?c("mnemonic"):o==="chains"?c("verify"):o==="theme"||t()},E=C=>{l(C),c("mnemonic")},A=()=>{(h||!u)&&c("verify")},P=()=>{c("chains")},k=async()=>{if(!j){N(!0);try{const C=m.join(" "),z=(await mo({mnemonic:C,selectedChainIds:y,chainConfigs:a})).map(({chainId:M,address:O,publicKey:Q})=>({chain:M,address:O,publicKey:Q??"",tokens:[]})),D=z[0];if(!D)throw new Error("No chain addresses derived");const L=ia(D.address),J=await fe.createWallet({name:n("create.generatedNamePattern",{word:gn(r),suffix:n("create.walletSuffix")}),keyType:"mnemonic",address:D.address,chain:D.chain,chainAddresses:z,themeHue:L},C,i,L);S(J.id),c("theme")}catch{}finally{N(!1)}}},T=()=>{s({to:"/",replace:!0})};return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(V,{title:n("create.title"),onBack:I}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(ct,{total:5,current:w})}),e.jsxs("div",{className:"flex-1 p-4",children:[o==="pattern"&&e.jsx("div",{"data-testid":"pattern-step",children:e.jsx(Da,{onComplete:E,minPoints:4})}),o==="mnemonic"&&e.jsx("div",{"data-testid":"mnemonic-step",children:e.jsx(Dv,{mnemonic:m,hidden:u,copied:h,onToggleHidden:()=>f(!u),onCopy:()=>v(!0),onContinue:A})}),o==="verify"&&e.jsx("div",{"data-testid":"verify-step",children:e.jsx(Bv,{mnemonic:m,onContinue:P})}),o==="chains"&&e.jsx("div",{"data-testid":"chain-selector-step",children:e.jsx(Ov,{chains:a,selectedChains:y,selectionCount:y.length,onSelectionChange:p,onComplete:k,completeLabel:n("create.nextStep"),isSubmitting:j})}),o==="theme"&&b&&e.jsx("div",{"data-testid":"theme-step",children:e.jsx(Fn,{mode:"edit-only",walletId:b,onEditOnlyComplete:T})})]})]})}function Dv({mnemonic:t,hidden:s,copied:n,onToggleHidden:a,onCopy:r,onContinue:o}){const{t:c}=B("onboarding"),i=n||!s;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Fs,{icon:e.jsx(Oa,{className:"size-full"}),variant:"warning",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:c("create.backupMnemonic")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:c("create.backupHint")})]}),e.jsx(zt,{variant:"warning",children:c("create.mnemonicWarning")}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:c("create.mnemonicTitle")}),e.jsxs("button",{type:"button","data-testid":"toggle-mnemonic-button",onClick:a,className:"text-primary flex items-center gap-1 text-sm",children:[s?e.jsx(za,{className:"size-4"}):e.jsx(fo,{className:"size-4"}),c(s?"create.mnemonicShow":"create.mnemonicHide")]})]}),e.jsx(lo,{words:t,hidden:s,onCopy:r})]}),e.jsxs(ze,{variant:"mint",className:"w-full","data-testid":"mnemonic-backed-up-button",disabled:!i,onClick:o,children:[c(i?"create.mnemonicBackedUp":"create.mnemonicViewFirst"),i&&e.jsx(Te,{className:"ml-2 size-4"})]})]})}function Bv({mnemonic:t,onContinue:s}){const{t:n}=B(["onboarding","common"]),[a]=d.useState(()=>Array.from({length:t.length},(f,h)=>h).toSorted(()=>Math.random()-.5).slice(0,3).toSorted((f,h)=>f-h)),[r,o]=d.useState({}),c=a.every(m=>{const u=t[m],f=r[m];return u&&f&&f.toLowerCase()===u.toLowerCase()}),i=(m,u)=>{o(f=>({...f,[m]:u}))},l=m=>{const u=t[m],f=r[m];if(f&&u&&f.toLowerCase()!==u.toLowerCase())return n("create.wordIncorrect")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Fs,{icon:e.jsx(us,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:n("create.verifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("create.verifyDesc")})]}),e.jsx("div",{className:"space-y-4",children:a.map(m=>e.jsx(Vu,{label:n("create.wordN",{n:m+1}),error:l(m),children:e.jsx(De,{"data-testid":`verify-word-input-${m}`,"data-verify-index":m,value:r[m]||"",onChange:u=>i(m,u.target.value),className:R(l(m)&&"border-destructive focus-visible:ring-destructive"),placeholder:n("create.wordNPlaceholder",{n:m+1}),autoCapitalize:"off",autoCorrect:"off"})},m))}),e.jsx(ze,{variant:"mint",className:"w-full","data-testid":"verify-next-button",disabled:!c,onClick:s,children:n("common:next")})]})}function Ov({chains:t,selectedChains:s,selectionCount:n,isSubmitting:a,completeLabel:r,onSelectionChange:o,onComplete:c}){const{t:i}=B(["onboarding","common"]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Fs,{icon:e.jsx(us,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:i("chainSelector.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:i("chainSelector.subtitle")})]}),t.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(Se,{})}):e.jsx(Ba,{"data-testid":"chain-selector",chains:t,selectedChains:s,onSelectionChange:o}),e.jsx(ze,{variant:"mint",className:"w-full","data-testid":"chain-selector-complete-button",disabled:n===0||a,onClick:c,children:r})]})}Rl.__docgenInfo={description:"",methods:[],displayName:"WalletCreatePage"};const Ll=()=>e.jsx(ae,{children:e.jsx(Rl,{})});Ll.__docgenInfo={description:"",methods:[],displayName:"WalletCreateActivity"};function Wv(t,s){return{symbol:t.symbol,name:t.name,balance:t.amount.toFormatted(),decimals:t.decimals,fiatValue:void 0,chain:s,icon:t.icon,change24h:0,contractAddress:t.contractAddress}}function zl(t,s){return t.map(n=>Wv(n,s))}const Fv={ETH:{amount:"0.002",symbol:"ETH"},USDT:{amount:"0.003",symbol:"ETH"},USDC:{amount:"0.003",symbol:"ETH"},BTC:{amount:"0.0001",symbol:"BTC"},TRX:{amount:"1",symbol:"TRX"},BFM:{amount:"0.1",symbol:"BFM"}},Ti={step:"input",asset:null,toAddress:"",amount:null,addressError:null,amountError:null,feeAmount:null,feeMinAmount:null,feeSymbol:"",feeLoading:!1,isSubmitting:!1,resultStatus:null,txHash:null,errorMessage:null},Ee=ge.t.bind(ge);async function $v(t,s){const n=Pe(t.id);if(!n.supportsFeeEstimate||!n.supportsBuildTransaction)throw new Error(`Chain ${t.id} does not support fee estimation`);const a=await n.buildTransaction({type:"transfer",from:s,to:s,amount:ne.fromRaw("1",t.decimals,t.symbol)});return{amount:(await n.estimateFee(a)).standard.amount,symbol:t.symbol}}async function qv({chainConfig:t,walletId:s,password:n,fromAddress:a,toAddress:r,amount:o}){let c;try{c=await as.getMnemonic(s,n)}catch(i){return i instanceof Rn&&i.code===Ln.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:i instanceof Error?i.message:Ee("error:transaction.unknownError")}}if(!o.isPositive())return{status:"error",message:Ee("error:validation.enterValidAmount")};try{const i=Pe(t.id);if(!i.supportsFullTransaction)return{status:"error",message:Ee("error:transaction.chainNotSupported",{chainId:t.id})};const l=Mu(c),m=await i.buildTransaction({type:"transfer",from:a,to:r,amount:o}),u=await i.signTransaction(m,{privateKey:l});return{status:"ok",txHash:await i.broadcastTransaction(u)}}catch(i){const l=i instanceof Error?i.message:String(i);return l.includes("insufficient")||l.includes("balance")?{status:"error",message:Ee("error:insufficientFunds")}:l.includes("fee")||l.includes("gas")?{status:"error",message:Ee("error:transaction.insufficientGas")}:l.includes("not yet implemented")||l.includes("not supported")?{status:"error",message:Ee("error:chain.transferNotImplemented")}:{status:"error",message:l||Ee("error:transaction.failed")}}}function Hv(t,s){const n=Pe(t.id);return n.supportsAddressValidation?!s||s.trim()===""?Ee("error:validation.enterRecipientAddress"):n.isValidAddress(s)?!s||s.trim()===""?Ee("error:validation.enterReceiverAddress"):n.isValidAddress(s)?null:Ee("error:validation.invalidAddress"):Ee("error:validation.invalidAddressFormat"):Ee("error:validation.unsupportedChainType")}const Ue=ge.t.bind(ge);function Dl(t,s){return t.trim()?s?Tm(t):qu(t):!1}function Uv(t,s,n){return t.trim()?Dl(t,s)?s&&n&&t.trim()===n.trim()?Ue("error:validation.cannotTransferToSelf"):null:Ue("error:validation.invalidAddressFormat"):Ue("error:validation.enterRecipientAddress")}function Vv(t,s){return t?s?t.isPositive()?t.gt(s.amount)?Ue("error:insufficientFunds"):null:Ue("error:validation.enterValidAmount"):null:Ue("error:validation.enterAmount")}function Jv(t){const{toAddress:s,amount:n,asset:a,isBioforestChain:r,feeAmount:o,feeLoading:c}=t;return!a||!n||c||!o?!1:s.trim()!==""&&Dl(s,r)&&n.isPositive()&&n.lte(a.amount)}function Bl(t,s,n){if(!t)return{status:"error",message:Ue("error:validation.enterValidAmount")};const a=s.amount;if(s.assetType===n.symbol){if(t.add(n).lte(a))return{status:"ok"};if(!t.eq(a))return{status:"error",message:Ue("error:insufficientFunds")};const o=a.sub(n);return o.isPositive()?{status:"ok",adjustedAmount:o}:{status:"error",message:Ue("error:insufficientFunds")}}else return t.lte(a)?{status:"ok"}:{status:"error",message:Ue("error:insufficientFunds")}}const Pi=ge.t.bind(ge);async function Kv(t){t(s=>({...s,step:"sending",isSubmitting:!0}));try{if(await new Promise(n=>setTimeout(n,2e3)),Math.random()>.2)return t(n=>({...n,step:"result",isSubmitting:!1,resultStatus:"success",txHash:`0x${Math.random().toString(16).slice(2)}${Math.random().toString(16).slice(2)}`,errorMessage:null})),{status:"ok"};throw new Error(Pi("error:transaction.transactionFailed"))}catch(s){return t(n=>({...n,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:s instanceof Error?s.message:Pi("error:transaction.unknownError")})),{status:"error"}}}const We=ge.t.bind(ge);function Gv(t={}){const{initialAsset:s,useMock:n=!0,walletId:a,fromAddress:r,chainConfig:o,getBalance:c}=t,[i,l]=d.useState({...Ti,asset:s??null}),m=d.useRef(null),u=o?.chainKind==="bioforest",f=o?.chainKind==="evm"||o?.chainKind==="tron"||o?.chainKind==="bitcoin",h=d.useCallback(P=>f&&o?Hv(o,P):Uv(P,u,r),[u,f,o,r]),v=d.useCallback((P,k)=>Vv(P,k),[]),y=d.useCallback(P=>{l(k=>({...k,toAddress:P,addressError:null}))},[]),p=d.useCallback(P=>{l(k=>({...k,amount:P,amountError:null}))},[]),x=d.useCallback(P=>{l(k=>{if(!k.feeAmount)return k;const T=ne.fromFormatted(P,k.feeAmount.decimals,k.feeAmount.symbol);return{...k,feeAmount:T}})},[]),g=d.useCallback(P=>{if(l(T=>({...T,asset:P,feeLoading:!0})),n||!u&&!f||!o||!r){setTimeout(()=>{const T=Fv[P.assetType]??{amount:"0.001",symbol:P.assetType},C=ne.fromFormatted(T.amount,P.decimals,T.symbol);l(_=>({..._,feeAmount:C,feeMinAmount:C,feeSymbol:T.symbol,feeLoading:!1}))},300);return}(async()=>{try{const T=f?await $v(o,r):await Bg(o,r);l(C=>({...C,feeAmount:T.amount,feeMinAmount:T.amount,feeSymbol:T.symbol,feeLoading:!1}))}catch(T){l(C=>({...C,feeLoading:!1,errorMessage:T instanceof Error?T.message:We("error:transaction.feeEstimateFailed")}))}})()},[o,r,u,f,n]);d.useEffect(()=>{if(!i.asset||i.feeLoading)return;const P=`${o?.id??"unknown"}:${r??""}:${i.asset.assetType}`,k=m.current!==P;k&&(m.current=P),!(!k&&i.feeAmount)&&(!k&&!i.feeAmount||g(i.asset))},[o?.id,r,g,i.asset,i.feeAmount,i.feeLoading]);const j=d.useMemo(()=>!i.asset?.assetType||!c?i.asset?.amount??null:c(i.asset.assetType)??i.asset?.amount??null,[i.asset?.assetType,i.asset?.amount,c]),N=d.useMemo(()=>!i.asset||!j?i.asset:j.decimals===i.asset.decimals?{...i.asset,amount:j}:{...i.asset,amount:j,decimals:j.decimals},[i.asset,j]),b=d.useMemo(()=>Jv({toAddress:i.toAddress,amount:i.amount,asset:N,isBioforestChain:u,feeAmount:i.feeAmount,feeLoading:i.feeLoading}),[u,i.amount,N,i.toAddress,i.feeAmount,i.feeLoading]),S=d.useCallback(()=>{const P=h(i.toAddress),k=N?v(i.amount,N):We("error:validation.selectAsset");if(P||k)return l(T=>({...T,addressError:P,amountError:k})),!1;if(N&&i.feeAmount&&i.amount){const T=Bl(i.amount,N,i.feeAmount);if(T.status==="error")return l(C=>({...C,amountError:T.message})),!1;T.adjustedAmount&&l(C=>({...C,amount:T.adjustedAmount??C.amount}))}return l(T=>({...T,step:"confirm",addressError:null,amountError:null})),!0},[i.toAddress,i.amount,N,i.feeAmount,h,v]),w=d.useCallback(()=>{l(P=>({...P,step:"input"}))},[]),I=d.useCallback(async P=>{if(n)return(await Kv(l)).status==="ok"?{status:"ok"}:{status:"error",message:We("transaction:broadcast.unknown")};if(!o)return l(_=>({..._,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:We("error:transaction.chainConfigMissing")})),{status:"error"};if(o.chainKind==="evm"||o.chainKind==="tron"||o.chainKind==="bitcoin"){if(!a||!r||!i.asset||!i.amount)return l(z=>({...z,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:We("error:transaction.walletInfoIncomplete")})),{status:"error"};l(z=>({...z,step:"sending",isSubmitting:!0,errorMessage:null}));const _=await qv({chainConfig:o,walletId:a,password:P,fromAddress:r,toAddress:i.toAddress,amount:i.amount});return _.status==="password"?(l(z=>({...z,step:"confirm",isSubmitting:!1})),{status:"password"}):_.status==="error"?(l(z=>({...z,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:_.message})),{status:"error"}):(l(z=>({...z,step:"result",isSubmitting:!1,resultStatus:"success",txHash:_.txHash,errorMessage:null})),{status:"ok",txHash:_.txHash})}if(o.chainKind!=="bioforest")return l(_=>({..._,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:We("error:transaction.unsupportedChainType",{chainType:o.chainKind})})),{status:"error"};if(!a||!r||!i.asset)return l(_=>({..._,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:We("error:wallet.incompleteInfo")})),{status:"error"};const k=h(i.toAddress),T=v(i.amount,i.asset);if(k||T)return l(_=>({..._,addressError:k,amountError:T})),{status:"error"};if(l(_=>({..._,step:"sending",isSubmitting:!0,errorMessage:null})),!i.amount)return l(_=>({..._,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:We("error:transaction.invalidAmount")})),{status:"error"};const C=await wi({chainConfig:o,walletId:a,password:P,fromAddress:r,toAddress:i.toAddress,amount:i.amount,assetType:i.asset.assetType,fee:i.feeAmount??void 0});return C.status==="password"?(l(_=>({..._,step:"confirm",isSubmitting:!1})),{status:"password"}):C.status==="password_required"?(l(_=>({..._,step:"confirm",isSubmitting:!1})),{status:"two_step_secret_required",secondPublicKey:C.secondPublicKey}):C.status==="error"?(l(_=>({..._,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:C.message})),{status:"error",message:C.message,pendingTxId:C.pendingTxId}):(l(_=>({..._,step:"result",isSubmitting:!1,resultStatus:"success",txHash:C.txHash,errorMessage:null})),{status:"ok",txHash:C.txHash,pendingTxId:C.pendingTxId})},[o,r,i.amount,i.asset,i.toAddress,n,h,v,a]),E=d.useCallback(async(P,k)=>{if(!o||!a||!r)return{status:"error"};if(l(C=>({...C,step:"sending",isSubmitting:!0,resultStatus:null,txHash:null,errorMessage:null})),!i.amount||!i.asset)return l(C=>({...C,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:We("error:transaction.invalidAmount")})),{status:"error"};const T=await wi({chainConfig:o,walletId:a,password:P,fromAddress:r,toAddress:i.toAddress,amount:i.amount,assetType:i.asset.assetType,fee:i.feeAmount??void 0,twoStepSecret:k});return T.status==="password"?(l(C=>({...C,step:"confirm",isSubmitting:!1})),{status:"password"}):T.status==="error"?(l(C=>({...C,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:T.message})),{status:"error",message:T.message,pendingTxId:T.pendingTxId}):T.status==="password_required"?(l(C=>({...C,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:We("error:transaction.securityPasswordFailed")})),{status:"error"}):(l(C=>({...C,step:"result",isSubmitting:!1,resultStatus:"success",txHash:T.txHash,errorMessage:null})),{status:"ok",txHash:T.txHash,pendingTxId:T.pendingTxId})},[o,r,i.amount,i.toAddress,a]),A=d.useCallback(()=>{l({...Ti,asset:s??null})},[s]);return{state:i,setToAddress:y,setAmount:p,setAsset:g,setFee:x,goToConfirm:S,goBack:w,submit:I,submitWithTwoStepSecret:E,reset:A,canProceed:b}}function Qv(){const{t}=B(["transaction","common","security"]),{goBack:s}=re(),{push:n}=Y(),a=at(),r=Vs(),o=d.useRef(!1),{address:c,amount:i,assetType:l,assetLocked:m}=de(),u=m==="true",f=Be(),h=Ae(),v=zn(),y=st(),p=y.snapshot?Je.getChainById(y,f):null,x=Ca(f),j=Kt().tokenBalances.useState({address:v?.address??""},{enabled:!!v?.address}),N=d.useMemo(()=>j?.data?zl(j.data,f):[],[j?.data,f]),b=d.useMemo(()=>{if(!p)return null;if(l){const X=N.find(le=>le.symbol.toUpperCase()===l.toUpperCase());return X?{assetType:X.symbol,name:X.name,amount:ne.fromFormatted(X.balance,X.decimals??p.decimals,X.symbol),decimals:X.decimals??p.decimals,logoUrl:X.icon}:null}const Z=N.find(X=>X.symbol===p.symbol)?.balance??"0";return{assetType:p.symbol,name:p.name,amount:ne.fromFormatted(Z,p.decimals,p.symbol),decimals:p.decimals}},[p,N,l]),S=d.useCallback(H=>{const Z=N.find(X=>X.symbol===H);return Z?ne.fromFormatted(Z.balance,Z.decimals??p?.decimals??8,Z.symbol):null},[N,p?.decimals]),{state:w,setToAddress:I,setAmount:E,setAsset:A,setFee:P,goToConfirm:k,submit:T,submitWithTwoStepSecret:C,canProceed:_}=Gv({initialAsset:b??void 0,useMock:!1,walletId:h?.id,fromAddress:v?.address,chainConfig:p,getBalance:S}),z=d.useMemo(()=>{if(!w.asset)return null;const H=S(w.asset.assetType);return{symbol:w.asset.assetType,name:w.asset.name??w.asset.assetType,balance:H?.toFormatted()??w.asset.amount.toFormatted(),decimals:w.asset.decimals,chain:f,icon:w.asset.logoUrl}},[w.asset,f,S]),D=d.useCallback(H=>{const Z={assetType:H.symbol,name:H.name,amount:ne.fromFormatted(H.balance,H.decimals??p?.decimals??8,H.symbol),decimals:H.decimals??p?.decimals??8,logoUrl:H.icon};A(Z)},[p?.decimals,A]),L=d.useRef(!1);d.useEffect(()=>{b&&!L.current&&!w.asset&&(A(b),L.current=!0)},[b,A,w.asset]),d.useEffect(()=>{if(c&&!w.toAddress&&I(c),i&&!w.amount&&w.asset){const H=ne.tryFromFormatted(i,w.asset.decimals,w.asset.assetType);H&&E(H)}},[c,i,w.toAddress,w.amount,w.asset,I,E]),d.useEffect(()=>{const H=Z=>{I(Z.detail.address.address)};return window.addEventListener("contact-picker-select",H),()=>window.removeEventListener("contact-picker-select",H)},[I]),d.useEffect(()=>{if(w.resultStatus==="success"&&w.toAddress){const H=Na.getContactByAddress(ks.state,w.toAddress);H&&_n.trackRecentContact(H.contact.id)}},[w.resultStatus,w.toAddress]);const J=d.useCallback(()=>{n("ContactPickerJob",{chainType:f})},[n,f]),M=d.useMemo(()=>w.asset?S(w.asset.assetType):null,[S,w.asset]),O=w.asset?.assetType??"TOKEN",Q=w.feeSymbol||p?.symbol,te=!!Q&&Q===O,W=d.useMemo(()=>{if(!w.asset||!M)return;if(!w.feeAmount)return M;const H={...w.asset,amount:M,decimals:M.decimals},Z=Bl(M,H,w.feeAmount);return Z.status==="ok"?Z.adjustedAmount??M:ne.zero(M.decimals,H.assetType)},[M,w.asset,w.feeAmount]),G=te&&(!w.feeAmount||w.feeLoading),ve=d.useCallback(()=>{Sm(({content:H,parsed:Z})=>{let X=H;Z.type==="address"||Z.type==="payment"?X=Z.address:Z.type==="contact"&&Z.addresses.length>0&&(X=Z.addresses[0].address),I(X),r.impact("success"),a.show(t("sendPage.scanSuccess"))}),n("ScannerJob",{chainType:x??f})},[n,f,x,I,r,a,t]),se=()=>{k()&&(r.impact("light"),ul(async()=>{o.current||(o.current=!0,await r.impact("medium"),fl(async(H,Z)=>{if(!Z){const le=await T(H);return le.status==="password"?{status:"wallet_lock_invalid"}:le.status==="two_step_secret_required"?{status:"two_step_secret_required"}:le.status==="ok"?(o.current=!1,{status:"ok",txHash:le.txHash,pendingTxId:le.pendingTxId}):le.status==="error"?{status:"error",message:le.message??t("transaction:broadcast.unknown"),pendingTxId:le.pendingTxId}:{status:"error",message:t("transaction:broadcast.unknown")}}const X=await C(H,Z);return X.status==="ok"?(o.current=!1,{status:"ok",txHash:X.txHash,pendingTxId:X.pendingTxId}):X.status==="password"?{status:"two_step_secret_invalid",message:t("error:transaction.securityPasswordWrong")}:X.status==="error"?{status:"error",message:X.message??t("transaction:broadcast.unknown"),pendingTxId:X.pendingTxId}:{status:"error",message:t("transaction:broadcast.unknown")}}),n("TransferWalletLockJob",{title:t("security:walletLock.verifyTitle")}))},{minFee:w.feeMinAmount?.toFormatted()??w.feeAmount?.toFormatted()??"0",onFeeChange:P}),n("TransferConfirmJob",{amount:w.amount?.toFormatted()??"0",symbol:O,toAddress:w.toAddress,feeAmount:w.feeAmount?.toFormatted()??"0",feeSymbol:w.feeSymbol,feeLoading:w.feeLoading?"true":"false"}))};return!h||!v?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(V,{title:t("sendPage.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("history.noWallet")})})]}):e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(V,{title:t("sendPage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"bg-muted/50 space-y-2 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(xt,{chain:f,size:"sm"}),e.jsx("span",{className:"text-sm font-medium",children:x})]}),v?.address&&e.jsxs("div",{className:"text-muted-foreground flex items-center justify-center gap-1 text-xs",children:[e.jsxs("span",{children:[t("sendPage.from"),":"]}),e.jsxs("span",{className:"font-mono",children:[v.address.slice(0,8),"...",v.address.slice(-6)]})]})]}),N.length>1&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("sendPage.assetLabel")}),e.jsx(ao,{selectedAsset:z,assets:N,onSelect:D,disabled:u,testId:"send-asset-selector"})]}),e.jsx(Hu,{label:t("sendPage.toAddressLabel"),value:w.toAddress,onChange:I,placeholder:t("sendPage.toAddressPlaceholder",{chain:x}),onScan:ve,onContactPicker:J,chainType:f,error:w.addressError??void 0}),e.jsx(po,{label:t("sendPage.amountLabel"),value:w.amount??void 0,onChange:E,balance:M??void 0,max:W,maxDisabled:G,symbol:O,error:w.amountError??void 0,fiatValue:w.amount?w.amount.toNumber().toFixed(2):void 0}),e.jsxs("div",{className:"text-muted-foreground flex items-center justify-between text-xs",children:[e.jsx("span",{children:t("sendPage.fee")}),e.jsx("span",{children:w.feeLoading?t("sendPage.feeEstimating"):w.feeAmount?`${w.feeAmount.toFormatted()} ${w.feeSymbol||O}`:t("sendPage.feeUnavailable")})]}),e.jsx(zt,{variant:"info",children:t("sendPage.networkWarning",{chain:x})}),e.jsx("div",{className:"pt-4",children:e.jsxs(ze,{variant:"mint",className:"w-full","data-testid":"send-continue-button",disabled:!_,onClick:se,children:[t("sendPage.continue"),e.jsx(Te,{className:"-mr-4 ml-2 size-4"})]})})]})]})}function Ol(){const{goBack:t}=re(),s=Be(),{t:n}=B(["transaction","common"]);return e.jsx(jt,{chainId:s,fallback:e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(V,{title:n("sendPage.title"),onBack:t}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Chain not supported"})})]}),children:e.jsx(Qv,{})})}Ol.__docgenInfo={description:"",methods:[],displayName:"SendPage"};const Wl=({params:t})=>e.jsx(ae,{children:e.jsx(oe,{params:t,children:e.jsx(Zi,{children:e.jsx(Ol,{})})})});Wl.__docgenInfo={description:"",methods:[],displayName:"SendActivity"};const $e=ge.t.bind(ge),Ei={step:"input",asset:null,amount:null,amountError:null,recipientAddress:null,feeAmount:null,feeMinAmount:null,feeSymbol:"",feeLoading:!1,isSubmitting:!1,resultStatus:null,txHash:null,errorMessage:null},xs={amount:"0.001",symbol:"BFM"};function Yv(t,s){if(!t||!s)return null;if(!t.isPositive())return $e("error:validation.enterValidAmount");const n=s.amount;return t.gt(n)?$e("error:validation.exceedsBalance"):null}function Xv(t={}){const{initialAsset:s,assetLocked:n=!1,useMock:a=!0,walletId:r,fromAddress:o,chainConfig:c}=t,[i,l]=d.useState({...Ei,asset:s??null}),m=c?.chainKind==="bioforest",u=d.useCallback((N,b)=>Yv(N,b),[]),f=d.useCallback(N=>{l(b=>({...b,amount:N,amountError:null}))},[]),h=d.useCallback(N=>{if(l(S=>({...S,asset:N,amount:null,amountError:null,feeLoading:!0,recipientAddress:null})),a||!m||!c||!o){setTimeout(()=>{l(S=>({...S,recipientAddress:"mock_apply_address",feeAmount:ne.fromFormatted(xs.amount,N.decimals,xs.symbol),feeMinAmount:ne.fromFormatted(xs.amount,N.decimals,xs.symbol),feeSymbol:c?.symbol??xs.symbol,feeLoading:!1}))},300);return}(async()=>{try{const S=await wl(c,N.assetType,o);if(!S){l(I=>({...I,feeLoading:!1,errorMessage:$e("error:transaction.issuerAddressNotFound")}));return}const w=await Cl(c,N.assetType,"1");l(I=>({...I,recipientAddress:S,feeAmount:w.amount,feeMinAmount:w.amount,feeSymbol:w.symbol,feeLoading:!1}))}catch(S){l(w=>({...w,feeLoading:!1,errorMessage:S instanceof Error?S.message:$e("error:transaction.feeEstimateFailed")}))}})()},[c,o,m,a]);d.useEffect(()=>{s&&!i.recipientAddress&&h(s)},[s,h,i.recipientAddress]);const v=d.useMemo(()=>!!(i.asset&&i.amount&&i.amount.isPositive()&&i.recipientAddress&&!i.feeLoading),[i.amount,i.asset,i.recipientAddress,i.feeLoading]),y=d.useCallback(()=>{const N=u(i.amount,i.asset);return N?(l(b=>({...b,amountError:N})),!1):i.recipientAddress?(l(b=>({...b,step:"confirm",amountError:null})),!0):(l(b=>({...b,errorMessage:$e("error:transaction.issuerAddressNotReady")})),!1)},[i.amount,i.asset,i.recipientAddress,u]),p=d.useCallback(()=>{l(N=>({...N,step:"input"}))},[]),x=d.useCallback(async N=>{if(a)return l(S=>({...S,step:"burning",isSubmitting:!0})),await new Promise(S=>setTimeout(S,1500)),l(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"success",txHash:`mock_burn_tx_${Date.now()}`})),{status:"ok",txHash:`mock_burn_tx_${Date.now()}`};if(!c||c.chainKind!=="bioforest")return l(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:$e("error:burn.bioforestOnly")})),{status:"error",message:$e("error:burn.bioforestOnly")};if(!r||!o||!i.asset||!i.amount||!i.recipientAddress)return l(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:$e("error:transaction.paramsIncomplete")})),{status:"error",message:$e("error:transaction.paramsIncomplete")};l(S=>({...S,step:"burning",isSubmitting:!0,errorMessage:null}));const b=await En({chainConfig:c,walletId:r,password:N,fromAddress:o,recipientAddress:i.recipientAddress,assetType:i.asset.assetType,amount:i.amount,fee:i.feeAmount??void 0});return b.status==="password"?(l(S=>({...S,step:"confirm",isSubmitting:!1})),{status:"password"}):b.status==="password_required"?(l(S=>({...S,step:"confirm",isSubmitting:!1})),{status:"two_step_secret_required",secondPublicKey:b.secondPublicKey}):b.status==="error"?(l(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:b.message})),{status:"error",message:b.message}):(l(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"success",txHash:b.txHash})),{status:"ok",txHash:b.txHash})},[c,o,i.amount,i.asset,i.feeAmount,i.recipientAddress,a,r]),g=d.useCallback(async(N,b)=>{if(!c||!r||!o||!i.asset||!i.amount||!i.recipientAddress)return{status:"error",message:$e("error:transaction.paramsIncomplete")};l(w=>({...w,step:"burning",isSubmitting:!0,errorMessage:null}));const S=await En({chainConfig:c,walletId:r,password:N,fromAddress:o,recipientAddress:i.recipientAddress,assetType:i.asset.assetType,amount:i.amount,fee:i.feeAmount??void 0,twoStepSecret:b});return S.status==="password"?(l(w=>({...w,step:"confirm",isSubmitting:!1})),{status:"password"}):S.status==="error"?(l(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:S.message})),{status:"error",message:S.message}):S.status==="password_required"?(l(w=>({...w,step:"confirm",isSubmitting:!1})),{status:"two_step_secret_required",secondPublicKey:S.secondPublicKey}):(l(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"success",txHash:S.txHash})),{status:"ok",txHash:S.txHash})},[c,o,i.amount,i.asset,i.feeAmount,i.recipientAddress,r]),j=d.useCallback(()=>{l({...Ei,asset:s??null})},[s]);return{state:i,setAmount:f,setAsset:h,goToConfirm:y,goBack:p,submit:x,submitWithTwoStepSecret:g,reset:j,canProceed:v,assetLocked:n}}function _i(t){return{assetType:t.symbol,name:t.name,amount:ne.fromFormatted(t.balance,t.decimals??8,t.symbol),decimals:t.decimals??8,logoUrl:t.icon}}function Zv(t,s){return{symbol:t.assetType,name:t.name??t.assetType,balance:t.amount.toFormatted(),decimals:t.decimals,chain:s,icon:t.logoUrl}}function ey(){const{t}=B(["transaction","common","security"]),{goBack:s}=re(),{push:n}=Y(),a=at(),r=Vs(),o=d.useRef(!1),{assetType:c,assetLocked:i}=de(),l=Be(),m=Ae(),u=zn(),f=st(),h=f.snapshot?Je.getChainById(f,l):null,v=Ca(l),p=Kt().tokenBalances.useState({address:u?.address??""},{enabled:!!u?.address}),x=d.useMemo(()=>p?.data?zl(p.data,l):[],[p?.data,l]),g=d.useMemo(()=>h?x.filter(Q=>Q.symbol.toUpperCase()!==h.symbol.toUpperCase()):[],[x,h]),j=d.useMemo(()=>{if(!c||g.length===0)return null;const Q=g.find(te=>te.symbol.toUpperCase()===c.toUpperCase());return Q?_i(Q):null},[c,g]),N=i==="true",{state:b,setAmount:S,setAsset:w,goToConfirm:I,submit:E,submitWithTwoStepSecret:A,reset:P,canProceed:k}=Xv({initialAsset:j??void 0,assetLocked:N,useMock:!1,walletId:m?.id,fromAddress:u?.address,chainConfig:h}),T=d.useCallback(Q=>{w(_i(Q))},[w]),C=d.useMemo(()=>b.asset?Zv(b.asset,l):null,[b.asset,l]),_=b.asset?.amount??null,z=b.asset?.assetType??"TOKEN",D=()=>{I()&&(r.impact("light"),ul(async()=>{o.current||(o.current=!0,await r.impact("medium"),fl(async(Q,te)=>{if(!te){const G=await E(Q);return G.status==="password"?{status:"wallet_lock_invalid"}:G.status==="two_step_secret_required"?{status:"two_step_secret_required"}:G.status==="ok"?(o.current=!1,{status:"ok",txHash:G.txHash,pendingTxId:G.pendingTxId}):G.status==="error"?{status:"error",message:G.message,pendingTxId:G.pendingTxId}:{status:"error",message:t("error:destroy.failed")}}const W=await A(Q,te);return W.status==="ok"?(o.current=!1,{status:"ok",txHash:W.txHash,pendingTxId:W.pendingTxId}):W.status==="password"?{status:"two_step_secret_invalid",message:t("error:security.passwordInvalid")}:W.status==="error"?{status:"error",message:W.message,pendingTxId:W.pendingTxId}:{status:"error",message:t("error:unknown")}}),n("TransferWalletLockJob",{title:t("security:walletLock.verifyTitle")}))},{minFee:b.feeMinAmount?.toFormatted()??b.feeAmount?.toFormatted()??"0"}),n("TransferConfirmJob",{amount:b.amount?.toFormatted()??"0",symbol:z,toAddress:b.recipientAddress??"",feeAmount:b.feeAmount?.toFormatted()??"0",feeSymbol:b.feeSymbol,feeLoading:b.feeLoading?"true":"false"}))},L=()=>{b.resultStatus==="success"&&r.impact("success"),s()},J=()=>{P()},M=d.useCallback(()=>{if(!b.txHash)return;const Q=h?.explorer?.queryTx;if(!Q){a.show(t("sendPage.explorerNotImplemented"));return}const te=Q.replace(":hash",b.txHash).replace(":signature",b.txHash);window.open(te,"_blank","noopener,noreferrer")},[b.txHash,h?.explorer?.queryTx,a,t]),O=h?.chainKind==="bioforest";return!m||!u?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(V,{title:t("destroyPage.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("history.noWallet")})})]}):O?b.step==="result"||b.step==="burning"?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(V,{title:t("destroyPage.resultTitle")}),e.jsx(_m,{status:b.step==="burning"?"pending":b.resultStatus??"pending",amount:b.amount?.toFormatted()??"0",symbol:z,toAddress:b.recipientAddress??"",txHash:b.txHash??void 0,errorMessage:b.errorMessage??void 0,onDone:L,onRetry:b.resultStatus==="failed"?J:void 0,onViewExplorer:b.resultStatus==="success"&&h?.explorer?.queryTx?M:void 0})]}):e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(V,{title:t("destroyPage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"bg-muted/50 space-y-2 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(xt,{chain:l,size:"sm"}),e.jsx("span",{className:"text-sm font-medium",children:v})]}),u?.address&&e.jsxs("div",{className:"text-muted-foreground flex items-center justify-center gap-1 text-xs",children:[e.jsxs("span",{children:[t("sendPage.from"),":"]}),e.jsxs("span",{className:"font-mono",children:[u.address.slice(0,8),"...",u.address.slice(-6)]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("destroyPage.assetLabel")}),e.jsx(ao,{selectedAsset:C,assets:g,onSelect:T,disabled:N,excludeAssets:h?[h.symbol]:[],testId:"destroy-asset-selector"}),g.length===0&&e.jsx("p",{className:"text-muted-foreground text-xs",children:t("destroyPage.noDestroyableAssets")})]}),b.asset&&e.jsx(po,{label:t("destroyPage.amountLabel"),value:b.amount??void 0,onChange:S,balance:_??void 0,symbol:z,error:b.amountError??void 0}),e.jsx(zt,{variant:"warning",children:t("destroyPage.warning")}),b.feeAmount&&e.jsx("div",{className:"bg-muted/50 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:t("sendPage.fee")}),e.jsxs("span",{className:"font-medium",children:[b.feeAmount.toFormatted()," ",b.feeSymbol]})]})}),e.jsx("div",{className:"pt-4",children:e.jsxs(ze,{variant:"mint",className:"w-full","data-testid":"destroy-confirm-button",disabled:!k,onClick:D,children:[e.jsx(pn,{className:"mr-2 -ml-4 size-4"}),t("destroyPage.confirm")]})})]})]}):e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(V,{title:t("destroyPage.title"),onBack:s}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx(pn,{className:"text-muted-foreground size-16"}),e.jsx("p",{className:"text-muted-foreground text-center",children:t("destroyPage.notSupported")})]})]})}function Fl(){const{goBack:t}=re(),s=Be(),{t:n}=B(["transaction","common"]);return e.jsx(jt,{chainId:s,fallback:e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(V,{title:n("destroyPage.title"),onBack:t}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Chain not supported"})})]}),children:e.jsx(ey,{})})}Fl.__docgenInfo={description:"",methods:[],displayName:"DestroyPage"};const $l=({params:t})=>e.jsx(ae,{children:e.jsx(oe,{params:t,children:e.jsx(Zi,{children:e.jsx(Fl,{})})})});$l.__docgenInfo={description:"",methods:[],displayName:"DestroyActivity"};function ql(){const{t}=B(["transaction","common"]),{goBack:s}=re(),n=Wa(),a=at(),r=Vs(),o=zn(),c=Be(),i=Ca(c),l=wa(),[m,u]=d.useState(!1),[f,h]=d.useState(!1),v=d.useRef(null),y=o?.address||"",p=l.username||t("common:myCard.defaultName"),x=d.useMemo(()=>y?Ma({name:p,addresses:[{address:y,label:i}],avatar:l.avatar}):"",[p,y,i,l.avatar]),g=async()=>{y&&(await n.write({text:y}),await r.impact("light"),u(!0),a.show(t("receivePage.addressCopied")),setTimeout(()=>u(!1),2e3))},j=d.useCallback(async()=>{const b=v.current;if(!(!b||f)){h(!0);try{const{snapdom:S}=await ht(async()=>{const{snapdom:w}=await import("./snapdom-CO8q8LPW.js").then(I=>I.s);return{snapdom:w}},__vite__mapDeps([0,1]),import.meta.url);await S.download(b,{type:"png",filename:`receive-${c}-${y.slice(0,8)}.png`,scale:2,quality:1}),await r.impact("success"),a.show(t("receivePage.imageSaved"))}catch{}finally{h(!1)}}},[y,c,f,r,a,t]),N=d.useCallback(async()=>{const b=v.current;if(!(!b||f)){h(!0);try{if(navigator.share){const{snapdom:S}=await ht(async()=>{const{snapdom:A}=await import("./snapdom-CO8q8LPW.js").then(P=>P.s);return{snapdom:A}},__vite__mapDeps([0,1]),import.meta.url),I=await(await S(b,{scale:2})).toBlob(),E=new File([I],`receive-${c}.png`,{type:"image/png"});await navigator.share({title:t("receivePage.shareTitle"),text:y,files:[E]}),await r.impact("success")}}catch{}finally{h(!1)}}},[y,c,f,r,t]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:t("receivePage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"text-muted-foreground flex items-center justify-center gap-2",children:[e.jsx(xt,{chain:c,size:"sm"}),e.jsx("span",{className:"text-sm",children:i})]}),e.jsx("div",{ref:v,className:"flex justify-center",children:e.jsx(La,{name:p,avatar:l.avatar,addresses:[{address:y,label:i}],qrContent:x,caption:t("common:contactCard.transferToMe")})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm font-medium",children:t("receivePage.receiveAddress")}),e.jsx("div",{className:"border-border bg-card rounded-xl border p-4",children:e.jsx(Pt,{address:y,copyable:!0})})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(q,{variant:"outline",className:"flex-1",onClick:g,children:m?e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"mr-2 size-4"}),t("receivePage.copied")]}):e.jsxs(e.Fragment,{children:[e.jsx(Ki,{className:"mr-2 size-4"}),t("receivePage.copyAddress")]})}),e.jsxs(q,{variant:"outline",className:"flex-1",onClick:j,disabled:f,children:[f?e.jsx(ke,{className:"mr-2 size-4 animate-spin"}):e.jsx(Hs,{className:"mr-2 size-4"}),t("receivePage.saveImage")]})]}),e.jsxs(ze,{variant:"mint",className:"w-full",onClick:N,disabled:f,children:[f?e.jsx(ke,{className:"mr-2 size-4 animate-spin"}):e.jsx(Of,{className:"mr-2 size-4"}),t("receivePage.share")]}),e.jsx(zt,{variant:"info",children:t("receivePage.networkWarning",{chain:i})})]})]})}ql.__docgenInfo={description:"",methods:[],displayName:"ReceivePage"};const Hl=()=>e.jsx(ae,{children:e.jsx(ql,{})});Hl.__docgenInfo={description:"",methods:[],displayName:"ReceiveActivity"};const Ul=()=>e.jsx(ae,{children:e.jsx(dr,{})});Ul.__docgenInfo={description:"",methods:[],displayName:"SettingsActivity"};const ty={"zh-CN":"","zh-TW":"",en:"English",ar:""};function Vl(){const{goBack:t}=re(),{t:s}=B("settings"),n=Ft(),a=r=>{_n.setLanguage(r),t()};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:s("languagePage.title"),onBack:t}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:Object.keys(iu).map((r,o)=>e.jsxs("div",{children:[o>0&&e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsxs("button",{onClick:()=>a(r),className:R("flex w-full items-center justify-between px-4 py-3.5","hover:bg-muted/50 active:bg-muted transition-colors",r===n&&"bg-primary/5"),children:[e.jsx("span",{className:"text-sm font-medium",children:ty[r]}),r===n&&e.jsx(he,{className:"text-primary size-5"})]})]},r))}),e.jsx("p",{className:"text-muted-foreground mt-4 px-1 text-xs",children:s("languagePage.hint")})]})]})}Vl.__docgenInfo={description:"",methods:[],displayName:"LanguagePage"};const Jl=()=>e.jsx(ae,{children:e.jsx(Vl,{})});Jl.__docgenInfo={description:"",methods:[],displayName:"SettingsLanguageActivity"};function Kl(){const{t}=B("settings"),{goBack:s}=re(),n=$i(),a=r=>{_n.setCurrency(r),s()};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:t("currency.title"),onBack:s}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:Object.keys(ur).map((r,o)=>e.jsxs("div",{children:[o>0&&e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsxs("button",{onClick:()=>a(r),className:R("flex w-full items-center justify-between px-4 py-3.5","hover:bg-muted/50 active:bg-muted transition-colors",r===n&&"bg-primary/5"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-muted-foreground text-base font-semibold",children:ur[r].symbol}),e.jsx("span",{className:"text-sm font-medium",children:t(`currency.names.${r}`)})]}),r===n&&e.jsx(he,{className:"text-primary size-5"})]})]},r))}),e.jsx("p",{className:"text-muted-foreground mt-4 px-1 text-xs",children:t("currency.hint")})]})]})}Kl.__docgenInfo={description:"",methods:[],displayName:"CurrencyPage"};const Gl=()=>e.jsx(ae,{children:e.jsx(Kl,{})});Gl.__docgenInfo={description:"",methods:[],displayName:"SettingsCurrencyActivity"};function sy(t){const{children:s,open:n,defaultOpen:a=!1,onOpenChange:r,onOpenChangeComplete:o,actionsRef:c,handle:i,triggerId:l,defaultTriggerId:m=null}=t,u=om(),f=!!u,h=Mm(()=>i?.store??new dm({open:n??a,activeTriggerId:l!==void 0?l:m,modal:!0,disablePointerDismissal:!0,nested:f,role:"alertdialog"})).current;h.useControlledProp("open",n,a),h.useControlledProp("activeTriggerId",l,m),h.useSyncedValue("nested",f),h.useContextCallback("onOpenChange",r),h.useContextCallback("onOpenChangeComplete",o);const v=h.useState("payload");cm({store:h,actionsRef:c,parentContext:u?.store.context});const y=d.useMemo(()=>({store:h}),[h]);return e.jsx(lm.Provider,{value:y,children:typeof s=="function"?s({payload:v}):s})}function Ql({...t}){return e.jsx(sy,{"data-slot":"alert-dialog",...t})}function Yl({...t}){return e.jsx(hm,{"data-slot":"alert-dialog-portal",...t})}function Xl({className:t,...s}){return e.jsx(xm,{"data-slot":"alert-dialog-overlay",className:R("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 bg-black/10 duration-100 supports-backdrop-filter:backdrop-blur-xs fixed inset-0 isolate z-50",t),...s})}function Zl({className:t,size:s="default",...n}){return e.jsxs(Yl,{children:[e.jsx(Xl,{}),e.jsx(um,{"data-slot":"alert-dialog-content","data-size":s,className:R("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 data-closed:zoom-out-95 data-open:zoom-in-95 bg-background ring-foreground/10 gap-4 rounded-xl p-4 ring-1 duration-100 data-[size=default]:max-w-xs data-[size=sm]:max-w-xs data-[size=default]:sm:max-w-sm group/alert-dialog-content fixed top-1/2 left-1/2 z-50 grid w-full -translate-x-1/2 -translate-y-1/2 outline-none",t),...n})]})}function ed({className:t,...s}){return e.jsx("div",{"data-slot":"alert-dialog-header",className:R("grid grid-rows-[auto_1fr] place-items-center gap-1.5 text-center has-data-[slot=alert-dialog-media]:grid-rows-[auto_auto_1fr] has-data-[slot=alert-dialog-media]:gap-x-4 sm:group-data-[size=default]/alert-dialog-content:place-items-start sm:group-data-[size=default]/alert-dialog-content:text-left sm:group-data-[size=default]/alert-dialog-content:has-data-[slot=alert-dialog-media]:grid-rows-[auto_1fr]",t),...s})}function td({className:t,...s}){return e.jsx("div",{"data-slot":"alert-dialog-footer",className:R("bg-muted/50 -mx-4 -mb-4 rounded-b-xl border-t p-4 flex flex-col-reverse gap-2 group-data-[size=sm]/alert-dialog-content:grid group-data-[size=sm]/alert-dialog-content:grid-cols-2 sm:flex-row sm:justify-end",t),...s})}function sd({className:t,...s}){return e.jsx(mm,{"data-slot":"alert-dialog-title",className:R("text-sm font-medium sm:group-data-[size=default]/alert-dialog-content:group-has-data-[slot=alert-dialog-media]/alert-dialog-content:col-start-2",t),...s})}function nd({className:t,...s}){return e.jsx(fm,{"data-slot":"alert-dialog-description",className:R("text-muted-foreground *:[a]:hover:text-foreground text-sm text-balance md:text-pretty *:[a]:underline *:[a]:underline-offset-3",t),...s})}function ad({className:t,...s}){return e.jsx(q,{"data-slot":"alert-dialog-action",className:R(t),...s})}function rd({className:t,variant:s="outline",size:n="default",...a}){return e.jsx(pm,{"data-slot":"alert-dialog-cancel",className:R(t),render:e.jsx(q,{variant:s,size:n}),...a})}Ql.__docgenInfo={description:"",methods:[],displayName:"AlertDialog"};ad.__docgenInfo={description:"",methods:[],displayName:"AlertDialogAction"};rd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogCancel",props:{variant:{defaultValue:{value:'"outline"',computed:!1},required:!1},size:{defaultValue:{value:'"default"',computed:!1},required:!1}}};Zl.__docgenInfo={description:"",methods:[],displayName:"AlertDialogContent",props:{size:{required:!1,tsType:{name:"union",raw:'"default" | "sm"',elements:[{name:"literal",value:'"default"'},{name:"literal",value:'"sm"'}]},description:"",defaultValue:{value:'"default"',computed:!1}}}};nd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogDescription"};td.__docgenInfo={description:"",methods:[],displayName:"AlertDialogFooter"};ed.__docgenInfo={description:"",methods:[],displayName:"AlertDialogHeader"};Xl.__docgenInfo={description:"",methods:[],displayName:"AlertDialogOverlay"};Yl.__docgenInfo={description:"",methods:[],displayName:"AlertDialogPortal"};sd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogTitle"};function Mi(t){if(typeof t!="object"||t===null||Array.isArray(t))return null;const s=t.id;return typeof s=="string"&&s.trim()!==""?s:null}function ny(t){try{const s=JSON.parse(t),n=Array.isArray(s)?s.map(Mi):[Mi(s)];return Array.from(new Set(n.filter(a=>typeof a=="string")))}catch{return[]}}function ay(t,s){switch(s){case"default":return t("chainConfig.source.default");case"subscription":return t("chainConfig.source.subscription");case"manual":return t("chainConfig.source.manual")}}function ry(t){switch(t){case"default":return"bg-muted text-muted-foreground";case"subscription":return"bg-blue-500/10 text-blue-600";case"manual":return"bg-amber-500/10 text-amber-700"}}function iy(t){const s=new Map;for(const n of t)s.set(n.id,n);return s}function id(){const{goBack:t}=re(),{t:s}=B("settings"),n=at(),a=Os(),r=mu(),o=fu(),c=pu(),i=hu(),l=d.useMemo(()=>iy(o),[o]),[m,u]=d.useState("default"),[f,h]=d.useState(""),[v,y]=d.useState(!1),[p,x]=d.useState([]),g=d.useRef(null),j=d.useRef(null),N=d.useRef(!1);d.useEffect(()=>{Gt.initialize()},[]),d.useEffect(()=>{r?.url&&u(r.url)},[r?.url]),d.useEffect(()=>{const A=N.current;if(N.current=c,!A||c)return;const P=g.current;if(P){if(g.current=null,i){n.show(i);return}n.show(s(`chainConfig.toast.${P}`)),P==="manualAdded"&&h("")}},[i,c,s,n]);const b=async()=>{g.current="subscriptionSaved",await Gt.setSubscriptionUrl(m)},S=async()=>{g.current="subscriptionRefreshed",await Gt.refreshSubscription()},w=async()=>{const A=ny(f),P=new Set(a.map(T=>T.id)),k=A.filter(T=>P.has(T));if(k.length>0){j.current=f,x(k),y(!0);return}g.current="manualAdded",await Gt.addManualConfig(f)},I=()=>{j.current=null,x([]),y(!1)},E=async()=>{const A=j.current;j.current=null,x([]),y(!1),A&&(g.current="manualAdded",await Gt.addManualConfig(A))};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:s("chainConfig.title"),onBack:t}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx(Ql,{open:v,onOpenChange:A=>{A?y(A):I()},children:e.jsxs(Zl,{children:[e.jsxs(ed,{children:[e.jsx(sd,{children:s("chainConfig.manual.duplicate.title")}),e.jsx(nd,{children:s("chainConfig.manual.duplicate.description")})]}),e.jsx("div",{className:"bg-muted/50 text-muted-foreground rounded-lg px-3 py-2 text-xs font-mono break-all",children:p.join(", ")}),e.jsxs(td,{children:[e.jsx(rd,{onClick:I,children:s("chainConfig.manual.duplicate.cancel")}),e.jsx(ad,{onClick:E,disabled:c,children:s("chainConfig.manual.duplicate.replace")})]})]})}),i&&e.jsx("div",{className:"border-destructive/20 bg-destructive/5 text-destructive rounded-xl border px-4 py-3 text-sm",children:i}),e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:e.jsxs("div",{className:"space-y-3 px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.subscription.title")}),e.jsx("div",{className:"text-muted-foreground text-xs",children:e.jsx(xo,{ns:"settings",i18nKey:"chainConfig.subscription.description",components:{code:e.jsx("code",{className:"font-mono"})}})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{type:"button",variant:"outline",size:"icon","data-testid":"refresh-subscription-button",onClick:S,disabled:c,"aria-label":s("chainConfig.subscription.refreshAriaLabel"),children:e.jsx(Vt,{className:R("size-4",c&&"animate-spin")})}),e.jsx(q,{type:"button","data-testid":"save-subscription-button",onClick:b,disabled:c,children:s("chainConfig.subscription.save")})]})]}),e.jsx(De,{"data-testid":"subscription-url-input",value:m,onChange:A=>u(A.target.value),placeholder:s("chainConfig.subscription.placeholder"),disabled:c,autoCapitalize:"off",autoCorrect:"off",spellCheck:!1}),r?.lastUpdated&&e.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.subscription.lastUpdated",{value:r.lastUpdated})})]})}),e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm","data-testid":"manual-add-section",children:e.jsxs("div",{className:"space-y-3 px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.manual.title")}),e.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.manual.description")})]}),e.jsxs(q,{type:"button",variant:"outline","data-testid":"add-chain-button",onClick:w,disabled:c||f.trim()==="",children:[e.jsx(nt,{className:"size-4"}),s("chainConfig.manual.add")]})]}),e.jsx("textarea",{"data-testid":"manual-config-textarea",value:f,onChange:A=>h(A.target.value),placeholder:s("chainConfig.manual.placeholder"),rows:5,disabled:c,className:R("bg-background w-full resize-none rounded-lg border px-3 py-3 text-sm","placeholder:text-muted-foreground","focus:ring-ring focus:ring-2 focus:ring-offset-2 focus:outline-none","disabled:cursor-not-allowed disabled:opacity-50"),autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})]})}),e.jsxs("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:[e.jsxs("div",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.list.title")}),e.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.list.description")})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{children:[a.map((A,P)=>{const k=l.get(A.id),T=k?.kind==="incompatible_major",C=ay(s,A.source);return e.jsxs("div",{"data-testid":`chain-item-${A.id}`,children:[P>0&&e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate text-sm font-medium",children:A.name}),e.jsx("span",{className:R("rounded px-2 py-0.5 text-xs",ry(A.source)),children:C})]}),e.jsxs("div",{className:"text-muted-foreground mt-1 flex flex-wrap gap-x-3 gap-y-1 text-xs",children:[e.jsx("span",{className:"font-mono",children:A.id}),e.jsxs("span",{children:["v",A.version]}),e.jsx("span",{children:A.chainKind}),e.jsx("span",{children:A.symbol})]}),k?.kind==="incompatible_major"&&e.jsxs("div",{className:"mt-2 flex items-start gap-2 rounded-lg bg-amber-500/10 px-3 py-2 text-xs text-amber-800",children:[e.jsx(_e,{className:"mt-0.5 size-4 shrink-0"}),e.jsx("div",{children:s("chainConfig.warning.incompatibleMajor",{version:k.version,supportedMajor:k.supportedMajor})})]})]}),e.jsx(so,{checked:A.enabled,onCheckedChange:_=>{Gt.setChainEnabled(A.id,_)},disabled:c||T,className:R(T&&"cursor-not-allowed opacity-60")})]})})]},A.id)}),a.length===0&&e.jsx("div",{className:"text-muted-foreground px-4 py-8 text-center text-sm",children:s("chainConfig.list.empty")})]})]}),e.jsx("div",{className:"text-muted-foreground px-1 text-xs",children:s("chainConfig.hint")})]})]})}id.__docgenInfo={description:"",methods:[],displayName:"ChainConfigPage"};const od=()=>e.jsx(ae,{children:e.jsx(id,{})});od.__docgenInfo={description:"",methods:[],displayName:"SettingsChainsActivity"};const oy=3e4;function cd(){const{t}=B("settings"),{goBack:s}=re(),{push:n}=Y(),a=Ae(),o=(a?.keyType??"mnemonic")==="arbitrary",[c,i]=d.useState(""),[l,m]=d.useState(!0),u=d.useRef(!1);d.useEffect(()=>{if(c.length>0&&!l){const v=setTimeout(()=>{m(!0)},oy);return()=>clearTimeout(v)}},[c.length,l]),d.useEffect(()=>{const v=()=>{document.hidden&&c.length>0&&m(!0)};return document.addEventListener("visibilitychange",v),()=>{document.removeEventListener("visibilitychange",v)}},[c.length]),d.useEffect(()=>{u.current||!a?.encryptedMnemonic||(u.current=!0,Nt(async v=>{try{const y=await ss(a.encryptedMnemonic,v);return i(y),m(!1),!0}catch{return!1}}),n("WalletLockConfirmJob",{title:t("viewMnemonic.verifyTitle"),description:t(o?"viewMnemonic.verifyDescKey":"viewMnemonic.verifyDescMnemonic")}))},[a,n,t,o]);const f=()=>{m(v=>!v)};if(!a)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:t(o?"viewMnemonic.titleKey":"viewMnemonic.titleMnemonic"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("viewMnemonic.noWallet")})})]});const h=o?[]:c.trim().split(/\s+/).filter(Boolean);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:t(o?"viewMnemonic.titleKey":"viewMnemonic.titleMnemonic"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"flex gap-3 rounded-xl bg-amber-500/10 p-4",children:[e.jsx(_e,{className:"size-5 shrink-0 text-amber-500"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("p",{className:"font-medium text-amber-700 dark:text-amber-400",children:t("viewMnemonic.securityTip")}),e.jsx("p",{className:"text-muted-foreground",children:t(o?"viewMnemonic.securityWarningKey":"viewMnemonic.securityWarningMnemonic")})]})]}),c.length>0&&e.jsxs("div",{className:"bg-card space-y-4 rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:o?t("viewMnemonic.charCount",{count:c.length}):t("viewMnemonic.wordCount",{count:h.length})}),e.jsx("button",{onClick:f,className:R("flex items-center gap-1.5 rounded-full px-3 py-1.5 text-xs font-medium","bg-muted hover:bg-muted/80 transition-colors"),children:l?e.jsxs(e.Fragment,{children:[e.jsx(za,{className:"size-3.5"}),t("viewMnemonic.show")]}):e.jsxs(e.Fragment,{children:[e.jsx(fo,{className:"size-3.5"}),t("viewMnemonic.hide")]})})]}),o?e.jsx("textarea",{value:c,readOnly:!0,rows:4,"data-testid":"secret-textarea",className:R("bg-background w-full resize-none rounded-lg border px-3 py-3 font-mono text-sm","focus:outline-none",l?"[-webkit-text-security:disc]":"[-webkit-text-security:none]")}):e.jsx(lo,{words:h,hidden:l}),!l&&e.jsx("p",{className:"text-muted-foreground text-center text-xs",children:t("viewMnemonic.autoHideNote")})]})]})]})}cd.__docgenInfo={description:"",methods:[],displayName:"ViewMnemonicPage"};const ld=()=>e.jsx(ae,{children:e.jsx(cd,{})});ld.__docgenInfo={description:"",methods:[],displayName:"SettingsMnemonicActivity"};function dd(){const{t}=B("settings"),{goBack:s}=re(),n=Ae(),[a,r]=d.useState("verify"),[o,c]=d.useState("pattern"),[i,l]=d.useState([]),[m,u]=d.useState(!1),[f,h]=d.useState(!1),v=d.useRef(null),[y,p]=d.useState([]),[x,g]=d.useState(!1),[j,N]=d.useState(null),[b,S]=d.useState(null),w=d.useCallback(()=>{v.current&&(clearTimeout(v.current),v.current=null),u(!1)},[]),I=d.useCallback(T=>{m&&T.length>0&&w(),l(T)},[m,w]),E=d.useCallback(async T=>{if(n?.encryptedMnemonic){h(!0),w();try{const C=gt(T);await Mt(n.encryptedMnemonic,C)?(l(T),r("setup")):(u(!0),l([]),v.current=setTimeout(()=>{u(!1)},1500))}catch{u(!0),l([]),v.current=setTimeout(()=>{u(!1)},1500)}finally{h(!1)}}},[n,w]),A=d.useCallback((T,C)=>{p(T),g(C),N(null)},[]),P=d.useCallback(async()=>{if(n?.encryptedWalletLock){h(!0),N(null);try{if(!Ji(y)){N(t("changeWalletLock.invalidMnemonic")),h(!1);return}const T=y.join(" ");await fe.verifyMnemonic(n.id,T)?(S(T),r("setup")):N(t("changeWalletLock.mnemonicVerifyFailed"))}catch{N(t("changeWalletLock.mnemonicVerifyFailed"))}finally{h(!1)}}},[n,y,t]),k=d.useCallback(async T=>{if(n)try{if(o==="mnemonic"&&b)await fe.resetWalletLockByMnemonic(n.id,b,T);else{const C=gt(i);await fe.updateWalletLock(n.id,C,T)}r("success"),setTimeout(()=>{s()},2e3)}catch{r("verify"),l([]),S(null)}},[n,o,b,i,s]);return n?a==="success"?e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:t("changeWalletLock.title")}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx("div",{className:"bg-green-500/10 flex size-16 items-center justify-center rounded-full",children:e.jsx(he,{className:"text-green-500 size-8"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:t("changeWalletLock.success")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:t("changeWalletLock.returning")})]})]})]}):a==="verify"?e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:t("changeWalletLock.title"),onBack:s}),e.jsx("div",{className:"flex-1 p-4",children:o==="pattern"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:t("changeWalletLock.verifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("changeWalletLock.verifyDesc")})]}),e.jsx(Ut,{value:i,onChange:I,onComplete:E,minPoints:4,error:m,disabled:f,"data-testid":"verify-pattern-lock"}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx("button",{type:"button",onClick:()=>c("mnemonic"),className:"text-primary hover:text-primary/80 text-sm underline","data-testid":"switch-to-mnemonic",children:t("changeWalletLock.forgotPattern")})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:t("changeWalletLock.mnemonicVerifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("changeWalletLock.mnemonicVerifyDesc")})]}),e.jsx(Rm,{wordCount:12,onChange:A}),j&&e.jsx("p",{className:"text-destructive mt-4 text-center text-sm",children:j}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx(q,{onClick:P,disabled:!x||f,className:"w-full","data-testid":"verify-mnemonic-button",children:t(f?"changeWalletLock.verifying":"changeWalletLock.verifyMnemonic")}),e.jsx("button",{type:"button",onClick:()=>{c("pattern"),p([]),N(null)},className:"text-muted-foreground hover:text-foreground w-full text-center text-sm","data-testid":"switch-to-pattern",children:t("changeWalletLock.usePattern")})]})]})})]}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:t("changeWalletLock.title"),onBack:()=>{r("verify"),l([])}}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(Da,{onComplete:k,minPoints:4})})]}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:t("changeWalletLock.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("changeWalletLock.noWallet")})})]})}dd.__docgenInfo={description:"",methods:[],displayName:"ChangeWalletLockPage"};const ud=()=>e.jsx(ae,{children:e.jsx(dd,{})});ud.__docgenInfo={description:"",methods:[],displayName:"SettingsWalletLockActivity"};function cy({targetChain:t,address:s,filter:n,setFilter:a,walletId:r,decimals:o}){const{navigate:c,goBack:i}=re(),l=Ws(),{t:m}=B(["transaction","common"]),u=Kt(),{data:f,isLoading:h,isFetching:v,error:y,refetch:p}=u.transactionHistory.useState({address:s,limit:50},{enabled:!!s}),x=va(y,m),{transactions:g,deleteTransaction:j,retryTransaction:N}=Vi(r,t,s,f),b=d.useMemo(()=>{if(!f)return[];const k=n.period;if(!k||k==="all")return f;const T=k==="7d"?7:k==="30d"?30:90,C=Date.now()-T*24*60*60*1e3;return f.filter(_=>_.timestamp>=C)},[f,n.period]),S=d.useMemo(()=>[{value:"all",label:m("history.filter.allTime")},{value:"7d",label:m("history.filter.days7")},{value:"30d",label:m("history.filter.days30")},{value:"90d",label:m("history.filter.days90")}],[m]),w=d.useMemo(()=>[{value:"all",label:m("history.filter.allChains")},...l.map(k=>({value:k.id,label:k.name}))],[m,l]),I=d.useCallback(k=>{if(!k.id)return;const T=f?.find(_=>_.hash===k.hash),C=T?Dt.stringify(T):void 0;c({to:`/transaction/${k.id}`,search:{txData:C}})},[c,f]),E=d.useCallback(k=>{a(T=>({...T,chain:k}))},[a]),A=d.useCallback(k=>{a(T=>({...T,period:k}))},[a]),P=d.useCallback(async()=>{await p?.()},[p]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:m("transaction:history.title"),onBack:i,rightAction:e.jsx("button",{onClick:P,disabled:v,className:R("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80",v&&"animate-spin"),"aria-label":m("common:a11y.refresh"),children:e.jsx(Vt,{className:"size-5"})})}),e.jsxs("div",{className:"bg-card border-b px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Co,{className:"text-muted-foreground size-4"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:m("history.filter.chainLabel")}),e.jsxs(Ts,{value:n.chain||"all",onValueChange:k=>E(k),children:[e.jsx(Ps,{size:"sm","aria-label":m("common:a11y.selectChain"),children:e.jsx(Es,{children:w.find(k=>k.value===(n.chain||"all"))?.label})}),e.jsx(_s,{children:w.map(k=>e.jsx(Wt,{value:k.value,children:k.label},k.value))})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:m("history.filter.periodLabel")}),e.jsxs(Ts,{value:n.period||"all",onValueChange:k=>A(k),children:[e.jsx(Ps,{size:"sm","aria-label":m("common:a11y.selectPeriod"),children:e.jsx(Es,{children:S.find(k=>k.value===(n.period||"all"))?.label})}),e.jsx(_s,{children:S.map(k=>e.jsx(Wt,{value:k.value,children:k.label},k.value))})]})]})]}),e.jsx("p",{className:"text-muted-foreground mt-2 text-xs",children:m("transaction:history.totalRecords",{count:b.length})})]}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[g.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-muted-foreground text-xs font-medium uppercase tracking-wider px-1",children:m("pendingTx.title")}),e.jsx("div",{className:"space-y-1",children:g.map(k=>{const T=Dc(k,o);return e.jsx(Yi,{transaction:T,onClick:()=>c({to:`/pending-tx/${k.id}`}),onRetry:k.status==="failed"?()=>N(k):void 0,onDelete:()=>j(k)},k.id)})})]}),(x.limited||!x.supported)&&!h&&e.jsx(Ju,{type:x.limited?"limited":"notSupported",feature:m("home:wallet.transactionHistory"),reason:x.reason,className:"mb-4"}),e.jsx(go,{transactions:Oc(b??[],t),loading:h,onTransactionClick:I,emptyTitle:m("transaction:history.emptyTitle"),emptyDescription:m("transaction:history.emptyDesc"),showChainIcon:!0})]})]})}function md({initialChain:t}){const{goBack:s}=re(),n=Ae(),a=Be(),{t:r}=B(["transaction","common"]),o=st(),[c,i]=d.useState({chain:t??a,period:"all"}),l=c.chain==="all"?a:c.chain,m=o.snapshot?Je.getChainById(o,l??""):void 0,f=n?.chainAddresses?.find(h=>h.chain===l)?.address??"";return n?e.jsx(jt,{chainId:l,fallback:e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:r("transaction:history.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Chain not supported"})})]}),children:e.jsx(cy,{targetChain:l,address:f,filter:c,setFilter:i,walletId:n.id,decimals:m?.decimals??8})}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:r("transaction:history.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:r("transaction:history.noWallet")})})]})}md.__docgenInfo={description:"",methods:[],displayName:"TransactionHistoryPage",props:{initialChain:{required:!1,tsType:{name:"union",raw:"ChainType | 'all' | undefined",elements:[{name:"ChainType"},{name:"literal",value:"'all'"},{name:"undefined"}]},description:""}}};const fd=()=>{const t=Zf();return e.jsx(ae,{children:e.jsx(md,{initialChain:t.chain})})};fd.__docgenInfo={description:"",methods:[],displayName:"HistoryActivity"};const ly={transfer:"send",swap:"swap",exchange:"exchange",approve:"approve",signature:"signature",stake:"stake",unstake:"unstake",mint:"mint",burn:"destroy",gift:"gift",grab:"grab",trust:"trust",signFor:"signFor",emigrate:"emigrate",immigrate:"immigrate",issueAsset:"issueAsset",increaseAsset:"increaseAsset",destroyAsset:"destroy",issueEntity:"issueEntity",destroyEntity:"destroyEntity",locationName:"locationName",dapp:"dapp",certificate:"certificate",mark:"mark",contract:"interaction",unknown:"other",revoke:"approve",claim:"receive"};function dy(t,s){const n=t.action,a=t.direction,r=n==="transfer"?a==="in"?"receive":"send":ly[n]??"other",o=t.assets[0],c=o.assetType==="nft"?"1":o.value,i=o.assetType==="nft"?0:o.decimals,l=o.assetType==="nft"?"NFT":o.symbol,m=a==="in"?t.from:t.to;return{hash:t.hash,from:t.from,to:t.to,address:m,timestamp:t.timestamp,status:t.status,type:r,direction:a,amount:ne.fromRaw(c,i,l),symbol:l,chain:s,assets:t.assets,fee:t.fee?ne.fromRaw(t.fee.value,t.fee.decimals,t.fee.symbol):void 0,contract:t.contract,blockNumber:t.blockNumber}}function Ri(t){return!t||t.assetType==="nft"?null:{value:t.value,decimals:t.decimals,symbol:t.symbol}}function uy(t){if(!t)return null;const[s,n]=t.split("--");return!s||!n?null:{chainId:s,hash:n}}function my({hash:t,chainId:s,txData:n,onBack:a}){const{t:r}=B(["transaction","common"]),o=st(),c=Kt(),i=d.useMemo(()=>n?Dt.parse(n):null,[n]),{data:l,isLoading:m,error:u}=c.transaction.useState({txHash:t},{enabled:!!t}),f=l??i,h=d.useMemo(()=>f?dy(f,s):null,[f,s]),v=d.useMemo(()=>{const D=h?.chain??s;return D?Je.getChainById(o,D):null},[o,s,h?.chain]),y=d.useMemo(()=>{const D=v?.explorer?.queryTx;return!D||!t?null:D.replace(":signature",t)},[v?.explorer?.queryTx,t]),p=d.useCallback(()=>{y&&window.open(y,"_blank","noopener,noreferrer")},[y]),[x,g]=d.useState(!1),j=d.useCallback(async()=>{y&&(await Aa.write({text:y}),g(!0),setTimeout(()=>g(!1),2e3))},[y]);if(m&&!i)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:r("detail.title"),onBack:a}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx($n,{className:"h-48"}),e.jsx($n,{className:"h-64"}),e.jsx($n,{className:"h-32"})]})]});if(u instanceof Du)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:r("detail.title"),onBack:a}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx("div",{className:"bg-card flex items-center justify-center rounded-xl p-6 shadow-sm",children:e.jsx("p",{className:"text-muted-foreground",children:r("detail.invalidData")})}),t&&e.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:r("detail.hash")}),e.jsx(pr,{text:t,className:"text-muted-foreground text-xs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:p,disabled:!y,className:R("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:[e.jsx(oa,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.openInExplorer")})]}),e.jsx("button",{onClick:j,disabled:!y,className:R("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:x?e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"text-green-500 size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.copied")})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ms,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.share")})]})})]})]})]})]});if(!h)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:r("detail.title"),onBack:a}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:r("detail.notFound")})})]});const N=h.type,b=Ou(N),S=b.Icon,w=h.type==="swap"?h.assets?.[0]:void 0,I=h.type==="swap"?h.assets?.[1]:void 0,E=Ri(w),A=Ri(I),P=h.contract?.address||h.to,k=h.contract?.method,T=h.contract?.methodId,C=k?r(`method.${k}`,{defaultValue:k}):null,_=E?ne.fromRaw(E.value,E.decimals,E.symbol):null,z=A?ne.fromRaw(A.value,A.decimals,A.symbol):null;return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:r("detail.title"),onBack:a}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"bg-card flex flex-col items-center gap-3 rounded-xl p-6 shadow-sm",children:[e.jsx("div",{className:R("flex size-16 items-center justify-center rounded-full",b.bg),children:e.jsx(S,{className:R("size-8",b.color)})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:r(`type.${h.type}`,{defaultValue:h.type})}),h.type==="swap"&&_&&z?e.jsxs("div",{className:R("flex items-center justify-center gap-2",b.color),children:[e.jsx(At,{value:_.toNumber(),symbol:_.symbol,decimals:_.decimals,sign:"never",color:"default",weight:"normal",size:"lg"}),e.jsx("span",{className:"text-lg",children:""}),e.jsx(At,{value:z.toNumber(),symbol:z.symbol,decimals:z.decimals,sign:"never",color:"default",weight:"normal",size:"lg"})]}):e.jsx(At,{value:h.type==="send"?-Math.abs(h.amount.toNumber()):h.amount.toNumber(),symbol:h.symbol,sign:b.amountSign,color:"default",weight:"normal",size:"xl",className:b.color})]}),e.jsx(Lm,{status:Wu(h.status).badgeStatus,label:r(`transaction:status.${h.status}`)})]}),e.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:r("detail.info")}),h.from&&h.to?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.fromAddress")}),e.jsx(Pt,{address:h.from,copyable:!0,className:"text-sm"})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.toAddress")}),e.jsx(Pt,{address:h.to,copyable:!0,className:"text-sm"})]})]}):e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:h.type==="send"?r("detail.toAddress"):r("detail.fromAddress")}),e.jsx(Pt,{address:h.address,copyable:!0,className:"text-sm"})]}),e.jsx("div",{className:"bg-border h-px"}),h.type==="swap"&&(E||A)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.swapFrom")}),e.jsx("span",{className:"text-sm font-medium",children:E?e.jsx(At,{value:ne.fromRaw(E.value,E.decimals,E.symbol).toNumber(),symbol:E.symbol,decimals:E.decimals,sign:"never",color:"default",size:"sm"}):"-"})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.swapTo")}),e.jsx("span",{className:"text-sm font-medium",children:A?e.jsx(At,{value:ne.fromRaw(A.value,A.decimals,A.symbol).toNumber(),symbol:A.symbol,decimals:A.decimals,sign:"never",color:"default",size:"sm"}):"-"})]}),e.jsx("div",{className:"bg-border h-px"})]}),(h.type==="approve"||h.type==="interaction"||h.type==="swap")&&P&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.contractAddress")}),e.jsx(Pt,{address:P,copyable:!0,className:"text-sm"})]}),(h.type==="approve"||h.type==="interaction")&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.method")}),e.jsx("span",{className:"text-sm font-medium font-mono",children:C||T||r("common:unknown")})]}),h.type==="approve"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.spender")}),e.jsx("span",{className:"text-sm font-medium",children:r("common:unknown")})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.allowance")}),e.jsx("span",{className:"text-sm font-medium",children:r("common:unknown")})]})]})]}),e.jsx("div",{className:"bg-border h-px"})]}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.time")}),e.jsx(Uu,{value:h.timestamp,format:"datetime",className:"text-sm"})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.network")}),e.jsx("span",{className:"text-sm font-medium capitalize",children:h.chain})]}),h.fee&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.fee")}),e.jsx(_a,{amount:h.fee?.toNumber?.()??0,symbol:h.fee?.symbol??"",className:"text-sm"})]})]}),h.blockNumber&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.blockHeight")}),e.jsx("span",{className:"text-sm font-medium",children:h.blockNumber.toLocaleString()})]})]}),h.confirmations!==void 0&&h.confirmations>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.confirmations")}),e.jsx("span",{className:"text-sm font-medium",children:h.confirmations})]})]})]}),t&&e.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:r("detail.hash")}),e.jsx(pr,{text:t,className:"text-muted-foreground text-xs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:p,disabled:!y,className:R("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:[e.jsx(oa,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.openInExplorer")})]}),e.jsx("button",{onClick:j,disabled:!y,className:R("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:x?e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"text-green-500 size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.copied")})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ms,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.share")})]})})]})]})]})]})}function pd(){const{t}=B(["transaction","common"]),{goBack:s}=re(),{txId:n,txData:a}=de(),r=Ae(),o=d.useMemo(()=>uy(n),[n]),c=d.useCallback(()=>{s()},[s]);return r?o?e.jsx(jt,{chainId:o.chainId,fallback:e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:t("detail.title"),onBack:c}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Chain not supported"})})]}),children:e.jsx(my,{hash:o.hash,chainId:o.chainId,txData:a,onBack:c})}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:t("detail.title"),onBack:c}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("detail.notFound")})})]}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:t("detail.title"),onBack:c}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("history.noWallet")})})]})}pd.__docgenInfo={description:"",methods:[],displayName:"TransactionDetailPage"};const hd=({params:t})=>e.jsx(ae,{children:e.jsx(oe,{params:t,children:e.jsx(pd,{})})});hd.__docgenInfo={description:"",methods:[],displayName:"TransactionDetailActivity"};const fy=150;function xd({onScan:t,className:s}){const{t:n}=B("scanner"),{t:a}=B("common"),{navigate:r,goBack:o}=re(),{push:c}=Y(),i=Io(),l=d.useRef(null),m=d.useRef(null),u=d.useRef(null),f=d.useRef(null),h=d.useRef(!1),v=d.useRef(null),y=d.useRef(t),[p,x]=d.useState("idle"),[g,j]=d.useState(null),[N,b]=d.useState(!1);d.useEffect(()=>{y.current=t},[t]);const S=d.useCallback(T=>{if(T===v.current)return;v.current=T,x("success"),h.current=!1,"vibrate"in navigator&&navigator.vibrate(100);const C=io(T);if(y.current)y.current(T,C);else switch(C.type){case"address":case"payment":r({to:"/send",search:{address:C.address,chain:C.chain,amount:C.type==="payment"?C.amount:void 0}});break;case"deeplink":r({to:C.path,search:C.params});break;case"contact":c("ContactAddConfirmJob",{name:C.name,addresses:JSON.stringify(C.addresses),memo:C.memo,avatar:C.avatar});break;case"unknown":r({to:"/send",search:{address:C.content}});break}},[r,c]),w=d.useCallback(()=>{if(h.current)return;h.current=!0,m.current||(m.current=document.createElement("canvas"));const T=async()=>{if(!(!h.current||!l.current||!f.current)){try{const C=await f.current.scanFromVideo(l.current,m.current??void 0);if(C){S(C.content);return}}catch{}h.current&&setTimeout(T,fy)}};T()},[S]),I=d.useCallback(()=>{h.current=!1,u.current&&(u.current.getTracks().forEach(T=>T.stop()),u.current=null)},[]),E=d.useCallback(async()=>{I(),x("requesting"),v.current=null;try{if(!await i.checkPermission()&&!await i.requestPermission()){x("denied");return}const C=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});u.current=C,l.current&&(l.current.srcObject=C,await l.current.play(),w()),x("scanning")}catch(T){x("error"),j(T instanceof Error?T.message:"Camera initialization failed")}},[i,w,I]);d.useEffect(()=>(f.current=oo({useWorker:!0}),E(),()=>{I(),f.current?.destroy(),f.current=null}),[]);const A=d.useCallback(()=>{I(),o()},[I,o]),P=d.useCallback(()=>{const T=document.createElement("input");T.type="file",T.accept="image/*",T.onchange=async C=>{const _=C.target.files?.[0];if(_)try{const z=new Image,D=URL.createObjectURL(_);z.onload=async()=>{URL.revokeObjectURL(D);const L=document.createElement("canvas");L.width=z.width,L.height=z.height;const J=L.getContext("2d");if(!J||!f.current){j(n("noQrFound")),x("error");return}J.drawImage(z,0,0);const M=await f.current.scanFromCanvas(L);M?S(M.content):(j(n("noQrFound")),x("error"))},z.onerror=()=>{URL.revokeObjectURL(D),j(n("noQrFound")),x("error")},z.src=D}catch{j(n("noQrFound")),x("error")}},T.click()},[S,n]),k=d.useCallback(async()=>{if(u.current){const T=u.current.getVideoTracks()[0];if(T)try{await T.applyConstraints({advanced:[{torch:!N}]}),b(!N)}catch{}}},[N]);return e.jsxs("div",{className:R("relative flex h-screen flex-col bg-black",s),children:[e.jsxs("div",{className:"absolute top-0 right-0 left-0 z-10 flex items-center justify-between p-4",children:[e.jsx(q,{variant:"ghost",size:"icon","data-testid":"back-button",onClick:A,className:"text-white","aria-label":a("a11y.back"),children:e.jsx(Us,{className:"size-6"})}),e.jsx("h1",{"data-testid":"page-title",className:"text-lg font-medium text-white",children:n("title")}),e.jsx(q,{variant:"ghost",size:"icon",onClick:k,className:R("text-white",N&&"text-yellow-400"),"aria-label":n(N?"flashOff":"flashOn"),children:e.jsx(No,{className:"size-6"})})]}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("video",{ref:l,className:R("absolute inset-0 size-full object-cover",p!=="scanning"&&p!=="success"&&"invisible"),playsInline:!0,muted:!0}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"relative size-64",children:[e.jsx("div",{className:R("absolute top-0 left-0 size-8 border-t-4 border-l-4",p==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:R("absolute top-0 right-0 size-8 border-t-4 border-r-4",p==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:R("absolute bottom-0 left-0 size-8 border-b-4 border-l-4",p==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:R("absolute right-0 bottom-0 size-8 border-r-4 border-b-4",p==="success"?"border-green-500":"border-primary")}),p==="scanning"&&e.jsx("div",{className:"animate-scan bg-primary absolute right-2 left-2 h-0.5"})]})}),e.jsxs("div",{className:"absolute inset-x-0 bottom-32 text-center",children:[p==="idle"&&e.jsx("p",{className:"text-white/80",children:n("initializing")}),p==="requesting"&&e.jsx("p",{className:"text-white/80",children:n("requestingPermission")}),p==="scanning"&&e.jsx("p",{className:"text-white/80",children:n("scanPrompt")}),p==="success"&&e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-green-400",children:n("scanSuccess")})}),p==="denied"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-red-400",children:n("permissionDenied")}),e.jsx(q,{variant:"outline","data-testid":"retry-button",onClick:E,children:n("retry")})]}),p==="error"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-red-400",children:g||n("error")}),e.jsx(q,{variant:"outline","data-testid":"retry-button",onClick:E,children:n("retry")})]})]})]}),e.jsxs("div",{className:"absolute inset-x-0 bottom-0 flex justify-center gap-8 pb-8",children:[e.jsxs(q,{variant:"ghost",size:"lg","data-testid":"gallery-button",onClick:P,className:"flex flex-col items-center text-white",children:[e.jsx(yo,{className:"mb-1 size-6"}),e.jsx("span",{className:"text-xs",children:n("gallery")})]}),e.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-white/20",children:e.jsx(rf,{className:"size-8 text-white"})}),e.jsx("div",{className:"w-16"})," "]})]})}xd.__docgenInfo={description:"",methods:[],displayName:"ScannerPage",props:{onScan:{required:!1,tsType:{name:"union",raw:"((content: string, parsed: ParsedQRContent) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:"Callback when QR code is scanned"},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"Custom class name"}}};const gd=()=>e.jsx(ae,{children:e.jsx(xd,{})});gd.__docgenInfo={description:"",methods:[],displayName:"ScannerActivity"};const py=300*1e3;function vd(t){if(t)return t}function hy(t){return t.map(s=>({id:s.id,name:s.name,address:s.address,balance:""}))}function xy(t,s,n){const a=new Map;for(const r of t)for(const o of r.chainAddresses){const c=vd(o.chain);if(!c)continue;const i=a.get(c)??[];i.push({address:o.address,isDefault:r.id===s}),a.set(c,i)}return Array.from(a.entries()).map(([r,o])=>({chain:r,name:n[r]??r,addresses:o.map(c=>({address:c.address,isDefault:c.isDefault}))}))}function Li(t){const s=t?.trim().toLowerCase();return s==="true"||s==="1"}function yd(){const{t}=B("authorize"),{t:s}=B("common"),{navigate:n,goBack:a}=re(),{push:r}=Y(),o=at(),{id:c,type:i,chainName:l,signMessage:m,getMain:u}=de(),f=we(Ce,F=>F.currentWalletId),h=we(Ce,F=>F.wallets),v=we(Ce,Bs.getCurrentWallet),y=$t(),[p,x]=d.useState(null),[g,j]=d.useState(null),[N,b]=d.useState(!1),S=d.useMemo(()=>hy(h),[h]),w=v?.id??h[0]?.id,[I,E]=d.useState(w),A=d.useMemo(()=>vd(l),[l]),[P,k]=d.useState(A);d.useEffect(()=>k(A),[A]);const[T,C]=d.useState(void 0),[_,z]=d.useState(()=>new Set(h.map(F=>F.id))),[D,L]=d.useState(!1);d.useEffect(()=>{E(w)},[w]),d.useEffect(()=>{z(new Set(h.map(F=>F.id)))},[h]);const J=d.useMemo(()=>{const F=["viewAddress","viewPublicKey"];return m?.trim()&&F.push("signMessage"),Li(u)&&F.push("getMain"),F},[u,m]),M=d.useMemo(()=>new Hf(rs,c),[c]),O=d.useMemo(()=>!!m?.trim(),[m]),Q=d.useMemo(()=>Li(u),[u]),te=O||Q;d.useEffect(()=>{let F=!1;async function ee(){j(null);try{const ue=await rs.getCallerAppInfo(c);if(F)return;x(ue)}catch{if(F)return;j(t("error.authFailed"))}}return ee(),()=>{F=!0}},[c,t]),d.useEffect(()=>{const F=window.setTimeout(()=>{(async()=>(await M.reject("timeout"),o.show({message:t("error.timeout"),position:"center"}),n({to:"/"})))()},py);return()=>{window.clearTimeout(F)}},[M,n,t,o]);const W=d.useMemo(()=>I?h.find(F=>F.id===I)??null:null,[I,h]),G=d.useMemo(()=>xy(h,f,y),[y,f,h]),ve=d.useMemo(()=>v?v.chainAddresses.map(F=>F.chain):[],[v]),se=d.useMemo(()=>{if(!(!v||!P))return v.chainAddresses.find(F=>F.chain===P)?.address},[v,P]);d.useEffect(()=>{i==="network"&&(P||k(G[0]?.chain))},[G,P,i]);const H=d.useMemo(()=>h.length===0?!1:i==="main"?!!W:i==="network"?P?(G.find(F=>F.chain===P)?.addresses.length??0)>0:!1:_.size>0,[G,P,W,_.size,i,h.length]),Z=d.useCallback(()=>{a()},[a]),X=d.useCallback(async()=>{if(!N){b(!0);try{await M.reject("rejected"),n({to:"/"})}finally{b(!1)}}},[M,N,n]),le=d.useCallback(async()=>{if(!(!H||N)){if(te){Nt(async F=>{b(!0);try{const ee=m?.trim()??"";let ue=[],ye=[];if(i==="main"){if(!W)return!1;ue=M.handleMainAddresses(W),ye=[W]}else if(i==="network"){if(!P)return!1;ue=M.handleNetworkAddresses(h,P),ye=h}else{const pe=h.filter(wt=>_.has(wt.id));ue=M.handleAllAddresses(pe),ye=pe}return ue=await M.applySensitiveOptions(ue,ye,{password:F,signMessage:ee,getMain:Q}),await M.approve(ue),n({to:"/"}),!0}catch{return!1}finally{b(!1)}}),r("WalletLockConfirmJob",{title:t("passwordConfirm.title")});return}b(!0);try{let F=[];if(i==="main"){if(!W)return;F=M.handleMainAddresses(W)}else if(i==="network"){if(!P)return;F=M.handleNetworkAddresses(h,P)}else{const ee=h.filter(ue=>_.has(ue.id));F=M.handleAllAddresses(ee)}await M.approve(F),n({to:"/"})}finally{b(!1)}}},[M,H,N,n,te,Q,r,P,W,_,m,t,i,h]);return i==="network"&&l&&!A?e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(V,{title:t("title.address"),onBack:Z}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-destructive",children:t("error.unknownChain")}),e.jsx("div",{className:"mt-4",children:e.jsx(q,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]}):g?e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(V,{title:t("title.address"),onBack:Z}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-destructive",children:g}),e.jsx("div",{className:"mt-4",children:e.jsx(q,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]}):e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(V,{title:t("title.address"),onBack:Z}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[p&&e.jsx(vo,{appInfo:p}),e.jsx("div",{className:"px-1 text-sm text-foreground",children:t("address.shareWith")}),e.jsx(zm,{permissions:J}),e.jsx("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:[i==="main"&&t("address.scope.main"),i==="network"&&t("address.scope.network",{chainName:(P?y[P]:void 0)??P??""}),i==="all"&&t("address.scope.all")]})}),e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[i==="main"&&e.jsx(Dm,{wallets:S,...I?{selectedId:I}:{},onSelect:F=>E(F.id)}),i==="network"&&v&&P&&e.jsx("div",{className:"aspect-[1.6/1] w-full",children:e.jsx(Ui,{wallet:v,chain:P,chainName:y[P]??P,address:se,priority:"low",onOpenChainSelector:A?void 0:()=>L(!0)})}),i==="all"&&e.jsxs("div",{className:"space-y-2",children:[h.length===0&&e.jsx("div",{className:"py-6 text-center text-sm text-muted-foreground",children:t("address.noWallets")}),h.map(F=>{const ee=_.has(F.id);return e.jsxs("button",{type:"button",onClick:()=>{z(ue=>{const ye=new Set(ue);return ye.has(F.id)?ye.delete(F.id):ye.add(F.id),ye})},className:R("flex w-full items-center justify-between rounded-lg border px-3 py-2 text-left transition-colors","hover:bg-muted/50",ee?"border-primary bg-primary/5":"border-border bg-background"),"aria-pressed":ee,children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-medium",children:F.name}),e.jsx("div",{className:"truncate font-mono text-xs text-muted-foreground",children:F.address})]}),e.jsx("div",{className:R("flex size-5 items-center justify-center rounded border",ee?"border-primary bg-primary text-primary-foreground":"border-border bg-background"),"aria-hidden":"true",children:ee?"":""})]},F.id)})]})]})]}),e.jsx("div",{className:"sticky bottom-0 border-t border-border bg-background p-4 safe-area-inset-bottom",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(q,{type:"button",variant:"outline",className:"flex-1",onClick:X,disabled:N,children:t("button.reject")}),e.jsx(q,{type:"button",className:"flex-1",onClick:le,disabled:!H||N,children:t("button.approve")})]})}),D&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/50",onClick:()=>L(!1),children:e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-background rounded-t-2xl",onClick:F=>F.stopPropagation(),children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("address.selectNetwork")})}),e.jsx("div",{className:"max-h-[60vh] space-y-2 overflow-y-auto p-4",children:ve.map(F=>{const ee=v?.chainAddresses.find(ue=>ue.chain===F);return e.jsxs("button",{onClick:()=>{k(F),L(!1)},className:R("flex w-full items-center gap-3 rounded-xl p-4 transition-colors",F===P?"bg-primary/10 ring-1 ring-primary":"bg-muted/50 hover:bg-muted"),children:[e.jsx(xt,{chain:F,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:y[F]??F}),e.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:ee?.address?gy(ee.address):"---"})]}),F===P&&e.jsx(he,{className:"size-5 text-primary"})]},F)})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})]})}function gy(t,s=10,n=8){return t.length<=s+n+3?t:`${t.slice(0,s)}...${t.slice(-n)}`}yd.__docgenInfo={description:"",methods:[],displayName:"AddressAuthPage"};const bd=({params:t})=>e.jsx(ae,{children:e.jsx(oe,{params:t,children:e.jsx(yd,{})})});bd.__docgenInfo={description:"",methods:[],displayName:"AuthorizeAddressActivity"};const vy=300*1e3;function zi(t){return typeof t=="object"&&t!==null}function qe(t,s){const n=t[s];if(typeof n=="string")return n;if(typeof n=="number"&&Number.isFinite(n))return String(n)}function yy(t,s,n){const a=qe(t,s)?.trim();return a?{ok:!0,value:a}:{ok:!1,error:`signaturedata missing field: ${n}`}}function kt(t,s){for(const n of s){const a=qe(t,n.key)?.trim();if(a)return{ok:!0,value:a}}return{ok:!1,error:`signaturedata missing field: ${s.map(n=>n.label).join(" / ")}`}}function by(t){if(typeof t=="string"){const s=t.trim().toLowerCase();return s==="message"?{ok:!0,value:"message"}:s==="transfer"?{ok:!0,value:"transfer"}:s==="destroy"||s==="destory"?{ok:!0,value:"destory"}:{ok:!1,error:`Unsupported signature type: ${t}`}}return typeof t=="number"&&Number.isInteger(t)?t===0?{ok:!0,value:"message"}:t===1?{ok:!0,value:"transfer"}:t===7?{ok:!0,value:"destory"}:{ok:!1,error:`Unsupported signature type: ${t}`}:{ok:!1,error:"signaturedata.type must be string or number"}}function jy(t){if(t===void 0||t.trim()==="")return{ok:!1,error:"Missing signaturedata parameter"};let s;try{s=JSON.parse(t)}catch{return{ok:!1,error:"signaturedata is not valid JSON"}}if(!Array.isArray(s))return{ok:!1,error:"signaturedata must be a JSON array"};if(s.length===0)return{ok:!1,error:"signaturedata cannot be an empty array"};const n=s[0];if(!zi(n))return{ok:!1,error:"signaturedata[0] must be an object"};const a=by(n.type);if(!a.ok)return a;const r=kt(n,[{key:"chainName",label:"chainName"},{key:"chain",label:"chain"}]);if(!r.ok)return r;const o=r.value;if(a.value==="message"){const c=kt(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!c.ok)return c;const i=yy(n,"message","message");return i.ok?{ok:!0,item:{type:"message",payload:{chainName:o,senderAddress:c.value,message:i.value}}}:i}if(a.value==="transfer"){const c=kt(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!c.ok)return c;const i=kt(n,[{key:"receiveAddress",label:"receiveAddress"},{key:"to",label:"to"}]);if(!i.ok)return i;const l=kt(n,[{key:"balance",label:"balance"},{key:"amount",label:"amount"}]);if(!l.ok)return l;const m=qe(n,"fee")?.trim(),u=qe(n,"assetType")?.trim();let f;const h=n.contractInfo;if(zi(h)){const v=qe(h,"assetType")?.trim(),y=h.decimals,p=qe(h,"contractAddress")?.trim(),x=typeof y=="number"&&Number.isFinite(y)?y:typeof y=="string"&&y.trim()!==""?Number(y):void 0;v&&p&&typeof x=="number"&&Number.isFinite(x)&&(f={assetType:v,contractAddress:p,decimals:x})}return{ok:!0,item:{type:"transfer",payload:{chainName:o,senderAddress:c.value,receiveAddress:i.value,balance:l.value,...m?{fee:m}:{},...u?{assetType:u}:{},...f?{contractInfo:f}:{}}}}}{const c=kt(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!c.ok)return c;const i=kt(n,[{key:"destoryAmount",label:"destoryAmount"},{key:"amount",label:"amount"}]);if(!i.ok)return i;const l=qe(n,"destoryAddress")?.trim()??qe(n,"to")?.trim()??c.value,m=qe(n,"fee")?.trim(),u=qe(n,"assetType")?.trim();return{ok:!0,item:{type:"destory",payload:{chainName:o,senderAddress:c.value,destoryAddress:l,destoryAmount:i.value,...m?{fee:m}:{},...u?{assetType:u}:{}}}}}}function Ny(t){return typeof t=="object"&&t!==null&&"senderAddress"in t&&"receiveAddress"in t&&"balance"in t}function wy(t){return typeof t=="object"&&t!==null&&"senderAddress"in t&&"message"in t&&!("receiveAddress"in t)}function Cy(t){return typeof t=="object"&&t!==null&&"senderAddress"in t&&"destoryAddress"in t&&"destoryAmount"in t}function Di(t){return t.contractInfo?.assetType?t.contractInfo.assetType.toUpperCase():t.assetType?t.assetType.toUpperCase():{ethereum:"ETH",bitcoin:"BTC",tron:"TRX",binance:"BNB",bsc:"BNB"}[t.chainName?.toLowerCase()??""]??"TOKEN"}function ky(t,s,n){const a=parseFloat(t)||0,r=parseFloat(s)||0,o=parseFloat(n??"0")||0,c=r+o;return{sufficient:a>=c,required:c.toString()}}function jd(){const{t}=B("authorize"),{t:s}=B("common"),{navigate:n,goBack:a}=re(),{push:r}=Y(),o=at(),{id:c,signaturedata:i}=de(),l=we(Ce,Bs.getCurrentWallet),[m,u]=d.useState(null),[f,h]=d.useState(null),[v,y]=d.useState(null),[p,x]=d.useState(!1),g=d.useMemo(()=>new Fa(rs,c),[c]);d.useEffect(()=>{let k=!1;async function T(){y(null);try{const C=jy(i);if(!C.ok){y(C.error);return}const _=await rs.getCallerAppInfo(c);if(k)return;u(_);const z={eventId:c,type:C.item.type,payload:C.item.payload,appName:_.appName,appHome:_.origin,appLogo:_.appIcon};h(z)}catch{if(k)return;y(t("error.authFailed"))}}return T(),()=>{k=!0}},[c,i,t]),d.useEffect(()=>{const k=window.setTimeout(()=>{(async()=>(await g.reject("timeout"),o.show({message:t("error.timeout"),position:"center"}),n({to:"/"})))()},vy);return()=>{window.clearTimeout(k)}},[g,n,t,o]);const j=d.useMemo(()=>!f||!Ny(f.payload)?null:f.payload,[f]),N=d.useMemo(()=>!f||!wy(f.payload)?null:f.payload,[f]),b=d.useMemo(()=>!f||!Cy(f.payload)?null:f.payload,[f]),S=d.useMemo(()=>{if(!l)return{sufficient:!0,required:"0",walletBalance:"0"};const k=j?{chainName:j.chainName,amount:j.balance,fee:j.fee}:b?{chainName:b.chainName,amount:b.destoryAmount,fee:b.fee}:null;if(!k)return{sufficient:!0,required:"0",walletBalance:"0"};const C=l.chainAddresses.find(z=>z.chain.toLowerCase()===k.chainName?.toLowerCase())?"1.0":"0";return{...ky(C,k.amount,k.fee),walletBalance:C}},[l,b,j]),w=d.useMemo(()=>j?Di(j):b?Di(b):"TOKEN",[b,j]),I=d.useCallback(()=>{a()},[a]),E=d.useCallback(async()=>{if(!p){x(!0);try{await g.reject(S.sufficient?"rejected":"insufficient_balance"),n({to:"/"})}finally{x(!1)}}},[g,S.sufficient,p,n]),A=d.useCallback(()=>{S.sufficient&&(p||(Nt(async k=>{x(!0);try{const T=l?.encryptedMnemonic;if(!T||!f)return!1;let C="";if(f.type==="message"){if(!N)return!1;const _=await g.handleMessageSign(N,T,k);C=typeof _=="string"?_:_.signature??""}else if(f.type==="transfer"){if(!j)return!1;const _=await g.handleTransferSign(j,T,k);C=typeof _=="string"?_:_.signature??""}else if(f.type==="destory"){if(!b)return!1;const _=await g.handleDestroySign(b,T,k);C=typeof _=="string"?_:_.signature??""}else return!1;return await g.approve(C),n({to:"/"}),!0}catch{return!1}finally{x(!1)}}),r("WalletLockConfirmJob",{title:t("button.confirm")})))},[g,S.sufficient,l?.encryptedMnemonic,b,p,N,n,r,f,t,j]);if(v)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:t("title.signature"),onBack:I}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsx("p",{className:"text-destructive text-sm",children:v}),e.jsx("div",{className:"mt-4",children:e.jsx(q,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]});const P=f?.type==="message"?t("signature.type.message"):f?.type==="destory"?t("signature.type.destroy"):t("title.signature");return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:P,onBack:I}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[m&&e.jsx(vo,{appInfo:m}),e.jsx("div",{className:"text-foreground px-1 text-sm",children:t("signature.reviewTransaction")}),j&&e.jsxs(e.Fragment,{children:[e.jsx(Ar,{from:j.senderAddress,to:j.receiveAddress,amount:`${j.balance} ${w}`,...j.fee?{fee:`${j.fee} ${w}`}:{},chainId:j.chainName}),!S.sufficient&&e.jsx(Ir,{balance:S.walletBalance,required:S.required,symbol:w})]}),N&&e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-sm",children:t("signature.messageToSign")}),e.jsx("div",{className:R("bg-muted/50 rounded-lg p-3","font-mono text-sm break-all whitespace-pre-wrap","max-h-48 overflow-y-auto"),children:N.message})]}),b&&e.jsxs(e.Fragment,{children:[e.jsx(Ar,{from:b.senderAddress,to:b.destoryAddress,amount:`${b.destoryAmount} ${w}`,...b.fee?{fee:`${b.fee} ${w}`}:{},chainId:b.chainName}),!S.sufficient&&e.jsx(Ir,{balance:S.walletBalance,required:S.required,symbol:w})]}),f&&e.jsx("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:e.jsxs("div",{className:"text-muted-foreground text-sm",children:[f.type==="transfer"&&t("signature.type.transfer"),f.type==="message"&&t("signature.type.message"),f.type==="destory"&&t("signature.type.destroy")]})})]}),e.jsx("div",{className:"border-border bg-background safe-area-inset-bottom sticky bottom-0 border-t p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(q,{type:"button",variant:"outline",className:"flex-1",onClick:E,disabled:p,children:t("button.reject")}),e.jsx(q,{type:"button",className:"flex-1",onClick:A,disabled:p||!S.sufficient,children:t("button.confirm")})]})})]})}jd.__docgenInfo={description:"",methods:[],displayName:"SignatureAuthPage"};const Nd=({params:t})=>e.jsx(ae,{children:e.jsx(oe,{params:t,children:e.jsx(jd,{})})});Nd.__docgenInfo={description:"",methods:[],displayName:"AuthorizeSignatureActivity"};function wd({walletName:t,onEnterWallet:s,className:n}){const{t:a}=B("onboarding");return e.jsxs("div",{"data-testid":"import-success-step",className:R("flex min-h-screen flex-col items-center justify-center px-6 py-8",n),children:[e.jsx("div",{className:"mb-6 flex size-20 items-center justify-center rounded-full bg-green-100 dark:bg-green-900/30",children:e.jsx(us,{className:"size-10 text-green-600 dark:text-green-400"})}),e.jsx("h1",{"data-testid":"success-message",className:"mb-2 text-2xl font-bold",children:a("import.success.title")}),e.jsx("p",{className:"text-muted-foreground mb-8 text-center",children:e.jsx(xo,{i18nKey:"import.success.description",ns:"onboarding",values:{name:t},components:{bold:e.jsx("span",{className:"text-foreground font-medium"})}})}),e.jsx("div",{className:"w-full max-w-xs",children:e.jsxs("button",{type:"button","data-testid":"enter-wallet-button",onClick:s,className:R("flex w-full items-center justify-center gap-2 rounded-full py-3 font-medium transition-colors","bg-primary hover:bg-primary/90 text-primary-foreground"),children:[e.jsx("span",{children:a("import.success.enterWallet")}),e.jsx(Te,{className:"size-5"})]})})]})}wd.__docgenInfo={description:"Success screen shown after wallet import",methods:[],displayName:"ImportWalletSuccess",props:{walletName:{required:!0,tsType:{name:"string"},description:"Wallet name"},onEnterWallet:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback when user chooses to enter wallet"},className:{required:!1,tsType:{name:"string"},description:"Additional class name"}}};ge.t.bind(ge);function Sy(t){if(!Ji(t))throw new Error("Invalid mnemonic");return Ru(t.join(" "))}function Ay(t){return new Set(t.map(s=>s.address.toLowerCase()))}const Iy=ge.t.bind(ge),aa={isDuplicate:!1,type:"none"};function Ty(t){const[s,n]=d.useState(aa),[a,r]=d.useState(!1),[o,c]=d.useState(null),i=d.useCallback(async m=>{r(!0),c(null);try{const u=Sy(m),f=Ay(u),h=await t.getAllAddresses();for(const x of h)if(f.has(x.address.toLowerCase())){const g={isDuplicate:!0,type:"address",matchedWallet:{id:x.walletId,name:x.walletName,importType:"mnemonic",matchedAddress:x.address}};return n(g),g}const y=(await t.getAllMainWallets()).filter(x=>x.importType==="privateKey");for(const x of y)for(const g of x.addresses)if(f.has(g.address.toLowerCase())){const j={isDuplicate:!0,type:"privateKey",matchedWallet:{id:x.id,name:x.name,importType:"privateKey",matchedAddress:g.address}};return n(j),j}const p={isDuplicate:!1,type:"none"};return n(p),p}catch(u){const f=u instanceof Error?u.message:Iy("error:duplicate.detectionFailed");return c(f),aa}finally{r(!1)}},[t]),l=d.useCallback(()=>{n(aa),c(null)},[]);return{result:s,isChecking:a,error:o,check:i,reset:l}}const Py={getAllAddresses:async()=>[],getAllMainWallets:async()=>[],findWalletByAddress:async()=>null};function Cd(){const{navigate:t,goBack:s}=re(),{push:n}=Y(),{t:a}=B(["onboarding","common","wallet"]),r=Os(),o=st().snapshot,c=xu(),i=Ft(),[l,m]=d.useState("keyType"),[u,f]=d.useState("mnemonic"),[h,v]=d.useState(!1),[y,p]=d.useState([]),[x,g]=d.useState(""),[j,N]=d.useState(null),[b,S]=d.useState([]),[w,I]=d.useState(!1),[E,A]=d.useState(""),[P,k]=d.useState(null),[T,C]=d.useState([]),[_,z]=d.useState(!1);d.useEffect(()=>{!_&&r.length>0&&(C(uo(r)),z(!0))},[r,_]);const D=Ty(Py),L=(()=>{switch(l){case"keyType":return 1;case"mnemonic":case"arbitrary":return 2;case"collision":return 2;case"pattern":return 3;case"chains":return 4;case"theme":return 5;case"success":return 5;default:return 1}})(),J=d.useCallback(()=>{switch(l){case"keyType":s();break;case"mnemonic":case"arbitrary":m("keyType"),D.reset();break;case"collision":m("mnemonic"),D.reset();break;case"pattern":m(u==="arbitrary"?"arbitrary":"mnemonic");break;case"chains":m("pattern");break;case"theme":m("chains");break}},[l,s,D,u]),M=d.useCallback(()=>{m("pattern")},[]),O=d.useCallback(le=>{A(le),m("chains")},[]),Q=d.useCallback(()=>{if(u==="mnemonic"){m("mnemonic");return}if(h){m("arbitrary");return}lv(()=>{v(!0),m("arbitrary")}),n("SecurityWarningJob",{})},[u,h,n]),te=d.useCallback(async le=>{p(le.mnemonic);const F=await D.check(le.mnemonic);if(F.isDuplicate){if(F.type==="address")return;if(F.type==="privateKey"){m("collision");return}}M()},[D,M]),W=d.useCallback(async()=>{M()},[M]),G=d.useCallback(()=>{m("mnemonic"),D.reset()},[D]),ve=d.useCallback(async(le,F)=>{I(!0);try{const ee=le.join(" "),ye=(await mo({mnemonic:ee,selectedChainIds:T,chainConfigs:r})).map(({chainId:tu,address:su,publicKey:nu})=>({chain:tu,address:su,publicKey:nu??"",tokens:[]})),pe=ye[0];if(!pe)throw new Error("No chain addresses derived");const wt=ia(pe.address),eu=await fe.createWallet({name:a("onboarding:create.generatedNamePattern",{word:gn(i),suffix:a("onboarding:create.walletSuffix")}),keyType:"mnemonic",address:pe.address,chain:pe.chain,chainAddresses:ye,themeHue:wt},ee,F,wt);k(eu.id),m("theme")}catch{}finally{I(!1)}},[r,T,a]),se=d.useCallback(async le=>{const F=x.trim();if(F&&b.length!==0){I(!0);try{const ee=b[0];if(!ee)throw new Error("No enabled bioforest chains");const ue=ia(ee.address),ye=b.map(wt=>({chain:wt.chainId,address:wt.address,publicKey:"",tokens:[]})),pe=await fe.createWallet({name:a("onboarding:create.generatedNamePattern",{word:gn(i),suffix:a("onboarding:create.walletSuffix")}),keyType:"arbitrary",address:ee.address,chain:ee.chainId,chainAddresses:ye,themeHue:ue},F,le,ue);k(pe.id),m("theme")}catch{}finally{I(!1)}}},[b,x,a]),H=d.useCallback(()=>{t({to:"/",replace:!0})},[t]),Z=d.useCallback(async()=>{if(!w){if(u==="arbitrary"){await se(E);return}y.length!==0&&await ve(y,E)}},[se,ve,w,u,y,E]),X=d.useCallback(()=>{t({to:"/"})},[t]);return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[l==="keyType"&&e.jsxs(e.Fragment,{children:[e.jsx(V,{title:a("onboarding:keyType.title"),onBack:J}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(ct,{total:5,current:L})}),e.jsxs("div",{"data-testid":"key-type-step",className:"flex-1 space-y-6 p-4",children:[e.jsx(Bm,{value:u,onChange:le=>{f(le),le==="mnemonic"&&(g(""),S([]))}}),e.jsx(q,{type:"button","data-testid":"continue-button",onClick:Q,className:"w-full",children:a("common:continue")})]})]}),l==="mnemonic"&&e.jsxs(e.Fragment,{children:[e.jsx(V,{title:a("onboarding:recover.title"),onBack:J}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(ct,{total:5,current:L})}),e.jsx("div",{"data-testid":"mnemonic-step",className:"flex-1 p-4",children:e.jsx(Nu,{onSubmit:te,isSubmitting:D.isChecking})})]}),l==="arbitrary"&&e.jsxs(e.Fragment,{children:[e.jsx(V,{title:a("onboarding:keyType.arbitrary"),onBack:J}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(ct,{total:5,current:L})}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx(Om,{value:x,onChange:le=>{N(null),g(le)},disabled:w}),j&&e.jsxs("div",{className:"bg-destructive/10 text-destructive flex items-start gap-2 rounded-lg px-3 py-2 text-sm",children:[e.jsx(vt,{className:"mt-0.5 size-4 shrink-0"}),e.jsx("span",{children:j})]}),e.jsx(Wm,{secret:x,enabledBioforestChainConfigs:o?c:void 0,onDerived:S}),e.jsxs(q,{type:"button",className:"w-full",disabled:w||x.trim()!==""&&b.length===0,onClick:()=>{if(!x.trim()){N(a("onboarding:arbitraryKey.required"));return}M()},children:[w&&e.jsx(ke,{className:"size-4 animate-spin"}),a("common:continue")]})]})]}),l==="collision"&&e.jsxs(e.Fragment,{children:[e.jsx(V,{title:a("onboarding:recover.addressConflict"),onBack:J}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(ct,{total:5,current:L})}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(Fm,{result:D.result,onConfirm:W,onCancel:G,isLoading:w})})]}),l==="pattern"&&e.jsxs(e.Fragment,{children:[e.jsx(V,{title:a("onboarding:recover.setWalletLock"),onBack:J}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(ct,{total:5,current:L})}),e.jsx("div",{"data-testid":"pattern-step",className:"flex-1 p-4",children:e.jsx(Da,{onComplete:O,minPoints:4})})]}),l==="chains"&&e.jsxs(e.Fragment,{children:[e.jsx(V,{title:a("onboarding:chainSelector.title"),onBack:J}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(ct,{total:5,current:L})}),e.jsx("div",{"data-testid":"chains-step",className:"flex-1 p-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Fs,{icon:e.jsx(us,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:a("onboarding:chainSelector.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:a("onboarding:chainSelector.subtitle")})]}),r.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(Se,{})}):e.jsx(Ba,{"data-testid":"chain-selector",chains:r,selectedChains:T,onSelectionChange:C}),e.jsx(ze,{variant:"mint",className:"w-full","data-testid":"chains-continue-button",disabled:T.length===0,onClick:Z,children:a("common:next")})]})})]}),l==="theme"&&P&&e.jsxs(e.Fragment,{children:[e.jsx(V,{title:a("onboarding:create.themeTitle")}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(ct,{total:5,current:L})}),e.jsx("div",{"data-testid":"theme-step",className:"flex-1 p-4",children:e.jsx(Fn,{mode:"edit-only",walletId:P,onEditOnlyComplete:H})})]}),l==="success"&&e.jsx(wd,{walletName:a("wallet:defaultName"),onEnterWallet:X})]})}Cd.__docgenInfo={description:`Onboarding recover wallet page
Implements wallet recovery with duplicate detection per openspec/changes/add-wallet-recover-duplicate-guards`,methods:[],displayName:"OnboardingRecoverPage"};const kd=()=>e.jsx(ae,{children:e.jsx(Cd,{})});kd.__docgenInfo={description:"",methods:[],displayName:"OnboardingRecoverActivity"};const rn={symbol:"USDT",balance:1234.56,fiatValue:"1234.56"},Ey=[{id:"1",type:"send",status:"confirmed",amount:ne.fromFormatted("100",6,"USDT"),symbol:"USDT",address:"0xabcd...1234",timestamp:new Date(Date.now()-36e5)},{id:"2",type:"receive",status:"confirmed",amount:ne.fromFormatted("500",6,"USDT"),symbol:"USDT",address:"0x1234...abcd",timestamp:new Date(Date.now()-864e5)}];function Sd(){const{t}=B("token"),{navigate:s,goBack:n}=re();return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(V,{title:rn.symbol,onBack:n}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsx("div",{className:"text-center",children:e.jsx(Em,{value:rn.balance,symbol:rn.symbol,fiatValue:rn.fiatValue,size:"lg"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(ze,{variant:"mint",className:"flex-1",onClick:()=>s({to:"/send",search:{address:void 0,chain:void 0,amount:void 0}}),children:[e.jsx(Fu,{className:"mr-2 size-4"}),t("detail.send")]}),e.jsxs(ze,{variant:"blue",className:"flex-1",onClick:()=>s({to:"/receive"}),children:[e.jsx(Dn,{className:"mr-2 size-4"}),t("detail.receive")]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold",children:t("detail.transactionHistory")}),e.jsx(go,{transactions:Ey,emptyTitle:t("detail.noTransactions"),emptyDescription:t("detail.noTransactionsDesc")})]})]})]})}Sd.__docgenInfo={description:"",methods:[],displayName:"TokenDetailPage"};const Ad=({params:t})=>e.jsx(ae,{children:e.jsx(oe,{params:t,children:e.jsx(Sd,{})})});Ad.__docgenInfo={description:"",methods:[],displayName:"TokenDetailActivity"};function Id(){const{t}=B("common"),{goBack:s}=re(),{push:n}=Y(),r=we(ks).contacts,o=we(Ce,Bs.getCurrentWallet),[c,i]=d.useState(""),l=d.useRef(null),m=d.useMemo(()=>c.trim()?Na.searchContacts(ks.state,c.trim()):r,[r,c]),u=d.useCallback(()=>{s()},[s]),f=d.useCallback(()=>{n("ContactEditJob",{})},[n]),h=d.useCallback(p=>{n("ContactEditJob",{contactId:p.id})},[n]),v=d.useCallback(p=>{n("ContactShareJob",{name:p.name,addresses:JSON.stringify(p.addresses.map(x=>({address:x.address,label:x.label}))),memo:p.memo,avatar:p.avatar})},[n]),y=d.useCallback(p=>{l.current=p,o?.encryptedMnemonic?(Nt(async x=>{try{return await Mt(o.encryptedMnemonic,x)?(Ss.deleteContact(p.id),l.current=null,!0):!1}catch{return!1}}),n("WalletLockConfirmJob",{title:t("addressBook.deleteTitle"),description:t("addressBook.deleteConfirm",{name:p.name})})):(Ss.deleteContact(p.id),l.current=null)},[o?.encryptedMnemonic,n,t]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:t("addressBook.title"),onBack:u,rightAction:e.jsx("button",{onClick:f,className:R("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":t("a11y.addContact"),"data-testid":"address-book-add-button",children:e.jsx(nt,{className:"size-5"})})}),e.jsx("div",{className:"px-4 py-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(qs,{className:"text-muted-foreground absolute top-1/2 left-3 size-4 -translate-y-1/2"}),e.jsx("input",{type:"text",value:c,onChange:p=>i(p.target.value),placeholder:t("addressBook.searchPlaceholder"),className:R("border-border bg-background w-full rounded-xl border py-2.5 pr-4 pl-10","focus:ring-primary focus:ring-2 focus:outline-none")})]})}),e.jsx("div",{className:"flex-1 p-4",children:m.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[e.jsx(im,{className:"text-muted-foreground/50 size-12"}),e.jsx("p",{className:"text-muted-foreground",children:t(c?"addressBook.noResults":"addressBook.noContacts")}),!c&&e.jsx("button",{onClick:f,className:R("bg-primary rounded-full px-6 py-2.5 text-sm font-medium text-primary-foreground","hover:bg-primary/90 active:bg-primary/80"),children:t("contact.addTitle")})]}):e.jsx("div",{className:"space-y-2",children:m.map(p=>e.jsx(_y,{contact:p,onShare:()=>v(p),onEdit:()=>h(p),onDelete:()=>y(p)},p.id))})})]})}function _y({contact:t,onEdit:s,onDelete:n,onShare:a}){const{t:r}=B("common"),[o,c]=d.useState(!1);return e.jsx("div",{className:R("bg-card rounded-xl p-4 shadow-sm","transition-colors"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ds,{src:t.avatar||(t.addresses[0]?.address?Rt(t.addresses[0].address):void 0),size:40}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"truncate font-medium",children:t.name}),t.addresses.length>0&&e.jsxs("p",{className:"text-muted-foreground truncate font-mono text-xs",children:[t.addresses[0]?.address,t.addresses.length>1&&` (+${t.addresses.length-1})`]}),t.memo&&e.jsx("p",{className:"text-muted-foreground mt-1 truncate text-xs",children:t.memo})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>c(!o),className:R("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":r("a11y.moreActions"),children:e.jsx($m,{className:"text-muted-foreground size-4"})}),o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>c(!1)}),e.jsxs("div",{className:"bg-popover border-border absolute top-full right-0 z-20 mt-1 w-32 rounded-lg border py-1 shadow-lg",children:[e.jsx("button",{onClick:()=>{c(!1),a()},className:"hover:bg-muted w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.shareContact")}),e.jsx("button",{onClick:()=>{c(!1),s()},className:"hover:bg-muted w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.edit")}),e.jsx("button",{onClick:()=>{c(!1),n()},className:"text-destructive hover:bg-destructive/10 w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.delete")})]})]})]})]})})}Id.__docgenInfo={description:"",methods:[],displayName:"AddressBookPage"};const Td=()=>e.jsx(ae,{children:e.jsx(Id,{})});Td.__docgenInfo={description:"",methods:[],displayName:"AddressBookActivity"};function Pd({open:t,onOpenChange:s}){const{t:n}=B("common"),a=yt(),r=ka(),o=lu(),c=du(),i=$t(),l=d.useCallback(m=>{!o.includes(m)&&!c||Xt.toggleWalletSelection(m)},[o,c]);return e.jsx(ut,{open:t,onOpenChange:s,children:e.jsxs(mt,{side:"bottom",className:"rounded-t-2xl",children:[e.jsx(ft,{className:"pb-4",children:e.jsx(pt,{children:n("myCard.selectWallets")})}),e.jsxs("div",{className:"max-h-[50vh] overflow-y-auto pb-[env(safe-area-inset-bottom)]",children:[a.map(m=>{const u=r[m.id]||m.chain,f=m.chainAddresses.find(y=>y.chain===u),h=o.includes(m.id),v=!h&&!c;return e.jsxs("button",{type:"button",onClick:()=>l(m.id),disabled:v,className:R("flex w-full items-center gap-3 rounded-lg p-3 text-left transition-colors",h&&"bg-primary/10",!v&&"hover:bg-muted",v&&"cursor-not-allowed opacity-50"),children:[e.jsx(xt,{chain:u,size:"md"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium",children:m.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{children:i[u]||u}),e.jsxs("span",{className:"truncate font-mono text-xs",children:[f?.address.slice(0,8),"...",f?.address.slice(-6)]})]})]}),h&&e.jsx("div",{className:"flex size-6 items-center justify-center rounded-full bg-primary",children:e.jsx(he,{className:"size-4 text-primary-foreground"})})]},m.id)}),a.length===0&&e.jsx("div",{className:"py-8 text-center text-muted-foreground",children:n("noAssets")})]}),e.jsx("p",{className:"py-4 text-center text-xs text-muted-foreground",children:n("myCard.maxWallets",{max:3})})]})})}Pd.__docgenInfo={description:"",methods:[],displayName:"WalletPickerSheet",props:{open:{required:!0,tsType:{name:"boolean"},description:""},onOpenChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(open: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"open"}],return:{name:"void"}}},description:""}}};function My(t,s){const[n,a]=d.useState(!1),{filename:r,shareTitle:o,shareText:c}=s,i=d.useCallback(async()=>{const m=t.current;if(!(!m||n)){a(!0);try{const{snapdom:u}=await ht(async()=>{const{snapdom:f}=await import("./snapdom-CO8q8LPW.js").then(h=>h.s);return{snapdom:f}},__vite__mapDeps([0,1]),import.meta.url);await u.download(m,{type:"png",filename:`${r}.png`,scale:2,quality:1})}catch(u){console.error("Download failed:",u)}finally{a(!1)}}},[t,r,n]),l=d.useCallback(async()=>{const m=t.current;if(!(!m||!navigator.share||n)){a(!0);try{const{snapdom:u}=await ht(async()=>{const{snapdom:y}=await import("./snapdom-CO8q8LPW.js").then(p=>p.s);return{snapdom:y}},__vite__mapDeps([0,1]),import.meta.url),h=await(await u(m,{scale:2})).toBlob(),v=new File([h],`${r}.png`,{type:"image/png"});await navigator.share({title:o,text:c,files:[v]})}catch{}finally{a(!1)}}},[t,r,o,c,n]);return{isProcessing:n,download:i,share:l,canShare:typeof navigator<"u"&&"share"in navigator}}function Ed(){const{t}=B(["common","settings"]),{goBack:s}=re(),n=d.useRef(null),a=d.useRef(null),r=wa(),o=yt(),c=ka(),i=$t(),[l,m]=d.useState(!1),[u,f]=d.useState(r.username),[h,v]=d.useState(!1);d.useEffect(()=>{if(!r.avatar&&o.length>0){const A=o[0]?.chainAddresses[0]?.address;A&&Xt.initializeDefaultAvatar(A)}},[r.avatar,o]),d.useEffect(()=>{if(r.selectedWalletIds.length===0&&o.length>0){const A=o[0];A&&Xt.toggleWalletSelection(A.id)}},[r.selectedWalletIds,o]);const y=d.useMemo(()=>r.selectedWalletIds.map(A=>o.find(P=>P.id===A)).filter(A=>!!A).map(A=>{const P=c[A.id]||A.chain,k=A.chainAddresses.find(T=>T.chain===P);return{wallet:A,chain:P,address:k?.address}}).filter(A=>A.address),[r.selectedWalletIds,o,c]),p=d.useMemo(()=>y.filter(A=>!!A.address).map(({wallet:A,address:P})=>({address:P,label:A.name})),[y]),x=d.useMemo(()=>p.length===0?"":Ma({name:r.username||t("myCard.defaultName"),addresses:p,avatar:r.avatar}),[r.username,r.avatar,p,t]),g=d.useCallback(()=>{Xt.randomizeAvatar()},[]),j=d.useCallback(()=>{f(r.username),m(!0)},[r.username]),N=d.useCallback(()=>{Xt.setUsername(u),m(!1)},[u]),b=d.useCallback(A=>{A.key==="Enter"?N():A.key==="Escape"&&m(!1)},[N]);d.useEffect(()=>{l&&n.current?.focus()},[l]);const{isProcessing:S,download:w,share:I}=My(a,{filename:`my-card-${Date.now()}`,shareTitle:t("myCard.title"),shareText:r.username||t("myCard.defaultName")}),E=r.username||t("myCard.defaultName");return e.jsxs("div",{className:"flex min-h-screen flex-col bg-background",children:[e.jsx(V,{title:t("myCard.title"),onBack:s}),e.jsxs("div",{className:"flex flex-1 flex-col items-center p-6",children:[e.jsxs("button",{type:"button",onClick:g,className:"group relative mb-4 cursor-pointer transition-transform hover:scale-105","aria-label":t("myCard.changeAvatar"),children:[e.jsx(ds,{src:r.avatar,size:80}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center rounded-full bg-black/50 opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx("span",{className:"text-xs text-white",children:t("myCard.changeAvatar")})})]}),l?e.jsx("div",{className:"mb-6 flex items-center gap-2",children:e.jsx(De,{ref:n,value:u,onChange:A=>f(A.target.value),onBlur:N,onKeyDown:b,placeholder:t("myCard.usernamePlaceholder"),className:"w-48 text-center"})}):e.jsxs("button",{type:"button",onClick:j,className:"group mb-6 flex items-center gap-2 text-xl font-semibold",children:[e.jsx("span",{children:E}),e.jsx(qm,{className:"size-4 text-muted-foreground opacity-50 group-hover:opacity-100"})]}),p.length>0?e.jsx("div",{ref:a,className:"mb-6",children:e.jsx(La,{name:E,avatar:r.avatar,addresses:p,qrContent:x})}):e.jsx("div",{className:"mb-6 flex h-[300px] w-[320px] items-center justify-center rounded-3xl bg-muted",children:e.jsx("p",{className:"text-muted-foreground",children:t("myCard.noWalletsSelected")})}),e.jsxs("div",{className:"mb-6 w-full max-w-[320px]",children:[e.jsx("h3",{className:"mb-2 text-sm font-medium text-muted-foreground",children:t("myCard.selectWallets")}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[y.map(({wallet:A,chain:P})=>{const{c0:k}=jm(A.themeHue);return e.jsxs("div",{className:"flex items-center gap-1.5 rounded-full px-3 py-1.5 text-sm font-medium",style:{backgroundColor:k,color:"#FFFFFF"},children:[e.jsx("span",{children:A.name}),e.jsx("span",{style:{opacity:.8},children:t("myCard.chainLabel",{chain:i[P]||P})}),e.jsx("button",{type:"button",onClick:()=>Xt.toggleWalletSelection(A.id),className:"ml-0.5 rounded-full p-0.5 transition-colors hover:bg-white/20","aria-label":t("myCard.removeWallet",{name:A.name}),children:e.jsx(Us,{className:"size-3"})})]},A.id)}),r.selectedWalletIds.length<3&&e.jsxs("button",{type:"button",onClick:()=>v(!0),className:"flex items-center gap-1 rounded-full border border-dashed border-muted-foreground/50 px-3 py-1 text-sm text-muted-foreground hover:border-primary hover:text-primary",children:[e.jsx(nt,{className:"size-3"}),t("myCard.addWallet")]})]}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:t("myCard.maxWallets",{max:3})})]}),e.jsxs("div",{className:"flex w-full max-w-[320px] gap-3",children:[e.jsxs(q,{variant:"outline",onClick:w,disabled:S||p.length===0,className:"flex-1",children:[S?e.jsx(ke,{className:"mr-2 size-4 animate-spin"}):e.jsx(Hs,{className:"mr-2 size-4"}),t("download")]}),"share"in navigator&&e.jsxs(q,{onClick:I,disabled:S||p.length===0,className:"flex-1",children:[S?e.jsx(ke,{className:"mr-2 size-4 animate-spin"}):e.jsx(Ms,{className:"mr-2 size-4"}),t("share")]})]}),e.jsx("p",{className:"mt-6 text-center text-sm text-muted-foreground",children:t("myCard.scanToAdd")})]}),e.jsx(Pd,{open:h,onOpenChange:v})]})}Ed.__docgenInfo={description:"",methods:[],displayName:"MyCardPage"};const _d=()=>e.jsx(ae,{children:e.jsx(Ed,{})});_d.__docgenInfo={description:"",methods:[],displayName:"MyCardActivity"};const Ry={transaction:{icon:"",bg:"bg-blue-100 dark:bg-blue-900/30"},security:{icon:"",bg:"bg-red-100 dark:bg-red-900/30"},system:{icon:"",bg:"bg-gray-100 dark:bg-gray-800/30"}};function Ly(){const{t}=B("notification"),s=Ft();return d.useCallback(n=>{const r=Date.now()-n,o=Math.floor(r/6e4),c=Math.floor(r/36e5),i=Math.floor(r/864e5);return o<1?t("time.justNow"):o<60?t("time.minutesAgo",{count:o}):c<24?t("time.hoursAgo",{count:c}):i<7?t("time.daysAgo",{count:i}):new Date(n).toLocaleDateString(s)},[t,s])}function zy({notification:t,onRead:s,onRemove:n,onNavigate:a,formatRelativeTime:r,t:o}){const c=Ry[t.type],i=t.type==="transaction"&&!!t.data?.pendingTxId,l=d.useCallback(()=>{t.read||s(t.id),i&&a&&a(t)},[t,s,a,i]);return e.jsxs("div",{onClick:l,className:R("flex cursor-pointer items-start gap-3 rounded-xl p-4 transition-colors",t.read?"bg-muted/30":"bg-card shadow-sm"),children:[e.jsx("div",{className:R("flex size-10 shrink-0 items-center justify-center rounded-full",c.bg),children:e.jsx("span",{className:"text-lg",children:c.icon})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h4",{className:R("font-medium",t.read&&"text-muted-foreground"),children:t.title}),e.jsx("span",{className:"text-muted-foreground shrink-0 text-xs",children:r(t.timestamp)})]}),e.jsx("p",{className:R("mt-1 text-sm",t.read?"text-muted-foreground":"text-foreground/80"),children:t.message}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[!t.read&&e.jsx("div",{className:"bg-primary flex size-2 rounded-full","aria-label":o("unread")}),i&&e.jsxs("span",{className:"text-primary flex items-center gap-0.5 text-xs",children:[o("viewDetails"),e.jsx(Te,{className:"size-3"})]})]})]}),e.jsx("button",{onClick:m=>{m.stopPropagation(),n(t.id)},className:"text-muted-foreground hover:text-destructive shrink-0 p-1","aria-label":o("delete"),children:e.jsx(qt,{className:"size-4"})})]})}function Dy({notifications:t,onRead:s,onRemove:n,onNavigate:a,formatRelativeTime:r,t:o,language:c}){const i=d.useMemo(()=>{const l=new Map,m=new Date().toLocaleDateString(c),u=new Date(Date.now()-864e5).toLocaleDateString(c);for(const f of t){const h=new Date(f.timestamp).toLocaleDateString(c);let v=h;h===m?v=o("time.today"):h===u&&(v=o("time.yesterday"));const y=l.get(v)||[];l.set(v,[...y,f])}return l},[t,c,o]);return t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx("div",{className:"bg-muted mb-4 flex size-16 items-center justify-center rounded-full",children:e.jsx(Hm,{className:"text-muted-foreground size-8"})}),e.jsx("h3",{className:"text-lg font-medium",children:o("empty.title")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:o("empty.desc")})]}):e.jsx("div",{className:"space-y-6",children:Array.from(i.entries()).map(([l,m])=>e.jsxs("div",{children:[e.jsx("h3",{className:"text-muted-foreground mb-2 text-sm font-medium",children:l}),e.jsx("div",{className:"space-y-2",children:m.map(u=>e.jsx(zy,{notification:u,onRead:s,onRemove:n,onNavigate:a,formatRelativeTime:r,t:o},u.id))})]},l))})}function Md(){const{t}=B("notification"),s=Ft(),n=Ly(),{goBack:a,navigate:r}=re(),o=we(Lu);d.useEffect(()=>{o.isInitialized||ms.initialize()},[o.isInitialized]);const c=d.useCallback(f=>{ms.markRead(f)},[]),i=d.useCallback(f=>{ms.remove(f)},[]),l=d.useCallback(()=>{ms.markAllRead()},[]),m=d.useCallback(()=>{ms.clearAll()},[]),u=d.useCallback(f=>{f.type==="transaction"&&f.data?.pendingTxId&&r({to:`/pending-tx/${f.data.pendingTxId}`})},[r]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:t("title"),onBack:a,rightAction:o.unreadCount>0?e.jsxs("button",{onClick:l,className:"text-primary hover:bg-primary/10 flex items-center gap-1 rounded-full px-3 py-1.5 text-sm","aria-label":t("markAllRead"),children:[e.jsx(he,{className:"size-4"}),t("markAllRead")]}):void 0}),e.jsx("div",{className:"bg-card border-b px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:o.unreadCount>0?t("unreadCount",{count:o.unreadCount}):t("noUnread")}),o.notifications.length>0&&e.jsxs(q,{variant:"ghost",size:"sm",onClick:m,className:"text-destructive",children:[e.jsx(qt,{className:"mr-1 size-4"}),t("clear")]})]})}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(Dy,{notifications:o.notifications,onRead:c,onRemove:i,onNavigate:u,formatRelativeTime:n,t,language:s})})]})}Md.__docgenInfo={description:"",methods:[],displayName:"NotificationCenterPage"};const Rd=()=>e.jsx(ae,{children:e.jsx(Md,{})});Rd.__docgenInfo={description:"",methods:[],displayName:"NotificationsActivity"};function By(t){const s=t.toNumber();return s>=1e9?`${(s/1e9).toFixed(2)}B`:s>=1e6?`${(s/1e6).toFixed(2)}M`:s>=1e3?`${(s/1e3).toFixed(2)}K`:s.toFixed(Math.min(5,8))}function Ld({item:t,onMint:s,className:n}){const{t:a}=B("staking"),r=[{label:a("totalMinted",{asset:t.assetType}),value:t.totalMinted},{label:a("totalCirculation",{asset:t.assetType}),value:t.totalCirculation},{label:a("totalBurned",{asset:t.assetType}),value:t.totalBurned},{label:a("totalStaked",{asset:t.externalAssetType}),value:t.totalStaked}];return e.jsxs("div",{className:R("overflow-hidden rounded-xl shadow-md","bg-gradient-to-b from-primary/90 to-primary",n),children:[e.jsxs("div",{className:"relative grid grid-cols-2 gap-3 p-4",children:[r.map((o,c)=>e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("span",{className:"text-lg font-semibold text-amber-300",children:By(o.value)}),e.jsx("span",{className:"text-xs text-primary-foreground/70",children:o.label})]},c)),e.jsx("div",{className:"pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 opacity-20",children:e.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-white/20 text-2xl font-bold text-white",children:t.chain.charAt(0)})})]}),e.jsxs("div",{className:"flex items-center justify-between bg-card px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(et,{symbol:t.externalAssetType,size:"sm"}),e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"font-medium text-foreground",children:t.externalAssetType}),e.jsx("div",{className:"text-muted-foreground",children:t.externalChain})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(et,{symbol:t.assetType,size:"sm"}),e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"font-medium text-foreground",children:t.assetType}),e.jsx("div",{className:"text-muted-foreground",children:t.chain})]})]}),e.jsx(q,{size:"sm",variant:"default",className:"rounded-full px-4",onClick:()=>s?.(t),children:a("mint")})]})]})]})}Ld.__docgenInfo={description:"Staking pool card component",methods:[],displayName:"StakingPoolCard",props:{item:{required:!0,tsType:{name:"StakingOverviewItem"},description:""},onMint:{required:!1,tsType:{name:"union",raw:"((item: StakingOverviewItem) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Oy=[{value:"all",label:"allNetworks"},{value:"ETH",label:"Ethereum"},{value:"BSC",label:"BNB Chain"},{value:"TRON",label:"Tron"},{value:"BFMeta",label:"BFMeta"},{value:"BFChain",label:"BFChain"}];function zd({onMint:t,className:s}){const{t:n}=B("staking"),[a,r]=d.useState(""),[o,c]=d.useState("all"),[i,l]=d.useState(!1),[m,u]=d.useState([]),[f,h]=d.useState(!0);d.useEffect(()=>{let p=!0;return h(!0),Lt.getOverview().then(x=>{p&&(u(x),h(!1))}),()=>{p=!1}},[]);const v=d.useMemo(()=>{let p=m;if(a.trim()){const x=a.toLowerCase();p=p.filter(g=>g.assetType.toLowerCase().includes(x)||g.externalAssetType.toLowerCase().includes(x)||g.chain.toLowerCase().includes(x)||g.externalChain.toLowerCase().includes(x))}return o!=="all"&&(p=p.filter(x=>x.chain===o||x.externalChain===o)),p},[m,a,o]),y=p=>{c(p),l(!1)};return f?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[e.jsx(Se,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):e.jsxs("div",{className:R("space-y-4",s),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(qs,{className:"text-muted-foreground absolute top-1/2 left-3 size-4 -translate-y-1/2"}),e.jsx(De,{type:"text",placeholder:n("searchPlaceholder"),value:a,onChange:p=>r(p.target.value),className:"pl-9"})]}),e.jsxs(ut,{open:i,onOpenChange:l,children:[e.jsx(gm,{render:e.jsxs(q,{variant:"outline",size:"icon",className:"relative",children:[e.jsx(Co,{className:"size-4"}),o!=="all"&&e.jsx("span",{className:"bg-primary absolute -top-1 -right-1 size-2 rounded-full"})]})}),e.jsxs(mt,{side:"bottom",className:"h-[60vh]",children:[e.jsx(ft,{children:e.jsx(pt,{children:n("selectNetwork")})}),e.jsx("div",{className:"mt-4 space-y-2",children:Oy.map(p=>e.jsxs("button",{onClick:()=>y(p.value),className:R("flex w-full items-center justify-between rounded-lg px-4 py-3 text-left transition-colors",o===p.value?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("span",{children:p.value==="all"?n("allNetworks"):p.label}),o===p.value&&e.jsx("span",{className:"text-primary",children:""})]},p.value))})]})]})]}),v.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-20",children:e.jsx("p",{className:"text-muted-foreground",children:n("noResults")})}):e.jsx("div",{className:"space-y-4",children:v.map((p,x)=>e.jsx(Ld,{item:p,onMint:t},`${p.chain}-${p.assetType}-${x}`))})]})}zd.__docgenInfo={description:"Staking overview panel with search and filter",methods:[],displayName:"StakingOverviewPanel",props:{onMint:{required:!1,tsType:{name:"signature",type:"function",raw:"(item: StakingOverviewItem) => void",signature:{arguments:[{type:{name:"StakingOverviewItem"},name:"item"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Wy=["ETH","BSC","TRON"],Fy={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron"},Bi={ETH:{BFM:"1000.00",USDT:"5000.00"},BSC:{BFM:"2500.00",USDT:"10000.00",BFC:"500.00"},TRON:{USDT:"8000.00"}};function $y(t,s){if(!t)return[];const n=[];for(const[a,r]of Object.entries(t))for(const[o,c]of Object.entries(r)){const i=c.supportChain[s];i&&n.push({asset:i.assetType,targetChain:a,targetAsset:o})}return n}function Dd({onSuccess:t,className:s}){const{t:n}=B("staking"),a=$t(),[r,o]=d.useState("BSC"),[c,i]=d.useState(""),[l,m]=d.useState(""),[u,f]=d.useState(""),[h,v]=d.useState(""),[y,p]=d.useState(!1),[x,g]=d.useState(!1),[j,N]=d.useState(!0),[b,S]=d.useState(!1),[w,I]=d.useState(null);d.useEffect(()=>{let L=!0;return Lt.getRechargeConfig().then(J=>{L&&(I(J),N(!1))}),()=>{L=!1}},[]);const E=d.useMemo(()=>$y(w,r),[w,r]),A=d.useCallback(L=>{const J=Fy[L];if(J)return J;const M=L.toLowerCase();return a[M]??a[L]??L},[a]);d.useEffect(()=>{const L=E[0];L&&!c&&(i(L.asset),m(L.targetChain),f(L.targetAsset))},[E,c]);const P=d.useCallback(L=>{o(L),i(""),m(""),f(""),v(""),p(!1)},[]),k=d.useCallback(L=>{i(L.asset),m(L.targetChain),f(L.targetAsset),g(!1)},[]),T=d.useMemo(()=>Bi[r]?.[c]??"0.00",[r,c]),C=d.useCallback(()=>{v(T.replace(/,/g,""))},[T]),_=d.useMemo(()=>{if(!h)return null;const L=parseFloat(h);if(isNaN(L)||L<=0)return n("invalidAmount");const J=parseFloat(T.replace(/,/g,""));return L>J?n("insufficientBalance"):null},[h,T,n]),z=d.useMemo(()=>r&&c&&l&&u&&h&&!_&&!b,[r,c,l,u,h,_,b]),D=d.useCallback(async()=>{if(z){S(!0);try{const L=h.replace(/,/g,""),J={sourceChain:r,sourceAsset:c,amount:ne.fromFormatted(L,18,c),targetChain:l,targetAsset:u},M=await Lt.submitMint(J);t?.(M.id)}finally{S(!1)}}},[z,r,c,h,l,u,t]);return j?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Se,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):e.jsxs("div",{className:R("space-y-4",s),children:[e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("sourceChain")}),e.jsxs("button",{type:"button",onClick:()=>p(!0),className:"bg-background mb-3 flex w-full items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-muted flex size-6 items-center justify-center rounded-full text-xs font-bold",children:r.charAt(0)}),e.jsx("span",{className:"font-medium",children:A(r)})]}),e.jsx(Te,{className:"text-muted-foreground size-4"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>g(!0),className:"bg-background flex shrink-0 items-center gap-2 rounded-lg px-3 py-2",children:[e.jsx(et,{symbol:c||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:c||n("selectToken")}),e.jsx(Te,{className:"text-muted-foreground size-4"})]}),e.jsx("div",{className:"flex-1",children:e.jsx(De,{type:"text",inputMode:"decimal",placeholder:"0.00",value:h,onChange:L=>v(L.target.value),className:"border-0 bg-transparent text-right text-lg font-semibold"})})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-muted-foreground",children:[n("availableBalance"),": ",T]}),e.jsx(q,{type:"button",variant:"ghost",size:"sm",className:"text-primary h-auto px-2 py-1 text-xs",onClick:C,children:n("max")})]}),_&&e.jsx("div",{className:"text-destructive mt-2 text-xs",children:_})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-muted rounded-full p-2",children:e.jsx(Dn,{className:"text-muted-foreground size-4"})})}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("targetChain")}),e.jsxs("div",{className:"bg-background flex items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-primary/20 text-primary flex size-6 items-center justify-center rounded-full text-xs font-bold",children:l.charAt(0)||"?"}),e.jsx("span",{className:"font-medium",children:l?A(l):n("selectToken")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(et,{symbol:u||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:u||"-"})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:n("amount")}),e.jsxs("span",{className:"font-semibold",children:[h||"0.00"," ",u]})]})]}),e.jsx(q,{type:"button",size:"lg",className:"w-full",disabled:!z,onClick:D,children:b?e.jsxs(e.Fragment,{children:[e.jsx(Se,{size:"sm"}),e.jsx("span",{className:"ml-2",children:n("confirm")})]}):n("confirm")}),e.jsx(ut,{open:y,onOpenChange:p,children:e.jsxs(mt,{side:"bottom",className:"h-[50vh]",children:[e.jsx(ft,{children:e.jsx(pt,{children:n("selectChain")})}),e.jsx("div",{className:"mt-4 space-y-2",children:Wy.map(L=>e.jsxs("button",{onClick:()=>P(L),className:R("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",r===L?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("div",{className:"bg-muted flex size-8 items-center justify-center rounded-full text-sm font-bold",children:L.charAt(0)}),e.jsx("span",{className:"font-medium",children:A(L)}),r===L&&e.jsx("span",{className:"text-primary ml-auto",children:""})]},L))})]})}),e.jsx(ut,{open:x,onOpenChange:g,children:e.jsxs(mt,{side:"bottom",className:"h-[60vh]",children:[e.jsx(ft,{children:e.jsx(pt,{children:n("selectToken")})}),e.jsx("div",{className:"mt-4 space-y-2",children:E.length===0?e.jsx("p",{className:"text-muted-foreground py-8 text-center",children:n("noResults")}):E.map(L=>e.jsxs("button",{onClick:()=>k(L),className:R("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",c===L.asset?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx(et,{symbol:L.asset,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:L.asset}),e.jsx("div",{className:"text-muted-foreground text-xs",children:n("targetChainLabel",{chain:A(L.targetChain),asset:L.targetAsset})})]}),e.jsx("div",{className:"text-muted-foreground text-right text-sm",children:Bi[r]?.[L.asset]??"0.00"}),c===L.asset&&e.jsx("span",{className:"text-primary",children:""})]},`${L.targetChain}-${L.asset}`))})]})})]})}Dd.__docgenInfo={description:"Mint form component",methods:[],displayName:"MintForm",props:{onSuccess:{required:!1,tsType:{name:"signature",type:"function",raw:"(txId: string) => void",signature:{arguments:[{type:{name:"string"},name:"txId"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const qy=["BFMeta","BFChain","CCChain","PMChain"],Hy={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron"},Oi={BFMeta:{BFM:"5000.00",USDT:"2500.00"},BFChain:{BFC:"1000.00"},CCChain:{},PMChain:{}};function Uy(t,s){if(!t)return[];const n=s.toLowerCase(),a=t[n];if(!a)return[];const r=[];for(const[o,c]of Object.entries(a)){const i=[];c.supportChain.ETH&&i.push("ETH"),c.supportChain.BSC&&i.push("BSC"),c.supportChain.TRON&&i.push("TRON"),i.length>0&&r.push({asset:o,targetChains:i})}return r}function Bd({onSuccess:t,className:s}){const{t:n}=B("staking"),a=$t(),[r,o]=d.useState("BFMeta"),[c,i]=d.useState(""),[l,m]=d.useState(""),[u,f]=d.useState(""),[h,v]=d.useState(!1),[y,p]=d.useState(!1),[x,g]=d.useState(!1),[j,N]=d.useState(!0),[b,S]=d.useState(!1),[w,I]=d.useState(null);d.useEffect(()=>{let M=!0;return Lt.getRechargeConfig().then(O=>{M&&(I(O),N(!1))}),()=>{M=!1}},[]);const E=d.useMemo(()=>Uy(w,r),[w,r]),A=d.useCallback(M=>{const O=Hy[M];if(O)return O;const Q=M.toLowerCase();return a[Q]??a[M]??M},[a]),P=d.useMemo(()=>c?E.find(O=>O.asset===c)?.targetChains??[]:[],[E,c]);d.useEffect(()=>{const M=E[0];if(M&&!c){i(M.asset);const O=M.targetChains[0];O&&m(O)}},[E,c]);const k=d.useCallback(M=>{o(M),i(""),m(""),f(""),v(!1)},[]),T=d.useCallback(M=>{i(M.asset);const O=M.targetChains[0];O&&m(O),p(!1)},[]),C=d.useCallback(M=>{m(M),g(!1)},[]),_=d.useMemo(()=>Oi[r]?.[c]??"0.00",[r,c]),z=d.useCallback(()=>{f(_.replace(/,/g,""))},[_]),D=d.useMemo(()=>{if(!u)return null;const M=parseFloat(u);if(isNaN(M)||M<=0)return n("invalidAmount");const O=parseFloat(_.replace(/,/g,""));return M>O?n("insufficientBalance"):null},[u,_,n]),L=d.useMemo(()=>r&&c&&l&&u&&!D&&!b,[r,c,l,u,D,b]),J=d.useCallback(async()=>{if(!(!L||!l)){S(!0);try{const M=u.replace(/,/g,""),O={sourceChain:r,sourceAsset:c,amount:ne.fromFormatted(M,8,c),targetChain:l,targetAsset:c},Q=await Lt.submitBurn(O);t?.(Q.id)}finally{S(!1)}}},[L,r,c,u,l,t]);return j?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Se,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):e.jsxs("div",{className:R("space-y-4",s),children:[e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("sourceChain")}),e.jsxs("button",{type:"button",onClick:()=>v(!0),className:"bg-background mb-3 flex w-full items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-primary/20 text-primary flex size-6 items-center justify-center rounded-full text-xs font-bold",children:r.charAt(0)}),e.jsx("span",{className:"font-medium",children:A(r)})]}),e.jsx(Te,{className:"text-muted-foreground size-4"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>p(!0),className:"bg-background flex shrink-0 items-center gap-2 rounded-lg px-3 py-2",children:[e.jsx(et,{symbol:c||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:c||n("selectToken")}),e.jsx(Te,{className:"text-muted-foreground size-4"})]}),e.jsx("div",{className:"flex-1",children:e.jsx(De,{type:"text",inputMode:"decimal",placeholder:"0.00",value:u,onChange:M=>f(M.target.value),className:"border-0 bg-transparent text-right text-lg font-semibold"})})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-muted-foreground",children:[n("availableBalance"),": ",_]}),e.jsx(q,{type:"button",variant:"ghost",size:"sm",className:"text-primary h-auto px-2 py-1 text-xs",onClick:z,children:n("max")})]}),D&&e.jsx("div",{className:"text-destructive mt-2 text-xs",children:D})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-muted rounded-full p-2",children:e.jsx(Dn,{className:"text-muted-foreground size-4"})})}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("targetChain")}),e.jsxs("button",{type:"button",onClick:()=>g(!0),disabled:P.length===0,className:"bg-background flex w-full items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-muted flex size-6 items-center justify-center rounded-full text-xs font-bold",children:l?l.charAt(0):"?"}),e.jsx("span",{className:"font-medium",children:l?A(l):n("selectChain")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(et,{symbol:c||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:c||"-"}),e.jsx(Te,{className:"text-muted-foreground size-4"})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:n("amount")}),e.jsxs("span",{className:"font-semibold",children:[u||"0.00"," ",c]})]})]}),e.jsx(q,{type:"button",size:"lg",className:"w-full",disabled:!L,onClick:J,children:b?e.jsxs(e.Fragment,{children:[e.jsx(Se,{size:"sm"}),e.jsx("span",{className:"ml-2",children:n("confirm")})]}):n("confirm")}),e.jsx(ut,{open:h,onOpenChange:v,children:e.jsxs(mt,{side:"bottom",className:"h-[50vh]",children:[e.jsx(ft,{children:e.jsx(pt,{children:n("selectChain")})}),e.jsx("div",{className:"mt-4 space-y-2",children:qy.map(M=>e.jsxs("button",{onClick:()=>k(M),className:R("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",r===M?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("div",{className:"bg-primary/20 text-primary flex size-8 items-center justify-center rounded-full text-sm font-bold",children:M.charAt(0)}),e.jsx("span",{className:"font-medium",children:A(M)}),r===M&&e.jsx("span",{className:"text-primary ml-auto",children:""})]},M))})]})}),e.jsx(ut,{open:y,onOpenChange:p,children:e.jsxs(mt,{side:"bottom",className:"h-[60vh]",children:[e.jsx(ft,{children:e.jsx(pt,{children:n("selectToken")})}),e.jsx("div",{className:"mt-4 space-y-2",children:E.length===0?e.jsx("p",{className:"text-muted-foreground py-8 text-center",children:n("noResults")}):E.map(M=>e.jsxs("button",{onClick:()=>T(M),className:R("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",c===M.asset?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx(et,{symbol:M.asset,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:M.asset}),e.jsxs("div",{className:"text-muted-foreground text-xs",children:[" ",M.targetChains.join(", ")]})]}),e.jsx("div",{className:"text-muted-foreground text-right text-sm",children:Oi[r]?.[M.asset]??"0.00"}),c===M.asset&&e.jsx("span",{className:"text-primary",children:""})]},M.asset))})]})}),e.jsx(ut,{open:x,onOpenChange:g,children:e.jsxs(mt,{side:"bottom",className:"h-[50vh]",children:[e.jsx(ft,{children:e.jsx(pt,{children:n("selectChain")})}),e.jsx("div",{className:"mt-4 space-y-2",children:P.map(M=>e.jsxs("button",{onClick:()=>C(M),className:R("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",l===M?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("div",{className:"bg-muted flex size-8 items-center justify-center rounded-full text-sm font-bold",children:M.charAt(0)}),e.jsx("span",{className:"font-medium",children:A(M)}),l===M&&e.jsx("span",{className:"text-primary ml-auto",children:""})]},M))})]})})]})}Bd.__docgenInfo={description:"Burn form component",methods:[],displayName:"BurnForm",props:{onSuccess:{required:!1,tsType:{name:"signature",type:"function",raw:"(txId: string) => void",signature:{arguments:[{type:{name:"string"},name:"txId"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Vy={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron"};function Jy({status:t}){switch(t){case"pending":return e.jsx(Vm,{className:"size-4 text-yellow-500"});case"confirming":return e.jsx(ke,{className:"size-4 animate-spin text-blue-500"});case"confirmed":return e.jsx(us,{className:"size-4 text-green-500"});case"failed":return e.jsx(Um,{className:"text-destructive size-4"})}}function Ky(t){const n=Date.now()-t;return n<6e4?"Just now":n<36e5?`${Math.floor(n/6e4)}m ago`:n<864e5?`${Math.floor(n/36e5)}h ago`:new Date(t).toLocaleDateString()}function Gy(t){const s=t.toNumber();return s>=1e6?`${(s/1e6).toFixed(2)}M`:s>=1e3?`${(s/1e3).toFixed(2)}K`:s.toFixed(4)}function Wi(t,s){const n=Vy[t];if(n)return n;const a=t.toLowerCase();return s[a]??s[t]??t}function Qy({record:t,onClick:s}){const{t:n}=B("staking"),a=$t(),r=Wi(t.sourceChain,a),o=Wi(t.targetChain,a),c=t.type==="mint",i=c?ef:jo;return e.jsxs("button",{type:"button",onClick:s,className:"bg-card hover:bg-muted/50 flex w-full items-center gap-3 rounded-lg p-3 text-left transition-colors",children:[e.jsx("div",{className:R("flex size-10 items-center justify-center rounded-full",c?"bg-green-500/10":"bg-orange-500/10"),children:e.jsx(i,{className:R("size-5",c?"text-green-500":"text-orange-500")})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:n(c?"mint":"burn")}),e.jsx(Jy,{status:t.status})]}),e.jsxs("div",{className:"text-muted-foreground flex items-center gap-1 text-xs",children:[e.jsx("span",{children:r}),e.jsx("span",{children:""}),e.jsx("span",{children:o})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(et,{symbol:t.sourceAsset,size:"sm"}),e.jsx("span",{className:"font-medium",children:Gy(t.sourceAmount)})]}),e.jsx("div",{className:"text-muted-foreground text-xs",children:Ky(t.createdAt)})]})]})}function Od({filterType:t="all",onRecordClick:s,className:n}){const{t:a}=B("staking"),[r,o]=d.useState([]),[c,i]=d.useState(!0),[l,m]=d.useState(t==="all"?"all":t);d.useEffect(()=>{let v=!0;return i(!0),Lt.getTransactions().then(y=>{v&&(o(y),i(!1))}),()=>{v=!1}},[]);const u=d.useMemo(()=>l==="all"?r:r.filter(v=>v.type===l),[r,l]),f=[{id:"all",label:a("history")},{id:"mint",label:a("mint")},{id:"burn",label:a("burn")}],h=d.useCallback(()=>{i(!0),Lt.getTransactions().then(v=>{o(v),i(!1)})},[]);return c?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Se,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:a("loading")})]}):e.jsxs("div",{className:R("space-y-4",n),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[f.map(v=>e.jsx(q,{type:"button",variant:l===v.id?"default":"outline",size:"sm",onClick:()=>m(v.id),children:v.label},v.id)),e.jsx(q,{type:"button",variant:"ghost",size:"sm",className:"ml-auto",onClick:h,children:a("refresh")})]}),u.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:a("noTransactions")})}):e.jsx("div",{className:"space-y-2",children:u.map(v=>e.jsx(Qy,{record:v,onClick:()=>s?.(v)},v.id))})]})}Od.__docgenInfo={description:"Staking record list component",methods:[],displayName:"StakingRecordList",props:{filterType:{required:!1,tsType:{name:"union",raw:"StakingTxType | 'all'",elements:[{name:"StakingTxType"},{name:"literal",value:"'all'"}]},description:"Filter by transaction type",defaultValue:{value:"'all'",computed:!1}},onRecordClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(record: StakingTransaction) => void",signature:{arguments:[{type:{name:"StakingTransaction"},name:"record"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};function Wd(){const{t}=B("staking"),{goBack:s}=re(),[n,a]=d.useState("overview"),r=[{id:"overview",label:t("overview")},{id:"mint",label:t("mint")},{id:"burn",label:t("burn")},{id:"history",label:t("history")}],o=c=>{a("mint")};return e.jsxs("div",{className:"flex min-h-screen flex-col bg-background",children:[e.jsx(V,{title:t("title"),onBack:s}),e.jsx("div",{className:"flex border-b border-border px-4",children:r.map(c=>e.jsx("button",{onClick:()=>a(c.id),className:R("flex-1 py-3 text-sm font-medium transition-colors",n===c.id?"border-b-2 border-primary text-primary":"text-muted-foreground hover:text-foreground"),children:c.label},c.id))}),e.jsxs("div",{className:"flex-1 p-4",children:[n==="overview"&&e.jsx(zd,{onMint:o}),n==="mint"&&e.jsx(Yy,{}),n==="burn"&&e.jsx(Xy,{}),n==="history"&&e.jsx(Od,{})]})]})}function Yy(){const{t}=B("staking"),s=n=>{};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:t("mintDescription")}),e.jsx(Dd,{onSuccess:s})]})}function Xy(){const{t}=B("staking"),s=n=>{};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:t("burnDescription")}),e.jsx(Bd,{onSuccess:s})]})}Wd.__docgenInfo={description:"Staking page with tab navigation",methods:[],displayName:"StakingPage"};const Fd=()=>e.jsx(ae,{children:e.jsx(Wd,{})});Fd.__docgenInfo={description:"",methods:[],displayName:"StakingActivity"};const Zy=ls({assetType:U(),decimals:Ot(),amount:U().optional(),useDefaultDecimals:Ze().optional(),logoUrl:U().optional(),contractAddress:U().optional()}),eb=ls({address:U(),symbol:U(),addressKey:U(),mainWalletId:U(),chain:U(),mnemonic:U().optional(),privateKey:U(),publicKey:U().optional(),isCustomAssets:Ze().optional(),isFreezed:Ze().optional(),assets:Xe(Zy),name:U(),prohibitChangeName:Ze().optional(),index:Ot().optional(),purpose:Pa([Ye(44),Ye(49),Ye(84),Ye(86)]).optional()}),tb=ls({chainName:U(),addressKey:U(),address:U(),symbol:U(),mainWalletId:U(),index:Ot().optional(),purpose:Pa([Ye(44),Ye(49),Ye(84),Ye(86)]).optional()});ls({name:U(),skipBackup:Ze().optional(),importPhrase:U(),importType:U(),addressKeyList:Xe(tb),mainWalletId:U(),headSculpture:U(),createTimestamp:Ot(),lastBitcoinAddressKey:U().optional()});ls({addressBookId:U(),name:U(),address:U(),chainList:Xe(U()).optional(),remarks:U().optional(),iconName:U().optional(),symbol:U().optional()});ls({password:U(),passwordTips:U().optional(),lastWalletActivate:eb.optional(),walletLock:Ze().optional(),fingerprintLock:Ze().optional(),fingerprintPay:Ze().optional()});const sb=d.createContext(null);function nb(){return d.useContext(sb)}const ab="keyapp_welcome_shown";function on(){localStorage.setItem(ab,"1")}function $d(){const{t}=B("guide"),{navigate:s}=re(),[n,a]=d.useState(0),r=nb(),o=d.useMemo(()=>[{icon:e.jsx(So,{className:"text-primary size-16"}),title:t("welcome.slides.transfer.title"),description:t("welcome.slides.transfer.description")},{icon:e.jsx(ko,{className:"text-primary size-16"}),title:t("welcome.slides.multichain.title"),description:t("welcome.slides.multichain.description")},{icon:e.jsx(Jm,{className:"text-primary size-16"}),title:t("welcome.slides.security.title"),description:t("welcome.slides.security.description")}],[t]),c=o[n];if(!c)return null;const i=d.useCallback(()=>{on(),s({to:"/wallet/create"})},[s]),l=d.useCallback(()=>{on(),s({to:"/onboarding/recover"})},[s]),m=d.useCallback(()=>{on(),s({to:"/onboarding/migrate"})},[s]),u=d.useCallback(()=>{on(),s({to:"/"})},[s]),f=d.useCallback(()=>{n<o.length-1&&a(y=>y+1)},[n,o.length]),h=n===o.length-1,v=r?.shouldPromptMigration;return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx("div",{className:"flex justify-end p-4",children:e.jsx(q,{variant:"ghost",size:"sm","data-testid":"skip-button",onClick:u,children:t("welcome.skip")})}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center px-8",children:[e.jsx("div",{className:"bg-primary/10 mb-8 flex size-32 items-center justify-center rounded-full",children:c.icon}),e.jsx("h1",{className:"mb-4 text-center text-2xl font-bold",children:c.title}),e.jsx("p",{className:"text-muted-foreground mb-8 max-w-sm text-center",children:c.description}),e.jsx("div",{className:"mb-8 flex gap-2",children:o.map((y,p)=>e.jsx("button",{"data-testid":`slide-dot-${p}`,onClick:()=>a(p),className:R("size-2 rounded-full transition-colors",p===n?"bg-primary":"bg-muted-foreground/30"),"aria-label":t("welcome.goToSlide",{number:p+1})},p))})]}),e.jsx("div",{className:"p-6",children:h?e.jsxs("div",{className:"flex flex-col gap-3",children:[v&&e.jsxs(q,{"data-testid":"migrate-button",onClick:m,className:"w-full",size:"lg",variant:"default",children:[e.jsx(Hs,{className:"mr-2 size-4"}),t("welcome.migrateFromMpay")]}),e.jsx(q,{"data-testid":"get-started-button",onClick:i,className:"w-full",size:"lg",variant:v?"outline":"default",children:t("welcome.getStarted")}),e.jsx(q,{"data-testid":"have-wallet-button",onClick:l,variant:"outline",className:"w-full",size:"lg",children:t("welcome.haveWallet")})]}):e.jsxs(q,{"data-testid":"next-button",onClick:f,className:"w-full",size:"lg",children:[t("welcome.next"),e.jsx(Te,{className:"ml-2 size-4"})]})})]})}$d.__docgenInfo={description:"",methods:[],displayName:"WelcomeScreen"};const qd=()=>e.jsx(ae,{children:e.jsx($d,{})});qd.__docgenInfo={description:"",methods:[],displayName:"WelcomeActivity"};function Hd(){const{t}=B(["wallet","onboarding","security","common"]),{goBack:s}=re(),n=Ae(),a=Os(),r=Be(),[o,c]=d.useState("select"),[i,l]=d.useState([]),[m,u]=d.useState([]),[f,h]=d.useState(!1),v=d.useRef(!1);d.useEffect(()=>{!v.current&&n&&(l(n.chainAddresses.map(g=>g.chain)),v.current=!0)},[n]);const y=d.useCallback(()=>{if(!n)return!1;const g=new Set(n.chainAddresses.map(j=>j.chain));return g.size!==i.length?!0:i.some(j=>!g.has(j))},[n,i]),p=d.useCallback(()=>{if(!y()){s();return}c("verify")},[y,s]),x=d.useCallback(async g=>{if(!(!n||g.length<4)){h(!1),c("saving");try{const j=gt(g);await fe.updateWalletChainAddresses(n.id,i,j,a),!i.includes(r)&&i.length>0&&fe.setSelectedChain(i[0]),c("success"),setTimeout(()=>{s()},1500)}catch(j){j instanceof Error&&j.message.includes("decrypt")?(h(!0),u([]),c("verify"),setTimeout(()=>{h(!1)},1500)):c("select")}}},[n,i,a,s]);return n?o==="saving"?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(V,{title:t("wallet:chains.title")}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx(Se,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground",children:t("wallet:chains.saving")})]})]}):o==="success"?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(V,{title:t("wallet:chains.title")}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-green-500/10",children:e.jsx(he,{className:"size-8 text-green-500"})}),e.jsx("p",{className:"font-medium",children:t("wallet:chains.success")})]})]}):o==="verify"?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(V,{title:t("wallet:chains.verifyTitle"),onBack:()=>{c("select"),u([])}}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:t("wallet:chains.verifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("wallet:chains.verifyDesc")})]}),e.jsx(Ut,{value:m,onChange:u,onComplete:x,minPoints:4,error:f,"data-testid":"wallet-chains-pattern"})]})]}):e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(V,{title:t("wallet:chains.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Fs,{icon:e.jsx(us,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:t("onboarding:chainSelector.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("onboarding:chainSelector.subtitle")})]}),a.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(Se,{})}):e.jsx(Ba,{"data-testid":"wallet-chains-selector",chains:a,selectedChains:i,onSelectionChange:l}),e.jsx(ze,{variant:"mint",className:"w-full","data-testid":"wallet-chains-save",disabled:i.length===0,onClick:p,children:y()?t("common:save"):t("common:done")})]})]}):e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(V,{title:t("wallet:chains.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx(zt,{variant:"warning",children:t("wallet:chains.noWallet")})})]})}Hd.__docgenInfo={description:"",methods:[],displayName:"WalletChainsPage"};const Ud=()=>e.jsx(ae,{children:e.jsx(Hd,{})});Ud.__docgenInfo={description:"",methods:[],displayName:"SettingsWalletChainsActivity"};function ra(t){if(t===0)return"0 B";const s=1024,n=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(s));return`${parseFloat((t/Math.pow(s,a)).toFixed(2))} ${n[a]}`}function Vd(){const{t}=B(["settings","common"]),{goBack:s}=re(),{push:n}=Y(),[a,r]=d.useState(null),[o,c]=d.useState(!0),i=d.useCallback(async()=>{c(!0);try{if(navigator.storage&&navigator.storage.estimate){const m=await navigator.storage.estimate();r({usage:m.usage??0,quota:m.quota??0})}}catch{}finally{c(!1)}},[]);d.useEffect(()=>{i()},[i]);const l=a?a.usage/a.quota*100:0;return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(V,{title:t("settings:storage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"bg-primary/10 flex size-10 items-center justify-center rounded-full",children:e.jsx(wo,{className:"text-primary size-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:t("settings:storage.usage")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:t("settings:storage.basedOn")})]})]}),o?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(ke,{className:"text-muted-foreground size-6 animate-spin"})}):a?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"bg-muted h-3 w-full overflow-hidden rounded-full",children:e.jsx("div",{className:"bg-primary h-full rounded-full transition-all",style:{width:`${Math.min(l,100)}%`}})}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[t("settings:storage.used"),": ",ra(a.usage)]}),e.jsxs("span",{className:"text-muted-foreground",children:[t("settings:storage.total"),": ",ra(a.quota)]})]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:t("settings:storage.usagePercent")}),e.jsxs("span",{className:"font-medium",children:[l.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:t("settings:storage.available")}),e.jsx("span",{className:"font-medium",children:ra(a.quota-a.usage)})]})]})]}):e.jsx("p",{className:"text-muted-foreground text-center py-4",children:t("settings:storage.unavailable")})]}),e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"font-medium mb-2",children:t("settings:storage.clearTitle")}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:t("settings:storage.clearDesc")}),e.jsxs(q,{variant:"destructive",className:"w-full",onClick:()=>n("ClearDataConfirmJob",{}),children:[e.jsx(qt,{className:"size-4 mr-2"}),t("settings:items.clearData")]})]})]})]})}Vd.__docgenInfo={description:"",methods:[],displayName:"SettingsStoragePage"};const Jd=()=>e.jsx(ae,{children:e.jsx(Vd,{})});Jd.__docgenInfo={description:"",methods:[],displayName:"SettingsStorageActivity"};const Kd=()=>{const{t}=B("common"),{pop:s}=Y(),n=we(Bt),[a,r]=d.useState(!1),[o,c]=d.useState(""),[i,l]=d.useState(""),[m,u]=d.useState(!1),[f,h]=d.useState(null),v=async()=>{if(!o.trim()){h(t("sources.enterUrl"));return}let g;try{g=new URL(o).toString()}catch{h(t("sources.invalidUrl"));return}if(n.sources.some(j=>j.url===g)){h(t("sources.alreadyExists"));return}je.addSource(g,i||t("sources.customSource")),c(""),l(""),r(!1),h(null),Cg(g)},y=g=>{je.removeSource(g)},p=g=>{je.toggleSource(g)},x=async()=>{u(!0);try{await cr()}catch{}u(!1)};return e.jsx(ae,{children:e.jsxs("div",{className:"bg-background flex min-h-full flex-col",children:[e.jsx("div",{className:"bg-background sticky top-0 z-10 border-b",children:e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[e.jsx("button",{onClick:()=>s(),className:"hover:bg-muted rounded-full p-1.5 transition-colors","aria-label":t("back"),children:e.jsx(ho,{className:"size-5",stroke:1.5})}),e.jsx("h1",{className:"flex-1 text-lg font-semibold",children:t("sources.title")}),e.jsx("button",{onClick:x,disabled:m,className:"hover:bg-muted rounded-full p-1.5 transition-colors","aria-label":t("refresh"),children:e.jsx(Vt,{className:R("size-5",m&&"animate-spin"),stroke:1.5})})]})}),e.jsxs("div",{className:"flex-1 space-y-3 p-4",children:[n.sources.map(g=>e.jsx(rb,{source:g,onToggle:()=>p(g.url),onRemove:()=>y(g.url)},g.url)),n.sources.length===0&&e.jsx("div",{className:"text-muted-foreground py-12 text-center",children:t("sources.noSources")})]}),a?e.jsxs("div",{className:"bg-background space-y-3 border-t p-4",children:[e.jsx("input",{type:"url",value:o,onChange:g=>{c(g.target.value),h(null)},placeholder:t("sources.urlPlaceholder"),className:"bg-background focus:ring-primary w-full rounded-lg border px-3 py-2 focus:ring-2 focus:outline-none"}),e.jsx("input",{type:"text",value:i,onChange:g=>l(g.target.value),placeholder:t("sources.namePlaceholder"),className:"bg-background focus:ring-primary w-full rounded-lg border px-3 py-2 focus:ring-2 focus:outline-none"}),f&&e.jsx("p",{className:"text-destructive text-sm",children:f}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{r(!1),c(""),l(""),h(null)},className:"bg-muted hover:bg-muted/80 flex-1 rounded-lg py-2 font-medium",children:t("cancel")}),e.jsx("button",{onClick:v,className:"bg-primary text-primary-foreground hover:bg-primary/90 flex-1 rounded-lg py-2 font-medium",children:t("add")})]})]}):e.jsx("div",{className:"border-t p-4",children:e.jsxs("button",{onClick:()=>r(!0),className:"border-muted-foreground/30 hover:border-primary hover:bg-primary/5 text-muted-foreground hover:text-primary flex w-full items-center justify-center gap-2 rounded-xl border-2 border-dashed py-3 transition-colors",children:[e.jsx(nt,{className:"size-5",stroke:1.5}),e.jsx("span",{children:t("sources.addSource")})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};function rb({source:t,onToggle:s,onRemove:n}){const{t:a}=B("common"),r=t.url.includes("ecosystem.json"),o={idle:null,loading:e.jsx(ke,{className:"text-muted-foreground size-3 animate-spin"}),success:e.jsx(he,{className:"size-3 text-green-500"}),error:e.jsx(vt,{className:"size-3 text-red-500"})}[t.status];return e.jsx("div",{className:R("rounded-xl border p-4 transition-colors",t.enabled?"bg-card":"bg-muted/30 opacity-60"),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/10 shrink-0 rounded-full p-2",children:e.jsx(Ao,{className:"text-primary size-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"truncate font-medium",children:t.name}),r&&e.jsx("span",{className:"bg-primary/10 text-primary rounded px-1.5 py-0.5 text-xs",children:a("sources.official")}),o]}),e.jsx("p",{className:"text-muted-foreground mt-0.5 truncate text-sm",children:t.url}),e.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:a("sources.updatedAt",{date:new Date(t.lastUpdated).toLocaleString()})}),t.status==="error"&&t.errorMessage&&e.jsx("p",{className:"truncate text-xs text-red-500",children:t.errorMessage})]})]}),e.jsxs("div",{className:"flex shrink-0 items-center gap-1",children:[e.jsx("button",{onClick:s,className:R("rounded-full p-2 transition-colors",t.enabled?"bg-green-100 text-green-600 hover:bg-green-200":"bg-muted text-muted-foreground hover:bg-muted/80"),"aria-label":t.enabled?a("disable"):a("enable"),children:t.enabled?e.jsx(he,{className:"size-4",stroke:2}):e.jsx(Us,{className:"size-4",stroke:2})}),!r&&e.jsx("button",{onClick:n,className:"text-muted-foreground hover:text-destructive hover:bg-destructive/10 rounded-full p-2 transition-colors","aria-label":a("delete"),children:e.jsx(qt,{className:"size-4",stroke:1.5})})]})]})})}Kd.__docgenInfo={description:"",methods:[],displayName:"SettingsSourcesActivity"};function ib({permission:t,isLast:s}){const a=tm[t]?.risk??"medium",r=sm(t),o=a==="high"?_e:co,c=a==="high"?"text-red-500":a==="medium"?"text-amber-500":"text-green-500";return e.jsxs("div",{className:R("flex items-start gap-3 py-3",!s&&"border-border/50 border-b"),children:[e.jsx(o,{className:R("mt-0.5 size-5 shrink-0",c),stroke:1.5}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:r.label}),e.jsx("p",{className:"text-muted-foreground mt-0.5 text-xs",children:r.description})]})]})}function Yt({label:t,value:s,isLink:n=!1,href:a}){const r=e.jsxs("div",{className:"border-border/50 flex items-center justify-between border-b py-3 last:border-0",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t}),e.jsxs("span",{className:R("text-sm font-medium",n&&"text-primary flex items-center gap-1"),children:[s,n&&e.jsx(Te,{className:"size-4"})]})]});return n&&a?e.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",children:r}):r}const Gd=({params:t})=>{const{pop:s}=Y(),{t:n}=B("ecosystem"),[a,r]=d.useState(null),[o,c]=d.useState(!0),[i,l]=d.useState(!1),m=we(Bt,p=>Ia.isAppInstalled(p,t.appId));d.useEffect(()=>{let p=!1;return(async()=>{c(!0),await Vc();let g=ji(t.appId);g||(await cr({force:!1}),g=ji(t.appId)),!p&&(r(g??null),c(!1))})(),()=>{p=!0}},[t.appId]);const u=d.useCallback(()=>{a&&je.installApp(a.id)},[a]),f=d.useCallback(()=>{a&&(je.updateAppLastUsed(a.id),je.setActiveSubPage("mine"),eo(a.id,{...a,targetDesktop:"mine"}),s())},[a,s]);if(o)return e.jsx(ae,{children:e.jsx("div",{className:"bg-background flex min-h-screen items-center justify-center",children:e.jsx(Se,{size:"lg"})})});if(!a)return e.jsx(ae,{children:e.jsxs("div",{className:"bg-background flex min-h-screen flex-col items-center justify-center gap-4",children:[e.jsx("p",{className:"text-muted-foreground",children:n("detail.notFound")}),e.jsx("button",{onClick:()=>s(),className:"bg-primary text-primary-foreground rounded-full px-4 py-2 text-sm font-medium",children:n("detail.back")})]})});const h=a.longDescription??a.description,v=h.length>150,y=i||!v?h:h.slice(0,150)+"...";return e.jsx(ae,{children:e.jsxs("div",{className:"bg-background detail-scroll-container flex min-h-screen flex-col",children:[e.jsx("div",{className:"bg-background/80 border-border/50 sticky top-0 z-20 border-b backdrop-blur-xl",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[e.jsx("button",{onClick:()=>s(),className:"hover:bg-muted -ml-1.5 rounded-full p-1.5 transition-colors",children:e.jsx(ho,{className:"size-5",stroke:1.5})}),e.jsx("span",{className:"detail-header-title max-w-[200px] truncate font-semibold",children:a.name}),e.jsx("button",{className:"hover:bg-muted -mr-1.5 rounded-full p-1.5 transition-colors",children:e.jsx(Ms,{className:"size-5",stroke:1.5})})]})}),e.jsxs("div",{className:"detail-scroller flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"px-5 pt-4 pb-5",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(am,{src:a.icon,name:a.name,size:"2xl",shadow:"lg",className:"shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1 pt-1",children:[e.jsx("h1",{className:"truncate text-xl font-bold",children:a.name}),e.jsx("p",{className:"text-muted-foreground mt-0.5 truncate text-sm",children:a.author??n("detail.unknownDeveloper")}),m?e.jsx("button",{onClick:f,className:"bg-primary text-primary-foreground mt-4 rounded-full px-8 py-2 text-sm font-semibold",children:n("detail.open")}):e.jsx("button",{onClick:u,className:"bg-primary text-primary-foreground mt-4 rounded-full px-8 py-2 text-sm font-semibold",children:n("detail.get")})]})]}),e.jsxs("div",{className:"text-muted-foreground mt-5 flex items-center gap-4 text-xs",children:[a.category&&e.jsx("span",{className:"text-foreground font-medium",children:n(`detail.categories.${a.category}`,{defaultValue:a.category})}),a.beta&&e.jsx("span",{className:"rounded-full bg-amber-100 px-2 py-0.5 font-medium text-amber-700 dark:bg-amber-900/30 dark:text-amber-400",children:n("detail.beta")}),e.jsxs("span",{children:["v",a.version]})]})]}),a.screenshots&&a.screenshots.length>0&&e.jsx("div",{className:"border-border/50 border-t",children:e.jsxs("div",{className:"px-5 py-4",children:[e.jsx("h2",{className:"mb-4 text-lg font-bold",children:n("detail.preview")}),e.jsx("div",{className:"-mx-5 flex snap-x snap-mandatory gap-3 overflow-x-auto px-5 pb-2",style:{scrollbarWidth:"none"},children:a.screenshots.map((p,x)=>e.jsx("div",{className:"bg-muted aspect-[9/19.5] w-[220px] shrink-0 snap-center overflow-hidden rounded-2xl shadow-lg ring-1 ring-black/5",children:e.jsx("img",{src:p,alt:`${a.name} screenshot ${x+1}`,className:"h-full w-full object-cover",loading:"lazy",onError:g=>{const j=g.currentTarget.parentElement;j&&(j.style.display="none")}})},p))})]})}),e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:y}),v&&e.jsxs("button",{onClick:()=>l(!i),className:"text-primary mt-2 flex items-center gap-1 text-sm font-medium",children:[n(i?"detail.collapse":"detail.more"),i?e.jsx(no,{className:"size-4"}):e.jsx(ro,{className:"size-4"})]})]}),a.chains&&a.chains.length>0&&e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("h2",{className:"mb-3 text-lg font-bold",children:n("detail.supportedChains")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.chains.map(p=>e.jsx("span",{className:"bg-muted rounded-full px-3 py-1.5 text-sm font-medium",children:p},p))})]}),a.permissions&&a.permissions.length>0&&e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("h2",{className:"mb-1 text-lg font-bold",children:n("detail.privacy")}),e.jsx("p",{className:"text-muted-foreground mb-4 text-xs",children:n("detail.privacyHint")}),e.jsx("div",{className:"bg-muted/50 rounded-2xl px-4",children:a.permissions.map((p,x)=>e.jsx(ib,{permission:p,isLast:x===a.permissions.length-1},p))})]}),a.tags&&a.tags.length>0&&e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("h2",{className:"mb-3 text-lg font-bold",children:n("detail.tags")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.tags.map(p=>e.jsx("span",{className:"bg-primary/10 text-primary rounded-full px-3 py-1.5 text-sm font-medium",children:n("detail.tagLabel",{tag:p})},p))})]}),e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("h2",{className:"mb-2 text-lg font-bold",children:n("detail.info")}),e.jsxs("div",{className:"bg-muted/50 rounded-2xl px-4",children:[a.author&&e.jsx(Yt,{label:n("detail.developer"),value:a.author}),e.jsx(Yt,{label:n("detail.version"),value:a.version}),a.category&&e.jsx(Yt,{label:n("detail.category"),value:n(`detail.categories.${a.category}`,{defaultValue:a.category})}),a.publishedAt&&e.jsx(Yt,{label:n("detail.publishedAt"),value:a.publishedAt}),a.updatedAt&&e.jsx(Yt,{label:n("detail.updatedAt"),value:a.updatedAt}),a.website&&e.jsx(Yt,{label:n("detail.website"),value:n("detail.visit"),isLink:!0,href:a.website})]})]}),e.jsx("div",{className:"h-8"})]})]})})};Gd.__docgenInfo={description:"",methods:[],displayName:"MiniappDetailActivity"};function Ds({className:t,...s}){return e.jsx("label",{"data-slot":"label",className:R("gap-2 text-sm leading-none font-medium group-data-[disabled=true]:opacity-50 peer-disabled:opacity-50 flex items-center select-none group-data-[disabled=true]:pointer-events-none peer-disabled:cursor-not-allowed",t),...s})}Ds.__docgenInfo={description:"",methods:[],displayName:"Label"};function Qs({className:t,size:s="default",...n}){return e.jsx("div",{"data-slot":"card","data-size":s,className:R("ring-foreground/10 bg-card text-card-foreground gap-4 overflow-hidden rounded-xl py-4 text-sm ring-1 has-data-[slot=card-footer]:pb-0 has-[>img:first-child]:pt-0 data-[size=sm]:gap-3 data-[size=sm]:py-3 data-[size=sm]:has-data-[slot=card-footer]:pb-0 *:[img:first-child]:rounded-t-xl *:[img:last-child]:rounded-b-xl group/card flex flex-col",t),...n})}function Ys({className:t,...s}){return e.jsx("div",{"data-slot":"card-content",className:R("px-4 group-data-[size=sm]/card:px-3",t),...s})}Qs.__docgenInfo={description:"",methods:[],displayName:"Card",props:{size:{required:!1,tsType:{name:"union",raw:'"default" | "sm"',elements:[{name:"literal",value:'"default"'},{name:"literal",value:'"sm"'}]},description:"",defaultValue:{value:'"default"',computed:!1}}}};Ys.__docgenInfo={description:"",methods:[],displayName:"CardContent"};function ob({queryAddress:t,queryChain:s}){const{t:n}=B(["common"]),a=Ws(),r=Kt(),{data:o,isLoading:c,error:i}=r.nativeBalance.useState({address:t},{enabled:!!t});return e.jsx(Qs,{className:R("transition-all",c&&"opacity-50"),children:e.jsx(Ys,{className:"pt-6",children:i?e.jsxs("div",{className:"flex items-center gap-3 text-destructive",children:[e.jsx(vt,{className:"size-5 shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:n("common:addressLookup.error")}),e.jsx("div",{className:"text-sm opacity-80",children:i.message})]})]}):o?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-primary/10 flex size-12 items-center justify-center rounded-full",children:e.jsx(ff,{className:"text-primary size-6"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[o.amount.toFormatted()," ",o.symbol]}),e.jsx("div",{className:"text-muted-foreground text-sm",children:n("common:addressLookup.onChain",{chain:a.find(l=>l.id===s)?.name??s})})]})]}):c?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx(Se,{size:"lg"})}):null})})}function Qd(){const{t}=B(["common","wallet"]),{goBack:s}=re(),n=Ws(),[a,r]=d.useState("ethereum"),[o,c]=d.useState(""),[i,l]=d.useState(""),[m,u]=d.useState(""),[f,h]=d.useState(!1),v=d.useCallback(()=>{o.trim()&&(h(!0),l(o.trim()),u(a),setTimeout(()=>h(!1),100))},[o,a]),y=d.useCallback(g=>{g.key==="Enter"&&v()},[v]),p=n.filter(g=>g.chainKind==="evm"),x=n.filter(g=>g.chainKind!=="evm");return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(V,{title:t("common:addressLookup.balanceTitle"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ds,{children:t("common:addressLookup.chain")}),e.jsxs(Ts,{value:a,onValueChange:g=>g&&r(g),children:[e.jsx(Ps,{children:e.jsx(Es,{})}),e.jsxs(_s,{children:[p.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:"EVM"}),p.map(g=>e.jsx(Wt,{value:g.id,children:g.name},g.id))]}),x.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:t("common:addressLookup.otherChains")}),x.map(g=>e.jsx(Wt,{value:g.id,children:g.name},g.id))]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ds,{children:t("common:addressLookup.address")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(De,{placeholder:t("common:addressLookup.addressPlaceholder"),value:o,onChange:g=>c(g.target.value),onKeyDown:y,className:"flex-1 font-mono text-sm"}),e.jsx(q,{onClick:v,disabled:!o.trim()||f,children:f?e.jsx(Se,{size:"sm"}):e.jsx(qs,{className:"size-4"})})]})]}),i&&m&&e.jsx(jt,{chainId:m,fallback:e.jsx(Qs,{children:e.jsx(Ys,{className:"pt-6",children:e.jsx("p",{className:"text-muted-foreground text-center",children:"Chain not supported"})})}),children:e.jsx(ob,{queryAddress:i,queryChain:m})}),!1]})]})}Qd.__docgenInfo={description:"",methods:[],displayName:"AddressBalancePage"};const Yd=()=>e.jsx(ae,{children:e.jsx(Qd,{})});Yd.__docgenInfo={description:"",methods:[],displayName:"AddressBalanceActivity"};function cb(t,s){return(parseFloat(t)/Math.pow(10,s)).toLocaleString(void 0,{maximumFractionDigits:6})}function lb(t){return new Date(t).toLocaleString()}function db({tx:t,address:s}){const{t:n}=B("common"),a=t.direction==="out"||t.from.toLowerCase()===s.toLowerCase(),r=t.assets.find(u=>u.assetType==="native"||u.assetType==="token"),o=r?r.value:"0",c=r?r.symbol:"",i=r?r.decimals:0,l=n(a?"signSymbol.minus":"signSymbol.plus"),m=n(a?"addressLookup.toLabel":"addressLookup.fromLabel");return e.jsxs("div",{className:"flex items-center gap-3 py-3 border-b last:border-b-0",children:[e.jsx("div",{className:`p-2 rounded-full ${a?"bg-red-100 text-red-600":"bg-green-100 text-green-600"}`,children:a?e.jsx(jo,{className:"size-4"}):e.jsx(Xm,{className:"size-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"text-sm font-medium truncate",children:[m," ",a?t.to:t.from]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:lb(t.timestamp)})]}),e.jsxs("div",{className:`text-sm font-medium ${a?"text-red-600":"text-green-600"}`,children:[l,cb(o,i)," ",c]})]})}function ub({searchAddress:t,selectedChain:s,explorerUrl:n,onOpenExplorer:a}){const{t:r}=B(["common"]),o=Ws(),c=d.useMemo(()=>o.find(h=>h.id===s),[o,s]),i=Kt(),{data:l,isLoading:m,error:u}=i.transactionHistory.useState({address:t,limit:50},{enabled:!!t}),f=!(u instanceof Qi);return e.jsx(Qs,{children:e.jsxs(Ys,{className:"pt-6",children:[m?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ke,{className:"size-6 animate-spin text-muted-foreground"})}):u?e.jsx("div",{className:"text-center py-8 text-destructive",children:r("common:addressLookup.queryError")}):l&&l.length>0?e.jsx("div",{className:"divide-y",children:l.map(h=>e.jsx(db,{tx:h,address:t},h.hash))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:f?e.jsx("p",{children:r("common:addressLookup.noTransactions")}):e.jsx("p",{children:r("common:addressLookup.useExplorerHint")})}),n&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs(q,{variant:f?"outline":"default",size:"sm",className:"w-full gap-2",onClick:a,children:[e.jsx(oa,{className:"size-4"}),r("common:addressLookup.viewOnExplorer",{name:c?.name??s})]})})]})})}function Xd(){const{t}=B(["common","wallet"]),{goBack:s}=re(),n=Ws(),[a,r]=d.useState("bfmeta"),[o,c]=d.useState(""),[i,l]=d.useState(""),[m,u]=d.useState(""),f=d.useMemo(()=>n.find(j=>j.id===m),[n,m]),h=d.useMemo(()=>{if(!f?.explorer||!i.trim())return null;const{queryAddress:j,url:N}=f.explorer;return j?j.replace(":address",i.trim()):`${N}/address/${i.trim()}`},[f,i]),v=d.useCallback(()=>{o.trim()&&(l(o.trim()),u(a))},[o,a]),y=d.useCallback(j=>{j.key==="Enter"&&v()},[v]),p=d.useCallback(()=>{h&&window.open(h,"_blank","noopener,noreferrer")},[h]),x=n.filter(j=>j.chainKind==="evm"),g=n.filter(j=>j.chainKind!=="evm");return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(V,{title:t("common:addressLookup.transactionsTitle"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ds,{children:t("common:addressLookup.chain")}),e.jsxs(Ts,{value:a,onValueChange:j=>j&&r(j),children:[e.jsx(Ps,{children:e.jsx(Es,{})}),e.jsxs(_s,{children:[x.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:"EVM"}),x.map(j=>e.jsx(Wt,{value:j.id,children:j.name},j.id))]}),g.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:t("common:addressLookup.otherChains")}),g.map(j=>e.jsx(Wt,{value:j.id,children:j.name},j.id))]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ds,{children:t("common:addressLookup.address")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(De,{placeholder:t("common:addressLookup.addressPlaceholder"),value:o,onChange:j=>c(j.target.value),onKeyDown:y,className:"flex-1 font-mono text-sm"}),e.jsx(q,{onClick:v,disabled:!o.trim(),children:e.jsx(qs,{className:"size-4"})})]})]}),i&&m&&e.jsx(jt,{chainId:m,fallback:e.jsx(Qs,{children:e.jsx(Ys,{className:"pt-6",children:e.jsx("p",{className:"text-muted-foreground text-center",children:"Chain not supported"})})}),children:e.jsx(ub,{searchAddress:i,selectedChain:m,explorerUrl:h,onOpenExplorer:p})})]})]})}Xd.__docgenInfo={description:"",methods:[],displayName:"AddressTransactionsPage"};const Zd=()=>e.jsx(ae,{children:e.jsx(Xd,{})});Zd.__docgenInfo={description:"",methods:[],displayName:"AddressTransactionsActivity"};const{useFlow:Y}=dh({transitionDuration:350,plugins:[uh(),Dh({theme:"cupertino"}),Xx({routes:{MainTabsActivity:"/",WalletListActivity:"/wallet/list",WalletConfigActivity:"/wallet/:walletId",WalletCreateActivity:"/wallet/create",SendActivity:"/send",DestroyActivity:"/destroy",ReceiveActivity:"/receive",SettingsActivity:"/settings",SettingsLanguageActivity:"/settings/language",SettingsCurrencyActivity:"/settings/currency",SettingsChainsActivity:"/settings/chains",SettingsMnemonicActivity:"/settings/mnemonic",SettingsWalletLockActivity:"/settings/wallet-lock",SettingsWalletChainsActivity:"/settings/wallet-chains",SettingsStorageActivity:"/settings/storage",HistoryActivity:"/history",TransactionDetailActivity:"/transaction/:txId",ScannerActivity:"/scanner",AuthorizeAddressActivity:"/authorize/address/:id",AuthorizeSignatureActivity:"/authorize/signature/:id",OnboardingRecoverActivity:"/onboarding/recover",TokenDetailActivity:"/token/:tokenId",AddressBookActivity:"/address-book",MyCardActivity:"/my-card",NotificationsActivity:"/notifications",StakingActivity:"/staking",WelcomeActivity:"/welcome",SettingsSourcesActivity:"/settings/sources",MiniappDetailActivity:"/miniapp/:appId/detail",AddressBalanceActivity:"/address-balance",AddressTransactionsActivity:"/address-transactions",ChainSelectorJob:"/job/chain-selector",WalletRenameJob:"/job/wallet-rename/:walletId",WalletDeleteJob:"/job/wallet-delete/:walletId",WalletLockConfirmJob:"/job/wallet-lock-confirm",TwoStepSecretConfirmJob:"/job/two-step-secret-confirm",SetTwoStepSecretJob:"/job/set-two-step-secret",MnemonicOptionsJob:"/job/mnemonic-options",ContactEditJob:"/job/contact-edit",ContactPickerJob:"/job/contact-picker",WalletAddJob:"/job/wallet-add",WalletListJob:"/job/wallet-list",SecurityWarningJob:"/job/security-warning",TransferConfirmJob:"/job/transfer-confirm",TransferWalletLockJob:"/job/transfer-wallet-lock",FeeEditJob:"/job/fee-edit",ScannerJob:"/job/scanner",ContactAddConfirmJob:"/job/contact-add-confirm",ContactShareJob:"/job/contact-share",ClearDataConfirmJob:"/job/clear-data-confirm",WalletPickerJob:"/job/wallet-picker",SigningConfirmJob:"/job/signing-confirm",PermissionRequestJob:"/job/permission-request",MiniappTransferConfirmJob:"/job/miniapp-transfer-confirm",MiniappDestroyConfirmJob:"/job/miniapp-destroy-confirm",MiniappSignTransactionJob:"/job/miniapp-sign-transaction",ChainSwitchConfirmJob:"/job/chain-switch-confirm",CryptoAuthorizeJob:"/job/crypto-authorize"},fallbackActivity:()=>"MainTabsActivity",useHash:!0,urlPatternOptions:{segmentValueCharset:"a-zA-Z0-9-._~ %"}})],activities:{MainTabsActivity:Pl,WalletListActivity:_l,WalletConfigActivity:Ml,WalletCreateActivity:Ll,SendActivity:Wl,DestroyActivity:$l,ReceiveActivity:Hl,SettingsActivity:Ul,SettingsLanguageActivity:Jl,SettingsCurrencyActivity:Gl,SettingsChainsActivity:od,SettingsMnemonicActivity:ld,SettingsWalletLockActivity:ud,SettingsWalletChainsActivity:Ud,SettingsStorageActivity:Jd,HistoryActivity:fd,TransactionDetailActivity:hd,ScannerActivity:gd,AuthorizeAddressActivity:bd,AuthorizeSignatureActivity:Nd,OnboardingRecoverActivity:kd,TokenDetailActivity:Ad,AddressBookActivity:Td,MyCardActivity:_d,NotificationsActivity:Rd,StakingActivity:Fd,WelcomeActivity:qd,SettingsSourcesActivity:Kd,MiniappDetailActivity:Gd,AddressBalanceActivity:Yd,AddressTransactionsActivity:Zd,ChainSelectorJob:Qc,WalletRenameJob:Xc,WalletDeleteJob:Zc,WalletLockConfirmJob:el,TwoStepSecretConfirmJob:tl,SetTwoStepSecretJob:al,MnemonicOptionsJob:rl,ContactEditJob:il,ContactPickerJob:ol,WalletAddJob:cl,WalletListJob:ll,SecurityWarningJob:dl,TransferConfirmJob:ml,TransferWalletLockJob:pl,FeeEditJob:nl,ScannerJob:hl,ContactAddConfirmJob:xl,ContactShareJob:gl,ClearDataConfirmJob:vl,WalletPickerJob:yl,SigningConfirmJob:bl,PermissionRequestJob:jl,MiniappTransferConfirmJob:Nl,MiniappDestroyConfirmJob:kl,MiniappSignTransactionJob:Sl,ChainSwitchConfirmJob:Al,CryptoAuthorizeJob:Il}});function mb(t,s){const n=Math.abs(t-s);return Math.min(n,360-n)}function fb(t,s,n=30){if(s.length===0)return 1;let a=180;for(const r of s){const o=mb(t,r);o<a&&(a=o)}return a<n?a/n:1}function pb(t){return ou.map(s=>({...s,weight:fb(s.hue,t)}))}const hb="wallet-config-preview-name";function Fn({mode:t,walletId:s,onEditOnlyComplete:n,className:a}){const{t:r}=B(["wallet","onboarding","common"]),{push:o}=Y(),c=yt(),i=c.find(M=>M.id===s),l=Be(),m=Hi(),u=Ft(),[f,h]=d.useState(t==="edit-only"?"edit":t),[v,y]=d.useState(""),[p,x]=d.useState(0),g=d.useRef(null),[j,N]=d.useState(!1),b=d.useMemo(()=>c.filter(M=>M.id!==s).map(M=>M.themeHue),[c,s]),S=d.useMemo(()=>pb(b),[b]);d.useEffect(()=>{i&&(y(i.name),x(i.themeHue))},[i]);const w=d.useMemo(()=>i?.chainAddresses.find(M=>M.chain===l)??i?.chainAddresses[0],[i,l]),I=d.useCallback(M=>{if(!g.current)return;const O=g.current.getBoundingClientRect(),te=Math.max(0,Math.min(M-O.left,O.width))/O.width,W=Math.round(te*3600)/10;x(W)},[]),E=M=>{M.stopPropagation(),N(!0),I(M.clientX)},A=M=>{M.stopPropagation(),N(!0),M.touches[0]&&I(M.touches[0].clientX)};d.useEffect(()=>{if(!j)return;const M=te=>I(te.clientX),O=te=>{te.touches[0]&&I(te.touches[0].clientX)},Q=()=>N(!1);return document.addEventListener("mousemove",M),document.addEventListener("mouseup",Q),document.addEventListener("touchmove",O),document.addEventListener("touchend",Q),()=>{document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",Q),document.removeEventListener("touchmove",O),document.removeEventListener("touchend",Q)}},[j,I]);const P=d.useCallback(()=>{o("ChainSelectorJob",{})},[o]),k=d.useCallback(()=>{i&&(y(i.name),x(i.themeHue)),h("edit")},[i]),T=d.useCallback(async()=>{if(!i)return;const M=v.trim();M&&M!==i.name&&await fe.updateWalletName(i.id,M),p!==i.themeHue&&await fe.updateWalletThemeHue(i.id,p),h("default")},[i,v,p]),C=d.useCallback(()=>{i&&(y(i.name),x(i.themeHue)),h("default")},[i]),_=d.useCallback(async()=>{if(!i)return;const M=v.trim();M&&M!==i.name&&await fe.updateWalletName(i.id,M),p!==i.themeHue&&await fe.updateWalletThemeHue(i.id,p),n?.()},[i,v,p,n]),z=d.useCallback(async()=>{i&&(await fe.setCurrentWallet(i.id),o("SettingsMnemonicActivity",{}))},[i,o]),D=d.useCallback(()=>{i&&o("WalletDeleteJob",{walletId:i.id})},[i,o]);if(!i)return e.jsx("div",{className:R("text-muted-foreground p-4 text-center",a),children:r("wallet:detail.notFound")});const L=f==="edit"||t==="edit-only"?p:i.themeHue,J=f==="edit"||t==="edit-only";return e.jsxs("div",{className:R("space-y-6",a),children:[e.jsx("div",{className:"flex justify-center px-4",children:e.jsx("div",{className:"aspect-[1.6/1] w-full max-w-[360px]",children:e.jsx(Ui,{wallet:{...i,name:J?v:i.name,themeHue:L},themeHue:L,walletNameTestId:hb,chain:w?.chain,chainName:w?.chain||"",address:w?.address||i.address,chainIconUrl:m[w?.chain??""],onOpenChainSelector:P})})}),J?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm",children:r("onboarding:theme.walletName")}),e.jsxs(wu,{children:[e.jsx(Cu,{value:v,onChange:M=>y(M.target.value),placeholder:r("wallet:defaultName"),maxLength:20,className:"text-center"}),e.jsx(ku,{align:"inline-end",children:e.jsx(Su,{size:"icon-xs",variant:"ghost",onClick:()=>y(r("onboarding:create.generatedNamePattern",{word:gn(u),suffix:r("onboarding:create.walletSuffix")})),title:r("wallet:randomName"),children:e.jsx(vf,{className:"size-4"})})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:r("onboarding:theme.customColor")}),e.jsxs("span",{className:"text-muted-foreground font-mono",children:[p.toFixed(1),""]})]}),e.jsxs("div",{ref:g,className:"relative h-8 cursor-pointer touch-none rounded-full",style:{background:"linear-gradient(to right, oklch(0.6 0.25 0), oklch(0.6 0.25 60), oklch(0.6 0.25 120), oklch(0.6 0.25 180), oklch(0.6 0.25 240), oklch(0.6 0.25 300), oklch(0.6 0.25 360))"},onMouseDown:E,onTouchStart:A,children:[b.map((M,O)=>e.jsx("div",{className:"absolute top-0 h-full w-0.5 bg-black/30",style:{left:`${M/360*100}%`},title:r("onboarding:theme.usedColor")},O)),e.jsx("div",{className:"absolute top-1/2 -translate-x-1/2 -translate-y-1/2",style:{left:`${p/360*100}%`},children:e.jsx("div",{className:"size-6 rounded-full border-2 border-white shadow-md",style:{backgroundColor:`oklch(0.6 0.25 ${p})`}})})]})]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-3",children:S.map(M=>{const O=Math.abs(p-M.hue)<.5,Q=M.weight<.5;return e.jsx("button",{type:"button",onClick:()=>x(M.hue),className:R("relative size-10 rounded-full transition-all","ring-offset-background focus-visible:ring-ring focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:outline-none",O&&"ring-primary ring-2 ring-offset-2",Q&&"opacity-50"),style:{backgroundColor:M.color},title:r(M.nameKey),children:O&&e.jsx(he,{className:"absolute inset-0 m-auto size-5 text-white drop-shadow-md"})},M.hue)})})]}),t==="edit-only"?e.jsx(q,{className:"w-full",onClick:_,disabled:!v.trim(),"data-testid":"theme-complete-button",style:{"--primary-hue":p,"--primary":`oklch(var(--primary-lightness) var(--primary-saturation) ${p})`},children:r("common:confirm")}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx(q,{variant:"outline",className:"flex-1",onClick:C,children:r("common:cancel")}),e.jsx(q,{className:"flex-1",onClick:T,disabled:!v.trim(),style:{"--primary-hue":p,"--primary":`oklch(var(--primary-lightness) var(--primary-saturation) ${p})`},children:r("common:save")})]})]}):e.jsxs("div",{className:"flex justify-center gap-8",children:[e.jsxs("button",{onClick:k,className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"bg-primary/10 text-primary group-hover:bg-primary/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:e.jsx(Rf,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:r("wallet:detail.editName")})]}),e.jsxs("button",{onClick:z,className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"bg-primary/10 text-primary group-hover:bg-primary/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:e.jsx(Oa,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:r("wallet:detail.exportMnemonic")})]}),e.jsxs("button",{onClick:D,className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"bg-destructive/10 text-destructive group-hover:bg-destructive/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:e.jsx(qt,{className:"size-5"})}),e.jsx("span",{className:"text-destructive text-xs font-medium",children:r("wallet:detail.deleteWallet")})]})]})]})}Fn.__docgenInfo={description:`
- default: + edit
- edit:  default  default
- edit-only: / onEditOnlyComplete`,methods:[],displayName:"WalletConfig",props:{mode:{required:!0,tsType:{name:"union",raw:"'edit-only' | 'default' | 'edit'",elements:[{name:"literal",value:"'edit-only'"},{name:"literal",value:"'default'"},{name:"literal",value:"'edit'"}]},description:""},walletId:{required:!0,tsType:{name:"string"},description:""},onEditOnlyComplete:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};export{Id as A,id as C,Fl as D,kf as I,Vl as L,Ed as M,Md as N,ql as R,Ne as S,pd as T,cd as V,Fn as W,Xd as a,md as b,dd as c,Kl as d,vs as e,dr as f,El as g};
