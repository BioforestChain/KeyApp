import{r as a,u as X,j as e}from"./iframe-CLYHcCRY.js";import{c as f}from"./utils-CDN07tui.js";import{C as E,g as G}from"./contact-avatar-Dld7FrOF.js";import{c as H}from"./web-DodBcwRj.js";import{i as J}from"./address-format-DY2duW3A.js";import{d as F,e as Y}from"./chain-config-CJhdu2xl.js";import{u as Z}from"./useTranslation-Cb2TYd22.js";import{I as ee}from"./IconX-wx2JE-kR.js";import{c as C}from"./createReactComponent-wBEFsRbv.js";const te=[["path",{d:"M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h3m9 -9v-5a2 2 0 0 0 -2 -2h-2",key:"svg-0"}],["path",{d:"M13 17v-1a1 1 0 0 1 1 -1h1m3 0h1a1 1 0 0 1 1 1v1m0 3v1a1 1 0 0 1 -1 1h-1m-3 0h-1a1 1 0 0 1 -1 -1v-1",key:"svg-1"}],["path",{d:"M9 3m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v0a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z",key:"svg-2"}]],ne=C("outline","clipboard-copy","ClipboardCopy",te);const se=[["path",{d:"M4 8v-2a2 2 0 0 1 2 -2h2",key:"svg-0"}],["path",{d:"M4 16v2a2 2 0 0 0 2 2h2",key:"svg-1"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v2",key:"svg-2"}],["path",{d:"M16 20h2a2 2 0 0 0 2 -2v-2",key:"svg-3"}],["path",{d:"M7 12h10",key:"svg-4"}]],ae=C("outline","line-scan","LineScan",se);const re=[["path",{d:"M9 7m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2",key:"svg-1"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"svg-2"}],["path",{d:"M21 21v-2a4 4 0 0 0 -3 -3.85",key:"svg-3"}]],oe=C("outline","users","Users",re);function z(s){return s.label||""}function de(s){return!!(!s||s.startsWith("0x")&&s.length===42||s.startsWith("T")&&s.length===34||(s.startsWith("1")||s.startsWith("3")||s.startsWith("bc1"))&&s.length>=26||s.length>=20)}const _=a.forwardRef(({value:s="",onChange:c,onScan:j,onPaste:$,onContactPicker:N,error:A,label:I,className:B,chainType:b,showSuggestions:h=!0,maxSuggestions:M=5,...L},R)=>{const[y,S]=a.useState(!1),[W,x]=a.useState(s),[v,l]=a.useState(!1),[o,k]=a.useState(-1),w=a.useRef(null),{t:d}=Z("common"),T=a.useId(),V=a.useId(),u=X(Y),q=u.contacts.length>0,i=s||W,P=de(i),g=!!(A||!P&&i),m=a.useMemo(()=>i?F.getContactByAddress(u,i):null,[u,i]),r=a.useMemo(()=>h?F.suggestContacts(u,i||"",M).map(n=>({...n,isValidForCurrentChain:b?J(n.matchedAddress.address,b):!0})):[],[u,i,b,h,M]);a.useEffect(()=>{y&&h&&(r.length>0||q)?(l(!0),k(-1)):l(!1)},[y,r.length,q,h]),a.useEffect(()=>{const t=n=>{w.current&&!w.current.contains(n.target)&&l(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const U=t=>{const n=t.target.value.trim();x(n),c?.(n)},K=async()=>{try{const n=(await H.read()).trim();x(n),c?.(n),$?.()}catch{console.error("Failed to read clipboard")}},D=a.useCallback(t=>{x(t.matchedAddress.address),c?.(t.matchedAddress.address),l(!1)},[c]),O=a.useCallback(()=>{x(""),c?.("")},[c]),Q=t=>{if(!(!v||r.length===0))switch(t.key){case"ArrowDown":t.preventDefault(),k(n=>n<r.length-1?n+1:n);break;case"ArrowUp":t.preventDefault(),k(n=>n>0?n-1:-1);break;case"Enter":o>=0&&r[o]&&r[o].isValidForCurrentChain&&(t.preventDefault(),D(r[o]));break;case"Escape":l(!1);break}};return e.jsxs("div",{ref:w,className:f("@container space-y-2",B),children:[I&&e.jsx("label",{className:"block text-sm font-medium",children:I}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:f("bg-background relative flex items-center gap-2 rounded-xl border p-2 transition-colors @xs:gap-3 @xs:p-3",y?"border-primary ring-primary/20 ring-2":"border-input",g&&"border-destructive ring-destructive/20 ring-2"),children:m?e.jsxs(e.Fragment,{children:[e.jsx(E,{src:m.contact.avatar||G(m.matchedAddress.address),size:40,className:"shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"truncate text-sm font-medium",children:m.contact.name}),e.jsx("p",{className:"text-muted-foreground truncate font-mono text-xs",children:m.matchedAddress.address})]}),e.jsx("button",{type:"button",onClick:O,className:"text-muted-foreground hover:text-foreground hover:bg-muted/50 shrink-0 rounded-lg p-1.5 transition-colors","aria-label":d("a11y.clear"),children:e.jsx(ee,{className:"size-5"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("input",{ref:R,type:"text","data-testid":"address-input",value:i,onChange:U,onFocus:()=>S(!0),onBlur:()=>setTimeout(()=>S(!1),150),onKeyDown:Q,className:"placeholder:text-muted-foreground min-w-0 flex-1 bg-transparent font-mono text-sm outline-none",placeholder:d("addressPlaceholder"),autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1,"aria-invalid":g,"aria-describedby":g?T:void 0,"aria-expanded":v,"aria-controls":v?V:void 0,"aria-activedescendant":o>=0?`suggestion-${o}`:void 0,role:"combobox",...L}),e.jsxs("div",{className:"flex items-center",children:[j&&e.jsx("button",{type:"button","data-testid":"scan-address-button",onClick:j,className:"text-muted-foreground hover:text-foreground hover:bg-muted/50 rounded-lg p-1.5 transition-colors @xs:p-2","aria-label":d("a11y.scanQrCode"),children:e.jsx(ae,{className:"size-5"})}),e.jsxs("button",{type:"button",onClick:K,className:"text-muted-foreground hover:text-foreground hover:bg-muted/50 @xs:text-primary @xs:hover:text-primary/80 rounded-lg p-1.5 transition-colors @xs:px-3 @xs:py-1.5 @xs:text-sm @xs:font-medium @xs:hover:bg-transparent","aria-label":d("a11y.paste"),children:[e.jsx(ne,{className:"size-5 @xs:hidden"}),e.jsx("span",{className:"hidden @xs:inline",children:d("paste")})]})]})]})}),v&&e.jsxs("div",{id:V,className:"bg-popover border-border absolute z-50 mt-1 w-full overflow-hidden rounded-xl border shadow-lg",children:[r.length>0?e.jsx("ul",{role:"listbox",children:r.map((t,n)=>{const p=!t.isValidForCurrentChain;return e.jsxs("li",{id:`suggestion-${n}`,role:"option","aria-selected":n===o,"aria-disabled":p,className:f("flex items-center gap-3 px-3 py-2 transition-colors",p?"opacity-50 cursor-not-allowed":n===o?"bg-accent cursor-pointer":"hover:bg-muted/50 cursor-pointer"),onClick:()=>!p&&D(t),children:[e.jsx(E,{src:t.contact.avatar,size:32,className:"shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"truncate text-sm font-medium",children:t.contact.name}),e.jsx("p",{className:f("truncate font-mono text-xs",p?"text-muted-foreground/50":"text-muted-foreground"),children:t.matchedAddress.address})]}),z(t.matchedAddress)&&e.jsx("span",{className:f("max-w-[4rem] shrink-0 truncate text-xs",p?"text-muted-foreground/50":"text-muted-foreground"),children:z(t.matchedAddress)})]},`${t.contact.id}-${t.matchedAddress.id}`)})}):e.jsx("div",{className:"text-muted-foreground px-3 py-4 text-center text-sm",children:d("contact.noContacts")}),N&&e.jsxs("button",{type:"button",onClick:()=>{l(!1),N()},className:"text-primary hover:bg-muted/50 border-border flex w-full items-center justify-center gap-2 border-t px-3 py-2.5 text-sm font-medium transition-colors",children:[e.jsx(oe,{className:"size-4"}),d("contact.viewAll")]})]})]}),g&&e.jsx("p",{id:T,className:"text-destructive -mt-0.5 text-xs",role:"alert","aria-live":"polite","aria-atomic":"true",children:A||d("a11y.invalidAddress")})]})});_.displayName="AddressInput";_.__docgenInfo={description:"",methods:[],displayName:"AddressInput",props:{value:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"",defaultValue:{value:"''",computed:!1}},onChange:{required:!1,tsType:{name:"union",raw:"((value: string) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},onScan:{required:!1,tsType:{name:"union",raw:"(() => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},onPaste:{required:!1,tsType:{name:"union",raw:"(() => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},onContactPicker:{required:!1,tsType:{name:"union",raw:"(() => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:"Callback to open contact picker"},error:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},label:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},chainType:{required:!1,tsType:{name:"union",raw:"ChainType | undefined",elements:[{name:"ChainType"},{name:"undefined"}]},description:"Chain type to filter contact addresses"},showSuggestions:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"Enable contact suggestions dropdown",defaultValue:{value:"true",computed:!1}},maxSuggestions:{required:!1,tsType:{name:"union",raw:"number | undefined",elements:[{name:"number"},{name:"undefined"}]},description:"Maximum suggestions to show (default: 5)",defaultValue:{value:"5",computed:!1}}},composes:["Omit"]};export{_ as A,ae as I,de as i};
