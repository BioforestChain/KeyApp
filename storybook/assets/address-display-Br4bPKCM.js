import{r as m,j as i}from"./iframe-Cdc63axx.js";import{c as p}from"./utils-CDN07tui.js";import{c as $}from"./web-D11Qze_b.js";import{u as k}from"./useTranslation-B1THGpvK.js";import{I as S}from"./IconCheck-CSFX6uTb.js";import{I as A}from"./IconCopy-Bd89ourp.js";let b=null,h=null;function v(e,r){return typeof document>"u"||(b||(b=document.createElement("canvas"),h=b.getContext("2d")),!h)?e.length*8:(h.font=r,h.measureText(e).width)}function M(e,r,o){if(v(e,o)<=r)return e;const x=v("...",o),l=r-x;if(l<=0)return"...";const d=v(e.charAt(0),o),a=Math.floor(l/d);let n,t;a<4*2?(n=Math.max(2,Math.floor(a/2)),t=Math.max(2,a-n)):(n=Math.ceil(a*.55),t=a-n);const y=e.length-t-1;return n=Math.min(n,y),n+t>=e.length?e:`${e.slice(0,n)}...${e.slice(-t)}`}function W({address:e,copyable:r=!0,className:o,onCopy:g,testId:s}){const{t:x}=k("common"),[l,d]=m.useState(!1),[a,n]=m.useState(null),t=m.useRef(null),f=m.useCallback(()=>{const c=t.current;if(!c)return;const u=getComputedStyle(c),T=`${u.fontSize} ${u.fontFamily}`,w=r?24:0,j=c.clientWidth-w;if(j<=0){n(e);return}const N=M(e,j,T);n(N)},[e,r]);m.useLayoutEffect(()=>{const c=t.current;if(!c)return;f();const u=new ResizeObserver(f);return u.observe(c),()=>u.disconnect()},[f]);const y=async()=>{try{await $.write({text:e}),d(!0),g?.(),setTimeout(()=>d(!1),2e3)}catch{console.error("Failed to copy address")}},C=a!==null;return r?i.jsxs("button",{ref:t,type:"button",onClick:y,...s&&{"data-testid":s},className:p("relative flex w-full items-center gap-1.5 font-mono text-sm transition-colors","hover:text-primary focus-visible:ring-ring rounded focus:outline-none focus-visible:ring-2",o),title:e,"aria-label":l?`已复制 ${e}`:`复制 ${e}`,children:[i.jsxs("span",{className:"relative min-w-0 flex-1",children:[i.jsx("span",{className:"invisible","aria-hidden":"true",children:"0"}),i.jsx("span",{...s&&{"data-testid":`${s}-text`},className:p("absolute inset-0 truncate",!C&&"invisible"),"aria-hidden":"true",children:a})]}),l?i.jsx(S,{className:"text-green-500 size-4 shrink-0","aria-hidden":"true"}):i.jsx(A,{className:"text-muted-foreground size-4 shrink-0","aria-hidden":"true"}),i.jsx("span",{role:"status","aria-live":"polite",className:"sr-only",children:l?x("copiedToClipboard"):""})]}):i.jsxs("span",{ref:t,...s&&{"data-testid":s},className:p("relative block font-mono text-sm",o),title:e,"aria-label":e,children:[i.jsx("span",{className:"invisible","aria-hidden":"true",children:"0"}),i.jsx("span",{...s&&{"data-testid":`${s}-text`},className:p("absolute inset-0 truncate",!C&&"invisible"),children:a})]})}W.__docgenInfo={description:"",methods:[],displayName:"AddressDisplay",props:{address:{required:!0,tsType:{name:"string"},description:""},copyable:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"",defaultValue:{value:"true",computed:!1}},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},onCopy:{required:!1,tsType:{name:"union",raw:"(() => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},testId:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""}}};export{W as A};
