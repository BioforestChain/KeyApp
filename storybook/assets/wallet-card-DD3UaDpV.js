import{r as n,j as t}from"./iframe-DZOLjtV7.js";import{c as _}from"./utils-4perknFd.js";import{u as F,H as J}from"./hologram-canvas-CtyfQBV3.js";import{C as Q}from"./chain-icon-CpIqzhT7.js";import{A as Z}from"./address-display-CHNAN0Hy.js";import{I as H}from"./IconChevronDown-glHB3lxd.js";import{I as ee}from"./IconSettings-Bg-1J7pD.js";import{I as te}from"./IconCheck-Bkd19m3i.js";import{I as ne}from"./web-CKuC86AI.js";function ae(q={}){const{gyroStrength:d=.15,touchStrength:v=1,enableGyro:h=!0,enableTouch:y=!0,idleTimeout:R=3e3,wakeThreshold:b=.055}=q,w=n.useCallback(e=>{const s=Math.abs(e),a=Math.pow(s,.7);return Math.sign(e)*a},[]),l=n.useRef(null),[g,E]=n.useState({pointerX:0,pointerY:0,isActive:!1}),k=n.useRef({x:0,y:0}),C=n.useRef({x:0,y:0,active:!1}),M=n.useRef("dynamic"),T=n.useRef(Date.now()),u=n.useRef({x:0,y:0}),m=n.useCallback(()=>{const e=Date.now(),s=k.current,a=C.current,r=w(s.x),c=w(s.y);let i=0,o=0,j=!1;a.active&&y?(i=a.x*v+r*d*.3,o=a.y*v+c*d*.3,j=!0):h&&(Math.abs(s.x)>.01||Math.abs(s.y)>.01)&&(i=r*d,o=c*d,j=!0),i=Math.max(-1,Math.min(1,i)),o=Math.max(-1,Math.min(1,o));const N=Math.hypot(i-u.current.x,o-u.current.y);if(M.current==="static")if(N>b||a.active)M.current="dynamic",T.current=e,u.current={x:i,y:o};else return;else if(N>b||a.active)T.current=e,u.current={x:i,y:o};else if(e-T.current>R){M.current="static";return}E({pointerX:i,pointerY:o,isActive:j})},[w,d,v,h,y,R,b]);n.useEffect(()=>{if(!h)return;let e=!1;const s=r=>{const{beta:c,gamma:i}=r;c===null||i===null||(k.current={x:Math.max(-1,Math.min(1,i/45)),y:Math.max(-1,Math.min(1,(c-45)/45))},m())};return(async()=>{if(typeof DeviceOrientationEvent<"u"&&"requestPermission"in DeviceOrientationEvent&&typeof DeviceOrientationEvent.requestPermission=="function")try{e=await DeviceOrientationEvent.requestPermission()==="granted"}catch{e=!1}else e=!0;e&&window.addEventListener("deviceorientation",s)})(),()=>{window.removeEventListener("deviceorientation",s)}},[h,m]);const f=n.useCallback(e=>{if(!y||!l.current)return;const a=l.current.getBoundingClientRect();let r,c;if("touches"in e&&e.touches[0])r=e.touches[0].clientX,c=e.touches[0].clientY;else if("clientX"in e)r=e.clientX,c=e.clientY;else return;const i=((r-a.left)/a.width-.5)*2,o=((c-a.top)/a.height-.5)*2;C.current={x:i,y:o,active:!0},m()},[y,m]),p=n.useCallback(()=>{C.current={x:0,y:0,active:!1},m()},[m]),z=n.useCallback(e=>{l.current&&(l.current.removeEventListener("pointermove",f),l.current.removeEventListener("pointerleave",p),l.current.removeEventListener("touchmove",f),l.current.removeEventListener("touchend",p)),l.current=e,e&&(e.addEventListener("pointermove",f),e.addEventListener("pointerleave",p),e.addEventListener("touchmove",f,{passive:!0}),e.addEventListener("touchend",p))},[f,p]);return{...g,bindElement:z,ref:l,style:{"--pointer-x":g.pointerX,"--pointer-y":g.pointerY}}}if(typeof window<"u"&&"registerProperty"in CSS){const q=[{name:"--tilt-x",syntax:"<number>",initialValue:"0"},{name:"--tilt-y",syntax:"<number>",initialValue:"0"},{name:"--tilt-nx",syntax:"<number>",initialValue:"0"},{name:"--tilt-ny",syntax:"<number>",initialValue:"0"},{name:"--tilt-intensity",syntax:"<number>",initialValue:"0"},{name:"--tilt-direction",syntax:"<number>",initialValue:"0"}];for(const d of q)try{CSS.registerProperty({...d,inherits:!0})}catch{}}const ie=n.forwardRef(function({wallet:d,chain:v,chainName:h,walletNameTestId:y="wallet-name",canvasKey:R,priority:b="high",address:w,chainIconUrl:l,watermarkLogoSize:g=60,watermarkLogoActualSize:E=24,onCopyAddress:k,onOpenChainSelector:C,onOpenSettings:M,className:T,themeHue:u=323,disableWatermarkRefraction:m,disablePatternRefraction:f,enableGyro:p},z){const[e,s]=n.useState(!1),a=n.useRef(null),r=n.useMemo(()=>typeof window>"u"?!1:window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches??!1,[]),c=m??r,i=f??r,o=p??!r,j=r?"static":"dynamic",N=R??d.id,W=typeof window<"u"?Math.min(3,window.devicePixelRatio||1):1,L=F(l,{size:Math.round(E*W),invert:!1,contrast:1.8,targetBrightness:.85}),{pointerX:V,pointerY:X,isActive:x,bindElement:A}=ae({gyroStrength:.35,touchStrength:.8,enableGyro:o});n.useEffect(()=>{A(a.current)},[A]);const O=n.useCallback(()=>{k?.(),s(!0),setTimeout(()=>s(!1),2e3)},[k]),S=15,Y=x?X*-S:0,D=x?V*S:0,I=Y/S,P=D/S,G=x?Math.min(1,Math.sqrt(I*I+P*P)):0,B=Math.atan2(-I,P)*(180/Math.PI),U={"--tilt-x":Y,"--tilt-y":D,"--tilt-nx":I,"--tilt-ny":P,"--tilt-intensity":G,"--tilt-direction":B},K="all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)",$=n.useMemo(()=>({background:`radial-gradient(120% 120% at 20% 10%, oklch(88% 0.12 ${u}) 0%, oklch(62% 0.18 ${u}) 45%, oklch(38% 0.12 ${u}) 100%)`}),[u]);return t.jsx("div",{ref:z,"data-testid":"wallet-card-container",className:_("wallet-card-container h-full w-full",T),style:{perspective:"1000px"},children:t.jsxs("div",{ref:a,"data-testid":"wallet-card","data-active":x?"true":"false",className:"wallet-card relative h-full w-full transform-gpu touch-none overflow-hidden rounded-2xl select-none",style:{...U,transform:"rotateX(calc(var(--tilt-x) * 1deg)) rotateY(calc(var(--tilt-y) * 1deg))",transformStyle:"preserve-3d",transition:x?"none":K,isolation:"isolate",willChange:"transform, --tilt-x, --tilt-y, --tilt-intensity"},children:[t.jsx("div",{className:"pointer-events-none absolute inset-0 rounded-2xl",style:$}),t.jsx(J,{priority:b,enabledPattern:!i,enabledWatermark:!c&&!!L,mode:j,pointerX:V,pointerY:X,active:x,themeHue:u,watermarkMaskUrl:L,watermarkCellSize:g,watermarkIconSize:E,poolKey:N}),t.jsx("div",{className:"pointer-events-none absolute inset-0 rounded-2xl",style:{border:"1px solid rgba(255,255,255,0.2)"}}),t.jsxs("div",{className:"relative z-10 flex h-full flex-col justify-between p-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("button",{onClick:C,"data-testid":"chain-selector",className:"flex items-center gap-1.5 rounded-full bg-black/20 px-2.5 py-1 text-xs text-white backdrop-blur-sm transition-colors hover:bg-black/30",children:[t.jsx(Q,{chainId:v,size:"sm"}),t.jsx("span",{className:"font-medium",children:h}),t.jsx(H,{className:"size-3 opacity-70"})]}),t.jsx("button",{onClick:M,"data-testid":"wallet-card-settings-button",className:"rounded-full bg-black/10 p-1.5 text-white/80 backdrop-blur-sm transition-colors hover:bg-black/20 hover:text-white",children:t.jsx(ee,{className:"size-4"})})]}),t.jsx("div",{className:"flex flex-1 items-center justify-center",children:t.jsx("h2",{"data-testid":y,className:"text-2xl font-bold text-white drop-shadow-lg",children:d.name})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Z,{address:w??"",copyable:!1,testId:"wallet-card-address",className:"min-w-0 flex-1 text-white/80 drop-shadow"}),t.jsx("button",{onClick:O,"data-testid":"wallet-card-copy-button","data-copied":e?"true":"false",className:"shrink-0 rounded-full bg-black/10 p-1.5 text-white/80 backdrop-blur-sm transition-all hover:bg-black/20 hover:text-white",children:e?t.jsx(te,{className:"size-4 text-green-300"}):t.jsx(ne,{className:"size-4"})})]})]}),t.jsx("div",{className:"pointer-events-none absolute inset-0 rounded-2xl",style:{boxShadow:`
                inset 0 1px 1px rgba(255,255,255,0.3),
                inset 0 -1px 1px rgba(0,0,0,0.2),
                0 20px 40px -15px rgba(0,0,0,0.4)
              `}})]})})});ie.__docgenInfo={description:"",methods:[],displayName:"WalletCard",props:{wallet:{required:!0,tsType:{name:"Wallet"},description:""},chain:{required:!0,tsType:{name:"ChainType"},description:""},chainName:{required:!0,tsType:{name:"string"},description:""},walletNameTestId:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"",defaultValue:{value:"'wallet-name'",computed:!1}},canvasKey:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"Canvas pool key (defaults to wallet.id)"},priority:{required:!1,tsType:{name:"union",raw:"'high' | 'medium' | 'low'",elements:[{name:"literal",value:"'high'"},{name:"literal",value:"'medium'"},{name:"literal",value:"'low'"}]},description:"渲染优先级，影响帧率和分辨率",defaultValue:{value:"'high'",computed:!1}},address:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},chainIconUrl:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"链图标 URL，用于防伪水印"},watermarkLogoSize:{required:!1,tsType:{name:"union",raw:"number | undefined",elements:[{name:"number"},{name:"undefined"}]},description:"防伪水印 logo 平铺尺寸（含间距），默认 40px",defaultValue:{value:"60",computed:!1}},watermarkLogoActualSize:{required:!1,tsType:{name:"union",raw:"number | undefined",elements:[{name:"number"},{name:"undefined"}]},description:"防伪水印 logo 实际尺寸，默认 24px（与 watermarkLogoSize 差值为间距）",defaultValue:{value:"24",computed:!1}},onCopyAddress:{required:!1,tsType:{name:"union",raw:"(() => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},onOpenChainSelector:{required:!1,tsType:{name:"union",raw:"(() => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},onOpenSettings:{required:!1,tsType:{name:"union",raw:"(() => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},themeHue:{required:!1,tsType:{name:"union",raw:"number | undefined",elements:[{name:"number"},{name:"undefined"}]},description:"",defaultValue:{value:"323",computed:!1}},disableWatermarkRefraction:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:`禁用“水印 Refraction”层（Android 部分机型/浏览器组合会出现页面闪动）。
默认：在 Android 浏览器上自动禁用，其它平台启用。`},disablePatternRefraction:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:`禁用“三角纹理 Refraction”层。
默认：在 Android 浏览器上自动禁用，其它平台启用。

说明：用户反馈 Pattern 在 Android 表现正常时，可以将该值显式设为 false 以保留效果。`},enableGyro:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:`是否启用陀螺仪倾斜（deviceorientation）。
默认：在 Android 上关闭（降低高频重绘导致的闪动/掉帧风险）。`}}};export{ie as W};
