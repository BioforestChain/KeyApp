const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./snapdom-CO8q8LPW.js","./preload-helper-PPVm8Dsz.js","./index-qYIYDQQe.js","./iframe-BWeqjITw.js","./iframe-vYdnEvhy.css","./service-jBNg5IZq.js","./schemas-CO8_C8zP.js","./index-D0E7N0oa.js","./derivation-Dn_NLtka.js","./amount-BQsqQYGO.js","./bioforest-tjr8Syby.js"])))=>i.map(i=>d[i]);
import{g as Qu,r as c,j as e,R as Ja,u as Ae,S as Yu,as as ko,at as Un,v as we,au as es,x as Co,av as Xu,y as Wr}from"./iframe-BWeqjITw.js";import{a as Vn,c as L}from"./utils-4perknFd.js";import{u as So,d as wa,W as Zu}from"./useWalletTheme-DOiYOqpa.js";import{W as em,u as Ao}from"./wallet-card-carousel-BBjKlV8H.js";import{W as Io}from"./wallet-card-B-MX2tyC.js";import{B as J,c as tm}from"./button-BAdyIxPu.js";import{f as ye,d as gs,W as Gs,g as vs,c as zs,a as Os,b as Ka,w as Re,e as Qs,u as Ga,h as sm,i as nm,j as ds}from"./user-profile-Dk_kijuI.js";import{c as lt,h as am,u as dt,b as He,j as ts,d as Ys,e as ka,k as Qa,l as rm,m as im,n as om,o as cm,f as os,p as Xs,q as lm}from"./service-jBNg5IZq.js";import{u as dm,a as um,b as Mt,c as Fe,d as Jn,e as Je,f as Ya,g as To,p as mm,T as fm}from"./TabBar-BogZdn9x.js";import{s as Ps}from"./index-D0E7N0oa.js";import{g as pm,v as Po,R as hm,I as xm,a as gm,b as vm,c as ym}from"./recover-wallet-form-CHLL9lre.js";import{S as bm}from"./swiper-sync-context-D7Xyv0No.js";import{h as jm,c as Nm,W as wm,C as Xa,s as Kt}from"./token-item-BMCb4Aw4.js";import{L as Te,G as Ue,A as Gt,P as bt,I as Zs,b as sa}from"./LoadingSpinner-BX-as0np.js";import{u as O}from"./useTranslation-xI2qK3OI.js";import{I as Oe}from"./IconAlertTriangle-DFmmXpxC.js";import{I as ss}from"./IconTrash-Bwn4Cqq0.js";import{c as Za,I as Eo}from"./web-Dl7j0Upe.js";import{t as km}from"./web-BAZGP8WJ.js";import{B as hs,k as $e,M as Vt,q as at,E as Cm,N as Sm,O as Am}from"./derivation-Dn_NLtka.js";import{p as wt,g as _o,n as Cs,a as Im}from"./notification-CZiZl7-G.js";import{g as Pe,N as Mo,o as Tm,q as Qt,u as $r,C as er,v as fs,I as Pm}from"./index-qYIYDQQe.js";import"./breakpoint-DQ_qwb34.js";import{T as Ro}from"./transaction-item-C4CjKwx4.js";import{A as oe}from"./amount-BQsqQYGO.js";import{I as ut}from"./IconPlus-CDNXereV.js";import{c as ue}from"./createReactComponent-CZ0FE120.js";import{I as Sn,b as Lo,c as na,d as Bs,e as Em,g as _m,f as Mm,h as Rm}from"./transaction-meta-BdKW6iP1.js";import{I as Lm,i as Dm,A as zm}from"./address-input-C5Tk_Z2d.js";import{A as Nt}from"./amount-display-C7Hj5IPN.js";import"./animated-number-DbwaE-UI.js";import{T as Om}from"./time-display-cVn3yrqg.js";import{F as Bm,E as Do,S as Fm,C as qr}from"./service-status-alert-BhZbADNa.js";import{e as tr,K as Wm,L as zo,M as $m,u as qm,J as Me,l as Oo,N as Bo,O as Hm,T as Um,P as Vm,Q as Jm,R as Hr,d as Km,S as Ur,U as Vr,V as Jr,W as Kr,X as Gr,Y as Qr,Z as Yr,_ as Xr,$ as Zr,a0 as ei,a1 as ti,a2 as si,a3 as Fo,a4 as Gm,a5 as Qm,a6 as ni,a7 as Ym,a8 as Xm}from"./index-D_IRGuS3.js";import{I as Zm,a as ef}from"./my-apps-page-CsvxcYi5.js";import{E as tf,c as Rt}from"./ecosystem-desktop-onDMME0a.js";import"./miniapp-splash-screen-CfCymeA9.js";import{u as sf}from"./item-CA8DIqh4.js";import{_ as Pt}from"./preload-helper-PPVm8Dsz.js";import{P as K}from"./page-header-M_4bILaW.js";import{C as js,I as nf}from"./contact-avatar-Dwb5kFfw.js";import{I as Le}from"./IconChevronRight-mJ0ZrtnL.js";import{S as Ct,a as St,b as At,c as It,u as af,f as rf,D as of,g as cf,h as lf,i as df,j as uf,k as mf,l as ff,m as pf,n as hf}from"./sheet-BqQ2mcQo.js";import{I as je}from"./IconCheck-C3Q_jHbl.js";import{C as Et,a as An}from"./chain-icon-Djkbu6SA.js";import{p as Be,P as mt}from"./pattern-lock-Ba_UD8wx.js";import{P as ys}from"./password-input-CCf2kDHG.js";import{I as en}from"./IconLock-BPNXFsTK.js";import{I as _t}from"./IconAlertCircle-BMq2upRj.js";import{F as sr}from"./fee-display-YvBjySTV.js";import{T as Wo}from"./tx-status-display-EwydJY0x.js";import{I as Ve}from"./input-Cwgz749E.js";import{b as Jt,i as xf,d as gf}from"./avatar-codec-BCfJ87vB.js";import{I as ns}from"./IconRefresh-BzDJYE_4.js";import{I as tn}from"./IconSearch-8dH4AdRt.js";import{I as sn}from"./IconDownload-CvGeN0ok.js";import{W as vf,r as yf}from"./wallet-mini-card-DQe6J6ch.js";import{I as bf,W as jf}from"./wallet-list-CAsJzJuO.js";import{C as $o}from"./checkbox-CGgUM4Ln.js";import{I as qo,S as Fs,a as Ws,b as $s,c as qs,d as Yt,A as Ho}from"./asset-selector-DYFGQfxc.js";import{I as Uo}from"./IconChevronDown-QjFEqfEJ.js";import{p as Vo,g as nr}from"./qr-parser-CQWbsUyl.js";import{c as Jo}from"./index-gswO3TSy.js";import{g as Nf,a as wf,b as kf}from"./scanner-validators-YRGmuXyx.js";import{I as nn}from"./IconX-hAmdSUWz.js";import{I as ar}from"./IconWallet-DICbfN_g.js";import{C as rr}from"./contact-card-U1ad18Fd.js";import{I as be}from"./IconLoader2-BTrRHJkA.js";import{g as Kn,n as Cf,p as Sf}from"./index-BkWKD4y7.js";import{a as jn,c as Nn,s as wn,p as Af,i as If}from"./bioforest-tjr8Syby.js";import{I as Tf}from"./IconApps-CuWv2Z3g.js";import{I as ir}from"./IconShieldCheck-DzQg7vt4.js";import{A as it}from"./address-display-ByxpPujQ.js";import{z as Pf}from"./composite-BhQqNIoG.js";import{f as Ef,u as or,d as _f,m as Mf}from"./useRenderElement-Cq20EMg7.js";import{I as cr}from"./IconEye-Dw1iy5ix.js";import{M as Ko}from"./mnemonic-display-ByjhnksG.js";import{P as lr}from"./pattern-lock-setup-hOqklofo.js";import{g as Go,C as dr}from"./chain-selector-w4lrpCqI.js";import{deriveWalletChainAddresses as Qo}from"./index-CrV4CaFj.js";import{I as Yo}from"./IconEyeOff-COzzO9TB.js";import{I as Ns}from"./IconCircleCheck-DoZA2oPt.js";import"./asset-item-PCzPrT0N.js";import"./asset-list-CrS6-F4-.js";import{A as Xo}from"./amount-input-Bg0-FeTI.js";import{B as Rf}from"./balance-display-BWYL8nx-.js";import{S as Lf,I as Zo}from"./send-result-611oYiL-.js";import{T as ec}from"./Trans-BUKIbtpd.js";import{M as Df}from"./mnemonic-input-LIOccwzm.js";import{T as tc}from"./transaction-list-CZ7gNiMr.js";import{T as zf}from"./transaction-status-BI7mS9e3.js";import{I as Ca}from"./IconExternalLink-DL00Vuw2.js";import{A as sc}from"./AppInfoCard-B3wIKVZQ.js";import{P as Of}from"./PermissionList-CKEnkEZy.js";import{W as Bf}from"./wallet-selector-D30S-zIg.js";import{T as ot}from"./token-icon-CY_6CJGW.js";import{T as ai}from"./TransactionDetails-C5OEycbY.js";import{B as ri}from"./BalanceWarning-DwJ1om0W.js";import{K as Ff}from"./key-type-selector-BUn3Z1Fs.js";import{A as Wf}from"./arbitrary-key-input-BncCSbim.js";import{C as $f}from"./chain-address-preview-phV6weWg.js";import{C as qf}from"./collision-confirm-dialog-DHuLX65B.js";import{I as Hf}from"./dropdown-menu-Bhfs_6g1.js";import"./hologram-canvas-4go9sMBC.js";import{I as Uf}from"./IconPencil-CtfWWO4R.js";import{I as Vf}from"./IconBell-_Oa9veDp.js";import{I as Jf}from"./IconCircleX-2tHR5F49.js";import{I as Kf}from"./IconClock-BsfdbLaa.js";import{j as ws,s as ce,c as Tt,n as Gn,i as nc,l as kt,a as ur}from"./schemas-CO8_C8zP.js";import{I as Gf}from"./IconShield-ToZdAnRG.js";const Qf=[["path",{d:"M20 6v12a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2z",key:"svg-0"}],["path",{d:"M10 16h6",key:"svg-1"}],["path",{d:"M13 11m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-2"}],["path",{d:"M4 8h3",key:"svg-3"}],["path",{d:"M4 12h3",key:"svg-4"}],["path",{d:"M4 16h3",key:"svg-5"}]],Yf=ue("outline","address-book","AddressBook",Qf);const Xf=[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 15h10.55",key:"svg-1"}],["path",{d:"M6.551 4.938l3.26 10.034",key:"svg-2"}],["path",{d:"M17.032 4.636l-8.535 6.201",key:"svg-3"}],["path",{d:"M20.559 14.51l-8.535 -6.201",key:"svg-4"}],["path",{d:"M12.257 20.916l3.261 -10.034",key:"svg-5"}]],ac=ue("outline","aperture","Aperture",Xf);const Zf=[["path",{d:"M17 7l-10 10",key:"svg-0"}],["path",{d:"M16 17l-9 0l0 -9",key:"svg-1"}]],ep=ue("outline","arrow-down-left","ArrowDownLeft",Zf);const tp=[["path",{d:"M7 7l10 10",key:"svg-0"}],["path",{d:"M17 8l0 9l-9 0",key:"svg-1"}]],sp=ue("outline","arrow-down-right","ArrowDownRight",tp);const np=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M13 18l6 -6",key:"svg-1"}],["path",{d:"M13 6l6 6",key:"svg-2"}]],rc=ue("outline","arrow-right","ArrowRight",np);const ap=[["path",{d:"M17 7l-10 10",key:"svg-0"}],["path",{d:"M8 7l9 0l0 9",key:"svg-1"}]],ic=ue("outline","arrow-up-right","ArrowUpRight",ap);const rp=[["path",{d:"M3 12h1m8 -9v1m8 8h1m-15.4 -6.4l.7 .7m12.1 -.7l-.7 .7",key:"svg-0"}],["path",{d:"M9 16a5 5 0 1 1 6 0a3.5 3.5 0 0 0 -1 3a2 2 0 0 1 -4 0a3.5 3.5 0 0 0 -1 -3",key:"svg-1"}],["path",{d:"M9.7 17l4.6 0",key:"svg-2"}]],oc=ue("outline","bulb","Bulb",rp);const ip=[["path",{d:"M5 7h1a2 2 0 0 0 2 -2a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1a2 2 0 0 0 2 2h1a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-9a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M9 13a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-1"}]],op=ue("outline","camera","Camera",ip);const cp=[["path",{d:"M14 10m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-0"}],["path",{d:"M21 12a9 9 0 1 1 -18 0a9 9 0 0 1 18 0z",key:"svg-1"}],["path",{d:"M12.5 11.5l-4 4l1.5 1.5",key:"svg-2"}],["path",{d:"M12 15l-1.5 -1.5",key:"svg-3"}]],mr=ue("outline","circle-key","CircleKey",cp);const lp=[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M14.8 9a2 2 0 0 0 -1.8 -1h-2a2 2 0 1 0 0 4h2a2 2 0 1 1 0 4h-2a2 2 0 0 1 -1.8 -1",key:"svg-1"}],["path",{d:"M12 7v10",key:"svg-2"}]],dp=ue("outline","coin","Coin",lp);const up=[["path",{d:"M16.7 8a3 3 0 0 0 -2.7 -2h-4a3 3 0 0 0 0 6h4a3 3 0 0 1 0 6h-4a3 3 0 0 1 -2.7 -2",key:"svg-0"}],["path",{d:"M12 3v3m0 12v3",key:"svg-1"}]],mp=ue("outline","currency-dollar","CurrencyDollar",up);const fp=[["path",{d:"M6 12l6 -9l6 9l-6 9z",key:"svg-0"}],["path",{d:"M6 12l6 -3l6 3l-6 2z",key:"svg-1"}]],pp=ue("outline","currency-ethereum","CurrencyEthereum",fp);const hp=[["path",{d:"M12 6m-8 0a8 3 0 1 0 16 0a8 3 0 1 0 -16 0",key:"svg-0"}],["path",{d:"M4 6v6a8 3 0 0 0 16 0v-6",key:"svg-1"}],["path",{d:"M4 12v6a8 3 0 0 0 16 0v-6",key:"svg-2"}]],cc=ue("outline","database","Database",hp);const xp=[["path",{d:"M3 5a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v10a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1v-10z",key:"svg-0"}],["path",{d:"M7 20h10",key:"svg-1"}],["path",{d:"M9 16v4",key:"svg-2"}],["path",{d:"M15 16v4",key:"svg-3"}]],gp=ue("outline","device-desktop","DeviceDesktop",xp);const vp=[["path",{d:"M3 3m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["circle",{cx:"8.5",cy:"8.5",r:".5",fill:"currentColor",key:"svg-1"}],["circle",{cx:"15.5",cy:"8.5",r:".5",fill:"currentColor",key:"svg-2"}],["circle",{cx:"15.5",cy:"15.5",r:".5",fill:"currentColor",key:"svg-3"}],["circle",{cx:"8.5",cy:"15.5",r:".5",fill:"currentColor",key:"svg-4"}],["circle",{cx:"12",cy:"12",r:".5",fill:"currentColor",key:"svg-5"}]],yp=ue("outline","dice-5","Dice5",vp);const bp=[["path",{d:"M4 4h16v2.172a2 2 0 0 1 -.586 1.414l-4.414 4.414v7l-6 2v-8.5l-4.48 -4.928a2 2 0 0 1 -.52 -1.345v-2.227z",key:"svg-0"}]],lc=ue("outline","filter","Filter",bp);const jp=[["path",{d:"M18.9 7a8 8 0 0 1 1.1 5v1a6 6 0 0 0 .8 3",key:"svg-0"}],["path",{d:"M8 11a4 4 0 0 1 8 0v1a10 10 0 0 0 2 6",key:"svg-1"}],["path",{d:"M12 11v2a14 14 0 0 0 2.5 8",key:"svg-2"}],["path",{d:"M8 15a18 18 0 0 0 1.8 6",key:"svg-3"}],["path",{d:"M4.9 19a22 22 0 0 1 -.9 -7v-1a8 8 0 0 1 12 -6.95",key:"svg-4"}]],Np=ue("outline","fingerprint","Fingerprint",jp);const wp=[["path",{d:"M7 12h3v4h-3z",key:"svg-0"}],["path",{d:"M10 6h-6a1 1 0 0 0 -1 1v12a1 1 0 0 0 1 1h16a1 1 0 0 0 1 -1v-12a1 1 0 0 0 -1 -1h-6",key:"svg-1"}],["path",{d:"M10 3m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v3a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M14 16h2",key:"svg-3"}],["path",{d:"M14 12h4",key:"svg-4"}]],kp=ue("outline","id-badge-2","IdBadge2",wp);const Cp=[["path",{d:"M9 6.371c0 4.418 -2.239 6.629 -5 6.629",key:"svg-0"}],["path",{d:"M4 6.371h7",key:"svg-1"}],["path",{d:"M5 9c0 2.144 2.252 3.908 6 4",key:"svg-2"}],["path",{d:"M12 20l4 -9l4 9",key:"svg-3"}],["path",{d:"M19.1 18h-6.2",key:"svg-4"}],["path",{d:"M6.694 3l.793 .582",key:"svg-5"}]],Sp=ue("outline","language","Language",Cp);const Ap=[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]],dc=ue("outline","link","Link",Ap);const Ip=[["path",{d:"M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z",key:"svg-0"}]],Tp=ue("outline","moon","Moon",Ip);const Pp=[["path",{d:"M6 9a6 6 0 1 0 12 0a6 6 0 0 0 -12 0",key:"svg-0"}],["path",{d:"M12 3c1.333 .333 2 2.333 2 6s-.667 5.667 -2 6",key:"svg-1"}],["path",{d:"M12 3c-1.333 .333 -2 2.333 -2 6s.667 5.667 2 6",key:"svg-2"}],["path",{d:"M6 9h12",key:"svg-3"}],["path",{d:"M3 20h7",key:"svg-4"}],["path",{d:"M14 20h7",key:"svg-5"}],["path",{d:"M10 20a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-6"}],["path",{d:"M12 15v3",key:"svg-7"}]],Ep=ue("outline","network","Network",Pp);const _p=[["path",{d:"M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25",key:"svg-0"}],["path",{d:"M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}],["path",{d:"M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-3"}]],Mp=ue("outline","palette","Palette",_p);const Rp=[["path",{d:"M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4",key:"svg-0"}],["path",{d:"M13.5 6.5l4 4",key:"svg-1"}],["path",{d:"M16 19h6",key:"svg-2"}]],Lp=ue("outline","pencil-minus","PencilMinus",Rp);const Dp=[["path",{d:"M4 4m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M7 17l0 .01",key:"svg-1"}],["path",{d:"M14 4m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M7 7l0 .01",key:"svg-3"}],["path",{d:"M4 14m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-4"}],["path",{d:"M17 7l0 .01",key:"svg-5"}],["path",{d:"M14 14l3 0",key:"svg-6"}],["path",{d:"M20 14l0 .01",key:"svg-7"}],["path",{d:"M14 14l0 3",key:"svg-8"}],["path",{d:"M14 20l3 0",key:"svg-9"}],["path",{d:"M17 17l3 0",key:"svg-10"}],["path",{d:"M20 17l0 3",key:"svg-11"}]],zp=ue("outline","qrcode","Qrcode",Dp);const Op=[["path",{d:"M10 14l11 -11",key:"svg-0"}],["path",{d:"M21 3l-6.5 18a.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a.55 .55 0 0 1 0 -1l18 -6.5",key:"svg-1"}]],uc=ue("outline","send","Send",Op);const Bp=[["path",{d:"M8 9h-1a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-8a2 2 0 0 0 -2 -2h-1",key:"svg-0"}],["path",{d:"M12 14v-11",key:"svg-1"}],["path",{d:"M9 6l3 -3l3 3",key:"svg-2"}]],Fp=ue("outline","share-2","Share2",Bp);const Wp=[["path",{d:"M6 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-0"}],["path",{d:"M18 6m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-1"}],["path",{d:"M18 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-2"}],["path",{d:"M8.7 10.7l6.6 -3.4",key:"svg-3"}],["path",{d:"M8.7 13.3l6.6 3.4",key:"svg-4"}]],Hs=ue("outline","share","Share",Wp);const $p=[["path",{d:"M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7",key:"svg-1"}]],qp=ue("outline","sun","Sun",$p);const Hp=[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 9h16.8",key:"svg-1"}],["path",{d:"M3.6 15h16.8",key:"svg-2"}],["path",{d:"M11.5 3a17 17 0 0 0 0 18",key:"svg-3"}],["path",{d:"M12.5 3a17 17 0 0 1 0 18",key:"svg-4"}]],mc=ue("outline","world","World",Hp),Up=15,Vp=1440*60*1e3;function Jp(t){return Math.floor(t.getTime()/Vp)}function Kp(t=new Date){const s=Jp(t);return Up*(s+1)%100}function ii(t,s=new Date){const n=typeof t.officialScore=="number"?t.officialScore:0,a=typeof t.communityScore=="number"?t.communityScore:0,r=Kp(s),o=100-r;return(n*r+a*o)/100}function fr(){return Za}function st(){return km}function an(){return jm}function fc(){return Nm}const In={authorizeAddress:"/wallet/authorize/address",authorizeSignature:"/wallet/authorize/signature"};class Gp{constructor(s,n){this.adapter=s,this.eventId=n}hasResponded=!1;handleNetworkAddresses(s,n){const a=n.trim().toLowerCase();if(!a)return[];const r=[];for(const o of s)for(const d of o.chainAddresses)String(d.chain).toLowerCase()===a&&r.push({name:o.name,address:d.address,chainName:d.chain,publicKey:"",magic:`${o.id}:${d.chain}`,signMessage:""});return r}handleMainAddresses(s){return s.chainAddresses.map(n=>({name:s.name,address:n.address,chainName:n.chain,publicKey:"",magic:`${s.id}:${n.chain}`,signMessage:""}))}async handleMainAddressesSigned(s,n){const a=this.handleMainAddresses(s);return await this.applySensitiveOptions(a,[s],{password:n.password,signMessage:n.signMessage,getMain:!1})}handleAllAddresses(s){const n=[];for(const a of s)n.push(...this.handleMainAddresses(a));return n}async handleAllAddressesSigned(s,n){const a=this.handleAllAddresses(s);return await this.applySensitiveOptions(a,s,{password:n.password,signMessage:n.signMessage,getMain:!1})}async handleNetworkAddressesSigned(s,n,a){const r=this.handleNetworkAddresses(s,n);return await this.applySensitiveOptions(r,s,{password:a.password,signMessage:a.signMessage,getMain:!1})}async applySensitiveOptions(s,n,a){return await this.applyPasswordProtectedFields(s,n,a)}async approve(s){await this.respondOnce(In.authorizeAddress,s)}async reject(s){await this.respondOnce(In.authorizeAddress,null)}async respondOnce(s,n){if(!this.hasResponded){this.hasResponded=!0;try{await this.adapter.respondWith(this.eventId,s,n)}finally{await this.adapter.removeEventId(this.eventId)}}}async applyPasswordProtectedFields(s,n,a){const r=a.signMessage?.trim()??"",o=!!r,d=!!a.getMain;if(!o&&!d)return s;const i=new Map;for(const u of n)i.set(u.id,u);const l=new Map,m=new Set;for(const u of s){const f=this.getWalletIdFromMagic(u.magic),h=i.get(f),g=h?.encryptedMnemonic;if(!h||!g)throw new Error("Missing secret");const b=u.chainName.trim().toLowerCase();if(d){let p=l.get(f);if(!p){try{p=await hs(g,a.password)}catch{throw new Error("Invalid password")}l.set(f,p)}u.main=p}if(o){if(jn(b)){let p=l.get(f);if(!p){try{p=await hs(g,a.password)}catch{throw new Error("Invalid password")}l.set(f,p)}const x=Nn(p),v=wn(r,x.secretKey);u.signMessage=`0x${$e(v)}`,u.publicKey=$e(x.publicKey);continue}if(!m.has(f))if(l.has(f))m.add(f);else{if(!await Vt(g,a.password))throw new Error("Invalid password");m.add(f)}u.signMessage=this.createDeterministicMockSignature({message:r,address:u.address,chainName:u.chainName})}}return s}getWalletIdFromMagic(s){const n=s.indexOf(":");return n===-1?s:s.slice(0,n)}createDeterministicMockSignature({message:s,address:n,chainName:a}){const r=new TextEncoder,o=at(r.encode(`address:${n}|chain:${a}|message:${s}`)),d=at(r.encode(`event:${this.eventId}`)),i=new Uint8Array(64);return i.set(o,0),i.set(d,32),`0x${$e(i)}`}}class pc{constructor(s,n){this.adapter=s,this.eventId=n}hasResponded=!1;async approve(s){await this.respondOnce(In.authorizeSignature,s)}async reject(s){await this.respondOnce(In.authorizeSignature,null)}async handleMessageSign(s,n,a){const r=s.chainName.trim(),o=r.toLowerCase(),d=lt.getConfig(r)??lt.getConfig(o);if(jn(o)||d?.chainKind==="bioforest"){let m;try{m=await hs(n,a)}catch{throw new Error("Invalid password")}const u=Nn(m),f=d?.prefix??(s.senderAddress.slice(0,1)||"b");if(Af(u.publicKey,f)!==s.senderAddress)throw new Error("Signing address mismatch");const g=wn(s.message,u.secretKey);return{signature:`0x${$e(g)}`,publicKey:$e(u.publicKey)}}if(!await Vt(n,a))throw new Error("Invalid password");{const m=new TextEncoder,u=at(m.encode(`message:${s.message}`)),f=at(m.encode(`event:${this.eventId}`)),h=new Uint8Array(64);h.set(u,0),h.set(f,32);const g=at(m.encode(`pubkey:${s.senderAddress}`));return{signature:`0x${$e(h)}`,publicKey:$e(g)}}}async handleTransferSign(s,n,a){const r=s.chainName.trim().toLowerCase(),o=["transfer",r,s.senderAddress,s.receiveAddress,s.balance,s.fee??"",s.contractInfo?.assetType??s.assetType??"",s.contractInfo?.contractAddress??"",s.contractInfo?.decimals?.toString()??""].join("|");if(jn(r)){let f;try{f=await hs(n,a)}catch{throw new Error("Invalid password")}const h=Nn(f),g=wn(o,h.secretKey);return`0x${$e(g)}`}if(!await Vt(n,a))throw new Error("Invalid password");const i=new TextEncoder,l=at(i.encode(o)),m=at(i.encode(`event:${this.eventId}`)),u=new Uint8Array(64);return u.set(l,0),u.set(m,32),`0x${$e(u)}`}async handleDestroySign(s,n,a){const r=s.chainName.trim().toLowerCase(),o=["destory",r,s.senderAddress,s.destoryAddress,s.destoryAmount,s.fee??"",s.assetType??""].join("|");if(jn(r)){let f;try{f=await hs(n,a)}catch{throw new Error("Invalid password")}const h=Nn(f),g=wn(o,h.secretKey);return`0x${$e(g)}`}if(!await Vt(n,a))throw new Error("Invalid password");const i=new TextEncoder,l=at(i.encode(o)),m=at(i.encode(`event:${this.eventId}`)),u=new Uint8Array(64);return u.set(l,0),u.set(m,32),`0x${$e(u)}`}async respondOnce(s,n){if(!this.hasResponded){this.hasResponded=!0;try{await this.adapter.respondWith(this.eventId,s,n)}finally{await this.adapter.removeEventId(this.eventId)}}}}class Qp{async getCallerAppInfo(s){throw new Error("DWEB runtime not available in web environment")}async respondWith(s,n,a){throw new Error("DWEB runtime not available in web environment")}async removeEventId(s){}isAvailable(){return!1}}const Us=new Qp,Yp={"zh-CN":Ps.wordlists.chinese_simplified,"zh-TW":Ps.wordlists.chinese_traditional,ja:Ps.wordlists.japanese,ko:Ps.wordlists.korean},Xp=["zh-CN","zh-TW","ja","ko"];function Tn(t){const s=Yp[t]??Ps.wordlists.english,n=s[Math.floor(Math.random()*s.length)];return Xp.includes(t)?n:n.charAt(0).toUpperCase()+n.slice(1)}function Zp(){return typeof window>"u"}function fn(){return!Zp()}function eh(){const t={value:null};function s(){return t.value}function n(a){t.value=a}return[s,n]}var aa,oi;function th(){if(oi)return aa;oi=1;var t=typeof Element<"u",s=typeof Map=="function",n=typeof Set=="function",a=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function r(o,d){if(o===d)return!0;if(o&&d&&typeof o=="object"&&typeof d=="object"){if(o.constructor!==d.constructor)return!1;var i,l,m;if(Array.isArray(o)){if(i=o.length,i!=d.length)return!1;for(l=i;l--!==0;)if(!r(o[l],d[l]))return!1;return!0}var u;if(s&&o instanceof Map&&d instanceof Map){if(o.size!==d.size)return!1;for(u=o.entries();!(l=u.next()).done;)if(!d.has(l.value[0]))return!1;for(u=o.entries();!(l=u.next()).done;)if(!r(l.value[1],d.get(l.value[0])))return!1;return!0}if(n&&o instanceof Set&&d instanceof Set){if(o.size!==d.size)return!1;for(u=o.entries();!(l=u.next()).done;)if(!d.has(l.value[0]))return!1;return!0}if(a&&ArrayBuffer.isView(o)&&ArrayBuffer.isView(d)){if(i=o.length,i!=d.length)return!1;for(l=i;l--!==0;)if(o[l]!==d[l])return!1;return!0}if(o.constructor===RegExp)return o.source===d.source&&o.flags===d.flags;if(o.valueOf!==Object.prototype.valueOf&&typeof o.valueOf=="function"&&typeof d.valueOf=="function")return o.valueOf()===d.valueOf();if(o.toString!==Object.prototype.toString&&typeof o.toString=="function"&&typeof d.toString=="function")return o.toString()===d.toString();if(m=Object.keys(o),i=m.length,i!==Object.keys(d).length)return!1;for(l=i;l--!==0;)if(!Object.prototype.hasOwnProperty.call(d,m[l]))return!1;if(t&&o instanceof Element)return!1;for(l=i;l--!==0;)if(!((m[l]==="_owner"||m[l]==="__v"||m[l]==="__o")&&o.$$typeof)&&!r(o[m[l]],d[m[l]]))return!1;return!0}return o!==o&&d!==d}return aa=function(d,i){try{return r(d,i)}catch(l){if((l.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw l}},aa}var sh=th();const _s=Qu(sh);function hc(t){const s=c.useRef(t),n=s.current,a=_s(n,t);return c.useEffect(()=>{a||(s.current=t)},[t]),a?n:t}var pr=c.createContext(null),xc=({children:t,value:s})=>e.jsx(pr.Provider,{value:hc(s),children:t});xc.displayName="ActivityProvider";var nh=()=>c.useContext(pr);function ah(){return c.useContext(pr).params}var gc=c.createContext(null),vc=({children:t,value:s})=>e.jsx(gc.Provider,{value:hc(s),children:t});vc.displayName="StackProvider";var rh=()=>c.useContext(gc),ih=Object.defineProperty,oh=Object.defineProperties,ch=Object.getOwnPropertyDescriptors,Pn=Object.getOwnPropertySymbols,yc=Object.prototype.hasOwnProperty,bc=Object.prototype.propertyIsEnumerable,ci=(t,s,n)=>s in t?ih(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,xe=(t,s)=>{for(var n in s||(s={}))yc.call(s,n)&&ci(t,n,s[n]);if(Pn)for(var n of Pn(s))bc.call(s,n)&&ci(t,n,s[n]);return t},Ne=(t,s)=>oh(t,ch(s)),lh=(t,s)=>{var n={};for(var a in t)yc.call(t,a)&&s.indexOf(a)<0&&(n[a]=t[a]);if(t!=null&&Pn)for(var a of Pn(t))s.indexOf(a)<0&&bc.call(t,a)&&(n[a]=t[a]);return n};function dh(t,s,n){const a=n(t),r=n(s);return a<r?-1:a===r?0:1}var uh=(t,s)=>{const n=[],a=[];return t.forEach(r=>{s(r)?n.push(r):a.push(r)}),[n,a]};function jc(t,s){return t.map((n,a)=>s(n)?a:void 0).filter(n=>typeof n=="number")}var ra=0,li=0,Nc=()=>{const t=new Date().getTime();return li===t?ra+=1:(li=t,ra=0),(t*1e3+ra)/1e3};function rt(){return(Nc()*1e3).toString(16)}function Qn(t){return t.length===0?void 0:t[t.length-1]}function di(t,s){const n=xe({},t);return s.forEach(a=>{delete n[a]}),n}function mh(t){let s=!1;return()=>{s||(s=!0,t())}}function fh(t,s){const n=new Map;return[...t].reverse().filter(a=>{const r=s(a);if(r===null)return!0;const o=!!n.get(r);return n.set(r,!0),!o}).reverse()}function Sa(t){return!t.exitedBy}function Aa(t,s){return s.enteredBy.eventDate-t.enteredBy.eventDate}function ui(t){return t.filter(Sa).sort(Aa)[0]}function ph(t,s,n){const a=[];switch(s.name){case"Replaced":{if(Qn(jc(t,l=>l.id===s.activityId))!==void 0)break;const o=t.slice().sort(Aa).filter(Sa),d=n.now-s.eventDate>=n.transitionDuration;if((s.skipEnterActiveState||d?"enter-done":"enter-active")==="enter-done"){const l=o.findIndex(m=>!(s.skipEnterActiveState&&m.enteredBy.name==="Replaced"&&m.transitionState==="enter-active"));return o.slice(0,l+1).map(m=>t.indexOf(m))}break}case"Popped":{const r=t.filter(Sa).sort(Aa),o=r.slice(0,r.length-1)[0];o&&a.push(t.indexOf(o));break}case"StepPushed":case"StepReplaced":{const r=ui(t);if(r){if(s.targetActivityId&&s.targetActivityId!==r.id)break;a.push(t.indexOf(r))}break}case"StepPopped":{const r=ui(t);if(r&&r.steps.length>1){if(s.targetActivityId&&s.targetActivityId!==r.id)break;a.push(t.indexOf(r))}break}}return a}function mi(t,s){switch(s.name){case"Pushed":case"Replaced":{const n=Qn(jc(t,a=>a.id===s.activityId));return n??t.length}default:return-1}}function fi(t,s){return{id:t.activityId,name:t.activityName,transitionState:s,params:t.activityParams,context:t.activityContext,steps:[{id:t.activityId,params:t.activityParams,enteredBy:t,zIndex:-1}],enteredBy:t,isTop:!1,isActive:!1,isRoot:!1,zIndex:-1}}function hr(t){return(s,n)=>{const a=t[n.name].bind(t);if(a)return a(s,n);throw new Error(`No reducer for event ${JSON.stringify(n)}`)}}function gt(t){return t}function hh({transitionDuration:t,now:s,resumedAt:n}){return hr({Pushed(a,r){const o=s-(n??r.eventDate)>=t,d=r.skipEnterActiveState||o?"enter-done":"enter-active",i=mi(a,r);return[...a.slice(0,i),fi(r,d),...a.slice(i+1)]},Replaced(a,r){var o,d;const i=s-(n??r.eventDate)>=t,l=mi(a,r),m=(d=(o=a[l])==null?void 0:o.transitionState)!=null?d:r.skipEnterActiveState||i?"enter-done":"enter-active";return[...a.slice(0,l),fi(r,m),...a.slice(l+1)]},Initialized:gt,ActivityRegistered:gt,Popped:gt,StepPushed:gt,StepReplaced:gt,StepPopped:gt,Paused:gt,Resumed:gt})}function Ss(t){return t}function xh(t){return hr({Replaced:(s,n)=>Ne(xe({},s),{exitedBy:n,transitionState:"exit-done"}),Popped:(s,n)=>{var a;const r=t.now-((a=t.resumedAt)!=null?a:n.eventDate)>=t.transitionDuration,o=n.skipExitActiveState||r?"exit-done":"exit-active";return Ne(xe({},s),{exitedBy:n,transitionState:o,params:o==="exit-done"?s.steps[0].params:s.params,steps:o==="exit-done"?[s.steps[0]]:s.steps})},StepPushed:(s,n)=>{var a;const r={id:n.stepId,params:n.stepParams,enteredBy:n,zIndex:s.zIndex,hasZIndex:(a=n.hasZIndex)!=null?a:!1};return Ne(xe({},s),{params:n.stepParams,steps:[...s.steps,r]})},StepReplaced:(s,n)=>{var a;const r={id:n.stepId,params:n.stepParams,enteredBy:n,zIndex:s.zIndex,hasZIndex:(a=n.hasZIndex)!=null?a:!1};return Ne(xe({},s),{params:n.stepParams,steps:[...s.steps.slice(0,s.steps.length-1),r]})},StepPopped:(s,n)=>{var a;s.steps.pop();const r=(a=Qn(s.steps))==null?void 0:a.params;return Ne(xe({},s),{params:r??s.params})},Initialized:Ss,ActivityRegistered:Ss,Pushed:Ss,Paused:Ss,Resumed:Ss})}function nt(t){return(s,n)=>s.globalTransitionState==="paused"?Ne(xe({},s),{pausedEvents:s.pausedEvents?[...s.pausedEvents,n]:[n]}):t(s,n)}function Ke(t,s){return(n,a)=>{const r=hh({transitionDuration:n.transitionDuration,now:s.now,resumedAt:s.resumedAt}),o=xh({transitionDuration:n.transitionDuration,now:s.now,resumedAt:s.resumedAt}),d=r(n.activities,a),i=ph(n.activities,a,{transitionDuration:n.transitionDuration,now:s.now});for(const u of i)d[u]=o(d[u],a);const l=d.find(u=>u.transitionState==="enter-active"||u.transitionState==="exit-active"),m=n.globalTransitionState==="paused"?"paused":l?"loading":"idle";return t(Ne(xe({},n),{activities:d,globalTransitionState:m}),a)}}function cs(t,s){return Ne(xe({},t),{events:[...t.events,s]})}function wc(t){return hr({Initialized:nt(Ke((s,n)=>Ne(xe({},s),{transitionDuration:n.transitionDuration,events:[...s.events,n]}),t)),ActivityRegistered:nt(Ke((s,n)=>Ne(xe({},s),{registeredActivities:[...s.registeredActivities,xe({name:n.activityName},n.activityParamsSchema?{paramsSchema:n.activityParamsSchema}:null)],events:[...s.events,n]}),t)),Paused:nt(Ke((s,n)=>Ne(xe({},s),{globalTransitionState:"paused",events:[...s.events,n]}),t)),Resumed:Ke((s,n)=>{if(s.globalTransitionState!=="paused"||!s.pausedEvents)return Ne(xe({},s),{events:[...s.events,n]});const a=wc({now:t.now,resumedAt:n.eventDate}),r=s,{pausedEvents:o}=r,d=lh(r,["pausedEvents"]),i=o.reduce(a,Ne(xe({},d),{globalTransitionState:"idle"}));return Ne(xe({},i),{events:[...i.events,n]})},t),Pushed:nt(Ke(cs,t)),Replaced:nt(Ke(cs,t)),Popped:nt(Ke(cs,t)),StepPushed:nt(Ke(cs,t)),StepReplaced:nt(Ke(cs,t)),StepPopped:nt(Ke(cs,t))})}function ia(t,s){return t.filter(n=>n.name===s)}function kn(t,s){return Ne(xe({id:rt(),eventDate:Nc()},s),{name:t})}function gh(t){if(t.length===0)throw new Error("events parameter is empty");if(ia(t,"Initialized").length>1)throw new Error("InitializedEvent can only exist once");const n=ia(t,"ActivityRegistered"),a=new Set(n.map(o=>o.activityName));if(ia(t,"Pushed").some(o=>!a.has(o.activityName)))throw new Error("the corresponding activity does not exist")}function oa(t,s){const n=fh([...t].sort((u,f)=>u.eventDate-f.eventDate),u=>u.id);gh(n);const a=wc({now:s}),r=n.reduce(a,{activities:[],globalTransitionState:"idle",registeredActivities:[],transitionDuration:0,events:[]}),o=r.activities.filter(u=>u.transitionState==="enter-active"||u.transitionState==="enter-done"||u.transitionState==="exit-active"),d=o.filter(u=>u.transitionState==="enter-active"||u.transitionState==="enter-done"),i=o[o.length-1],l=d[d.length-1];return Ne(xe({},r),{activities:r.activities.map(u=>{let f=o.findIndex(({id:b})=>b===u.id);const h=o.slice(0,f);for(const b of h)for(const p of b.steps)p.hasZIndex&&(f+=1);const g=u.steps.reduce((b,p)=>{var x;const v=Qn(b),j=(x=v?.zIndex)!=null?x:f;return[...b,Ne(xe({},p),{zIndex:j+(p.hasZIndex?1:0)})]},[]);return xe(xe({id:u.id,name:u.name,transitionState:u.transitionState,params:u.params,steps:g,enteredBy:u.enteredBy,zIndex:f,isTop:i?.id===u.id,isActive:l?.id===u.id,isRoot:f===0||f===1&&u.transitionState==="enter-active"&&u.enteredBy.name==="Replaced"},u.exitedBy?{exitedBy:u.exitedBy}:null),u.context?{context:u.context}:null)}).sort((u,f)=>dh(u,f,h=>h.id))})}function vh(t,s){var n,a,r,o,d,i,l,m;const u=[];!_s(t,s)&&u.push({_TAG:"%SOMETHING_CHANGED%"});const h=t.globalTransitionState!=="paused"&&s.globalTransitionState==="paused",g=t.globalTransitionState==="paused"&&s.globalTransitionState!=="paused";h&&u.push({_TAG:"PAUSED"}),g&&u.push({_TAG:"RESUMED"});for(let b=0;b<Math.max(t.activities.length,s.activities.length);b+=1){const p=t.activities[b],x=s.activities[b],v=p?.transitionState==="exit-done"||p?.transitionState==="exit-active",j=x?.transitionState==="enter-active"||x?.transitionState==="enter-done";if(p&&x&&p.id===x.id)for(let N=0;N<Math.max(((n=p.steps)!=null?n:[]).length,((a=x.steps)!=null?a:[]).length);N+=1){const y=p.steps[N],S=x.steps[N];!y&&S?u.push({_TAG:"STEP_PUSHED",activity:x,step:S}):y&&!S?u.push({_TAG:"STEP_POPPED",activity:x}):p.steps.length===x.steps.length&&y.id!==S.id&&u.push({_TAG:"STEP_REPLACED",activity:x,step:S})}!p&&x?u.push({_TAG:x.enteredBy.name==="Pushed"?"PUSHED":"REPLACED",activity:x}):v&&j?u.push({_TAG:x.enteredBy.name==="Pushed"?"PUSHED":"REPLACED",activity:x}):p&&x&&p.id===x.id&&!_s(di(p,["isActive","isTop","isRoot","transitionState","zIndex"]),di(x,["isActive","isTop","isRoot","transitionState","zIndex"]))&&x.enteredBy.name==="Replaced"&&!_s(p.enteredBy,x.enteredBy)&&u.push({_TAG:"REPLACED",activity:x})}for(let b=Math.max(t.activities.length,s.activities.length)-1;b>=0;b-=1){const p=((r=t.activities[b])==null?void 0:r.transitionState)==="enter-done"||((o=t.activities[b])==null?void 0:o.transitionState)==="enter-active",x=((d=s.activities[b])==null?void 0:d.transitionState)==="exit-active"||((i=s.activities[b])==null?void 0:i.transitionState)==="exit-done",v=((l=s.activities[b+1])==null?void 0:l.enteredBy.name)==="Replaced"&&((m=s.activities[b+1])==null?void 0:m.transitionState)==="enter-done";p&&x&&!v&&u.push({_TAG:"POPPED",activity:s.activities[b]})}return u}var yh={Pushed:"onBeforePush",Replaced:"onBeforeReplace",Popped:"onBeforePop",StepPushed:"onBeforeStepPush",StepReplaced:"onBeforeStepReplace",StepPopped:"onBeforeStepPop",Paused:"onBeforePause",Resumed:"onBeforeResume"};function vt(t,s,n,a){let r=!1,o=xe({},s);for(const d of n){const i=d[yh[t]];i&&i({actionParams:xe({},o),actions:Ne(xe({},a),{preventDefault:()=>{r=!0},overrideActionParams:l=>{o=xe(xe({},o),l)}})})}return{isPrevented:r,nextActionParams:o}}function bh({dispatchEvent:t,pluginInstances:s,actions:n}){return{push(a){const{isPrevented:r,nextActionParams:o}=vt("Pushed",a,s,n);r||t("Pushed",o)},replace(a){const{isPrevented:r,nextActionParams:o}=vt("Replaced",a,s,n);r||t("Replaced",o)},pop(a={}){const{isPrevented:r,nextActionParams:o}=vt("Popped",a,s,n);r||t("Popped",o)},stepPush(a){const{isPrevented:r,nextActionParams:o}=vt("StepPushed",a,s,n);r||t("StepPushed",o)},stepReplace(a){const{isPrevented:r,nextActionParams:o}=vt("StepReplaced",a,s,n);r||t("StepReplaced",o)},stepPop(a={}){const{isPrevented:r,nextActionParams:o}=vt("StepPopped",a,s,n);r||t("StepPopped",o)},pause(a={}){const{isPrevented:r,nextActionParams:o}=vt("Paused",a,s,n);r||t("Paused",o)},resume(a={}){const{isPrevented:r,nextActionParams:o}=vt("Resumed",a,s,n);r||t("Resumed",o)}}}function jh(t,s,n){t.forEach(a=>{s.forEach(r=>{var o,d,i,l,m,u,f,h,g;switch(a._TAG){case"PUSHED":(o=r.onPushed)==null||o.call(r,{actions:n,effect:a});break;case"REPLACED":(d=r.onReplaced)==null||d.call(r,{actions:n,effect:a});break;case"POPPED":(i=r.onPopped)==null||i.call(r,{actions:n,effect:a});break;case"STEP_PUSHED":(l=r.onStepPushed)==null||l.call(r,{actions:n,effect:a});break;case"STEP_REPLACED":(m=r.onStepReplaced)==null||m.call(r,{actions:n,effect:a});break;case"STEP_POPPED":(u=r.onStepPopped)==null||u.call(r,{actions:n,effect:a});break;case"PAUSED":(f=r.onPaused)==null||f.call(r,{actions:n,effect:a});break;case"RESUMED":(h=r.onResumed)==null||h.call(r,{actions:n,effect:a});break;case"%SOMETHING_CHANGED%":(g=r.onChanged)==null||g.call(r,{actions:n,effect:a});break}})})}var Nh=1e3,wh=Nh/60;function pi(t){var s,n,a,r;const o=[],i=[{key:"@stackflow/core",onChanged(){o.forEach(x=>x())}},...t.plugins.map(x=>x())],[l,m]=uh(t.initialEvents,x=>x.name==="Pushed"||x.name==="StepPushed"),u=i.reduce((x,v)=>{var j,N,y;return(y=(N=v.overrideInitialEvents)==null?void 0:N.call(v,{initialEvents:x,initialContext:(j=t.initialContext)!=null?j:{}}))!=null?y:x},l);u.length>0&&l.length>0&&u!==l&&((n=(s=t.handlers)==null?void 0:s.onInitialActivityIgnored)==null||n.call(s,u)),u.length===0&&((r=(a=t.handlers)==null?void 0:a.onInitialActivityNotFound)==null||r.call(a));const h={value:[...m,...u]},g={value:oa(h.value,new Date().getTime())},b={getStack(){return g.value},dispatchEvent(x,v){const j=kn(x,v),N=oa([...h.value,j],new Date().getTime());h.value.push(j),p(N);const y=setInterval(()=>{const S=oa(h.value,new Date().getTime());_s(g.value,S)||p(S),S.globalTransitionState==="idle"&&clearInterval(y)},wh)},push:()=>{},replace:()=>{},pop:()=>{},stepPush:()=>{},stepReplace:()=>{},stepPop:()=>{},pause:()=>{},resume:()=>{}},p=x=>{const v=vh(g.value,x);g.value=x,jh(v,i,b)};return Object.assign(b,bh({dispatchEvent:b.dispatchEvent,pluginInstances:i,actions:b})),{actions:b,init:mh(()=>{i.forEach(x=>{var v;(v=x.onInit)==null||v.call(x,{actions:b})})}),pullEvents:()=>h.value,subscribe(x){return o.push(x),function(){const j=o.findIndex(N=>N===x);j>-1&&o.splice(j,1)}},pluginInstances:i}}var kc=c.createContext(null);function kh(){const t=c.useContext(kc);if(t===null)throw new Error("useActivityComponentMap must be used within ActivityComponentMapProvider");return t}function Ch({children:t,value:s}){return e.jsx(kc.Provider,{value:s,children:t})}var En=t=>s=>s.find(({id:n})=>n===t);function Sh(t){return!t.exitedBy}function Ah(t,s){return s.enteredBy.eventDate-t.enteredBy.eventDate}function _n(t){return t.filter(Sh).sort(Ah)[0]}function Ht(){return rt()}function Mn(){return rt()}var hi,Ih=(hi=Ja.useDeferredValue)!=null?hi:t=>t,xi,Th=(xi=Ja.useSyncExternalStore)!=null?xi:(t,s)=>{const[n,a]=c.useState(()=>s());return c.useEffect(()=>t(()=>{a(()=>s())})),n},gi,Cc=(gi=Ja.useTransition)!=null?gi:()=>[!1,t=>t()],Sc=c.createContext(null),Ac=c.createContext(null),Ic=({coreStore:t,children:s})=>{const n=Th(t.subscribe,t.actions.getStack,t.actions.getStack),a=Ih(n);return e.jsx(Ac.Provider,{value:a,children:e.jsx(Sc.Provider,{value:t.actions,children:s})})};Ic.displayName="CoreProvider";var Tc=()=>c.useContext(Sc),Pc=()=>c.useContext(Ac),Ec=c.createContext(null),_c=({children:t,value:s})=>e.jsx(Ec.Provider,{value:s,children:t});_c.displayName="PluginsProvider";function Mc(){return c.useContext(Ec)}function Ph(t){return typeof t=="object"&&t!==null&&"then"in t&&typeof t.then=="function"}var ke={PENDING:"pending",FULFILLED:"fulfilled",REJECTED:"rejected"};function xr(t){if(t.status===ke.PENDING)return{status:ke.PENDING};if(t.status===ke.FULFILLED&&"value"in t)return{status:ke.FULFILLED,value:t.value};if(t.status===ke.REJECTED&&"reason"in t)return{status:ke.REJECTED,reason:t.reason};throw new Error("Invalid promise state")}function Eh(t){if("status"in t&&Object.values(ke).some(n=>n===t.status))return t;const s=Object.assign(t,{status:ke.PENDING});return s.then(n=>{s.status=ke.FULFILLED,s.value=n},n=>{s.status=ke.REJECTED,s.reason=n}),s}function Cn(t){return Ph(t)?Eh(t instanceof Promise?t:Promise.resolve(t)):Object.assign(Promise.resolve(t),{status:ke.FULFILLED,value:t})}function _h(t){return Object.assign(Promise.reject(t),{status:ke.REJECTED,reason:t})}function Mh(t){const s=Cn(t),n=xr(s);if(n.status===ke.FULFILLED)return n.value;throw n.status===ke.REJECTED?n.reason:s}var Rh=Object.defineProperty,vi=Object.getOwnPropertySymbols,Lh=Object.prototype.hasOwnProperty,Dh=Object.prototype.propertyIsEnumerable,yi=(t,s,n)=>s in t?Rh(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,zh=(t,s)=>{for(var n in s||(s={}))Lh.call(s,n)&&yi(t,n,s[n]);if(vi)for(var n of vi(s))Dh.call(s,n)&&yi(t,n,s[n]);return t},Oh=(t,s,n)=>new Promise((a,r)=>{var o=l=>{try{i(n.next(l))}catch(m){r(m)}},d=l=>{try{i(n.throw(l))}catch(m){r(m)}},i=l=>l.done?a(l.value):Promise.resolve(l.value).then(o,d);i((n=n.apply(t,s)).next())});function Bh(t){let s=null;const n=()=>((!s||xr(s).status===ke.REJECTED)&&(s=t()),s);return{Component:r=>{const{default:o}=Mh(n());return e.jsx(o,zh({},r))},preload:()=>Oh(this,null,function*(){yield n()})}}var Fh=Symbol("STRUCTURED_ACTIVITY_COMPONENT_TYPE");function Wh(t){return t!==null&&typeof t=="object"&&Fh in t}var ca=new WeakMap;function $h(t){if(ca.has(t))return ca.get(t);const{Component:s}=Bh(()=>{const n=t.content,a=Cn(typeof n=="function"?n():{default:n}),r=xr(a);return r.status===ke.FULFILLED?Cn({default:r.value.default.component}):r.status===ke.REJECTED?_h(r.reason):Cn(a.then(o=>({default:o.default.component})))});return ca.set(t,s),s}var qh=Object.defineProperty,Hh=Object.defineProperties,Uh=Object.getOwnPropertyDescriptors,bi=Object.getOwnPropertySymbols,Vh=Object.prototype.hasOwnProperty,Jh=Object.prototype.propertyIsEnumerable,Ia=(t,s,n)=>s in t?qh(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Bt=(t,s)=>{for(var n in s||(s={}))Vh.call(s,n)&&Ia(t,n,s[n]);if(bi)for(var n of bi(s))Jh.call(s,n)&&Ia(t,n,s[n]);return t},la=(t,s)=>Hh(t,Uh(s)),ji=(t,s,n)=>Ia(t,typeof s!="symbol"?s+"":s,n),Rc=({plugin:t,initialContext:s})=>{const n=kh(),a=Pc(),r=Mc();return t.render({stack:la(Bt({},a),{render(o){return{activities:Bt(Bt({},a),o).activities.map(i=>la(Bt({},i),{key:i.id,render(l){const m=n[i.name];let u=Wh(m)?Gh(m,i.params):e.jsx(m,{params:i.params});return r.forEach(f=>{var h,g;u=(g=(h=f.wrapActivity)==null?void 0:h.call(f,{activity:la(Bt({},i),{render:()=>u}),initialContext:s}))!=null?g:u}),e.jsx(xc,{value:Bt(Bt({},i),l),children:u},i.id)}}))}}}),initialContext:s})};Rc.displayName="PluginRenderer";var Kh=Rc;function Gh(t,s){const{layout:n,loading:a,errorHandler:r}=t,o=$h(t);return[i=>a?.component?e.jsx(c.Suspense,{fallback:e.jsx(a.component,{params:s}),children:i}):i,i=>{var l;if(!r)return i;const m=(l=r.boundary)!=null?l:Qh;return e.jsx(m,{renderFallback:(u,f)=>e.jsx(r.component,{params:s,error:u,reset:f}),children:i})},i=>n?.component?e.jsx(n.component,{params:s,children:i}):i].reduce((i,l)=>l(i),e.jsx(o,{params:s}))}var Qh=class extends c.Component{constructor(){super(...arguments),ji(this,"state",{hasError:!1,error:null}),ji(this,"reset",()=>this.setState({hasError:!1,error:null}))}render(){return this.state.hasError?this.props.renderFallback(this.state.error,this.reset):this.props.children}static getDerivedStateFromError(t){return{hasError:!0,error:t}}},Yh=Object.defineProperty,Xh=Object.defineProperties,Zh=Object.getOwnPropertyDescriptors,Ni=Object.getOwnPropertySymbols,ex=Object.prototype.hasOwnProperty,tx=Object.prototype.propertyIsEnumerable,wi=(t,s,n)=>s in t?Yh(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,sx=(t,s)=>{for(var n in s||(s={}))ex.call(s,n)&&wi(t,n,s[n]);if(Ni)for(var n of Ni(s))tx.call(s,n)&&wi(t,n,s[n]);return t},nx=(t,s)=>Xh(t,Zh(s)),Lc=({initialContext:t})=>{const s=Pc(),n=Mc(),a=n.filter(o=>!!o.render);c.useEffect(()=>{a.length===0&&console.warn(`Stackflow - There is no rendering plugin, so "<Stack />" doesn't render anything. If you want to render some UI, use "@stackflow/plugin-renderer-basic" or add another rendering plugin.`)},[a]);let r=e.jsx(e.Fragment,{children:a.map(o=>e.jsx(Kh,{plugin:o,initialContext:t},o.key))});return n.forEach(o=>{var d,i;r=(i=(d=o.wrapStack)==null?void 0:d.call(o,{stack:nx(sx({},s),{render(){return r}}),initialContext:t}))!=null?i:r}),e.jsx(vc,{value:s,children:r})};Lc.displayName="MainRenderer";var ax=Lc,rx=Object.defineProperty,ki=Object.getOwnPropertySymbols,ix=Object.prototype.hasOwnProperty,ox=Object.prototype.propertyIsEnumerable,Ci=(t,s,n)=>s in t?rx(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Si=(t,s)=>{for(var n in s||(s={}))ix.call(s,n)&&Ci(t,n,s[n]);if(ki)for(var n of ki(s))ox.call(s,n)&&Ci(t,n,s[n]);return t};function da(t){return t?t.animate==null?{skipActiveState:!1}:{skipActiveState:!t.animate}:{skipActiveState:!1}}function rn(){const t=Tc(),[s]=Cc();return c.useMemo(()=>({pending:s,push(n,a,r){const o=Ht();return t?.push({activityId:o,activityName:n,activityParams:a,skipEnterActiveState:da(r).skipActiveState}),{activityId:o}},replace(n,a,r){var o;const d=Ht();return t?.replace({activityId:(o=r?.activityId)!=null?o:Ht(),activityName:n,activityParams:a,skipEnterActiveState:da(r).skipActiveState}),{activityId:d}},pop(n,a){let r=1,o={};typeof n=="object"&&(o=Si({},n)),typeof n=="number"&&(r=n),a&&(o=Si({},a));for(let d=0;d<r;d+=1)t?.pop({skipExitActiveState:d===0?da(o).skipActiveState:!0})}}),[t?.push,t?.replace,t?.pop,s])}var cx=()=>{const t=Tc(),[s]=Cc();return c.useMemo(()=>({pending:s,stepPush(n,a){const r=t?.getStack().activities,o=a?.targetActivityId?En(a.targetActivityId):_n,d=r&&o(r);if(!d)throw new Error("The target activity is not found.");const i=typeof n=="function"?n(d.params):n,l=Mn();t?.stepPush({stepId:l,stepParams:i,targetActivityId:a?.targetActivityId})},stepReplace(n,a){const r=t?.getStack().activities,o=a?.targetActivityId?En(a.targetActivityId):_n,d=r&&o(r);if(!d)throw new Error("The target activity is not found.");const i=typeof n=="function"?n(d.params):n,l=Mn();t?.stepReplace({stepId:l,stepParams:i,targetActivityId:a?.targetActivityId})},stepPop(n){t?.stepPop({targetActivityId:n?.targetActivityId})}}),[t?.stepPush,t?.stepReplace,t?.stepPop,t?.getStack,s])},lx=Object.defineProperty,dx=Object.defineProperties,ux=Object.getOwnPropertyDescriptors,Ai=Object.getOwnPropertySymbols,mx=Object.prototype.hasOwnProperty,fx=Object.prototype.propertyIsEnumerable,Ii=(t,s,n)=>s in t?lx(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,pn=(t,s)=>{for(var n in s||(s={}))mx.call(s,n)&&Ii(t,n,s[n]);if(Ai)for(var n of Ai(s))fx.call(s,n)&&Ii(t,n,s[n]);return t},px=(t,s)=>dx(t,ux(s));function ua(t){return t?t.animate==null?{skipActiveState:!1}:{skipActiveState:!t.animate}:{skipActiveState:!1}}function hx(t){var s;const n=((s=t.plugins)!=null?s:[]).flat(Number.POSITIVE_INFINITY).map(m=>m),a=Object.entries(t.activities).reduce((m,[u,f])=>px(pn({},m),{[u]:"component"in f?f.component:f}),{}),r=()=>new Date().getTime()-t.transitionDuration*2,o=pi({initialEvents:[kn("Initialized",{transitionDuration:t.transitionDuration,eventDate:r()}),...Object.entries(t.activities).map(([m,u])=>kn("ActivityRegistered",pn({activityName:m,eventDate:r()},"component"in u?{activityParamsSchema:u.paramsSchema}:null)))],plugins:[]}),[d,i]=eh(),l=c.memo(m=>{const u=c.useMemo(()=>{const f=d();if(fn()&&f)return f;const h=t.initialActivity?[kn("Pushed",{activityId:Ht(),activityName:t.initialActivity(),activityParams:{},eventDate:r(),skipEnterActiveState:!1})]:[],g=pi({initialEvents:[...o.pullEvents(),...h],initialContext:m.initialContext,plugins:n,handlers:{onInitialActivityIgnored:b=>{fn()&&console.warn(`Stackflow - Some plugin overrides an "initialActivity" option. The "initialActivity" option you set to "${b[0].activityName}" in the "stackflow" is ignored.`)},onInitialActivityNotFound:()=>{fn()&&console.warn("Stackflow - There is no initial activity. If you want to set the initial activity, add the `initialActivity` option of the `stackflow()` function or add a plugin that sets the initial activity. (e.g. `@stackflow/plugin-history-sync`)")}}});return fn()&&(g.init(),i(g)),g},[]);return e.jsx(_c,{value:u.pluginInstances,children:e.jsx(Ic,{coreStore:u,children:e.jsx(Ch,{value:a,children:e.jsx(ax,{initialContext:m.initialContext})})})})});return l.displayName="Stack",{activities:t.activities,Stack:l,useFlow:rn,useStepFlow:cx,addActivity(m){if(d()){console.warn("Stackflow - `addActivity()` API cannot be called after a `<Stack />` component has been rendered");return}a[m.name]=c.memo(m.component),o.actions.dispatchEvent("ActivityRegistered",{activityName:m.name,activityParamsSchema:m.paramsSchema,eventDate:r()})},addPlugin(m){if(d()){console.warn("Stackflow - `addPlugin()` API cannot be called after a `<Stack />` component has been rendered");return}[m].flat(Number.POSITIVE_INFINITY).map(u=>u).forEach(u=>{n.push(u)})},actions:{getStack(){var m,u;return(u=(m=d())==null?void 0:m.actions.getStack())!=null?u:o.actions.getStack()},dispatchEvent(m,u){var f;return(f=d())==null?void 0:f.actions.dispatchEvent(m,u)},push(m,u,f){var h;const g=Ht();return(h=d())==null||h.actions.push({activityId:g,activityName:m,activityParams:u,skipEnterActiveState:ua(f).skipActiveState}),{activityId:g}},replace(m,u,f){var h,g,b;const p=(h=f?.activityId)!=null?h:Ht();return(b=d())==null||b.actions.replace({activityId:(g=f?.activityId)!=null?g:Ht(),activityName:m,activityParams:u,skipEnterActiveState:ua(f).skipActiveState}),{activityId:p}},pop(m,u){var f;let h=1,g={};typeof m=="object"&&(g=pn({},m)),typeof m=="number"&&(h=m),u&&(g=pn({},u));for(let b=0;b<h;b+=1)(f=d())==null||f.actions.pop({skipExitActiveState:b===0?ua(g).skipActiveState:!0})},stepPush(m,u){var f,h;const g=(f=d())==null?void 0:f.actions.getStack().activities,b=u?.targetActivityId?En(u.targetActivityId):_n,p=g&&b(g);if(!p)throw new Error("The target activity is not found.");const x=typeof m=="function"?m(p.params):m,v=Mn();return(h=d())==null?void 0:h.actions.stepPush({stepId:v,stepParams:x,targetActivityId:u?.targetActivityId})},stepReplace(m,u){var f,h;const g=(f=d())==null?void 0:f.actions.getStack().activities,b=u?.targetActivityId?En(u.targetActivityId):_n,p=g&&b(g);if(!p)throw new Error("The target activity is not found.");const x=typeof m=="function"?m(p.params):m,v=Mn();return(h=d())==null?void 0:h.actions.stepReplace({stepId:v,stepParams:x,targetActivityId:u?.targetActivityId})},stepPop(m){var u;return(u=d())==null?void 0:u.actions.stepPop({targetActivityId:m?.targetActivityId})}}}}function xx(){return()=>({key:"plugin-renderer-basic",render({stack:t}){return e.jsx(e.Fragment,{children:t.render().activities.filter(s=>s.transitionState!=="exit-done").map(s=>e.jsx(c.Fragment,{children:s.render()},s.key))})}})}function gx(t){var s=t.match(/^var\((.*)\)$/);return s?s[1]:t}function on(t,s){var n={};{var a=t;for(var r in a){var o=a[r];o!=null&&(n[gx(r)]=o)}}return Object.defineProperty(n,"toString",{value:function(){return Object.keys(this).map(i=>"".concat(i,":").concat(this[i])).join(";")},writable:!1}),n}function vx(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function yx(t){var s=vx(t,"string");return typeof s=="symbol"?s:String(s)}function bx(t,s,n){return s=yx(s),s in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function Ti(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,a)}return n}function Pi(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?Ti(Object(n),!0).forEach(function(a){bx(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ti(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function Ei(t,s){var n={};for(var a in t)n[a]=s(t[a],a);return n}var jx=(t,s,n)=>{for(var a of Object.keys(t)){var r;if(t[a]!==((r=s[a])!==null&&r!==void 0?r:n[a]))return!1}return!0},Lt=t=>{var s=n=>{var a=t.defaultClassName,r=Pi(Pi({},t.defaultVariants),n);for(var o in r){var d,i=(d=r[o])!==null&&d!==void 0?d:t.defaultVariants[o];if(i!=null){var l=i;typeof l=="boolean"&&(l=l===!0?"true":"false");var m=t.variantClassNames[o][l];m&&(a+=" "+m)}}for(var[u,f]of t.compoundVariants)jx(u,r,t.defaultVariants)&&(a+=" "+f);return a};return s.variants=()=>Object.keys(t.variantClassNames),s.classNames={get base(){return t.defaultClassName.split(" ")[0]},get variants(){return Ei(t.variantClassNames,n=>Ei(n,a=>a.split(" ")[0]))}},s},Nx=Object.defineProperty,_i=Object.getOwnPropertySymbols,wx=Object.prototype.hasOwnProperty,kx=Object.prototype.propertyIsEnumerable,Mi=(t,s,n)=>s in t?Nx(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Cx=(t,s)=>{for(var n in s||(s={}))wx.call(s,n)&&Mi(t,n,s[n]);if(_i)for(var n of _i(s))kx.call(s,n)&&Mi(t,n,s[n]);return t};function gr(){const[t,s]=c.useReducer(()=>!0,!1);return c.useEffect(()=>{s()},[]),t}function as(){return nh()}function Dc(){const t=as(),s=gr();return Cx({},s?{"data-stackflow-activity-id":t?.id,"data-stackflow-activity-is-active":t?.isActive,"data-stackflow-activity-transition-state":t?.transitionState}:null)}function zc(t,s,n){const a=()=>{s.forEach(r=>{t.removeEventListener(r,a)}),n()};s.forEach(r=>{t.addEventListener(r,a)})}var Sx=t=>(t(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}),tt=()=>{};function Ta(t){requestAnimationFrame(()=>{requestAnimationFrame(()=>{t()})})}function Ax({outerRef:t,innerRef:s,enable:n}){const[a,r]=c.useState(void 0);return c.useEffect(()=>{const o=t&&"current"in t&&t.current,d=s.current;return!n||!o||!d?tt:Sx(()=>{const l=o.clientWidth,m=d.offsetLeft,u=d.clientWidth,f=l-m-u,h=Math.max(m,f);r(l-2*h)})}),{maxWidth:a}}function vr(t){const[s,n]=c.useState(void 0);return c.useEffect(()=>{Ta(()=>{n(t)})},[t]),s}function Ix(){return rh()}function yr({ref:t}){const s=Ix();c.useEffect(()=>{if(!s)return;const n=t.current;if(!n||s.globalTransitionState==="idle")return;const a=r=>{r.preventDefault(),r.stopPropagation()};return n.addEventListener("touchstart",a,{capture:!0}),n.addEventListener("touchmove",a,{capture:!0}),n.addEventListener("touchend",a,{capture:!0}),n.addEventListener("touchcancel",a,{capture:!0}),()=>{n.removeEventListener("touchstart",a,{capture:!0}),n.removeEventListener("touchmove",a,{capture:!0}),n.removeEventListener("touchend",a,{capture:!0}),n.removeEventListener("touchcancel",a,{capture:!0})}},[s?.globalTransitionState])}var As={};function ct({styleName:t,refs:s,effect:n,effectDeps:a}){const r=as();c.useEffect(()=>r?(As[t]||(As[t]=new Map),As[t].set(r.zIndex,{refs:s,hasEffect:!!n}),()=>{As[t].delete(r.zIndex)}):tt,[r?.id,s,n]),c.useEffect(()=>{if(!r||!n)return tt;const o=(()=>{let i=[];for(let l=1;l<=r.zIndex;l+=1){const m=As[t].get(r.zIndex-l);if(m?.refs&&(i=[...i,...m.refs]),m?.hasEffect)break}return i})(),d=n({activityTransitionState:r.transitionState,refs:o});return()=>{d?.()}},[r?.transitionState,...a??[]])}function Tx({refs:t}){ct({styleName:"hide",refs:t,effect:({activityTransitionState:s,refs:n})=>{const a=()=>{n.forEach(r=>{if(!r.current)return;const o=r.current;o.style.display=""})};return s==="enter-done"?(n.forEach(r=>{if(!r.current)return;const o=r.current;o.style.display="none"}),()=>{a()}):(a(),tt)}})}function Px({refs:t,transitionDuration:s,offsetStyles:n,hasEffect:a=!1}){ct({styleName:"offset",refs:t,effect:a?({activityTransitionState:r,refs:o})=>{const d=()=>{Ta(()=>{o.forEach(i=>{if(!i.current)return;const l=i.current;l.style.transform="",l.style.opacity="",zc(l,["transitionend","transitioncancel"],()=>{l.style.transition=""})})})};switch(r){case"enter-active":case"enter-done":return o.forEach(i=>{i.current&&(i.current.style.transition=s,i.current.style.transform=n.transform,i.current.style.opacity=n.opacity)}),r==="enter-done"?()=>{d()}:tt;case"exit-active":case"exit-done":return Ta(()=>{d()}),tt;default:return tt}}:void 0})}var hn="--stackflow-swipe-back-ratio";function Ex({dimRef:t,edgeRef:s,paperRef:n,appBarRef:a,offset:r,transitionDuration:o,preventSwipeBack:d,moveAppBarTogether:i,getActivityTransitionState:l,onSwipeStart:m,onSwipeMove:u,onSwipeEnd:f,onTransitionEnd:h}){ct({styleName:"swipe-back",refs:i&&a?[n,a]:[n],effect:({refs:g})=>{if(d||!t.current||!s.current||!n.current)return tt;const b=t.current,p=s.current,x=n.current,v=a?.current;let j=null,N=null,y=null,S=[];const C=()=>{j=null,N=null,y=null,S=[]};let P=!1;function _({dx:w,ratio:E}){P||(P=!0,requestAnimationFrame(()=>{b.style.opacity=`${1-E}`,b.style.transition="0s",x.style.overflowY="hidden",x.style.transform=`translate3d(${w}px, 0, 0)`,x.style.transition="0s",i&&v&&(v.style.overflowY="hidden",v.style.transform=`translate3d(${w}px, 0, 0)`,v.style.transition="0s"),v?.style.setProperty(hn,String(E)),g.forEach(D=>{var z,R;D.current&&(D.current.style.transform=`translate3d(${-1*(1-E)*r}px, 0, 0)`,D.current.style.transition="0s",((z=D.current.parentElement)==null?void 0:z.style.display)==="none"&&(D.current.parentElement.style.display="block"),(R=D.current.parentElement)==null||R.style.setProperty(hn,String(E)))}),P=!1}))}function I({swiped:w}){return new Promise(E=>{requestAnimationFrame(()=>{b.style.opacity=`${w?0:1}`,b.style.transition=o,x.style.overflowY="hidden",x.style.transform=`translateX(${w?"100%":"0"})`,x.style.transition=o,i&&v&&(v.style.overflowY="hidden",v.style.transform=`translateX(${w?"100%":"0"})`,v.style.transition=o),g.forEach(z=>{z.current&&(z.current.style.transition=o,z.current.style.transform=`translate3d(${w?"0":`-${r/16}rem`}, 0, 0)`)});const D=[...S];E(),zc(x,["transitionend","transitioncancel"],()=>{const z=w||l()==="exit-active"||l()==="exit-done";b.style.opacity="",x.style.overflowY="",x.style.transform="",i&&v&&(v.style.overflowY="",v.style.transform="",v.style.removeProperty("transition")),v?.style.removeProperty(hn),g.forEach((R,V)=>{var M;if(!R.current)return;const B=D[V];z?(R.current.style.transition="",R.current.style.transform="",R.current.parentElement&&(R.current.parentElement.style.display="")):B&&(R.current.style.transition=B.style.transition,R.current.style.transform=B.style.transform,R.current.parentElement&&B.parentElement&&(R.current.parentElement.style.display=B.parentElement.style.display)),(M=R.current.parentElement)==null||M.style.removeProperty(hn)}),h?.({swiped:w})})})})}const T=w=>{var E;const{activeElement:D}=document;(E=D?.blur)==null||E.call(D),j=y=w.touches[0].clientX,N=Date.now(),S=g.map(z=>z.current?{style:{transform:z.current.style.transform,transition:z.current.style.transition},parentElement:z.current.parentElement?{style:{display:z.current.parentElement.style.display}}:void 0}:{style:{transform:"",transition:""}}),m?.()},k=w=>{if(!j){C();return}y=w.touches[0].clientX;const E=y-j,D=E/x.clientWidth;_({dx:E,ratio:D}),u?.({dx:E,ratio:D})},A=()=>{if(!j||!N||!y){C();return}const w=Date.now(),D=(y-j)/(w-N)>1||y/x.clientWidth>.4;f?.({swiped:D}),Promise.resolve().then(()=>I({swiped:D})).then(()=>C())};return p.addEventListener("touchstart",T,{passive:!0}),p.addEventListener("touchmove",k,{passive:!0}),p.addEventListener("touchend",A,{passive:!0}),p.addEventListener("touchcancel",A,{passive:!0}),()=>{p.removeEventListener("touchstart",T),p.removeEventListener("touchmove",k),p.removeEventListener("touchend",A),p.removeEventListener("touchcancel",A)}},effectDeps:[d]})}function Vs(){var t;const s=as();return((t=s?.zIndex)!=null?t:0)*5}var _x=Object.defineProperty,Mx=Object.defineProperties,Rx=Object.getOwnPropertyDescriptors,Ri=Object.getOwnPropertySymbols,Lx=Object.prototype.hasOwnProperty,Dx=Object.prototype.propertyIsEnumerable,Li=(t,s,n)=>s in t?_x(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,$t=(t,s)=>{for(var n in s||(s={}))Lx.call(s,n)&&Li(t,n,s[n]);if(Ri)for(var n of Ri(s))Dx.call(s,n)&&Li(t,n,s[n]);return t},Ms=(t,s)=>Mx(t,Rx(s)),zx=t=>e.jsx("svg",{className:t.className,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.7241 2.76052C17.105 3.16043 17.0896 3.79341 16.6897 4.17431L8.45 12.0222L16.6896 19.8689C17.0896 20.2498 17.105 20.8827 16.7242 21.2827C16.3433 21.6826 15.7103 21.6981 15.3104 21.3172L6.31037 12.7464C6.11218 12.5576 6.00001 12.2959 6 12.0222C5.99999 11.7486 6.11215 11.4868 6.31032 11.2981L15.3103 2.72608C15.7102 2.34518 16.3432 2.3606 16.7241 2.76052Z",fill:"currentColor"})}),Di=zx,Ox=t=>e.jsx("svg",{className:t.className,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M20.7071 4.70711C21.0976 4.31658 21.0976 3.68342 20.7071 3.29289C20.3166 2.90237 19.6834 2.90237 19.2929 3.29289L12 10.5858L4.70711 3.29289C4.31658 2.90237 3.68342 2.90237 3.29289 3.29289C2.90237 3.68342 2.90237 4.31658 3.29289 4.70711L10.5858 12L3.29289 19.2929C2.90237 19.6834 2.90237 20.3166 3.29289 20.7071C3.68342 21.0976 4.31658 21.0976 4.70711 20.7071L12 13.4142L19.2929 20.7071C19.6834 21.0976 20.3166 21.0976 20.7071 20.7071C21.0976 20.3166 21.0976 19.6834 20.7071 19.2929L13.4142 12L20.7071 4.70711Z",fill:"currentColor"})}),zi=Ox,U={backgroundColor:"var(--stackflow-plugin-basic-ui-background-color)",backgroundImage:"var(--stackflow-plugin-basic-ui-background-image)",dimBackgroundColor:"var(--stackflow-plugin-basic-ui-dim-background-color)",dimHeight:"var(--stackflow-plugin-basic-ui-dim-height)",transitionDuration:"var(--stackflow-plugin-basic-ui-transition-duration)",computedTransitionDuration:"var(--stackflow-plugin-basic-ui-computed-transition-duration)",defaultTransitionOffSet:"var(--stackflow-plugin-basic-ui-default-transition-off-set)",appBar:{borderColor:"var(--stackflow-plugin-basic-ui-app-bar-border-color)",borderColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-border-color-transition-duration)",borderSize:"var(--stackflow-plugin-basic-ui-app-bar-border-size)",height:"var(--stackflow-plugin-basic-ui-app-bar-height)",heightTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-height-transition-duration)",minHeight:"var(--stackflow-plugin-basic-ui-app-bar-min-height)",iconColor:"var(--stackflow-plugin-basic-ui-app-bar-icon-color)",iconColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-icon-color-transition-duration)",textColor:"var(--stackflow-plugin-basic-ui-app-bar-text-color)",textColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-text-color-transition-duration)",backgroundColor:"var(--stackflow-plugin-basic-ui-app-bar-background-color)",backgroundColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-background-color-transition-duration)",backgroundImage:"var(--stackflow-plugin-basic-ui-app-bar-background-image)",backgroundImageTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-background-image-transition-duration)",overflow:"var(--stackflow-plugin-basic-ui-app-bar-overflow)",minSafeAreaInsetTop:"var(--stackflow-plugin-basic-ui-app-bar-min-safe-area-inset-top)",containerPadding:"var(--stackflow-plugin-basic-ui-app-bar-container-padding)",itemGap:"var(--stackflow-plugin-basic-ui-app-bar-item-gap)",fontSize:"var(--stackflow-plugin-basic-ui-app-bar-font-size)",lineHeight:"var(--stackflow-plugin-basic-ui-app-bar-line-height)",hitSlop:"var(--stackflow-plugin-basic-ui-app-bar-hit-slop)"},bottomSheet:{borderRadius:"var(--stackflow-plugin-basic-ui-bottom-sheet-border-radius)"},modal:{borderRadius:"var(--stackflow-plugin-basic-ui-modal-border-radius)",maxWidth:"var(--stackflow-plugin-basic-ui-modal-max-width)"},edge:{width:"var(--stackflow-plugin-basic-ui-edge-width)"}},Bx=Lt({defaultClassName:"_1q6dj2j2",variantClassNames:{theme:{android:"_1q6dj2j0",cupertino:"_1q6dj2j1"}},defaultVariants:{},compoundVariants:[]});function Fx(t){return t.filter(s=>s!=null)}function cn(t){return Object.entries(t).reduce((s,[n,a])=>(a!=null&&(s[n]=a),s),{})}var Oc=c.createContext({theme:"android"}),Wx=Oc.Provider;function Bc(){return c.useContext(Oc)}var $x=t=>()=>({key:"basic-ui",wrapStack({stack:s,initialContext:n}){var a,r,o,d,i,l,m,u,f,h,g,b,p,x,v,j,N;const y=typeof t=="function"?t({initialContext:n}):t;return e.jsx(Wx,{value:Ms($t({},y),{theme:(a=n?.theme)!=null?a:y.theme}),children:e.jsx("div",{className:Fx([Bx({theme:(r=n?.theme)!=null?r:y.theme}),y.rootClassName]).join(" "),style:on(cn({[U.backgroundColor]:y.backgroundColor,[U.backgroundImage]:y.backgroundImage,[U.dimBackgroundColor]:y.dimBackgroundColor,[U.dimHeight]:y.dimHeight,[U.transitionDuration]:`${s.transitionDuration}ms`,[U.computedTransitionDuration]:s.globalTransitionState==="loading"?`${s.transitionDuration}ms`:"0ms",[U.defaultTransitionOffSet]:y.defaultTransitionOffSet,[U.appBar.borderColor]:(o=y.appBar)==null?void 0:o.borderColor,[U.appBar.borderSize]:(d=y.appBar)==null?void 0:d.borderSize,[U.appBar.height]:(i=y.appBar)==null?void 0:i.height,[U.appBar.minHeight]:(l=y.appBar)==null?void 0:l.minHeight,[U.appBar.iconColor]:(m=y.appBar)==null?void 0:m.iconColor,[U.appBar.textColor]:(u=y.appBar)==null?void 0:u.textColor,[U.appBar.minSafeAreaInsetTop]:(f=y.appBar)==null?void 0:f.minSafeAreaInsetTop,[U.bottomSheet.borderRadius]:(h=y.bottomSheet)==null?void 0:h.borderRadius,[U.modal.borderRadius]:(g=y.modal)==null?void 0:g.borderRadius,[U.appBar.containerPadding]:(b=y.appBar)==null?void 0:b.containerPadding,[U.appBar.fontSize]:(p=y.appBar)==null?void 0:p.fontSize,[U.appBar.lineHeight]:(x=y.appBar)==null?void 0:x.lineHeight,[U.appBar.hitSlop]:(v=y.appBar)==null?void 0:v.hitSlop,[U.appBar.itemGap]:(j=y.appBar)==null?void 0:j.itemGap,[U.edge.width]:(N=y.edge)==null?void 0:N.width})),children:s.render()})})}}),qx=Lt({defaultClassName:"_1yk3a452 dhthxq4 dhthxq0 dhthxqh _1yk3a451",variantClassNames:{activityEnterStyle:{slideInLeft:"_1yk3a453"},enterStyle:{cover:"_1yk3a454"},border:{true:"_1yk3a455"},modalPresentationStyle:{fullScreen:"_1yk3a456"}},defaultVariants:{},compoundVariants:[[{activityEnterStyle:"slideInLeft",enterStyle:"cover"},"_1yk3a457"]]}),Oi="_1yk3a45b dhthxq9 dhthxq7 dhthxqb dhthxqf dhthxqi",Hx="dhthxq9 dhthxq7 dhthxq8 _1yk3a450",Ux="_1yk3a45e",Vx="_1yk3a45f dhthxqi dhthxq4 dhthxq2 dhthxqf",Jx="_1yk3a45g dhthxqc dhthxqd dhthxq0",Kx="_1yk3a45b dhthxq9 dhthxq7 dhthxqb dhthxqf dhthxqi",Gx="_1yk3a459 dhthxqa dhthxq7 _1yk3a451",Qx="_1yk3a45a dhthxq9 dhthxq7 dhthxq1 _1yk3a450",Yx="_1yk3a45h dhthxq9 dhthxq7 dhthxq1 dhthxq5 _1yk3a450",Xx="_1yk3a458",Zx=Lt({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_1dlf434a","enter-done":"_1dlf434b","exit-active":"_1dlf434c","exit-done":"_1dlf434d"},hasAppBar:{true:"_1dlf434j"}},defaultVariants:{},compoundVariants:[]}),eg="_1dlf434k dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 _1dlf4347 _1dlf4349",tg=Lt({defaultClassName:"_1dlf434r dhthxq4 dhthxq2 dhthxq3 dhthxq1",variantClassNames:{hasAppBar:{true:"_1dlf434s"}},defaultVariants:{},compoundVariants:[]}),sg="_1dlf434a",ng="_1dlf434b",ag="_1dlf434c",rg="_1dlf434d",ig=Lt({defaultClassName:"_1dlf434l dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 _1dlf4348 _1dlf4349",variantClassNames:{hasAppBar:{true:"_1dlf434m dhthxqg"},modalPresentationStyle:{fullScreen:"_1dlf434n"},activityEnterStyle:{slideInLeft:"_1dlf434o"}},defaultVariants:{},compoundVariants:[]}),og=Lt({defaultClassName:"_1dlf434p dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3",variantClassNames:{hasAppBar:{true:"_1dlf434q"}},defaultVariants:{},compoundVariants:[]}),us={transitionDuration:"var(--_1dlf4340)",zIndexes:{dim:"var(--_1dlf4341)",paper:"var(--_1dlf4342)",edge:"var(--_1dlf4343)",appBar:"var(--_1dlf4344)"},appBar:{center:{mainWidth:"var(--_1dlf4346)"}}},Fc=c.forwardRef(({title:t,renderLeft:s,renderRight:n,backButton:a,closeButton:r,closeButtonLocation:o="left",border:d=!0,modalPresentationStyle:i,activityEnterStyle:l,iconColor:m,iconColorTransitionDuration:u,textColor:f,textColorTransitionDuration:h,borderColor:g,borderColorTransitionDuration:b,borderSize:p,height:x,heightTransitionDuration:v,overflow:j,backgroundColor:N,backgroundColorTransitionDuration:y,backgroundImage:S,backgroundImageTransitionDuration:C,onTopClick:P,enterStyle:_,className:I,minHeight:T,fontSize:k,lineHeight:A,hitSlop:w,containerPadding:E,itemGap:D},z)=>{var R,V;const M=rn(),B=as(),G=Dc();gr();const ee=Bc(),W=(R=ee.appBar)==null?void 0:R.closeButton,F=(V=ee.appBar)==null?void 0:V.backButton,ie=c.useRef(null),{maxWidth:ne}=Ax({outerRef:z,innerRef:ie,enable:ee.theme==="cupertino"}),q=(ee.theme==="cupertino"&&i!=="fullScreen"||l==="slideInLeft")&&_!=="cover",H=se=>{a&&"onClick"in a&&a.onClick&&a.onClick(se),se.defaultPrevented||M.pop()},Q=()=>{var se,re;return!B||B.isRoot?null:!a&&!F?e.jsx("button",{type:"button","aria-label":"Go Back",className:Oi,onClick:H,children:e.jsx(Di,{})}):a&&"render"in a&&a.render?(se=a.render)==null?void 0:se.call(a):F&&"render"in F&&F.render?(re=F.render)==null?void 0:re.call(F):e.jsx("button",{type:"button",className:Oi,"aria-label":a&&"ariaLabel"in a?a.ariaLabel:F&&"ariaLabel"in F?F.ariaLabel:void 0,onClick:H,children:a&&"renderIcon"in a&&a.renderIcon?a.renderIcon():F&&"renderIcon"in F&&F.renderIcon?F.renderIcon():i==="fullScreen"?e.jsx(zi,{}):e.jsx(Di,{})})},ae=se=>{var re;r&&"onClick"in r&&r.onClick&&r.onClick(se),!se.defaultPrevented&&W&&"onClick"in W&&((re=W.onClick)==null||re.call(W,se))},$=()=>{var se;const re=!B||B.isRoot,ge=ve=>ve&&"render"in ve&&ve.render||ve&&"renderIcon"in ve&&ve.renderIcon||ve&&"onClick"in ve&&ve.onClick;return!(ge(r)||ge((se=ee.appBar)==null?void 0:se.closeButton))||!re?null:r&&"render"in r&&r.render?r.render():W&&"render"in W&&W.render?W.render():e.jsx("button",{type:"button",className:Kx,"aria-label":r&&"ariaLabel"in r?r.ariaLabel:W&&"ariaLabel"in W?W.ariaLabel:void 0,onClick:ae,children:r&&"renderIcon"in r&&r.renderIcon?r.renderIcon():W&&"renderIcon"in W&&W.renderIcon?W.renderIcon():e.jsx(zi,{})})};return e.jsxs("div",Ms($t({ref:z,className:Vn(qx({border:d,modalPresentationStyle:i,activityEnterStyle:l,enterStyle:_}),I),style:on(cn({[U.appBar.iconColor]:m,[U.appBar.iconColorTransitionDuration]:u,[U.appBar.textColor]:f,[U.appBar.textColorTransitionDuration]:h,[U.appBar.borderColor]:g,[U.appBar.borderColorTransitionDuration]:b,[U.appBar.borderSize]:p,[U.appBar.height]:x,[U.appBar.heightTransitionDuration]:v,[U.appBar.overflow]:j,[U.appBar.backgroundColor]:N??(q?U.backgroundColor:"transparent"),[U.appBar.backgroundColorTransitionDuration]:y,[U.appBar.backgroundImage]:S??(q?U.appBar.backgroundImage:"none"),[U.appBar.backgroundImageTransitionDuration]:C,[us.appBar.center.mainWidth]:`${ne}px`,[U.appBar.minHeight]:T,[U.appBar.containerPadding]:E,[U.appBar.fontSize]:k,[U.appBar.hitSlop]:w,[U.appBar.lineHeight]:A,[U.appBar.itemGap]:D})),"data-part":"appBar"},G),{children:[e.jsx("div",{className:Xx}),e.jsxs("div",{className:Gx,children:[e.jsxs("div",{className:Qx,children:[o==="left"&&$(),Q(),s?.()]}),e.jsx("div",{ref:ie,className:Hx,children:e.jsxs("div",{className:Ux,children:[typeof t=="string"?e.jsx("div",{className:Jx,children:t}):t,e.jsx("button",{className:Vx,type:"button",onClick:P})]})}),e.jsxs("div",{className:Yx,children:[n?.(),o==="right"&&$()]})]})]}))});Fc.displayName="AppBar";var cg=Fc,lg=32,Bi=80,dg=c.createContext(null),ug=({backgroundColor:t,backgroundImage:s,dimBackgroundColor:n,appBar:a,preventSwipeBack:r,CUPERTINO_ONLY_modalPresentationStyle:o,ANDROID_ONLY_activityEnterStyle:d,className:i,children:l})=>{var m;const u=Bc(),f=as(),h=Dc();gr();const{pop:g}=rn(),b=c.useRef(null),p=c.useRef(null),x=c.useRef(null),v=c.useRef(null),j=c.useRef(null),N=c.useRef(null),y=u.theme==="cupertino"?o:void 0,S=u.theme==="android"?d:void 0,C=r||y==="fullScreen",P=!!a,_=Vs();let I,T,k,A;u.theme==="cupertino"?(I=_+(y==="fullScreen"?2:0),T=_+(P&&y!=="fullScreen"?a.enterStyle==="cover"?2:1:3),k=_+4,A=_+7):(I=_,T=_+(S==="slideInLeft"&&a?.enterStyle!=="cover"?0:2),k=_+4,A=_+(S==="slideInLeft"?6:4));const w=(m=f?.transitionState)!=null?m:"enter-done",E=vr(w);Tx({refs:[b]}),Px({refs:(u.theme==="cupertino"||S==="slideInLeft")&&a?.enterStyle!=="cover"?[x]:[x,j],offsetStyles:u.theme==="cupertino"?{transform:`translate3d(-${Bi/16}rem, 0, 0)`,opacity:"1"}:S==="slideInLeft"?{transform:"translate3d(-50%, 0, 0)",opacity:"0"}:{transform:`translate3d(0, -${lg/16}rem, 0)`,opacity:"1"},transitionDuration:U.computedTransitionDuration,hasEffect:y!=="fullScreen"}),Ex({dimRef:p,edgeRef:v,paperRef:x,appBarRef:j,offset:Bi,transitionDuration:U.transitionDuration,moveAppBarTogether:a?.enterStyle==="cover",preventSwipeBack:C||u.theme!=="cupertino",getActivityTransitionState(){const z=x.current,R=z?.parentElement;return R?R.classList.contains(sg)?"enter-active":R.classList.contains(ng)?"enter-done":R.classList.contains(ag)?"exit-active":R.classList.contains(rg)?"exit-done":null:null},onSwipeEnd({swiped:z}){z&&g()}});const D=z=>{var R,V;(R=a?.onTopClick)==null||R.call(a,z),z.defaultPrevented||(V=N.current)==null||V.scroll({top:0,behavior:"smooth"})};return yr({ref:b}),e.jsx(dg.Provider,{value:c.useMemo(()=>({scroll({top:z}){var R;(R=N?.current)==null||R.scroll({top:z,behavior:"smooth"})},zIndices:{dim:I,paper:T,edge:k,appBar:A}}),[N,I,T,k,A]),children:e.jsxs("div",Ms($t({ref:b,className:Vn(Zx({hasAppBar:P,transitionState:w==="enter-done"||w==="exit-done"?w:E}),i),style:on(cn({[U.backgroundColor]:t,[U.backgroundImage]:s,[U.dimBackgroundColor]:n,[U.appBar.height]:a?.height,[U.appBar.heightTransitionDuration]:a?.heightTransitionDuration,[us.zIndexes.dim]:`${I}`,[us.zIndexes.paper]:`${T}`,[us.zIndexes.edge]:`${k}`,[us.zIndexes.appBar]:`${A}`,[us.transitionDuration]:w==="enter-active"||w==="exit-active"?U.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"AppScreen"},h),{children:[S!=="slideInLeft"&&e.jsx("div",$t({ref:p,className:eg,"data-part":"dim"},h)),a&&e.jsx(cg,Ms($t({},a),{ref:j,modalPresentationStyle:y,activityEnterStyle:S,onTopClick:D})),e.jsx("div",Ms($t({ref:x,className:ig({hasAppBar:P,modalPresentationStyle:y,activityEnterStyle:S}),"data-part":"paper"},h),{children:e.jsx("div",{ref:N,className:og({hasAppBar:P}),children:l})}),f?.id),!f?.isRoot&&u.theme==="cupertino"&&!C&&e.jsx("div",$t({ref:v,className:tg({hasAppBar:P}),"data-part":"edge"},h))]}))})},le=ug,mg=Lt({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_1ht38h04","enter-done":"_1ht38h05","exit-active":"_1ht38h06","exit-done":"_1ht38h07"}},defaultVariants:{},compoundVariants:[]}),fg="_1ht38h0d dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc dhthxqa dhthxq7 _1ht38h03",pg="_1ht38h0e dhthxqc _1ht38h03",ma={transitionDuration:"var(--_1ht38h00)",zIndexes:{dim:"var(--_1ht38h01)",paper:"var(--_1ht38h02)"}},Wc=({borderRadius:t="1rem",backgroundColor:s,backgroundImage:n,dimBackgroundColor:a,paperRef:r,onOutsideClick:o,children:d,className:i})=>{var l;const m=as(),{pop:u}=rn(),f=c.useRef(null),h=c.useRef(null);ct({styleName:"hide",refs:[f]}),ct({styleName:"offset",refs:[h]}),ct({styleName:"swipe-back",refs:[h]});const g=c.useRef(!1),b=N=>{o?.(N),!N.defaultPrevented&&(g.current||(g.current=!0,u()))},p=N=>{N.stopPropagation()},x=Vs()+3,v=Vs()+4,j=(l=m?.transitionState)!=null?l:"enter-done";return yr({ref:f}),e.jsx("div",{className:Vn(mg({transitionState:vr(j)}),i),ref:f,style:on(cn({[U.bottomSheet.borderRadius]:t,[U.backgroundColor]:s,[U.backgroundImage]:n,[U.dimBackgroundColor]:a,[ma.zIndexes.dim]:`${x}`,[ma.zIndexes.paper]:`${v}`,[ma.transitionDuration]:j==="enter-active"||j==="exit-active"?U.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"BottomSheet","data-stackflow-activity-id":m?.id,"data-stackflow-activity-is-active":m?.isActive,children:e.jsx("div",{className:fg,ref:h,onClick:b,children:e.jsx("div",{className:pg,ref:r,onClick:p,children:d})})})};Wc.displayName="BottomSheet";var hg=Wc,xg=Lt({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_5ozg8c4","enter-done":"_5ozg8c5","exit-active":"_5ozg8c6","exit-done":"_5ozg8c7"}},defaultVariants:{},compoundVariants:[]}),gg="_5ozg8cd dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc dhthxq9 dhthxq7 dhthxqb _5ozg8c3",vg="_5ozg8ce dhthxqc _5ozg8c3",fa={transitionDuration:"var(--_5ozg8c0)",zIndexes:{dim:"var(--_5ozg8c1)",paper:"var(--_5ozg8c2)"}},$c=({backgroundColor:t,backgroundImage:s,dimBackgroundColor:n,borderRadius:a="1rem",maxWidth:r,onOutsideClick:o,children:d,className:i})=>{var l;const m=as(),{pop:u}=rn(),f=c.useRef(null),h=c.useRef(null);ct({styleName:"hide",refs:[f]}),ct({styleName:"offset",refs:[h]}),ct({styleName:"swipe-back",refs:[h]});const g=c.useRef(!1),b=N=>{o?.(N),!N.defaultPrevented&&(g.current||(g.current=!0,u()))},p=N=>{N.stopPropagation()},x=Vs()+3,v=Vs()+4,j=(l=m?.transitionState)!=null?l:"enter-done";return yr({ref:f}),e.jsx("div",{className:Vn(xg({transitionState:vr(j)}),i),ref:f,style:on(cn({[U.backgroundColor]:t,[U.backgroundImage]:s,[U.dimBackgroundColor]:n,[U.modal.borderRadius]:a,[U.modal.maxWidth]:r,[fa.zIndexes.dim]:`${x}`,[fa.zIndexes.paper]:`${v}`,[fa.transitionDuration]:j==="enter-active"||j==="exit-active"?U.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"Modal","data-stackflow-activity-id":m?.id,"data-stackflow-activity-is-active":m?.isActive,children:e.jsx("div",{className:gg,ref:h,onClick:b,children:e.jsx("div",{className:vg,onClick:p,children:d})})})};$c.displayName="Modal";var yg=$c,bg=Object.defineProperty,Y=(t,s)=>bg(t,"name",{value:s,configurable:!0}),xs=class{type=3;name="";prefix="";value="";suffix="";modifier=3;constructor(t,s,n,a,r,o){this.type=t,this.name=s,this.prefix=n,this.value=a,this.suffix=r,this.modifier=o}hasCustomName(){return this.name!==""&&typeof this.name!="number"}};Y(xs,"Part");var jg=/[$_\p{ID_Start}]/u,Ng=/[$_\u200C\u200D\p{ID_Continue}]/u,Pa=".*";function qc(t,s){return(s?/^[\x00-\xFF]*$/:/^[\x00-\x7F]*$/).test(t)}Y(qc,"isASCII");function br(t,s=!1){let n=[],a=0;for(;a<t.length;){let r=t[a],o=Y(function(d){if(!s)throw new TypeError(d);n.push({type:"INVALID_CHAR",index:a,value:t[a++]})},"ErrorOrInvalid");if(r==="*"){n.push({type:"ASTERISK",index:a,value:t[a++]});continue}if(r==="+"||r==="?"){n.push({type:"OTHER_MODIFIER",index:a,value:t[a++]});continue}if(r==="\\"){n.push({type:"ESCAPED_CHAR",index:a++,value:t[a++]});continue}if(r==="{"){n.push({type:"OPEN",index:a,value:t[a++]});continue}if(r==="}"){n.push({type:"CLOSE",index:a,value:t[a++]});continue}if(r===":"){let d="",i=a+1;for(;i<t.length;){let l=t.substr(i,1);if(i===a+1&&jg.test(l)||i!==a+1&&Ng.test(l)){d+=t[i++];continue}break}if(!d){o(`Missing parameter name at ${a}`);continue}n.push({type:"NAME",index:a,value:d}),a=i;continue}if(r==="("){let d=1,i="",l=a+1,m=!1;if(t[l]==="?"){o(`Pattern cannot start with "?" at ${l}`);continue}for(;l<t.length;){if(!qc(t[l],!1)){o(`Invalid character '${t[l]}' at ${l}.`),m=!0;break}if(t[l]==="\\"){i+=t[l++]+t[l++];continue}if(t[l]===")"){if(d--,d===0){l++;break}}else if(t[l]==="("&&(d++,t[l+1]!=="?")){o(`Capturing groups are not allowed at ${l}`),m=!0;break}i+=t[l++]}if(m)continue;if(d){o(`Unbalanced pattern at ${a}`);continue}if(!i){o(`Missing pattern at ${a}`);continue}n.push({type:"REGEX",index:a,value:i}),a=l;continue}n.push({type:"CHAR",index:a,value:t[a++]})}return n.push({type:"END",index:a,value:""}),n}Y(br,"lexer");function jr(t,s={}){let n=br(t);s.delimiter??="/#?",s.prefixes??="./";let a=`[^${_e(s.delimiter)}]+?`,r=[],o=0,d=0,i=new Set,l=Y(j=>{if(d<n.length&&n[d].type===j)return n[d++].value},"tryConsume"),m=Y(()=>l("OTHER_MODIFIER")??l("ASTERISK"),"tryConsumeModifier"),u=Y(j=>{let N=l(j);if(N!==void 0)return N;let{type:y,index:S}=n[d];throw new TypeError(`Unexpected ${y} at ${S}, expected ${j}`)},"mustConsume"),f=Y(()=>{let j="",N;for(;N=l("CHAR")??l("ESCAPED_CHAR");)j+=N;return j},"consumeText"),h=Y(j=>j,"DefaultEncodePart"),g=s.encodePart||h,b="",p=Y(j=>{b+=j},"appendToPendingFixedValue"),x=Y(()=>{b.length&&(r.push(new xs(3,"","",g(b),"",3)),b="")},"maybeAddPartFromPendingFixedValue"),v=Y((j,N,y,S,C)=>{let P=3;switch(C){case"?":P=1;break;case"*":P=0;break;case"+":P=2;break}if(!N&&!y&&P===3){p(j);return}if(x(),!N&&!y){if(!j)return;r.push(new xs(3,"","",g(j),"",P));return}let _;y?y==="*"?_=Pa:_=y:_=a;let I=2;_===a?(I=1,_=""):_===Pa&&(I=0,_="");let T;if(N?T=N:y&&(T=o++),i.has(T))throw new TypeError(`Duplicate name '${T}'.`);i.add(T),r.push(new xs(I,T,g(j),_,g(S),P))},"addPart");for(;d<n.length;){let j=l("CHAR"),N=l("NAME"),y=l("REGEX");if(!N&&!y&&(y=l("ASTERISK")),N||y){let C=j??"";s.prefixes.indexOf(C)===-1&&(p(C),C=""),x();let P=m();v(C,N,y,"",P);continue}let S=j??l("ESCAPED_CHAR");if(S){p(S);continue}if(l("OPEN")){let C=f(),P=l("NAME"),_=l("REGEX");!P&&!_&&(_=l("ASTERISK"));let I=f();u("CLOSE");let T=m();v(C,P,_,I,T);continue}x(),u("END")}return r}Y(jr,"parse");function _e(t){return t.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}Y(_e,"escapeString");function Ea(t){return t&&t.ignoreCase?"ui":"u"}Y(Ea,"flags");function Hc(t,s,n){return Nr(jr(t,n),s,n)}Y(Hc,"stringToRegexp");function Ut(t){switch(t){case 0:return"*";case 1:return"?";case 2:return"+";case 3:return""}}Y(Ut,"modifierToString");function Nr(t,s,n={}){n.delimiter??="/#?",n.prefixes??="./",n.sensitive??=!1,n.strict??=!1,n.end??=!0,n.start??=!0,n.endsWith="";let a=n.start?"^":"";for(let i of t){if(i.type===3){i.modifier===3?a+=_e(i.value):a+=`(?:${_e(i.value)})${Ut(i.modifier)}`;continue}s&&s.push(i.name);let l=`[^${_e(n.delimiter)}]+?`,m=i.value;if(i.type===1?m=l:i.type===0&&(m=Pa),!i.prefix.length&&!i.suffix.length){i.modifier===3||i.modifier===1?a+=`(${m})${Ut(i.modifier)}`:a+=`((?:${m})${Ut(i.modifier)})`;continue}if(i.modifier===3||i.modifier===1){a+=`(?:${_e(i.prefix)}(${m})${_e(i.suffix)})`,a+=Ut(i.modifier);continue}a+=`(?:${_e(i.prefix)}`,a+=`((?:${m})(?:`,a+=_e(i.suffix),a+=_e(i.prefix),a+=`(?:${m}))*)${_e(i.suffix)})`,i.modifier===0&&(a+="?")}let r=`[${_e(n.endsWith)}]|$`,o=`[${_e(n.delimiter)}]`;if(n.end)return n.strict||(a+=`${o}?`),n.endsWith.length?a+=`(?=${r})`:a+="$",new RegExp(a,Ea(n));n.strict||(a+=`(?:${o}(?=${r}))?`);let d=!1;if(t.length){let i=t[t.length-1];i.type===3&&i.modifier===3&&(d=n.delimiter.indexOf(i)>-1)}return d||(a+=`(?=${o}|${r})`),new RegExp(a,Ea(n))}Y(Nr,"partsToRegexp");var jt={delimiter:"",prefixes:"",sensitive:!0,strict:!0},wg={delimiter:".",prefixes:"",sensitive:!0,strict:!0},kg={delimiter:"/",prefixes:"/",sensitive:!0,strict:!0};function Uc(t,s){return t.length?t[0]==="/"?!0:!s||t.length<2?!1:(t[0]=="\\"||t[0]=="{")&&t[1]=="/":!1}Y(Uc,"isAbsolutePathname");function wr(t,s){return t.startsWith(s)?t.substring(s.length,t.length):t}Y(wr,"maybeStripPrefix");function Vc(t,s){return t.endsWith(s)?t.substr(0,t.length-s.length):t}Y(Vc,"maybeStripSuffix");function kr(t){return!t||t.length<2?!1:t[0]==="["||(t[0]==="\\"||t[0]==="{")&&t[1]==="["}Y(kr,"treatAsIPv6Hostname");var Jc=["ftp","file","http","https","ws","wss"];function Cr(t){if(!t)return!0;for(let s of Jc)if(t.test(s))return!0;return!1}Y(Cr,"isSpecialScheme");function Kc(t,s){if(t=wr(t,"#"),s||t==="")return t;let n=new URL("https://example.com");return n.hash=t,n.hash?n.hash.substring(1,n.hash.length):""}Y(Kc,"canonicalizeHash");function Gc(t,s){if(t=wr(t,"?"),s||t==="")return t;let n=new URL("https://example.com");return n.search=t,n.search?n.search.substring(1,n.search.length):""}Y(Gc,"canonicalizeSearch");function Qc(t,s){return s||t===""?t:kr(t)?Ir(t):Ar(t)}Y(Qc,"canonicalizeHostname");function Yc(t,s){if(s||t==="")return t;let n=new URL("https://example.com");return n.password=t,n.password}Y(Yc,"canonicalizePassword");function Xc(t,s){if(s||t==="")return t;let n=new URL("https://example.com");return n.username=t,n.username}Y(Xc,"canonicalizeUsername");function Zc(t,s,n){if(n||t==="")return t;if(s&&!Jc.includes(s))return new URL(`${s}:${t}`).pathname;let a=t[0]=="/";return t=new URL(a?t:"/-"+t,"https://example.com").pathname,a||(t=t.substring(2,t.length)),t}Y(Zc,"canonicalizePathname");function el(t,s,n){return Sr(s)===t&&(t=""),n||t===""?t:Tr(t)}Y(el,"canonicalizePort");function tl(t,s){return t=Vc(t,":"),s||t===""?t:Yn(t)}Y(tl,"canonicalizeProtocol");function Sr(t){switch(t){case"ws":case"http":return"80";case"wws":case"https":return"443";case"ftp":return"21";default:return""}}Y(Sr,"defaultPortForProtocol");function Yn(t){if(t==="")return t;if(/^[-+.A-Za-z0-9]*$/.test(t))return t.toLowerCase();throw new TypeError(`Invalid protocol '${t}'.`)}Y(Yn,"protocolEncodeCallback");function sl(t){if(t==="")return t;let s=new URL("https://example.com");return s.username=t,s.username}Y(sl,"usernameEncodeCallback");function nl(t){if(t==="")return t;let s=new URL("https://example.com");return s.password=t,s.password}Y(nl,"passwordEncodeCallback");function Ar(t){if(t==="")return t;if(/[\t\n\r #%/:<>?@[\]^\\|]/g.test(t))throw new TypeError(`Invalid hostname '${t}'`);let s=new URL("https://example.com");return s.hostname=t,s.hostname}Y(Ar,"hostnameEncodeCallback");function Ir(t){if(t==="")return t;if(/[^0-9a-fA-F[\]:]/g.test(t))throw new TypeError(`Invalid IPv6 hostname '${t}'`);return t.toLowerCase()}Y(Ir,"ipv6HostnameEncodeCallback");function Tr(t){if(t===""||/^[0-9]*$/.test(t)&&parseInt(t)<=65535)return t;throw new TypeError(`Invalid port '${t}'.`)}Y(Tr,"portEncodeCallback");function al(t){if(t==="")return t;let s=new URL("https://example.com");return s.pathname=t[0]!=="/"?"/-"+t:t,t[0]!=="/"?s.pathname.substring(2,s.pathname.length):s.pathname}Y(al,"standardURLPathnameEncodeCallback");function rl(t){return t===""?t:new URL(`data:${t}`).pathname}Y(rl,"pathURLPathnameEncodeCallback");function il(t){if(t==="")return t;let s=new URL("https://example.com");return s.search=t,s.search.substring(1,s.search.length)}Y(il,"searchEncodeCallback");function ol(t){if(t==="")return t;let s=new URL("https://example.com");return s.hash=t,s.hash.substring(1,s.hash.length)}Y(ol,"hashEncodeCallback");var cl=class{#r;#n=[];#t={};#e=0;#a=1;#l=0;#o=0;#f=0;#p=0;#h=!1;constructor(t){this.#r=t}get result(){return this.#t}parse(){for(this.#n=br(this.#r,!0);this.#e<this.#n.length;this.#e+=this.#a){if(this.#a=1,this.#n[this.#e].type==="END"){if(this.#o===0){this.#y(),this.#d()?this.#s(9,1):this.#u()?this.#s(8,1):this.#s(7,0);continue}else if(this.#o===2){this.#m(5);continue}this.#s(10,0);break}if(this.#f>0)if(this.#S())this.#f-=1;else continue;if(this.#C()){this.#f+=1;continue}switch(this.#o){case 0:this.#b()&&this.#m(1);break;case 1:if(this.#b()){this.#T();let t=7,s=1;this.#N()?(t=2,s=3):this.#h&&(t=2),this.#s(t,s)}break;case 2:this.#g()?this.#m(3):(this.#v()||this.#u()||this.#d())&&this.#m(5);break;case 3:this.#w()?this.#s(4,1):this.#g()&&this.#s(5,1);break;case 4:this.#g()&&this.#s(5,1);break;case 5:this.#A()?this.#p+=1:this.#I()&&(this.#p-=1),this.#k()&&!this.#p?this.#s(6,1):this.#v()?this.#s(7,0):this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 6:this.#v()?this.#s(7,0):this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 7:this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 8:this.#d()&&this.#s(9,1);break}}this.#t.hostname!==void 0&&this.#t.port===void 0&&(this.#t.port="")}#s(t,s){switch(this.#o){case 0:break;case 1:this.#t.protocol=this.#c();break;case 2:break;case 3:this.#t.username=this.#c();break;case 4:this.#t.password=this.#c();break;case 5:this.#t.hostname=this.#c();break;case 6:this.#t.port=this.#c();break;case 7:this.#t.pathname=this.#c();break;case 8:this.#t.search=this.#c();break;case 9:this.#t.hash=this.#c();break}this.#o!==0&&t!==10&&([1,2,3,4].includes(this.#o)&&[6,7,8,9].includes(t)&&(this.#t.hostname??=""),[1,2,3,4,5,6].includes(this.#o)&&[8,9].includes(t)&&(this.#t.pathname??=this.#h?"/":""),[1,2,3,4,5,6,7].includes(this.#o)&&t===9&&(this.#t.search??="")),this.#j(t,s)}#j(t,s){this.#o=t,this.#l=this.#e+s,this.#e+=s,this.#a=0}#y(){this.#e=this.#l,this.#a=0}#m(t){this.#y(),this.#o=t}#x(t){return t<0&&(t=this.#n.length-t),t<this.#n.length?this.#n[t]:this.#n[this.#n.length-1]}#i(t,s){let n=this.#x(t);return n.value===s&&(n.type==="CHAR"||n.type==="ESCAPED_CHAR"||n.type==="INVALID_CHAR")}#b(){return this.#i(this.#e,":")}#N(){return this.#i(this.#e+1,"/")&&this.#i(this.#e+2,"/")}#g(){return this.#i(this.#e,"@")}#w(){return this.#i(this.#e,":")}#k(){return this.#i(this.#e,":")}#v(){return this.#i(this.#e,"/")}#u(){if(this.#i(this.#e,"?"))return!0;if(this.#n[this.#e].value!=="?")return!1;let t=this.#x(this.#e-1);return t.type!=="NAME"&&t.type!=="REGEX"&&t.type!=="CLOSE"&&t.type!=="ASTERISK"}#d(){return this.#i(this.#e,"#")}#C(){return this.#n[this.#e].type=="OPEN"}#S(){return this.#n[this.#e].type=="CLOSE"}#A(){return this.#i(this.#e,"[")}#I(){return this.#i(this.#e,"]")}#c(){let t=this.#n[this.#e],s=this.#x(this.#l).index;return this.#r.substring(s,t.index)}#T(){let t={};Object.assign(t,jt),t.encodePart=Yn;let s=Hc(this.#c(),void 0,t);this.#h=Cr(s)}};Y(cl,"Parser");var pa=["protocol","username","password","hostname","port","pathname","search","hash"],yt="*";function _a(t,s){if(typeof t!="string")throw new TypeError("parameter 1 is not of type 'string'.");let n=new URL(t,s);return{protocol:n.protocol.substring(0,n.protocol.length-1),username:n.username,password:n.password,hostname:n.hostname,port:n.port,pathname:n.pathname,search:n.search!==""?n.search.substring(1,n.search.length):void 0,hash:n.hash!==""?n.hash.substring(1,n.hash.length):void 0}}Y(_a,"extractValues");function Qe(t,s){return s?ps(t):t}Y(Qe,"processBaseURLString");function ms(t,s,n){let a;if(typeof s.baseURL=="string")try{a=new URL(s.baseURL),s.protocol===void 0&&(t.protocol=Qe(a.protocol.substring(0,a.protocol.length-1),n)),!n&&s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.username===void 0&&(t.username=Qe(a.username,n)),!n&&s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.username===void 0&&s.password===void 0&&(t.password=Qe(a.password,n)),s.protocol===void 0&&s.hostname===void 0&&(t.hostname=Qe(a.hostname,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&(t.port=Qe(a.port,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&(t.pathname=Qe(a.pathname,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&s.search===void 0&&(t.search=Qe(a.search.substring(1,a.search.length),n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&s.search===void 0&&s.hash===void 0&&(t.hash=Qe(a.hash.substring(1,a.hash.length),n))}catch{throw new TypeError(`invalid baseURL '${s.baseURL}'.`)}if(typeof s.protocol=="string"&&(t.protocol=tl(s.protocol,n)),typeof s.username=="string"&&(t.username=Xc(s.username,n)),typeof s.password=="string"&&(t.password=Yc(s.password,n)),typeof s.hostname=="string"&&(t.hostname=Qc(s.hostname,n)),typeof s.port=="string"&&(t.port=el(s.port,t.protocol,n)),typeof s.pathname=="string"){if(t.pathname=s.pathname,a&&!Uc(t.pathname,n)){let r=a.pathname.lastIndexOf("/");r>=0&&(t.pathname=Qe(a.pathname.substring(0,r+1),n)+t.pathname)}t.pathname=Zc(t.pathname,t.protocol,n)}return typeof s.search=="string"&&(t.search=Gc(s.search,n)),typeof s.hash=="string"&&(t.hash=Kc(s.hash,n)),t}Y(ms,"applyInit");function ps(t){return t.replace(/([+*?:{}()\\])/g,"\\$1")}Y(ps,"escapePatternString");function ll(t){return t.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}Y(ll,"escapeRegexpString");function dl(t,s){s.delimiter??="/#?",s.prefixes??="./",s.sensitive??=!1,s.strict??=!1,s.end??=!0,s.start??=!0,s.endsWith="";let n=".*",a=`[^${ll(s.delimiter)}]+?`,r=/[$_\u200C\u200D\p{ID_Continue}]/u,o="";for(let d=0;d<t.length;++d){let i=t[d];if(i.type===3){if(i.modifier===3){o+=ps(i.value);continue}o+=`{${ps(i.value)}}${Ut(i.modifier)}`;continue}let l=i.hasCustomName(),m=!!i.suffix.length||!!i.prefix.length&&(i.prefix.length!==1||!s.prefixes.includes(i.prefix)),u=d>0?t[d-1]:null,f=d<t.length-1?t[d+1]:null;if(!m&&l&&i.type===1&&i.modifier===3&&f&&!f.prefix.length&&!f.suffix.length)if(f.type===3){let h=f.value.length>0?f.value[0]:"";m=r.test(h)}else m=!f.hasCustomName();if(!m&&!i.prefix.length&&u&&u.type===3){let h=u.value[u.value.length-1];m=s.prefixes.includes(h)}m&&(o+="{"),o+=ps(i.prefix),l&&(o+=`:${i.name}`),i.type===2?o+=`(${i.value})`:i.type===1?l||(o+=`(${a})`):i.type===0&&(!l&&(!u||u.type===3||u.modifier!==3||m||i.prefix!=="")?o+="*":o+=`(${n})`),i.type===1&&l&&i.suffix.length&&r.test(i.suffix[0])&&(o+="\\"),o+=ps(i.suffix),m&&(o+="}"),i.modifier!==3&&(o+=Ut(i.modifier))}return o}Y(dl,"partsToPattern");var ul=class{#r;#n={};#t={};#e={};#a={};#l=!1;constructor(t={},s,n){try{let a;if(typeof s=="string"?a=s:n=s,typeof t=="string"){let i=new cl(t);if(i.parse(),t=i.result,a===void 0&&typeof t.protocol!="string")throw new TypeError("A base URL must be provided for a relative constructor string.");t.baseURL=a}else{if(!t||typeof t!="object")throw new TypeError("parameter 1 is not of type 'string' and cannot convert to dictionary.");if(a)throw new TypeError("parameter 1 is not of type 'string'.")}typeof n>"u"&&(n={ignoreCase:!1});let r={ignoreCase:n.ignoreCase===!0},o={pathname:yt,protocol:yt,username:yt,password:yt,hostname:yt,port:yt,search:yt,hash:yt};this.#r=ms(o,t,!0),Sr(this.#r.protocol)===this.#r.port&&(this.#r.port="");let d;for(d of pa){if(!(d in this.#r))continue;let i={},l=this.#r[d];switch(this.#t[d]=[],d){case"protocol":Object.assign(i,jt),i.encodePart=Yn;break;case"username":Object.assign(i,jt),i.encodePart=sl;break;case"password":Object.assign(i,jt),i.encodePart=nl;break;case"hostname":Object.assign(i,wg),kr(l)?i.encodePart=Ir:i.encodePart=Ar;break;case"port":Object.assign(i,jt),i.encodePart=Tr;break;case"pathname":Cr(this.#n.protocol)?(Object.assign(i,kg,r),i.encodePart=al):(Object.assign(i,jt,r),i.encodePart=rl);break;case"search":Object.assign(i,jt,r),i.encodePart=il;break;case"hash":Object.assign(i,jt,r),i.encodePart=ol;break}try{this.#a[d]=jr(l,i),this.#n[d]=Nr(this.#a[d],this.#t[d],i),this.#e[d]=dl(this.#a[d],i),this.#l=this.#l||this.#a[d].some(m=>m.type===2)}catch{throw new TypeError(`invalid ${d} pattern '${this.#r[d]}'.`)}}}catch(a){throw new TypeError(`Failed to construct 'URLPattern': ${a.message}`)}}get[Symbol.toStringTag](){return"URLPattern"}test(t={},s){let n={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof t!="string"&&s)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof t>"u")return!1;try{typeof t=="object"?n=ms(n,t,!1):n=ms(n,_a(t,s),!1)}catch{return!1}let a;for(a of pa)if(!this.#n[a].exec(n[a]))return!1;return!0}exec(t={},s){let n={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof t!="string"&&s)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof t>"u")return;try{typeof t=="object"?n=ms(n,t,!1):n=ms(n,_a(t,s),!1)}catch{return null}let a={};s?a.inputs=[t,s]:a.inputs=[t];let r;for(r of pa){let o=this.#n[r].exec(n[r]);if(!o)return null;let d={};for(let[i,l]of this.#t[r].entries())if(typeof l=="string"||typeof l=="number"){let m=o[i+1];d[l]=m}a[r]={input:n[r]??"",groups:d}}return a}static compareComponent(t,s,n){let a=Y((i,l)=>{for(let m of["type","modifier","prefix","value","suffix"]){if(i[m]<l[m])return-1;if(i[m]!==l[m])return 1}return 0},"comparePart"),r=new xs(3,"","","","",3),o=new xs(0,"","","","",3),d=Y((i,l)=>{let m=0;for(;m<Math.min(i.length,l.length);++m){let u=a(i[m],l[m]);if(u)return u}return i.length===l.length?0:a(i[m]??r,l[m]??r)},"comparePartList");return!s.#e[t]&&!n.#e[t]?0:s.#e[t]&&!n.#e[t]?d(s.#a[t],[o]):!s.#e[t]&&n.#e[t]?d([o],n.#a[t]):d(s.#a[t],n.#a[t])}get protocol(){return this.#e.protocol}get username(){return this.#e.username}get password(){return this.#e.password}get hostname(){return this.#e.hostname}get port(){return this.#e.port}get pathname(){return this.#e.pathname}get search(){return this.#e.search}get hash(){return this.#e.hash}get hasRegExpGroups(){return this.#l}};Y(ul,"URLPattern");globalThis.URLPattern||(globalThis.URLPattern=ul);const Cg=c.createContext({requestHistoryTick:()=>{}}),ml=({children:t,requestHistoryTick:s})=>{const n=c.useMemo(()=>({requestHistoryTick:s}),[s]);return e.jsx(Cg.Provider,{value:n,children:t})};ml.__docgenInfo={description:"",methods:[],displayName:"HistoryQueueProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},requestHistoryTick:{required:!0,tsType:{name:"signature",type:"function",raw:"(cb: (resolve: () => void) => void) => void",signature:{arguments:[{type:{name:"signature",type:"function",raw:"(resolve: () => void) => void",signature:{arguments:[{type:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},name:"resolve"}],return:{name:"void"}}},name:"cb"}],return:{name:"void"}}},description:""}}};function bs(){return bs=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},bs.apply(null,arguments)}var Ze;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ze||(Ze={}));var Rn=function(t){return t},Fi="beforeunload",Sg="popstate";function Ag(t){t===void 0&&(t={});var s=t,n=s.window,a=n===void 0?document.defaultView:n,r=a.history;function o(){var P=a.location,_=P.pathname,I=P.search,T=P.hash,k=r.state||{};return[k.idx,Rn({pathname:_,search:I,hash:T,state:k.usr||null,key:k.key||"default"})]}var d=null;function i(){if(d)g.call(d),d=null;else{var P=Ze.Pop,_=o(),I=_[0],T=_[1];if(g.length){if(I!=null){var k=u-I;k&&(d={action:P,location:T,retry:function(){S(k*-1)}},S(k))}}else j(P)}}a.addEventListener(Sg,i);var l=Ze.Pop,m=o(),u=m[0],f=m[1],h=Ln(),g=Ln();u==null&&(u=0,r.replaceState(bs({},r.state,{idx:u}),""));function b(P){return typeof P=="string"?P:fl(P)}function p(P,_){return _===void 0&&(_=null),Rn(bs({pathname:f.pathname,hash:"",search:""},typeof P=="string"?Ra(P):P,{state:_,key:Ma()}))}function x(P,_){return[{usr:P.state,key:P.key,idx:_},b(P)]}function v(P,_,I){return!g.length||(g.call({action:P,location:_,retry:I}),!1)}function j(P){l=P;var _=o();u=_[0],f=_[1],h.call({action:l,location:f})}function N(P,_){var I=Ze.Push,T=p(P,_);function k(){N(P,_)}if(v(I,T,k)){var A=x(T,u+1),w=A[0],E=A[1];try{r.pushState(w,"",E)}catch{a.location.assign(E)}j(I)}}function y(P,_){var I=Ze.Replace,T=p(P,_);function k(){y(P,_)}if(v(I,T,k)){var A=x(T,u),w=A[0],E=A[1];r.replaceState(w,"",E),j(I)}}function S(P){r.go(P)}var C={get action(){return l},get location(){return f},createHref:b,push:N,replace:y,go:S,back:function(){S(-1)},forward:function(){S(1)},listen:function(_){return h.push(_)},block:function(_){var I=g.push(_);return g.length===1&&a.addEventListener(Fi,$i),function(){I(),g.length||a.removeEventListener(Fi,$i)}}};return C}function Ig(t){t===void 0&&(t={});var s=t,n=s.initialEntries,a=n===void 0?["/"]:n,r=s.initialIndex,o=a.map(function(N){var y=Rn(bs({pathname:"/",search:"",hash:"",state:null,key:Ma()},typeof N=="string"?Ra(N):N));return y}),d=Wi(r??o.length-1,0,o.length-1),i=Ze.Pop,l=o[d],m=Ln(),u=Ln();function f(N){return typeof N=="string"?N:fl(N)}function h(N,y){return y===void 0&&(y=null),Rn(bs({pathname:l.pathname,search:"",hash:""},typeof N=="string"?Ra(N):N,{state:y,key:Ma()}))}function g(N,y,S){return!u.length||(u.call({action:N,location:y,retry:S}),!1)}function b(N,y){i=N,l=y,m.call({action:i,location:l})}function p(N,y){var S=Ze.Push,C=h(N,y);function P(){p(N,y)}g(S,C,P)&&(d+=1,o.splice(d,o.length,C),b(S,C))}function x(N,y){var S=Ze.Replace,C=h(N,y);function P(){x(N,y)}g(S,C,P)&&(o[d]=C,b(S,C))}function v(N){var y=Wi(d+N,0,o.length-1),S=Ze.Pop,C=o[y];function P(){v(N)}g(S,C,P)&&(d=y,b(S,C))}var j={get index(){return d},get action(){return i},get location(){return l},createHref:f,push:p,replace:x,go:v,back:function(){v(-1)},forward:function(){v(1)},listen:function(y){return m.push(y)},block:function(y){return u.push(y)}};return j}function Wi(t,s,n){return Math.min(Math.max(t,s),n)}function $i(t){t.preventDefault(),t.returnValue=""}function Ln(){var t=[];return{get length(){return t.length},push:function(n){return t.push(n),function(){t=t.filter(function(a){return a!==n})}},call:function(n){t.forEach(function(a){return a&&a(n)})}}}function Ma(){return Math.random().toString(36).substr(2,8)}function fl(t){var s=t.pathname,n=s===void 0?"/":s,a=t.search,r=a===void 0?"":a,o=t.hash,d=o===void 0?"":o;return r&&r!=="?"&&(n+=r.charAt(0)==="?"?r:"?"+r),d&&d!=="#"&&(n+=d.charAt(0)==="#"?d:"#"+d),n}function Ra(t){var s={};if(t){var n=t.indexOf("#");n>=0&&(s.hash=t.substr(n),t=t.substr(0,n));var a=t.indexOf("?");a>=0&&(s.search=t.substr(a),t=t.substr(0,a)),t&&(s.pathname=t)}return s}const Tg=c.createContext([]);function pl(t){return t.name==="Pushed"||t.name==="Popped"||t.name==="Replaced"}function Pg(t){return t.name==="StepPushed"||t.name==="StepPopped"||t.name==="StepReplaced"}function Eg(t){return pl(t)||Pg(t)}const qt={IDLE:"idle",PROGRESS:"progress",SUCCEEDED:"succeeded",FAILED:"failed"};function hl(t){return t===qt.SUCCEEDED||t===qt.FAILED}class _g{targetId;initialSetupProcess;focusCount;previousActivationTrigger;constructor(s,n){this.targetId=s,this.initialSetupProcess=n,this.focusCount=0,this.previousActivationTrigger=null}captureStackChange(s){const n=this.initialSetupProcess.getStatus();if(!hl(n))return;const a=s.activities.find(o=>o.id===this.targetId);if(!a||!a.isActive)return;const r=s.events.findLast(pl);!r||this.previousActivationTrigger&&r.eventDate<=this.previousActivationTrigger.eventDate||(this.focusCount++,this.previousActivationTrigger=r)}getActivationCount(){return this.focusCount}getTargetId(){return this.targetId}}const{parse:Mg,stringify:Rg}=JSON,{keys:Lg}=Object,Js=String,xl="string",qi={},Pr="object",gl=(t,s)=>s,Dg=t=>t instanceof Js?Js(t):t,zg=(t,s)=>typeof s===xl?new Js(s):s,vl=(t,s,n,a)=>{const r=[];for(let o=Lg(n),{length:d}=o,i=0;i<d;i++){const l=o[i],m=n[l];if(m instanceof Js){const u=t[m];typeof u===Pr&&!s.has(u)?(s.add(u),n[l]=qi,r.push({k:l,a:[t,s,u,a]})):n[l]=a.call(n,l,u)}else n[l]!==qi&&(n[l]=a.call(n,l,m))}for(let{length:o}=r,d=0;d<o;d++){const{k:i,a:l}=r[d];n[i]=a.call(n,i,vl.apply(null,l))}return n},Hi=(t,s,n)=>{const a=Js(s.push(n)-1);return t.set(n,a),a},Og=(t,s)=>{const n=Mg(t,zg).map(Dg),a=n[0],r=s||gl,o=typeof a===Pr&&a?vl(n,new Set,a,r):a;return r.call({"":o},"",o)},Bg=(t,s,n)=>{const a=gl,r=new Map,o=[],d=[];let i=+Hi(r,o,a.call({"":t},"",t)),l=!i;for(;i<o.length;)l=!0,d[i]=Rg(o[i++],m,n);return"["+d.join(",")+"]";function m(u,f){if(l)return l=!l,f;const h=a.call(this,u,f);switch(typeof h){case Pr:if(h===null)return h;case xl:return r.get(h)||Hi(r,o,h)}return h}},yl="@biochain/plugin-navigation-sync";function bl(t){return{_TAG:yl,flattedState:Bg({activity:t.activity,step:t.step})}}function Fg(t){return typeof t=="object"&&t!==null&&"_TAG"in t&&"flattedState"in t&&typeof t._TAG=="string"&&t._TAG===yl&&typeof t.flattedState=="string"}function xn(t){try{return Fg(t)?Og(t.flattedState):null}catch{return null}}function Ui({history:t,pathname:s,state:n,useHash:a}){const r=a?`${t.location.pathname}#${s}`:s;t.push(r,bl(n))}function ha({history:t,pathname:s,state:n,useHash:a}){const r=a?`${t.location.pathname}#${s}`:s;t.replace(r,bl(n))}function Vi(t){return t.length===0?void 0:t[t.length-1]}const Wg=t=>{let s=Promise.resolve();return{requestHistoryTick:a=>{s=s.then(()=>new Promise(r=>{const o=t.listen(()=>{o(),r()});a(()=>{o(),r()})}))}}};function jl(t){return new URL(t,"file://")}function La(t){const s={};return t.forEach((n,a)=>{s[a]=n}),s}function gn(t){return t.endsWith("/")?t:`${t}/`}function Ji(t){return t.toString().length>0?`?${t}`:t}function We({path:t,decode:s},n){const a=t==="*"||t==="/*",r=a?[]:Array.from(t.matchAll(/:([A-Za-z0-9_]+)/g)).map(m=>m[1]).filter(Boolean),o=Array.from(new Set(r)),d=a?Number.POSITIVE_INFINITY:o.length,i=a?"*":gn(t),l=a?null:new URLPattern({pathname:i});return{fill(m){if(a){const g=new URLSearchParams(Object.entries(m).reduce((b,[p,x])=>x?{...b,[p]:x}:b,{}));return gn("/")+Ji(g)}let u=t;for(const g of o){const b=m[g];if(b===void 0)throw new Error(`Missing route param: ${g}`);u=u.replace(`:${g}`,encodeURIComponent(b))}u=gn(u);const f={...m};o.forEach(g=>{delete f[g]});const h=new URLSearchParams(Object.entries(f).reduce((g,[b,p])=>({...g,...p?{[b]:p}:null}),{}));return u+Ji(h)},parse(m){const u=jl(m);if(a){const v={...La(u.searchParams)};return s?s(v):v}if(!l)return null;const f=gn(u.pathname),h=l.exec({pathname:f}),g=La(u.searchParams);if(!h)return null;const b=h.pathname.groups,p={...g};for(const[x,v]of Object.entries(b))v!==void 0&&(p[x]=v);return s?s(p):p},variableCount:d}}class $g{status;pendingNavigations;dispatchedEvents;baseNavigationEvents;constructor(s,n=[]){this.status=s.length>0?qt.IDLE:qt.SUCCEEDED,this.pendingNavigations=s.slice(),this.dispatchedEvents=[],this.baseNavigationEvents=n}captureNavigationOpportunity(s){if(hl(this.status))return[];if(s&&s.globalTransitionState!=="idle")return[];if(this.pendingNavigations.length===0)return this.status=qt.SUCCEEDED,[];const n=s?s.events.filter(Eg):[];if(!(this.verifyAllDispatchedEventsAreInNavigationHistory(n)&&this.verifyNoUnknownNavigationEvents(n)))return this.pendingNavigations=[],this.status=qt.FAILED,[];const a=this.pendingNavigations.shift();if(!a)return[];const r=a();return this.dispatchedEvents.push(...r),this.status=qt.PROGRESS,r}getStatus(){return this.status}verifyAllDispatchedEventsAreInNavigationHistory(s){const n=new Set(s.map(a=>a.id));return this.dispatchedEvents.every(a=>n.has(a.id))}verifyNoUnknownNavigationEvents(s){const n=new Set([...this.baseNavigationEvents,...this.dispatchedEvents].map(a=>a.id));return s.every(a=>n.has(a.id))}}function qg(t){return typeof t=="string"?{path:t}:t}function Hg(t){return(Array.isArray(t)?t:[t]).map(qg)}function Ug(t){return Object.keys(t).flatMap(n=>{const a=t[n];return a?Hg(a).map(r=>({activityName:n,...r})):[]})}class Vg{latestlyBookedSession=Promise.resolve();acquire(){return new Promise(s=>{this.latestlyBookedSession=this.latestlyBookedSession.then(()=>new Promise(n=>s({release:()=>n()})))})}async runExclusively(s){const{release:n}=await this.acquire();try{return await s()}finally{n()}}}class Jg{subscribers=[];publishLock=new Vg;subscribe(s){return this.subscribers.push(s),()=>{this.subscribers=this.subscribers.filter(n=>n!==s)}}publish(s){const n=this.subscribers.slice();return this.publishLock.runExclusively(()=>Promise.allSettled(n.map(a=>a(s))))}}const Kg=c.createContext([]),Er=t=>e.jsx(Kg.Provider,{value:t.routes,children:t.children});Er.displayName="RoutesProvider";Er.__docgenInfo={description:"",methods:[],displayName:"RoutesProvider",props:{routes:{required:!0,tsType:{name:"Array",elements:[{name:"ActivityRoute",elements:[{name:"T"}],raw:"ActivityRoute<T>"}],raw:"ActivityRoute<T>[]"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const Gg=/^:[\w-]+$/,Qg=3,Yg=1,Xg=10,Zg=-2,Ki=t=>t==="*";function Gi(t){const s=t.split("/");let n=s.length;return s.some(Ki)&&(n+=Zg),s.filter(a=>!Ki(a)).reduce((a,r)=>a+(Gg.test(r)?Qg:r===""?Yg:Xg),n)}function ev(t){return[...t].toSorted((s,n)=>Gi(n.path)-Gi(s.path))}const tv=1e3,sv=60*tv;function nv(t){"config"in t&&t.config.decorate("historySync",{makeTemplate:We,urlPatternOptions:t.urlPatternOptions});const s=t.history??(typeof window>"u"?Ig({}):Ag({window})),{location:n}=s,a="routes"in t?t.routes:t.config.activities.reduce((o,d)=>({...o,[d.name]:d.route}),{}),r=ev(Ug(a));return()=>{let o=0,d=!1,i=null;const l=[],m=new Jg,{requestHistoryTick:u}=Wg(s),f=p=>m.subscribe(async()=>p());let h=null;const g=()=>{const p=l.map(x=>({activityId:x.getTargetId(),activationCount:x.getActivationCount()}));return(!h||h.length!==p.length||h.some(({activityId:x,activationCount:v})=>p.some(({activityId:j,activationCount:N})=>j===x&&N!==v)))&&(h=p),h},b=p=>{let x=!1;for(const v of l){const j=v.getActivationCount();v.captureStackChange(p),j!==v.getActivationCount()&&(x=!0)}x&&m.publish()};return{key:"plugin-history-sync",wrapStack({stack:p}){const x=c.useSyncExternalStore(f,g,g);return e.jsx(ml,{requestHistoryTick:u,children:e.jsx(Er,{routes:r,children:e.jsx(Tg.Provider,{value:x,children:p.render()})})})},overrideInitialEvents({initialContext:p}){const x=xn(s.location.state);if(x)return[{...x.activity.enteredBy,name:"Pushed"},...x.step?.enteredBy.name==="StepPushed"||x.step?.enteredBy.name==="StepReplaced"?[{...x.step.enteredBy,name:"StepPushed"}]:[]];function v(){return p?.req?.path&&typeof p.req.path=="string"?p.req.path:t.useHash?n.hash.split("#")[1]??"/":n.pathname+n.search}const j=v(),N=t.fallbackActivity({initialContext:p}),y=r.find(I=>We(I,t.urlPatternOptions).parse(j)!==null)??r.find(I=>I.activityName===N),C=We(y,t.urlPatternOptions).parse(j)??{},P=Object.entries(C).reduce((I,[T,k])=>(typeof k=="string"&&(I[T]=k),I),{}),_=y.defaultHistory?.(P)??[];return i=new $g([..._.map(({activityName:I,activityParams:T,additionalSteps:k=[]})=>()=>{const A=[{name:"Pushed",id:rt(),activityId:rt(),activityName:I,activityParams:{...T},activityContext:{path:j,lazyActivityComponentRenderContext:{shouldRenderImmediately:!0}}},...k.map(({stepParams:w,hasZIndex:E})=>({name:"StepPushed",id:rt(),stepId:rt(),stepParams:w,hasZIndex:E}))];for(const w of A)w.name==="Pushed"&&l.push(new _g(w.activityId,i));return A}),()=>[{name:"Pushed",id:rt(),activityId:rt(),activityName:y.activityName,activityParams:We(y,t.urlPatternOptions).parse(j)??La(jl(j).searchParams),activityContext:{path:j,lazyActivityComponentRenderContext:{shouldRenderImmediately:!0}}}]]),i.captureNavigationOpportunity(null).map(I=>({...I,eventDate:Date.now()-sv}))},onInit({actions:{getStack:p,dispatchEvent:x,push:v,stepPush:j}}){const N=p(),y=N.activities[0],S=r.find(I=>I.activityName===y.name),C=We(S,t.urlPatternOptions),P=Vi(y.steps);u(()=>{d=!0,ha({history:s,pathname:C.fill(y.params),state:{activity:y,step:P},useHash:t.useHash})});const _=I=>{if(d){d=!1;return}const T=xn(I.location.state);if(!T)return;const k=T.activity,A=T.activity.id,w=T.step,{activities:E}=p(),D=E.find(F=>F.isActive);if(!D)return;const z=Vi(D.steps),R=E.find(F=>F.id===A),V=D.steps.find(F=>F.id===w?.id),M=()=>D.id>A,B=()=>D.id<A,G=()=>D.id===A,ee=()=>G()?!!(!w||z&&z.id>w.id):!1,W=()=>G()?!!(!z||w&&z.id<w.id):!1;if(M()&&(x("Popped",{}),!R&&(o+=1,v({...k.enteredBy}),w?.enteredBy.name==="StepPushed"||w?.enteredBy.name==="StepReplaced"))){const{enteredBy:F}=w;o+=1,j({...F})}if(ee()){if(!V&&w&&(w?.enteredBy.name==="StepPushed"||w?.enteredBy.name==="StepReplaced")){const{enteredBy:F}=w;o+=1,j({...F})}x("StepPopped",{})}if(B()&&(o+=1,v({activityId:k.id,activityName:k.name,activityParams:k.params})),W()){if(!w)return;o+=1,j({stepId:w.id,stepParams:w.params})}};s.listen(_),i?.captureNavigationOpportunity(N).forEach(I=>I.name==="Pushed"?v(I):j(I)),b(N)},onPushed({effect:{activity:p}}){if(o){o-=1;return}const x=r.find(j=>j.activityName===p.name),v=We(x,t.urlPatternOptions);u(()=>{d=!0,Ui({history:s,pathname:v.fill(p.params),state:{activity:p},useHash:t.useHash})})},onStepPushed({effect:{activity:p,step:x}}){if(o){o-=1;return}const v=r.find(N=>N.activityName===p.name),j=We(v,t.urlPatternOptions);u(()=>{d=!0,Ui({history:s,pathname:j.fill(p.params),state:{activity:p,step:x},useHash:t.useHash})})},onReplaced({effect:{activity:p}}){if(!p.isActive)return;const x=r.find(j=>j.activityName===p.name),v=We(x,t.urlPatternOptions);u(()=>{d=!0,ha({history:s,pathname:v.fill(p.params),state:{activity:p},useHash:t.useHash})})},onStepReplaced({effect:{activity:p,step:x}}){if(!p.isActive)return;const v=r.find(N=>N.activityName===p.name),j=We(v,t.urlPatternOptions);u(()=>{d=!0,ha({history:s,pathname:j.fill(p.params),state:{activity:p,step:x},useHash:t.useHash})})},onBeforePush({actionParams:p,actions:{overrideActionParams:x}}){if(!p.activityContext||!("path"in p.activityContext)){const v=r.find(y=>y.activityName===p.activityName),N=We(v,t.urlPatternOptions).fill(p.activityParams);x({...p,activityContext:{...p.activityContext,path:N}})}},onBeforeReplace({actionParams:p,actions:{overrideActionParams:x,getStack:v}}){if(!p.activityContext||!("path"in p.activityContext)){const S=r.find(_=>_.activityName===p.activityName),P=We(S,t.urlPatternOptions).fill(p.activityParams);x({...p,activityContext:{...p.activityContext,path:P}})}const{activities:j}=v(),N=j.filter(S=>S.transitionState==="enter-active"||S.transitionState==="enter-done"),y=N.length>0?N[N.length-1]:null;if(y)for(let S=0;S<y.steps.length-1;S+=1)u(C=>{xn(s.location.state)?C():(d=!0,s.back())}),u(()=>{d=!0,s.back()})},onBeforeStepPop({actions:{getStack:p}}){const{activities:x}=p();(x.find(j=>j.isActive)?.steps.length??0)>1&&u(()=>{d=!0,s.back()})},onBeforePop({actions:{getStack:p}}){const{activities:x}=p(),v=x.find(j=>j.isActive);if(v){const{isRoot:j,steps:N}=v,y=j?0:N.length;for(let S=0;S<y;S+=1)u(C=>{xn(s.location.state)?C():(d=!0,s.back())}),u(()=>{d=!0,s.back()})}},onChanged({actions:{getStack:p,push:x,stepPush:v}}){const j=p();i?.captureNavigationOpportunity(j).forEach(N=>N.name==="Pushed"?x(N):v(N)),b(j)}}}}function Nl(){const{t}=O(["settings","common"]),[s,n]=c.useState(!1),a=()=>{n(!0);const r="./";window.location.href=`${r}clear.html`};return e.jsx("div",{className:"bg-background flex min-h-screen flex-col items-center justify-center p-6",children:e.jsxs("div",{className:"flex max-w-sm flex-col items-center gap-6 text-center",children:[e.jsx("div",{className:"bg-destructive/10 flex size-20 items-center justify-center rounded-full",children:e.jsx(Oe,{className:"text-destructive size-10"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-xl font-bold",children:t("settings:storage.migrationRequired")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:t("settings:storage.migrationDesc")})]}),e.jsx("div",{className:"bg-destructive/5 w-full rounded-lg p-4",children:e.jsxs("ul",{className:"text-destructive space-y-2 text-left text-sm",children:[e.jsxs("li",{children:[" ",t("settings:clearData.item1")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item2")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item3")]})]})}),e.jsxs(J,{variant:"destructive",onClick:a,className:"w-full gap-2",disabled:s,children:[e.jsx(ss,{className:"size-4"}),t("settings:clearData.confirm")]})]})})}Nl.__docgenInfo={description:`


 Stackflow context  useFlow()`,methods:[],displayName:"MigrationRequiredView"};function av(t){switch(t){case"confirmed":return"confirmed";case"failed":return"failed";default:return"pending"}}function wl(t,s){const n=t.meta?.displayAmount??"0",a=t.meta?.displaySymbol??"",r=oe.fromFormatted(n,s,a);return{id:`${t.chainId}--${t.txHash}`,type:t.meta?.type??"other",status:av(t.status),amount:r,symbol:a,address:t.meta?.displayToAddress??t.fromAddress,timestamp:new Date(t.createdAt),hash:t.txHash,chain:t.chainId}}const kl=c.createContext(null);function Dt({chainId:t,children:s,fallback:n=null}){const a=c.useMemo(()=>t?Pe(t):null,[t]);return a?e.jsx(kl.Provider,{value:a,children:s},t):e.jsx(e.Fragment,{children:n})}function rs(){const t=c.useContext(kl);if(!t)throw new Error("useChainProvider must be used within ChainProviderGate. Make sure to wrap your component with <ChainProviderGate chainId={...}>.");return t}Dt.__docgenInfo={description:`ChainProvider 

 ChainProvider 
 chainId  fallback  null

@example
\`\`\`tsx
<ChainProviderGate chainId={selectedChain} fallback={<ChainNotSupported />}>
  <WalletContent />
</ChainProviderGate>
\`\`\``,methods:[],displayName:"ChainProviderGate",props:{chainId:{required:!0,tsType:{name:"union",raw:"string | null | undefined",elements:[{name:"string"},{name:"null"},{name:"undefined"}]},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},fallback:{required:!1,tsType:{name:"ReactNode"},description:" provider ",defaultValue:{value:"null",computed:!1}}}};function Da(t,s){return c.useMemo(()=>t?t instanceof Mo?{supported:!1,limited:!1,type:"notSupported",reason:s("common:service.notSupported")}:t instanceof Tm?{supported:!0,limited:!0,type:"limited",reason:s("common:service.limited")}:{supported:!0,limited:!1,type:"error",error:t,reason:t.message}:{supported:!0,limited:!1,type:"ok"},[t,s])}function rv(t,s){return t==="transfer"?s==="in"?"receive":"send":{swap:"swap",exchange:"exchange",approve:"approve",stake:"stake",unstake:"unstake",mint:"mint",burn:"destroy",gift:"gift",grab:"grab",trust:"trust",signFor:"signFor",emigrate:"emigrate",immigrate:"immigrate",issueAsset:"issueAsset",increaseAsset:"increaseAsset",destroyAsset:"destroy",issueEntity:"issueEntity",destroyEntity:"destroyEntity",locationName:"locationName",dapp:"dapp",certificate:"certificate",mark:"mark",signature:"signature"}[t]??"other"}function iv(t,s){const n=l=>l?s?`${s}--${l}`:l:"unknown";if(!t||!t.hash||!t.assets||t.assets.length===0)return{id:n(t?.hash),type:"other",status:"pending",amount:oe.fromRaw("0",8,""),symbol:"",address:t?.from??t?.to??"",timestamp:new Date,hash:t?.hash,chain:s};const a=t.assets[0],r=t.direction==="in"?t.from:t.to;let o=8,d="0",i="";return(a.assetType==="native"||a.assetType==="token")&&(o=a.decimals??8,d=a.value??"0",i=a.symbol??""),{id:n(t.hash),type:rv(t.action,t.direction),status:t.status,amount:oe.fromRaw(d,o,i),symbol:i,address:r,timestamp:new Date(t.timestamp),hash:t.hash,chain:s}}function Cl(t,s){return!t||!Array.isArray(t)?[]:t.filter(n=>n!=null).map(n=>{try{return iv(n,s)}catch(a){return console.warn("[toTransactionInfoList] Failed to convert transaction:",n,a),{id:s?`${s}--${n?.hash??"error"}`:n?.hash??"error",type:"other",status:"pending",amount:oe.fromRaw("0",8,""),symbol:"",address:"",timestamp:new Date,chain:s}}})}function ov({address:t,selectedChain:s,selectedChainName:n,mainAssetSymbol:a,wallets:r,currentWalletId:o,chainPreferences:d,onWalletChange:i,onCopyAddress:l,onOpenChainSelector:m,onOpenSettings:u,onOpenWalletList:f,onAddWallet:h,onOpenAddressBalance:g,onOpenAddressTransactions:b}){const{push:p}=Z(),x=an(),{t:v}=O(["home","wallet","common","transaction"]),j=dt(),N=j.snapshot?He.getChainById(j,s):void 0,y=rs(),{data:S=[],isLoading:C,isFetching:P,error:_}=y.allBalances.useState({address:t},{enabled:!!t}),{data:I,isLoading:T,isFetching:k,error:A}=y.transactionHistory.useState({address:t,limit:50},{enabled:!!t}),w=C||P&&S.length===0,E=Da(_,v),D=Da(A,v),{transactions:z,deleteTransaction:R,retryTransaction:V}=To(o??void 0,s,t,I),M=c.useMemo(()=>I?Cl(I,s):[],[I,s]),B=T||k&&M.length===0,G=c.useCallback(W=>{if(W.id){const F=I?.find(ne=>ne.hash===W.hash),ie=F?Qt.stringify(F):void 0;p("TransactionDetailActivity",{txId:W.id,txData:ie})}},[p,I]),ee=c.useCallback((W,F)=>[{label:v("home:wallet.transfer"),icon:e.jsx(rc,{className:"size-4"}),onClick:()=>{x.impact("light"),p("SendActivity",{assetType:W.symbol})}},{label:v("home:wallet.destroy"),icon:e.jsx(Sn,{className:"size-4"}),onClick:()=>{x.impact("light"),p("DestroyActivity",{assetType:W.symbol,assetLocked:"true"})},variant:"destructive",show:F.canDestroy}],[x,p,v]);return e.jsxs("div",{"data-testid":"wallet-home",className:"flex h-full flex-col overflow-y-auto bg-background",children:[e.jsxs("div",{className:"pt-2 pb-1",children:[e.jsx(em,{wallets:r,currentWalletId:o,selectedChain:s,chainPreferences:d,onWalletChange:i,onCopyAddress:l,onOpenChainSelector:m,onOpenSettings:u,onOpenWalletList:f,onAddWallet:h,onOpenAddressBalance:g,onOpenAddressTransactions:b}),e.jsxs("div",{className:"mt-2 flex justify-center gap-8 px-6",children:[e.jsxs("button",{onClick:()=>p("SendActivity",{}),"data-testid":"wallet-home-send-button",className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:e.jsx(uc,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:v("home:wallet.send")})]}),e.jsxs("button",{onClick:()=>p("ReceiveActivity",{}),"data-testid":"wallet-home-receive-button",className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:e.jsx(zp,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:v("home:wallet.receive")})]}),e.jsxs("button",{onClick:()=>p("ScannerActivity",{}),"data-testid":"wallet-home-scan-button",className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:e.jsx(Lm,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:v("common:a11y.scan")})]})]})]}),z.length>0&&e.jsxs("div",{className:"px-4 pt-2 space-y-2",children:[e.jsx("h3",{className:"text-muted-foreground text-xs font-medium uppercase tracking-wider px-1",children:v("transaction:pendingTx.title")}),e.jsx("div",{className:"space-y-1",children:z.slice(0,3).map(W=>{const F=wl(W,N?.decimals??8);return e.jsx(Ro,{transaction:F,onClick:()=>p("TransactionDetailActivity",{txId:F.id}),onRetry:W.status==="failed"?()=>V(W):void 0,onDelete:()=>R(W)},W.id)})}),z.length>3&&e.jsx("button",{onClick:()=>p("HistoryActivity",{chain:s}),className:"mt-2 w-full rounded-lg bg-muted/60 py-2 text-xs font-medium text-muted-foreground transition-colors hover:bg-muted",children:v("transaction:pendingTx.viewAll",{count:z.length})})]}),e.jsx("div",{className:"flex-1 pt-3",children:e.jsx(wm,{chainId:s,chainName:n,tokens:S.map(W=>({symbol:W.symbol,name:W.name,chain:s,balance:W.amount.toFormatted(),decimals:W.decimals,fiatValue:void 0,change24h:0,icon:W.icon})),transactions:M.slice(0,5),tokensLoading:w,tokensRefreshing:P&&S.length>0,transactionsLoading:B,transactionsRefreshing:k&&M.length>0,tokensSupported:E.type!=="notSupported",tokensFallbackReason:E.type!=="ok"?E.reason:void 0,transactionsSupported:D.type!=="notSupported"&&D.type!=="limited",transactionsFallbackReason:D.type!=="ok"?D.reason:void 0,onTokenClick:W=>{},onTransactionClick:G,mainAssetSymbol:a,tokenMenuItems:ee,renderTransactionFooter:()=>e.jsx("button",{onClick:()=>p("HistoryActivity",{chain:M.length>0?s:"all"}),className:"mt-3 w-full rounded-lg bg-muted/60 py-2.5 text-sm font-medium text-muted-foreground transition-colors hover:bg-muted",children:M.length>0?v("transaction:history.viewAll",{count:M.length}):v("transaction:history.viewAllChains")}),testId:"wallet-home"})}),e.jsx("div",{className:"shrink-0 h-[var(--tab-bar-height)]"})]})}function Sl(){const{push:t}=Z(),s=fr(),n=st(),a=an(),{t:r}=O(["home","wallet","common","transaction"]),o=am(),d=dm(),i=um(),l=Mt(),m=Fe(),u=Jn(),f=m?.id??null,h=Je(),g=Ya(),b=r(`common:chains.${h}`,{defaultValue:h}),p=dt(),v=(p.snapshot?He.getChainById(p,h):null)?.symbol;So();const j=u?.address??"",N=c.useCallback(async k=>{await s.write({text:k}),await a.impact("light"),n.show(r("home:wallet.addressCopied"))},[s,a,n,r]),y=c.useCallback(k=>{k!==f&&ye.setCurrentWallet(k),t("ChainSelectorJob",{})},[t,f]),S=c.useCallback(k=>{const A=l.find(w=>w.id===k);A&&t("WalletConfigActivity",{walletId:k,walletName:A.name})},[t,l]),C=c.useCallback(k=>{ye.setCurrentWallet(k)},[]),P=c.useCallback(()=>{t("WalletAddJob",{})},[t]),_=c.useCallback(()=>{t("WalletListJob",{})},[t]),I=c.useCallback(()=>{t("AddressBalanceActivity",{})},[t]),T=c.useCallback(()=>{t("AddressTransactionsActivity",{})},[t]);return o?e.jsx(Nl,{}):d?!i||!m?e.jsx(cv,{}):e.jsx(Dt,{chainId:h,fallback:e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:r("common:ecosystem.chainNotSupported")})}),children:e.jsx(ov,{address:j,selectedChain:h,selectedChainName:b,mainAssetSymbol:v,wallets:l,currentWalletId:f,chainPreferences:g,onWalletChange:C,onCopyAddress:N,onOpenChainSelector:y,onOpenSettings:S,onOpenWalletList:_,onAddWallet:P,onOpenAddressBalance:I,onOpenAddressTransactions:T})}):e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(Te,{size:"lg"})})}function cv(){const{push:t}=Z(),{t:s}=O("home");return e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-6 p-6 text-center",children:[e.jsx("div",{className:"bg-primary/10 rounded-full p-6",children:e.jsx(ut,{className:"text-primary size-12"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:s("welcome.title")}),e.jsx("p",{className:"text-muted-foreground mt-2",children:s("welcome.subtitle")})]}),e.jsxs("div",{className:"flex w-full max-w-xs flex-col gap-3",children:[e.jsx(Ue,{variant:"mint",className:"w-full","data-testid":"create-wallet-button",onClick:()=>t("WalletCreateActivity",{}),children:s("welcome.createWallet")}),e.jsx(J,{variant:"outline",className:"w-full","data-testid":"import-wallet-button",onClick:()=>t("OnboardingRecoverActivity",{}),children:s("welcome.importWallet")})]})]})}Sl.__docgenInfo={description:"",methods:[],displayName:"WalletTab"};function Al(){const{push:t}=Z(),s=c.useRef(null),[n,a]=c.useState([]),[r,o]=c.useState(!0),d=Ae(tr,b=>b.myApps);c.useEffect(()=>{let b=!1;const p=Wm(x=>{a(x),b||(b=!0,o(!1))});return zo({refresh:!0}).then(()=>{b||(a($m()),o(!1))}),()=>p()},[]),qm();const i=c.useCallback(b=>{t("MiniappDetailActivity",{appId:encodeURIComponent(b.id)})},[t]),l=c.useCallback(b=>{Me.installApp(b.id),Me.updateAppLastUsed(b.id),Me.setActiveSubPage("mine"),s.current?.slideTo("mine"),requestAnimationFrame(()=>{Oo(b.id,{...b,targetDesktop:"mine"})})},[]),m=c.useCallback(b=>{Me.uninstallApp(b)},[]),u=c.useMemo(()=>d.map(b=>({...b,app:n.find(p=>p.id===b.appId)})).filter(b=>!!b.app).map(({app:b,lastUsedAt:p})=>({app:b,lastUsed:p})),[d,n]),f=c.useMemo(()=>n.length===0?[]:[...n].toSorted((b,p)=>ii(p)-ii(b)).slice(0,2),[n]),h=c.useMemo(()=>{const b=new Set(f.map(p=>p.id));return[...n].filter(p=>!b.has(p.id)).toSorted((p,x)=>(x.officialScore??0)-(p.officialScore??0)).slice(0,6)},[n,f]),g=c.useMemo(()=>[...n].toSorted((b,p)=>(p.communityScore??0)-(b.communityScore??0)).slice(0,10),[n]);return r?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(Te,{size:"lg"})}):e.jsx(tf,{ref:s,showDiscoverPage:!0,showStackPage:"auto",apps:n,myApps:u,featuredApps:f,recommendedApps:h,hotApps:g,onAppOpen:l,onAppDetail:i,onAppRemove:m})}Al.__docgenInfo={description:"",methods:[],displayName:"EcosystemTab"};const lv=/^(\d+)\.(\d+)\.(\d+)(?:-([0-9A-Za-z.-]+))?$/;function Qi(t){const s=t.match(lv);if(!s)return null;const[,n,a,r,o]=s,d=o&&/^\d+$/.test(o)?Number(o):void 0;return{major:Number(n),minor:Number(a),patch:Number(r),suffix:o??void 0,suffixNumber:d}}function dv(t,s){const n=Qi(t),a=Qi(s);if(!n||!a)return null;if(n.major!==a.major)return n.major-a.major;if(n.minor!==a.minor)return n.minor-a.minor;if(n.patch!==a.patch)return n.patch-a.patch;const r=n.suffixNumber??(n.suffix?Number.NaN:0),o=a.suffixNumber??(a.suffix?Number.NaN:0);return!Number.isNaN(r)&&!Number.isNaN(o)?r-o:n.suffix&&!a.suffix?1:!n.suffix&&a.suffix?-1:n.suffix&&a.suffix?n.suffix.localeCompare(a.suffix):0}function xa(t){return t.endsWith("/")?t:`${t}/`}function uv(t){return t.endsWith("/")?t:`${t}/`}function mv(){const t=xa("https://BioforestChain.github.io");try{const a=new URL(t).pathname;if(a&&a!=="/")return xa(t)}catch{return t}const s=uv("/KeyApp/");return xa(new URL(s,t).toString())}function fv(){const t=mv(),s="dweb-dev/metadata.json";return new URL(s,t).toString()}function pv(t){return`dweb://install?url=${encodeURIComponent(t)}`}async function hv(t){const s=await fetch(t,{cache:"no-store"});if(!s.ok)throw new Error(`metadata fetch failed: ${s.status}`);const n=await s.json(),a=typeof n.version=="string"?n.version:"",r=typeof n.change_log=="string"?n.change_log:n.changeLog;return{version:a,changeLog:r}}async function xv(){const t="1.0.2-021603",s=Cm();let n="",a="";try{n=fv(),a=pv(n)}catch(r){const o=r instanceof Error?r.message:"invalid site origin";return{status:"error",currentVersion:t,metadataUrl:n,installUrl:a,error:o}}try{const r=await hv(n);if(!r.version)return{status:"error",currentVersion:t,metadataUrl:n,installUrl:a,error:"metadata version missing"};const o=dv(r.version,t);return o===null?{status:"error",currentVersion:t,metadataUrl:n,installUrl:a,error:"version parse failed"}:s?o>0?{status:"update-available",currentVersion:t,latestVersion:r.version,metadataUrl:n,installUrl:a,changeLog:r.changeLog}:{status:"up-to-date",currentVersion:t,latestVersion:r.version,metadataUrl:n,installUrl:a,changeLog:r.changeLog}:{status:"not-dweb",currentVersion:t,latestVersion:r.version,metadataUrl:n,installUrl:a,changeLog:r.changeLog}}catch(r){const o=r instanceof Error?r.message:"unknown error";return{status:"error",currentVersion:t,metadataUrl:n,installUrl:a,error:o}}}const gv={status:"idle",currentVersion:"1.0.2-021603",dialogOpen:!1},Wt=new Yu(gv),vv={openDialog:()=>{Wt.setState(t=>({...t,dialogOpen:!0}))},closeDialog:()=>{Wt.setState(t=>({...t,dialogOpen:!1}))},check:async t=>{const{status:s}=Wt.state;if(s==="checking")return{status:"error",currentVersion:"1.0.2-021603",metadataUrl:"",installUrl:"",error:"already checking"};Wt.setState(a=>({...a,status:"checking"}));const n=await xv();return Wt.setState(a=>({...a,status:n.status,currentVersion:n.currentVersion,latestVersion:n.latestVersion,changeLog:n.changeLog,metadataUrl:n.metadataUrl,installUrl:n.installUrl,error:n.error,lastCheckedAt:Date.now(),dialogOpen:n.status==="update-available"?!0:a.dialogOpen})),t==="auto"&&n.status!=="update-available"&&Wt.setState(a=>({...a,dialogOpen:!1})),n}};function yv(){return Ae(Wt)}function Se({icon:t,label:s,value:n,showChevron:a=!0,disabled:r=!1,onClick:o,trailing:d,className:i,testId:l}){const m=o?"button":"div";return e.jsxs(m,{type:o?"button":void 0,onClick:r?void 0:o,disabled:r,"data-testid":l,className:L("bg-background flex w-full items-center gap-3 rounded-xl px-4 py-3.5","transition-colors",o&&!r&&"hover:bg-muted/50 active:bg-muted",r&&"cursor-not-allowed",i),children:[t&&e.jsx("span",{className:"bg-muted text-foreground flex size-8 shrink-0 items-center justify-center rounded-lg",children:t}),e.jsx("span",{className:L("flex-1 text-left text-sm font-medium",r&&"text-muted-foreground"),children:s}),d??e.jsxs(e.Fragment,{children:[n&&e.jsx("span",{className:"text-muted-foreground text-sm",children:n}),a&&o&&e.jsx(Le,{className:"text-muted-foreground/50 size-5"})]})]})}Se.__docgenInfo={description:"",methods:[],displayName:"SettingsItem",props:{icon:{required:!1,tsType:{name:"union",raw:"ReactNode | undefined",elements:[{name:"ReactNode"},{name:"undefined"}]},description:""},label:{required:!0,tsType:{name:"string"},description:""},value:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},showChevron:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"",defaultValue:{value:"true",computed:!1}},disabled:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"",defaultValue:{value:"false",computed:!1}},onClick:{required:!1,tsType:{name:"union",raw:"(() => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},trailing:{required:!1,tsType:{name:"union",raw:"ReactNode | undefined",elements:[{name:"ReactNode"},{name:"undefined"}]},description:""},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:" className"},testId:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:" ID"}}};function Es({title:t,children:s,className:n,allowContextMenu:a}){return e.jsxs("section",{className:L("space-y-1",n),"data-allow-context-menu":a?"true":void 0,children:[t&&e.jsx("h3",{className:"mb-2 px-1 text-xs font-medium uppercase text-muted-foreground",children:t}),e.jsx("div",{className:"overflow-hidden rounded-xl bg-card shadow-sm",children:s})]})}Es.__docgenInfo={description:"",methods:[],displayName:"SettingsSection",props:{title:{required:!1,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},className:{required:!1,tsType:{name:"string"},description:" className"},allowContextMenu:{required:!1,tsType:{name:"boolean"},description:"DWEB "}}};const bv=[{value:"system",icon:gp},{value:"light",icon:qp},{value:"dark",icon:Tp}];function Il({open:t,onOpenChange:s}){const{t:n}=O("settings"),a=ko(),r=o=>{Un.setTheme(o),s(!1)};return e.jsx(Ct,{open:t,onOpenChange:s,children:e.jsxs(St,{side:"bottom",className:"rounded-t-2xl",children:[e.jsx(At,{children:e.jsx(It,{children:n("appearance.title")})}),e.jsx("div",{className:"mt-4 space-y-2",children:bv.map(({value:o,icon:d})=>e.jsxs("button",{onClick:()=>r(o),className:L("flex w-full items-center gap-3 rounded-xl p-4 transition-colors",a===o?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx(d,{size:24}),e.jsx("span",{className:"flex-1 text-left font-medium",children:n(`appearance.${o}`)}),a===o&&e.jsx(je,{size:20})]},o))})]})})}Il.__docgenInfo={description:"",methods:[],displayName:"AppearanceSheet",props:{open:{required:!0,tsType:{name:"boolean"},description:""},onOpenChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(open: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"open"}],return:{name:"void"}}},description:""}}};const qe=we.t.bind(we);async function jv(t,s){const n=Pe(t.id);if(!n.estimateFee||!n.buildTransaction){const r=lt.getBiowalletApi(t.id);if(!r)throw new Error(qe("error:transaction.feeEstimateFailed"));const o=await $r(r,t.id,s,"1");return{amount:oe.fromRaw(o,t.decimals,t.symbol),symbol:t.symbol}}const a=await n.buildTransaction({type:"transfer",from:s,to:s,amount:oe.fromRaw("1",t.decimals,t.symbol)});try{return{amount:(await n.estimateFee(a)).standard.amount,symbol:t.symbol}}catch{const r=lt.getBiowalletApi(t.id);if(!r)throw new Error(qe("error:transaction.feeEstimateFailed"));const o=await $r(r,t.id,s,"1");return{amount:oe.fromRaw(o,t.decimals,t.symbol),symbol:t.symbol}}}async function Yi({chainConfig:t,walletId:s,password:n,fromAddress:a,toAddress:r,amount:o,assetType:d,fee:i,twoStepSecret:l}){let m;try{m=await gs.getMnemonic(s,n)}catch(f){return f instanceof Gs&&f.code===vs.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:f instanceof Error?f.message:qe("error:unknown")}}if(!o.isPositive())return{status:"error",message:qe("error:validation.enterValidAmount")};const u=Pe(t.id);if(!u.supportsFullTransaction)return{status:"error",message:qe("error:transaction.chainNotSupported")};try{let f=null;if(u.bioGetAccountInfo){if(f=(await u.bioGetAccountInfo(a)).secondPublicKey,f&&!l)return{status:"password_required",secondPublicKey:f};if(l&&f&&u.bioVerifyPayPassword&&!await u.bioVerifyPayPassword({mainSecret:m,paySecret:l,publicKey:f}))return{status:"error",message:qe("error:transaction.securityPasswordFailed")}}const h=await u.buildTransaction({type:"transfer",from:a,to:r,amount:o,fee:i,bioAssetType:d}),g=await u.signTransaction(h,{privateKey:new TextEncoder().encode(m),bioSecret:m,bioPaySecret:l}),b=await wt.create({walletId:_o(t.id,a),chainId:t.id,fromAddress:a,rawTx:g,meta:{type:"send",displayAmount:o.toFormatted(),displaySymbol:d,displayToAddress:r}});await wt.updateStatus({id:b.id,status:"broadcasting"});try{const p=await u.broadcastTransaction(g);return await wt.updateStatus({id:b.id,status:"broadcasted",txHash:p}),{status:"ok",txHash:p,pendingTxId:b.id}}catch(p){const x=p;return await wt.updateStatus({id:b.id,status:"failed",errorCode:"BROADCAST_FAILED",errorMessage:x.message}),{status:"error",message:x.message,pendingTxId:b.id}}}catch(f){return{status:"error",message:(f instanceof Error?f.message:String(f))||qe("error:transaction.failed")}}}async function Nv({chainConfig:t,walletId:s,password:n,fromAddress:a,newTwoStepSecret:r}){let o;try{o=await gs.getMnemonic(s,n)}catch(i){return i instanceof Gs&&i.code===vs.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:i instanceof Error?i.message:qe("error:unknown")}}const d=Pe(t.id);if(!d.supportsFullTransaction)return{status:"error",message:qe("error:transaction.chainNotSupported")};try{if(d.bioGetAccountInfo&&(await d.bioGetAccountInfo(a)).secondPublicKey)return{status:"already_set"};const i=await d.buildTransaction({type:"setPayPassword",from:a}),l=await d.signTransaction(i,{privateKey:new TextEncoder().encode(o),bioSecret:o,bioNewPaySecret:r});return{status:"ok",txHash:await d.broadcastTransaction(l)}}catch(i){const l=i instanceof Error?i.message:String(i);return l.includes("fee")||l.includes("")?{status:"error",message:qe("error:insufficientFunds")}:{status:"error",message:l||qe("error:transaction.failed")}}}async function wv(t){const s=Pe(t.id);if(!s.buildTransaction||!s.estimateFee)return null;try{const n=await s.buildTransaction({type:"setPayPassword",from:"0x0000000000000000000000000000000000000000"});return{amount:(await s.estimateFee(n)).standard.amount,symbol:t.symbol}}catch{return null}}async function kv(t,s){const n=Pe(t.id);if(!n.bioGetAccountInfo)return!1;try{return!!(await n.bioGetAccountInfo(s)).secondPublicKey}catch{return!1}}function pe({cancelable:t,onCancel:s,onOutsideClick:n,...a}){const r=t??!!s,o=d=>{if(!r){d.preventDefault();return}if(s){s(),d.preventDefault();return}n?.(d)};return e.jsx(hg,{onOutsideClick:o,...a})}const Tl=yg;function Dn({title:t,children:s,className:n}){return e.jsxs("div",{className:L("bg-background rounded-t-2xl",n),children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),t&&e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t})}),s,e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}pe.__docgenInfo={description:"Re-export Stackflow BottomSheet",methods:[],displayName:"BottomSheet",props:{cancelable:{required:!1,tsType:{name:"boolean"},description:`Whether the sheet supports cancel (outside click).
Defaults to true to preserve existing behavior.`},onCancel:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:`Cancel handler invoked when outside click happens.
If provided, it is responsible for closing the sheet (call pop).`}}};Dn.__docgenInfo={description:"Standard sheet content wrapper with handle, title, and safe area",methods:[],displayName:"SheetContent",props:{title:{required:!1,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};function Cv(t,s=10,n=8){return t.length<=s+n+3?t:`${t.slice(0,s)}...${t.slice(-n)}`}const Pl=()=>{const{t}=O(["home","common"]),{pop:s}=Z(),n=Fe(),a=Je(),r=ts(),o=c.useMemo(()=>n?n.chainAddresses.map(l=>l.chain):[],[n]),d=l=>{ye.setSelectedChain(l),s()},i=()=>{s()};return e.jsx(pe,{onCancel:i,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("home:wallet.selectNetwork")})}),e.jsx("div",{"data-testid":"chain-sheet",className:"max-h-[60vh] space-y-2 overflow-y-auto p-4",children:o.map(l=>{const m=n?.chainAddresses.find(u=>u.chain===l);return e.jsxs("button",{"data-testid":`chain-option-${l}`,onClick:()=>d(l),className:`flex w-full items-center gap-3 rounded-xl p-4 transition-colors ${l===a?"bg-primary/10 ring-1 ring-primary":"bg-muted/50 hover:bg-muted"}`,children:[e.jsx(Et,{chain:l,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:r[l]??l}),e.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:m?.address?Cv(m.address):"---"})]}),l===a&&e.jsx(je,{className:"size-5 text-primary"})]},l)})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};Pl.__docgenInfo={description:"",methods:[],displayName:"ChainSelectorJob"};const Xi={"/":"MainTabsActivity","/wallet/list":"WalletListActivity","/wallet/create":"WalletCreateActivity","/send":"SendActivity","/receive":"ReceiveActivity","/settings":"SettingsActivity","/settings/language":"SettingsLanguageActivity","/settings/currency":"SettingsCurrencyActivity","/settings/chains":"SettingsChainsActivity","/settings/mnemonic":"SettingsMnemonicActivity","/settings/wallet-lock":"SettingsWalletLockActivity","/settings/wallet-chains":"SettingsWalletChainsActivity","/settings/storage":"SettingsStorageActivity","/settings/sources":"SettingsSourcesActivity","/history":"HistoryActivity","/scanner":"ScannerActivity","/onboarding/recover":"OnboardingRecoverActivity","/address-book":"AddressBookActivity","/my-card":"MyCardActivity","/notifications":"NotificationsActivity","/staking":"StakingActivity","/welcome":"WelcomeActivity"},Sv=[{pattern:/^\/wallet\/([^/]+)$/,activity:"WalletConfigActivity",paramExtractor:t=>({walletId:t[1]??""})},{pattern:/^\/transaction\/([^/]+)$/,activity:"TransactionDetailActivity",paramExtractor:t=>({txId:t[1]??""})},{pattern:/^\/authorize\/address\/([^/]+)$/,activity:"AuthorizeAddressActivity",paramExtractor:t=>({id:t[1]??""})},{pattern:/^\/authorize\/signature\/([^/]+)$/,activity:"AuthorizeSignatureActivity",paramExtractor:t=>({id:t[1]??""})},{pattern:/^\/token\/([^/]+)$/,activity:"TokenDetailActivity",paramExtractor:t=>({tokenId:t[1]??""})}];function Av(t){if(Xi[t])return{activity:Xi[t],params:{}};for(const{pattern:s,activity:n,paramExtractor:a}of Sv){const r=t.match(s);if(r)return{activity:n,params:a(r)}}return null}function de(){const t=Z();return{navigate:a=>{const r=typeof a=="string"?{to:a}:a,o=Av(r.to);if(!o)return;const d={...o.params,...r.search};r.replace?t.replace(o.activity,d,{animate:!0}):t.push(o.activity,d,{animate:!0})},goBack:()=>{t.pop()}}}const El=c.createContext({});function me({params:t,children:s}){return e.jsx(El.Provider,{value:t,children:s})}function he(){return c.useContext(El)}me.__docgenInfo={description:"",methods:[],displayName:"ActivityParamsProvider",props:{params:{required:!0,tsType:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""}}};function Iv(){const{t}=O("wallet"),{pop:s}=Z(),{walletId:n}=he(),r=Mt().find(u=>u.id===n),[o,d]=c.useState(r?.name??"");c.useEffect(()=>{r&&d(r.name)},[r]);const i=c.useCallback(()=>{if(!r)return;const u=o.trim();u&&(ye.updateWalletName(r.id,u),s())},[r,o,s]),l=()=>{s()};if(!r)return null;const m=o.trim().length>0&&o.trim()!==r.name;return e.jsx(pe,{onCancel:l,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("editSheet.renameTitle")})}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"wallet-name",className:"text-sm font-medium",children:t("editSheet.walletName")}),e.jsx("input",{id:"wallet-name",type:"text",value:o,onChange:u=>d(u.target.value),placeholder:t("editSheet.walletNamePlaceholder"),maxLength:20,className:L("w-full rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")}),e.jsxs("p",{className:"text-right text-xs text-muted-foreground",children:[o.length,"/20"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:i,disabled:!m,className:L("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t("editSheet.save")}),e.jsx("button",{onClick:l,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("editSheet.cancel")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const _l=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Iv,{})});_l.__docgenInfo={description:"",methods:[],displayName:"WalletRenameJob"};function Tv(){const{t}=O("wallet"),{pop:s}=Z(),{navigate:n}=de(),{walletId:a}=he(),o=Mt().find(b=>b.id===a),[d,i]=c.useState([]),[l,m]=c.useState(!1),[u,f]=c.useState(!1),h=()=>{s()},g=c.useCallback(async b=>{if(!(!o||b.length<4)){if(!o.encryptedMnemonic){ye.deleteWallet(o.id),n({to:"/"});return}f(!0),m(!1);try{const p=Be(b);if(!await Vt(o.encryptedMnemonic,p)){m(!0),i([]);return}ye.deleteWallet(o.id),n({to:"/"})}catch{m(!0),i([])}finally{f(!1)}}},[o,n]);return o?e.jsx(pe,{onCancel:h,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("editSheet.deleteTitle")})}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsx("p",{className:"text-center text-muted-foreground",children:t("editSheet.deleteWarning",{name:o.name})}),e.jsx(mt,{value:d,onChange:i,onComplete:g,minPoints:4,error:l,disabled:u}),e.jsx("div",{className:"space-y-3",children:e.jsx("button",{onClick:h,disabled:u,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("editSheet.cancel")})})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}):null}const Ml=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Tv,{})});Ml.__docgenInfo={description:"",methods:[],displayName:"WalletDeleteJob"};let zn=null,_r=null;function ks(t,s){zn=t,_r=null}function Pv(){zn=null,_r=null}function Ev(){const{t}=O("security"),{pop:s}=Z(),{title:n,description:a,biometricAvailable:r,miniappName:o,miniappIcon:d,walletName:i,walletAddress:l,walletChainId:m}=he(),[u,f]=c.useState([]),[h,g]=c.useState(!1),[b,p]=c.useState(null),[x,v]=c.useState(!1),j=c.useRef(null),N=c.useRef(null),y=c.useRef(null),S=c.useRef(!1);!S.current&&zn&&(N.current=zn,y.current=_r,Pv(),S.current=!0);const C=n??t("patternLock.unlockTitle"),P=r==="true"&&y.current,_=!!(i&&l&&m),I=!!(o||d||_||m),T=c.useCallback(()=>{j.current&&(clearTimeout(j.current),j.current=null),g(!1),p(null)},[]),k=c.useCallback(D=>{h&&D.length>0&&T(),f(D)},[h,T]),A=c.useCallback(async D=>{const z=N.current;if(!(D.length<4||!z)){v(!0),T();try{const R=Be(D);await z(R)?s():(g(!0),p(t("walletLock.error")),f([]),j.current=setTimeout(()=>{g(!1),p(null)},1500))}catch(R){g(!0),p(R instanceof Error?R.message:t("walletLock.error")),f([]),j.current=setTimeout(()=>{g(!1),p(null)},1500)}finally{v(!1)}}},[s,T,t]),w=c.useCallback(async()=>{const D=y.current;if(D){v(!0),T();try{await D()?s():(g(!0),j.current=setTimeout(()=>{g(!1)},1500))}catch{g(!0),j.current=setTimeout(()=>{g(!1)},1500)}finally{v(!1)}}},[s,T]),E=()=>{s()};return e.jsx(pe,{"data-testid":"wallet-lock-dialog",onCancel:E,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),I?e.jsx(Rt,{title:C,description:a,appName:o,appIcon:d,chainId:_?void 0:m,walletInfo:_?{name:i,address:l,chainId:m}:void 0}):e.jsxs("div",{className:"px-4 pb-4 text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:C}),a&&e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:a})]}),e.jsx("div",{className:"px-4 pb-4",children:e.jsx(mt,{value:u,onChange:k,onComplete:A,minPoints:4,error:h,errorText:b??void 0,disabled:x,"data-testid":"wallet-lock-pattern"})}),e.jsxs("div",{className:"space-y-3 px-4 pb-4",children:[P&&e.jsxs("button",{type:"button",onClick:w,disabled:x,className:L("flex w-full items-center justify-center gap-2 rounded-full border border-border py-3 font-medium transition-colors","hover:bg-muted","disabled:cursor-not-allowed disabled:opacity-50"),children:[e.jsx(Np,{className:"size-5"}),e.jsx("span",{children:t("walletLock.biometric")})]}),e.jsx("button",{type:"button",onClick:E,disabled:x,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("walletLock.cancel")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Rl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Ev,{})});Rl.__docgenInfo={description:"",methods:[],displayName:"WalletLockConfirmJob"};let _v=null;function Mv(){const{t}=O(["security","transaction","common"]),{pop:s}=Z(),{title:n,description:a}=he(),[r,o]=c.useState(""),[d,i]=c.useState(),[l,m]=c.useState(!1),u=c.useRef(null);c.useRef(!1).current;const h=n??t("security:twoStepSecret.confirmTitle"),g=a??t("security:twoStepSecret.confirmDesc"),b=c.useCallback(async v=>{v.preventDefault();const j=u.current;if(!(!r.trim()||!j)){m(!0),i(void 0);try{await j(r)?s():i(t("security:twoStepSecret.notMatch"))}catch{i(t("security:twoStepSecret.notMatch"))}finally{m(!1)}}},[r,s,t]),p=r.trim().length>0&&!l,x=()=>{s()};return e.jsx(pe,{"data-testid":"two-step-secret-dialog",onCancel:x,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(en,{className:"size-5 text-primary"}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:h})]})}),e.jsxs("form",{onSubmit:b,className:"space-y-6 p-4",children:[e.jsx("p",{className:"text-center text-muted-foreground text-sm",children:g}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ys,{value:r,onChange:v=>o(v.target.value),placeholder:t("security:twoStepSecret.inputPlaceholder"),disabled:l,"aria-describedby":d?"two-step-secret-error":void 0,"data-testid":"two-step-secret-input"}),d&&e.jsxs("div",{id:"two-step-secret-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(_t,{className:"size-4"}),e.jsx("span",{children:d})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{type:"submit",disabled:!p,"data-testid":"two-step-secret-confirm-button",className:L("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(l?"security:walletLock.verifying":"common:confirm")}),e.jsx("button",{type:"button",onClick:x,disabled:l,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("security:walletLock.cancel")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Ll=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Mv,{})});Ll.__docgenInfo={description:"",methods:[],displayName:"TwoStepSecretConfirmJob"};let Rs=null,On=null;function Dl(t,s){Rs=t,On=s}function Zi(){Rs=null,On=null}function Rv(){const{t}=O(["transaction","common"]),{pop:s}=Z();he();const n=c.useRef(Rs),a=c.useRef(On),r=c.useRef(!1);!r.current&&Rs&&(n.current=Rs,a.current=On,Zi(),r.current=!0);const o=n.current,[d,i]=c.useState(o?.currentFee??""),[l,m]=c.useState();c.useEffect(()=>()=>{Zi()},[]);const u=c.useCallback(v=>{if(!o)return;const j=parseFloat(v),N=parseFloat(o.minFee);if(isNaN(j)||j<=0)return t("transaction:feeEdit.invalidFee");if(j<N)return t("transaction:feeEdit.belowMinFee",{minFee:o.minFee,symbol:o.symbol})},[o,t]),f=c.useCallback(v=>{const j=v.target.value;(j===""||/^\d*\.?\d*$/.test(j))&&(i(j),m(void 0))},[]),h=c.useCallback(v=>{i(v),m(void 0)},[]),g=c.useCallback(v=>{v.preventDefault();const j=u(d);if(j){m(j);return}a.current?.({fee:d}),s()},[d,u,s]),b=c.useCallback(()=>{s()},[s]);if(!o)return null;const p=[{label:t("transaction:feeEdit.presetMin"),value:o.minFee}],x=o.presets??p;return e.jsx(Tl,{children:e.jsxs("div",{className:"bg-background rounded-2xl p-4","data-testid":"fee-edit-modal",children:[e.jsx("h2",{className:"mb-4 text-center text-lg font-semibold",children:t("transaction:feeEdit.title")}),e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 text-sm text-muted-foreground",children:[e.jsxs("p",{children:[t("transaction:feeEdit.currentFee"),": ",o.currentFee," ",o.symbol]}),e.jsxs("p",{children:[t("transaction:feeEdit.minFee"),": ",o.minFee," ",o.symbol]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:x.map(v=>e.jsx("button",{type:"button",onClick:()=>h(v.value),className:L("rounded-full px-3 py-1 text-sm transition-colors",d===v.value?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:v.label},v.value))}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("transaction:feeEdit.customFee")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{type:"text",inputMode:"decimal",value:d,onChange:f,placeholder:o.minFee,className:L(l&&"border-destructive"),"data-testid":"fee-input"}),e.jsx("span",{className:"shrink-0 text-sm text-muted-foreground",children:o.symbol})]}),l&&e.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(_t,{className:"size-4"}),e.jsx("span",{children:l})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(J,{type:"button",variant:"outline",onClick:b,className:"flex-1",children:t("common:cancel")}),e.jsx(J,{type:"submit",className:"flex-1",disabled:!d,children:t("common:confirm")})]})]})]})})}const zl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Rv,{})});zl.__docgenInfo={description:"",methods:[],displayName:"FeeEditJob"};let Ls=null,Bn=null,Fn=null,Wn="";function Lv(t,s,n){Ls=t,Bn=n??null,s&&(Fn=s.amount,Wn=s.symbol)}function Dv(){Ls=null,Bn=null,Fn=null,Wn=""}function zv(){const{t}=O(["security","transaction","common"]),{pop:s,push:n}=Z(),{chainId:a,chainIcon:r,chainSymbol:o,address:d,chainName:i}=he(),[l,m]=c.useState(""),[u,f]=c.useState(""),[h,g]=c.useState([]),[b,p]=c.useState(!1),[x,v]=c.useState("input"),[j,N]=c.useState(),[y,S]=c.useState(!1),[C,P]=c.useState("idle"),[_,I]=c.useState(),[T,k]=c.useState(null),A=c.useRef(Ls),w=c.useRef(Bn),E=c.useRef({amount:Fn,symbol:Wn}),D=T??E.current.amount?.toDisplayString()??"0";c.useEffect(()=>(Ls&&!A.current&&(A.current=Ls,w.current=Bn,E.current={amount:Fn,symbol:Wn}),()=>{Dv()}),[]);const z=c.useCallback(()=>{const B=E.current.amount?.toDisplayString()??"0";Dl({currentFee:D,minFee:B,symbol:E.current.symbol},G=>{k(G.fee)}),n("FeeEditJob",{})},[D,n]),R=c.useCallback(()=>{if(N(void 0),x==="input"){if(!l.trim())return;v("confirm")}else if(x==="confirm"){if(l!==u){N(t("security:twoStepSecret.notMatch"));return}v("walletLock")}},[x,l,u,t]),V=c.useCallback(()=>{x==="input"?s():x==="confirm"?(v("input"),N(void 0)):(v("confirm"),N(void 0),p(!1),g([]))},[x,s]),M=c.useCallback(async B=>{const G=A.current;if(B.length<4||!G)return;S(!0),P("broadcasting"),N(void 0),p(!1);const ee=Be(B);try{const W=await G(l,ee);W.success?(I(W.txHash),P("broadcasted")):(P("idle"),p(!0),g([]),N(W.error??t("security:twoStepSecret.setFailed")))}catch{P("idle"),p(!0),g([]),N(t("security:twoStepSecret.setFailed"))}finally{S(!1)}},[l,t]);return C!=="idle"?e.jsx(pe,{onCancel:V,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx(Wo,{status:C,txHash:_,title:{confirmed:t("security:twoStepSecret.txConfirmed")},description:{confirmed:t("security:twoStepSecret.setSuccessDesc")},checkConfirmed:w.current??void 0,onStatusChange:P,onDone:()=>s()}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}):e.jsx(pe,{onCancel:V,children:e.jsxs("div",{className:"bg-background rounded-t-2xl","data-testid":"set-two-step-secret-dialog",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsxs("div",{className:"border-b border-border px-4 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(en,{className:"size-5 text-primary"}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("security:twoStepSecret.setTitle")})]}),a&&d?e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(Xa,{chainId:a,chainIcon:r,chainSymbol:o,address:d,size:"sm"})}):i?e.jsx("p",{className:"mt-1 text-center text-sm text-muted-foreground",children:i}):null]}),e.jsxs("div",{className:"space-y-6 p-4",children:[E.current.amount&&e.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-muted/50 p-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:t("security:twoStepSecret.feeInfo")}),e.jsx(sr,{amount:D,symbol:E.current.symbol,editable:!0,onEdit:z})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:L("size-2 rounded-full",x==="input"?"bg-primary":"bg-muted")}),e.jsx("div",{className:L("size-2 rounded-full",x==="confirm"?"bg-primary":"bg-muted")}),e.jsx("div",{className:L("size-2 rounded-full",x==="walletLock"?"bg-primary":"bg-muted")})]}),x==="input"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:t("security:twoStepSecret.inputDesc")}),e.jsx(ys,{value:l,onChange:B=>m(B.target.value),placeholder:t("security:twoStepSecret.inputPlaceholder"),"aria-describedby":j?"two-step-secret-error":void 0,"data-testid":"new-two-step-secret-input"})]}),x==="confirm"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:t("security:twoStepSecret.confirmDesc")}),e.jsx(ys,{value:u,onChange:B=>f(B.target.value),placeholder:t("security:twoStepSecret.confirmPlaceholder"),"aria-describedby":j?"two-step-secret-error":void 0,"data-testid":"confirm-two-step-secret-input"})]}),x==="walletLock"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:t("security:twoStepSecret.walletLockDesc")}),e.jsx(mt,{value:h,onChange:g,onComplete:M,minPoints:4,error:b,disabled:y,"data-testid":"wallet-lock-pattern"})]}),j&&e.jsxs("div",{id:"two-step-secret-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(_t,{className:"size-4"}),e.jsx("span",{children:j})]}),e.jsxs("div",{className:"space-y-3",children:[x!=="walletLock"&&e.jsx("button",{type:"button",onClick:R,"data-testid":"set-two-step-secret-next-button",className:L("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90"),children:t("common:next")}),e.jsx("button",{type:"button",onClick:V,disabled:y,"data-testid":"set-two-step-secret-cancel-button",className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t(x==="input"?"common:cancel":"common:back")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Ol=({params:t})=>e.jsx(me,{params:t,children:e.jsx(zv,{})});Ol.__docgenInfo={description:"",methods:[],displayName:"SetTwoStepSecretJob"};let za=null;function Ov(){za=null}const Bv=[{value:"english",label:"English"},{value:"zh-Hans",label:""},{value:"zh-Hant",label:""}],Fv=[12,15,18,21,24,36];function Wv(){const{t}=O("onboarding"),{pop:s}=Z(),{language:n,length:a}=he(),[r,o]=c.useState({language:n||"english",length:Number(a)||12}),d=u=>{o(f=>({...f,language:u}))},i=u=>{o(f=>({...f,length:u}))},l=()=>{za&&za(r),Ov(),s()},m=()=>{s()};return e.jsx(pe,{onCancel:m,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx("div",{className:"border-border border-b px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("create.mnemonicOptions.title")})}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:t("create.mnemonicOptions.language")}),e.jsx("div",{className:"space-y-1",role:"radiogroup",children:Bv.map(u=>e.jsxs("button",{type:"button",role:"radio","aria-checked":r.language===u.value,onClick:()=>d(u.value),className:L("flex w-full items-center justify-between rounded-lg px-4 py-3","hover:bg-muted/50 transition-colors",r.language===u.value&&"bg-muted"),children:[e.jsx("span",{className:"text-sm",children:u.label}),r.language===u.value&&e.jsx(je,{className:"text-primary size-5"})]},u.value))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:t("create.mnemonicOptions.wordCount")}),e.jsx("div",{className:"grid grid-cols-3 gap-2",role:"radiogroup",children:Fv.map(u=>e.jsxs("button",{type:"button",role:"radio","aria-checked":r.length===u,onClick:()=>i(u),className:L("flex items-center justify-center rounded-lg py-3 text-sm font-medium","transition-colors",r.length===u?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:[u," ",t("create.mnemonicOptions.words")]},u))})]}),e.jsx("button",{type:"button",onClick:l,className:L("text-primary-foreground w-full rounded-full py-3 font-medium transition-colors","bg-primary hover:bg-primary/90"),children:t("create.mnemonicOptions.confirm")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Bl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Wv,{})});Bl.__docgenInfo={description:"",methods:[],displayName:"MnemonicOptionsJob"};const ga=3,$v=10;function qv(){const{t}=O("common"),{pop:s}=Z(),{contactId:n}=he(),a=Ae(zs,k=>k.contacts),r=n?a.find(k=>k.id===n):null,[o,d]=c.useState(""),[i,l]=c.useState([{id:crypto.randomUUID(),label:"",address:""}]),[m,u]=c.useState(""),[f,h]=c.useState(()=>Math.floor(Math.random()*1e4)),[g,b]=c.useState(!1),p=!!r;c.useEffect(()=>{r&&(d(r.name),l(r.addresses.length>0?r.addresses.map(k=>({id:k.id,label:k.label||"",address:k.address})):[{id:crypto.randomUUID(),label:"",address:""}]),u(r.memo??""),b(!1))},[r]);const x=c.useCallback(()=>{h(Math.floor(Math.random()*1e4)),b(!0)},[]),v=i.find(k=>k.address.trim())?.address.trim(),j=!p||g?v?Jt(v,f):void 0:r?.avatar||(v?Jt(v,f):void 0),N=c.useCallback(()=>{i.length>=ga||l(k=>[...k,{id:crypto.randomUUID(),label:"",address:""}])},[i.length]),y=c.useCallback(k=>{l(A=>A.length<=1?A:A.filter(w=>w.id!==k))},[]),S=c.useCallback((k,A,w)=>{l(E=>E.map(D=>D.id===k?{...D,[A]:w}:D))},[]),C=c.useCallback(()=>{const k=o.trim(),A=m.trim(),w=i.filter(D=>D.address.trim()).map((D,z)=>({id:D.id,address:D.address.trim(),label:D.label.trim()||void 0,isDefault:z===0}));if(!k||w.length===0)return;const E=!p||g?w[0]?Jt(w[0].address,f):void 0:r?.avatar;p&&r?Os.updateContact(r.id,{name:k,avatar:E,addresses:w,memo:A||void 0}):Os.addContact({name:k,addresses:w,avatar:E,memo:A||void 0}),s()},[o,i,m,f,p,r,s]),P=i.some(k=>k.address.trim()),_=o.trim().length>0&&P,I=i.length<ga,T=()=>{s()};return e.jsx(pe,{onCancel:T,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t(p?"contact.editTitle":"contact.addTitle")})}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:x,disabled:!v,className:"group relative shrink-0",title:t("addressBook.changeAvatar"),children:[e.jsx(js,{src:j,size:56}),v&&e.jsx("div",{className:"bg-background/80 absolute inset-0 flex items-center justify-center rounded-full opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx(ns,{className:"text-primary size-5"})})]}),e.jsx("input",{id:"contact-name",type:"text",value:o,onChange:k=>d(k.target.value),placeholder:t("contact.namePlaceholder"),maxLength:20,className:L("flex-1 rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:t("contact.addresses")}),e.jsx("span",{className:"text-muted-foreground text-xs",children:t("contact.addressCount",{count:i.length,max:ga})})]}),i.map((k,A)=>e.jsxs("div",{className:"space-y-2 rounded-xl border border-border p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:k.label,onChange:w=>S(k.id,"label",w.target.value),placeholder:t("contact.addressLabelPlaceholder"),maxLength:$v,className:L("w-24 shrink-0 rounded-lg border border-border bg-muted/50 px-3 py-2 text-sm","focus:outline-none focus:ring-2 focus:ring-primary")}),i.length>1&&e.jsx("button",{type:"button",onClick:()=>y(k.id),className:"text-muted-foreground hover:text-destructive shrink-0 p-1",children:e.jsx(ss,{className:"size-4"})}),A===0&&e.jsx("span",{className:"bg-primary/10 text-primary rounded px-1.5 py-0.5 text-xs",children:t("contact.defaultLabel")})]}),e.jsx("input",{type:"text",value:k.address,onChange:w=>S(k.id,"address",w.target.value),placeholder:t("contact.addressPlaceholder"),className:L("w-full rounded-lg border border-border bg-background px-3 py-2 font-mono text-sm","focus:outline-none focus:ring-2 focus:ring-primary")})]},k.id)),I&&e.jsxs("button",{type:"button",onClick:N,className:"flex w-full items-center justify-center gap-2 rounded-xl border border-dashed border-border py-3 text-sm text-muted-foreground hover:border-primary hover:text-primary",children:[e.jsx(ut,{className:"size-4"}),t("contact.addAddress")]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"contact-memo",className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(Lo,{className:"size-4"}),t("contact.memoOptional")]}),e.jsx("textarea",{id:"contact-memo",value:m,onChange:k=>u(k.target.value),placeholder:t("contact.memoPlaceholder"),maxLength:100,rows:2,className:L("w-full resize-none rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")})]}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsx("button",{onClick:C,disabled:!_,className:L("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(p?"contact.save":"contact.add")}),e.jsx("button",{onClick:T,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("contact.cancel")})]})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Fl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(qv,{})});Fl.__docgenInfo={description:"",methods:[],displayName:"ContactEditJob"};function Hv(t,s=8,n=6){return t.length<=s+n+3?t:`${t.slice(0,s)}...${t.slice(-n)}`}function Uv(){const{t}=O("common"),{pop:s}=Z(),{chainType:n}=he(),a=n,[r,o]=c.useState(""),d=Ae(zs),i=c.useMemo(()=>{let u=d.contacts;return r&&(u=Ka.searchContacts(d,r)),u=[...u].toSorted((f,h)=>h.updatedAt-f.updatedAt),u.map(f=>{const h=f.addresses.map(b=>({...b,isValidForCurrentChain:a?xf(b.address,a):!0})),g=h.some(b=>b.isValidForCurrentChain);return{contact:f,addresses:h,hasValidAddress:g}})},[d,r,a]),l=(u,f)=>{const h=new CustomEvent("contact-picker-select",{detail:{contact:u,address:f}});window.dispatchEvent(h),s()},m=()=>{s()};return e.jsx(pe,{onCancel:m,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx("div",{className:"border-border border-b px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("contact.selectAddress")})}),e.jsx("div",{className:"border-border border-b p-4",children:e.jsxs("div",{className:"bg-muted/50 flex items-center gap-2 rounded-xl px-3 py-2",children:[e.jsx(tn,{className:"text-muted-foreground size-4"}),e.jsx("input",{type:"text",value:r,onChange:u=>o(u.target.value),placeholder:t("addressBook.searchPlaceholder"),className:"placeholder:text-muted-foreground min-w-0 flex-1 bg-transparent text-sm outline-none"})]})}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto",children:i.length===0?e.jsx("div",{className:"text-muted-foreground py-12 text-center text-sm",children:t(r?"addressBook.noResults":"contact.noContacts")}):e.jsx("div",{className:"divide-border divide-y",children:i.map(({contact:u,addresses:f,hasValidAddress:h})=>e.jsxs("div",{className:L(!h&&"opacity-50"),children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 pt-3 pb-2",children:[e.jsx(js,{src:u.avatar||(f[0]?.address?Jt(f[0].address):void 0),size:40,className:"shrink-0"}),e.jsx("p",{className:"min-w-0 flex-1 truncate font-medium",children:u.name})]}),e.jsx("div",{className:"space-y-1 pb-3 pl-[56px] pr-4",children:f.map(g=>{const b=!g.isValidForCurrentChain,p=g.label;return e.jsxs("button",{onClick:()=>!b&&l(u,g),disabled:b,className:L("flex min-h-[44px] w-full items-center gap-3 rounded-xl px-3 py-2.5 transition-colors",b?"cursor-not-allowed opacity-50":"hover:bg-muted/50 active:bg-muted"),children:[e.jsx("p",{className:L("min-w-0 flex-1 truncate text-left font-mono text-sm",b?"text-muted-foreground/50":"text-foreground"),children:Hv(g.address)}),e.jsxs("div",{className:"flex shrink-0 items-center gap-2",children:[p&&e.jsx("span",{className:L("max-w-[5rem] truncate rounded-md bg-muted px-2 py-0.5 text-xs",b?"text-muted-foreground/50":"text-muted-foreground"),children:p}),g.isDefault&&e.jsx("span",{className:"bg-primary/10 text-primary rounded-md px-2 py-0.5 text-xs",children:t("contact.defaultLabel")})]})]},g.id)})})]},u.id))})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Wl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Uv,{})});Wl.__docgenInfo={description:"",methods:[],displayName:"ContactPickerJob"};const $l=()=>{const{t}=O(["wallet","home"]),{pop:s}=Z(),{navigate:n}=de(),a=()=>{s(),n({to:"/wallet/create"})},r=()=>{s(),n({to:"/onboarding/recover"})},o=()=>{s()};return e.jsx(pe,{onCancel:o,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("wallet:add")})}),e.jsxs("div",{className:"space-y-3 p-4",children:[e.jsxs("button",{onClick:a,className:L("flex w-full items-center gap-4 rounded-xl p-4 transition-colors","bg-muted/50 hover:bg-muted active:bg-muted/80"),children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10",children:e.jsx(ut,{className:"size-6 text-primary"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-semibold",children:t("home:welcome.createWallet")}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t("wallet:createDesc")})]})]}),e.jsxs("button",{onClick:r,className:L("flex w-full items-center gap-4 rounded-xl p-4 transition-colors","bg-muted/50 hover:bg-muted active:bg-muted/80"),children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10",children:e.jsx(sn,{className:"size-6 text-primary"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-semibold",children:t("home:welcome.importWallet")}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t("wallet:importDesc")})]})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};$l.__docgenInfo={description:"",methods:[],displayName:"WalletAddJob"};const ql=()=>{const{t}=O(["wallet","common"]),{pop:s,push:n}=Z(),a=Mt(),o=Fe()?.id,{getWalletTheme:d}=So(),i=Ao(),l=f=>{ye.setCurrentWallet(f),s()},m=()=>{s(),n("WalletAddJob",{})},u=()=>{s()};return e.jsx(pe,{onCancel:u,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("common:a11y.tabWallet")})}),e.jsx("div",{className:"max-h-[50vh] space-y-2 overflow-y-auto p-4",children:a.map(f=>{const h=f.id===o,g=f.chainAddresses[0]?.address,b=g?`${g.slice(0,6)}...${g.slice(-4)}`:"---",p=d(f.id);return e.jsxs("button",{onClick:()=>l(f.id),className:L("flex w-full items-center gap-3 rounded-xl p-4 transition-all","active:scale-[0.98]",h?"bg-primary/10 ring-2 ring-primary":"bg-muted/50 hover:bg-muted"),children:[e.jsx(vf,{themeHue:p,size:"md",watermarkIconUrl:i[f.chain]}),e.jsxs("div",{className:"min-w-0 flex-1 text-left",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate font-medium",children:f.name}),h&&e.jsx(bf,{className:"size-4 shrink-0 text-primary"})]}),e.jsx("p",{className:"truncate font-mono text-xs text-muted-foreground",children:b})]})]},f.id)})}),e.jsx("div",{className:"border-t border-border p-4",children:e.jsxs("button",{onClick:m,className:L("flex w-full items-center justify-center gap-2 rounded-xl p-4","bg-muted/50 hover:bg-muted active:bg-muted/80 transition-colors"),children:[e.jsx(ut,{className:"size-5"}),e.jsx("span",{className:"font-medium",children:t("wallet:add")})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};ql.__docgenInfo={description:"",methods:[],displayName:"WalletListJob"};let Oa=null;function Vv(t){Oa=t}const Hl=()=>{const{t}=O(["onboarding","common"]),{pop:s}=Z(),[n,a]=c.useState(!1),r=()=>{s()},o=()=>{n&&(s(),Oa?.(),Oa=null)};return e.jsx(Tl,{children:e.jsxs("div",{className:"bg-background mx-4 max-w-sm rounded-2xl p-5",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"rounded-full bg-amber-500/15 p-2",children:e.jsx(Oe,{className:"size-5 text-amber-600","aria-hidden":"true"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h2",{className:"text-base font-semibold",children:t("onboarding:securityWarning.title")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:t("onboarding:securityWarning.message")})]})]}),e.jsxs("label",{className:"mt-4 flex cursor-pointer items-center gap-2 text-sm",children:[e.jsx($o,{checked:n,onCheckedChange:a}),e.jsx("span",{children:t("onboarding:securityWarning.acknowledge")})]}),e.jsxs("div",{className:"mt-5 flex gap-2",children:[e.jsx(J,{type:"button",variant:"outline",className:"flex-1",onClick:r,children:t("common:cancel")}),e.jsx(J,{type:"button",className:"flex-1",onClick:o,disabled:!n,children:t("common:confirm")})]})]})})};Hl.__docgenInfo={description:"",methods:[],displayName:"SecurityWarningJob"};let Ds=null;function Ul(t,s){Ds={onConfirm:t,minFee:s?.minFee,onFeeChange:s?.onFeeChange}}function eo(){Ds=null}function Jv(t){return t.length<=16?t:`${t.slice(0,10)}...${t.slice(-6)}`}function Kv(){const{t}=O("transaction"),{pop:s,push:n}=Z(),a=he(),[r,o]=c.useState(!1),[d,i]=c.useState(!1),[l,m]=c.useState(!1),[u,f]=c.useState(null),h=c.useRef(Ds),g=c.useRef(!1);!g.current&&Ds&&(h.current=Ds,eo(),g.current=!0),c.useEffect(()=>()=>{eo()},[]);const b=a.feeLoading==="true",p=a.feeFiatValue?parseFloat(a.feeFiatValue):void 0,x=u??a.feeAmount,v=!!h.current?.onFeeChange,j=c.useCallback(async()=>{try{await Za.write({text:a.toAddress}),i(!0),setTimeout(()=>i(!1),2e3)}catch{}},[a.toAddress]),N=c.useCallback(()=>{o(P=>!P)},[]),y=c.useCallback(()=>{const P=h.current;P?.onFeeChange&&(Dl({currentFee:x,minFee:P.minFee??a.feeAmount,symbol:a.feeSymbol},_=>{f(_.fee),P.onFeeChange?.(_.fee)}),n("FeeEditJob",{}))},[x,a.feeAmount,a.feeSymbol,n]),S=c.useCallback(async()=>{const P=h.current;if(!(!P?.onConfirm||l)){m(!0);try{s(),await P.onConfirm()}finally{m(!1)}}},[l,s]),C=c.useCallback(()=>{s()},[s]);return e.jsx(pe,{"data-testid":"transfer-confirm-sheet",onCancel:C,children:e.jsx(Dn,{title:t("confirmSheet.title"),children:e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-3xl font-bold",children:[a.amount," ",a.symbol]}),a.fiatValue&&e.jsxs("p",{className:"text-muted-foreground mt-1",children:[" $",a.fiatValue]})]}),e.jsxs("div",{className:"bg-muted/30 space-y-4 rounded-xl p-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:t("confirmSheet.toAddress")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:N,className:"hover:text-primary flex min-w-0 flex-1 items-center gap-1 text-left font-mono text-sm",children:[e.jsx("span",{className:L("min-w-0",r?"break-all":"truncate"),children:r?a.toAddress:Jv(a.toAddress)}),r?e.jsx(qo,{className:"size-4 shrink-0"}):e.jsx(Uo,{className:"size-4 shrink-0"})]}),e.jsx("button",{type:"button",onClick:j,className:"text-muted-foreground hover:text-foreground shrink-0 p-1","aria-label":t(d?"confirmSheet.copied":"confirmSheet.copyAddress"),children:d?e.jsx(je,{className:"size-4 text-green-500"}):e.jsx(Eo,{className:"size-4"})})]})]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:t("confirmSheet.networkFee")}),e.jsx(sr,{amount:x,symbol:a.feeSymbol,...p!==void 0&&{fiatValue:p},isLoading:b,editable:v,onEdit:y})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button","data-testid":"cancel-transfer-button",onClick:C,className:"border-border hover:bg-muted flex-1 rounded-full border py-3 font-medium transition-colors",disabled:l,children:t("confirmSheet.cancel")}),e.jsx("button",{type:"button","data-testid":"confirm-transfer-button",onClick:S,disabled:l||b,className:L("flex-1 rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(l?"confirmSheet.confirming":"confirmSheet.confirm")})]})]})})})}const Vl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Kv,{})});Vl.__docgenInfo={description:"",methods:[],displayName:"TransferConfirmJob"};let $n=null;function Jl(t){$n=t}function Gv(){$n=null}function Qv(){const{t}=O(["security","transaction","common"]),{pop:s,push:n}=Z(),{title:a}=he(),r=fr(),o=st(),d=Je(),i=dt(),l=Fe(),[m,u]=c.useState("wallet_lock"),[f,h]=c.useState([]),[g,b]=c.useState(""),[p,x]=c.useState("idle"),[v,j]=c.useState(),[N,y]=c.useState(),[S,C]=c.useState(!1),[P,_]=c.useState(!1),[I,T]=c.useState(),[k,A]=c.useState(null),w=c.useRef(null),E=c.useRef(""),D=c.useRef(!1);!D.current&&$n&&(w.current=$n,Gv(),D.current=!0),c.useEffect(()=>{if(!v||!d||!l?.address)return;const ne=Pe(d);return ne?.transaction?ne.transaction.subscribe({txHash:v,senderId:l.address},H=>{H&&(H.status==="confirmed"?x("confirmed"):H.status==="failed"?x("failed"):H.status==="pending"&&x("broadcasted"))}):void 0},[v,d,l?.address]),c.useEffect(()=>{if(p!=="confirmed"){A(null);return}A(5);const ne=setInterval(()=>{A(q=>q===null||q<=1?(clearInterval(ne),s(),null):q-1)},1e3);return()=>clearInterval(ne)},[p,s]);const z=c.useMemo(()=>He.getChainById(i,d),[i,d]),R=c.useMemo(()=>{const ne=z?.explorer?.queryTx;return!ne||!v?null:ne.replace(":hash",v).replace(":signature",v)},[z?.explorer?.queryTx,v]),V=c.useCallback(()=>{R&&window.open(R,"_blank","noopener,noreferrer")},[R]),M=m==="wallet_lock"?a??t("security:walletLock.verifyTitle"):t("transaction:sendPage.twoStepSecretTitle"),B=c.useCallback(async ne=>{const q=w.current;if(ne.length<4||!q)return;_(!0),y(void 0),C(!1),x("broadcasting");const H=Be(ne);E.current=H;try{const Q=await q(H);if(Q.status==="ok"){Q.txHash&&j(Q.txHash),Q.pendingTxId&&T(Q.pendingTxId),x("broadcasted");return}if(Q.status==="wallet_lock_invalid"){C(!0),h([]),x("idle");return}if(Q.status==="two_step_secret_required"){u("two_step_secret"),y(void 0),x("idle");return}if(Q.status==="error"){y(Q.message??t("transaction:broadcast.unknown")),x("failed"),Q.pendingTxId&&T(Q.pendingTxId);return}}catch{y(t("transaction:broadcast.unknown")),x("failed")}finally{_(!1)}},[t]),G=c.useCallback(async()=>{const ne=w.current;if(!(!g.trim()||!ne)){_(!0),y(void 0);try{const q=await ne(E.current,g);if(q.status==="ok"){q.txHash&&j(q.txHash),q.pendingTxId&&T(q.pendingTxId),x("broadcasted");return}(q.status==="two_step_secret_invalid"||q.status==="error")&&(y(q.message??t("transaction:sendPage.twoStepSecretError")),q.pendingTxId&&(T(q.pendingTxId),x("failed")))}catch{y(t("transaction:sendPage.twoStepSecretError"))}finally{_(!1)}}},[g,t]),ee=c.useCallback(ne=>{ne.preventDefault(),m==="two_step_secret"&&G()},[m,G]),W=g.trim().length>0&&!P,F=c.useCallback(async()=>{if(I){_(!0),y(void 0);try{await mm.retryBroadcast(I,i),x("broadcasted")}catch(ne){y(ne instanceof Error?ne.message:t("transaction:broadcast.unknown"))}finally{_(!1)}}},[I,i,t]),ie=c.useCallback(()=>{s()},[s]);if(p!=="idle"){const ne=p==="failed",q=p==="confirmed";return e.jsx(pe,{onCancel:ie,children:e.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx(Wo,{status:p,txHash:v,title:{broadcasted:t("transaction:txStatus.broadcasted"),confirmed:t("transaction:sendResult.success"),failed:t("transaction:broadcast.failed")},description:{broadcasted:t("transaction:txStatus.broadcastedDesc"),confirmed:k!==null?t("transaction:txStatus.autoCloseIn",{seconds:k}):t("transaction:txStatus.confirmedDesc"),failed:N},onStatusChange:x,onDone:()=>s(),onViewDetails:()=>{s(),v&&n("TransactionDetailActivity",{txId:v})},onViewExplorer:R?V:void 0,onShare:async()=>{v&&(await r.write({text:v}),o.show(t("common:copied")))}}),e.jsxs("div",{className:"px-4 pb-4 space-y-2",children:[ne&&e.jsxs("button",{type:"button",onClick:F,disabled:P,className:L("w-full flex items-center justify-center gap-2 rounded-full py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:[e.jsx(ns,{className:"size-4"}),t(P?"common:retrying":"transaction:pendingTx.retry")]}),e.jsx("button",{type:"button",onClick:ie,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:q&&k!==null?t("transaction:txStatus.closeIn",{seconds:k}):t("common:close")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})})}return m==="wallet_lock"?e.jsx(pe,{onCancel:ie,children:e.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:e.jsx(Dn,{title:M,children:e.jsxs("div",{className:"p-4",children:[e.jsx(mt,{value:f,onChange:h,onComplete:B,minPoints:4,error:S,disabled:P,"data-testid":"transfer-wallet-lock-pattern"}),N&&e.jsxs("div",{className:"flex items-start justify-center gap-1.5 text-sm text-destructive mt-3",children:[e.jsx(_t,{className:"size-4 shrink-0 mt-0.5"}),e.jsx("pre",{className:"overflow-auto whitespace-break-spaces",children:N})]}),e.jsx("button",{type:"button",onClick:ie,disabled:P,className:"mt-4 w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("common:cancel")})]})})})}):e.jsx(pe,{onCancel:ie,children:e.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:e.jsx(Dn,{title:M,children:e.jsxs("form",{onSubmit:ee,className:"space-y-6 p-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-primary mb-2",children:[e.jsx(en,{className:"size-5"}),e.jsx("span",{className:"text-sm",children:t("transaction:sendPage.twoStepSecretDescription")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ys,{value:g,onChange:ne=>b(ne.target.value),placeholder:t("transaction:sendPage.twoStepSecretPlaceholder"),disabled:P,"aria-describedby":N?"two-step-error":void 0,"data-testid":"two-step-secret-input"}),g.length>0&&g.length<6&&e.jsx("div",{className:"absolute right-10 top-1/2 -translate-y-1/2",children:e.jsx("span",{className:"text-xs text-amber-500",children:t("security:twoStepSecret.lengthHint",{count:g.length})})})]}),N&&e.jsxs("div",{id:"two-step-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(_t,{className:"size-4"}),e.jsx("span",{children:N})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{type:"submit","data-testid":"two-step-confirm-button",disabled:!W,className:L("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(P?"common:verifying":"common:confirm")}),e.jsx("button",{type:"button",onClick:()=>s(),disabled:P,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("common:cancel")})]})]})})})})}const Kl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Qv,{})});Kl.__docgenInfo={description:"",methods:[],displayName:"TransferWalletLockJob"};const Yv=150;function Xv(){const{t}=O("scanner"),{pop:s}=Z(),n=fc(),{chainType:a,title:r,hint:o}=he(),d=c.useRef(null),i=c.useRef(null),l=c.useRef(null),m=c.useRef(null),u=c.useRef(!1),f=c.useRef(!1),h=c.useRef(!1),[g,b]=c.useState(!1),[p,x]=c.useState(!1),[v,j]=c.useState(null),[N,y]=c.useState(null),S=Nf(a),C=c.useCallback(w=>{if(w===N)return;y(w);const E=Vo(w),D=S(w,E);if(D===!0){j({type:"success",text:t("scanSuccess")}),"vibrate"in navigator&&navigator.vibrate(100),u.current=!1;const z=wf();setTimeout(()=>{s(),setTimeout(()=>{z?.({content:w,parsed:E})},100)},300)}else j({type:"error",text:t(D,{defaultValue:D})}),setTimeout(()=>{j(null),y(null)},3e3)},[N,S,t,s]),P=c.useCallback(()=>{if(u.current)return;u.current=!0,i.current||(i.current=document.createElement("canvas"));const w=async()=>{if(!(!u.current||!d.current||!m.current)){try{const E=await m.current.scanFromVideo(d.current,i.current??void 0);E&&C(E.content)}catch{}u.current&&setTimeout(w,Yv)}};w()},[C]),_=c.useCallback(()=>{u.current=!1,l.current&&(l.current.getTracks().forEach(w=>w.stop()),l.current=null),b(!1)},[]),I=c.useCallback(async()=>{if(!h.current){if(h.current=!0,!navigator.mediaDevices?.getUserMedia){j({type:"error",text:t("error")}),h.current=!1;return}try{try{if(!await n.checkPermission()&&!await n.requestPermission()){j({type:"error",text:t("permissionDenied")}),h.current=!1;return}}catch{}if(!f.current){h.current=!1;return}const w=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});if(!f.current){w.getTracks().forEach(E=>E.stop()),h.current=!1;return}if(l.current=w,d.current){d.current.srcObject=w;try{await d.current.play(),f.current&&(b(!0),P())}catch(E){if(!(E instanceof DOMException&&E.name==="AbortError"))throw E}}}catch(w){if(!f.current){h.current=!1;return}w instanceof DOMException?w.name==="NotAllowedError"?j({type:"error",text:t("permissionDenied")}):w.name==="NotFoundError"?j({type:"error",text:t("noCameraFound",{defaultValue:t("error")})}):w.name==="AbortError"||j({type:"error",text:t("error")}):j({type:"error",text:t("error")})}finally{h.current=!1}}},[n,P,t]);c.useEffect(()=>(f.current=!0,m.current=Jo({useWorker:!0}),I(),()=>{f.current=!1,_(),m.current?.destroy(),m.current=null}),[]);const T=c.useCallback(()=>{const w=document.createElement("input");w.type="file",w.accept="image/*",w.onchange=async E=>{const D=E.target.files?.[0];if(!(!D||!m.current))try{const z=new Image,R=URL.createObjectURL(D);z.onload=async()=>{URL.revokeObjectURL(R);const V=document.createElement("canvas");V.width=z.width,V.height=z.height;const M=V.getContext("2d");if(!M||!m.current){j({type:"error",text:t("noQrFound")});return}M.drawImage(z,0,0);const B=await m.current.scanFromCanvas(V);B?C(B.content):j({type:"error",text:t("noQrFound")})},z.onerror=()=>{URL.revokeObjectURL(R),j({type:"error",text:t("noQrFound")})},z.src=R}catch{j({type:"error",text:t("noQrFound")})}},w.click()},[C,t]),k=c.useCallback(async()=>{if(l.current){const w=l.current.getVideoTracks()[0];if(w)try{await w.applyConstraints({advanced:[{torch:!p}]}),x(!p)}catch{}}},[p]),A=c.useCallback(()=>{_(),s()},[_,s]);return e.jsx(pe,{onCancel:A,children:e.jsxs("div",{className:"flex h-[80vh] flex-col overflow-hidden rounded-t-2xl bg-black",children:[e.jsx("div",{className:"flex justify-center py-2",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-white/30"})}),e.jsxs("div",{className:"flex items-center justify-between px-4 pb-2",children:[e.jsx(J,{variant:"ghost",size:"icon",onClick:A,className:"text-white hover:bg-white/20","data-testid":"scanner-close-button",children:e.jsx(nn,{className:"size-6"})}),e.jsx("h2",{className:"text-lg font-medium text-white","data-testid":"scanner-title",children:r??t("title")}),e.jsx(J,{variant:"ghost",size:"icon",onClick:k,className:L("text-white hover:bg-white/20",p&&"text-yellow-400"),"data-testid":"scanner-flash-button",children:e.jsx(oc,{className:"size-6"})})]}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("video",{ref:d,className:L("absolute inset-0 size-full object-cover",!g&&"hidden"),playsInline:!0,muted:!0,"data-testid":"scanner-video"}),!g&&!v&&e.jsx("div",{className:"flex size-full items-center justify-center",children:e.jsx("p",{className:"text-white/60",children:t("initializing")})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"relative size-64","data-testid":"scanner-viewfinder",children:[e.jsx("div",{className:L("absolute top-0 left-0 size-8 border-t-4 border-l-4",v?.type==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:L("absolute top-0 right-0 size-8 border-t-4 border-r-4",v?.type==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:L("absolute bottom-0 left-0 size-8 border-b-4 border-l-4",v?.type==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:L("absolute right-0 bottom-0 size-8 border-r-4 border-b-4",v?.type==="success"?"border-green-500":"border-primary")}),g&&!v&&e.jsx("div",{className:"animate-scan bg-primary absolute right-2 left-2 h-0.5"})]})}),e.jsx("div",{className:"absolute inset-x-0 bottom-24 px-4 text-center",children:v?e.jsx("div",{className:L("inline-block rounded-lg px-4 py-2",v.type==="error"&&"bg-red-500/80 text-white",v.type==="success"&&"bg-green-500/80 text-white",v.type==="info"&&"bg-black/50 text-white"),"data-testid":"scanner-message",children:v.text}):g?e.jsx("p",{className:"text-white/80","data-testid":"scanner-hint",children:o??(a?t("scanPromptChain",{chain:a}):t("scanPrompt"))}):null})]}),e.jsx("div",{className:"flex justify-center gap-8 bg-black/50 py-6",children:e.jsxs(J,{variant:"ghost",size:"lg",onClick:T,className:"flex flex-col items-center text-white hover:bg-white/20","data-testid":"scanner-gallery-button",children:[e.jsx(ac,{className:"mb-1 size-6"}),e.jsx("span",{className:"text-xs",children:t("gallery")})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)] bg-black"})]})})}const Gl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Xv,{})});Gl.__docgenInfo={description:"",methods:[],displayName:"ScannerJob"};function Zv(){const{t}=O("common"),{pop:s}=Z(),n=he(),[a,r]=c.useState(n.name||""),[o,d]=c.useState(n.memo||""),[i,l]=c.useState(0),[m,u]=c.useState(!1),[f,h]=c.useState(!1),g=(()=>{try{return JSON.parse(n.addresses||"[]")}catch{return[]}})(),b=c.useCallback(()=>{l(v=>v+1)},[]),p=c.useCallback(async()=>{if(!(!a.trim()||g.length===0)){u(!0);try{const v=n.avatar||(g[0]?.address?Jt(g[0].address,i):void 0);Os.addContact({name:a.trim(),addresses:g.map((j,N)=>({id:`addr-${N}`,address:j.address,label:j.label,isDefault:N===0})),memo:o.trim()||void 0,avatar:v}),h(!0),setTimeout(()=>s(),500)}catch{}finally{u(!1)}}},[a,o,g,n.avatar,i,s]),x=c.useCallback(()=>{s()},[s]);return e.jsx(pe,{onCancel:x,children:e.jsxs("div",{className:"bg-background rounded-t-2xl pb-[env(safe-area-inset-bottom)]",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx("div",{className:"border-border border-b px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("addressBook.addContact")})}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:b,className:"group relative",title:t("addressBook.changeAvatar"),children:[e.jsx(js,{src:n.avatar||(g[0]?.address?Jt(g[0].address,i):void 0),size:48}),!n.avatar&&e.jsx("div",{className:"bg-background/80 absolute inset-0 flex items-center justify-center rounded-full opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx(ns,{className:"text-primary size-5"})})]}),e.jsx(Ve,{value:a,onChange:v=>r(v.target.value),placeholder:t("addressBook.namePlaceholder"),className:"flex-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm",children:t("addressBook.addresses")}),e.jsx("div",{className:"space-y-2",children:g.map((v,j)=>{const N=gf(v.address),y=v.label||N.chainType?.toUpperCase()||"";return e.jsxs("div",{className:"bg-muted/50 flex items-center gap-3 rounded-lg p-3",children:[e.jsx(ar,{className:"text-muted-foreground size-5 shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[y&&e.jsx("div",{className:"text-muted-foreground text-xs",children:y}),e.jsx("div",{className:"truncate font-mono text-sm",children:v.address})]})]},j)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm",children:t("addressBook.memo")}),e.jsx(Ve,{value:o,onChange:v=>d(v.target.value),placeholder:t("addressBook.memoPlaceholder")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx(J,{variant:"outline",onClick:x,disabled:m||f,className:"flex-1",children:t("cancel")}),e.jsx(J,{onClick:p,disabled:!a.trim()||g.length===0||m||f,className:L("flex-1",f&&"bg-green-500"),children:f?e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"mr-1 size-4"}),t("saved")]}):t(m?"saving":"save")})]})]})})}const Ql=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Zv,{})});Ql.__docgenInfo={description:"",methods:[],displayName:"ContactAddConfirmJob"};function ey(){const{t}=O("common"),{pop:s}=Z(),n=he(),a=c.useRef(null),[r,o]=c.useState(!1),d=c.useMemo(()=>{try{return JSON.parse(n.addresses||"[]")}catch{return[]}},[n.addresses]),i=c.useMemo(()=>nr({name:n.name,addresses:d,avatar:n.avatar}),[n.name,d,n.avatar]),l=c.useCallback(async()=>{const f=a.current;if(!(!f||r)){o(!0);try{const{snapdom:h}=await Pt(async()=>{const{snapdom:g}=await import("./snapdom-CO8q8LPW.js").then(b=>b.s);return{snapdom:g}},__vite__mapDeps([0,1]),import.meta.url);await h.download(f,{type:"png",filename:`contact-${n.name}.png`,scale:2,quality:1})}catch{}finally{o(!1)}}},[n.name,r]),m=c.useCallback(async()=>{const f=a.current;if(!(!f||!navigator.share)){o(!0);try{const{snapdom:h}=await Pt(async()=>{const{snapdom:x}=await import("./snapdom-CO8q8LPW.js").then(v=>v.s);return{snapdom:x}},__vite__mapDeps([0,1]),import.meta.url),b=await(await h(f,{scale:2})).toBlob(),p=new File([b],`contact-${n.name}.png`,{type:"image/png"});await navigator.share({title:t("addressBook.shareContact"),text:`${n.name} - ${d.map(x=>`${x.label||""}: ${x.address}`).join(", ")}`,files:[p]})}catch{}finally{o(!1)}}},[n.name,d,t,r]),u=()=>{s()};return e.jsx(pe,{onCancel:u,children:e.jsxs("div",{className:"bg-background rounded-t-2xl pb-[env(safe-area-inset-bottom)]",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"flex items-center justify-between border-b px-4 pb-4",children:[e.jsx(J,{variant:"ghost",size:"icon",onClick:u,children:e.jsx(nn,{className:"size-5"})}),e.jsx("h2",{className:"text-lg font-semibold",children:t("addressBook.shareContact")}),e.jsx("div",{className:"w-10"})]}),e.jsxs("div",{className:"flex flex-col items-center p-6",children:[e.jsx("div",{ref:a,children:e.jsx(rr,{name:n.name,avatar:n.avatar,addresses:d,qrContent:i})}),e.jsx("p",{className:"text-muted-foreground mt-4 text-center text-sm",children:t("addressBook.scanToAdd")})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsxs(J,{variant:"outline",onClick:l,disabled:r,className:"flex-1",children:[r?e.jsx(be,{className:"mr-2 size-4 animate-spin"}):e.jsx(sn,{className:"mr-2 size-4"}),t("download")]}),"share"in navigator&&e.jsxs(J,{onClick:m,disabled:r,className:"flex-1",children:[r?e.jsx(be,{className:"mr-2 size-4 animate-spin"}):e.jsx(Hs,{className:"mr-2 size-4"}),t("share")]})]})]})})}const Yl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(ey,{})});Yl.__docgenInfo={description:"",methods:[],displayName:"ContactShareJob"};function ty(){const{t}=O(["settings","common"]),{pop:s}=Z(),[n,a]=c.useState(!1),r=c.useCallback(()=>{a(!0);const d="./";window.location.href=`${d}clear.html`},[]),o=()=>{s()};return e.jsx(pe,{onCancel:o,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-destructive/10 flex size-16 items-center justify-center rounded-full",children:e.jsx(Oe,{className:"text-destructive size-8"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:t("settings:clearData.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("settings:clearData.warning")})]}),e.jsx("div",{className:"bg-destructive/5 rounded-lg p-4",children:e.jsxs("ul",{className:"text-destructive space-y-2 text-sm",children:[e.jsxs("li",{children:[" ",t("settings:clearData.item1")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item2")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item3")]})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(J,{variant:"outline",className:"flex-1",onClick:o,disabled:n,children:t("common:cancel")}),e.jsx(J,{variant:"destructive",className:"flex-1",onClick:r,disabled:n,children:t("settings:clearData.confirm")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Xl=()=>e.jsx(ty,{});Xl.__docgenInfo={description:"",methods:[],displayName:"ClearDataConfirmJob"};function sy(t){if(!t)return;if(t.startsWith("0x")){const n=Kn(t);if(n)return n}const s=Cf(t);return lt.getConfig(s),s}function ny(){const{t}=O("common"),{pop:s}=Z(),{chain:n,exclude:a,appName:r,appIcon:o}=he(),d=Ys(),i=c.useMemo(()=>sy(n),[n]),l=c.useMemo(()=>i?d.find(x=>x.id===i):null,[i,d]),m=i?lt.getName(i):void 0,u=Ae(Re),f=Qs.getCurrentWallet(u),h=c.useMemo(()=>{const x=a?.toLowerCase(),v=[];for(const j of u.wallets){const N=i?j.chainAddresses.find(y=>y.chain===i):j.chainAddresses[0];N&&(x&&N.address.toLowerCase()===x||v.push({id:j.id,name:j.name,address:N.address,themeHue:j.themeHue,chainIconUrl:l?.icon}))}return v},[u.wallets,i,a]),g=c.useMemo(()=>{const x=new Map;return u.wallets.forEach(v=>{const j=i?v.chainAddresses.find(N=>N.chain===i):v.chainAddresses[0];j&&x.set(v.id,{wallet:v,chainAddress:j})}),x},[u.wallets,i]),b=x=>{const v=g.get(x);if(!v)return;const j=new CustomEvent("wallet-picker-select",{detail:{address:v.chainAddress.address,chain:v.chainAddress.chain,name:v.wallet.name,publicKey:v.chainAddress.publicKey}});window.dispatchEvent(j),s()},p=x=>{x?.preventDefault?.();const v=new CustomEvent("wallet-picker-cancel");window.dispatchEvent(v),s()};return e.jsx(pe,{onCancel:p,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Rt,{title:i?t("selectChainWallet",{chain:m}):t("selectWallet"),description:`${r||t("unknownDApp")} ${t("requestsAccess")}`,appName:r,appIcon:o,chainId:i}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto p-4",children:h.length===0?e.jsx("div",{className:"text-muted-foreground py-12 text-center text-sm",children:i?t("noWalletsForChain",{chain:i}):t("noWallets")}):e.jsx(jf,{wallets:h,currentWalletId:f?.id,onSelect:b,showAddButton:!1})}),e.jsx("div",{className:"border-border border-t p-4",children:e.jsx("button",{onClick:p,className:"bg-muted hover:bg-muted/80 w-full rounded-xl py-3 font-medium transition-colors",children:t("cancel")})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Zl=({params:t})=>e.jsx(me,{params:t,children:e.jsx(ny,{})});Zl.__docgenInfo={description:"",methods:[],displayName:"WalletPickerJob"};const ay={"bfmeta-v2":"bfmetav2",bfmeta_v2:"bfmetav2"};function Ba(t){return t.trim().toLowerCase()}function to(t){return t.trim()}function so(t){return t.startsWith("0x")}function ry(t,s){return Ba(t)===Ba(s)}function iy(t,s){const n=to(t),a=to(s);return so(n)||so(a)?n.toLowerCase()===a.toLowerCase():n===a}function ln(t){const s=Ba(t);if(s.length===0)return s;const n=ka.state,a=He.getChainById(n,s);return a?a.id:ay[s]??s}function Mr(t,s){const n=ln(t);for(const a of Re.state.wallets){const r=a.chainAddresses.find(o=>ry(o.chain,n)&&iy(o.address,s));if(r)return{wallet:a,chainAddress:r}}return null}function ed(t,s){return Mr(t,s)?.wallet.id??null}function oy(){const{t}=O("common"),{pop:s,push:n}=Z(),{message:a,address:r,appName:o,appIcon:d,chainName:i}=he(),[l,m]=c.useState(!1),u=c.useMemo(()=>ln(i),[i]),f=c.useMemo(()=>Mr(u,r),[u,r]),h=f?.wallet,g=f?.chainAddress.chain,b=!!(h?.encryptedMnemonic&&g),p=h?.name||t("unknownWallet"),x=g??u,v=c.useCallback(()=>{l||!b||(ks(async y=>{m(!0);try{if(!h||!h.encryptedMnemonic||!g)throw new Error(t("signingAddressNotFound"));const S=`miniapp_sign_${Date.now()}`,P=await new pc(Us,S).handleMessageSign({chainName:g,senderAddress:r,message:a},h.encryptedMnemonic,y),_=new CustomEvent("signing-confirm",{detail:{confirmed:!0,signature:P.signature,publicKey:P.publicKey}});return window.dispatchEvent(_),s(),!0}catch(S){throw S instanceof Error?S:new Error(t("walletLock.error"))}finally{m(!1)}}),n("WalletLockConfirmJob",{title:t("signMessage"),description:o||t("unknownDApp"),miniappName:o,miniappIcon:d,walletName:p,walletAddress:r,walletChainId:x}))},[l,b,r,a,s,n,g,t,h,o,d,p,x]),j=c.useCallback(()=>{const y=new CustomEvent("signing-confirm",{detail:{confirmed:!1}});window.dispatchEvent(y),s()},[s]),N=a.startsWith("0x")&&/^0x[0-9a-fA-F]+$/.test(a);return e.jsx(pe,{onCancel:j,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Rt,{title:t("signMessage"),description:o||t("unknownDApp"),appName:o,appIcon:d,walletInfo:{name:p,address:r,chainId:x}}),e.jsxs("div",{className:"space-y-4 p-4",children:[!b&&e.jsx("div",{className:"rounded-xl bg-amber-50 p-3 text-sm text-amber-800 dark:bg-amber-950/30 dark:text-amber-200",children:t("signingAddressNotFound")}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsxs("p",{className:"text-muted-foreground mb-1 text-xs",children:[" ",t("message")]}),e.jsx("div",{className:"max-h-40 overflow-y-auto",children:e.jsx("pre",{className:"font-mono text-sm break-all whitespace-pre-wrap",children:a})})]}),N&&e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[e.jsx(Oe,{className:"size-5 shrink-0 text-amber-600"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:t("hexDataWarning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:j,disabled:l,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("cancel")}),e.jsx("button",{onClick:v,disabled:l||!b,className:L("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","flex items-center justify-center gap-2 disabled:opacity-50"),children:l?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"size-4 animate-spin"}),t("signing")]}):t("sign")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const td=({params:t})=>e.jsx(me,{params:t,children:e.jsx(oy,{})});td.__docgenInfo={description:"",methods:[],displayName:"SigningConfirmJob"};const cy={bio_requestAccounts:ar,bio_createTransaction:Lo,bio_signMessage:na,bio_signTypedData:na,bio_signTransaction:na,bio_sendTransaction:mp};function ly(){const{t}=O("permission"),{pop:s}=Z(),{appName:n,appIcon:a,permissions:r}=he(),o=(()=>{try{return JSON.parse(r)}catch{return[]}})(),d=()=>{const u=new CustomEvent("permission-request",{detail:{approved:!0,permissions:o}});window.dispatchEvent(u),s()},i=()=>{const u=new CustomEvent("permission-request",{detail:{approved:!1}});window.dispatchEvent(u),s()},l=u=>{const f=`${u}.label`;return String(t(f))},m=u=>{const f=`${u}.description`;return String(t(f))};return e.jsx(pe,{onCancel:i,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"border-border border-b px-4 pb-4",children:[e.jsx("div",{className:"bg-primary/10 mx-auto mb-3 flex size-14 items-center justify-center rounded-2xl",children:a?e.jsx("img",{src:a,alt:n,className:"size-10 rounded-xl"}):e.jsx(Tf,{className:"text-primary size-8"})}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:n}),e.jsx("p",{className:"text-muted-foreground mt-1 text-center text-sm",children:String(t("requestsPermissions"))})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"space-y-3",children:o.map(u=>{const f=cy[u];return f?e.jsxs("div",{className:"bg-muted/50 flex items-center gap-3 rounded-xl p-3",children:[e.jsx("div",{className:"bg-primary/10 flex size-10 shrink-0 items-center justify-center rounded-full",children:e.jsx(f,{className:"text-primary size-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium",children:l(u)}),e.jsx("p",{className:"text-muted-foreground text-sm",children:m(u)})]})]},u):null})}),e.jsxs("div",{className:"text-muted-foreground mt-4 flex items-center gap-2 text-sm",children:[e.jsx(ir,{className:"size-4"}),e.jsx("span",{children:String(t("permissionNote"))})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:i,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("reject")}),e.jsx("button",{onClick:d,className:L("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90"),children:t("approve")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const sd=({params:t})=>e.jsx(me,{params:t,children:e.jsx(ly,{})});sd.__docgenInfo={description:"",methods:[],displayName:"PermissionRequestJob"};const Fa="MINIAPP_TRANSFER_UNSUPPORTED_PIPELINE";function dy(t){return/timeout|timed out|etimedout|aborterror|aborted/i.test(t)}function uy(t){return/failed to broadcast transaction|broadcast failed|tx_broadcast_failed/i.test(t)}function nd(t){const s=[],n=new Set;let a=t;for(;a instanceof Error&&!n.has(a);)n.add(a),a.message&&s.push(a.message),a=a.cause;return s}function va(t){return nd(t).some(s=>dy(s))}function no(t){return nd(t).some(s=>uy(s))}function my(t){return new er(fs.NOT_SUPPORTED,Fa,{scope:"miniapp-transfer",chainId:t})}function fy(t,s,n){if(s instanceof er){if(s.code===fs.NOT_SUPPORTED&&s.message===Fa)return t("common:miniappTransferUnsupportedPipeline",{chainId:n});if(s.code===fs.TRANSACTION_TIMEOUT)return t("transaction:broadcast.timeout");if(s.code===fs.TX_BROADCAST_FAILED)return va(s)?t("transaction:broadcast.timeout"):t("transaction:broadcast.failed");if(s.code===fs.NETWORK_ERROR){if(va(s))return t("transaction:broadcast.timeout");if(no(s))return t("transaction:broadcast.failed")}}if(s instanceof Error){if(s.message===Fa)return t("common:miniappTransferUnsupportedPipeline",{chainId:n});if(va(s))return t("transaction:broadcast.timeout");if(no(s))return t("transaction:broadcast.failed")}return t("transaction:broadcast.unknown")}const py=/^\d+$/;function hy(t,s,n){const a=t.trim();if(!py.test(a))throw new Error("Invalid miniapp transfer amount");return oe.fromRaw(a,s,n)}const ao=/pay password|pay secret|second secret|security password/i;function Wa(t){return t instanceof Gs?t.code===vs.DECRYPTION_FAILED||t.code===vs.INVALID_PASSWORD:t instanceof Error?/wrong password|decrypt mnemonic|invalid walletlock|wallet lock/i.test(t.message):!1}function $a(t){return t instanceof er&&t.code===fs.SIGNATURE_FAILED&&ao.test(t.message)?!0:t instanceof Error?ao.test(t.message):!1}async function ad(t,s){const n=Pe(t);if(!n.bioGetAccountInfo)return!1;try{return!!(await n.bioGetAccountInfo(s)).secondPublicKey}catch{return!1}}const ro=new Map;function xy(t,s){const n=JSON.stringify({locale:t,options:s}),a=ro.get(n);if(a)return a;const r=new Intl.NumberFormat(t,s);return ro.set(n,r),r}function io(t,s,n){return t==null?"":xy(s,n).format(t)}const rd=c.createContext(void 0);function id(){const t=c.useContext(rd);if(t===void 0)throw new Error(Ef(51));return t}let ya=(function(t){return t.complete="data-complete",t.indeterminate="data-indeterminate",t.progressing="data-progressing",t})({});const Rr={status(t){return t==="progressing"?{[ya.progressing]:""}:t==="complete"?{[ya.complete]:""}:t==="indeterminate"?{[ya.indeterminate]:""}:null}};function gy(t,s,n){return t==null?"":n?io(t,s,n):io(t/100,s,{style:"percent"})}function vy(t,s){return s==null?"indeterminate progress":t||`${s}%`}const yy=c.forwardRef(function(s,n){const{format:a,getAriaValueText:r=vy,locale:o,max:d=100,min:i=0,value:l,render:m,className:u,...f}=s,[h,g]=c.useState(),b=Pf(a);let p="indeterminate";Number.isFinite(l)&&(p=l===d?"complete":"progressing");const x=gy(l,o,b.current),v=c.useMemo(()=>({status:p}),[p]),j={"aria-labelledby":h,"aria-valuemax":d,"aria-valuemin":i,"aria-valuenow":l??void 0,"aria-valuetext":r(x,l),role:"progressbar"},N=c.useMemo(()=>({formattedValue:x,max:d,min:i,setLabelId:g,state:v,status:p,value:l}),[x,d,i,g,v,p,l]),y=or("div",s,{state:v,ref:n,props:[j,f],stateAttributesMapping:Rr});return e.jsx(rd.Provider,{value:N,children:y})}),by=c.forwardRef(function(s,n){const{render:a,className:r,...o}=s,{state:d}=id();return or("div",s,{state:d,ref:n,props:o,stateAttributesMapping:Rr})});function jy(t,s,n){return(t-s)*100/(n-s)}const Ny=c.forwardRef(function(s,n){const{render:a,className:r,...o}=s,{max:d,min:i,value:l,state:m}=id(),u=Number.isFinite(l)&&l!==null?jy(l,i,d):null,f=c.useCallback(()=>u==null?{}:{insetInlineStart:0,height:"inherit",width:`${u}%`},[u]);return or("div",s,{state:m,ref:n,props:[{style:f()},o],stateAttributesMapping:Rr})});function od({className:t,children:s,value:n,...a}){return e.jsxs(yy,{value:n,"data-slot":"progress",className:L("flex flex-wrap gap-3",t),...a,children:[s,e.jsx(cd,{children:e.jsx(ld,{})})]})}function cd({className:t,...s}){return e.jsx(by,{className:L("bg-muted h-1 rounded-full relative flex w-full items-center overflow-x-hidden",t),"data-slot":"progress-track",...s})}function ld({className:t,...s}){return e.jsx(Ny,{"data-slot":"progress-indicator",className:L("bg-primary h-full transition-all",t),...s})}od.__docgenInfo={description:"",methods:[],displayName:"Progress"};cd.__docgenInfo={description:"",methods:[],displayName:"ProgressTrack"};ld.__docgenInfo={description:"",methods:[],displayName:"ProgressIndicator"};function Lr({currentStep:t,totalSteps:s,percent:n,className:a}){const{t:r}=O("common");return e.jsxs("div",{className:a,"data-testid":"miniapp-step-progress",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:r("stepProgress")}),e.jsx("span",{className:"text-muted-foreground text-xs tabular-nums",children:r("stepFraction",{current:t,total:s})})]}),e.jsx(od,{value:n,className:"w-full","aria-label":r("stepProgressAriaLabel")})]})}Lr.__docgenInfo={description:"",methods:[],displayName:"MiniappStepProgress",props:{currentStep:{required:!0,tsType:{name:"number"},description:""},totalSteps:{required:!0,tsType:{name:"number"},description:""},percent:{required:!0,tsType:{name:"number"},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const wy=["review","wallet_lock","broadcasting"],ky=["review","wallet_lock","two_step_secret","broadcasting"],Cy=["review","wallet_lock","signing"],Sy=["review","wallet_lock","two_step_secret","signing"];function oo(t,s){const n=Math.max(1,t),a=Math.min(Math.max(s,1),n);return{currentStep:a,totalSteps:n,percent:Math.round(a/n*100)}}function Ay(t){return t?ky:wy}function Iy(t){return t?Sy:Cy}function dd(t,s){const n=t.indexOf(s);return n<0?oo(t.length,1):oo(t.length,n+1)}function qn(t){return typeof t=="object"&&t!==null}function co(t){if(typeof structuredClone=="function")try{const s=structuredClone(t);if(qn(s))return s}catch{}try{const s=JSON.parse(JSON.stringify(t));if(qn(s))return s}catch{}return{...t}}const Ty=3,vn=new Map;function Py(){const{t}=O(["common","transaction"]),{pop:s}=Z(),n=st(),a=he(),{requestId:r,appName:o,appIcon:d,from:i,to:l,amount:m,chain:u,asset:f,remark:h}=a,b=c.useRef(r??`legacy-transfer-${Date.now()}-${Math.random().toString(36).slice(2,8)}`).current,[p,x]=c.useState("review"),[v,j]=c.useState([]),[N,y]=c.useState(""),[S,C]=c.useState(!1),[P,_]=c.useState(!1),[I,T]=c.useState(null),[k,A]=c.useState("idle"),[w,E]=c.useState(null),[D,z]=c.useState(!1),[R,V]=c.useState(!0),M=c.useRef(!0),B=c.useRef(!1),G=c.useRef(!1),ee=c.useRef(!1),W=c.useRef(!1),F=c.useMemo(()=>ln(u),[u]),ie=c.useMemo(()=>ed(F,i),[F,i]),q=Re.state.wallets.find(X=>X.id===ie)?.name||t("unknownWallet"),H=`${o||t("unknownDApp")} ${t("requestsTransfer")}`,Q=c.useMemo(()=>Ay(D),[D]),ae=c.useMemo(()=>dd(Q,p),[Q,p]),$=c.useMemo(()=>f||lt.getSymbol(F)||F.toUpperCase(),[f,F]),se=c.useMemo(()=>lt.getDecimals(F),[F]),re=c.useMemo(()=>{try{return hy(m,se,$)}catch{return null}},[m,se,$]),ge=c.useMemo(()=>re?.toFormatted({trimTrailingZeros:!1})??m,[re,m]),ve=c.useMemo(()=>re?null:t("transaction:broadcast.invalidParams"),[re,t]),De=c.useMemo(()=>h?Object.entries(h).map(([X,te])=>({key:X.trim(),value:te.trim()})).filter(X=>X.key.length>0&&X.value.length>0):[],[h]),ft=c.useMemo(()=>t("transaction:miniappTransfer.shortTitle",{amount:ge,asset:$}),[t,ge,$]),zt=k==="building",Ot=k==="broadcasting",pt=k==="success",Ce=k==="building"||k==="broadcasting",fe=c.useCallback((X,te={})=>{console.log("[miniapp-transfer-sheet]",X,{requestId:b,appName:o,chain:F,...te})},[o,b,F]),dn=c.useCallback(()=>{j([]),C(!1),y(""),_(!1),T(null)},[]);c.useEffect(()=>{if(M.current=!0,typeof window<"u"){const X=vn.get(b);X!==void 0&&(window.clearTimeout(X),vn.delete(b),fe("sheet.unmount-settle.cancelled"))}return fe("sheet.mount",{from:i,to:l,amount:m,asset:f??"native"}),r||fe("sheet.request-id.fallback",{fallbackRequestId:b}),()=>{if(M.current=!1,fe("sheet.unmount"),typeof window>"u"||!r)return;const X=window.setTimeout(()=>{if(vn.delete(b),!G.current){G.current=!0;const te={requestId:b,confirmed:!1};fe("sheet.emit.on-unmount",{confirmed:!1,hasTxHash:!1,hasTransaction:!1}),window.dispatchEvent(new CustomEvent("miniapp-transfer-confirm",{detail:te}))}if(!ee.current){ee.current=!0;const te={requestId:b,reason:"cancel"};fe("sheet.closed.on-unmount",te),window.dispatchEvent(new CustomEvent("miniapp-transfer-sheet-closed",{detail:te}))}},0);vn.set(b,X)}},[m,f,b,i,fe,r,l]),c.useEffect(()=>{let X=!0;return V(!0),ad(F,i).then(te=>{X&&z(te)}).finally(()=>{X&&V(!1)}),()=>{X=!1}},[F,i]);const is=c.useCallback(X=>{if(G.current||(G.current=!0,typeof window>"u"))return;const te={requestId:b,...X};fe("sheet.emit",{confirmed:te.confirmed,hasTxHash:!!te.txHash,hasTransaction:!!te.transaction,txId:te.txId}),window.dispatchEvent(new CustomEvent("miniapp-transfer-confirm",{detail:te}))},[b,fe]),ht=c.useCallback(X=>{if(ee.current||(ee.current=!0,typeof window>"u"))return;const te={requestId:b,reason:X};fe("sheet.closed",te),window.dispatchEvent(new CustomEvent("miniapp-transfer-sheet-closed",{detail:te}))},[b,fe]);c.useEffect(()=>{if(!pt||w===null)return;if(w<=0){fe("sheet.success.auto-close"),ht("confirmed"),s();return}const X=window.setTimeout(()=>{E(te=>te===null?null:te-1)},1e3);return()=>{window.clearTimeout(X)}},[ht,pt,fe,s,w]);const Zn=c.useCallback(()=>{!Ot||B.current||(B.current=!0,fe("sheet.background-broadcast"),ht("background"),n.show(t("transaction:miniappTransfer.toast.background",{title:ft})),s())},[ht,Ot,fe,s,t,n,ft]),qu=c.useCallback(()=>{Ce||!ie||(dn(),x("wallet_lock"))},[Ce,ie,dn]),zr=c.useCallback(()=>{Ce||(dn(),x("review"))},[Ce,dn]),Hu=c.useCallback(X=>{(S||I||P)&&(C(!1),_(!1),T(null)),j(X)},[S,I,P]),Uu=c.useCallback(X=>{(P||I)&&(_(!1),T(null)),y(X)},[P,I]),Or=c.useCallback(async(X,te)=>{if(!ie)throw new Error("missing walletId");const Ee=Pe(F);if(!Ee.supportsFullTransaction||!Ee.buildTransaction||!Ee.signTransaction||!Ee.broadcastTransaction)throw my(F);if(!re)throw new Error("Invalid miniapp transfer amount");const mn=await Ee.buildTransaction({type:"transfer",from:i,to:l,amount:re,...f?{bioAssetType:f}:{},...h?{remark:h}:{}}),Ie=await Bo({walletId:ie,password:X,from:i,chainId:F,unsignedTx:mn,...te?{paySecret:te}:{}}),xt=qn(Ie.data)?{...Ie,data:co(Ie.data)}:Ie;M.current&&(x("broadcasting"),A("broadcasting"));const Ku=await Ee.broadcastTransaction(xt),Gu=qn(xt.data)?co(xt.data):{data:xt.data};return{txHash:Ku,transaction:Gu}},[F,re,f,i,l,ie,h]),Br=c.useCallback((X,te)=>{const Ee=fy(t,X,F);if(B.current){M.current&&(x(te),A("idle")),is({confirmed:!1}),n.show(t("transaction:miniappTransfer.toast.failed",{title:ft,reason:Ee}));return}if(!M.current){fe("transfer.failed.after-unmount",{inputStep:te,message:Ee});return}if(A("idle"),Wa(X)){C(!0),_(!1),T(t("walletLock.error")),x("wallet_lock"),j([]);return}if($a(X)){C(!1),_(!0),T(t("transaction:sendPage.twoStepSecretError")),x("two_step_secret");return}C(!1),_(!1),T(Ee),x(te),te==="wallet_lock"&&j([])},[is,fe,F,t,n,ft]),un=c.useCallback(async(X,te,Ee)=>{if(W.current){fe("transfer.skip.in-flight",{inputStep:te});return}let mn=!1;W.current=!0,fe("transfer.start",{inputStep:te,hasPaySecret:!!Ee}),A("building"),C(!1),_(!1),T(null);try{const{txHash:Ie,transaction:xt}=await Or(X,Ee);mn=!0,fe("transfer.broadcast.success",{txHash:Ie}),(B.current||!M.current)&&n.show(t("transaction:miniappTransfer.toast.success",{title:ft})),is({confirmed:!0,txHash:Ie,txId:Ie,transaction:xt}),!B.current&&M.current&&(x("broadcasting"),A("success"),E(Ty))}catch(Ie){const xt=Ie instanceof Error?Ie.name:typeof Ie;fe("transfer.failed",{inputStep:te,errorType:xt}),console.error(te==="two_step_secret"?"[miniapp-transfer][two-step-secret]":"[miniapp-transfer]",Ie),Br(Ie,te)}finally{fe("transfer.finally",{inputStep:te,backgrounded:B.current}),W.current=!1,M.current&&!B.current&&!mn&&A("idle")}},[is,Br,fe,Or,t,n,ft]),Vu=c.useCallback(async X=>{if(X.length<4||Ce||W.current||!ie)return;const te=Be(X);await un(te,"wallet_lock")},[Ce,ie,un]),Fr=c.useCallback(async()=>{if(!ie||!v.length||!N.trim()||Ce||W.current)return;const X=Be(v);await un(X,"two_step_secret",N.trim())},[ie,v,N,Ce,un]),Ju=c.useCallback(()=>{Fr()},[Fr]),ea=c.useCallback(()=>{fe("sheet.success.manual-close",{countdown:w}),ht("confirmed"),s()},[ht,fe,s,w]),ta=c.useCallback(()=>{if(pt){ea();return}if(Ot){fe("sheet.cancel.broadcasting"),Zn();return}if(zt){fe("sheet.cancel.blocked-building");return}fe("sheet.cancel.idle"),is({confirmed:!1}),ht("cancel"),s()},[ht,is,ea,Ot,zt,pt,fe,Zn,s]);return e.jsx(pe,{onCancel:ta,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Rt,{title:t("confirmTransfer"),description:zt?t("buildingTransaction"):p==="review"?H:t(p==="wallet_lock"?"drawPatternToConfirm":p==="two_step_secret"?"transaction:sendPage.twoStepSecretDescription":pt?"transaction:txStatus.broadcastedDesc":"transaction:txStatus.broadcasting"),appName:o,appIcon:d,walletInfo:{name:q,address:i,chainId:F}}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(Lr,{currentStep:ae.currentStep,totalSteps:ae.totalSteps,percent:ae.percent})}),p==="review"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx("div",{className:"bg-muted/50 rounded-xl p-4 text-center",children:e.jsx(Nt,{value:ge,symbol:$,size:"xl",weight:"bold",decimals:se,fixedDecimals:!0})}),e.jsxs("div",{className:"bg-muted/50 space-y-3 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-10 shrink-0 text-xs",children:[" ",t("from")]}),e.jsx(it,{address:i,copyable:!0,className:"flex-1 text-sm"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(Bs,{className:"text-muted-foreground size-4"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-10 shrink-0 text-xs",children:[" ",t("to")]}),e.jsx(it,{address:l,copyable:!0,className:"flex-1 text-sm"})]})]}),!ie&&e.jsx("div",{className:"rounded-xl bg-amber-50 p-3 text-sm text-amber-800 dark:bg-amber-950/30 dark:text-amber-200",children:t("signingAddressNotFound")}),ve&&e.jsx("div",{className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:ve}),e.jsxs("div",{className:"bg-muted/50 flex items-center justify-between rounded-xl p-3",children:[e.jsxs("span",{className:"text-muted-foreground text-sm",children:[" ",t("network")]}),e.jsx(An,{chainId:F})]}),De.length>0&&e.jsxs("div",{"data-testid":"miniapp-transfer-remark",className:"bg-muted/50 space-y-2 rounded-xl p-3",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:t("memo")}),e.jsx("div",{className:"max-h-36 space-y-1 overflow-y-auto pr-1 scrollbar-thin scrollbar-track-transparent scrollbar-thumb-[color-mix(in_srgb,currentColor,transparent)]",children:De.map((X,te)=>e.jsxs("div",{className:L("flex flex-row items-start justify-between gap-2 rounded-md px-2 py-1 text-xs leading-5",te%2===0?"bg-white":"bg-muted/40"),children:[e.jsx("span",{className:"text-muted-foreground min-w-0 break-all",children:X.key}),e.jsx("span",{className:"min-w-0 break-all text-right",children:X.value})]},X.key))})]}),e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[e.jsx(Oe,{className:"mt-0.5 size-5 shrink-0 text-amber-600"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:t("transferWarning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:ta,disabled:Ce,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("cancel")}),e.jsx("button",{"data-testid":"miniapp-transfer-review-confirm",onClick:qu,disabled:Ce||!ie||R||!re,className:L("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","flex items-center justify-center gap-2 disabled:opacity-50"),children:t("confirm")})]})]}):p==="wallet_lock"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 p-4",children:[!ie&&e.jsx("div",{className:"rounded-xl bg-amber-50 p-3 text-sm text-amber-800 dark:bg-amber-950/30 dark:text-amber-200",children:t("signingAddressNotFound")}),e.jsx(mt,{value:v,onChange:Hu,onComplete:Vu,minPoints:4,disabled:Ce||!ie,error:S,errorText:S?t("walletLock.error"):void 0}),I&&!S&&e.jsx("div",{"data-testid":"miniapp-transfer-error",className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:I}),zt&&e.jsxs("div",{"data-testid":"miniapp-transfer-building-status",className:"bg-muted text-muted-foreground flex items-center justify-center gap-2 rounded-xl p-3 text-sm",children:[e.jsx(be,{className:"size-4 animate-spin"}),t("buildingTransaction")]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:zr,disabled:Ce,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("back")}),e.jsx("button",{onClick:ta,disabled:Ce,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("cancel")})]})]}):p==="two_step_secret"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx(ys,{value:N,onChange:X=>Uu(X.target.value),placeholder:t("transaction:sendPage.twoStepSecretPlaceholder"),disabled:Ce,"aria-describedby":I?"miniapp-two-step-secret-error":void 0,"data-testid":"miniapp-two-step-secret-input"}),I&&e.jsx("div",{id:"miniapp-two-step-secret-error","data-testid":"miniapp-transfer-error",className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:I}),zt&&e.jsxs("div",{"data-testid":"miniapp-transfer-building-status",className:"bg-muted text-muted-foreground flex items-center justify-center gap-2 rounded-xl p-3 text-sm",children:[e.jsx(be,{className:"size-4 animate-spin"}),t("buildingTransaction")]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:zr,disabled:Ce,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("back")}),e.jsx("button",{onClick:Ju,disabled:Ce||N.trim().length===0,className:L("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","disabled:opacity-50"),children:t("confirm")})]})]}):e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx("div",{className:"bg-muted/50 rounded-xl p-4 text-center",children:e.jsx(Nt,{value:ge,symbol:$,size:"xl",weight:"bold",decimals:se,fixedDecimals:!0})}),e.jsxs("div",{className:"bg-muted/50 space-y-3 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-10 shrink-0 text-xs",children:[" ",t("from")]}),e.jsx(it,{address:i,copyable:!0,className:"flex-1 text-sm"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(Bs,{className:"text-muted-foreground size-4"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-10 shrink-0 text-xs",children:[" ",t("to")]}),e.jsx(it,{address:l,copyable:!0,className:"flex-1 text-sm"})]})]}),e.jsxs("div",{className:"bg-muted/50 flex items-center justify-between rounded-xl p-3",children:[e.jsxs("span",{className:"text-muted-foreground text-sm",children:[" ",t("network")]}),e.jsx(An,{chainId:F})]}),De.length>0&&e.jsxs("div",{"data-testid":"miniapp-transfer-remark",className:"bg-muted/50 space-y-2 rounded-xl p-3",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:t("memo")}),e.jsx("div",{className:"max-h-36 space-y-1 overflow-y-auto pr-1 scrollbar-thin scrollbar-track-transparent scrollbar-thumb-[color-mix(in_srgb,currentColor,transparent)]",children:De.map((X,te)=>e.jsxs("div",{className:L("flex flex-row items-start justify-between gap-2 rounded-md px-2 py-1 text-xs leading-5",te%2===0?"bg-white":"bg-muted/40"),children:[e.jsx("span",{className:"text-muted-foreground min-w-0 break-all",children:X.key}),e.jsx("span",{className:"min-w-0 break-all text-right",children:X.value})]},X.key))})]}),pt?e.jsxs(e.Fragment,{children:[e.jsx("div",{"data-testid":"miniapp-transfer-broadcast-success-status",className:"bg-muted text-muted-foreground flex items-center justify-center gap-2 rounded-xl p-3 text-sm",children:t("transaction:txStatus.broadcasted")}),e.jsx("button",{type:"button","data-testid":"miniapp-transfer-success-close",onClick:ea,className:L("w-full rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90"),children:t("transaction:txStatus.closeIn",{seconds:w??0})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{"data-testid":"miniapp-transfer-broadcasting-status",className:"bg-muted text-muted-foreground flex items-center justify-center gap-2 rounded-xl p-3 text-sm",children:[e.jsx(be,{className:"size-4 animate-spin"}),t("transaction:txStatus.broadcasting")]}),e.jsx("button",{type:"button","data-testid":"miniapp-transfer-background-broadcast",onClick:Zn,disabled:!Ot,className:L("w-full rounded-xl py-3 font-medium transition-colors","bg-muted hover:bg-muted/80 text-foreground","disabled:opacity-50"),children:t("transaction:miniappTransfer.backgroundBroadcast")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const ud=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Py,{})});ud.__docgenInfo={description:"",methods:[],displayName:"MiniappTransferConfirmJob"};const Is=we.t.bind(we);function qa(t){return typeof t=="object"&&t!==null}function Ey(t){if(typeof structuredClone=="function")try{const s=structuredClone(t);if(qa(s))return s}catch{}try{const s=JSON.parse(JSON.stringify(t));if(qa(s))return s}catch{}return{...t}}async function md(t,s,n){const a=Pe(t.id);return a.bioGetAssetDetail?(await a.bioGetAssetDetail(s,n))?.applyAddress??null:null}async function fd(t,s,n){const a=Pe(t.id);if(!a.buildTransaction||!a.estimateFee)return{amount:oe.fromRaw("1000",t.decimals,t.symbol),symbol:t.symbol};try{const r=await a.buildTransaction({type:"destroy",from:"0x0000000000000000000000000000000000000000",recipientId:"0x0000000000000000000000000000000000000000",bioAssetType:s,amount:oe.fromRaw(n,t.decimals,t.symbol)});return{amount:(await a.estimateFee(r)).standard.amount,symbol:t.symbol}}catch{return{amount:oe.fromRaw("1000",t.decimals,t.symbol),symbol:t.symbol}}}async function Hn({chainConfig:t,walletId:s,password:n,fromAddress:a,recipientAddress:r,assetType:o,amount:d,fee:i,twoStepSecret:l,remark:m}){let u;try{u=await gs.getMnemonic(s,n)}catch(h){return h instanceof Gs&&h.code===vs.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:h instanceof Error?h.message:Is("error:unknown")}}if(!d.isPositive())return{status:"error",message:Is("error:validation.enterValidAmount")};const f=Pe(t.id);if(!f.supportsFullTransaction)return{status:"error",message:Is("error:transaction.chainNotSupported")};try{let h=null;if(f.bioGetAccountInfo){if(h=(await f.bioGetAccountInfo(a)).secondPublicKey,h&&!l)return{status:"password_required",secondPublicKey:h};if(l&&h&&f.bioVerifyPayPassword&&!await f.bioVerifyPayPassword({mainSecret:u,paySecret:l,publicKey:h}))return{status:"error",message:Is("error:transaction.securityPasswordFailed")}}const g=await f.buildTransaction({type:"destroy",from:a,recipientId:r,amount:d,bioAssetType:o,...m?{remark:m}:{}}),b=await f.signTransaction(g,{privateKey:new TextEncoder().encode(u),bioSecret:u,bioPaySecret:l}),p=await wt.create({walletId:_o(t.id,a),chainId:t.id,fromAddress:a,rawTx:b,meta:{type:"destroy",displayAmount:d.toFormatted(),displaySymbol:o,displayToAddress:r}});await wt.updateStatus({id:p.id,status:"broadcasting"});try{const x=await f.broadcastTransaction(b);await wt.updateStatus({id:p.id,status:"broadcasted",txHash:x});const v=qa(b.data)?Ey(b.data):{data:b.data};return{status:"ok",txHash:x,txId:x,transaction:v,pendingTxId:p.id}}catch(x){const v=x;return await wt.updateStatus({id:p.id,status:"failed",errorCode:"BROADCAST_FAILED",errorMessage:v.message}),{status:"error",message:v.message,pendingTxId:p.id}}}catch(h){return{status:"error",message:(h instanceof Error?h.message:String(h))||Is("error:transaction.burnFailed")}}}const _y=Object.freeze(Object.defineProperty({__proto__:null,fetchAssetApplyAddress:md,fetchBioforestBurnFee:fd,submitBioforestBurn:Hn},Symbol.toStringTag,{value:"Module"}));function My(){const{t}=O(["common","transaction"]),{pop:s,push:n}=Z(),a=he(),{requestId:r,appName:o,appIcon:d,from:i,amount:l,chain:m,asset:u,remark:f}=a,h=dt(),g=c.useMemo(()=>ln(m),[m]),p=c.useMemo(()=>Mr(g,i),[g,i])?.wallet,x=h.snapshot?He.getChainById(h,g):null,[v,j]=c.useState(!1),N=c.useCallback(w=>{if(typeof window>"u")return;const E={requestId:r,...w};window.dispatchEvent(new CustomEvent("miniapp-destroy-confirm",{detail:E}))},[r]),y=c.useCallback(w=>{if(typeof window>"u")return;const E={requestId:r,reason:w};window.dispatchEvent(new CustomEvent("miniapp-destroy-sheet-closed",{detail:E}))},[r]),S=p?.name||t("common:unknownWallet"),C=`${o||t("common:unknownDApp")} ${t("common:requestsDestroy")}`,P=c.useMemo(()=>{if(!x)return null;try{return oe.fromRaw(l,x.decimals,u)}catch{return null}},[l,u,x]),_=c.useMemo(()=>P?.toFormatted({trimTrailingZeros:!1})??l,[l,P]),I=x?.decimals??8,T=c.useMemo(()=>x?P?null:t("transaction:broadcast.invalidParams"):null,[x,P,t]),k=c.useCallback(()=>{v||(ks(async w=>{j(!0);try{if(!p?.id||!x)throw new Error(t("common:signingAddressNotFound"));const{fetchAssetApplyAddress:E}=await Pt(async()=>{const{fetchAssetApplyAddress:M}=await Promise.resolve().then(()=>_y);return{fetchAssetApplyAddress:M}},void 0,import.meta.url),D=await E(x,u,i);if(!D)return!1;if(!P)throw new Error("Invalid miniapp destroy amount");const z=P,R=await Hn({chainConfig:x,walletId:p.id,password:w,fromAddress:i,recipientAddress:D,assetType:u,amount:z,...f?{remark:f}:{}});if(R.status==="password"||R.status==="error")return!1;const V=new CustomEvent("miniapp-destroy-confirm",{detail:{requestId:r,confirmed:!0,txHash:R.status==="ok"?R.txHash:void 0,txId:R.status==="ok"?R.txId:void 0,transaction:R.status==="ok"?R.transaction:void 0}});return window.dispatchEvent(V),y("confirmed"),s(),!0}catch{return!1}finally{j(!1)}}),n("WalletLockConfirmJob",{title:t("transaction:destroyPage.title"),description:C,miniappName:o,miniappIcon:d,walletName:S,walletAddress:i,walletChainId:g}))},[v,p,x,u,i,l,P,s,n,t,C,o,d,S,g,f,r,y]),A=c.useCallback(()=>{N({confirmed:!1}),y("cancel"),s()},[N,y,s]);return e.jsx(pe,{onCancel:A,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Rt,{title:t("transaction:destroyPage.title"),description:C,appName:o,appIcon:d,walletInfo:{name:S,address:i,chainId:g}}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx("div",{className:"bg-destructive/5 rounded-xl p-4 text-center",children:e.jsx(Nt,{value:_,symbol:u,size:"xl",weight:"bold",decimals:I,fixedDecimals:!0})}),e.jsx("div",{className:"bg-muted/50 space-y-3 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-10 shrink-0 text-xs",children:[" ",t("common:from")]}),e.jsx(Xa,{chainId:g,address:i,copyable:!0,size:"sm"})]})}),T&&e.jsx("div",{className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:T}),e.jsxs("div",{className:"bg-muted/50 flex items-center justify-between rounded-xl p-3",children:[e.jsxs("span",{className:"text-muted-foreground text-sm",children:[" ",t("common:network")]}),e.jsx(An,{chainId:g})]}),e.jsxs("div",{className:"bg-destructive/10 flex items-start gap-2 rounded-xl p-3",children:[e.jsx(Oe,{className:"text-destructive mt-0.5 size-5 shrink-0"}),e.jsx("p",{className:"text-destructive text-sm",children:t("transaction:destroyPage.warning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:A,disabled:v,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("common:cancel")}),e.jsx("button",{onClick:k,disabled:v||!p?.id||!x||!P,className:L("flex-1 rounded-xl py-3 font-medium transition-colors","bg-destructive text-destructive-foreground hover:bg-destructive/90","flex items-center justify-center gap-2 disabled:opacity-50"),children:v?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"size-4 animate-spin"}),t("common:confirming")]}):e.jsxs(e.Fragment,{children:[e.jsx(Sn,{className:"size-4"}),t("transaction:destroyPage.confirm")]})})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const pd=({params:t})=>e.jsx(me,{params:t,children:e.jsx(My,{})});pd.__docgenInfo={description:"",methods:[],displayName:"MiniappDestroyConfirmJob"};function Ry(){const{t}=O("common"),{pop:s}=Z(),n=he(),{appName:a,appIcon:r,from:o,chain:d,unsignedTx:i}=n,[l,m]=c.useState("review"),[u,f]=c.useState([]),[h,g]=c.useState(""),[b,p]=c.useState(!1),[x,v]=c.useState(!1),[j,N]=c.useState(null),[y,S]=c.useState(!1),[C,P]=c.useState(!1),[_,I]=c.useState(!0),T=c.useMemo(()=>{try{return Qt.parse(i)}catch{return null}},[i]),k=c.useMemo(()=>ln(d),[d]),A=c.useMemo(()=>ed(k,o),[k,o]),E=Re.state.wallets.find(H=>H.id===A)?.name||t("unknownWallet"),D=c.useMemo(()=>Iy(C),[C]),z=c.useMemo(()=>dd(D,l),[D,l]),R=c.useCallback(()=>{f([]),p(!1),g(""),v(!1),N(null)},[]);c.useEffect(()=>{let H=!0;return I(!0),ad(k,o).then(Q=>{H&&P(Q)}).finally(()=>{H&&I(!1)}),()=>{H=!1}},[k,o]);const V=c.useCallback(()=>{y||!T||!A||(R(),m("wallet_lock"))},[y,T,A,R]),M=c.useCallback(()=>{y||(R(),m("review"))},[y,R]),B=c.useCallback(H=>{(b||j||x)&&(p(!1),v(!1),N(null)),f(H)},[b,j,x]),G=c.useCallback(H=>{(x||j)&&(v(!1),N(null)),g(H)},[x,j]),ee=c.useCallback(async(H,Q)=>{if(!A||!T)return;const ae=await Bo({walletId:A,password:H,from:o,chainId:k,unsignedTx:T,...Q?{paySecret:Q}:{}}),$=new CustomEvent("miniapp-sign-transaction-confirm",{detail:{confirmed:!0,signedTx:ae}});window.dispatchEvent($),s()},[A,T,o,k,s]),W=c.useCallback(async H=>{if(H.length<4||y||!T||!A)return;const Q=Be(H);S(!0),p(!1),v(!1),N(null);try{m("signing"),await ee(Q)}catch(ae){console.error("[miniapp-sign-transaction]",ae),Wa(ae)?(p(!0),N(t("walletLock.error"))):$a(ae)?(p(!1),v(!0),N(t("transaction:sendPage.twoStepSecretError")),m("two_step_secret")):(p(!1),v(!1),N(t("signingFailed"))),f([])}finally{S(!1)}},[y,T,A,ee,t]),F=c.useCallback(async()=>{if(!A||!T||!u.length||!h.trim()||y)return;const H=Be(u);S(!0),v(!1),N(null);try{m("signing"),await ee(H,h.trim())}catch(Q){console.error("[miniapp-sign-transaction][two-step-secret]",Q),$a(Q)?(v(!0),N(t("transaction:sendPage.twoStepSecretError")),m("two_step_secret")):Wa(Q)?(p(!0),N(t("walletLock.error")),m("wallet_lock")):(v(!1),N(t("signingFailed")),m("two_step_secret"))}finally{S(!1)}},[A,T,u,h,y,ee,t]),ie=c.useCallback(()=>{F()},[F]),ne=c.useCallback(()=>{const H=new CustomEvent("miniapp-sign-transaction-confirm",{detail:{confirmed:!1}});window.dispatchEvent(H),s()},[s]),q=c.useMemo(()=>{if(!T)return"";try{return JSON.stringify(T.data,null,2)}catch{return String(T.data)}},[T]);return e.jsx(pe,{onCancel:ne,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Rt,{title:t("signTransaction"),description:l==="review"?a||t("unknownDApp"):t(l==="wallet_lock"?"drawPatternToConfirm":l==="two_step_secret"?"transaction:sendPage.twoStepSecretDescription":"signing"),appName:a,appIcon:r,walletInfo:{name:E,address:o,chainId:k}}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(Lr,{currentStep:z.currentStep,totalSteps:z.totalSteps,percent:z.percent})}),l==="review"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 p-4",children:[!T&&e.jsx("div",{className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:t("invalidTransaction")}),T&&!A&&e.jsx("div",{className:"rounded-xl bg-amber-50 p-3 text-sm text-amber-800 dark:bg-amber-950/30 dark:text-amber-200",children:t("signingAddressNotFound")}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("network")}),e.jsx(An,{chainId:k})]}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("signingAddress")}),e.jsx(Xa,{chainId:k,address:o,copyable:!1,size:"sm"})]}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("transaction")}),e.jsx("div",{className:"max-h-44 overflow-y-auto",children:e.jsx("pre",{className:"font-mono text-xs break-all whitespace-pre-wrap",children:q})})]}),e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[e.jsx(Oe,{className:"mt-0.5 size-5 shrink-0 text-amber-600"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:t("signTxWarning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:ne,disabled:y,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("cancel")}),e.jsx("button",{onClick:V,disabled:y||!T||!A||_,className:L("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","flex items-center justify-center gap-2 disabled:opacity-50"),children:t("sign")})]})]}):l==="wallet_lock"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 p-4",children:[!A&&e.jsx("div",{className:"rounded-xl bg-amber-50 p-3 text-sm text-amber-800 dark:bg-amber-950/30 dark:text-amber-200",children:t("signingAddressNotFound")}),e.jsx(mt,{value:u,onChange:B,onComplete:W,minPoints:4,disabled:y||!A,error:b,errorText:b?t("walletLock.error"):void 0}),j&&!b&&e.jsx("div",{className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:j}),y&&e.jsxs("div",{className:"bg-muted text-muted-foreground flex items-center justify-center gap-2 rounded-xl p-3 text-sm",children:[e.jsx(be,{className:"size-4 animate-spin"}),t("signing")]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:M,disabled:y,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("back")}),e.jsx("button",{onClick:ne,disabled:y,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("cancel")})]})]}):l==="two_step_secret"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx(ys,{value:h,onChange:H=>G(H.target.value),placeholder:t("transaction:sendPage.twoStepSecretPlaceholder"),disabled:y,"aria-describedby":j?"miniapp-sign-two-step-secret-error":void 0,"data-testid":"miniapp-sign-two-step-secret-input"}),j&&e.jsx("div",{id:"miniapp-sign-two-step-secret-error",className:"bg-destructive/10 text-destructive rounded-xl p-3 text-sm",children:j}),y&&e.jsxs("div",{className:"bg-muted text-muted-foreground flex items-center justify-center gap-2 rounded-xl p-3 text-sm",children:[e.jsx(be,{className:"size-4 animate-spin"}),t("signing")]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:M,disabled:y,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors disabled:opacity-50",children:t("back")}),e.jsx("button",{onClick:ie,disabled:y||h.trim().length===0,className:L("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","disabled:opacity-50"),children:t("confirm")})]})]}):e.jsx("div",{className:"space-y-4 p-4",children:e.jsxs("div",{className:"bg-muted text-muted-foreground flex items-center justify-center gap-2 rounded-xl p-3 text-sm",children:[e.jsx(be,{className:"size-4 animate-spin"}),t("signing")]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const hd=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Ry,{})});hd.__docgenInfo={description:"",methods:[],displayName:"MiniappSignTransactionJob"};function lo(t){const s=Kn(t);if(s)return lt.getName(s);try{return`Chain ${Sf(t)}`}catch{return t}}function uo(t){return Kn(t)}function Ly(){const{t}=O("common"),{pop:s}=Z(),{fromChainId:n,toChainId:a,appName:r,appIcon:o}=he(),d=lo(n),i=lo(a),l=uo(n),m=uo(a),u=()=>{const h=new CustomEvent("chain-switch-confirm",{detail:{approved:!0,toChainId:a}});window.dispatchEvent(h),s()},f=()=>{const h=new CustomEvent("chain-switch-confirm",{detail:{approved:!1}});window.dispatchEvent(h),s()};return e.jsx(pe,{onCancel:f,children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Rt,{title:t("switchNetwork"),description:`${r||t("unknownDApp")} ${t("requestsNetworkSwitch")}`,appName:r,appIcon:o}),e.jsxs("div",{className:"flex items-center justify-center gap-4 px-6 py-8",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[l?e.jsx(Et,{chain:l,size:"lg"}):e.jsx("div",{className:"bg-muted flex size-12 items-center justify-center rounded-full",children:e.jsx(Oe,{className:"text-muted-foreground size-6"})}),e.jsx("span",{className:"text-muted-foreground text-sm",children:d})]}),e.jsx(rc,{className:"text-primary size-8"}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[m?e.jsx(Et,{chain:m,size:"lg"}):e.jsx("div",{className:"bg-muted flex size-12 items-center justify-center rounded-full",children:e.jsx(Oe,{className:"text-muted-foreground size-6"})}),e.jsx("span",{className:"font-medium",children:i})]})]}),e.jsx("div",{className:"bg-warning/10 border-warning/20 mx-4 mb-4 rounded-lg border p-3",children:e.jsx("p",{className:"text-warning text-sm",children:t("chainSwitchWarning")})}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:f,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("cancel")}),e.jsx("button",{onClick:u,className:"bg-primary hover:bg-primary/90 text-primary-foreground flex-1 rounded-xl py-3 font-medium transition-colors",children:t("confirm")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const xd=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Ly,{})});xd.__docgenInfo={description:"",methods:[],displayName:"ChainSwitchConfirmJob"};function Dy(){const{t}=O("common"),{pop:s}=Z(),n=he(),a=Qt.parse(n.actions),r=n.duration,{address:o,chainId:d,appName:i,appIcon:l}=n,m=Re.state.wallets.find(C=>C.chainAddresses.some(P=>P.address===o)),u=m?.name,f=m?.id,[h,g]=c.useState([]),[b,p]=c.useState(!1),[x,v]=c.useState(!1),[j,N]=c.useState(r),y=c.useCallback(async C=>{v(!0),p(!1);try{const P=Be(C),_=await gs.getAllWallets();if(_.length===0){p(!0),g([]),v(!1);return}let I=!1;for(const T of _)try{await gs.getMnemonic(T.id,P),I=!0;break}catch{}if(I&&f){const T=new CustomEvent("crypto-authorize-confirm",{detail:{approved:!0,patternKey:P,walletId:f,selectedDuration:j}});window.dispatchEvent(T),s()}else p(!0),g([])}catch{p(!0),g([])}finally{v(!1)}},[s,j]),S=c.useCallback(()=>{const C=new CustomEvent("crypto-authorize-confirm",{detail:{approved:!1}});window.dispatchEvent(C),s()},[s]);return e.jsx(pe,{onCancel:S,children:e.jsxs("div",{className:"bg-background flex max-h-[85vh] flex-col rounded-t-2xl",children:[e.jsx("div",{className:"flex flex-shrink-0 justify-center py-2",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Rt,{title:t("cryptoAuthorize"),description:i||t("unknownDApp"),appName:i,appIcon:l,walletInfo:{name:u||t("unknownWallet"),address:o,chainId:d||"bfmeta"}}),e.jsx("div",{className:"min-h-0 flex-1 space-y-3 overflow-y-auto px-4 py-3",children:e.jsxs("div",{className:"bg-muted/50 space-y-2 rounded-xl p-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(en,{className:"text-primary size-4 flex-shrink-0"}),e.jsxs("span",{className:"text-muted-foreground",children:[t("permissions"),""]}),e.jsx("span",{className:"truncate font-medium",children:a.map(C=>Hm[C]?.name||C).join("")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-muted-foreground ml-6",children:[t("duration"),""]}),e.jsxs(Fs,{value:j,onValueChange:C=>N(C),children:[e.jsx(Ws,{className:"h-7 w-24 text-xs",children:e.jsx($s,{})}),e.jsx(qs,{children:Um.map(C=>e.jsx(Yt,{value:C,children:Vm[C]},C))})]})]})]})}),e.jsxs("div",{className:"flex-shrink-0 px-4 pb-2",children:[e.jsx("p",{className:"text-muted-foreground mb-2 text-center text-xs",children:t("drawPatternToConfirm")}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-[280px]",children:e.jsx(mt,{value:h,onChange:g,onComplete:y,error:b,disabled:x})})}),e.jsx("div",{className:"flex h-6 items-center justify-center",children:x&&e.jsxs("div",{className:"text-muted-foreground flex items-center gap-2",children:[e.jsx(be,{className:"size-4 animate-spin"}),e.jsx("span",{className:"text-xs",children:t("verifying")})]})})]}),e.jsx("div",{className:"flex-shrink-0 px-4 pb-2",children:e.jsx("button",{onClick:S,disabled:x,className:"bg-muted hover:bg-muted/80 w-full rounded-xl py-2.5 text-sm font-medium transition-colors disabled:opacity-50",children:t("cancel")})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)] flex-shrink-0"})]})})}const gd=({params:t})=>e.jsx(me,{params:t,children:e.jsx(Dy,{})});gd.__docgenInfo={description:"",methods:[],displayName:"CryptoAuthorizeJob"};const zy={"zh-CN":"","zh-TW":"",en:"English",ja:"",ko:"",ar:""},Oy={USD:"USD ($)",CNY:"CNY ()",EUR:"EUR ()",JPY:"JPY ()",KRW:"KRW ()"};function Dr(){const{navigate:t}=de(),{push:s}=Z(),{t:n}=O(["settings","common","security","error"]),a=Fe(),r=Ga(),o=es(),d=Co(),i=ko(),l=st(),m=yv(),[u,f]=c.useState(!1),[h,g]=c.useState("loading");c.useEffect(()=>{async function N(){if(!a){g("unavailable");return}const y=a.chainAddresses.find(S=>S.chain==="bfmeta"||S.chain==="bfm");if(!y){g("unavailable");return}try{const S=He.getChainById(ka.state,"bfmeta");if(!S){g("unavailable");return}const C=await kv(S,y.address);g(C?"set":"not_set")}catch{g("unavailable")}}N()},[a]);const b=()=>n(`settings:appearance.${i}`),p=()=>{switch(m.status){case"checking":return n("settings:update.checking");case"update-available":return n("settings:update.available");case"up-to-date":return n("settings:update.upToDate");case"error":return n("settings:update.failed");case"not-dweb":return n("settings:update.dwebRequired");default:return n("settings:update.notChecked")}},x=async()=>{const N=await vv.check("manual");if(N.status==="not-dweb"){l.show(n("error:crypto.dwebEnvironmentRequired"));return}if(N.status==="error"){l.show(n("settings:update.failed"));return}N.status==="up-to-date"&&l.show(n("settings:update.upToDate"))},v=()=>{switch(h){case"loading":return"...";case"set":return n("security:twoStepSecret.alreadySet");case"not_set":return n("security:twoStepSecret.notSet");default:return n("settings:notSupported")}},j=async()=>{if(h!=="not_set"||!a)return;const N=a.chainAddresses.find(C=>C.chain==="bfmeta"||C.chain==="bfm");if(!N)return;const y=He.getChainById(ka.state,"bfmeta");if(!y)return;const S=await wv(y);Lv(async(C,P)=>{const _=await Nv({chainConfig:y,walletId:a.id,password:P,fromAddress:N.address,newTwoStepSecret:C});return _.status==="ok"?(g("set"),{success:!0,txHash:_.txHash}):_.status==="password"?{success:!1,error:n("security:passwordConfirm.verifying")}:_.status==="already_set"?(g("set"),{success:!1,error:n("security:twoStepSecret.alreadySet")}):{success:!1,error:_.message}},S??void 0,async()=>{const{getChainProvider:C}=await Pt(async()=>{const{getChainProvider:_}=await import("./index-qYIYDQQe.js").then(I=>I.x);return{getChainProvider:_}},__vite__mapDeps([2,3,1,4,5,6,7,8,9,10]),import.meta.url),P=C(y.id);if(!P.bioGetAccountInfo)return!1;try{return!!(await P.bioGetAccountInfo(N.address)).secondPublicKey}catch{return!1}}),s("SetTwoStepSecretJob",{chainName:"BioForest Chain"})};return e.jsxs("div",{className:"bg-muted/30 flex h-full flex-col overflow-y-auto",children:[e.jsx(K,{title:n("common:a11y.tabSettings")}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("button",{type:"button",onClick:()=>t({to:"/my-card"}),className:"bg-card hover:bg-accent flex w-full items-center gap-4 rounded-xl p-4 shadow-sm transition-colors","data-testid":"my-card-button",children:[e.jsx(js,{src:r.avatar,size:56}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("h2",{className:"font-semibold",children:r.username||n("common:myCard.defaultName")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:n("settings:items.myCard")})]}),e.jsx(kp,{size:20,className:"text-muted-foreground"})]}),e.jsxs(Es,{title:n("settings:sections.walletManagement"),children:[e.jsx(Se,{icon:e.jsx(ar,{size:20}),label:n("settings:items.walletManagement"),onClick:()=>t({to:`/wallet/${a?.id??""}`})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(dc,{size:20}),label:n("settings:items.walletChains"),onClick:()=>t({to:"/settings/wallet-chains"}),testId:"wallet-chains-button"}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(Yf,{size:20}),label:n("settings:items.addressBook"),onClick:()=>t({to:"/address-book"}),testId:"address-book-button"})]}),e.jsxs(Es,{title:n("settings:sections.security"),children:[e.jsx(Se,{icon:e.jsx(en,{size:20}),label:n("settings:items.appLock"),value:n("settings:notSupported"),disabled:!0}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(cr,{size:20}),label:n("settings:items.viewMnemonic"),onClick:()=>t({to:"/settings/mnemonic"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(mr,{size:20}),label:n("settings:items.changeWalletLock"),onClick:()=>t({to:"/settings/wallet-lock"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(Em,{size:20}),label:n("security:twoStepSecret.setup"),value:v(),onClick:j,disabled:h==="set"||h==="unavailable",testId:"set-pay-password-button"})]}),e.jsxs(Es,{title:n("settings:sections.preferences"),children:[e.jsx(Se,{icon:e.jsx(Sp,{size:20}),label:n("settings:items.language"),value:zy[o],onClick:()=>t({to:"/settings/language"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(dp,{size:20}),label:n("settings:items.currency"),value:Oy[d],onClick:()=>t({to:"/settings/currency"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(Mp,{size:20}),label:n("settings:items.appearance"),value:b(),onClick:()=>f(!0)}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(Ep,{size:20}),label:n("settings:items.chainConfig"),onClick:()=>t({to:"/settings/chains"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(mc,{size:20}),label:n("settings:items.miniappSources"),onClick:()=>t({to:"/settings/sources"})})]}),e.jsxs(Es,{title:n("settings:sections.about"),allowContextMenu:!0,children:[e.jsx(Se,{icon:e.jsx(Zm,{size:20}),label:n("settings:items.aboutApp"),value:"v1.0.2-021603",onClick:()=>{}}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(ns,{size:20}),label:n("settings:update.check"),value:p(),onClick:x}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(Se,{icon:e.jsx(cc,{size:20}),label:n("settings:items.storage"),onClick:()=>t({to:"/settings/storage"}),testId:"storage-button"})]}),e.jsx("div",{className:"h-[var(--tab-bar-height)]"})]}),e.jsx(Il,{open:u,onOpenChange:f})]})}Dr.__docgenInfo={description:"",methods:[],displayName:"SettingsPage"};function vd(){return e.jsx(Dr,{})}vd.__docgenInfo={description:`SettingsTab - 

 SettingsPage `,methods:[],displayName:"SettingsTab"};const yd=({params:t})=>{const{push:s}=Z(),[n,a]=c.useState(t.tab||"wallet"),r=c.useRef(Promise.resolve()),o=c.useRef(0);return c.useEffect(()=>{Jm(),Hr().setPermissionRequestCallback(async(l,m,u)=>{const f=Km.state.apps.get(l)?.manifest.icon;return new Promise(h=>{const g=window.setTimeout(()=>h(!1),3e4),b=p=>{window.clearTimeout(g);const x=p.detail;h(x?.approved===!0)};window.addEventListener("permission-request",b,{once:!0}),s("PermissionRequestJob",{appName:m,appIcon:f,permissions:JSON.stringify(u)})})}),Ur(async l=>{const m=l?.app?.name,u=l?.app?.icon;return new Promise(f=>{const h=window.setTimeout(()=>f(null),3e4),g=()=>{window.clearTimeout(h),window.removeEventListener("wallet-picker-select",b),window.removeEventListener("wallet-picker-cancel",p)},b=x=>{g();const v=x.detail;f({address:v.address,chain:v.chain,name:v.name})},p=()=>{g(),f(null)};window.addEventListener("wallet-picker-select",b),window.addEventListener("wallet-picker-cancel",p),s("WalletPickerJob",{chain:l?.chain,exclude:l?.exclude,...m?{appName:m}:{},...u?{appIcon:u}:{}})})}),Vr(()=>{const l=Re.state,m=Qs.getCurrentWallet(l);return m?m.chainAddresses.map(u=>({address:u.address,chain:u.chain,name:m.name})):[]}),Jr(async l=>new Promise(m=>{const u=window.setTimeout(()=>m(null),6e4),f=h=>{window.clearTimeout(u);const g=h.detail;if(g?.confirmed&&g.signature&&g.publicKey){m({signature:g.signature,publicKey:g.publicKey});return}m(null)};window.addEventListener("signing-confirm",f,{once:!0}),s("SigningConfirmJob",{message:l.message,address:l.address,appName:l.app.name,appIcon:l.app.icon??"",chainName:l.chainName})}));const d=(l,m)=>{console.log("[miniapp-transfer-sheet]",l,m)},i=(l,m)=>{d("queue.enqueue",m);const u=r.current.catch(()=>{}).then(async()=>(d("queue.start",m),l()));return r.current=u.then(()=>{d("queue.done",m)},f=>{const h=f instanceof Error?f.message:String(f);d("queue.error",{...m,message:h})}),u};return Kr(async l=>{const m=`transfer-${Date.now()}-${++o.current}`;return new Promise(u=>{i(()=>new Promise(f=>{let h=!1,g=!1;const b=()=>{window.removeEventListener("miniapp-transfer-confirm",v),window.removeEventListener("miniapp-transfer-sheet-closed",j)},p=N=>{h||(h=!0,u(N),g&&b())},x=N=>{g||(g=!0,d("queue.release",{requestId:m,source:"bio",reason:N,resultSettled:h}),f(),h&&b())},v=N=>{const y=N.detail;if(y?.requestId!==m){d("dialog.ignore",{requestId:m,source:"bio",incomingRequestId:y?.requestId??"unknown"});return}if(d("dialog.receive",{requestId:m,source:"bio",confirmed:y?.confirmed===!0}),y?.confirmed&&y.txHash){p({txHash:y.txHash,txId:y.txId,transaction:y.transaction});return}p(null)},j=N=>{const y=N.detail;y?.requestId===m&&(d("dialog.sheet-closed",{requestId:m,source:"bio",reason:y?.reason??"unknown"}),h||p(null),x(y?.reason??"sheet-closed"))};window.addEventListener("miniapp-transfer-confirm",v),window.addEventListener("miniapp-transfer-sheet-closed",j),d("dialog.push",{requestId:m,source:"bio",from:l.from,to:l.to,chain:l.chain}),s("MiniappTransferConfirmJob",{requestId:m,appName:l.app.name,appIcon:l.app.icon??"",from:l.from,to:l.to,amount:l.amount,chain:l.chain,...l.asset?{asset:l.asset}:{},...l.remark?{remark:l.remark}:{}})}),{requestId:m,source:"bio"})})}),Gr(async l=>{const m=`destroy-${Date.now()}-${++o.current}`;return new Promise(u=>{i(()=>new Promise(f=>{let h=!1,g=!1;const b=()=>{window.removeEventListener("miniapp-destroy-confirm",v),window.removeEventListener("miniapp-destroy-sheet-closed",j)},p=N=>{h||(h=!0,u(N),g&&b())},x=N=>{g||(g=!0,d("queue.release",{requestId:m,source:"destroy",reason:N,resultSettled:h}),f(),h&&b())},v=N=>{const y=N.detail;if(y?.requestId!==m){d("dialog.ignore",{requestId:m,source:"destroy",incomingRequestId:y?.requestId??"unknown"});return}if(d("dialog.receive",{requestId:m,source:"destroy",confirmed:y?.confirmed===!0}),y?.confirmed&&y.txHash){p({txHash:y.txHash,txId:y.txId,transaction:y.transaction});return}p(null)},j=N=>{const y=N.detail;y?.requestId===m&&(d("dialog.sheet-closed",{requestId:m,source:"destroy",reason:y?.reason??"unknown"}),h||p(null),x(y?.reason??"sheet-closed"))};window.addEventListener("miniapp-destroy-confirm",v),window.addEventListener("miniapp-destroy-sheet-closed",j),d("dialog.push",{requestId:m,source:"destroy",from:l.from,chain:l.chain,asset:l.asset}),s("MiniappDestroyConfirmJob",{requestId:m,appName:l.app.name,appIcon:l.app.icon??"",from:l.from,amount:l.amount,chain:l.chain,asset:l.asset,...l.remark?{remark:l.remark}:{}})}),{requestId:m,source:"destroy"})})}),Qr(async l=>new Promise(m=>{const u=window.setTimeout(()=>m(null),6e4),f=h=>{window.clearTimeout(u);const g=h.detail;if(g?.confirmed&&g.signedTx){m(g.signedTx);return}m(null)};window.addEventListener("miniapp-sign-transaction-confirm",f,{once:!0}),s("MiniappSignTransactionJob",{appName:l.app.name,appIcon:l.app.icon??"",from:l.from,chain:l.chain,unsignedTx:Qt.stringify(l.unsignedTx)})})),Yr(async l=>{const m=l.app?.name,u=l.app?.icon;return new Promise(f=>{const h=window.setTimeout(()=>f(null),3e4),g=()=>{window.clearTimeout(h),window.removeEventListener("wallet-picker-select",b),window.removeEventListener("wallet-picker-cancel",p)},b=x=>{g();const v=x.detail;f({address:v.address,chain:v.chain,name:v.name})},p=()=>{g(),f(null)};window.addEventListener("wallet-picker-select",b),window.addEventListener("wallet-picker-cancel",p),s("WalletPickerJob",{chain:l.chainId,...m?{appName:m}:{},...u?{appIcon:u}:{}})})}),ti(async l=>new Promise(m=>{const u=window.setTimeout(()=>m(!1),3e4),f=h=>{window.clearTimeout(u);const g=h.detail;m(g?.approved===!0)};window.addEventListener("chain-switch-confirm",f,{once:!0}),s("ChainSwitchConfirmJob",{fromChainId:l.fromChainId,toChainId:l.toChainId,appName:l.appName,appIcon:l.appIcon})})),Xr(async l=>new Promise(m=>{const u=window.setTimeout(()=>m(null),6e4),f=h=>{window.clearTimeout(u);const g=h.detail;if(g?.confirmed&&g.signature){m({signature:g.signature});return}m(null)};window.addEventListener("signing-confirm",f,{once:!0}),s("SigningConfirmJob",{message:l.message,address:l.address,appName:l.appName,chainName:"ethereum"})})),Zr(async l=>{const{from:m,to:u,value:f,chainId:h}=l.tx;if(!m||!u)return null;const b=BigInt(f??"0x0").toString(),p=h?Kn(h):null,x=`transfer-${Date.now()}-${++o.current}`;return new Promise(v=>{i(()=>new Promise(j=>{let N=!1,y=!1;const S=()=>{window.removeEventListener("miniapp-transfer-confirm",_),window.removeEventListener("miniapp-transfer-sheet-closed",I)},C=T=>{N||(N=!0,v(T),y&&S())},P=T=>{y||(y=!0,d("queue.release",{requestId:x,source:"evm",reason:T,resultSettled:N}),j(),N&&S())},_=T=>{const k=T.detail;if(k?.requestId!==x){d("dialog.ignore",{requestId:x,source:"evm",incomingRequestId:k?.requestId??"unknown"});return}if(d("dialog.receive",{requestId:x,source:"evm",confirmed:k?.confirmed===!0}),k?.confirmed&&k.txHash){C({txHash:k.txHash});return}C(null)},I=T=>{const k=T.detail;k?.requestId===x&&(d("dialog.sheet-closed",{requestId:x,source:"evm",reason:k?.reason??"unknown"}),N||C(null),P(k?.reason??"sheet-closed"))};window.addEventListener("miniapp-transfer-confirm",_),window.addEventListener("miniapp-transfer-sheet-closed",I),d("dialog.push",{requestId:x,source:"evm",from:m,to:u,chain:p??"ethereum"}),s("MiniappTransferConfirmJob",{requestId:x,appName:l.appName,from:m,to:u,amount:b,chain:p??"ethereum"})}),{requestId:x,source:"evm"})})}),ei(async l=>{const m=l?.app?.name,u=l?.app?.icon;return new Promise(f=>{const h=window.setTimeout(()=>f(null),3e4),g=()=>{window.clearTimeout(h),window.removeEventListener("wallet-picker-select",b),window.removeEventListener("wallet-picker-cancel",p)},b=x=>{g();const v=x.detail;f({address:v.address,chain:v.chain,name:v.name})},p=()=>{g(),f(null)};window.addEventListener("wallet-picker-select",b),window.addEventListener("wallet-picker-cancel",p),s("WalletPickerJob",{chain:"tron",...m?{appName:m}:{},...u?{appIcon:u}:{}})})}),si(l=>async m=>new Promise(u=>{const f=window.setTimeout(()=>u({approved:!1}),6e4),h=g=>{window.clearTimeout(f);const b=g.detail;if(b?.approved&&b.patternKey&&b.walletId){u({approved:!0,patternKey:b.patternKey,walletId:b.walletId,selectedDuration:b.selectedDuration});return}u({approved:!1})};window.addEventListener("crypto-authorize-confirm",h,{once:!0}),s("CryptoAuthorizeJob",{actions:Qt.stringify(m.actions),duration:m.duration,address:m.address,chainId:m.chainId,appName:m.app.name,appIcon:m.app.icon})})),()=>{Hr().setPermissionRequestCallback(null),Ur(null),Yr(null),ti(null),Xr(null),Zr(null),ei(null),si(null),Vr(null),Jr(null),Kr(null),Gr(null),Qr(null)}},[s]),e.jsx(le,{children:e.jsx(bm,{children:e.jsxs("div",{className:"bg-background relative h-dvh",children:[e.jsx(c.Activity,{mode:n==="wallet"?"visible":"hidden",children:e.jsx(Sl,{})}),e.jsx("div",{style:{display:n==="ecosystem"?"contents":"none"},children:e.jsx(Al,{})}),e.jsx(c.Activity,{mode:n==="settings"?"visible":"hidden",children:e.jsx(vd,{})}),e.jsx(fm,{activeTab:n,onTabChange:a})]})})})};yd.__docgenInfo={description:"",methods:[],displayName:"MainTabsActivity"};function bd(){const{t}=O("wallet"),{navigate:s,goBack:n}=de(),{push:a}=Z(),r=Ae(Re,u=>u.wallets),o=Ae(Re,u=>u.currentWalletId),d=c.useCallback(u=>{ye.setCurrentWallet(u)},[]),i=c.useCallback(u=>{s({to:`/wallet/${u}`})},[s]),l=c.useCallback(()=>{a("WalletAddJob",{})},[a]),m=c.useCallback(()=>{n()},[n]);return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(K,{title:t("list.title"),onBack:m,rightAction:e.jsx("button",{onClick:l,className:L("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":t("add"),children:e.jsx(ut,{className:"size-5"})})}),e.jsx("div",{className:"flex-1 p-4",children:r.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[e.jsx("p",{className:"text-muted-foreground",children:t("list.empty")}),e.jsx("button",{onClick:l,className:L("bg-primary rounded-full px-6 py-2.5 text-sm font-medium text-primary-foreground","hover:bg-primary/90 active:bg-primary/80"),children:t("add")})]}):e.jsx("div",{className:"space-y-3",children:r.map(u=>e.jsx(By,{wallet:u,isActive:u.id===o,onSelect:()=>d(u.id),onDetail:()=>i(u.id),t},u.id))})})]})}function By({wallet:t,isActive:s,onSelect:n,onDetail:a,t:r}){return e.jsxs("div",{className:L("bg-card rounded-xl p-4 shadow-sm transition-colors",s&&"ring-primary ring-2"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:n,className:L("flex size-12 items-center justify-center rounded-full text-lg font-semibold",s?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),children:t.name.slice(0,1)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"truncate font-semibold",children:t.name}),s&&e.jsxs("span",{className:"text-primary flex items-center gap-1 text-xs",children:[e.jsx(je,{className:"size-3"}),r("list.current")]})]}),e.jsx("p",{className:"text-muted-foreground text-sm",children:r("list.chainAddresses",{count:t.chainAddresses.length})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-semibold",children:["$",0 .toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})}),e.jsx("button",{onClick:a,className:L("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":r("list.viewDetail"),children:e.jsx(Le,{className:"text-muted-foreground size-5"})})]})]}),e.jsx("p",{className:"text-muted-foreground mt-2 truncate font-mono text-xs",children:t.address})]})}bd.__docgenInfo={description:"",methods:[],displayName:"WalletListPage"};const jd=()=>e.jsx(le,{children:e.jsx(bd,{})});jd.__docgenInfo={description:"",methods:[],displayName:"WalletListActivity"};function Fy(){const{t}=O("wallet"),{walletId:s,mode:n="default"}=he(),{goBack:a,navigate:r}=de(),d=Mt().find(m=>m.id===s),i=()=>{r({to:"/",replace:!0})};if(!d)return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:t("detail.title"),onBack:a}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(Gt,{variant:"error",children:t("detail.notFound")})})]});const l=t(n==="edit-only"?"detail.editTitle":"detail.title");return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:l,...n!=="edit-only"&&{onBack:a}}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsx(Xn,{mode:n,walletId:s,onEditOnlyComplete:i}),n==="default"&&e.jsx("div",{className:"mt-6",children:e.jsx(Gt,{variant:"warning",children:t("detail.securityWarning")})})]})]})}const Nd=({params:t})=>e.jsx(le,{children:e.jsx(me,{params:t,children:e.jsx(Fy,{})})});Nd.__docgenInfo={description:"",methods:[],displayName:"WalletConfigActivity"};const Wy=["pattern","mnemonic","verify","chains","theme"];function wd(){const{goBack:t,navigate:s}=de(),{t:n}=O("onboarding"),a=Ys(),r=es(),[o,d]=c.useState("pattern"),[i,l]=c.useState(""),[m]=c.useState(()=>{if(typeof window<"u"){const w=window.__E2E_MNEMONIC__;if(typeof w=="string"&&w.trim())return w.trim().split(/\s+/);if(Array.isArray(w)&&w.every(E=>typeof E=="string"))return w}return pm()}),[u,f]=c.useState(!0),[h,g]=c.useState(!1),[b,p]=c.useState([]),[x,v]=c.useState(!1),[j,N]=c.useState(!1),[y,S]=c.useState(null),C=Wy.indexOf(o)+1;c.useEffect(()=>{!x&&a.length>0&&(p(Go(a)),v(!0))},[a,x]);const P=()=>{o==="mnemonic"?(d("pattern"),l("")):o==="verify"?d("mnemonic"):o==="chains"?d("verify"):o==="theme"||t()},_=w=>{l(w),d("mnemonic")},I=()=>{(h||!u)&&d("verify")},T=()=>{d("chains")},k=async()=>{if(!j){N(!0);try{const w=m.join(" "),D=(await Qo({mnemonic:w,selectedChainIds:b,chainConfigs:a})).map(({chainId:M,address:B,publicKey:G})=>({chain:M,address:B,publicKey:G??"",tokens:[]})),z=D[0];if(!z)throw new Error("No chain addresses derived");const R=wa(z.address),V=await ye.createWallet({name:n("create.generatedNamePattern",{word:Tn(r),suffix:n("create.walletSuffix")}),keyType:"mnemonic",address:z.address,chain:z.chain,chainAddresses:D,themeHue:R},w,i,R);S(V.id),d("theme")}catch{}finally{N(!1)}}},A=()=>{s({to:"/",replace:!0})};return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:n("create.title"),onBack:P}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(bt,{total:5,current:C})}),e.jsxs("div",{className:"flex-1 p-4",children:[o==="pattern"&&e.jsx("div",{"data-testid":"pattern-step",children:e.jsx(lr,{onComplete:_,minPoints:4})}),o==="mnemonic"&&e.jsx("div",{"data-testid":"mnemonic-step",children:e.jsx($y,{mnemonic:m,hidden:u,copied:h,onToggleHidden:()=>f(!u),onCopy:()=>g(!0),onContinue:I})}),o==="verify"&&e.jsx("div",{"data-testid":"verify-step",children:e.jsx(qy,{mnemonic:m,onContinue:T})}),o==="chains"&&e.jsx("div",{"data-testid":"chain-selector-step",children:e.jsx(Hy,{chains:a,selectedChains:b,selectionCount:b.length,onSelectionChange:p,onComplete:k,completeLabel:n("create.nextStep"),isSubmitting:j})}),o==="theme"&&y&&e.jsx("div",{"data-testid":"theme-step",children:e.jsx(Xn,{mode:"edit-only",walletId:y,onEditOnlyComplete:A})})]})]})}function $y({mnemonic:t,hidden:s,copied:n,onToggleHidden:a,onCopy:r,onContinue:o}){const{t:d}=O("onboarding"),i=n||!s;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Zs,{icon:e.jsx(mr,{className:"size-full"}),variant:"warning",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:d("create.backupMnemonic")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:d("create.backupHint")})]}),e.jsx(Gt,{variant:"warning",children:d("create.mnemonicWarning")}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:d("create.mnemonicTitle")}),e.jsxs("button",{type:"button","data-testid":"toggle-mnemonic-button",onClick:a,className:"text-primary flex items-center gap-1 text-sm",children:[s?e.jsx(cr,{className:"size-4"}):e.jsx(Yo,{className:"size-4"}),d(s?"create.mnemonicShow":"create.mnemonicHide")]})]}),e.jsx(Ko,{words:t,hidden:s,onCopy:r})]}),e.jsxs(Ue,{variant:"mint",className:"w-full","data-testid":"mnemonic-backed-up-button",disabled:!i,onClick:o,children:[d(i?"create.mnemonicBackedUp":"create.mnemonicViewFirst"),i&&e.jsx(Le,{className:"ml-2 size-4"})]})]})}function qy({mnemonic:t,onContinue:s}){const{t:n}=O(["onboarding","common"]),[a]=c.useState(()=>Array.from({length:t.length},(f,h)=>h).toSorted(()=>Math.random()-.5).slice(0,3).toSorted((f,h)=>f-h)),[r,o]=c.useState({}),d=a.every(m=>{const u=t[m],f=r[m];return u&&f&&f.toLowerCase()===u.toLowerCase()}),i=(m,u)=>{o(f=>({...f,[m]:u}))},l=m=>{const u=t[m],f=r[m];if(f&&u&&f.toLowerCase()!==u.toLowerCase())return n("create.wordIncorrect")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Zs,{icon:e.jsx(Ns,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:n("create.verifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("create.verifyDesc")})]}),e.jsx("div",{className:"space-y-4",children:a.map(m=>e.jsx(Bm,{label:n("create.wordN",{n:m+1}),error:l(m),children:e.jsx(Ve,{"data-testid":`verify-word-input-${m}`,"data-verify-index":m,value:r[m]||"",onChange:u=>i(m,u.target.value),className:L(l(m)&&"border-destructive focus-visible:ring-destructive"),placeholder:n("create.wordNPlaceholder",{n:m+1}),autoCapitalize:"off",autoCorrect:"off"})},m))}),e.jsx(Ue,{variant:"mint",className:"w-full","data-testid":"verify-next-button",disabled:!d,onClick:s,children:n("common:next")})]})}function Hy({chains:t,selectedChains:s,selectionCount:n,isSubmitting:a,completeLabel:r,onSelectionChange:o,onComplete:d}){const{t:i}=O(["onboarding","common"]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Zs,{icon:e.jsx(Ns,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:i("chainSelector.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:i("chainSelector.subtitle")})]}),t.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(Te,{})}):e.jsx(dr,{"data-testid":"chain-selector",chains:t,selectedChains:s,onSelectionChange:o}),e.jsx(Ue,{variant:"mint",className:"w-full","data-testid":"chain-selector-complete-button",disabled:n===0||a,onClick:d,children:r})]})}wd.__docgenInfo={description:"",methods:[],displayName:"WalletCreatePage"};const kd=()=>e.jsx(le,{children:e.jsx(wd,{})});kd.__docgenInfo={description:"",methods:[],displayName:"WalletCreateActivity"};function Uy(t,s){return{symbol:t.symbol,name:t.name,balance:t.amount.toFormatted(),decimals:t.decimals,fiatValue:void 0,chain:s,icon:t.icon,change24h:0,contractAddress:t.contractAddress}}function Cd(t,s){return t.map(n=>Uy(n,s))}const Vy={ETH:{amount:"0.002",symbol:"ETH"},USDT:{amount:"0.003",symbol:"ETH"},USDC:{amount:"0.003",symbol:"ETH"},BTC:{amount:"0.0001",symbol:"BTC"},TRX:{amount:"1",symbol:"TRX"},BFM:{amount:"0.1",symbol:"BFM"}},mo={step:"input",asset:null,toAddress:"",amount:null,addressError:null,amountError:null,feeAmount:null,feeMinAmount:null,feeSymbol:"",feeLoading:!1,isSubmitting:!1,resultStatus:null,txHash:null,errorMessage:null},ze=we.t.bind(we);async function Jy(t,s){const n=Pe(t.id);if(!n.supportsFeeEstimate||!n.supportsBuildTransaction)throw new Error(`Chain ${t.id} does not support fee estimation`);const a=await n.buildTransaction({type:"transfer",from:s,to:s,amount:oe.fromRaw("1",t.decimals,t.symbol)});return{amount:(await n.estimateFee(a)).standard.amount,symbol:t.symbol}}async function Ky({chainConfig:t,walletId:s,password:n,fromAddress:a,toAddress:r,amount:o}){let d;try{d=await gs.getMnemonic(s,n)}catch(i){return i instanceof Gs&&i.code===vs.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:i instanceof Error?i.message:ze("error:transaction.unknownError")}}if(!o.isPositive())return{status:"error",message:ze("error:validation.enterValidAmount")};try{const i=Pe(t.id);if(!i.supportsFullTransaction)return{status:"error",message:ze("error:transaction.chainNotSupported",{chainId:t.id})};const l=Sm(d),m=await i.buildTransaction({type:"transfer",from:a,to:r,amount:o}),u=await i.signTransaction(m,{privateKey:l});return{status:"ok",txHash:await i.broadcastTransaction(u)}}catch(i){const l=i instanceof Error?i.message:String(i);return l.includes("insufficient")||l.includes("balance")?{status:"error",message:ze("error:insufficientFunds")}:l.includes("fee")||l.includes("gas")?{status:"error",message:ze("error:transaction.insufficientGas")}:l.includes("not yet implemented")||l.includes("not supported")?{status:"error",message:ze("error:chain.transferNotImplemented")}:{status:"error",message:l||ze("error:transaction.failed")}}}function Gy(t,s){const n=Pe(t.id);return n.supportsAddressValidation?!s||s.trim()===""?ze("error:validation.enterRecipientAddress"):n.isValidAddress(s)?!s||s.trim()===""?ze("error:validation.enterReceiverAddress"):n.isValidAddress(s)?null:ze("error:validation.invalidAddress"):ze("error:validation.invalidAddressFormat"):ze("error:validation.unsupportedChainType")}const et=we.t.bind(we);function Sd(t,s){return t.trim()?s?If(t):Dm(t):!1}function Qy(t,s,n){return t.trim()?Sd(t,s)?s&&n&&t.trim()===n.trim()?et("error:validation.cannotTransferToSelf"):null:et("error:validation.invalidAddressFormat"):et("error:validation.enterRecipientAddress")}function Yy(t,s){return t?s?t.isPositive()?t.gt(s.amount)?et("error:insufficientFunds"):null:et("error:validation.enterValidAmount"):null:et("error:validation.enterAmount")}function Xy(t){const{toAddress:s,amount:n,asset:a,isBioforestChain:r,feeAmount:o,feeLoading:d}=t;return!a||!n||d||!o?!1:s.trim()!==""&&Sd(s,r)&&n.isPositive()&&n.lte(a.amount)}function Ad(t,s,n){if(!t)return{status:"error",message:et("error:validation.enterValidAmount")};const a=s.amount;if(s.assetType===n.symbol){if(t.add(n).lte(a))return{status:"ok"};if(!t.eq(a))return{status:"error",message:et("error:insufficientFunds")};const o=a.sub(n);return o.isPositive()?{status:"ok",adjustedAmount:o}:{status:"error",message:et("error:insufficientFunds")}}else return t.lte(a)?{status:"ok"}:{status:"error",message:et("error:insufficientFunds")}}const fo=we.t.bind(we);async function Zy(t){t(s=>({...s,step:"sending",isSubmitting:!0}));try{if(await new Promise(n=>setTimeout(n,2e3)),Math.random()>.2)return t(n=>({...n,step:"result",isSubmitting:!1,resultStatus:"success",txHash:`0x${Math.random().toString(16).slice(2)}${Math.random().toString(16).slice(2)}`,errorMessage:null})),{status:"ok"};throw new Error(fo("error:transaction.transactionFailed"))}catch(s){return t(n=>({...n,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:s instanceof Error?s.message:fo("error:transaction.unknownError")})),{status:"error"}}}const Ge=we.t.bind(we);function eb(t={}){const{initialAsset:s,useMock:n=!0,walletId:a,fromAddress:r,chainConfig:o,getBalance:d}=t,[i,l]=c.useState({...mo,asset:s??null}),m=c.useRef(null),u=o?.chainKind==="bioforest",f=o?.chainKind==="evm"||o?.chainKind==="tron"||o?.chainKind==="bitcoin",h=c.useCallback(T=>f&&o?Gy(o,T):Qy(T,u,r),[u,f,o,r]),g=c.useCallback((T,k)=>Yy(T,k),[]),b=c.useCallback(T=>{l(k=>({...k,toAddress:T,addressError:null}))},[]),p=c.useCallback(T=>{l(k=>({...k,amount:T,amountError:null}))},[]),x=c.useCallback(T=>{l(k=>{if(!k.feeAmount)return k;const A=oe.fromFormatted(T,k.feeAmount.decimals,k.feeAmount.symbol);return{...k,feeAmount:A}})},[]),v=c.useCallback(T=>{if(l(A=>({...A,asset:T,feeLoading:!0})),n||!u&&!f||!o||!r){setTimeout(()=>{const A=Vy[T.assetType]??{amount:"0.001",symbol:T.assetType},w=oe.fromFormatted(A.amount,T.decimals,A.symbol);l(E=>({...E,feeAmount:w,feeMinAmount:w,feeSymbol:A.symbol,feeLoading:!1}))},300);return}(async()=>{try{const A=f?await Jy(o,r):await jv(o,r);l(w=>({...w,feeAmount:A.amount,feeMinAmount:A.amount,feeSymbol:A.symbol,feeLoading:!1}))}catch(A){l(w=>({...w,feeLoading:!1,errorMessage:A instanceof Error?A.message:Ge("error:transaction.feeEstimateFailed")}))}})()},[o,r,u,f,n]);c.useEffect(()=>{if(!i.asset||i.feeLoading)return;const T=`${o?.id??"unknown"}:${r??""}:${i.asset.assetType}`,k=m.current!==T;k&&(m.current=T),!(!k&&i.feeAmount)&&(!k&&!i.feeAmount||v(i.asset))},[o?.id,r,v,i.asset,i.feeAmount,i.feeLoading]);const j=c.useMemo(()=>!i.asset?.assetType||!d?i.asset?.amount??null:d(i.asset.assetType)??i.asset?.amount??null,[i.asset?.assetType,i.asset?.amount,d]),N=c.useMemo(()=>!i.asset||!j?i.asset:j.decimals===i.asset.decimals?{...i.asset,amount:j}:{...i.asset,amount:j,decimals:j.decimals},[i.asset,j]),y=c.useMemo(()=>Xy({toAddress:i.toAddress,amount:i.amount,asset:N,isBioforestChain:u,feeAmount:i.feeAmount,feeLoading:i.feeLoading}),[u,i.amount,N,i.toAddress,i.feeAmount,i.feeLoading]),S=c.useCallback(()=>{const T=h(i.toAddress),k=N?g(i.amount,N):Ge("error:validation.selectAsset");if(T||k)return l(A=>({...A,addressError:T,amountError:k})),!1;if(N&&i.feeAmount&&i.amount){const A=Ad(i.amount,N,i.feeAmount);if(A.status==="error")return l(w=>({...w,amountError:A.message})),!1;A.adjustedAmount&&l(w=>({...w,amount:A.adjustedAmount??w.amount}))}return l(A=>({...A,step:"confirm",addressError:null,amountError:null})),!0},[i.toAddress,i.amount,N,i.feeAmount,h,g]),C=c.useCallback(()=>{l(T=>({...T,step:"input"}))},[]),P=c.useCallback(async T=>{if(n)return(await Zy(l)).status==="ok"?{status:"ok"}:{status:"error",message:Ge("transaction:broadcast.unknown")};if(!o)return l(E=>({...E,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:Ge("error:transaction.chainConfigMissing")})),{status:"error"};if(o.chainKind==="evm"||o.chainKind==="tron"||o.chainKind==="bitcoin"){if(!a||!r||!i.asset||!i.amount)return l(D=>({...D,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:Ge("error:transaction.walletInfoIncomplete")})),{status:"error"};l(D=>({...D,step:"sending",isSubmitting:!0,errorMessage:null}));const E=await Ky({chainConfig:o,walletId:a,password:T,fromAddress:r,toAddress:i.toAddress,amount:i.amount});return E.status==="password"?(l(D=>({...D,step:"confirm",isSubmitting:!1})),{status:"password"}):E.status==="error"?(l(D=>({...D,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:E.message})),{status:"error"}):(l(D=>({...D,step:"result",isSubmitting:!1,resultStatus:"success",txHash:E.txHash,errorMessage:null})),{status:"ok",txHash:E.txHash})}if(o.chainKind!=="bioforest")return l(E=>({...E,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:Ge("error:transaction.unsupportedChainType",{chainType:o.chainKind})})),{status:"error"};if(!a||!r||!i.asset)return l(E=>({...E,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:Ge("error:wallet.incompleteInfo")})),{status:"error"};const k=h(i.toAddress),A=g(i.amount,i.asset);if(k||A)return l(E=>({...E,addressError:k,amountError:A})),{status:"error"};if(l(E=>({...E,step:"sending",isSubmitting:!0,errorMessage:null})),!i.amount)return l(E=>({...E,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:Ge("error:transaction.invalidAmount")})),{status:"error"};const w=await Yi({chainConfig:o,walletId:a,password:T,fromAddress:r,toAddress:i.toAddress,amount:i.amount,assetType:i.asset.assetType,fee:i.feeAmount??void 0});return w.status==="password"?(l(E=>({...E,step:"confirm",isSubmitting:!1})),{status:"password"}):w.status==="password_required"?(l(E=>({...E,step:"confirm",isSubmitting:!1})),{status:"two_step_secret_required",secondPublicKey:w.secondPublicKey}):w.status==="error"?(l(E=>({...E,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:w.message})),{status:"error",message:w.message,pendingTxId:w.pendingTxId}):(l(E=>({...E,step:"result",isSubmitting:!1,resultStatus:"success",txHash:w.txHash,errorMessage:null})),{status:"ok",txHash:w.txHash,pendingTxId:w.pendingTxId})},[o,r,i.amount,i.asset,i.toAddress,n,h,g,a]),_=c.useCallback(async(T,k)=>{if(!o||!a||!r)return{status:"error"};if(l(w=>({...w,step:"sending",isSubmitting:!0,resultStatus:null,txHash:null,errorMessage:null})),!i.amount||!i.asset)return l(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:Ge("error:transaction.invalidAmount")})),{status:"error"};const A=await Yi({chainConfig:o,walletId:a,password:T,fromAddress:r,toAddress:i.toAddress,amount:i.amount,assetType:i.asset.assetType,fee:i.feeAmount??void 0,twoStepSecret:k});return A.status==="password"?(l(w=>({...w,step:"confirm",isSubmitting:!1})),{status:"password"}):A.status==="error"?(l(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:A.message})),{status:"error",message:A.message,pendingTxId:A.pendingTxId}):A.status==="password_required"?(l(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:Ge("error:transaction.securityPasswordFailed")})),{status:"error"}):(l(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"success",txHash:A.txHash,errorMessage:null})),{status:"ok",txHash:A.txHash,pendingTxId:A.pendingTxId})},[o,r,i.amount,i.toAddress,a]),I=c.useCallback(()=>{l({...mo,asset:s??null})},[s]);return{state:i,setToAddress:b,setAmount:p,setAsset:v,setFee:x,goToConfirm:S,goBack:C,submit:P,submitWithTwoStepSecret:_,reset:I,canProceed:y}}function tb(){const{t}=O(["transaction","common","security"]),{goBack:s}=de(),{push:n}=Z(),a=st(),r=an(),o=c.useRef(!1),{address:d,amount:i,assetType:l,assetLocked:m}=he(),u=m==="true",f=Je(),h=Fe(),g=Jn(),b=dt(),p=b.snapshot?He.getChainById(b,f):null,x=Qa(f),j=rs().tokenBalances.useState({address:g?.address??""},{enabled:!!g?.address}),N=c.useMemo(()=>j?.data?Cd(j.data,f):[],[j?.data,f]),y=c.useMemo(()=>{if(!p)return null;if(l){const Q=N.find(ae=>ae.symbol.toUpperCase()===l.toUpperCase());return Q?{assetType:Q.symbol,name:Q.name,amount:oe.fromFormatted(Q.balance,Q.decimals??p.decimals,Q.symbol),decimals:Q.decimals??p.decimals,logoUrl:Q.icon}:null}const H=N.find(Q=>Q.symbol===p.symbol)?.balance??"0";return{assetType:p.symbol,name:p.name,amount:oe.fromFormatted(H,p.decimals,p.symbol),decimals:p.decimals}},[p,N,l]),S=c.useCallback(q=>{const H=N.find(Q=>Q.symbol===q);return H?oe.fromFormatted(H.balance,H.decimals??p?.decimals??8,H.symbol):null},[N,p?.decimals]),{state:C,setToAddress:P,setAmount:_,setAsset:I,setFee:T,goToConfirm:k,submit:A,submitWithTwoStepSecret:w,canProceed:E}=eb({initialAsset:y??void 0,useMock:!1,walletId:h?.id,fromAddress:g?.address,chainConfig:p,getBalance:S}),D=c.useMemo(()=>{if(!C.asset)return null;const q=S(C.asset.assetType);return{symbol:C.asset.assetType,name:C.asset.name??C.asset.assetType,balance:q?.toFormatted()??C.asset.amount.toFormatted(),decimals:C.asset.decimals,chain:f,icon:C.asset.logoUrl}},[C.asset,f,S]),z=c.useCallback(q=>{const H={assetType:q.symbol,name:q.name,amount:oe.fromFormatted(q.balance,q.decimals??p?.decimals??8,q.symbol),decimals:q.decimals??p?.decimals??8,logoUrl:q.icon};I(H)},[p?.decimals,I]),R=c.useRef(!1);c.useEffect(()=>{y&&!R.current&&!C.asset&&(I(y),R.current=!0)},[y,I,C.asset]),c.useEffect(()=>{if(d&&!C.toAddress&&P(d),i&&!C.amount&&C.asset){const q=oe.tryFromFormatted(i,C.asset.decimals,C.asset.assetType);q&&_(q)}},[d,i,C.toAddress,C.amount,C.asset,P,_]),c.useEffect(()=>{const q=H=>{P(H.detail.address.address)};return window.addEventListener("contact-picker-select",q),()=>window.removeEventListener("contact-picker-select",q)},[P]),c.useEffect(()=>{if(C.resultStatus==="success"&&C.toAddress){const q=Ka.getContactByAddress(zs.state,C.toAddress);q&&Un.trackRecentContact(q.contact.id)}},[C.resultStatus,C.toAddress]);const V=c.useCallback(()=>{n("ContactPickerJob",{chainType:f})},[n,f]),M=c.useMemo(()=>C.asset?S(C.asset.assetType):null,[S,C.asset]),B=C.asset?.assetType??"TOKEN",G=C.feeSymbol||p?.symbol,ee=!!G&&G===B,W=c.useMemo(()=>{if(!C.asset||!M)return;if(!C.feeAmount)return M;const q={...C.asset,amount:M,decimals:M.decimals},H=Ad(M,q,C.feeAmount);return H.status==="ok"?H.adjustedAmount??M:oe.zero(M.decimals,q.assetType)},[M,C.asset,C.feeAmount]),F=ee&&(!C.feeAmount||C.feeLoading),ie=c.useCallback(()=>{kf(({content:q,parsed:H})=>{let Q=q;H.type==="address"||H.type==="payment"?Q=H.address:H.type==="contact"&&H.addresses.length>0&&(Q=H.addresses[0].address),P(Q),r.impact("success"),a.show(t("sendPage.scanSuccess"))}),n("ScannerJob",{chainType:x??f})},[n,f,x,P,r,a,t]),ne=()=>{k()&&(r.impact("light"),Ul(async()=>{o.current||(o.current=!0,await r.impact("medium"),Jl(async(q,H)=>{if(!H){const ae=await A(q);return ae.status==="password"?{status:"wallet_lock_invalid"}:ae.status==="two_step_secret_required"?{status:"two_step_secret_required"}:ae.status==="ok"?(o.current=!1,{status:"ok",txHash:ae.txHash,pendingTxId:ae.pendingTxId}):ae.status==="error"?{status:"error",message:ae.message??t("transaction:broadcast.unknown"),pendingTxId:ae.pendingTxId}:{status:"error",message:t("transaction:broadcast.unknown")}}const Q=await w(q,H);return Q.status==="ok"?(o.current=!1,{status:"ok",txHash:Q.txHash,pendingTxId:Q.pendingTxId}):Q.status==="password"?{status:"two_step_secret_invalid",message:t("error:transaction.securityPasswordWrong")}:Q.status==="error"?{status:"error",message:Q.message??t("transaction:broadcast.unknown"),pendingTxId:Q.pendingTxId}:{status:"error",message:t("transaction:broadcast.unknown")}}),n("TransferWalletLockJob",{title:t("security:walletLock.verifyTitle")}))},{minFee:C.feeMinAmount?.toFormatted()??C.feeAmount?.toFormatted()??"0",onFeeChange:T}),n("TransferConfirmJob",{amount:C.amount?.toFormatted()??"0",symbol:B,toAddress:C.toAddress,feeAmount:C.feeAmount?.toFormatted()??"0",feeSymbol:C.feeSymbol,feeLoading:C.feeLoading?"true":"false"}))};return!h||!g?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:t("sendPage.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("history.noWallet")})})]}):e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:t("sendPage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"bg-muted/50 space-y-2 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(Et,{chain:f,size:"sm"}),e.jsx("span",{className:"text-sm font-medium",children:x})]}),g?.address&&e.jsxs("div",{className:"text-muted-foreground flex items-center justify-center gap-1 text-xs",children:[e.jsxs("span",{children:[t("sendPage.from"),":"]}),e.jsxs("span",{className:"font-mono",children:[g.address.slice(0,8),"...",g.address.slice(-6)]})]})]}),N.length>1&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("sendPage.assetLabel")}),e.jsx(Ho,{selectedAsset:D,assets:N,onSelect:z,disabled:u,testId:"send-asset-selector"})]}),e.jsx(zm,{label:t("sendPage.toAddressLabel"),value:C.toAddress,onChange:P,placeholder:t("sendPage.toAddressPlaceholder",{chain:x}),onScan:ie,onContactPicker:V,chainType:f,error:C.addressError??void 0}),e.jsx(Xo,{label:t("sendPage.amountLabel"),value:C.amount??void 0,onChange:_,balance:M??void 0,max:W,maxDisabled:F,symbol:B,error:C.amountError??void 0,fiatValue:C.amount?C.amount.toNumber().toFixed(2):void 0}),e.jsxs("div",{className:"text-muted-foreground flex items-center justify-between text-xs",children:[e.jsx("span",{children:t("sendPage.fee")}),e.jsx("span",{children:C.feeLoading?t("sendPage.feeEstimating"):C.feeAmount?`${C.feeAmount.toFormatted()} ${C.feeSymbol||B}`:t("sendPage.feeUnavailable")})]}),e.jsx(Gt,{variant:"info",children:t("sendPage.networkWarning",{chain:x})}),e.jsx("div",{className:"pt-4",children:e.jsxs(Ue,{variant:"mint",className:"w-full","data-testid":"send-continue-button",disabled:!E,onClick:ne,children:[t("sendPage.continue"),e.jsx(Le,{className:"-mr-4 ml-2 size-4"})]})})]})]})}function Id(){const{goBack:t}=de(),s=Je(),{t:n}=O(["transaction","common"]);return e.jsx(Dt,{chainId:s,fallback:e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:n("sendPage.title"),onBack:t}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Chain not supported"})})]}),children:e.jsx(tb,{})})}Id.__docgenInfo={description:"",methods:[],displayName:"SendPage"};const Td=({params:t})=>e.jsx(le,{children:e.jsx(me,{params:t,children:e.jsx(Do,{children:e.jsx(Id,{})})})});Td.__docgenInfo={description:"",methods:[],displayName:"SendActivity"};const Ye=we.t.bind(we),po={step:"input",asset:null,amount:null,amountError:null,recipientAddress:null,feeAmount:null,feeMinAmount:null,feeSymbol:"",feeLoading:!1,isSubmitting:!1,resultStatus:null,txHash:null,errorMessage:null},Ts={amount:"0.001",symbol:"BFM"};function sb(t,s){if(!t||!s)return null;if(!t.isPositive())return Ye("error:validation.enterValidAmount");const n=s.amount;return t.gt(n)?Ye("error:validation.exceedsBalance"):null}function nb(t={}){const{initialAsset:s,assetLocked:n=!1,useMock:a=!0,walletId:r,fromAddress:o,chainConfig:d}=t,[i,l]=c.useState({...po,asset:s??null}),m=d?.chainKind==="bioforest",u=c.useCallback((N,y)=>sb(N,y),[]),f=c.useCallback(N=>{l(y=>({...y,amount:N,amountError:null}))},[]),h=c.useCallback(N=>{if(l(S=>({...S,asset:N,amount:null,amountError:null,feeLoading:!0,recipientAddress:null})),a||!m||!d||!o){setTimeout(()=>{l(S=>({...S,recipientAddress:"mock_apply_address",feeAmount:oe.fromFormatted(Ts.amount,N.decimals,Ts.symbol),feeMinAmount:oe.fromFormatted(Ts.amount,N.decimals,Ts.symbol),feeSymbol:d?.symbol??Ts.symbol,feeLoading:!1}))},300);return}(async()=>{try{const S=await md(d,N.assetType,o);if(!S){l(P=>({...P,feeLoading:!1,errorMessage:Ye("error:transaction.issuerAddressNotFound")}));return}const C=await fd(d,N.assetType,"1");l(P=>({...P,recipientAddress:S,feeAmount:C.amount,feeMinAmount:C.amount,feeSymbol:C.symbol,feeLoading:!1}))}catch(S){l(C=>({...C,feeLoading:!1,errorMessage:S instanceof Error?S.message:Ye("error:transaction.feeEstimateFailed")}))}})()},[d,o,m,a]);c.useEffect(()=>{s&&!i.recipientAddress&&h(s)},[s,h,i.recipientAddress]);const g=c.useMemo(()=>!!(i.asset&&i.amount&&i.amount.isPositive()&&i.recipientAddress&&!i.feeLoading),[i.amount,i.asset,i.recipientAddress,i.feeLoading]),b=c.useCallback(()=>{const N=u(i.amount,i.asset);return N?(l(y=>({...y,amountError:N})),!1):i.recipientAddress?(l(y=>({...y,step:"confirm",amountError:null})),!0):(l(y=>({...y,errorMessage:Ye("error:transaction.issuerAddressNotReady")})),!1)},[i.amount,i.asset,i.recipientAddress,u]),p=c.useCallback(()=>{l(N=>({...N,step:"input"}))},[]),x=c.useCallback(async N=>{if(a)return l(S=>({...S,step:"burning",isSubmitting:!0})),await new Promise(S=>setTimeout(S,1500)),l(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"success",txHash:`mock_burn_tx_${Date.now()}`})),{status:"ok",txHash:`mock_burn_tx_${Date.now()}`};if(!d||d.chainKind!=="bioforest")return l(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:Ye("error:burn.bioforestOnly")})),{status:"error",message:Ye("error:burn.bioforestOnly")};if(!r||!o||!i.asset||!i.amount||!i.recipientAddress)return l(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:Ye("error:transaction.paramsIncomplete")})),{status:"error",message:Ye("error:transaction.paramsIncomplete")};l(S=>({...S,step:"burning",isSubmitting:!0,errorMessage:null}));const y=await Hn({chainConfig:d,walletId:r,password:N,fromAddress:o,recipientAddress:i.recipientAddress,assetType:i.asset.assetType,amount:i.amount,fee:i.feeAmount??void 0});return y.status==="password"?(l(S=>({...S,step:"confirm",isSubmitting:!1})),{status:"password"}):y.status==="password_required"?(l(S=>({...S,step:"confirm",isSubmitting:!1})),{status:"two_step_secret_required",secondPublicKey:y.secondPublicKey}):y.status==="error"?(l(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:y.message})),{status:"error",message:y.message}):(l(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"success",txHash:y.txHash})),{status:"ok",txHash:y.txHash})},[d,o,i.amount,i.asset,i.feeAmount,i.recipientAddress,a,r]),v=c.useCallback(async(N,y)=>{if(!d||!r||!o||!i.asset||!i.amount||!i.recipientAddress)return{status:"error",message:Ye("error:transaction.paramsIncomplete")};l(C=>({...C,step:"burning",isSubmitting:!0,errorMessage:null}));const S=await Hn({chainConfig:d,walletId:r,password:N,fromAddress:o,recipientAddress:i.recipientAddress,assetType:i.asset.assetType,amount:i.amount,fee:i.feeAmount??void 0,twoStepSecret:y});return S.status==="password"?(l(C=>({...C,step:"confirm",isSubmitting:!1})),{status:"password"}):S.status==="error"?(l(C=>({...C,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:S.message})),{status:"error",message:S.message}):S.status==="password_required"?(l(C=>({...C,step:"confirm",isSubmitting:!1})),{status:"two_step_secret_required",secondPublicKey:S.secondPublicKey}):(l(C=>({...C,step:"result",isSubmitting:!1,resultStatus:"success",txHash:S.txHash})),{status:"ok",txHash:S.txHash})},[d,o,i.amount,i.asset,i.feeAmount,i.recipientAddress,r]),j=c.useCallback(()=>{l({...po,asset:s??null})},[s]);return{state:i,setAmount:f,setAsset:h,goToConfirm:b,goBack:p,submit:x,submitWithTwoStepSecret:v,reset:j,canProceed:g,assetLocked:n}}function ho(t){return{assetType:t.symbol,name:t.name,amount:oe.fromFormatted(t.balance,t.decimals??8,t.symbol),decimals:t.decimals??8,logoUrl:t.icon}}function ab(t,s){return{symbol:t.assetType,name:t.name??t.assetType,balance:t.amount.toFormatted(),decimals:t.decimals,chain:s,icon:t.logoUrl}}function rb(){const{t}=O(["transaction","common","security"]),{goBack:s}=de(),{push:n}=Z(),a=st(),r=an(),o=c.useRef(!1),{assetType:d,assetLocked:i}=he(),l=Je(),m=Fe(),u=Jn(),f=dt(),h=f.snapshot?He.getChainById(f,l):null,g=Qa(l),p=rs().tokenBalances.useState({address:u?.address??""},{enabled:!!u?.address}),x=c.useMemo(()=>p?.data?Cd(p.data,l):[],[p?.data,l]),v=c.useMemo(()=>h?x.filter(G=>G.symbol.toUpperCase()!==h.symbol.toUpperCase()):[],[x,h]),j=c.useMemo(()=>{if(!d||v.length===0)return null;const G=v.find(ee=>ee.symbol.toUpperCase()===d.toUpperCase());return G?ho(G):null},[d,v]),N=i==="true",{state:y,setAmount:S,setAsset:C,goToConfirm:P,submit:_,submitWithTwoStepSecret:I,reset:T,canProceed:k}=nb({initialAsset:j??void 0,assetLocked:N,useMock:!1,walletId:m?.id,fromAddress:u?.address,chainConfig:h}),A=c.useCallback(G=>{C(ho(G))},[C]),w=c.useMemo(()=>y.asset?ab(y.asset,l):null,[y.asset,l]),E=y.asset?.amount??null,D=y.asset?.assetType??"TOKEN",z=()=>{P()&&(r.impact("light"),Ul(async()=>{o.current||(o.current=!0,await r.impact("medium"),Jl(async(G,ee)=>{if(!ee){const F=await _(G);return F.status==="password"?{status:"wallet_lock_invalid"}:F.status==="two_step_secret_required"?{status:"two_step_secret_required"}:F.status==="ok"?(o.current=!1,{status:"ok",txHash:F.txHash,pendingTxId:F.pendingTxId}):F.status==="error"?{status:"error",message:F.message,pendingTxId:F.pendingTxId}:{status:"error",message:t("error:destroy.failed")}}const W=await I(G,ee);return W.status==="ok"?(o.current=!1,{status:"ok",txHash:W.txHash,pendingTxId:W.pendingTxId}):W.status==="password"?{status:"two_step_secret_invalid",message:t("error:security.passwordInvalid")}:W.status==="error"?{status:"error",message:W.message,pendingTxId:W.pendingTxId}:{status:"error",message:t("error:unknown")}}),n("TransferWalletLockJob",{title:t("security:walletLock.verifyTitle")}))},{minFee:y.feeMinAmount?.toFormatted()??y.feeAmount?.toFormatted()??"0"}),n("TransferConfirmJob",{amount:y.amount?.toFormatted()??"0",symbol:D,toAddress:y.recipientAddress??"",feeAmount:y.feeAmount?.toFormatted()??"0",feeSymbol:y.feeSymbol,feeLoading:y.feeLoading?"true":"false"}))},R=()=>{y.resultStatus==="success"&&r.impact("success"),s()},V=()=>{T()},M=c.useCallback(()=>{if(!y.txHash)return;const G=h?.explorer?.queryTx;if(!G){a.show(t("sendPage.explorerNotImplemented"));return}const ee=G.replace(":hash",y.txHash).replace(":signature",y.txHash);window.open(ee,"_blank","noopener,noreferrer")},[y.txHash,h?.explorer?.queryTx,a,t]),B=h?.chainKind==="bioforest";return!m||!u?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:t("destroyPage.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("history.noWallet")})})]}):B?y.step==="result"||y.step==="burning"?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:t("destroyPage.resultTitle")}),e.jsx(Lf,{status:y.step==="burning"?"pending":y.resultStatus??"pending",amount:y.amount?.toFormatted()??"0",symbol:D,toAddress:y.recipientAddress??"",txHash:y.txHash??void 0,errorMessage:y.errorMessage??void 0,onDone:R,onRetry:y.resultStatus==="failed"?V:void 0,onViewExplorer:y.resultStatus==="success"&&h?.explorer?.queryTx?M:void 0})]}):e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:t("destroyPage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"bg-muted/50 space-y-2 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(Et,{chain:l,size:"sm"}),e.jsx("span",{className:"text-sm font-medium",children:g})]}),u?.address&&e.jsxs("div",{className:"text-muted-foreground flex items-center justify-center gap-1 text-xs",children:[e.jsxs("span",{children:[t("sendPage.from"),":"]}),e.jsxs("span",{className:"font-mono",children:[u.address.slice(0,8),"...",u.address.slice(-6)]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("destroyPage.assetLabel")}),e.jsx(Ho,{selectedAsset:w,assets:v,onSelect:A,disabled:N,excludeAssets:h?[h.symbol]:[],testId:"destroy-asset-selector"}),v.length===0&&e.jsx("p",{className:"text-muted-foreground text-xs",children:t("destroyPage.noDestroyableAssets")})]}),y.asset&&e.jsx(Xo,{label:t("destroyPage.amountLabel"),value:y.amount??void 0,onChange:S,balance:E??void 0,symbol:D,error:y.amountError??void 0}),e.jsx(Gt,{variant:"warning",children:t("destroyPage.warning")}),y.feeAmount&&e.jsx("div",{className:"bg-muted/50 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:t("sendPage.fee")}),e.jsxs("span",{className:"font-medium",children:[y.feeAmount.toFormatted()," ",y.feeSymbol]})]})}),e.jsx("div",{className:"pt-4",children:e.jsxs(Ue,{variant:"mint",className:"w-full","data-testid":"destroy-confirm-button",disabled:!k,onClick:z,children:[e.jsx(Sn,{className:"mr-2 -ml-4 size-4"}),t("destroyPage.confirm")]})})]})]}):e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:t("destroyPage.title"),onBack:s}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx(Sn,{className:"text-muted-foreground size-16"}),e.jsx("p",{className:"text-muted-foreground text-center",children:t("destroyPage.notSupported")})]})]})}function Pd(){const{goBack:t}=de(),s=Je(),{t:n}=O(["transaction","common"]);return e.jsx(Dt,{chainId:s,fallback:e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:n("destroyPage.title"),onBack:t}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Chain not supported"})})]}),children:e.jsx(rb,{})})}Pd.__docgenInfo={description:"",methods:[],displayName:"DestroyPage"};const Ed=({params:t})=>e.jsx(le,{children:e.jsx(me,{params:t,children:e.jsx(Do,{children:e.jsx(Pd,{})})})});Ed.__docgenInfo={description:"",methods:[],displayName:"DestroyActivity"};function _d(){const{t}=O(["transaction","common"]),{goBack:s}=de(),n=fr(),a=st(),r=an(),o=Jn(),d=Je(),i=Qa(d),l=Ga(),[m,u]=c.useState(!1),[f,h]=c.useState(!1),g=c.useRef(null),b=o?.address||"",p=l.username||t("common:myCard.defaultName"),x=c.useMemo(()=>b?nr({name:p,addresses:[{address:b,label:i}],avatar:l.avatar}):"",[p,b,i,l.avatar]),v=async()=>{b&&(await n.write({text:b}),await r.impact("light"),u(!0),a.show(t("receivePage.addressCopied")),setTimeout(()=>u(!1),2e3))},j=c.useCallback(async()=>{const y=g.current;if(!(!y||f)){h(!0);try{const{snapdom:S}=await Pt(async()=>{const{snapdom:C}=await import("./snapdom-CO8q8LPW.js").then(P=>P.s);return{snapdom:C}},__vite__mapDeps([0,1]),import.meta.url);await S.download(y,{type:"png",filename:`receive-${d}-${b.slice(0,8)}.png`,scale:2,quality:1}),await r.impact("success"),a.show(t("receivePage.imageSaved"))}catch{}finally{h(!1)}}},[b,d,f,r,a,t]),N=c.useCallback(async()=>{const y=g.current;if(!(!y||f)){h(!0);try{if(navigator.share){const{snapdom:S}=await Pt(async()=>{const{snapdom:I}=await import("./snapdom-CO8q8LPW.js").then(T=>T.s);return{snapdom:I}},__vite__mapDeps([0,1]),import.meta.url),P=await(await S(y,{scale:2})).toBlob(),_=new File([P],`receive-${d}.png`,{type:"image/png"});await navigator.share({title:t("receivePage.shareTitle"),text:b,files:[_]}),await r.impact("success")}}catch{}finally{h(!1)}}},[b,d,f,r,t]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("receivePage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"text-muted-foreground flex items-center justify-center gap-2",children:[e.jsx(Et,{chain:d,size:"sm"}),e.jsx("span",{className:"text-sm",children:i})]}),e.jsx("div",{ref:g,className:"flex justify-center",children:e.jsx(rr,{name:p,avatar:l.avatar,addresses:[{address:b,label:i}],qrContent:x,caption:t("common:contactCard.transferToMe")})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm font-medium",children:t("receivePage.receiveAddress")}),e.jsx("div",{className:"border-border bg-card rounded-xl border p-4",children:e.jsx(it,{address:b,copyable:!0})})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(J,{variant:"outline",className:"flex-1",onClick:v,children:m?e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"mr-2 size-4"}),t("receivePage.copied")]}):e.jsxs(e.Fragment,{children:[e.jsx(Eo,{className:"mr-2 size-4"}),t("receivePage.copyAddress")]})}),e.jsxs(J,{variant:"outline",className:"flex-1",onClick:j,disabled:f,children:[f?e.jsx(be,{className:"mr-2 size-4 animate-spin"}):e.jsx(sn,{className:"mr-2 size-4"}),t("receivePage.saveImage")]})]}),e.jsxs(Ue,{variant:"mint",className:"w-full",onClick:N,disabled:f,children:[f?e.jsx(be,{className:"mr-2 size-4 animate-spin"}):e.jsx(Fp,{className:"mr-2 size-4"}),t("receivePage.share")]}),e.jsx(Gt,{variant:"info",children:t("receivePage.networkWarning",{chain:i})})]})]})}_d.__docgenInfo={description:"",methods:[],displayName:"ReceivePage"};const Md=()=>e.jsx(le,{children:e.jsx(_d,{})});Md.__docgenInfo={description:"",methods:[],displayName:"ReceiveActivity"};const Rd=()=>e.jsx(le,{children:e.jsx(Dr,{})});Rd.__docgenInfo={description:"",methods:[],displayName:"SettingsActivity"};const ib={"zh-CN":"","zh-TW":"",en:"English",ar:""};function Ld(){const{goBack:t}=de(),{t:s}=O("settings"),n=es(),a=r=>{Un.setLanguage(r),t()};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:s("languagePage.title"),onBack:t}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:Object.keys(Xu).map((r,o)=>e.jsxs("div",{children:[o>0&&e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsxs("button",{onClick:()=>a(r),className:L("flex w-full items-center justify-between px-4 py-3.5","hover:bg-muted/50 active:bg-muted transition-colors",r===n&&"bg-primary/5"),children:[e.jsx("span",{className:"text-sm font-medium",children:ib[r]}),r===n&&e.jsx(je,{className:"text-primary size-5"})]})]},r))}),e.jsx("p",{className:"text-muted-foreground mt-4 px-1 text-xs",children:s("languagePage.hint")})]})]})}Ld.__docgenInfo={description:"",methods:[],displayName:"LanguagePage"};const Dd=()=>e.jsx(le,{children:e.jsx(Ld,{})});Dd.__docgenInfo={description:"",methods:[],displayName:"SettingsLanguageActivity"};function zd(){const{t}=O("settings"),{goBack:s}=de(),n=Co(),a=r=>{Un.setCurrency(r),s()};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("currency.title"),onBack:s}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:Object.keys(Wr).map((r,o)=>e.jsxs("div",{children:[o>0&&e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsxs("button",{onClick:()=>a(r),className:L("flex w-full items-center justify-between px-4 py-3.5","hover:bg-muted/50 active:bg-muted transition-colors",r===n&&"bg-primary/5"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-muted-foreground text-base font-semibold",children:Wr[r].symbol}),e.jsx("span",{className:"text-sm font-medium",children:t(`currency.names.${r}`)})]}),r===n&&e.jsx(je,{className:"text-primary size-5"})]})]},r))}),e.jsx("p",{className:"text-muted-foreground mt-4 px-1 text-xs",children:t("currency.hint")})]})]})}zd.__docgenInfo={description:"",methods:[],displayName:"CurrencyPage"};const Od=()=>e.jsx(le,{children:e.jsx(zd,{})});Od.__docgenInfo={description:"",methods:[],displayName:"SettingsCurrencyActivity"};function ob(t){const{children:s,open:n,defaultOpen:a=!1,onOpenChange:r,onOpenChangeComplete:o,actionsRef:d,handle:i,triggerId:l,defaultTriggerId:m=null}=t,u=af(),f=!!u,h=_f(()=>i?.store??new cf({open:n??a,activeTriggerId:l!==void 0?l:m,modal:!0,disablePointerDismissal:!0,nested:f,role:"alertdialog"})).current;h.useControlledProp("open",n,a),h.useControlledProp("activeTriggerId",l,m),h.useSyncedValue("nested",f),h.useContextCallback("onOpenChange",r),h.useContextCallback("onOpenChangeComplete",o);const g=h.useState("payload");rf({store:h,actionsRef:d,parentContext:u?.store.context});const b=c.useMemo(()=>({store:h}),[h]);return e.jsx(of.Provider,{value:b,children:typeof s=="function"?s({payload:g}):s})}function Bd({...t}){return e.jsx(ob,{"data-slot":"alert-dialog",...t})}function Fd({...t}){return e.jsx(ff,{"data-slot":"alert-dialog-portal",...t})}function Wd({className:t,...s}){return e.jsx(pf,{"data-slot":"alert-dialog-overlay",className:L("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 bg-black/10 duration-100 supports-backdrop-filter:backdrop-blur-xs fixed inset-0 isolate z-50",t),...s})}function $d({className:t,size:s="default",...n}){return e.jsxs(Fd,{children:[e.jsx(Wd,{}),e.jsx(lf,{"data-slot":"alert-dialog-content","data-size":s,className:L("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 data-closed:zoom-out-95 data-open:zoom-in-95 bg-background ring-foreground/10 gap-4 rounded-xl p-4 ring-1 duration-100 data-[size=default]:max-w-xs data-[size=sm]:max-w-xs data-[size=default]:sm:max-w-sm group/alert-dialog-content fixed top-1/2 left-1/2 z-50 grid w-full -translate-x-1/2 -translate-y-1/2 outline-none",t),...n})]})}function qd({className:t,...s}){return e.jsx("div",{"data-slot":"alert-dialog-header",className:L("grid grid-rows-[auto_1fr] place-items-center gap-1.5 text-center has-data-[slot=alert-dialog-media]:grid-rows-[auto_auto_1fr] has-data-[slot=alert-dialog-media]:gap-x-4 sm:group-data-[size=default]/alert-dialog-content:place-items-start sm:group-data-[size=default]/alert-dialog-content:text-left sm:group-data-[size=default]/alert-dialog-content:has-data-[slot=alert-dialog-media]:grid-rows-[auto_1fr]",t),...s})}function Hd({className:t,...s}){return e.jsx("div",{"data-slot":"alert-dialog-footer",className:L("bg-muted/50 -mx-4 -mb-4 rounded-b-xl border-t p-4 flex flex-col-reverse gap-2 group-data-[size=sm]/alert-dialog-content:grid group-data-[size=sm]/alert-dialog-content:grid-cols-2 sm:flex-row sm:justify-end",t),...s})}function Ud({className:t,...s}){return e.jsx(df,{"data-slot":"alert-dialog-title",className:L("text-sm font-medium sm:group-data-[size=default]/alert-dialog-content:group-has-data-[slot=alert-dialog-media]/alert-dialog-content:col-start-2",t),...s})}function Vd({className:t,...s}){return e.jsx(uf,{"data-slot":"alert-dialog-description",className:L("text-muted-foreground *:[a]:hover:text-foreground text-sm text-balance md:text-pretty *:[a]:underline *:[a]:underline-offset-3",t),...s})}function Jd({className:t,...s}){return e.jsx(J,{"data-slot":"alert-dialog-action",className:L(t),...s})}function Kd({className:t,variant:s="outline",size:n="default",...a}){return e.jsx(mf,{"data-slot":"alert-dialog-cancel",className:L(t),render:e.jsx(J,{variant:s,size:n}),...a})}Bd.__docgenInfo={description:"",methods:[],displayName:"AlertDialog"};Jd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogAction"};Kd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogCancel",props:{variant:{defaultValue:{value:'"outline"',computed:!1},required:!1},size:{defaultValue:{value:'"default"',computed:!1},required:!1}}};$d.__docgenInfo={description:"",methods:[],displayName:"AlertDialogContent",props:{size:{required:!1,tsType:{name:"union",raw:'"default" | "sm"',elements:[{name:"literal",value:'"default"'},{name:"literal",value:'"sm"'}]},description:"",defaultValue:{value:'"default"',computed:!1}}}};Vd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogDescription"};Hd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogFooter"};qd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogHeader"};Wd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogOverlay"};Fd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogPortal"};Ud.__docgenInfo={description:"",methods:[],displayName:"AlertDialogTitle"};function xo(t){if(typeof t!="object"||t===null||Array.isArray(t))return null;const s=t.id;return typeof s=="string"&&s.trim()!==""?s:null}function cb(t){try{const s=JSON.parse(t),n=Array.isArray(s)?s.map(xo):[xo(s)];return Array.from(new Set(n.filter(a=>typeof a=="string")))}catch{return[]}}function lb(t,s){switch(s){case"default":return t("chainConfig.source.default");case"subscription":return t("chainConfig.source.subscription");case"manual":return t("chainConfig.source.manual")}}function db(t){switch(t){case"default":return"bg-muted text-muted-foreground";case"subscription":return"bg-blue-500/10 text-blue-600";case"manual":return"bg-amber-500/10 text-amber-700"}}function ub(t){const s=new Map;for(const n of t)s.set(n.id,n);return s}function Gd(){const{goBack:t}=de(),{t:s}=O("settings"),n=st(),a=Ys(),r=rm(),o=im(),d=om(),i=cm(),l=c.useMemo(()=>ub(o),[o]),[m,u]=c.useState("default"),[f,h]=c.useState(""),[g,b]=c.useState(!1),[p,x]=c.useState([]),v=c.useRef(null),j=c.useRef(null),N=c.useRef(!1);c.useEffect(()=>{os.initialize()},[]),c.useEffect(()=>{r?.url&&u(r.url)},[r?.url]),c.useEffect(()=>{const I=N.current;if(N.current=d,!I||d)return;const T=v.current;if(T){if(v.current=null,i){n.show(i);return}n.show(s(`chainConfig.toast.${T}`)),T==="manualAdded"&&h("")}},[i,d,s,n]);const y=async()=>{v.current="subscriptionSaved",await os.setSubscriptionUrl(m)},S=async()=>{v.current="subscriptionRefreshed",await os.refreshSubscription()},C=async()=>{const I=cb(f),T=new Set(a.map(A=>A.id)),k=I.filter(A=>T.has(A));if(k.length>0){j.current=f,x(k),b(!0);return}v.current="manualAdded",await os.addManualConfig(f)},P=()=>{j.current=null,x([]),b(!1)},_=async()=>{const I=j.current;j.current=null,x([]),b(!1),I&&(v.current="manualAdded",await os.addManualConfig(I))};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:s("chainConfig.title"),onBack:t}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx(Bd,{open:g,onOpenChange:I=>{I?b(I):P()},children:e.jsxs($d,{children:[e.jsxs(qd,{children:[e.jsx(Ud,{children:s("chainConfig.manual.duplicate.title")}),e.jsx(Vd,{children:s("chainConfig.manual.duplicate.description")})]}),e.jsx("div",{className:"bg-muted/50 text-muted-foreground rounded-lg px-3 py-2 text-xs font-mono break-all",children:p.join(", ")}),e.jsxs(Hd,{children:[e.jsx(Kd,{onClick:P,children:s("chainConfig.manual.duplicate.cancel")}),e.jsx(Jd,{onClick:_,disabled:d,children:s("chainConfig.manual.duplicate.replace")})]})]})}),i&&e.jsx("div",{className:"border-destructive/20 bg-destructive/5 text-destructive rounded-xl border px-4 py-3 text-sm",children:i}),e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:e.jsxs("div",{className:"space-y-3 px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.subscription.title")}),e.jsx("div",{className:"text-muted-foreground text-xs",children:e.jsx(ec,{ns:"settings",i18nKey:"chainConfig.subscription.description",components:{code:e.jsx("code",{className:"font-mono"})}})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{type:"button",variant:"outline",size:"icon","data-testid":"refresh-subscription-button",onClick:S,disabled:d,"aria-label":s("chainConfig.subscription.refreshAriaLabel"),children:e.jsx(ns,{className:L("size-4",d&&"animate-spin")})}),e.jsx(J,{type:"button","data-testid":"save-subscription-button",onClick:y,disabled:d,children:s("chainConfig.subscription.save")})]})]}),e.jsx(Ve,{"data-testid":"subscription-url-input",value:m,onChange:I=>u(I.target.value),placeholder:s("chainConfig.subscription.placeholder"),disabled:d,autoCapitalize:"off",autoCorrect:"off",spellCheck:!1}),r?.lastUpdated&&e.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.subscription.lastUpdated",{value:r.lastUpdated})})]})}),e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm","data-testid":"manual-add-section",children:e.jsxs("div",{className:"space-y-3 px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.manual.title")}),e.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.manual.description")})]}),e.jsxs(J,{type:"button",variant:"outline","data-testid":"add-chain-button",onClick:C,disabled:d||f.trim()==="",children:[e.jsx(ut,{className:"size-4"}),s("chainConfig.manual.add")]})]}),e.jsx("textarea",{"data-testid":"manual-config-textarea",value:f,onChange:I=>h(I.target.value),placeholder:s("chainConfig.manual.placeholder"),rows:5,disabled:d,className:L("bg-background w-full resize-none rounded-lg border px-3 py-3 text-sm","placeholder:text-muted-foreground","focus:ring-ring focus:ring-2 focus:ring-offset-2 focus:outline-none","disabled:cursor-not-allowed disabled:opacity-50"),autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})]})}),e.jsxs("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:[e.jsxs("div",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.list.title")}),e.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.list.description")})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{children:[a.map((I,T)=>{const k=l.get(I.id),A=k?.kind==="incompatible_major",w=lb(s,I.source);return e.jsxs("div",{"data-testid":`chain-item-${I.id}`,children:[T>0&&e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate text-sm font-medium",children:I.name}),e.jsx("span",{className:L("rounded px-2 py-0.5 text-xs",db(I.source)),children:w})]}),e.jsxs("div",{className:"text-muted-foreground mt-1 flex flex-wrap gap-x-3 gap-y-1 text-xs",children:[e.jsx("span",{className:"font-mono",children:I.id}),e.jsxs("span",{children:["v",I.version]}),e.jsx("span",{children:I.chainKind}),e.jsx("span",{children:I.symbol})]}),k?.kind==="incompatible_major"&&e.jsxs("div",{className:"mt-2 flex items-start gap-2 rounded-lg bg-amber-500/10 px-3 py-2 text-xs text-amber-800",children:[e.jsx(Oe,{className:"mt-0.5 size-4 shrink-0"}),e.jsx("div",{children:s("chainConfig.warning.incompatibleMajor",{version:k.version,supportedMajor:k.supportedMajor})})]})]}),e.jsx($o,{checked:I.enabled,onCheckedChange:E=>{os.setChainEnabled(I.id,E)},disabled:d||A,className:L(A&&"cursor-not-allowed opacity-60")})]})})]},I.id)}),a.length===0&&e.jsx("div",{className:"text-muted-foreground px-4 py-8 text-center text-sm",children:s("chainConfig.list.empty")})]})]}),e.jsx("div",{className:"text-muted-foreground px-1 text-xs",children:s("chainConfig.hint")})]})]})}Gd.__docgenInfo={description:"",methods:[],displayName:"ChainConfigPage"};const Qd=()=>e.jsx(le,{children:e.jsx(Gd,{})});Qd.__docgenInfo={description:"",methods:[],displayName:"SettingsChainsActivity"};const mb=3e4;function Yd(){const{t}=O("settings"),{goBack:s}=de(),{push:n}=Z(),a=Fe(),o=(a?.keyType??"mnemonic")==="arbitrary",[d,i]=c.useState(""),[l,m]=c.useState(!0),u=c.useRef(!1);c.useEffect(()=>{if(d.length>0&&!l){const g=setTimeout(()=>{m(!0)},mb);return()=>clearTimeout(g)}},[d.length,l]),c.useEffect(()=>{const g=()=>{document.hidden&&d.length>0&&m(!0)};return document.addEventListener("visibilitychange",g),()=>{document.removeEventListener("visibilitychange",g)}},[d.length]),c.useEffect(()=>{u.current||!a?.encryptedMnemonic||(u.current=!0,ks(async g=>{try{const b=await hs(a.encryptedMnemonic,g);return i(b),m(!1),!0}catch{return!1}}),n("WalletLockConfirmJob",{title:t("viewMnemonic.verifyTitle"),description:t(o?"viewMnemonic.verifyDescKey":"viewMnemonic.verifyDescMnemonic")}))},[a,n,t,o]);const f=()=>{m(g=>!g)};if(!a)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t(o?"viewMnemonic.titleKey":"viewMnemonic.titleMnemonic"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("viewMnemonic.noWallet")})})]});const h=o?[]:d.trim().split(/\s+/).filter(Boolean);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t(o?"viewMnemonic.titleKey":"viewMnemonic.titleMnemonic"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"flex gap-3 rounded-xl bg-amber-500/10 p-4",children:[e.jsx(Oe,{className:"size-5 shrink-0 text-amber-500"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("p",{className:"font-medium text-amber-700 dark:text-amber-400",children:t("viewMnemonic.securityTip")}),e.jsx("p",{className:"text-muted-foreground",children:t(o?"viewMnemonic.securityWarningKey":"viewMnemonic.securityWarningMnemonic")})]})]}),d.length>0&&e.jsxs("div",{className:"bg-card space-y-4 rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:o?t("viewMnemonic.charCount",{count:d.length}):t("viewMnemonic.wordCount",{count:h.length})}),e.jsx("button",{onClick:f,className:L("flex items-center gap-1.5 rounded-full px-3 py-1.5 text-xs font-medium","bg-muted hover:bg-muted/80 transition-colors"),children:l?e.jsxs(e.Fragment,{children:[e.jsx(cr,{className:"size-3.5"}),t("viewMnemonic.show")]}):e.jsxs(e.Fragment,{children:[e.jsx(Yo,{className:"size-3.5"}),t("viewMnemonic.hide")]})})]}),o?e.jsx("textarea",{value:d,readOnly:!0,rows:4,"data-testid":"secret-textarea",className:L("bg-background w-full resize-none rounded-lg border px-3 py-3 font-mono text-sm","focus:outline-none",l?"[-webkit-text-security:disc]":"[-webkit-text-security:none]")}):e.jsx(Ko,{words:h,hidden:l}),!l&&e.jsx("p",{className:"text-muted-foreground text-center text-xs",children:t("viewMnemonic.autoHideNote")})]})]})]})}Yd.__docgenInfo={description:"",methods:[],displayName:"ViewMnemonicPage"};const Xd=()=>e.jsx(le,{children:e.jsx(Yd,{})});Xd.__docgenInfo={description:"",methods:[],displayName:"SettingsMnemonicActivity"};function Zd(){const{t}=O("settings"),{goBack:s}=de(),n=Fe(),[a,r]=c.useState("verify"),[o,d]=c.useState("pattern"),[i,l]=c.useState([]),[m,u]=c.useState(!1),[f,h]=c.useState(!1),g=c.useRef(null),[b,p]=c.useState([]),[x,v]=c.useState(!1),[j,N]=c.useState(null),[y,S]=c.useState(null),C=c.useCallback(()=>{g.current&&(clearTimeout(g.current),g.current=null),u(!1)},[]),P=c.useCallback(A=>{m&&A.length>0&&C(),l(A)},[m,C]),_=c.useCallback(async A=>{if(n?.encryptedMnemonic){h(!0),C();try{const w=Be(A);await Vt(n.encryptedMnemonic,w)?(l(A),r("setup")):(u(!0),l([]),g.current=setTimeout(()=>{u(!1)},1500))}catch{u(!0),l([]),g.current=setTimeout(()=>{u(!1)},1500)}finally{h(!1)}}},[n,C]),I=c.useCallback((A,w)=>{p(A),v(w),N(null)},[]),T=c.useCallback(async()=>{if(n?.encryptedWalletLock){h(!0),N(null);try{if(!Po(b)){N(t("changeWalletLock.invalidMnemonic")),h(!1);return}const A=b.join(" ");await ye.verifyMnemonic(n.id,A)?(S(A),r("setup")):N(t("changeWalletLock.mnemonicVerifyFailed"))}catch{N(t("changeWalletLock.mnemonicVerifyFailed"))}finally{h(!1)}}},[n,b,t]),k=c.useCallback(async A=>{if(n)try{if(o==="mnemonic"&&y)await ye.resetWalletLockByMnemonic(n.id,y,A);else{const w=Be(i);await ye.updateWalletLock(n.id,w,A)}r("success"),setTimeout(()=>{s()},2e3)}catch{r("verify"),l([]),S(null)}},[n,o,y,i,s]);return n?a==="success"?e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("changeWalletLock.title")}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx("div",{className:"bg-green-500/10 flex size-16 items-center justify-center rounded-full",children:e.jsx(je,{className:"text-green-500 size-8"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:t("changeWalletLock.success")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:t("changeWalletLock.returning")})]})]})]}):a==="verify"?e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("changeWalletLock.title"),onBack:s}),e.jsx("div",{className:"flex-1 p-4",children:o==="pattern"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:t("changeWalletLock.verifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("changeWalletLock.verifyDesc")})]}),e.jsx(mt,{value:i,onChange:P,onComplete:_,minPoints:4,error:m,disabled:f,"data-testid":"verify-pattern-lock"}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx("button",{type:"button",onClick:()=>d("mnemonic"),className:"text-primary hover:text-primary/80 text-sm underline","data-testid":"switch-to-mnemonic",children:t("changeWalletLock.forgotPattern")})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:t("changeWalletLock.mnemonicVerifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("changeWalletLock.mnemonicVerifyDesc")})]}),e.jsx(Df,{wordCount:12,onChange:I}),j&&e.jsx("p",{className:"text-destructive mt-4 text-center text-sm",children:j}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx(J,{onClick:T,disabled:!x||f,className:"w-full","data-testid":"verify-mnemonic-button",children:t(f?"changeWalletLock.verifying":"changeWalletLock.verifyMnemonic")}),e.jsx("button",{type:"button",onClick:()=>{d("pattern"),p([]),N(null)},className:"text-muted-foreground hover:text-foreground w-full text-center text-sm","data-testid":"switch-to-pattern",children:t("changeWalletLock.usePattern")})]})]})})]}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("changeWalletLock.title"),onBack:()=>{r("verify"),l([])}}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(lr,{onComplete:k,minPoints:4})})]}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("changeWalletLock.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("changeWalletLock.noWallet")})})]})}Zd.__docgenInfo={description:"",methods:[],displayName:"ChangeWalletLockPage"};const eu=()=>e.jsx(le,{children:e.jsx(Zd,{})});eu.__docgenInfo={description:"",methods:[],displayName:"SettingsWalletLockActivity"};function fb({targetChain:t,address:s,filter:n,setFilter:a,walletId:r,decimals:o}){const{navigate:d,goBack:i}=de(),l=Xs(),{t:m}=O(["transaction","common"]),u=rs(),{data:f,isLoading:h,isFetching:g,error:b,refetch:p}=u.transactionHistory.useState({address:s,limit:50},{enabled:!!s}),x=Da(b,m),{transactions:v,deleteTransaction:j,retryTransaction:N}=To(r,t,s,f),y=c.useMemo(()=>{if(!f)return[];const k=n.period;if(!k||k==="all")return f;const A=k==="7d"?7:k==="30d"?30:90,w=Date.now()-A*24*60*60*1e3;return f.filter(E=>E.timestamp>=w)},[f,n.period]),S=c.useMemo(()=>[{value:"all",label:m("history.filter.allTime")},{value:"7d",label:m("history.filter.days7")},{value:"30d",label:m("history.filter.days30")},{value:"90d",label:m("history.filter.days90")}],[m]),C=c.useMemo(()=>[{value:"all",label:m("history.filter.allChains")},...l.map(k=>({value:k.id,label:k.name}))],[m,l]),P=c.useCallback(k=>{if(!k.id)return;const A=f?.find(E=>E.hash===k.hash),w=A?Qt.stringify(A):void 0;d({to:`/transaction/${k.id}`,search:{txData:w}})},[d,f]),_=c.useCallback(k=>{a(A=>({...A,chain:k}))},[a]),I=c.useCallback(k=>{a(A=>({...A,period:k}))},[a]),T=c.useCallback(async()=>{await p?.()},[p]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:m("transaction:history.title"),onBack:i,rightAction:e.jsx("button",{onClick:T,disabled:g,className:L("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80",g&&"animate-spin"),"aria-label":m("common:a11y.refresh"),children:e.jsx(ns,{className:"size-5"})})}),e.jsxs("div",{className:"bg-card border-b px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(lc,{className:"text-muted-foreground size-4"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:m("history.filter.chainLabel")}),e.jsxs(Fs,{value:n.chain||"all",onValueChange:k=>_(k),children:[e.jsx(Ws,{size:"sm","aria-label":m("common:a11y.selectChain"),children:e.jsx($s,{children:C.find(k=>k.value===(n.chain||"all"))?.label})}),e.jsx(qs,{children:C.map(k=>e.jsx(Yt,{value:k.value,children:k.label},k.value))})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:m("history.filter.periodLabel")}),e.jsxs(Fs,{value:n.period||"all",onValueChange:k=>I(k),children:[e.jsx(Ws,{size:"sm","aria-label":m("common:a11y.selectPeriod"),children:e.jsx($s,{children:S.find(k=>k.value===(n.period||"all"))?.label})}),e.jsx(qs,{children:S.map(k=>e.jsx(Yt,{value:k.value,children:k.label},k.value))})]})]})]}),e.jsx("p",{className:"text-muted-foreground mt-2 text-xs",children:m("transaction:history.totalRecords",{count:y.length})})]}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[v.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-muted-foreground text-xs font-medium uppercase tracking-wider px-1",children:m("pendingTx.title")}),e.jsx("div",{className:"space-y-1",children:v.map(k=>{const A=wl(k,o);return e.jsx(Ro,{transaction:A,onClick:()=>d({to:`/pending-tx/${k.id}`}),onRetry:k.status==="failed"?()=>N(k):void 0,onDelete:()=>j(k)},k.id)})})]}),(x.limited||!x.supported)&&!h&&e.jsx(Fm,{type:x.limited?"limited":"notSupported",feature:m("home:wallet.transactionHistory"),reason:x.reason,className:"mb-4"}),e.jsx(tc,{transactions:Cl(y??[],t),loading:h,onTransactionClick:P,emptyTitle:m("transaction:history.emptyTitle"),emptyDescription:m("transaction:history.emptyDesc"),showChainIcon:!0})]})]})}function tu({initialChain:t}){const{goBack:s}=de(),n=Fe(),a=Je(),{t:r}=O(["transaction","common"]),o=dt(),[d,i]=c.useState({chain:t??a,period:"all"}),l=d.chain==="all"?a:d.chain,m=o.snapshot?He.getChainById(o,l??""):void 0,f=n?.chainAddresses?.find(h=>h.chain===l)?.address??"";return n?e.jsx(Dt,{chainId:l,fallback:e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:r("transaction:history.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Chain not supported"})})]}),children:e.jsx(fb,{targetChain:l,address:f,filter:d,setFilter:i,walletId:n.id,decimals:m?.decimals??8})}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:r("transaction:history.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:r("transaction:history.noWallet")})})]})}tu.__docgenInfo={description:"",methods:[],displayName:"TransactionHistoryPage",props:{initialChain:{required:!1,tsType:{name:"union",raw:"ChainType | 'all' | undefined",elements:[{name:"ChainType"},{name:"literal",value:"'all'"},{name:"undefined"}]},description:""}}};const su=()=>{const t=ah();return e.jsx(le,{children:e.jsx(tu,{initialChain:t.chain})})};su.__docgenInfo={description:"",methods:[],displayName:"HistoryActivity"};const pb={transfer:"send",swap:"swap",exchange:"exchange",approve:"approve",signature:"signature",stake:"stake",unstake:"unstake",mint:"mint",burn:"destroy",gift:"gift",grab:"grab",trust:"trust",signFor:"signFor",emigrate:"emigrate",immigrate:"immigrate",issueAsset:"issueAsset",increaseAsset:"increaseAsset",destroyAsset:"destroy",issueEntity:"issueEntity",destroyEntity:"destroyEntity",locationName:"locationName",dapp:"dapp",certificate:"certificate",mark:"mark",contract:"interaction",unknown:"other",revoke:"approve",claim:"receive"};function hb(t,s){const n=t.action,a=t.direction,r=n==="transfer"?a==="in"?"receive":"send":pb[n]??"other",o=t.assets[0],d=o.assetType==="nft"?"1":o.value,i=o.assetType==="nft"?0:o.decimals,l=o.assetType==="nft"?"NFT":o.symbol,m=a==="in"?t.from:t.to;return{hash:t.hash,from:t.from,to:t.to,address:m,timestamp:t.timestamp,status:t.status,type:r,direction:a,amount:oe.fromRaw(d,i,l),symbol:l,chain:s,assets:t.assets,fee:t.fee?oe.fromRaw(t.fee.value,t.fee.decimals,t.fee.symbol):void 0,contract:t.contract,blockNumber:t.blockNumber}}function go(t){return!t||t.assetType==="nft"?null:{value:t.value,decimals:t.decimals,symbol:t.symbol}}function xb(t){if(!t)return null;const[s,n]=t.split("--");return!s||!n?null:{chainId:s,hash:n}}function gb({hash:t,chainId:s,txData:n,onBack:a}){const{t:r}=O(["transaction","common"]),o=dt(),d=rs(),i=c.useMemo(()=>n?Qt.parse(n):null,[n]),{data:l,isLoading:m,error:u}=d.transaction.useState({txHash:t},{enabled:!!t}),f=l??i,h=c.useMemo(()=>f?hb(f,s):null,[f,s]),g=c.useMemo(()=>{const z=h?.chain??s;return z?He.getChainById(o,z):null},[o,s,h?.chain]),b=c.useMemo(()=>{const z=g?.explorer?.queryTx;return!z||!t?null:z.replace(":signature",t)},[g?.explorer?.queryTx,t]),p=c.useCallback(()=>{b&&window.open(b,"_blank","noopener,noreferrer")},[b]),[x,v]=c.useState(!1),j=c.useCallback(async()=>{b&&(await Za.write({text:b}),v(!0),setTimeout(()=>v(!1),2e3))},[b]);if(m&&!i)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:r("detail.title"),onBack:a}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx(sa,{className:"h-48"}),e.jsx(sa,{className:"h-64"}),e.jsx(sa,{className:"h-32"})]})]});if(u instanceof Pm)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:r("detail.title"),onBack:a}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx("div",{className:"bg-card flex items-center justify-center rounded-xl p-6 shadow-sm",children:e.jsx("p",{className:"text-muted-foreground",children:r("detail.invalidData")})}),t&&e.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:r("detail.hash")}),e.jsx(qr,{text:t,className:"text-muted-foreground text-xs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:p,disabled:!b,className:L("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:[e.jsx(Ca,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.openInExplorer")})]}),e.jsx("button",{onClick:j,disabled:!b,className:L("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:x?e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"text-green-500 size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.copied")})]}):e.jsxs(e.Fragment,{children:[e.jsx(Hs,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.share")})]})})]})]})]})]});if(!h)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:r("detail.title"),onBack:a}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:r("detail.notFound")})})]});const N=h.type,y=_m(N),S=y.Icon,C=h.type==="swap"?h.assets?.[0]:void 0,P=h.type==="swap"?h.assets?.[1]:void 0,_=go(C),I=go(P),T=h.contract?.address||h.to,k=h.contract?.method,A=h.contract?.methodId,w=k?r(`method.${k}`,{defaultValue:k}):null,E=_?oe.fromRaw(_.value,_.decimals,_.symbol):null,D=I?oe.fromRaw(I.value,I.decimals,I.symbol):null;return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:r("detail.title"),onBack:a}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"bg-card flex flex-col items-center gap-3 rounded-xl p-6 shadow-sm",children:[e.jsx("div",{className:L("flex size-16 items-center justify-center rounded-full",y.bg),children:e.jsx(S,{className:L("size-8",y.color)})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:r(`type.${h.type}`,{defaultValue:h.type})}),h.type==="swap"&&E&&D?e.jsxs("div",{className:L("flex items-center justify-center gap-2",y.color),children:[e.jsx(Nt,{value:E.toNumber(),symbol:E.symbol,decimals:E.decimals,sign:"never",color:"default",weight:"normal",size:"lg"}),e.jsx("span",{className:"text-lg",children:""}),e.jsx(Nt,{value:D.toNumber(),symbol:D.symbol,decimals:D.decimals,sign:"never",color:"default",weight:"normal",size:"lg"})]}):e.jsx(Nt,{value:h.type==="send"?-Math.abs(h.amount.toNumber()):h.amount.toNumber(),symbol:h.symbol,sign:y.amountSign,color:"default",weight:"normal",size:"xl",className:y.color})]}),e.jsx(zf,{status:Mm(h.status).badgeStatus,label:r(`transaction:status.${h.status}`)})]}),e.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:r("detail.info")}),h.from&&h.to?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.fromAddress")}),e.jsx(it,{address:h.from,copyable:!0,className:"text-sm"})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.toAddress")}),e.jsx(it,{address:h.to,copyable:!0,className:"text-sm"})]})]}):e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:h.type==="send"?r("detail.toAddress"):r("detail.fromAddress")}),e.jsx(it,{address:h.address,copyable:!0,className:"text-sm"})]}),e.jsx("div",{className:"bg-border h-px"}),h.type==="swap"&&(_||I)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.swapFrom")}),e.jsx("span",{className:"text-sm font-medium",children:_?e.jsx(Nt,{value:oe.fromRaw(_.value,_.decimals,_.symbol).toNumber(),symbol:_.symbol,decimals:_.decimals,sign:"never",color:"default",size:"sm"}):"-"})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.swapTo")}),e.jsx("span",{className:"text-sm font-medium",children:I?e.jsx(Nt,{value:oe.fromRaw(I.value,I.decimals,I.symbol).toNumber(),symbol:I.symbol,decimals:I.decimals,sign:"never",color:"default",size:"sm"}):"-"})]}),e.jsx("div",{className:"bg-border h-px"})]}),(h.type==="approve"||h.type==="interaction"||h.type==="swap")&&T&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.contractAddress")}),e.jsx(it,{address:T,copyable:!0,className:"text-sm"})]}),(h.type==="approve"||h.type==="interaction")&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.method")}),e.jsx("span",{className:"text-sm font-medium font-mono",children:w||A||r("common:unknown")})]}),h.type==="approve"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.spender")}),e.jsx("span",{className:"text-sm font-medium",children:r("common:unknown")})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.allowance")}),e.jsx("span",{className:"text-sm font-medium",children:r("common:unknown")})]})]})]}),e.jsx("div",{className:"bg-border h-px"})]}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.time")}),e.jsx(Om,{value:h.timestamp,format:"datetime",className:"text-sm"})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.network")}),e.jsx("span",{className:"text-sm font-medium capitalize",children:h.chain})]}),h.fee&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.fee")}),e.jsx(sr,{amount:h.fee?.toNumber?.()??0,symbol:h.fee?.symbol??"",className:"text-sm"})]})]}),h.blockNumber&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.blockHeight")}),e.jsx("span",{className:"text-sm font-medium",children:h.blockNumber.toLocaleString()})]})]}),h.confirmations!==void 0&&h.confirmations>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:r("detail.confirmations")}),e.jsx("span",{className:"text-sm font-medium",children:h.confirmations})]})]})]}),t&&e.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:r("detail.hash")}),e.jsx(qr,{text:t,className:"text-muted-foreground text-xs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:p,disabled:!b,className:L("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:[e.jsx(Ca,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.openInExplorer")})]}),e.jsx("button",{onClick:j,disabled:!b,className:L("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:x?e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"text-green-500 size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.copied")})]}):e.jsxs(e.Fragment,{children:[e.jsx(Hs,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:r("detail.share")})]})})]})]})]})]})}function nu(){const{t}=O(["transaction","common"]),{goBack:s}=de(),{txId:n,txData:a}=he(),r=Fe(),o=c.useMemo(()=>xb(n),[n]),d=c.useCallback(()=>{s()},[s]);return r?o?e.jsx(Dt,{chainId:o.chainId,fallback:e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("detail.title"),onBack:d}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Chain not supported"})})]}),children:e.jsx(gb,{hash:o.hash,chainId:o.chainId,txData:a,onBack:d})}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("detail.title"),onBack:d}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("detail.notFound")})})]}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("detail.title"),onBack:d}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("history.noWallet")})})]})}nu.__docgenInfo={description:"",methods:[],displayName:"TransactionDetailPage"};const au=({params:t})=>e.jsx(le,{children:e.jsx(me,{params:t,children:e.jsx(nu,{})})});au.__docgenInfo={description:"",methods:[],displayName:"TransactionDetailActivity"};const vb=150;function ru({onScan:t,className:s}){const{t:n}=O("scanner"),{t:a}=O("common"),{navigate:r,goBack:o}=de(),{push:d}=Z(),i=fc(),l=c.useRef(null),m=c.useRef(null),u=c.useRef(null),f=c.useRef(null),h=c.useRef(!1),g=c.useRef(null),b=c.useRef(t),[p,x]=c.useState("idle"),[v,j]=c.useState(null),[N,y]=c.useState(!1);c.useEffect(()=>{b.current=t},[t]);const S=c.useCallback(A=>{if(A===g.current)return;g.current=A,x("success"),h.current=!1,"vibrate"in navigator&&navigator.vibrate(100);const w=Vo(A);if(b.current)b.current(A,w);else switch(w.type){case"address":case"payment":r({to:"/send",search:{address:w.address,chain:w.chain,amount:w.type==="payment"?w.amount:void 0}});break;case"deeplink":r({to:w.path,search:w.params});break;case"contact":d("ContactAddConfirmJob",{name:w.name,addresses:JSON.stringify(w.addresses),memo:w.memo,avatar:w.avatar});break;case"unknown":r({to:"/send",search:{address:w.content}});break}},[r,d]),C=c.useCallback(()=>{if(h.current)return;h.current=!0,m.current||(m.current=document.createElement("canvas"));const A=async()=>{if(!(!h.current||!l.current||!f.current)){try{const w=await f.current.scanFromVideo(l.current,m.current??void 0);if(w){S(w.content);return}}catch{}h.current&&setTimeout(A,vb)}};A()},[S]),P=c.useCallback(()=>{h.current=!1,u.current&&(u.current.getTracks().forEach(A=>A.stop()),u.current=null)},[]),_=c.useCallback(async()=>{P(),x("requesting"),g.current=null;try{if(!await i.checkPermission()&&!await i.requestPermission()){x("denied");return}const w=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});u.current=w,l.current&&(l.current.srcObject=w,await l.current.play(),C()),x("scanning")}catch(A){x("error"),j(A instanceof Error?A.message:"Camera initialization failed")}},[i,C,P]);c.useEffect(()=>(f.current=Jo({useWorker:!0}),_(),()=>{P(),f.current?.destroy(),f.current=null}),[]);const I=c.useCallback(()=>{P(),o()},[P,o]),T=c.useCallback(()=>{const A=document.createElement("input");A.type="file",A.accept="image/*",A.onchange=async w=>{const E=w.target.files?.[0];if(E)try{const D=new Image,z=URL.createObjectURL(E);D.onload=async()=>{URL.revokeObjectURL(z);const R=document.createElement("canvas");R.width=D.width,R.height=D.height;const V=R.getContext("2d");if(!V||!f.current){j(n("noQrFound")),x("error");return}V.drawImage(D,0,0);const M=await f.current.scanFromCanvas(R);M?S(M.content):(j(n("noQrFound")),x("error"))},D.onerror=()=>{URL.revokeObjectURL(z),j(n("noQrFound")),x("error")},D.src=z}catch{j(n("noQrFound")),x("error")}},A.click()},[S,n]),k=c.useCallback(async()=>{if(u.current){const A=u.current.getVideoTracks()[0];if(A)try{await A.applyConstraints({advanced:[{torch:!N}]}),y(!N)}catch{}}},[N]);return e.jsxs("div",{className:L("relative flex h-screen flex-col bg-black",s),children:[e.jsxs("div",{className:"absolute top-0 right-0 left-0 z-10 flex items-center justify-between p-4",children:[e.jsx(J,{variant:"ghost",size:"icon","data-testid":"back-button",onClick:I,className:"text-white","aria-label":a("a11y.back"),children:e.jsx(nn,{className:"size-6"})}),e.jsx("h1",{"data-testid":"page-title",className:"text-lg font-medium text-white",children:n("title")}),e.jsx(J,{variant:"ghost",size:"icon",onClick:k,className:L("text-white",N&&"text-yellow-400"),"aria-label":n(N?"flashOff":"flashOn"),children:e.jsx(oc,{className:"size-6"})})]}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("video",{ref:l,className:L("absolute inset-0 size-full object-cover",p!=="scanning"&&p!=="success"&&"invisible"),playsInline:!0,muted:!0}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"relative size-64",children:[e.jsx("div",{className:L("absolute top-0 left-0 size-8 border-t-4 border-l-4",p==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:L("absolute top-0 right-0 size-8 border-t-4 border-r-4",p==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:L("absolute bottom-0 left-0 size-8 border-b-4 border-l-4",p==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:L("absolute right-0 bottom-0 size-8 border-r-4 border-b-4",p==="success"?"border-green-500":"border-primary")}),p==="scanning"&&e.jsx("div",{className:"animate-scan bg-primary absolute right-2 left-2 h-0.5"})]})}),e.jsxs("div",{className:"absolute inset-x-0 bottom-32 text-center",children:[p==="idle"&&e.jsx("p",{className:"text-white/80",children:n("initializing")}),p==="requesting"&&e.jsx("p",{className:"text-white/80",children:n("requestingPermission")}),p==="scanning"&&e.jsx("p",{className:"text-white/80",children:n("scanPrompt")}),p==="success"&&e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-green-400",children:n("scanSuccess")})}),p==="denied"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-red-400",children:n("permissionDenied")}),e.jsx(J,{variant:"outline","data-testid":"retry-button",onClick:_,children:n("retry")})]}),p==="error"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-red-400",children:v||n("error")}),e.jsx(J,{variant:"outline","data-testid":"retry-button",onClick:_,children:n("retry")})]})]})]}),e.jsxs("div",{className:"absolute inset-x-0 bottom-0 flex justify-center gap-8 pb-8",children:[e.jsxs(J,{variant:"ghost",size:"lg","data-testid":"gallery-button",onClick:T,className:"flex flex-col items-center text-white",children:[e.jsx(ac,{className:"mb-1 size-6"}),e.jsx("span",{className:"text-xs",children:n("gallery")})]}),e.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-white/20",children:e.jsx(op,{className:"size-8 text-white"})}),e.jsx("div",{className:"w-16"})," "]})]})}ru.__docgenInfo={description:"",methods:[],displayName:"ScannerPage",props:{onScan:{required:!1,tsType:{name:"union",raw:"((content: string, parsed: ParsedQRContent) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:"Callback when QR code is scanned"},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"Custom class name"}}};const iu=()=>e.jsx(le,{children:e.jsx(ru,{})});iu.__docgenInfo={description:"",methods:[],displayName:"ScannerActivity"};const yb=300*1e3;function ou(t){if(t)return t}function bb(t){return t.map(s=>({id:s.id,name:s.name,address:s.address,balance:""}))}function jb(t,s,n){const a=new Map;for(const r of t)for(const o of r.chainAddresses){const d=ou(o.chain);if(!d)continue;const i=a.get(d)??[];i.push({address:o.address,isDefault:r.id===s}),a.set(d,i)}return Array.from(a.entries()).map(([r,o])=>({chain:r,name:n[r]??r,addresses:o.map(d=>({address:d.address,isDefault:d.isDefault}))}))}function vo(t){const s=t?.trim().toLowerCase();return s==="true"||s==="1"}function cu(){const{t}=O("authorize"),{t:s}=O("common"),{navigate:n,goBack:a}=de(),{push:r}=Z(),o=st(),{id:d,type:i,chainName:l,signMessage:m,getMain:u}=he(),f=Ae(Re,$=>$.currentWalletId),h=Ae(Re,$=>$.wallets),g=Ae(Re,Qs.getCurrentWallet),b=ts(),[p,x]=c.useState(null),[v,j]=c.useState(null),[N,y]=c.useState(!1),S=c.useMemo(()=>bb(h),[h]),C=g?.id??h[0]?.id,[P,_]=c.useState(C),I=c.useMemo(()=>ou(l),[l]),[T,k]=c.useState(I);c.useEffect(()=>k(I),[I]);const[A,w]=c.useState(void 0),[E,D]=c.useState(()=>new Set(h.map($=>$.id))),[z,R]=c.useState(!1);c.useEffect(()=>{_(C)},[C]),c.useEffect(()=>{D(new Set(h.map($=>$.id)))},[h]);const V=c.useMemo(()=>{const $=["viewAddress","viewPublicKey"];return m?.trim()&&$.push("signMessage"),vo(u)&&$.push("getMain"),$},[u,m]),M=c.useMemo(()=>new Gp(Us,d),[d]),B=c.useMemo(()=>!!m?.trim(),[m]),G=c.useMemo(()=>vo(u),[u]),ee=B||G;c.useEffect(()=>{let $=!1;async function se(){j(null);try{const re=await Us.getCallerAppInfo(d);if($)return;x(re)}catch{if($)return;j(t("error.authFailed"))}}return se(),()=>{$=!0}},[d,t]),c.useEffect(()=>{const $=window.setTimeout(()=>{(async()=>(await M.reject("timeout"),o.show({message:t("error.timeout"),position:"center"}),n({to:"/"})))()},yb);return()=>{window.clearTimeout($)}},[M,n,t,o]);const W=c.useMemo(()=>P?h.find($=>$.id===P)??null:null,[P,h]),F=c.useMemo(()=>jb(h,f,b),[b,f,h]),ie=c.useMemo(()=>g?g.chainAddresses.map($=>$.chain):[],[g]),ne=c.useMemo(()=>{if(!(!g||!T))return g.chainAddresses.find($=>$.chain===T)?.address},[g,T]);c.useEffect(()=>{i==="network"&&(T||k(F[0]?.chain))},[F,T,i]);const q=c.useMemo(()=>h.length===0?!1:i==="main"?!!W:i==="network"?T?(F.find($=>$.chain===T)?.addresses.length??0)>0:!1:E.size>0,[F,T,W,E.size,i,h.length]),H=c.useCallback(()=>{a()},[a]),Q=c.useCallback(async()=>{if(!N){y(!0);try{await M.reject("rejected"),n({to:"/"})}finally{y(!1)}}},[M,N,n]),ae=c.useCallback(async()=>{if(!(!q||N)){if(ee){ks(async $=>{y(!0);try{const se=m?.trim()??"";let re=[],ge=[];if(i==="main"){if(!W)return!1;re=M.handleMainAddresses(W),ge=[W]}else if(i==="network"){if(!T)return!1;re=M.handleNetworkAddresses(h,T),ge=h}else{const ve=h.filter(De=>E.has(De.id));re=M.handleAllAddresses(ve),ge=ve}return re=await M.applySensitiveOptions(re,ge,{password:$,signMessage:se,getMain:G}),await M.approve(re),n({to:"/"}),!0}catch{return!1}finally{y(!1)}}),r("WalletLockConfirmJob",{title:t("passwordConfirm.title")});return}y(!0);try{let $=[];if(i==="main"){if(!W)return;$=M.handleMainAddresses(W)}else if(i==="network"){if(!T)return;$=M.handleNetworkAddresses(h,T)}else{const se=h.filter(re=>E.has(re.id));$=M.handleAllAddresses(se)}await M.approve($),n({to:"/"})}finally{y(!1)}}},[M,q,N,n,ee,G,r,T,W,E,m,t,i,h]);return i==="network"&&l&&!I?e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(K,{title:t("title.address"),onBack:H}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-destructive",children:t("error.unknownChain")}),e.jsx("div",{className:"mt-4",children:e.jsx(J,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]}):v?e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(K,{title:t("title.address"),onBack:H}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-destructive",children:v}),e.jsx("div",{className:"mt-4",children:e.jsx(J,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]}):e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(K,{title:t("title.address"),onBack:H}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[p&&e.jsx(sc,{appInfo:p}),e.jsx("div",{className:"px-1 text-sm text-foreground",children:t("address.shareWith")}),e.jsx(Of,{permissions:V}),e.jsx("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:[i==="main"&&t("address.scope.main"),i==="network"&&t("address.scope.network",{chainName:(T?b[T]:void 0)??T??""}),i==="all"&&t("address.scope.all")]})}),e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[i==="main"&&e.jsx(Bf,{wallets:S,...P?{selectedId:P}:{},onSelect:$=>_($.id)}),i==="network"&&g&&T&&e.jsx("div",{className:"flex w-full aspect-[1.6/1] items-stretch",children:e.jsx(Io,{wallet:g,chain:T,chainName:b[T]??T,address:ne,priority:"low",onOpenChainSelector:I?void 0:()=>R(!0)})}),i==="all"&&e.jsxs("div",{className:"space-y-2",children:[h.length===0&&e.jsx("div",{className:"py-6 text-center text-sm text-muted-foreground",children:t("address.noWallets")}),h.map($=>{const se=E.has($.id);return e.jsxs("button",{type:"button",onClick:()=>{D(re=>{const ge=new Set(re);return ge.has($.id)?ge.delete($.id):ge.add($.id),ge})},className:L("flex w-full items-center justify-between rounded-lg border px-3 py-2 text-left transition-colors","hover:bg-muted/50",se?"border-primary bg-primary/5":"border-border bg-background"),"aria-pressed":se,children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-medium",children:$.name}),e.jsx("div",{className:"truncate font-mono text-xs text-muted-foreground",children:$.address})]}),e.jsx("div",{className:L("flex size-5 items-center justify-center rounded border",se?"border-primary bg-primary text-primary-foreground":"border-border bg-background"),"aria-hidden":"true",children:se?"":""})]},$.id)})]})]})]}),e.jsx("div",{className:"sticky bottom-0 border-t border-border bg-background p-4 safe-area-inset-bottom",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(J,{type:"button",variant:"outline",className:"flex-1",onClick:Q,disabled:N,children:t("button.reject")}),e.jsx(J,{type:"button",className:"flex-1",onClick:ae,disabled:!q||N,children:t("button.approve")})]})}),z&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/50",onClick:()=>R(!1),children:e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-background rounded-t-2xl",onClick:$=>$.stopPropagation(),children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("address.selectNetwork")})}),e.jsx("div",{className:"max-h-[60vh] space-y-2 overflow-y-auto p-4",children:ie.map($=>{const se=g?.chainAddresses.find(re=>re.chain===$);return e.jsxs("button",{onClick:()=>{k($),R(!1)},className:L("flex w-full items-center gap-3 rounded-xl p-4 transition-colors",$===T?"bg-primary/10 ring-1 ring-primary":"bg-muted/50 hover:bg-muted"),children:[e.jsx(Et,{chain:$,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:b[$]??$}),e.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:se?.address?Nb(se.address):"---"})]}),$===T&&e.jsx(je,{className:"size-5 text-primary"})]},$)})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})]})}function Nb(t,s=10,n=8){return t.length<=s+n+3?t:`${t.slice(0,s)}...${t.slice(-n)}`}cu.__docgenInfo={description:"",methods:[],displayName:"AddressAuthPage"};const lu=({params:t})=>e.jsx(le,{children:e.jsx(me,{params:t,children:e.jsx(cu,{})})});lu.__docgenInfo={description:"",methods:[],displayName:"AuthorizeAddressActivity"};const wb=300*1e3;function yo(t){return typeof t=="object"&&t!==null}function Xe(t,s){const n=t[s];if(typeof n=="string")return n;if(typeof n=="number"&&Number.isFinite(n))return String(n)}function kb(t,s,n){const a=Xe(t,s)?.trim();return a?{ok:!0,value:a}:{ok:!1,error:`signaturedata missing field: ${n}`}}function Ft(t,s){for(const n of s){const a=Xe(t,n.key)?.trim();if(a)return{ok:!0,value:a}}return{ok:!1,error:`signaturedata missing field: ${s.map(n=>n.label).join(" / ")}`}}function Cb(t){if(typeof t=="string"){const s=t.trim().toLowerCase();return s==="message"?{ok:!0,value:"message"}:s==="transfer"?{ok:!0,value:"transfer"}:s==="destroy"||s==="destory"?{ok:!0,value:"destory"}:{ok:!1,error:`Unsupported signature type: ${t}`}}return typeof t=="number"&&Number.isInteger(t)?t===0?{ok:!0,value:"message"}:t===1?{ok:!0,value:"transfer"}:t===7?{ok:!0,value:"destory"}:{ok:!1,error:`Unsupported signature type: ${t}`}:{ok:!1,error:"signaturedata.type must be string or number"}}function Sb(t){if(t===void 0||t.trim()==="")return{ok:!1,error:"Missing signaturedata parameter"};let s;try{s=JSON.parse(t)}catch{return{ok:!1,error:"signaturedata is not valid JSON"}}if(!Array.isArray(s))return{ok:!1,error:"signaturedata must be a JSON array"};if(s.length===0)return{ok:!1,error:"signaturedata cannot be an empty array"};const n=s[0];if(!yo(n))return{ok:!1,error:"signaturedata[0] must be an object"};const a=Cb(n.type);if(!a.ok)return a;const r=Ft(n,[{key:"chainName",label:"chainName"},{key:"chain",label:"chain"}]);if(!r.ok)return r;const o=r.value;if(a.value==="message"){const d=Ft(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!d.ok)return d;const i=kb(n,"message","message");return i.ok?{ok:!0,item:{type:"message",payload:{chainName:o,senderAddress:d.value,message:i.value}}}:i}if(a.value==="transfer"){const d=Ft(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!d.ok)return d;const i=Ft(n,[{key:"receiveAddress",label:"receiveAddress"},{key:"to",label:"to"}]);if(!i.ok)return i;const l=Ft(n,[{key:"balance",label:"balance"},{key:"amount",label:"amount"}]);if(!l.ok)return l;const m=Xe(n,"fee")?.trim(),u=Xe(n,"assetType")?.trim();let f;const h=n.contractInfo;if(yo(h)){const g=Xe(h,"assetType")?.trim(),b=h.decimals,p=Xe(h,"contractAddress")?.trim(),x=typeof b=="number"&&Number.isFinite(b)?b:typeof b=="string"&&b.trim()!==""?Number(b):void 0;g&&p&&typeof x=="number"&&Number.isFinite(x)&&(f={assetType:g,contractAddress:p,decimals:x})}return{ok:!0,item:{type:"transfer",payload:{chainName:o,senderAddress:d.value,receiveAddress:i.value,balance:l.value,...m?{fee:m}:{},...u?{assetType:u}:{},...f?{contractInfo:f}:{}}}}}{const d=Ft(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!d.ok)return d;const i=Ft(n,[{key:"destoryAmount",label:"destoryAmount"},{key:"amount",label:"amount"}]);if(!i.ok)return i;const l=Xe(n,"destoryAddress")?.trim()??Xe(n,"to")?.trim()??d.value,m=Xe(n,"fee")?.trim(),u=Xe(n,"assetType")?.trim();return{ok:!0,item:{type:"destory",payload:{chainName:o,senderAddress:d.value,destoryAddress:l,destoryAmount:i.value,...m?{fee:m}:{},...u?{assetType:u}:{}}}}}}function Ab(t){return typeof t=="object"&&t!==null&&"senderAddress"in t&&"receiveAddress"in t&&"balance"in t}function Ib(t){return typeof t=="object"&&t!==null&&"senderAddress"in t&&"message"in t&&!("receiveAddress"in t)}function Tb(t){return typeof t=="object"&&t!==null&&"senderAddress"in t&&"destoryAddress"in t&&"destoryAmount"in t}function bo(t){return t.contractInfo?.assetType?t.contractInfo.assetType.toUpperCase():t.assetType?t.assetType.toUpperCase():{ethereum:"ETH",bitcoin:"BTC",tron:"TRX",binance:"BNB",bsc:"BNB"}[t.chainName?.toLowerCase()??""]??"TOKEN"}function Pb(t,s,n){const a=parseFloat(t)||0,r=parseFloat(s)||0,o=parseFloat(n??"0")||0,d=r+o;return{sufficient:a>=d,required:d.toString()}}function du(){const{t}=O("authorize"),{t:s}=O("common"),{navigate:n,goBack:a}=de(),{push:r}=Z(),o=st(),{id:d,signaturedata:i}=he(),l=Ae(Re,Qs.getCurrentWallet),[m,u]=c.useState(null),[f,h]=c.useState(null),[g,b]=c.useState(null),[p,x]=c.useState(!1),v=c.useMemo(()=>new pc(Us,d),[d]);c.useEffect(()=>{let k=!1;async function A(){b(null);try{const w=Sb(i);if(!w.ok){b(w.error);return}const E=await Us.getCallerAppInfo(d);if(k)return;u(E);const D={eventId:d,type:w.item.type,payload:w.item.payload,appName:E.appName,appHome:E.origin,appLogo:E.appIcon};h(D)}catch{if(k)return;b(t("error.authFailed"))}}return A(),()=>{k=!0}},[d,i,t]),c.useEffect(()=>{const k=window.setTimeout(()=>{(async()=>(await v.reject("timeout"),o.show({message:t("error.timeout"),position:"center"}),n({to:"/"})))()},wb);return()=>{window.clearTimeout(k)}},[v,n,t,o]);const j=c.useMemo(()=>!f||!Ab(f.payload)?null:f.payload,[f]),N=c.useMemo(()=>!f||!Ib(f.payload)?null:f.payload,[f]),y=c.useMemo(()=>!f||!Tb(f.payload)?null:f.payload,[f]),S=c.useMemo(()=>{if(!l)return{sufficient:!0,required:"0",walletBalance:"0"};const k=j?{chainName:j.chainName,amount:j.balance,fee:j.fee}:y?{chainName:y.chainName,amount:y.destoryAmount,fee:y.fee}:null;if(!k)return{sufficient:!0,required:"0",walletBalance:"0"};const w=l.chainAddresses.find(D=>D.chain.toLowerCase()===k.chainName?.toLowerCase())?"1.0":"0";return{...Pb(w,k.amount,k.fee),walletBalance:w}},[l,y,j]),C=c.useMemo(()=>j?bo(j):y?bo(y):"TOKEN",[y,j]),P=c.useCallback(()=>{a()},[a]),_=c.useCallback(async()=>{if(!p){x(!0);try{await v.reject(S.sufficient?"rejected":"insufficient_balance"),n({to:"/"})}finally{x(!1)}}},[v,S.sufficient,p,n]),I=c.useCallback(()=>{S.sufficient&&(p||(ks(async k=>{x(!0);try{const A=l?.encryptedMnemonic;if(!A||!f)return!1;let w="";if(f.type==="message"){if(!N)return!1;const E=await v.handleMessageSign(N,A,k);w=typeof E=="string"?E:E.signature??""}else if(f.type==="transfer"){if(!j)return!1;const E=await v.handleTransferSign(j,A,k);w=typeof E=="string"?E:E.signature??""}else if(f.type==="destory"){if(!y)return!1;const E=await v.handleDestroySign(y,A,k);w=typeof E=="string"?E:E.signature??""}else return!1;return await v.approve(w),n({to:"/"}),!0}catch{return!1}finally{x(!1)}}),r("WalletLockConfirmJob",{title:t("button.confirm")})))},[v,S.sufficient,l?.encryptedMnemonic,y,p,N,n,r,f,t,j]);if(g)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("title.signature"),onBack:P}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsx("p",{className:"text-destructive text-sm",children:g}),e.jsx("div",{className:"mt-4",children:e.jsx(J,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]});const T=f?.type==="message"?t("signature.type.message"):f?.type==="destory"?t("signature.type.destroy"):t("title.signature");return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:T,onBack:P}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[m&&e.jsx(sc,{appInfo:m}),e.jsx("div",{className:"text-foreground px-1 text-sm",children:t("signature.reviewTransaction")}),j&&e.jsxs(e.Fragment,{children:[e.jsx(ai,{from:j.senderAddress,to:j.receiveAddress,amount:`${j.balance} ${C}`,...j.fee?{fee:`${j.fee} ${C}`}:{},chainId:j.chainName}),!S.sufficient&&e.jsx(ri,{balance:S.walletBalance,required:S.required,symbol:C})]}),N&&e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-sm",children:t("signature.messageToSign")}),e.jsx("div",{className:L("bg-muted/50 rounded-lg p-3","font-mono text-sm break-all whitespace-pre-wrap","max-h-48 overflow-y-auto"),children:N.message})]}),y&&e.jsxs(e.Fragment,{children:[e.jsx(ai,{from:y.senderAddress,to:y.destoryAddress,amount:`${y.destoryAmount} ${C}`,...y.fee?{fee:`${y.fee} ${C}`}:{},chainId:y.chainName}),!S.sufficient&&e.jsx(ri,{balance:S.walletBalance,required:S.required,symbol:C})]}),f&&e.jsx("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:e.jsxs("div",{className:"text-muted-foreground text-sm",children:[f.type==="transfer"&&t("signature.type.transfer"),f.type==="message"&&t("signature.type.message"),f.type==="destory"&&t("signature.type.destroy")]})})]}),e.jsx("div",{className:"border-border bg-background safe-area-inset-bottom sticky bottom-0 border-t p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(J,{type:"button",variant:"outline",className:"flex-1",onClick:_,disabled:p,children:t("button.reject")}),e.jsx(J,{type:"button",className:"flex-1",onClick:I,disabled:p||!S.sufficient,children:t("button.confirm")})]})})]})}du.__docgenInfo={description:"",methods:[],displayName:"SignatureAuthPage"};const uu=({params:t})=>e.jsx(le,{children:e.jsx(me,{params:t,children:e.jsx(du,{})})});uu.__docgenInfo={description:"",methods:[],displayName:"AuthorizeSignatureActivity"};function mu({walletName:t,onEnterWallet:s,className:n}){const{t:a}=O("onboarding");return e.jsxs("div",{"data-testid":"import-success-step",className:L("flex min-h-screen flex-col items-center justify-center px-6 py-8",n),children:[e.jsx("div",{className:"mb-6 flex size-20 items-center justify-center rounded-full bg-green-100 dark:bg-green-900/30",children:e.jsx(Ns,{className:"size-10 text-green-600 dark:text-green-400"})}),e.jsx("h1",{"data-testid":"success-message",className:"mb-2 text-2xl font-bold",children:a("import.success.title")}),e.jsx("p",{className:"text-muted-foreground mb-8 text-center",children:e.jsx(ec,{i18nKey:"import.success.description",ns:"onboarding",values:{name:t},components:{bold:e.jsx("span",{className:"text-foreground font-medium"})}})}),e.jsx("div",{className:"w-full max-w-xs",children:e.jsxs("button",{type:"button","data-testid":"enter-wallet-button",onClick:s,className:L("flex w-full items-center justify-center gap-2 rounded-full py-3 font-medium transition-colors","bg-primary hover:bg-primary/90 text-primary-foreground"),children:[e.jsx("span",{children:a("import.success.enterWallet")}),e.jsx(Le,{className:"size-5"})]})})]})}mu.__docgenInfo={description:"Success screen shown after wallet import",methods:[],displayName:"ImportWalletSuccess",props:{walletName:{required:!0,tsType:{name:"string"},description:"Wallet name"},onEnterWallet:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback when user chooses to enter wallet"},className:{required:!1,tsType:{name:"string"},description:"Additional class name"}}};we.t.bind(we);function Eb(t){if(!Po(t))throw new Error("Invalid mnemonic");return Am(t.join(" "))}function _b(t){return new Set(t.map(s=>s.address.toLowerCase()))}const Mb=we.t.bind(we),ba={isDuplicate:!1,type:"none"};function Rb(t){const[s,n]=c.useState(ba),[a,r]=c.useState(!1),[o,d]=c.useState(null),i=c.useCallback(async m=>{r(!0),d(null);try{const u=Eb(m),f=_b(u),h=await t.getAllAddresses();for(const x of h)if(f.has(x.address.toLowerCase())){const v={isDuplicate:!0,type:"address",matchedWallet:{id:x.walletId,name:x.walletName,importType:"mnemonic",matchedAddress:x.address}};return n(v),v}const b=(await t.getAllMainWallets()).filter(x=>x.importType==="privateKey");for(const x of b)for(const v of x.addresses)if(f.has(v.address.toLowerCase())){const j={isDuplicate:!0,type:"privateKey",matchedWallet:{id:x.id,name:x.name,importType:"privateKey",matchedAddress:v.address}};return n(j),j}const p={isDuplicate:!1,type:"none"};return n(p),p}catch(u){const f=u instanceof Error?u.message:Mb("error:duplicate.detectionFailed");return d(f),ba}finally{r(!1)}},[t]),l=c.useCallback(()=>{n(ba),d(null)},[]);return{result:s,isChecking:a,error:o,check:i,reset:l}}const Lb={getAllAddresses:async()=>[],getAllMainWallets:async()=>[],findWalletByAddress:async()=>null};function fu(){const{navigate:t,goBack:s}=de(),{push:n}=Z(),{t:a}=O(["onboarding","common","wallet"]),r=Ys(),o=dt().snapshot,d=lm(),i=es(),[l,m]=c.useState("keyType"),[u,f]=c.useState("mnemonic"),[h,g]=c.useState(!1),[b,p]=c.useState([]),[x,v]=c.useState(""),[j,N]=c.useState(null),[y,S]=c.useState([]),[C,P]=c.useState(!1),[_,I]=c.useState(""),[T,k]=c.useState(null),[A,w]=c.useState([]),[E,D]=c.useState(!1);c.useEffect(()=>{!E&&r.length>0&&(w(Go(r)),D(!0))},[r,E]);const z=Rb(Lb),R=(()=>{switch(l){case"keyType":return 1;case"mnemonic":case"arbitrary":return 2;case"collision":return 2;case"pattern":return 3;case"chains":return 4;case"theme":return 5;case"success":return 5;default:return 1}})(),V=c.useCallback(()=>{switch(l){case"keyType":s();break;case"mnemonic":case"arbitrary":m("keyType"),z.reset();break;case"collision":m("mnemonic"),z.reset();break;case"pattern":m(u==="arbitrary"?"arbitrary":"mnemonic");break;case"chains":m("pattern");break;case"theme":m("chains");break}},[l,s,z,u]),M=c.useCallback(()=>{m("pattern")},[]),B=c.useCallback(ae=>{I(ae),m("chains")},[]),G=c.useCallback(()=>{if(u==="mnemonic"){m("mnemonic");return}if(h){m("arbitrary");return}Vv(()=>{g(!0),m("arbitrary")}),n("SecurityWarningJob",{})},[u,h,n]),ee=c.useCallback(async ae=>{p(ae.mnemonic);const $=await z.check(ae.mnemonic);if($.isDuplicate){if($.type==="address")return;if($.type==="privateKey"){m("collision");return}}M()},[z,M]),W=c.useCallback(async()=>{M()},[M]),F=c.useCallback(()=>{m("mnemonic"),z.reset()},[z]),ie=c.useCallback(async(ae,$)=>{P(!0);try{const se=ae.join(" "),ge=(await Qo({mnemonic:se,selectedChainIds:A,chainConfigs:r})).map(({chainId:zt,address:Ot,publicKey:pt})=>({chain:zt,address:Ot,publicKey:pt??"",tokens:[]})),ve=ge[0];if(!ve)throw new Error("No chain addresses derived");const De=wa(ve.address),ft=await ye.createWallet({name:a("onboarding:create.generatedNamePattern",{word:Tn(i),suffix:a("onboarding:create.walletSuffix")}),keyType:"mnemonic",address:ve.address,chain:ve.chain,chainAddresses:ge,themeHue:De},se,$,De);k(ft.id),m("theme")}catch{}finally{P(!1)}},[r,A,a]),ne=c.useCallback(async ae=>{const $=x.trim();if($&&y.length!==0){P(!0);try{const se=y[0];if(!se)throw new Error("No enabled bioforest chains");const re=wa(se.address),ge=y.map(De=>({chain:De.chainId,address:De.address,publicKey:"",tokens:[]})),ve=await ye.createWallet({name:a("onboarding:create.generatedNamePattern",{word:Tn(i),suffix:a("onboarding:create.walletSuffix")}),keyType:"arbitrary",address:se.address,chain:se.chainId,chainAddresses:ge,themeHue:re},$,ae,re);k(ve.id),m("theme")}catch{}finally{P(!1)}}},[y,x,a]),q=c.useCallback(()=>{t({to:"/",replace:!0})},[t]),H=c.useCallback(async()=>{if(!C){if(u==="arbitrary"){await ne(_);return}b.length!==0&&await ie(b,_)}},[ne,ie,C,u,b,_]),Q=c.useCallback(()=>{t({to:"/"})},[t]);return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[l==="keyType"&&e.jsxs(e.Fragment,{children:[e.jsx(K,{title:a("onboarding:keyType.title"),onBack:V}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(bt,{total:5,current:R})}),e.jsxs("div",{"data-testid":"key-type-step",className:"flex-1 space-y-6 p-4",children:[e.jsx(Ff,{value:u,onChange:ae=>{f(ae),ae==="mnemonic"&&(v(""),S([]))}}),e.jsx(J,{type:"button","data-testid":"continue-button",onClick:G,className:"w-full",children:a("common:continue")})]})]}),l==="mnemonic"&&e.jsxs(e.Fragment,{children:[e.jsx(K,{title:a("onboarding:recover.title"),onBack:V}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(bt,{total:5,current:R})}),e.jsx("div",{"data-testid":"mnemonic-step",className:"flex-1 p-4",children:e.jsx(hm,{onSubmit:ee,isSubmitting:z.isChecking})})]}),l==="arbitrary"&&e.jsxs(e.Fragment,{children:[e.jsx(K,{title:a("onboarding:keyType.arbitrary"),onBack:V}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(bt,{total:5,current:R})}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx(Wf,{value:x,onChange:ae=>{N(null),v(ae)},disabled:C}),j&&e.jsxs("div",{className:"bg-destructive/10 text-destructive flex items-start gap-2 rounded-lg px-3 py-2 text-sm",children:[e.jsx(_t,{className:"mt-0.5 size-4 shrink-0"}),e.jsx("span",{children:j})]}),e.jsx($f,{secret:x,enabledBioforestChainConfigs:o?d:void 0,onDerived:S}),e.jsxs(J,{type:"button",className:"w-full",disabled:C||x.trim()!==""&&y.length===0,onClick:()=>{if(!x.trim()){N(a("onboarding:arbitraryKey.required"));return}M()},children:[C&&e.jsx(be,{className:"size-4 animate-spin"}),a("common:continue")]})]})]}),l==="collision"&&e.jsxs(e.Fragment,{children:[e.jsx(K,{title:a("onboarding:recover.addressConflict"),onBack:V}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(bt,{total:5,current:R})}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(qf,{result:z.result,onConfirm:W,onCancel:F,isLoading:C})})]}),l==="pattern"&&e.jsxs(e.Fragment,{children:[e.jsx(K,{title:a("onboarding:recover.setWalletLock"),onBack:V}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(bt,{total:5,current:R})}),e.jsx("div",{"data-testid":"pattern-step",className:"flex-1 p-4",children:e.jsx(lr,{onComplete:B,minPoints:4})})]}),l==="chains"&&e.jsxs(e.Fragment,{children:[e.jsx(K,{title:a("onboarding:chainSelector.title"),onBack:V}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(bt,{total:5,current:R})}),e.jsx("div",{"data-testid":"chains-step",className:"flex-1 p-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Zs,{icon:e.jsx(Ns,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:a("onboarding:chainSelector.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:a("onboarding:chainSelector.subtitle")})]}),r.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(Te,{})}):e.jsx(dr,{"data-testid":"chain-selector",chains:r,selectedChains:A,onSelectionChange:w}),e.jsx(Ue,{variant:"mint",className:"w-full","data-testid":"chains-continue-button",disabled:A.length===0,onClick:H,children:a("common:next")})]})})]}),l==="theme"&&T&&e.jsxs(e.Fragment,{children:[e.jsx(K,{title:a("onboarding:create.themeTitle")}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(bt,{total:5,current:R})}),e.jsx("div",{"data-testid":"theme-step",className:"flex-1 p-4",children:e.jsx(Xn,{mode:"edit-only",walletId:T,onEditOnlyComplete:q})})]}),l==="success"&&e.jsx(mu,{walletName:a("wallet:defaultName"),onEnterWallet:Q})]})}fu.__docgenInfo={description:`Onboarding recover wallet page
Implements wallet recovery with duplicate detection per openspec/changes/add-wallet-recover-duplicate-guards`,methods:[],displayName:"OnboardingRecoverPage"};const pu=()=>e.jsx(le,{children:e.jsx(fu,{})});pu.__docgenInfo={description:"",methods:[],displayName:"OnboardingRecoverActivity"};const yn={symbol:"USDT",balance:1234.56,fiatValue:"1234.56"},Db=[{id:"1",type:"send",status:"confirmed",amount:oe.fromFormatted("100",6,"USDT"),symbol:"USDT",address:"0xabcd...1234",timestamp:new Date(Date.now()-36e5)},{id:"2",type:"receive",status:"confirmed",amount:oe.fromFormatted("500",6,"USDT"),symbol:"USDT",address:"0x1234...abcd",timestamp:new Date(Date.now()-864e5)}];function hu(){const{t}=O("token"),{navigate:s,goBack:n}=de();return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(K,{title:yn.symbol,onBack:n}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsx("div",{className:"text-center",children:e.jsx(Rf,{value:yn.balance,symbol:yn.symbol,fiatValue:yn.fiatValue,size:"lg"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(Ue,{variant:"mint",className:"flex-1",onClick:()=>s({to:"/send",search:{address:void 0,chain:void 0,amount:void 0}}),children:[e.jsx(Rm,{className:"mr-2 size-4"}),t("detail.send")]}),e.jsxs(Ue,{variant:"blue",className:"flex-1",onClick:()=>s({to:"/receive"}),children:[e.jsx(Bs,{className:"mr-2 size-4"}),t("detail.receive")]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold",children:t("detail.transactionHistory")}),e.jsx(tc,{transactions:Db,emptyTitle:t("detail.noTransactions"),emptyDescription:t("detail.noTransactionsDesc")})]})]})]})}hu.__docgenInfo={description:"",methods:[],displayName:"TokenDetailPage"};const xu=({params:t})=>e.jsx(le,{children:e.jsx(me,{params:t,children:e.jsx(hu,{})})});xu.__docgenInfo={description:"",methods:[],displayName:"TokenDetailActivity"};function gu(){const{t}=O("common"),{goBack:s}=de(),{push:n}=Z(),r=Ae(zs).contacts,o=Ae(Re,Qs.getCurrentWallet),[d,i]=c.useState(""),l=c.useRef(null),m=c.useMemo(()=>d.trim()?Ka.searchContacts(zs.state,d.trim()):r,[r,d]),u=c.useCallback(()=>{s()},[s]),f=c.useCallback(()=>{n("ContactEditJob",{})},[n]),h=c.useCallback(p=>{n("ContactEditJob",{contactId:p.id})},[n]),g=c.useCallback(p=>{n("ContactShareJob",{name:p.name,addresses:JSON.stringify(p.addresses.map(x=>({address:x.address,label:x.label}))),memo:p.memo,avatar:p.avatar})},[n]),b=c.useCallback(p=>{l.current=p,o?.encryptedMnemonic?(ks(async x=>{try{return await Vt(o.encryptedMnemonic,x)?(Os.deleteContact(p.id),l.current=null,!0):!1}catch{return!1}}),n("WalletLockConfirmJob",{title:t("addressBook.deleteTitle"),description:t("addressBook.deleteConfirm",{name:p.name})})):(Os.deleteContact(p.id),l.current=null)},[o?.encryptedMnemonic,n,t]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("addressBook.title"),onBack:u,rightAction:e.jsx("button",{onClick:f,className:L("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":t("a11y.addContact"),"data-testid":"address-book-add-button",children:e.jsx(ut,{className:"size-5"})})}),e.jsx("div",{className:"px-4 py-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(tn,{className:"text-muted-foreground absolute top-1/2 left-3 size-4 -translate-y-1/2"}),e.jsx("input",{type:"text",value:d,onChange:p=>i(p.target.value),placeholder:t("addressBook.searchPlaceholder"),className:L("border-border bg-background w-full rounded-xl border py-2.5 pr-4 pl-10","focus:ring-primary focus:ring-2 focus:outline-none")})]})}),e.jsx("div",{className:"flex-1 p-4",children:m.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[e.jsx(nf,{className:"text-muted-foreground/50 size-12"}),e.jsx("p",{className:"text-muted-foreground",children:t(d?"addressBook.noResults":"addressBook.noContacts")}),!d&&e.jsx("button",{onClick:f,className:L("bg-primary rounded-full px-6 py-2.5 text-sm font-medium text-primary-foreground","hover:bg-primary/90 active:bg-primary/80"),children:t("contact.addTitle")})]}):e.jsx("div",{className:"space-y-2",children:m.map(p=>e.jsx(zb,{contact:p,onShare:()=>g(p),onEdit:()=>h(p),onDelete:()=>b(p)},p.id))})})]})}function zb({contact:t,onEdit:s,onDelete:n,onShare:a}){const{t:r}=O("common"),[o,d]=c.useState(!1);return e.jsx("div",{className:L("bg-card rounded-xl p-4 shadow-sm","transition-colors"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(js,{src:t.avatar||(t.addresses[0]?.address?Jt(t.addresses[0].address):void 0),size:40}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"truncate font-medium",children:t.name}),t.addresses.length>0&&e.jsxs("p",{className:"text-muted-foreground truncate font-mono text-xs",children:[t.addresses[0]?.address,t.addresses.length>1&&` (+${t.addresses.length-1})`]}),t.memo&&e.jsx("p",{className:"text-muted-foreground mt-1 truncate text-xs",children:t.memo})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>d(!o),className:L("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":r("a11y.moreActions"),children:e.jsx(Hf,{className:"text-muted-foreground size-4"})}),o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>d(!1)}),e.jsxs("div",{className:"bg-popover border-border absolute top-full right-0 z-20 mt-1 w-32 rounded-lg border py-1 shadow-lg",children:[e.jsx("button",{onClick:()=>{d(!1),a()},className:"hover:bg-muted w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.shareContact")}),e.jsx("button",{onClick:()=>{d(!1),s()},className:"hover:bg-muted w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.edit")}),e.jsx("button",{onClick:()=>{d(!1),n()},className:"text-destructive hover:bg-destructive/10 w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.delete")})]})]})]})]})})}gu.__docgenInfo={description:"",methods:[],displayName:"AddressBookPage"};const vu=()=>e.jsx(le,{children:e.jsx(gu,{})});vu.__docgenInfo={description:"",methods:[],displayName:"AddressBookActivity"};function yu({open:t,onOpenChange:s}){const{t:n}=O("common"),a=Mt(),r=Ya(),o=sm(),d=nm(),i=ts(),l=c.useCallback(m=>{!o.includes(m)&&!d||ds.toggleWalletSelection(m)},[o,d]);return e.jsx(Ct,{open:t,onOpenChange:s,children:e.jsxs(St,{side:"bottom",className:"rounded-t-2xl",children:[e.jsx(At,{className:"pb-4",children:e.jsx(It,{children:n("myCard.selectWallets")})}),e.jsxs("div",{className:"max-h-[50vh] overflow-y-auto pb-[env(safe-area-inset-bottom)]",children:[a.map(m=>{const u=r[m.id]||m.chain,f=m.chainAddresses.find(b=>b.chain===u),h=o.includes(m.id),g=!h&&!d;return e.jsxs("button",{type:"button",onClick:()=>l(m.id),disabled:g,className:L("flex w-full items-center gap-3 rounded-lg p-3 text-left transition-colors",h&&"bg-primary/10",!g&&"hover:bg-muted",g&&"cursor-not-allowed opacity-50"),children:[e.jsx(Et,{chain:u,size:"md"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium",children:m.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{children:i[u]||u}),e.jsxs("span",{className:"truncate font-mono text-xs",children:[f?.address.slice(0,8),"...",f?.address.slice(-6)]})]})]}),h&&e.jsx("div",{className:"flex size-6 items-center justify-center rounded-full bg-primary",children:e.jsx(je,{className:"size-4 text-primary-foreground"})})]},m.id)}),a.length===0&&e.jsx("div",{className:"py-8 text-center text-muted-foreground",children:n("noAssets")})]}),e.jsx("p",{className:"py-4 text-center text-xs text-muted-foreground",children:n("myCard.maxWallets",{max:3})})]})})}yu.__docgenInfo={description:"",methods:[],displayName:"WalletPickerSheet",props:{open:{required:!0,tsType:{name:"boolean"},description:""},onOpenChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(open: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"open"}],return:{name:"void"}}},description:""}}};function Ob(t,s){const[n,a]=c.useState(!1),{filename:r,shareTitle:o,shareText:d}=s,i=c.useCallback(async()=>{const m=t.current;if(!(!m||n)){a(!0);try{const{snapdom:u}=await Pt(async()=>{const{snapdom:f}=await import("./snapdom-CO8q8LPW.js").then(h=>h.s);return{snapdom:f}},__vite__mapDeps([0,1]),import.meta.url);await u.download(m,{type:"png",filename:`${r}.png`,scale:2,quality:1})}catch(u){console.error("Download failed:",u)}finally{a(!1)}}},[t,r,n]),l=c.useCallback(async()=>{const m=t.current;if(!(!m||!navigator.share||n)){a(!0);try{const{snapdom:u}=await Pt(async()=>{const{snapdom:b}=await import("./snapdom-CO8q8LPW.js").then(p=>p.s);return{snapdom:b}},__vite__mapDeps([0,1]),import.meta.url),h=await(await u(m,{scale:2})).toBlob(),g=new File([h],`${r}.png`,{type:"image/png"});await navigator.share({title:o,text:d,files:[g]})}catch{}finally{a(!1)}}},[t,r,o,d,n]);return{isProcessing:n,download:i,share:l,canShare:typeof navigator<"u"&&"share"in navigator}}function bu(){const{t}=O(["common","settings"]),{goBack:s}=de(),n=c.useRef(null),a=c.useRef(null),r=Ga(),o=Mt(),d=Ya(),i=ts(),[l,m]=c.useState(!1),[u,f]=c.useState(r.username),[h,g]=c.useState(!1);c.useEffect(()=>{if(!r.avatar&&o.length>0){const I=o[0]?.chainAddresses[0]?.address;I&&ds.initializeDefaultAvatar(I)}},[r.avatar,o]),c.useEffect(()=>{if(r.selectedWalletIds.length===0&&o.length>0){const I=o[0];I&&ds.toggleWalletSelection(I.id)}},[r.selectedWalletIds,o]);const b=c.useMemo(()=>r.selectedWalletIds.map(I=>o.find(T=>T.id===I)).filter(I=>!!I).map(I=>{const T=d[I.id]||I.chain,k=I.chainAddresses.find(A=>A.chain===T);return{wallet:I,chain:T,address:k?.address}}).filter(I=>I.address),[r.selectedWalletIds,o,d]),p=c.useMemo(()=>b.filter(I=>!!I.address).map(({wallet:I,address:T})=>({address:T,label:I.name})),[b]),x=c.useMemo(()=>p.length===0?"":nr({name:r.username||t("myCard.defaultName"),addresses:p,avatar:r.avatar}),[r.username,r.avatar,p,t]),v=c.useCallback(()=>{ds.randomizeAvatar()},[]),j=c.useCallback(()=>{f(r.username),m(!0)},[r.username]),N=c.useCallback(()=>{ds.setUsername(u),m(!1)},[u]),y=c.useCallback(I=>{I.key==="Enter"?N():I.key==="Escape"&&m(!1)},[N]);c.useEffect(()=>{l&&n.current?.focus()},[l]);const{isProcessing:S,download:C,share:P}=Ob(a,{filename:`my-card-${Date.now()}`,shareTitle:t("myCard.title"),shareText:r.username||t("myCard.defaultName")}),_=r.username||t("myCard.defaultName");return e.jsxs("div",{className:"flex min-h-screen flex-col bg-background",children:[e.jsx(K,{title:t("myCard.title"),onBack:s}),e.jsxs("div",{className:"flex flex-1 flex-col items-center p-6",children:[e.jsxs("button",{type:"button",onClick:v,className:"group relative mb-4 cursor-pointer transition-transform hover:scale-105","aria-label":t("myCard.changeAvatar"),children:[e.jsx(js,{src:r.avatar,size:80}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center rounded-full bg-black/50 opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx("span",{className:"text-xs text-white",children:t("myCard.changeAvatar")})})]}),l?e.jsx("div",{className:"mb-6 flex items-center gap-2",children:e.jsx(Ve,{ref:n,value:u,onChange:I=>f(I.target.value),onBlur:N,onKeyDown:y,placeholder:t("myCard.usernamePlaceholder"),className:"w-48 text-center"})}):e.jsxs("button",{type:"button",onClick:j,className:"group mb-6 flex items-center gap-2 text-xl font-semibold",children:[e.jsx("span",{children:_}),e.jsx(Uf,{className:"size-4 text-muted-foreground opacity-50 group-hover:opacity-100"})]}),p.length>0?e.jsx("div",{ref:a,className:"mb-6",children:e.jsx(rr,{name:_,avatar:r.avatar,addresses:p,qrContent:x})}):e.jsx("div",{className:"mb-6 flex h-[300px] w-[320px] items-center justify-center rounded-3xl bg-muted",children:e.jsx("p",{className:"text-muted-foreground",children:t("myCard.noWalletsSelected")})}),e.jsxs("div",{className:"mb-6 w-full max-w-[320px]",children:[e.jsx("h3",{className:"mb-2 text-sm font-medium text-muted-foreground",children:t("myCard.selectWallets")}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[b.map(({wallet:I,chain:T})=>{const{c0:k}=yf(I.themeHue);return e.jsxs("div",{className:"flex items-center gap-1.5 rounded-full px-3 py-1.5 text-sm font-medium",style:{backgroundColor:k,color:"#FFFFFF"},children:[e.jsx("span",{children:I.name}),e.jsx("span",{style:{opacity:.8},children:t("myCard.chainLabel",{chain:i[T]||T})}),e.jsx("button",{type:"button",onClick:()=>ds.toggleWalletSelection(I.id),className:"ml-0.5 rounded-full p-0.5 transition-colors hover:bg-white/20","aria-label":t("myCard.removeWallet",{name:I.name}),children:e.jsx(nn,{className:"size-3"})})]},I.id)}),r.selectedWalletIds.length<3&&e.jsxs("button",{type:"button",onClick:()=>g(!0),className:"flex items-center gap-1 rounded-full border border-dashed border-muted-foreground/50 px-3 py-1 text-sm text-muted-foreground hover:border-primary hover:text-primary",children:[e.jsx(ut,{className:"size-3"}),t("myCard.addWallet")]})]}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:t("myCard.maxWallets",{max:3})})]}),e.jsxs("div",{className:"flex w-full max-w-[320px] gap-3",children:[e.jsxs(J,{variant:"outline",onClick:C,disabled:S||p.length===0,className:"flex-1",children:[S?e.jsx(be,{className:"mr-2 size-4 animate-spin"}):e.jsx(sn,{className:"mr-2 size-4"}),t("download")]}),"share"in navigator&&e.jsxs(J,{onClick:P,disabled:S||p.length===0,className:"flex-1",children:[S?e.jsx(be,{className:"mr-2 size-4 animate-spin"}):e.jsx(Hs,{className:"mr-2 size-4"}),t("share")]})]}),e.jsx("p",{className:"mt-6 text-center text-sm text-muted-foreground",children:t("myCard.scanToAdd")})]}),e.jsx(yu,{open:h,onOpenChange:g})]})}bu.__docgenInfo={description:"",methods:[],displayName:"MyCardPage"};const ju=()=>e.jsx(le,{children:e.jsx(bu,{})});ju.__docgenInfo={description:"",methods:[],displayName:"MyCardActivity"};const Bb={transaction:{icon:"",bg:"bg-blue-100 dark:bg-blue-900/30"},security:{icon:"",bg:"bg-red-100 dark:bg-red-900/30"},system:{icon:"",bg:"bg-gray-100 dark:bg-gray-800/30"}};function Fb(){const{t}=O("notification"),s=es();return c.useCallback(n=>{const r=Date.now()-n,o=Math.floor(r/6e4),d=Math.floor(r/36e5),i=Math.floor(r/864e5);return o<1?t("time.justNow"):o<60?t("time.minutesAgo",{count:o}):d<24?t("time.hoursAgo",{count:d}):i<7?t("time.daysAgo",{count:i}):new Date(n).toLocaleDateString(s)},[t,s])}function Wb({notification:t,onRead:s,onRemove:n,onNavigate:a,formatRelativeTime:r,t:o}){const d=Bb[t.type],i=t.type==="transaction"&&!!t.data?.pendingTxId,l=c.useCallback(()=>{t.read||s(t.id),i&&a&&a(t)},[t,s,a,i]);return e.jsxs("div",{onClick:l,className:L("flex cursor-pointer items-start gap-3 rounded-xl p-4 transition-colors",t.read?"bg-muted/30":"bg-card shadow-sm"),children:[e.jsx("div",{className:L("flex size-10 shrink-0 items-center justify-center rounded-full",d.bg),children:e.jsx("span",{className:"text-lg",children:d.icon})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h4",{className:L("font-medium",t.read&&"text-muted-foreground"),children:t.title}),e.jsx("span",{className:"text-muted-foreground shrink-0 text-xs",children:r(t.timestamp)})]}),e.jsx("p",{className:L("mt-1 text-sm",t.read?"text-muted-foreground":"text-foreground/80"),children:t.message}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[!t.read&&e.jsx("div",{className:"bg-primary flex size-2 rounded-full","aria-label":o("unread")}),i&&e.jsxs("span",{className:"text-primary flex items-center gap-0.5 text-xs",children:[o("viewDetails"),e.jsx(Le,{className:"size-3"})]})]})]}),e.jsx("button",{onClick:m=>{m.stopPropagation(),n(t.id)},className:"text-muted-foreground hover:text-destructive shrink-0 p-1","aria-label":o("delete"),children:e.jsx(ss,{className:"size-4"})})]})}function $b({notifications:t,onRead:s,onRemove:n,onNavigate:a,formatRelativeTime:r,t:o,language:d}){const i=c.useMemo(()=>{const l=new Map,m=new Date().toLocaleDateString(d),u=new Date(Date.now()-864e5).toLocaleDateString(d);for(const f of t){const h=new Date(f.timestamp).toLocaleDateString(d);let g=h;h===m?g=o("time.today"):h===u&&(g=o("time.yesterday"));const b=l.get(g)||[];l.set(g,[...b,f])}return l},[t,d,o]);return t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx("div",{className:"bg-muted mb-4 flex size-16 items-center justify-center rounded-full",children:e.jsx(Vf,{className:"text-muted-foreground size-8"})}),e.jsx("h3",{className:"text-lg font-medium",children:o("empty.title")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:o("empty.desc")})]}):e.jsx("div",{className:"space-y-6",children:Array.from(i.entries()).map(([l,m])=>e.jsxs("div",{children:[e.jsx("h3",{className:"text-muted-foreground mb-2 text-sm font-medium",children:l}),e.jsx("div",{className:"space-y-2",children:m.map(u=>e.jsx(Wb,{notification:u,onRead:s,onRemove:n,onNavigate:a,formatRelativeTime:r,t:o},u.id))})]},l))})}function Nu(){const{t}=O("notification"),s=es(),n=Fb(),{goBack:a,navigate:r}=de(),o=Ae(Im);c.useEffect(()=>{o.isInitialized||Cs.initialize()},[o.isInitialized]);const d=c.useCallback(f=>{Cs.markRead(f)},[]),i=c.useCallback(f=>{Cs.remove(f)},[]),l=c.useCallback(()=>{Cs.markAllRead()},[]),m=c.useCallback(()=>{Cs.clearAll()},[]),u=c.useCallback(f=>{f.type==="transaction"&&f.data?.pendingTxId&&r({to:`/pending-tx/${f.data.pendingTxId}`})},[r]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("title"),onBack:a,rightAction:o.unreadCount>0?e.jsxs("button",{onClick:l,className:"text-primary hover:bg-primary/10 flex items-center gap-1 rounded-full px-3 py-1.5 text-sm","aria-label":t("markAllRead"),children:[e.jsx(je,{className:"size-4"}),t("markAllRead")]}):void 0}),e.jsx("div",{className:"bg-card border-b px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:o.unreadCount>0?t("unreadCount",{count:o.unreadCount}):t("noUnread")}),o.notifications.length>0&&e.jsxs(J,{variant:"ghost",size:"sm",onClick:m,className:"text-destructive",children:[e.jsx(ss,{className:"mr-1 size-4"}),t("clear")]})]})}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx($b,{notifications:o.notifications,onRead:d,onRemove:i,onNavigate:u,formatRelativeTime:n,t,language:s})})]})}Nu.__docgenInfo={description:"",methods:[],displayName:"NotificationCenterPage"};const wu=()=>e.jsx(le,{children:e.jsx(Nu,{})});wu.__docgenInfo={description:"",methods:[],displayName:"NotificationsActivity"};function qb(t){const s=t.toNumber();return s>=1e9?`${(s/1e9).toFixed(2)}B`:s>=1e6?`${(s/1e6).toFixed(2)}M`:s>=1e3?`${(s/1e3).toFixed(2)}K`:s.toFixed(Math.min(5,8))}function ku({item:t,onMint:s,className:n}){const{t:a}=O("staking"),r=[{label:a("totalMinted",{asset:t.assetType}),value:t.totalMinted},{label:a("totalCirculation",{asset:t.assetType}),value:t.totalCirculation},{label:a("totalBurned",{asset:t.assetType}),value:t.totalBurned},{label:a("totalStaked",{asset:t.externalAssetType}),value:t.totalStaked}];return e.jsxs("div",{className:L("overflow-hidden rounded-xl shadow-md","bg-gradient-to-b from-primary/90 to-primary",n),children:[e.jsxs("div",{className:"relative grid grid-cols-2 gap-3 p-4",children:[r.map((o,d)=>e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("span",{className:"text-lg font-semibold text-amber-300",children:qb(o.value)}),e.jsx("span",{className:"text-xs text-primary-foreground/70",children:o.label})]},d)),e.jsx("div",{className:"pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 opacity-20",children:e.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-white/20 text-2xl font-bold text-white",children:t.chain.charAt(0)})})]}),e.jsxs("div",{className:"flex items-center justify-between bg-card px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ot,{symbol:t.externalAssetType,size:"sm"}),e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"font-medium text-foreground",children:t.externalAssetType}),e.jsx("div",{className:"text-muted-foreground",children:t.externalChain})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ot,{symbol:t.assetType,size:"sm"}),e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"font-medium text-foreground",children:t.assetType}),e.jsx("div",{className:"text-muted-foreground",children:t.chain})]})]}),e.jsx(J,{size:"sm",variant:"default",className:"rounded-full px-4",onClick:()=>s?.(t),children:a("mint")})]})]})]})}ku.__docgenInfo={description:"Staking pool card component",methods:[],displayName:"StakingPoolCard",props:{item:{required:!0,tsType:{name:"StakingOverviewItem"},description:""},onMint:{required:!1,tsType:{name:"union",raw:"((item: StakingOverviewItem) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Hb=[{value:"all",label:"allNetworks"},{value:"ETH",label:"Ethereum"},{value:"BSC",label:"BNB Chain"},{value:"TRON",label:"Tron"},{value:"BFMeta",label:"BFMeta"},{value:"BFChain",label:"BFChain"}];function Cu({onMint:t,className:s}){const{t:n}=O("staking"),[a,r]=c.useState(""),[o,d]=c.useState("all"),[i,l]=c.useState(!1),[m,u]=c.useState([]),[f,h]=c.useState(!0);c.useEffect(()=>{let p=!0;return h(!0),Kt.getOverview().then(x=>{p&&(u(x),h(!1))}),()=>{p=!1}},[]);const g=c.useMemo(()=>{let p=m;if(a.trim()){const x=a.toLowerCase();p=p.filter(v=>v.assetType.toLowerCase().includes(x)||v.externalAssetType.toLowerCase().includes(x)||v.chain.toLowerCase().includes(x)||v.externalChain.toLowerCase().includes(x))}return o!=="all"&&(p=p.filter(x=>x.chain===o||x.externalChain===o)),p},[m,a,o]),b=p=>{d(p),l(!1)};return f?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[e.jsx(Te,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):e.jsxs("div",{className:L("space-y-4",s),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(tn,{className:"text-muted-foreground absolute top-1/2 left-3 size-4 -translate-y-1/2"}),e.jsx(Ve,{type:"text",placeholder:n("searchPlaceholder"),value:a,onChange:p=>r(p.target.value),className:"pl-9"})]}),e.jsxs(Ct,{open:i,onOpenChange:l,children:[e.jsx(hf,{render:e.jsxs(J,{variant:"outline",size:"icon",className:"relative",children:[e.jsx(lc,{className:"size-4"}),o!=="all"&&e.jsx("span",{className:"bg-primary absolute -top-1 -right-1 size-2 rounded-full"})]})}),e.jsxs(St,{side:"bottom",className:"h-[60vh]",children:[e.jsx(At,{children:e.jsx(It,{children:n("selectNetwork")})}),e.jsx("div",{className:"mt-4 space-y-2",children:Hb.map(p=>e.jsxs("button",{onClick:()=>b(p.value),className:L("flex w-full items-center justify-between rounded-lg px-4 py-3 text-left transition-colors",o===p.value?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("span",{children:p.value==="all"?n("allNetworks"):p.label}),o===p.value&&e.jsx("span",{className:"text-primary",children:""})]},p.value))})]})]})]}),g.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-20",children:e.jsx("p",{className:"text-muted-foreground",children:n("noResults")})}):e.jsx("div",{className:"space-y-4",children:g.map((p,x)=>e.jsx(ku,{item:p,onMint:t},`${p.chain}-${p.assetType}-${x}`))})]})}Cu.__docgenInfo={description:"Staking overview panel with search and filter",methods:[],displayName:"StakingOverviewPanel",props:{onMint:{required:!1,tsType:{name:"signature",type:"function",raw:"(item: StakingOverviewItem) => void",signature:{arguments:[{type:{name:"StakingOverviewItem"},name:"item"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Ub=["ETH","BSC","TRON"],Vb={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron"},jo={ETH:{BFM:"1000.00",USDT:"5000.00"},BSC:{BFM:"2500.00",USDT:"10000.00",BFC:"500.00"},TRON:{USDT:"8000.00"}};function Jb(t,s){if(!t)return[];const n=[];for(const[a,r]of Object.entries(t))for(const[o,d]of Object.entries(r)){const i=d.supportChain[s];i&&n.push({asset:i.assetType,targetChain:a,targetAsset:o})}return n}function Su({onSuccess:t,className:s}){const{t:n}=O("staking"),a=ts(),[r,o]=c.useState("BSC"),[d,i]=c.useState(""),[l,m]=c.useState(""),[u,f]=c.useState(""),[h,g]=c.useState(""),[b,p]=c.useState(!1),[x,v]=c.useState(!1),[j,N]=c.useState(!0),[y,S]=c.useState(!1),[C,P]=c.useState(null);c.useEffect(()=>{let R=!0;return Kt.getRechargeConfig().then(V=>{R&&(P(V),N(!1))}),()=>{R=!1}},[]);const _=c.useMemo(()=>Jb(C,r),[C,r]),I=c.useCallback(R=>{const V=Vb[R];if(V)return V;const M=R.toLowerCase();return a[M]??a[R]??R},[a]);c.useEffect(()=>{const R=_[0];R&&!d&&(i(R.asset),m(R.targetChain),f(R.targetAsset))},[_,d]);const T=c.useCallback(R=>{o(R),i(""),m(""),f(""),g(""),p(!1)},[]),k=c.useCallback(R=>{i(R.asset),m(R.targetChain),f(R.targetAsset),v(!1)},[]),A=c.useMemo(()=>jo[r]?.[d]??"0.00",[r,d]),w=c.useCallback(()=>{g(A.replace(/,/g,""))},[A]),E=c.useMemo(()=>{if(!h)return null;const R=parseFloat(h);if(isNaN(R)||R<=0)return n("invalidAmount");const V=parseFloat(A.replace(/,/g,""));return R>V?n("insufficientBalance"):null},[h,A,n]),D=c.useMemo(()=>r&&d&&l&&u&&h&&!E&&!y,[r,d,l,u,h,E,y]),z=c.useCallback(async()=>{if(D){S(!0);try{const R=h.replace(/,/g,""),V={sourceChain:r,sourceAsset:d,amount:oe.fromFormatted(R,18,d),targetChain:l,targetAsset:u},M=await Kt.submitMint(V);t?.(M.id)}finally{S(!1)}}},[D,r,d,h,l,u,t]);return j?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Te,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):e.jsxs("div",{className:L("space-y-4",s),children:[e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("sourceChain")}),e.jsxs("button",{type:"button",onClick:()=>p(!0),className:"bg-background mb-3 flex w-full items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-muted flex size-6 items-center justify-center rounded-full text-xs font-bold",children:r.charAt(0)}),e.jsx("span",{className:"font-medium",children:I(r)})]}),e.jsx(Le,{className:"text-muted-foreground size-4"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>v(!0),className:"bg-background flex shrink-0 items-center gap-2 rounded-lg px-3 py-2",children:[e.jsx(ot,{symbol:d||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:d||n("selectToken")}),e.jsx(Le,{className:"text-muted-foreground size-4"})]}),e.jsx("div",{className:"flex-1",children:e.jsx(Ve,{type:"text",inputMode:"decimal",placeholder:"0.00",value:h,onChange:R=>g(R.target.value),className:"border-0 bg-transparent text-right text-lg font-semibold"})})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-muted-foreground",children:[n("availableBalance"),": ",A]}),e.jsx(J,{type:"button",variant:"ghost",size:"sm",className:"text-primary h-auto px-2 py-1 text-xs",onClick:w,children:n("max")})]}),E&&e.jsx("div",{className:"text-destructive mt-2 text-xs",children:E})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-muted rounded-full p-2",children:e.jsx(Bs,{className:"text-muted-foreground size-4"})})}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("targetChain")}),e.jsxs("div",{className:"bg-background flex items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-primary/20 text-primary flex size-6 items-center justify-center rounded-full text-xs font-bold",children:l.charAt(0)||"?"}),e.jsx("span",{className:"font-medium",children:l?I(l):n("selectToken")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ot,{symbol:u||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:u||"-"})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:n("amount")}),e.jsxs("span",{className:"font-semibold",children:[h||"0.00"," ",u]})]})]}),e.jsx(J,{type:"button",size:"lg",className:"w-full",disabled:!D,onClick:z,children:y?e.jsxs(e.Fragment,{children:[e.jsx(Te,{size:"sm"}),e.jsx("span",{className:"ml-2",children:n("confirm")})]}):n("confirm")}),e.jsx(Ct,{open:b,onOpenChange:p,children:e.jsxs(St,{side:"bottom",className:"h-[50vh]",children:[e.jsx(At,{children:e.jsx(It,{children:n("selectChain")})}),e.jsx("div",{className:"mt-4 space-y-2",children:Ub.map(R=>e.jsxs("button",{onClick:()=>T(R),className:L("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",r===R?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("div",{className:"bg-muted flex size-8 items-center justify-center rounded-full text-sm font-bold",children:R.charAt(0)}),e.jsx("span",{className:"font-medium",children:I(R)}),r===R&&e.jsx("span",{className:"text-primary ml-auto",children:""})]},R))})]})}),e.jsx(Ct,{open:x,onOpenChange:v,children:e.jsxs(St,{side:"bottom",className:"h-[60vh]",children:[e.jsx(At,{children:e.jsx(It,{children:n("selectToken")})}),e.jsx("div",{className:"mt-4 space-y-2",children:_.length===0?e.jsx("p",{className:"text-muted-foreground py-8 text-center",children:n("noResults")}):_.map(R=>e.jsxs("button",{onClick:()=>k(R),className:L("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",d===R.asset?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx(ot,{symbol:R.asset,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:R.asset}),e.jsx("div",{className:"text-muted-foreground text-xs",children:n("targetChainLabel",{chain:I(R.targetChain),asset:R.targetAsset})})]}),e.jsx("div",{className:"text-muted-foreground text-right text-sm",children:jo[r]?.[R.asset]??"0.00"}),d===R.asset&&e.jsx("span",{className:"text-primary",children:""})]},`${R.targetChain}-${R.asset}`))})]})})]})}Su.__docgenInfo={description:"Mint form component",methods:[],displayName:"MintForm",props:{onSuccess:{required:!1,tsType:{name:"signature",type:"function",raw:"(txId: string) => void",signature:{arguments:[{type:{name:"string"},name:"txId"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Kb=["BFMeta","BFChain","CCChain","PMChain"],Gb={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron"},No={BFMeta:{BFM:"5000.00",USDT:"2500.00"},BFChain:{BFC:"1000.00"},CCChain:{},PMChain:{}};function Qb(t,s){if(!t)return[];const n=s.toLowerCase(),a=t[n];if(!a)return[];const r=[];for(const[o,d]of Object.entries(a)){const i=[];d.supportChain.ETH&&i.push("ETH"),d.supportChain.BSC&&i.push("BSC"),d.supportChain.TRON&&i.push("TRON"),i.length>0&&r.push({asset:o,targetChains:i})}return r}function Au({onSuccess:t,className:s}){const{t:n}=O("staking"),a=ts(),[r,o]=c.useState("BFMeta"),[d,i]=c.useState(""),[l,m]=c.useState(""),[u,f]=c.useState(""),[h,g]=c.useState(!1),[b,p]=c.useState(!1),[x,v]=c.useState(!1),[j,N]=c.useState(!0),[y,S]=c.useState(!1),[C,P]=c.useState(null);c.useEffect(()=>{let M=!0;return Kt.getRechargeConfig().then(B=>{M&&(P(B),N(!1))}),()=>{M=!1}},[]);const _=c.useMemo(()=>Qb(C,r),[C,r]),I=c.useCallback(M=>{const B=Gb[M];if(B)return B;const G=M.toLowerCase();return a[G]??a[M]??M},[a]),T=c.useMemo(()=>d?_.find(B=>B.asset===d)?.targetChains??[]:[],[_,d]);c.useEffect(()=>{const M=_[0];if(M&&!d){i(M.asset);const B=M.targetChains[0];B&&m(B)}},[_,d]);const k=c.useCallback(M=>{o(M),i(""),m(""),f(""),g(!1)},[]),A=c.useCallback(M=>{i(M.asset);const B=M.targetChains[0];B&&m(B),p(!1)},[]),w=c.useCallback(M=>{m(M),v(!1)},[]),E=c.useMemo(()=>No[r]?.[d]??"0.00",[r,d]),D=c.useCallback(()=>{f(E.replace(/,/g,""))},[E]),z=c.useMemo(()=>{if(!u)return null;const M=parseFloat(u);if(isNaN(M)||M<=0)return n("invalidAmount");const B=parseFloat(E.replace(/,/g,""));return M>B?n("insufficientBalance"):null},[u,E,n]),R=c.useMemo(()=>r&&d&&l&&u&&!z&&!y,[r,d,l,u,z,y]),V=c.useCallback(async()=>{if(!(!R||!l)){S(!0);try{const M=u.replace(/,/g,""),B={sourceChain:r,sourceAsset:d,amount:oe.fromFormatted(M,8,d),targetChain:l,targetAsset:d},G=await Kt.submitBurn(B);t?.(G.id)}finally{S(!1)}}},[R,r,d,u,l,t]);return j?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Te,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):e.jsxs("div",{className:L("space-y-4",s),children:[e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("sourceChain")}),e.jsxs("button",{type:"button",onClick:()=>g(!0),className:"bg-background mb-3 flex w-full items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-primary/20 text-primary flex size-6 items-center justify-center rounded-full text-xs font-bold",children:r.charAt(0)}),e.jsx("span",{className:"font-medium",children:I(r)})]}),e.jsx(Le,{className:"text-muted-foreground size-4"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>p(!0),className:"bg-background flex shrink-0 items-center gap-2 rounded-lg px-3 py-2",children:[e.jsx(ot,{symbol:d||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:d||n("selectToken")}),e.jsx(Le,{className:"text-muted-foreground size-4"})]}),e.jsx("div",{className:"flex-1",children:e.jsx(Ve,{type:"text",inputMode:"decimal",placeholder:"0.00",value:u,onChange:M=>f(M.target.value),className:"border-0 bg-transparent text-right text-lg font-semibold"})})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-muted-foreground",children:[n("availableBalance"),": ",E]}),e.jsx(J,{type:"button",variant:"ghost",size:"sm",className:"text-primary h-auto px-2 py-1 text-xs",onClick:D,children:n("max")})]}),z&&e.jsx("div",{className:"text-destructive mt-2 text-xs",children:z})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-muted rounded-full p-2",children:e.jsx(Bs,{className:"text-muted-foreground size-4"})})}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("targetChain")}),e.jsxs("button",{type:"button",onClick:()=>v(!0),disabled:T.length===0,className:"bg-background flex w-full items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-muted flex size-6 items-center justify-center rounded-full text-xs font-bold",children:l?l.charAt(0):"?"}),e.jsx("span",{className:"font-medium",children:l?I(l):n("selectChain")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ot,{symbol:d||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:d||"-"}),e.jsx(Le,{className:"text-muted-foreground size-4"})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:n("amount")}),e.jsxs("span",{className:"font-semibold",children:[u||"0.00"," ",d]})]})]}),e.jsx(J,{type:"button",size:"lg",className:"w-full",disabled:!R,onClick:V,children:y?e.jsxs(e.Fragment,{children:[e.jsx(Te,{size:"sm"}),e.jsx("span",{className:"ml-2",children:n("confirm")})]}):n("confirm")}),e.jsx(Ct,{open:h,onOpenChange:g,children:e.jsxs(St,{side:"bottom",className:"h-[50vh]",children:[e.jsx(At,{children:e.jsx(It,{children:n("selectChain")})}),e.jsx("div",{className:"mt-4 space-y-2",children:Kb.map(M=>e.jsxs("button",{onClick:()=>k(M),className:L("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",r===M?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("div",{className:"bg-primary/20 text-primary flex size-8 items-center justify-center rounded-full text-sm font-bold",children:M.charAt(0)}),e.jsx("span",{className:"font-medium",children:I(M)}),r===M&&e.jsx("span",{className:"text-primary ml-auto",children:""})]},M))})]})}),e.jsx(Ct,{open:b,onOpenChange:p,children:e.jsxs(St,{side:"bottom",className:"h-[60vh]",children:[e.jsx(At,{children:e.jsx(It,{children:n("selectToken")})}),e.jsx("div",{className:"mt-4 space-y-2",children:_.length===0?e.jsx("p",{className:"text-muted-foreground py-8 text-center",children:n("noResults")}):_.map(M=>e.jsxs("button",{onClick:()=>A(M),className:L("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",d===M.asset?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx(ot,{symbol:M.asset,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:M.asset}),e.jsxs("div",{className:"text-muted-foreground text-xs",children:[" ",M.targetChains.join(", ")]})]}),e.jsx("div",{className:"text-muted-foreground text-right text-sm",children:No[r]?.[M.asset]??"0.00"}),d===M.asset&&e.jsx("span",{className:"text-primary",children:""})]},M.asset))})]})}),e.jsx(Ct,{open:x,onOpenChange:v,children:e.jsxs(St,{side:"bottom",className:"h-[50vh]",children:[e.jsx(At,{children:e.jsx(It,{children:n("selectChain")})}),e.jsx("div",{className:"mt-4 space-y-2",children:T.map(M=>e.jsxs("button",{onClick:()=>w(M),className:L("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",l===M?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("div",{className:"bg-muted flex size-8 items-center justify-center rounded-full text-sm font-bold",children:M.charAt(0)}),e.jsx("span",{className:"font-medium",children:I(M)}),l===M&&e.jsx("span",{className:"text-primary ml-auto",children:""})]},M))})]})})]})}Au.__docgenInfo={description:"Burn form component",methods:[],displayName:"BurnForm",props:{onSuccess:{required:!1,tsType:{name:"signature",type:"function",raw:"(txId: string) => void",signature:{arguments:[{type:{name:"string"},name:"txId"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Yb={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron"};function Xb({status:t}){switch(t){case"pending":return e.jsx(Kf,{className:"size-4 text-yellow-500"});case"confirming":return e.jsx(be,{className:"size-4 animate-spin text-blue-500"});case"confirmed":return e.jsx(Ns,{className:"size-4 text-green-500"});case"failed":return e.jsx(Jf,{className:"text-destructive size-4"})}}function Zb(t){const n=Date.now()-t;return n<6e4?"Just now":n<36e5?`${Math.floor(n/6e4)}m ago`:n<864e5?`${Math.floor(n/36e5)}h ago`:new Date(t).toLocaleDateString()}function ej(t){const s=t.toNumber();return s>=1e6?`${(s/1e6).toFixed(2)}M`:s>=1e3?`${(s/1e3).toFixed(2)}K`:s.toFixed(4)}function wo(t,s){const n=Yb[t];if(n)return n;const a=t.toLowerCase();return s[a]??s[t]??t}function tj({record:t,onClick:s}){const{t:n}=O("staking"),a=ts(),r=wo(t.sourceChain,a),o=wo(t.targetChain,a),d=t.type==="mint",i=d?sp:ic;return e.jsxs("button",{type:"button",onClick:s,className:"bg-card hover:bg-muted/50 flex w-full items-center gap-3 rounded-lg p-3 text-left transition-colors",children:[e.jsx("div",{className:L("flex size-10 items-center justify-center rounded-full",d?"bg-green-500/10":"bg-orange-500/10"),children:e.jsx(i,{className:L("size-5",d?"text-green-500":"text-orange-500")})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:n(d?"mint":"burn")}),e.jsx(Xb,{status:t.status})]}),e.jsxs("div",{className:"text-muted-foreground flex items-center gap-1 text-xs",children:[e.jsx("span",{children:r}),e.jsx("span",{children:""}),e.jsx("span",{children:o})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(ot,{symbol:t.sourceAsset,size:"sm"}),e.jsx("span",{className:"font-medium",children:ej(t.sourceAmount)})]}),e.jsx("div",{className:"text-muted-foreground text-xs",children:Zb(t.createdAt)})]})]})}function Iu({filterType:t="all",onRecordClick:s,className:n}){const{t:a}=O("staking"),[r,o]=c.useState([]),[d,i]=c.useState(!0),[l,m]=c.useState(t==="all"?"all":t);c.useEffect(()=>{let g=!0;return i(!0),Kt.getTransactions().then(b=>{g&&(o(b),i(!1))}),()=>{g=!1}},[]);const u=c.useMemo(()=>l==="all"?r:r.filter(g=>g.type===l),[r,l]),f=[{id:"all",label:a("history")},{id:"mint",label:a("mint")},{id:"burn",label:a("burn")}],h=c.useCallback(()=>{i(!0),Kt.getTransactions().then(g=>{o(g),i(!1)})},[]);return d?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Te,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:a("loading")})]}):e.jsxs("div",{className:L("space-y-4",n),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[f.map(g=>e.jsx(J,{type:"button",variant:l===g.id?"default":"outline",size:"sm",onClick:()=>m(g.id),children:g.label},g.id)),e.jsx(J,{type:"button",variant:"ghost",size:"sm",className:"ml-auto",onClick:h,children:a("refresh")})]}),u.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:a("noTransactions")})}):e.jsx("div",{className:"space-y-2",children:u.map(g=>e.jsx(tj,{record:g,onClick:()=>s?.(g)},g.id))})]})}Iu.__docgenInfo={description:"Staking record list component",methods:[],displayName:"StakingRecordList",props:{filterType:{required:!1,tsType:{name:"union",raw:"StakingTxType | 'all'",elements:[{name:"StakingTxType"},{name:"literal",value:"'all'"}]},description:"Filter by transaction type",defaultValue:{value:"'all'",computed:!1}},onRecordClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(record: StakingTransaction) => void",signature:{arguments:[{type:{name:"StakingTransaction"},name:"record"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};function Tu(){const{t}=O("staking"),{goBack:s}=de(),[n,a]=c.useState("overview"),r=[{id:"overview",label:t("overview")},{id:"mint",label:t("mint")},{id:"burn",label:t("burn")},{id:"history",label:t("history")}],o=d=>{a("mint")};return e.jsxs("div",{className:"flex min-h-screen flex-col bg-background",children:[e.jsx(K,{title:t("title"),onBack:s}),e.jsx("div",{className:"flex border-b border-border px-4",children:r.map(d=>e.jsx("button",{onClick:()=>a(d.id),className:L("flex-1 py-3 text-sm font-medium transition-colors",n===d.id?"border-b-2 border-primary text-primary":"text-muted-foreground hover:text-foreground"),children:d.label},d.id))}),e.jsxs("div",{className:"flex-1 p-4",children:[n==="overview"&&e.jsx(Cu,{onMint:o}),n==="mint"&&e.jsx(sj,{}),n==="burn"&&e.jsx(nj,{}),n==="history"&&e.jsx(Iu,{})]})]})}function sj(){const{t}=O("staking"),s=n=>{};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:t("mintDescription")}),e.jsx(Su,{onSuccess:s})]})}function nj(){const{t}=O("staking"),s=n=>{};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:t("burnDescription")}),e.jsx(Au,{onSuccess:s})]})}Tu.__docgenInfo={description:"Staking page with tab navigation",methods:[],displayName:"StakingPage"};const Pu=()=>e.jsx(le,{children:e.jsx(Tu,{})});Pu.__docgenInfo={description:"",methods:[],displayName:"StakingActivity"};const aj=ws({assetType:ce(),decimals:Gn(),amount:ce().optional(),useDefaultDecimals:Tt().optional(),logoUrl:ce().optional(),contractAddress:ce().optional()}),rj=ws({address:ce(),symbol:ce(),addressKey:ce(),mainWalletId:ce(),chain:ce(),mnemonic:ce().optional(),privateKey:ce(),publicKey:ce().optional(),isCustomAssets:Tt().optional(),isFreezed:Tt().optional(),assets:ur(aj),name:ce(),prohibitChangeName:Tt().optional(),index:Gn().optional(),purpose:nc([kt(44),kt(49),kt(84),kt(86)]).optional()}),ij=ws({chainName:ce(),addressKey:ce(),address:ce(),symbol:ce(),mainWalletId:ce(),index:Gn().optional(),purpose:nc([kt(44),kt(49),kt(84),kt(86)]).optional()});ws({name:ce(),skipBackup:Tt().optional(),importPhrase:ce(),importType:ce(),addressKeyList:ur(ij),mainWalletId:ce(),headSculpture:ce(),createTimestamp:Gn(),lastBitcoinAddressKey:ce().optional()});ws({addressBookId:ce(),name:ce(),address:ce(),chainList:ur(ce()).optional(),remarks:ce().optional(),iconName:ce().optional(),symbol:ce().optional()});ws({password:ce(),passwordTips:ce().optional(),lastWalletActivate:rj.optional(),walletLock:Tt().optional(),fingerprintLock:Tt().optional(),fingerprintPay:Tt().optional()});const oj=c.createContext(null);function cj(){return c.useContext(oj)}const lj="keyapp_welcome_shown";function bn(){localStorage.setItem(lj,"1")}function Eu(){const{t}=O("guide"),{navigate:s}=de(),[n,a]=c.useState(0),r=cj(),o=c.useMemo(()=>[{icon:e.jsx(uc,{className:"text-primary size-16"}),title:t("welcome.slides.transfer.title"),description:t("welcome.slides.transfer.description")},{icon:e.jsx(dc,{className:"text-primary size-16"}),title:t("welcome.slides.multichain.title"),description:t("welcome.slides.multichain.description")},{icon:e.jsx(Gf,{className:"text-primary size-16"}),title:t("welcome.slides.security.title"),description:t("welcome.slides.security.description")}],[t]),d=o[n];if(!d)return null;const i=c.useCallback(()=>{bn(),s({to:"/wallet/create"})},[s]),l=c.useCallback(()=>{bn(),s({to:"/onboarding/recover"})},[s]),m=c.useCallback(()=>{bn(),s({to:"/onboarding/migrate"})},[s]),u=c.useCallback(()=>{bn(),s({to:"/"})},[s]),f=c.useCallback(()=>{n<o.length-1&&a(b=>b+1)},[n,o.length]),h=n===o.length-1,g=r?.shouldPromptMigration;return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx("div",{className:"flex justify-end p-4",children:e.jsx(J,{variant:"ghost",size:"sm","data-testid":"skip-button",onClick:u,children:t("welcome.skip")})}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center px-8",children:[e.jsx("div",{className:"bg-primary/10 mb-8 flex size-32 items-center justify-center rounded-full",children:d.icon}),e.jsx("h1",{className:"mb-4 text-center text-2xl font-bold",children:d.title}),e.jsx("p",{className:"text-muted-foreground mb-8 max-w-sm text-center",children:d.description}),e.jsx("div",{className:"mb-8 flex gap-2",children:o.map((b,p)=>e.jsx("button",{"data-testid":`slide-dot-${p}`,onClick:()=>a(p),className:L("size-2 rounded-full transition-colors",p===n?"bg-primary":"bg-muted-foreground/30"),"aria-label":t("welcome.goToSlide",{number:p+1})},p))})]}),e.jsx("div",{className:"p-6",children:h?e.jsxs("div",{className:"flex flex-col gap-3",children:[g&&e.jsxs(J,{"data-testid":"migrate-button",onClick:m,className:"w-full",size:"lg",variant:"default",children:[e.jsx(sn,{className:"mr-2 size-4"}),t("welcome.migrateFromMpay")]}),e.jsx(J,{"data-testid":"get-started-button",onClick:i,className:"w-full",size:"lg",variant:g?"outline":"default",children:t("welcome.getStarted")}),e.jsx(J,{"data-testid":"have-wallet-button",onClick:l,variant:"outline",className:"w-full",size:"lg",children:t("welcome.haveWallet")})]}):e.jsxs(J,{"data-testid":"next-button",onClick:f,className:"w-full",size:"lg",children:[t("welcome.next"),e.jsx(Le,{className:"ml-2 size-4"})]})})]})}Eu.__docgenInfo={description:"",methods:[],displayName:"WelcomeScreen"};const _u=()=>e.jsx(le,{children:e.jsx(Eu,{})});_u.__docgenInfo={description:"",methods:[],displayName:"WelcomeActivity"};function Mu(){const{t}=O(["wallet","onboarding","security","common"]),{goBack:s}=de(),n=Fe(),a=Ys(),r=Je(),[o,d]=c.useState("select"),[i,l]=c.useState([]),[m,u]=c.useState([]),[f,h]=c.useState(!1),g=c.useRef(!1);c.useEffect(()=>{!g.current&&n&&(l(n.chainAddresses.map(v=>v.chain)),g.current=!0)},[n]);const b=c.useCallback(()=>{if(!n)return!1;const v=new Set(n.chainAddresses.map(j=>j.chain));return v.size!==i.length?!0:i.some(j=>!v.has(j))},[n,i]),p=c.useCallback(()=>{if(!b()){s();return}d("verify")},[b,s]),x=c.useCallback(async v=>{if(!(!n||v.length<4)){h(!1),d("saving");try{const j=Be(v);await ye.updateWalletChainAddresses(n.id,i,j,a),!i.includes(r)&&i.length>0&&ye.setSelectedChain(i[0]),d("success"),setTimeout(()=>{s()},1500)}catch(j){j instanceof Error&&j.message.includes("decrypt")?(h(!0),u([]),d("verify"),setTimeout(()=>{h(!1)},1500)):d("select")}}},[n,i,a,s]);return n?o==="saving"?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(K,{title:t("wallet:chains.title")}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx(Te,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground",children:t("wallet:chains.saving")})]})]}):o==="success"?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(K,{title:t("wallet:chains.title")}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-green-500/10",children:e.jsx(je,{className:"size-8 text-green-500"})}),e.jsx("p",{className:"font-medium",children:t("wallet:chains.success")})]})]}):o==="verify"?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(K,{title:t("wallet:chains.verifyTitle"),onBack:()=>{d("select"),u([])}}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:t("wallet:chains.verifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("wallet:chains.verifyDesc")})]}),e.jsx(mt,{value:m,onChange:u,onComplete:x,minPoints:4,error:f,"data-testid":"wallet-chains-pattern"})]})]}):e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(K,{title:t("wallet:chains.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Zs,{icon:e.jsx(Ns,{className:"size-full"}),variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:t("onboarding:chainSelector.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("onboarding:chainSelector.subtitle")})]}),a.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(Te,{})}):e.jsx(dr,{"data-testid":"wallet-chains-selector",chains:a,selectedChains:i,onSelectionChange:l}),e.jsx(Ue,{variant:"mint",className:"w-full","data-testid":"wallet-chains-save",disabled:i.length===0,onClick:p,children:b()?t("common:save"):t("common:done")})]})]}):e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(K,{title:t("wallet:chains.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx(Gt,{variant:"warning",children:t("wallet:chains.noWallet")})})]})}Mu.__docgenInfo={description:"",methods:[],displayName:"WalletChainsPage"};const Ru=()=>e.jsx(le,{children:e.jsx(Mu,{})});Ru.__docgenInfo={description:"",methods:[],displayName:"SettingsWalletChainsActivity"};function ja(t){if(t===0)return"0 B";const s=1024,n=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(s));return`${parseFloat((t/Math.pow(s,a)).toFixed(2))} ${n[a]}`}function Lu(){const{t}=O(["settings","common"]),{goBack:s}=de(),{push:n}=Z(),[a,r]=c.useState(null),[o,d]=c.useState(!0),i=c.useCallback(async()=>{d(!0);try{if(navigator.storage&&navigator.storage.estimate){const m=await navigator.storage.estimate();r({usage:m.usage??0,quota:m.quota??0})}}catch{}finally{d(!1)}},[]);c.useEffect(()=>{i()},[i]);const l=a?a.usage/a.quota*100:0;return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(K,{title:t("settings:storage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"bg-primary/10 flex size-10 items-center justify-center rounded-full",children:e.jsx(cc,{className:"text-primary size-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:t("settings:storage.usage")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:t("settings:storage.basedOn")})]})]}),o?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(be,{className:"text-muted-foreground size-6 animate-spin"})}):a?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"bg-muted h-3 w-full overflow-hidden rounded-full",children:e.jsx("div",{className:"bg-primary h-full rounded-full transition-all",style:{width:`${Math.min(l,100)}%`}})}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[t("settings:storage.used"),": ",ja(a.usage)]}),e.jsxs("span",{className:"text-muted-foreground",children:[t("settings:storage.total"),": ",ja(a.quota)]})]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:t("settings:storage.usagePercent")}),e.jsxs("span",{className:"font-medium",children:[l.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:t("settings:storage.available")}),e.jsx("span",{className:"font-medium",children:ja(a.quota-a.usage)})]})]})]}):e.jsx("p",{className:"text-muted-foreground text-center py-4",children:t("settings:storage.unavailable")})]}),e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"font-medium mb-2",children:t("settings:storage.clearTitle")}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:t("settings:storage.clearDesc")}),e.jsxs(J,{variant:"destructive",className:"w-full",onClick:()=>n("ClearDataConfirmJob",{}),children:[e.jsx(ss,{className:"size-4 mr-2"}),t("settings:items.clearData")]})]})]})]})}Lu.__docgenInfo={description:"",methods:[],displayName:"SettingsStoragePage"};const Du=()=>e.jsx(le,{children:e.jsx(Lu,{})});Du.__docgenInfo={description:"",methods:[],displayName:"SettingsStorageActivity"};const zu=()=>{const{t}=O("common"),{pop:s}=Z(),n=Ae(tr),[a,r]=c.useState(!1),[o,d]=c.useState(null),[i,l]=c.useState(""),[m,u]=c.useState(""),[f,h]=c.useState(null),[g,b]=c.useState(!1),[p,x]=c.useState(!1),[v,j]=c.useState(null),N=c.useCallback(async w=>{b(!0),h(null);try{const E=new URL(w).toString(),D=await fetch(E);if(D.ok){const z=await D.json();z.name&&typeof z.name=="string"&&h(z.name)}}catch{}finally{b(!1)}},[]);c.useEffect(()=>{if(!i.trim()){h(null);return}try{new URL(i)}catch{return}const w=setTimeout(()=>{N(i)},500);return()=>clearTimeout(w)},[i,N]);const y=()=>{r(!0),d(null),l(""),u(""),h(null),j(null)},S=w=>{r(!0),d(w.url),l(w.url),u(w.name),h(null),j(null)},C=()=>{r(!1),d(null),l(""),u(""),h(null),j(null)},P=async()=>{if(!i.trim()){j(t("sources.enterUrl"));return}let w;try{w=new URL(i).toString()}catch{j(t("sources.invalidUrl"));return}const E=m.trim()||f||t("sources.customSource");if(o)if(o!==w){if(n.sources.some(D=>D.url===w)){j(t("sources.alreadyExists"));return}Me.removeSource(o),Me.addSource(w,E)}else Me.updateSourceName(o,E);else{if(n.sources.some(D=>D.url===w)){j(t("sources.alreadyExists"));return}Me.addSource(w,E)}C(),Gm(w)},_=w=>{Me.removeSource(w)},I=w=>{Me.toggleSource(w)},T=async()=>{x(!0);try{await Fo()}catch{}x(!1)},k=o===null,A=f?t("sources.nameWithDefault",{name:f}):t("sources.namePlaceholder");return e.jsx(le,{children:e.jsxs("div",{className:"bg-background flex h-full flex-col",children:[e.jsx("div",{className:"bg-background sticky top-0 z-10 border-b",children:e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[e.jsx("button",{onClick:()=>s(),className:"hover:bg-muted rounded-full p-1.5 transition-colors","aria-label":t("back"),children:e.jsx(Zo,{className:"size-5",stroke:1.5})}),e.jsx("h1",{className:"flex-1 text-lg font-semibold",children:t("sources.title")}),e.jsx("button",{onClick:T,disabled:p,className:"hover:bg-muted rounded-full p-1.5 transition-colors","aria-label":t("refresh"),children:e.jsx(ns,{className:L("size-5",p&&"animate-spin"),stroke:1.5})})]})}),e.jsxs("div",{className:"flex-1 space-y-3 overflow-y-auto p-4",children:[n.sources.map(w=>e.jsx(dj,{source:w,onToggle:()=>I(w.url),onRemove:()=>_(w.url),onEdit:()=>S(w),isSelected:o===w.url},w.url)),n.sources.length===0&&e.jsx("div",{className:"text-muted-foreground py-12 text-center",children:t("sources.noSources")})]}),a?e.jsxs("div",{className:"bg-background space-y-3 border-t p-4",children:[e.jsx("textarea",{value:i,onChange:w=>{l(w.target.value),j(null)},placeholder:t("sources.urlPlaceholder"),rows:1,spellCheck:!1,className:"bg-background focus:ring-primary [field-sizing:content] w-full resize-none rounded-lg border px-3 py-2 focus:ring-2 focus:outline-none"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:m,onChange:w=>u(w.target.value),placeholder:A,className:"bg-background focus:ring-primary w-full rounded-lg border px-3 py-2 pr-8 focus:ring-2 focus:outline-none"}),g&&e.jsx(be,{className:"text-muted-foreground absolute top-1/2 right-3 size-4 -translate-y-1/2 animate-spin"})]}),v&&e.jsx("p",{className:"text-destructive text-sm",children:v}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:C,className:"bg-muted hover:bg-muted/80 flex-1 rounded-lg py-2 font-medium",children:t("cancel")}),e.jsx("button",{onClick:P,className:"bg-primary text-primary-foreground hover:bg-primary/90 flex-1 rounded-lg py-2 font-medium",children:t(k?"add":"save")})]})]}):e.jsx("div",{className:"border-t p-4",children:e.jsxs("button",{onClick:y,className:"border-muted-foreground/30 hover:border-primary hover:bg-primary/5 text-muted-foreground hover:text-primary flex w-full items-center justify-center gap-2 rounded-xl border-2 border-dashed py-3 transition-colors",children:[e.jsx(ut,{className:"size-5",stroke:1.5}),e.jsx("span",{children:t("sources.addSource")})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};function dj({source:t,onToggle:s,onRemove:n,onEdit:a,isSelected:r}){const{t:o}=O("common"),d=t.url.includes("ecosystem.json"),i=t.status==="error"||t.status!=="loading"&&!!t.errorMessage;let l=null;return i?l=e.jsx(_t,{className:"size-3 text-red-500"}):t.status==="loading"?l=e.jsx(be,{className:"text-muted-foreground size-3 animate-spin"}):t.status==="success"&&(l=e.jsx(je,{className:"size-3 text-green-500"})),e.jsx("div",{className:L("cursor-pointer rounded-xl border p-4 transition-colors",t.enabled?"bg-card":"bg-muted/30 opacity-60",r&&"ring-primary ring-2"),onClick:a,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-primary/10 shrink-0 rounded-full p-2",children:e.jsx(mc,{className:"text-primary size-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"truncate font-medium",children:t.name}),d&&e.jsx("span",{className:"bg-primary/10 text-primary rounded px-1.5 py-0.5 text-xs",children:o("sources.official")}),l]}),e.jsx("p",{className:"text-muted-foreground mt-0.5 truncate text-sm",children:t.url}),e.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:o("sources.updatedAt",{date:new Date(t.lastUpdated).toLocaleString()})}),i&&e.jsx("p",{className:"truncate text-xs text-red-500",children:t.errorMessage??o("service.queryFailed")})]})]}),e.jsxs("div",{className:"flex shrink-0 items-center gap-1",onClick:m=>m.stopPropagation(),children:[e.jsx("button",{onClick:s,className:L("rounded-full p-2 transition-colors",t.enabled?"bg-green-100 text-green-600 hover:bg-green-200":"bg-muted text-muted-foreground hover:bg-muted/80"),"aria-label":t.enabled?o("disable"):o("enable"),children:t.enabled?e.jsx(je,{className:"size-4",stroke:2}):e.jsx(nn,{className:"size-4",stroke:2})}),!d&&e.jsx("button",{onClick:n,className:"text-muted-foreground hover:text-destructive hover:bg-destructive/10 rounded-full p-2 transition-colors","aria-label":o("delete"),children:e.jsx(ss,{className:"size-4",stroke:1.5})})]})]})})}zu.__docgenInfo={description:"",methods:[],displayName:"SettingsSourcesActivity"};function Xt({className:t,size:s="default",...n}){return e.jsx("div",{"data-slot":"card","data-size":s,className:L("ring-foreground/10 bg-card text-card-foreground gap-4 overflow-hidden rounded-xl py-4 text-sm ring-1 has-data-[slot=card-footer]:pb-0 has-[>img:first-child]:pt-0 data-[size=sm]:gap-3 data-[size=sm]:py-3 data-[size=sm]:has-data-[slot=card-footer]:pb-0 *:[img:first-child]:rounded-t-xl *:[img:last-child]:rounded-b-xl group/card flex flex-col",t),...n})}function Ha({className:t,...s}){return e.jsx("div",{"data-slot":"card-header",className:L("gap-1 rounded-t-xl px-4 group-data-[size=sm]/card:px-3 [.border-b]:pb-4 group-data-[size=sm]/card:[.border-b]:pb-3 group/card-header @container/card-header grid auto-rows-min items-start has-data-[slot=card-action]:grid-cols-[1fr_auto] has-data-[slot=card-description]:grid-rows-[auto_auto]",t),...s})}function Ua({className:t,...s}){return e.jsx("div",{"data-slot":"card-title",className:L("text-base leading-snug font-medium group-data-[size=sm]/card:text-sm",t),...s})}function Va({className:t,...s}){return e.jsx("div",{"data-slot":"card-description",className:L("text-muted-foreground text-sm",t),...s})}function Zt({className:t,...s}){return e.jsx("div",{"data-slot":"card-content",className:L("px-4 group-data-[size=sm]/card:px-3",t),...s})}Xt.__docgenInfo={description:"",methods:[],displayName:"Card",props:{size:{required:!1,tsType:{name:"union",raw:'"default" | "sm"',elements:[{name:"literal",value:'"default"'},{name:"literal",value:'"sm"'}]},description:"",defaultValue:{value:'"default"',computed:!1}}}};Ha.__docgenInfo={description:"",methods:[],displayName:"CardHeader"};Ua.__docgenInfo={description:"",methods:[],displayName:"CardTitle"};Va.__docgenInfo={description:"",methods:[],displayName:"CardDescription"};Zt.__docgenInfo={description:"",methods:[],displayName:"CardContent"};const uj=tm("h-5 gap-1 rounded-4xl border border-transparent px-2 py-0.5 text-xs font-medium transition-all has-data-[icon=inline-end]:pr-1.5 has-data-[icon=inline-start]:pl-1.5 [&>svg]:size-3! inline-flex items-center justify-center w-fit whitespace-nowrap shrink-0 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-colors overflow-hidden group/badge",{variants:{variant:{default:"bg-primary text-primary-foreground [a]:hover:bg-primary/80",secondary:"bg-secondary text-secondary-foreground [a]:hover:bg-secondary/80",destructive:"bg-destructive/10 [a]:hover:bg-destructive/20 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 text-destructive dark:bg-destructive/20",outline:"border-border text-foreground [a]:hover:bg-muted [a]:hover:text-muted-foreground",ghost:"hover:bg-muted hover:text-muted-foreground dark:hover:bg-muted/50",link:"text-primary underline-offset-4 hover:underline"}},defaultVariants:{variant:"default"}});function Na({className:t,variant:s="default",render:n,...a}){return sf({defaultTagName:"span",props:Mf({className:L(uj({className:t,variant:s}))},a),...n!==void 0?{render:n}:{},state:{slot:"badge",variant:s}})}function mj({permission:t}){const n=Ym[t]?.risk??"medium",a=Xm(t),r=n==="high"?Oe:ir,o=n==="high"?"text-red-500":n==="medium"?"text-amber-500":"text-green-500";return e.jsxs("div",{className:"flex items-start gap-3 py-3",children:[e.jsx(r,{className:L("mt-0.5 size-5 shrink-0",o),stroke:1.5}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:a.label}),e.jsx("p",{className:"text-muted-foreground mt-0.5 text-xs",children:a.description})]})]})}function fj({directive:t}){const{t:s}=O("ecosystem"),n=s(`permissionsPolicy.${t}.name`,{defaultValue:t}),a=s(`permissionsPolicy.${t}.description`,{defaultValue:s("permissionsPolicy.defaultDescription")});return e.jsxs("div",{className:"flex items-start gap-3 py-3",children:[e.jsx(ir,{className:"text-sky-500 mt-0.5 size-5 shrink-0",stroke:1.5}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:n}),e.jsx("p",{className:"text-muted-foreground mt-0.5 text-xs",children:a})]})]})}function ls({label:t,value:s,isLink:n=!1,href:a}){const r=e.jsxs("div",{className:"border-border/50 flex items-center justify-between border-b py-3 last:border-0",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t}),e.jsxs("span",{className:L("text-sm font-medium",n&&"text-primary flex items-center gap-1"),children:[s,n&&e.jsx(Le,{className:"size-4"})]})]});return n&&a?e.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",children:r}):r}const Ou=({params:t})=>{const{pop:s}=Z(),{t:n}=O("ecosystem"),[a,r]=c.useState(null),[o,d]=c.useState(!0),[i,l]=c.useState(!1),m=Ae(tr,v=>Qm.isAppInstalled(v,t.appId));c.useEffect(()=>{let v=!1;return(async()=>{d(!0),await zo();let N=ni(t.appId);N||(await Fo({force:!1}),N=ni(t.appId)),!v&&(r(N??null),d(!1))})(),()=>{v=!0}},[t.appId]);const u=c.useCallback(()=>{a&&Me.installApp(a.id)},[a]),f=c.useCallback(()=>{a&&(Me.updateAppLastUsed(a.id),Me.setActiveSubPage("mine"),Oo(a.id,{...a,targetDesktop:"mine"}),s())},[a,s]);if(o)return e.jsx(le,{children:e.jsx("div",{className:"bg-background flex min-h-screen items-center justify-center",children:e.jsx(Te,{size:"lg"})})});if(!a)return e.jsx(le,{children:e.jsxs("div",{className:"bg-background flex min-h-screen flex-col items-center justify-center gap-4",children:[e.jsx("p",{className:"text-muted-foreground",children:n("detail.notFound")}),e.jsx("button",{onClick:()=>s(),className:"bg-primary text-primary-foreground rounded-full px-4 py-2 text-sm font-medium",children:n("detail.back")})]})});const h=a.longDescription??a.description,g=h.length>150,b=i||!g?h:h.slice(0,150)+"...",p=a.permissions??[],x=a.permissionsPolicy??[];return e.jsx(le,{children:e.jsxs("div",{className:"bg-background detail-scroll-container flex min-h-screen flex-col",children:[e.jsx("div",{className:"bg-background/80 border-border/50 sticky top-0 z-20 border-b backdrop-blur-xl",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[e.jsx("button",{onClick:()=>s(),className:"hover:bg-muted -ml-1.5 rounded-full p-1.5 transition-colors",children:e.jsx(Zo,{className:"size-5",stroke:1.5})}),e.jsx("span",{className:"detail-header-title max-w-[200px] truncate font-semibold",children:a.name}),e.jsx("button",{className:"hover:bg-muted -mr-1.5 rounded-full p-1.5 transition-colors",children:e.jsx(Hs,{className:"size-5",stroke:1.5})})]})}),e.jsxs("div",{className:"detail-scroller flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"px-5 pt-4 pb-5",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(ef,{src:a.icon,name:a.name,size:"2xl",shadow:"lg",className:"shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1 pt-1",children:[e.jsx("h1",{className:"truncate text-xl font-bold",children:a.name}),e.jsx("p",{className:"text-muted-foreground mt-0.5 truncate text-sm",children:a.author??n("detail.unknownDeveloper")}),m?e.jsx("button",{onClick:f,className:"bg-primary text-primary-foreground mt-4 rounded-full px-8 py-2 text-sm font-semibold",children:n("detail.open")}):e.jsx("button",{onClick:u,className:"bg-primary text-primary-foreground mt-4 rounded-full px-8 py-2 text-sm font-semibold",children:n("detail.get")})]})]}),e.jsxs("div",{className:"text-muted-foreground mt-5 flex items-center gap-4 text-xs",children:[a.category&&e.jsx("span",{className:"text-foreground font-medium",children:n(`detail.categories.${a.category}`,{defaultValue:a.category})}),a.beta&&e.jsx("span",{className:"rounded-full bg-amber-100 px-2 py-0.5 font-medium text-amber-700 dark:bg-amber-900/30 dark:text-amber-400",children:n("detail.beta")}),e.jsxs("span",{children:["v",a.version]})]})]}),a.screenshots&&a.screenshots.length>0&&e.jsx("div",{className:"border-border/50 border-t",children:e.jsxs("div",{className:"px-5 py-4",children:[e.jsx("h2",{className:"mb-4 text-lg font-bold",children:n("detail.preview")}),e.jsx("div",{className:"-mx-5 flex snap-x snap-mandatory gap-3 overflow-x-auto px-5 pb-2",style:{scrollbarWidth:"none"},children:a.screenshots.map((v,j)=>e.jsx("div",{className:"bg-muted aspect-[9/19.5] w-[220px] shrink-0 snap-center overflow-hidden rounded-2xl shadow-lg ring-1 ring-black/5",children:e.jsx("img",{src:v,alt:`${a.name} screenshot ${j+1}`,className:"h-full w-full object-cover",loading:"lazy",onError:N=>{const y=N.currentTarget.parentElement;y&&(y.style.display="none")}})},v))})]})}),e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:b}),g&&e.jsxs("button",{onClick:()=>l(!i),className:"text-primary mt-2 flex items-center gap-1 text-sm font-medium",children:[n(i?"detail.collapse":"detail.more"),i?e.jsx(qo,{className:"size-4"}):e.jsx(Uo,{className:"size-4"})]})]}),a.chains&&a.chains.length>0&&e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("h2",{className:"mb-3 text-lg font-bold",children:n("detail.supportedChains")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.chains.map(v=>e.jsx("span",{className:"bg-muted rounded-full px-3 py-1.5 text-sm font-medium",children:v},v))})]}),(p.length>0||x.length>0)&&e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-bold",children:n("detail.privacy")}),e.jsx(Na,{variant:"outline",children:p.length+x.length})]}),e.jsxs("div",{className:"space-y-3",children:[p.length>0&&e.jsxs(Xt,{size:"sm",children:[e.jsxs(Ha,{className:"border-b",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx(Ua,{children:n("detail.permissions")}),e.jsx(Na,{variant:"secondary",children:p.length})]}),e.jsx(Va,{children:n("detail.privacyHint")})]}),e.jsx(Zt,{className:"divide-y divide-border/50",children:p.map(v=>e.jsx(mj,{permission:v},v))})]}),x.length>0&&e.jsxs(Xt,{size:"sm",children:[e.jsxs(Ha,{className:"border-b",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx(Ua,{children:n("permissionsPolicy.title")}),e.jsx(Na,{variant:"secondary",children:x.length})]}),e.jsx(Va,{children:n("permissionsPolicy.hint")})]}),e.jsx(Zt,{className:"divide-y divide-border/50",children:x.map(v=>e.jsx(fj,{directive:v},v))})]})]})]}),a.tags&&a.tags.length>0&&e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("h2",{className:"mb-3 text-lg font-bold",children:n("detail.tags")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.tags.map(v=>e.jsx("span",{className:"bg-primary/10 text-primary rounded-full px-3 py-1.5 text-sm font-medium",children:n("detail.tagLabel",{tag:v})},v))})]}),e.jsxs("div",{className:"border-border/50 border-t px-5 py-4",children:[e.jsx("h2",{className:"mb-2 text-lg font-bold",children:n("detail.info")}),e.jsxs("div",{className:"bg-muted/50 rounded-2xl px-4",children:[a.author&&e.jsx(ls,{label:n("detail.developer"),value:a.author}),e.jsx(ls,{label:n("detail.version"),value:a.version}),a.category&&e.jsx(ls,{label:n("detail.category"),value:n(`detail.categories.${a.category}`,{defaultValue:a.category})}),a.publishedAt&&e.jsx(ls,{label:n("detail.publishedAt"),value:a.publishedAt}),a.updatedAt&&e.jsx(ls,{label:n("detail.updatedAt"),value:a.updatedAt}),a.website&&e.jsx(ls,{label:n("detail.website"),value:n("detail.visit"),isLink:!0,href:a.website})]})]}),e.jsx("div",{className:"h-8"})]})]})})};Ou.__docgenInfo={description:"",methods:[],displayName:"MiniappDetailActivity"};function Ks({className:t,...s}){return e.jsx("label",{"data-slot":"label",className:L("gap-2 text-sm leading-none font-medium group-data-[disabled=true]:opacity-50 peer-disabled:opacity-50 flex items-center select-none group-data-[disabled=true]:pointer-events-none peer-disabled:cursor-not-allowed",t),...s})}Ks.__docgenInfo={description:"",methods:[],displayName:"Label"};function pj({queryAddress:t,queryChain:s}){const{t:n}=O(["common"]),a=Xs(),r=rs(),{data:o,isLoading:d,error:i}=r.nativeBalance.useState({address:t},{enabled:!!t});return e.jsx(Xt,{className:L("transition-all",d&&"opacity-50"),children:e.jsx(Zt,{className:"pt-6",children:i?e.jsxs("div",{className:"flex items-center gap-3 text-destructive",children:[e.jsx(_t,{className:"size-5 shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:n("common:addressLookup.error")}),e.jsx("div",{className:"text-sm opacity-80",children:i.message})]})]}):o?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-primary/10 flex size-12 items-center justify-center rounded-full",children:e.jsx(pp,{className:"text-primary size-6"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[o.amount.toFormatted()," ",o.symbol]}),e.jsx("div",{className:"text-muted-foreground text-sm",children:n("common:addressLookup.onChain",{chain:a.find(l=>l.id===s)?.name??s})})]})]}):d?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx(Te,{size:"lg"})}):null})})}function Bu(){const{t}=O(["common","wallet"]),{goBack:s}=de(),n=Xs(),[a,r]=c.useState("ethereum"),[o,d]=c.useState(""),[i,l]=c.useState(""),[m,u]=c.useState(""),[f,h]=c.useState(!1),g=c.useCallback(()=>{o.trim()&&(h(!0),l(o.trim()),u(a),setTimeout(()=>h(!1),100))},[o,a]),b=c.useCallback(v=>{v.key==="Enter"&&g()},[g]),p=n.filter(v=>v.chainKind==="evm"),x=n.filter(v=>v.chainKind!=="evm");return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(K,{title:t("common:addressLookup.balanceTitle"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ks,{children:t("common:addressLookup.chain")}),e.jsxs(Fs,{value:a,onValueChange:v=>v&&r(v),children:[e.jsx(Ws,{children:e.jsx($s,{})}),e.jsxs(qs,{children:[p.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:"EVM"}),p.map(v=>e.jsx(Yt,{value:v.id,children:v.name},v.id))]}),x.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:t("common:addressLookup.otherChains")}),x.map(v=>e.jsx(Yt,{value:v.id,children:v.name},v.id))]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ks,{children:t("common:addressLookup.address")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ve,{placeholder:t("common:addressLookup.addressPlaceholder"),value:o,onChange:v=>d(v.target.value),onKeyDown:b,className:"flex-1 font-mono text-sm"}),e.jsx(J,{onClick:g,disabled:!o.trim()||f,children:f?e.jsx(Te,{size:"sm"}):e.jsx(tn,{className:"size-4"})})]})]}),i&&m&&e.jsx(Dt,{chainId:m,fallback:e.jsx(Xt,{children:e.jsx(Zt,{className:"pt-6",children:e.jsx("p",{className:"text-muted-foreground text-center",children:"Chain not supported"})})}),children:e.jsx(pj,{queryAddress:i,queryChain:m})}),!1]})]})}Bu.__docgenInfo={description:"",methods:[],displayName:"AddressBalancePage"};const Fu=()=>e.jsx(le,{children:e.jsx(Bu,{})});Fu.__docgenInfo={description:"",methods:[],displayName:"AddressBalanceActivity"};function hj(t,s){return(parseFloat(t)/Math.pow(10,s)).toLocaleString(void 0,{maximumFractionDigits:6})}function xj(t){return new Date(t).toLocaleString()}function gj({tx:t,address:s}){const{t:n}=O("common"),a=t.direction==="out"||t.from.toLowerCase()===s.toLowerCase(),r=t.assets.find(u=>u.assetType==="native"||u.assetType==="token"),o=r?r.value:"0",d=r?r.symbol:"",i=r?r.decimals:0,l=n(a?"signSymbol.minus":"signSymbol.plus"),m=n(a?"addressLookup.toLabel":"addressLookup.fromLabel");return e.jsxs("div",{className:"flex items-center gap-3 py-3 border-b last:border-b-0",children:[e.jsx("div",{className:`p-2 rounded-full ${a?"bg-red-100 text-red-600":"bg-green-100 text-green-600"}`,children:a?e.jsx(ic,{className:"size-4"}):e.jsx(ep,{className:"size-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"text-sm font-medium truncate",children:[m," ",a?t.to:t.from]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:xj(t.timestamp)})]}),e.jsxs("div",{className:`text-sm font-medium ${a?"text-red-600":"text-green-600"}`,children:[l,hj(o,i)," ",d]})]})}function vj({searchAddress:t,selectedChain:s,explorerUrl:n,onOpenExplorer:a}){const{t:r}=O(["common"]),o=Xs(),d=c.useMemo(()=>o.find(h=>h.id===s),[o,s]),i=rs(),{data:l,isLoading:m,error:u}=i.transactionHistory.useState({address:t,limit:50},{enabled:!!t}),f=!(u instanceof Mo);return e.jsx(Xt,{children:e.jsxs(Zt,{className:"pt-6",children:[m?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(be,{className:"size-6 animate-spin text-muted-foreground"})}):u?e.jsx("div",{className:"text-center py-8 text-destructive",children:r("common:addressLookup.queryError")}):l&&l.length>0?e.jsx("div",{className:"divide-y",children:l.map(h=>e.jsx(gj,{tx:h,address:t},h.hash))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:f?e.jsx("p",{children:r("common:addressLookup.noTransactions")}):e.jsx("p",{children:r("common:addressLookup.useExplorerHint")})}),n&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs(J,{variant:f?"outline":"default",size:"sm",className:"w-full gap-2",onClick:a,children:[e.jsx(Ca,{className:"size-4"}),r("common:addressLookup.viewOnExplorer",{name:d?.name??s})]})})]})})}function Wu(){const{t}=O(["common","wallet"]),{goBack:s}=de(),n=Xs(),[a,r]=c.useState("bfmeta"),[o,d]=c.useState(""),[i,l]=c.useState(""),[m,u]=c.useState(""),f=c.useMemo(()=>n.find(j=>j.id===m),[n,m]),h=c.useMemo(()=>{if(!f?.explorer||!i.trim())return null;const{queryAddress:j,url:N}=f.explorer;return j?j.replace(":address",i.trim()):`${N}/address/${i.trim()}`},[f,i]),g=c.useCallback(()=>{o.trim()&&(l(o.trim()),u(a))},[o,a]),b=c.useCallback(j=>{j.key==="Enter"&&g()},[g]),p=c.useCallback(()=>{h&&window.open(h,"_blank","noopener,noreferrer")},[h]),x=n.filter(j=>j.chainKind==="evm"),v=n.filter(j=>j.chainKind!=="evm");return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(K,{title:t("common:addressLookup.transactionsTitle"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ks,{children:t("common:addressLookup.chain")}),e.jsxs(Fs,{value:a,onValueChange:j=>j&&r(j),children:[e.jsx(Ws,{children:e.jsx($s,{})}),e.jsxs(qs,{children:[x.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:"EVM"}),x.map(j=>e.jsx(Yt,{value:j.id,children:j.name},j.id))]}),v.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:t("common:addressLookup.otherChains")}),v.map(j=>e.jsx(Yt,{value:j.id,children:j.name},j.id))]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ks,{children:t("common:addressLookup.address")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ve,{placeholder:t("common:addressLookup.addressPlaceholder"),value:o,onChange:j=>d(j.target.value),onKeyDown:b,className:"flex-1 font-mono text-sm"}),e.jsx(J,{onClick:g,disabled:!o.trim(),children:e.jsx(tn,{className:"size-4"})})]})]}),i&&m&&e.jsx(Dt,{chainId:m,fallback:e.jsx(Xt,{children:e.jsx(Zt,{className:"pt-6",children:e.jsx("p",{className:"text-muted-foreground text-center",children:"Chain not supported"})})}),children:e.jsx(vj,{searchAddress:i,selectedChain:m,explorerUrl:h,onOpenExplorer:p})})]})]})}Wu.__docgenInfo={description:"",methods:[],displayName:"AddressTransactionsPage"};const $u=()=>e.jsx(le,{children:e.jsx(Wu,{})});$u.__docgenInfo={description:"",methods:[],displayName:"AddressTransactionsActivity"};const{useFlow:Z}=hx({transitionDuration:350,plugins:[xx(),$x({theme:"cupertino"}),nv({routes:{MainTabsActivity:"/",WalletListActivity:"/wallet/list",WalletConfigActivity:"/wallet/:walletId",WalletCreateActivity:"/wallet/create",SendActivity:"/send",DestroyActivity:"/destroy",ReceiveActivity:"/receive",SettingsActivity:"/settings",SettingsLanguageActivity:"/settings/language",SettingsCurrencyActivity:"/settings/currency",SettingsChainsActivity:"/settings/chains",SettingsMnemonicActivity:"/settings/mnemonic",SettingsWalletLockActivity:"/settings/wallet-lock",SettingsWalletChainsActivity:"/settings/wallet-chains",SettingsStorageActivity:"/settings/storage",HistoryActivity:"/history",TransactionDetailActivity:"/transaction/:txId",ScannerActivity:"/scanner",AuthorizeAddressActivity:"/authorize/address/:id",AuthorizeSignatureActivity:"/authorize/signature/:id",OnboardingRecoverActivity:"/onboarding/recover",TokenDetailActivity:"/token/:tokenId",AddressBookActivity:"/address-book",MyCardActivity:"/my-card",NotificationsActivity:"/notifications",StakingActivity:"/staking",WelcomeActivity:"/welcome",SettingsSourcesActivity:"/settings/sources",MiniappDetailActivity:"/miniapp/:appId/detail",AddressBalanceActivity:"/address-balance",AddressTransactionsActivity:"/address-transactions",ChainSelectorJob:"/job/chain-selector",WalletRenameJob:"/job/wallet-rename/:walletId",WalletDeleteJob:"/job/wallet-delete/:walletId",WalletLockConfirmJob:"/job/wallet-lock-confirm",TwoStepSecretConfirmJob:"/job/two-step-secret-confirm",SetTwoStepSecretJob:"/job/set-two-step-secret",MnemonicOptionsJob:"/job/mnemonic-options",ContactEditJob:"/job/contact-edit",ContactPickerJob:"/job/contact-picker",WalletAddJob:"/job/wallet-add",WalletListJob:"/job/wallet-list",SecurityWarningJob:"/job/security-warning",TransferConfirmJob:"/job/transfer-confirm",TransferWalletLockJob:"/job/transfer-wallet-lock",FeeEditJob:"/job/fee-edit",ScannerJob:"/job/scanner",ContactAddConfirmJob:"/job/contact-add-confirm",ContactShareJob:"/job/contact-share",ClearDataConfirmJob:"/job/clear-data-confirm",WalletPickerJob:"/job/wallet-picker",SigningConfirmJob:"/job/signing-confirm",PermissionRequestJob:"/job/permission-request",MiniappTransferConfirmJob:"/job/miniapp-transfer-confirm",MiniappDestroyConfirmJob:"/job/miniapp-destroy-confirm",MiniappSignTransactionJob:"/job/miniapp-sign-transaction",ChainSwitchConfirmJob:"/job/chain-switch-confirm",CryptoAuthorizeJob:"/job/crypto-authorize"},fallbackActivity:()=>"MainTabsActivity",useHash:!0,urlPatternOptions:{segmentValueCharset:"a-zA-Z0-9-._~ %"}})],activities:{MainTabsActivity:yd,WalletListActivity:jd,WalletConfigActivity:Nd,WalletCreateActivity:kd,SendActivity:Td,DestroyActivity:Ed,ReceiveActivity:Md,SettingsActivity:Rd,SettingsLanguageActivity:Dd,SettingsCurrencyActivity:Od,SettingsChainsActivity:Qd,SettingsMnemonicActivity:Xd,SettingsWalletLockActivity:eu,SettingsWalletChainsActivity:Ru,SettingsStorageActivity:Du,HistoryActivity:su,TransactionDetailActivity:au,ScannerActivity:iu,AuthorizeAddressActivity:lu,AuthorizeSignatureActivity:uu,OnboardingRecoverActivity:pu,TokenDetailActivity:xu,AddressBookActivity:vu,MyCardActivity:ju,NotificationsActivity:wu,StakingActivity:Pu,WelcomeActivity:_u,SettingsSourcesActivity:zu,MiniappDetailActivity:Ou,AddressBalanceActivity:Fu,AddressTransactionsActivity:$u,ChainSelectorJob:Pl,WalletRenameJob:_l,WalletDeleteJob:Ml,WalletLockConfirmJob:Rl,TwoStepSecretConfirmJob:Ll,SetTwoStepSecretJob:Ol,MnemonicOptionsJob:Bl,ContactEditJob:Fl,ContactPickerJob:Wl,WalletAddJob:$l,WalletListJob:ql,SecurityWarningJob:Hl,TransferConfirmJob:Vl,TransferWalletLockJob:Kl,FeeEditJob:zl,ScannerJob:Gl,ContactAddConfirmJob:Ql,ContactShareJob:Yl,ClearDataConfirmJob:Xl,WalletPickerJob:Zl,SigningConfirmJob:td,PermissionRequestJob:sd,MiniappTransferConfirmJob:ud,MiniappDestroyConfirmJob:pd,MiniappSignTransactionJob:hd,ChainSwitchConfirmJob:xd,CryptoAuthorizeJob:gd}});function yj(t,s){const n=Math.abs(t-s);return Math.min(n,360-n)}function bj(t,s,n=30){if(s.length===0)return 1;let a=180;for(const r of s){const o=yj(t,r);o<a&&(a=o)}return a<n?a/n:1}function jj(t){return Zu.map(s=>({...s,weight:bj(s.hue,t)}))}const Nj="wallet-config-preview-name";function Xn({mode:t,walletId:s,onEditOnlyComplete:n,className:a}){const{t:r}=O(["wallet","onboarding","common"]),{push:o}=Z(),d=Mt(),i=d.find(M=>M.id===s),l=Je(),m=Ao(),u=es(),[f,h]=c.useState(t==="edit-only"?"edit":t),[g,b]=c.useState(""),[p,x]=c.useState(0),v=c.useRef(null),[j,N]=c.useState(!1),y=c.useMemo(()=>d.filter(M=>M.id!==s).map(M=>M.themeHue),[d,s]),S=c.useMemo(()=>jj(y),[y]);c.useEffect(()=>{i&&(b(i.name),x(i.themeHue))},[i]);const C=c.useMemo(()=>i?.chainAddresses.find(M=>M.chain===l)??i?.chainAddresses[0],[i,l]),P=c.useCallback(M=>{if(!v.current)return;const B=v.current.getBoundingClientRect(),ee=Math.max(0,Math.min(M-B.left,B.width))/B.width,W=Math.round(ee*3600)/10;x(W)},[]),_=M=>{M.stopPropagation(),N(!0),P(M.clientX)},I=M=>{M.stopPropagation(),N(!0),M.touches[0]&&P(M.touches[0].clientX)};c.useEffect(()=>{if(!j)return;const M=ee=>P(ee.clientX),B=ee=>{ee.touches[0]&&P(ee.touches[0].clientX)},G=()=>N(!1);return document.addEventListener("mousemove",M),document.addEventListener("mouseup",G),document.addEventListener("touchmove",B),document.addEventListener("touchend",G),()=>{document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",G),document.removeEventListener("touchmove",B),document.removeEventListener("touchend",G)}},[j,P]);const T=c.useCallback(()=>{o("ChainSelectorJob",{})},[o]),k=c.useCallback(()=>{i&&(b(i.name),x(i.themeHue)),h("edit")},[i]),A=c.useCallback(async()=>{if(!i)return;const M=g.trim();M&&M!==i.name&&await ye.updateWalletName(i.id,M),p!==i.themeHue&&await ye.updateWalletThemeHue(i.id,p),h("default")},[i,g,p]),w=c.useCallback(()=>{i&&(b(i.name),x(i.themeHue)),h("default")},[i]),E=c.useCallback(async()=>{if(!i)return;const M=g.trim();M&&M!==i.name&&await ye.updateWalletName(i.id,M),p!==i.themeHue&&await ye.updateWalletThemeHue(i.id,p),n?.()},[i,g,p,n]),D=c.useCallback(async()=>{i&&(await ye.setCurrentWallet(i.id),o("SettingsMnemonicActivity",{}))},[i,o]),z=c.useCallback(()=>{i&&o("WalletDeleteJob",{walletId:i.id})},[i,o]);if(!i)return e.jsx("div",{className:L("text-muted-foreground p-4 text-center",a),children:r("wallet:detail.notFound")});const R=f==="edit"||t==="edit-only"?p:i.themeHue,V=f==="edit"||t==="edit-only";return e.jsxs("div",{className:L("space-y-6",a),children:[e.jsx("div",{className:"flex justify-center px-4",children:e.jsx("div",{className:"flex w-full max-w-[360px] aspect-[1.6/1] items-stretch",children:e.jsx(Io,{wallet:{...i,name:V?g:i.name,themeHue:R},themeHue:R,walletNameTestId:Nj,chain:C?.chain,chainName:C?.chain||"",address:C?.address||i.address,chainIconUrl:m[C?.chain??""],onOpenChainSelector:T})})}),V?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm",children:r("onboarding:theme.walletName")}),e.jsxs(xm,{children:[e.jsx(gm,{value:g,onChange:M=>b(M.target.value),placeholder:r("wallet:defaultName"),maxLength:20,className:"text-center"}),e.jsx(vm,{align:"inline-end",children:e.jsx(ym,{size:"icon-xs",variant:"ghost",onClick:()=>b(r("onboarding:create.generatedNamePattern",{word:Tn(u),suffix:r("onboarding:create.walletSuffix")})),title:r("wallet:randomName"),children:e.jsx(yp,{className:"size-4"})})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:r("onboarding:theme.customColor")}),e.jsxs("span",{className:"text-muted-foreground font-mono",children:[p.toFixed(1),""]})]}),e.jsxs("div",{ref:v,className:"relative h-8 cursor-pointer touch-none rounded-full",style:{background:"linear-gradient(to right, oklch(0.6 0.25 0), oklch(0.6 0.25 60), oklch(0.6 0.25 120), oklch(0.6 0.25 180), oklch(0.6 0.25 240), oklch(0.6 0.25 300), oklch(0.6 0.25 360))"},onMouseDown:_,onTouchStart:I,children:[y.map((M,B)=>e.jsx("div",{className:"absolute top-0 h-full w-0.5 bg-black/30",style:{left:`${M/360*100}%`},title:r("onboarding:theme.usedColor")},B)),e.jsx("div",{className:"absolute top-1/2 -translate-x-1/2 -translate-y-1/2",style:{left:`${p/360*100}%`},children:e.jsx("div",{className:"size-6 rounded-full border-2 border-white shadow-md",style:{backgroundColor:`oklch(0.6 0.25 ${p})`}})})]})]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-3",children:S.map(M=>{const B=Math.abs(p-M.hue)<.5,G=M.weight<.5;return e.jsx("button",{type:"button",onClick:()=>x(M.hue),className:L("relative size-10 rounded-full transition-all","ring-offset-background focus-visible:ring-ring focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:outline-none",B&&"ring-primary ring-2 ring-offset-2",G&&"opacity-50"),style:{backgroundColor:M.color},title:r(M.nameKey),children:B&&e.jsx(je,{className:"absolute inset-0 m-auto size-5 text-white drop-shadow-md"})},M.hue)})})]}),t==="edit-only"?e.jsx(J,{className:"w-full",onClick:E,disabled:!g.trim(),"data-testid":"theme-complete-button",style:{"--primary-hue":p,"--primary":`oklch(var(--primary-lightness) var(--primary-saturation) ${p})`},children:r("common:confirm")}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx(J,{variant:"outline",className:"flex-1",onClick:w,children:r("common:cancel")}),e.jsx(J,{className:"flex-1",onClick:A,disabled:!g.trim(),style:{"--primary-hue":p,"--primary":`oklch(var(--primary-lightness) var(--primary-saturation) ${p})`},children:r("common:save")})]})]}):e.jsxs("div",{className:"flex justify-center gap-8",children:[e.jsxs("button",{onClick:k,className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"bg-primary/10 text-primary group-hover:bg-primary/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:e.jsx(Lp,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:r("wallet:detail.editName")})]}),e.jsxs("button",{onClick:D,className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"bg-primary/10 text-primary group-hover:bg-primary/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:e.jsx(mr,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:r("wallet:detail.exportMnemonic")})]}),e.jsxs("button",{onClick:z,className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"bg-destructive/10 text-destructive group-hover:bg-destructive/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:e.jsx(ss,{className:"size-5"})}),e.jsx("span",{className:"text-destructive text-xs font-medium",children:r("wallet:detail.deleteWallet")})]})]})]})}Xn.__docgenInfo={description:`
- default: + edit
- edit:  default  default
- edit-only: / onEditOnlyComplete`,methods:[],displayName:"WalletConfig",props:{mode:{required:!0,tsType:{name:"union",raw:"'edit-only' | 'default' | 'edit'",elements:[{name:"literal",value:"'edit-only'"},{name:"literal",value:"'default'"},{name:"literal",value:"'edit'"}]},description:""},walletId:{required:!0,tsType:{name:"string"},description:""},onEditOnlyComplete:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};export{gu as A,Gd as C,Pd as D,Sp as I,Ld as L,bu as M,Nu as N,_d as R,Se as S,nu as T,Yd as V,Xn as W,Wu as a,tu as b,Zd as c,zd as d,Es as e,Dr as f,bd as g};
