const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./snapdom-CO8q8LPW.js","./preload-helper-PPVm8Dsz.js","./index-Ar-6A-5n.js","./schemas-BX8BzOgD.js","./chain-config-DqVXGLIz.js","./index-D0E7N0oa.js","./bioforest-uXX5qE5N.js","./iframe-Cctxta_P.js","./iframe-BqSeQW3N.css","./address-format-DY2duW3A.js","./amount-BQsqQYGO.js"])))=>i.map(i=>d[i]);
import{A as Ue,w as Ce,B as ms,C as Bt,D as ye,K as zo,j as ur,x as mr,y as fr,d as hs,a as xs,b as na,g as Us,f as qa,r as en,L as rm,u as aa,G as Lo,H as Bo,I as Oo,J as Fo,c as _t,E as ra,M as im,F as Wo}from"./chain-config-DqVXGLIz.js";import{u as Ne,g as om,r as c,j as t,R as pr,N as lm,aJ as hr,aH as tn,aI as sn,O as xr,aK as $o,P as Va,S as cm,t as dm}from"./iframe-Cctxta_P.js";import{a as ia,c as z}from"./utils-CDN07tui.js";import{u as Ho,d as Ua,W as um}from"./useWalletTheme-Dodx2vR5.js";import{W as mm,u as qo,a as fm,b as pm,c as hm,g as xm,d as gm,C as vm,e as bm,f as ym,h as jm,I as Nm,i as wm}from"./wallet-card-carousel-bHjRtOBy.js";import{W as Vo}from"./wallet-card-DUvztJIp.js";import{I as He,u as Sm,a as Uo,b as Jo,c as Cm,d as ci,e as km,f as Am}from"./input-BEIppV2G.js";import{B as q}from"./button-sjDKCcea.js";import{S as Im}from"./swiper-sync-context-CjJlB7jB.js";import{T as Tm}from"./TabBar-DcRd8yGH.js";import{h as Pm,c as Em,u as nn,t as Ko,a as _m,C as Mm,s as Ut}from"./token-item-JMOiWq81.js";import{T as gr}from"./transaction-list-X9g1OvtJ.js";import{S as Rm}from"./swipeable-tabs-BaNw0YM4.js";import{L as _e}from"./loading-spinner-CQ_N_PP1.js";import{u as F}from"./useTranslation-Cyi9axMr.js";import{I as qe}from"./IconAlertTriangle-D1gPId_I.js";import{b as Qt,I as oa,a as la}from"./IconTrash-B0njLt7H.js";import{G as et}from"./gradient-button-CI0i7sXk.js";import{c as Fs}from"./web-DodBcwRj.js";import{t as Dm}from"./web-DnZPwNCZ.js";import"./index-D0E7N0oa.js";import"./breakpoint-wIg8UP9C.js";import{_ as Ln}from"./preload-helper-PPVm8Dsz.js";import{g as Ss,k as vr,l as zm,s as Lm,v as Bm,m as Om,n as Fm,I as Wm}from"./index-Ar-6A-5n.js";import{A as Me}from"./amount-BQsqQYGO.js";import{c as de}from"./createReactComponent-BokZZTcn.js";import{I as $m,i as Hm,A as qm}from"./address-input-ByEd7c8I.js";import{I as kt}from"./IconPlus-BYH4oyqv.js";import{e as Js,I as Go,H as fs,u as Vm,l as Qo,J as Um,K as Jm,L as di,d as Km,M as ui,N as mi,O as fi,P as pi,Q as hi,R as xi,S as gi,T as vi,U as bi,V as yi,W as Gm}from"./index-PMWuThF-.js";import{g as ca,n as Qm,C as Ja,p as Ym}from"./index-Ddwf1R_9.js";import{a as br,j as yr,l as ut,o as gs,n as Jt,s as H,b as ft,c as mt,i as Cs}from"./schemas-BX8BzOgD.js";import{a as Xm}from"./my-apps-page-MK7MKRTA.js";import{E as Zm,c as Yo}from"./ecosystem-desktop-BnPQQWcR.js";import"./miniapp-splash-screen-CFlAZsTJ.js";import"./swiper-DvJCME9U.js";/* empty css                     */import{P as Q}from"./page-header-IqZZ6WTq.js";import{I as Be}from"./IconChevronRight-C0BW2P53.js";import{S as Ot,a as Ft,b as Wt,c as $t,u as ef,f as tf,D as sf,g as nf,h as af,i as rf,j as of,k as lf,l as cf,m as df,n as uf}from"./sheet-B0S2a8-v.js";import{I as je}from"./IconCheck-BUbIsnVA.js";import{createBioforestAdapter as Xo,deriveWalletChainAddresses as Zo}from"./index-gCFvptSk.js";import{C as vs}from"./chain-icon-DZMbM4Yp.js";import{p as Kt,P as ks}from"./pattern-lock-SayAo4q6.js";import{P as Bn}from"./password-input-BpuuKr_C.js";import{I as Yt}from"./IconAlertCircle-BEx518Hp.js";import{F as jr}from"./fee-display-DOEEjDSo.js";import{I as Ve}from"./IconLoader2-HxqyfCLV.js";import{g as Ht,C as da,I as mf}from"./contact-avatar-DZ6k3846.js";import{I as an,P as Nr}from"./pattern-lock-setup-CURA0ZEO.js";import{I as el,a as Ca,b as ua,c as ff,g as pf,d as hf,e as xf}from"./transaction-item-B6DGk-oU.js";import{i as gf,d as vf}from"./address-format-DY2duW3A.js";import{I as rn}from"./IconSearch-C5pGjBwS.js";import{I as wr}from"./IconDownload-eiHb9IB1.js";import{W as bf}from"./wallet-mini-card-C-JPi8da.js";import{I as yf,W as jf}from"./wallet-list-4aWeAdUv.js";import{C as tl}from"./checkbox-BowDeGVG.js";import{I as Sr}from"./IconChevronDown-BNgXvKMn.js";import{I as On}from"./IconCopy-XrsQyI7S.js";import{p as sl,g as Nf}from"./qr-parser-8mU0z0ng.js";import{c as nl}from"./index-DncKScgj.js";import{g as wf,a as Sf,b as Cf}from"./scanner-validators-YRGmuXyx.js";import{I as ma}from"./IconX-DY670URD.js";import{I as Cr}from"./IconWallet-V7xYCP6e.js";import{C as kf}from"./contact-card-G-Wjt9Su.js";import{i as Pn,c as En,X as _n,o as $e,G as ct,a as Af}from"./bioforest-uXX5qE5N.js";import{A as Ct}from"./address-display-Dtq1ht35.js";import{I as al}from"./IconShieldCheck-DQW5fnOn.js";import{A as os}from"./amount-display-lh-aDGFD.js";import{I as kr}from"./IconEye-B6IHLGK9.js";import{I as If}from"./IconInfoCircle-Cpbyhs8C.js";import{A as bs,P as wt,F as Tf,E as Pf}from"./error-boundary-DnCREgnV.js";import{I as on}from"./icon-circle-DAEhXiJ_.js";import{M as rl}from"./mnemonic-display-CRX6TruT.js";import{g as il,C as Ar}from"./chain-selector-Bmb_sBZp.js";import{g as Ef,v as ol,R as _f}from"./recover-wallet-form-CSOCwcjA.js";import{I as ll}from"./IconEyeOff-CeQs-_9n.js";import{I as As}from"./IconCircleCheck-B3YbjWQ1.js";import{A as Mf}from"./amount-input-G7sMpQoK.js";import{S as Rf,I as cl,a as Df}from"./send-result-Bhdp0SOO.js";import{A as zf}from"./qr-code-CY_2OM_C.js";import{e as dl,f as fa,a as Ye,b as ze,m as ul,k as ml,C as ji,u as tt,l as Ni}from"./useRenderElement-qlaWX--Y.js";import{T as fl}from"./Trans-D1vAX2s_.js";import{M as Lf}from"./mnemonic-input-RAWbuVGe.js";import{n as pe,ah as Ir,c as Bf,ai as te,U as Tr,u as pa,s as Of,h as Ff,m as Wf,aj as $f,ak as Hf,J as Dt,V as qf,ae as Vf,a1 as Ka,k as wi,v as Uf,b as Jf,a2 as Kf,l as Gf,I as Qf,i as Yf,p as pl,a8 as Xf,al as Zf,F as ep,t as hl,a as tp}from"./useOpenInteractionType-DzuqK0yc.js";import{c as pt,n as xl,f as sp,j as np,w as ap,h as ka}from"./useBaseUiId-H_eAYFur.js";import{u as gl}from"./useButton-BiCET3WI.js";import{r as rp}from"./index-CAE8aR0t.js";import"./empty-state-QlYsD_4V.js";import{b as Aa}from"./skeleton-dMQmJuYw.js";import"./animated-number-uR3fQozJ.js";import{T as ip}from"./time-display-DtS7YJCT.js";import{T as op,I as lp}from"./transaction-status-BNP81CyK.js";import{A as vl}from"./AppInfoCard-DdCKUNGl.js";import{P as cp}from"./PermissionList-rUVCBuXS.js";import{W as dp}from"./wallet-selector-Bl24-a4p.js";import{T as ht}from"./token-icon-DtvtRadC.js";import{T as Si}from"./TransactionDetails-BialB6zZ.js";import{B as Ci}from"./BalanceWarning-BruiXVm5.js";import{K as up}from"./key-type-selector-WnzuTAwd.js";import{A as mp}from"./arbitrary-key-input-D957AM3j.js";import{C as fp}from"./chain-address-preview-DEOfZQi_.js";import{C as pp}from"./collision-confirm-dialog-CVasNnUS.js";import{B as hp}from"./balance-display-CClRaya2.js";import{I as xp}from"./IconBell-85F7-uS-.js";import{I as gp}from"./IconCircleX-DxFRB6o2.js";import{I as vp}from"./IconShield-CgU9LUtE.js";const bp=[["path",{d:"M20 6v12a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2z",key:"svg-0"}],["path",{d:"M10 16h6",key:"svg-1"}],["path",{d:"M13 11m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-2"}],["path",{d:"M4 8h3",key:"svg-3"}],["path",{d:"M4 12h3",key:"svg-4"}],["path",{d:"M4 16h3",key:"svg-5"}]],yp=de("outline","address-book","AddressBook",bp);const jp=[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 15h10.55",key:"svg-1"}],["path",{d:"M6.551 4.938l3.26 10.034",key:"svg-2"}],["path",{d:"M17.032 4.636l-8.535 6.201",key:"svg-3"}],["path",{d:"M20.559 14.51l-8.535 -6.201",key:"svg-4"}],["path",{d:"M12.257 20.916l3.261 -10.034",key:"svg-5"}]],bl=de("outline","aperture","Aperture",jp);const Np=[["path",{d:"M17 7l-10 10",key:"svg-0"}],["path",{d:"M16 17l-9 0l0 -9",key:"svg-1"}]],wp=de("outline","arrow-down-left","ArrowDownLeft",Np);const Sp=[["path",{d:"M7 7l10 10",key:"svg-0"}],["path",{d:"M17 8l0 9l-9 0",key:"svg-1"}]],Cp=de("outline","arrow-down-right","ArrowDownRight",Sp);const kp=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M13 18l6 -6",key:"svg-1"}],["path",{d:"M13 6l6 6",key:"svg-2"}]],Ap=de("outline","arrow-right","ArrowRight",kp);const Ip=[["path",{d:"M17 7l-10 10",key:"svg-0"}],["path",{d:"M8 7l9 0l0 9",key:"svg-1"}]],yl=de("outline","arrow-up-right","ArrowUpRight",Ip);const Tp=[["path",{d:"M3 12h1m8 -9v1m8 8h1m-15.4 -6.4l.7 .7m12.1 -.7l-.7 .7",key:"svg-0"}],["path",{d:"M9 16a5 5 0 1 1 6 0a3.5 3.5 0 0 0 -1 3a2 2 0 0 1 -4 0a3.5 3.5 0 0 0 -1 -3",key:"svg-1"}],["path",{d:"M9.7 17l4.6 0",key:"svg-2"}]],jl=de("outline","bulb","Bulb",Tp);const Pp=[["path",{d:"M5 7h1a2 2 0 0 0 2 -2a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1a2 2 0 0 0 2 2h1a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-9a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M9 13a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-1"}]],Ep=de("outline","camera","Camera",Pp);const _p=[["path",{d:"M6 15l6 -6l6 6",key:"svg-0"}]],Pr=de("outline","chevron-up","ChevronUp",_p);const Mp=[["path",{d:"M14 10m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-0"}],["path",{d:"M21 12a9 9 0 1 1 -18 0a9 9 0 0 1 18 0z",key:"svg-1"}],["path",{d:"M12.5 11.5l-4 4l1.5 1.5",key:"svg-2"}],["path",{d:"M12 15l-1.5 -1.5",key:"svg-3"}]],Er=de("outline","circle-key","CircleKey",Mp);const Rp=[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M14.8 9a2 2 0 0 0 -1.8 -1h-2a2 2 0 1 0 0 4h2a2 2 0 1 1 0 4h-2a2 2 0 0 1 -1.8 -1",key:"svg-1"}],["path",{d:"M12 7v10",key:"svg-2"}]],Dp=de("outline","coin","Coin",Rp);const zp=[["path",{d:"M16.7 8a3 3 0 0 0 -2.7 -2h-4a3 3 0 0 0 0 6h4a3 3 0 0 1 0 6h-4a3 3 0 0 1 -2.7 -2",key:"svg-0"}],["path",{d:"M12 3v3m0 12v3",key:"svg-1"}]],Lp=de("outline","currency-dollar","CurrencyDollar",zp);const Bp=[["path",{d:"M6 12l6 -9l6 9l-6 9z",key:"svg-0"}],["path",{d:"M6 12l6 -3l6 3l-6 2z",key:"svg-1"}]],Op=de("outline","currency-ethereum","CurrencyEthereum",Bp);const Fp=[["path",{d:"M12 6m-8 0a8 3 0 1 0 16 0a8 3 0 1 0 -16 0",key:"svg-0"}],["path",{d:"M4 6v6a8 3 0 0 0 16 0v-6",key:"svg-1"}],["path",{d:"M4 12v6a8 3 0 0 0 16 0v-6",key:"svg-2"}]],Nl=de("outline","database","Database",Fp);const Wp=[["path",{d:"M3 5a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v10a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1v-10z",key:"svg-0"}],["path",{d:"M7 20h10",key:"svg-1"}],["path",{d:"M9 16v4",key:"svg-2"}],["path",{d:"M15 16v4",key:"svg-3"}]],$p=de("outline","device-desktop","DeviceDesktop",Wp);const Hp=[["path",{d:"M4 4h16v2.172a2 2 0 0 1 -.586 1.414l-4.414 4.414v7l-6 2v-8.5l-4.48 -4.928a2 2 0 0 1 -.52 -1.345v-2.227z",key:"svg-0"}]],wl=de("outline","filter","Filter",Hp);const qp=[["path",{d:"M18.9 7a8 8 0 0 1 1.1 5v1a6 6 0 0 0 .8 3",key:"svg-0"}],["path",{d:"M8 11a4 4 0 0 1 8 0v1a10 10 0 0 0 2 6",key:"svg-1"}],["path",{d:"M12 11v2a14 14 0 0 0 2.5 8",key:"svg-2"}],["path",{d:"M8 15a18 18 0 0 0 1.8 6",key:"svg-3"}],["path",{d:"M4.9 19a22 22 0 0 1 -.9 -7v-1a8 8 0 0 1 12 -6.95",key:"svg-4"}]],Vp=de("outline","fingerprint","Fingerprint",qp);const Up=[["path",{d:"M9 6.371c0 4.418 -2.239 6.629 -5 6.629",key:"svg-0"}],["path",{d:"M4 6.371h7",key:"svg-1"}],["path",{d:"M5 9c0 2.144 2.252 3.908 6 4",key:"svg-2"}],["path",{d:"M12 20l4 -9l4 9",key:"svg-3"}],["path",{d:"M19.1 18h-6.2",key:"svg-4"}],["path",{d:"M6.694 3l.793 .582",key:"svg-5"}]],Jp=de("outline","language","Language",Up);const Kp=[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]],Sl=de("outline","link","Link",Kp);const Gp=[["path",{d:"M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z",key:"svg-0"}]],Qp=de("outline","moon","Moon",Gp);const Yp=[["path",{d:"M6 9a6 6 0 1 0 12 0a6 6 0 0 0 -12 0",key:"svg-0"}],["path",{d:"M12 3c1.333 .333 2 2.333 2 6s-.667 5.667 -2 6",key:"svg-1"}],["path",{d:"M12 3c-1.333 .333 -2 2.333 -2 6s.667 5.667 2 6",key:"svg-2"}],["path",{d:"M6 9h12",key:"svg-3"}],["path",{d:"M3 20h7",key:"svg-4"}],["path",{d:"M14 20h7",key:"svg-5"}],["path",{d:"M10 20a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-6"}],["path",{d:"M12 15v3",key:"svg-7"}]],Xp=de("outline","network","Network",Yp);const Zp=[["path",{d:"M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25",key:"svg-0"}],["path",{d:"M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}],["path",{d:"M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-3"}]],eh=de("outline","palette","Palette",Zp);const th=[["path",{d:"M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4",key:"svg-0"}],["path",{d:"M13.5 6.5l4 4",key:"svg-1"}],["path",{d:"M16 19h6",key:"svg-2"}]],sh=de("outline","pencil-minus","PencilMinus",th);const nh=[["path",{d:"M4 4m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M7 17l0 .01",key:"svg-1"}],["path",{d:"M14 4m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M7 7l0 .01",key:"svg-3"}],["path",{d:"M4 14m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-4"}],["path",{d:"M17 7l0 .01",key:"svg-5"}],["path",{d:"M14 14l3 0",key:"svg-6"}],["path",{d:"M20 14l0 .01",key:"svg-7"}],["path",{d:"M14 14l0 3",key:"svg-8"}],["path",{d:"M14 20l3 0",key:"svg-9"}],["path",{d:"M17 17l3 0",key:"svg-10"}],["path",{d:"M20 17l0 3",key:"svg-11"}]],ah=de("outline","qrcode","Qrcode",nh);const rh=[["path",{d:"M8 9l4 -4l4 4",key:"svg-0"}],["path",{d:"M16 15l-4 4l-4 -4",key:"svg-1"}]],ih=de("outline","selector","Selector",rh);const oh=[["path",{d:"M10 14l11 -11",key:"svg-0"}],["path",{d:"M21 3l-6.5 18a.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a.55 .55 0 0 1 0 -1l18 -6.5",key:"svg-1"}]],Cl=de("outline","send","Send",oh);const lh=[["path",{d:"M8 9h-1a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-8a2 2 0 0 0 -2 -2h-1",key:"svg-0"}],["path",{d:"M12 14v-11",key:"svg-1"}],["path",{d:"M9 6l3 -3l3 3",key:"svg-2"}]],ch=de("outline","share-2","Share2",lh);const dh=[["path",{d:"M6 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-0"}],["path",{d:"M18 6m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-1"}],["path",{d:"M18 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-2"}],["path",{d:"M8.7 10.7l6.6 -3.4",key:"svg-3"}],["path",{d:"M8.7 13.3l6.6 3.4",key:"svg-4"}]],Fn=de("outline","share","Share",dh);const uh=[["path",{d:"M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7",key:"svg-1"}]],mh=de("outline","sun","Sun",uh);const fh=[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 9h16.8",key:"svg-1"}],["path",{d:"M3.6 15h16.8",key:"svg-2"}],["path",{d:"M11.5 3a17 17 0 0 0 0 18",key:"svg-3"}],["path",{d:"M12.5 3a17 17 0 0 1 0 18",key:"svg-4"}]],kl=de("outline","world","World",fh);function Xt(){return Ne(Ce,e=>e.wallets)}function Le(){return Ne(Ce,e=>Ue.getCurrentWallet(e))}function At(){return Ne(Ce,e=>e.selectedChain)}function Al(){return Ne(Ce,e=>e.chainPreferences)}function _r(){return Ne(Ce,e=>Ue.getCurrentChainAddress(e))}function Il(){return Ne(Ce,e=>Ue.getCurrentChainTokens(e))}function Tl(){return Ne(Ce,e=>Ue.getAvailableChains(e))}function Pl(){return Ne(Ce,e=>Ue.hasWallet(e))}function El(){return Ne(Ce,e=>e.isInitialized)}const ph=Object.freeze(Object.defineProperty({__proto__:null,addressBookActions:xs,addressBookSelectors:na,addressBookStore:hs,chainConfigActions:_t,chainConfigSelectors:Us,chainConfigStore:qa,currencies:Va,languages:$o,preferencesActions:tn,preferencesStore:dm,useAvailableChains:Tl,useChainConfigError:Fo,useChainConfigLoading:Oo,useChainConfigMigrationRequired:zo,useChainConfigState:aa,useChainConfigSubscription:Lo,useChainConfigWarnings:Bo,useChainConfigs:en,useChainPreferences:Al,useCurrency:xr,useCurrentChainAddress:_r,useCurrentChainTokens:Il,useCurrentWallet:Le,useEnabledBioforestChainConfigs:Wo,useEnabledChains:ra,useHasWallet:Pl,useLanguage:sn,useSelectedChain:At,useTheme:hr,useWalletInitialized:El,useWallets:Xt,walletActions:ye,walletSelectors:Ue,walletStore:Ce},Symbol.toStringTag,{value:"Module"}));function Mr(){return Fs}function Zt(){return Dm}function Rr(){return Pm}function _l(){return Em}const Wn={authorizeAddress:"/wallet/authorize/address",authorizeSignature:"/wallet/authorize/signature"};class hh{constructor(s,n){this.adapter=s,this.eventId=n}hasResponded=!1;handleNetworkAddresses(s,n){const a=n.trim().toLowerCase();if(!a)return[];const r=[];for(const i of s)for(const l of i.chainAddresses)String(l.chain).toLowerCase()===a&&r.push({name:i.name,address:l.address,chainName:l.chain,publicKey:"",magic:`${i.id}:${l.chain}`,signMessage:""});return r}handleMainAddresses(s){return s.chainAddresses.map(n=>({name:s.name,address:n.address,chainName:n.chain,publicKey:"",magic:`${s.id}:${n.chain}`,signMessage:""}))}async handleMainAddressesSigned(s,n){const a=this.handleMainAddresses(s);return await this.applySensitiveOptions(a,[s],{password:n.password,signMessage:n.signMessage,getMain:!1})}handleAllAddresses(s){const n=[];for(const a of s)n.push(...this.handleMainAddresses(a));return n}async handleAllAddressesSigned(s,n){const a=this.handleAllAddresses(s);return await this.applySensitiveOptions(a,s,{password:n.password,signMessage:n.signMessage,getMain:!1})}async handleNetworkAddressesSigned(s,n,a){const r=this.handleNetworkAddresses(s,n);return await this.applySensitiveOptions(r,s,{password:a.password,signMessage:a.signMessage,getMain:!1})}async applySensitiveOptions(s,n,a){return await this.applyPasswordProtectedFields(s,n,a)}async approve(s){await this.respondOnce(Wn.authorizeAddress,s)}async reject(s){await this.respondOnce(Wn.authorizeAddress,null)}async respondOnce(s,n){if(!this.hasResponded){this.hasResponded=!0;try{await this.adapter.respondWith(this.eventId,s,n)}finally{await this.adapter.removeEventId(this.eventId)}}}async applyPasswordProtectedFields(s,n,a){const r=a.signMessage?.trim()??"",i=!!r,l=!!a.getMain;if(!i&&!l)return s;const o=new Map;for(const m of n)o.set(m.id,m);const d=new Map,u=new Set;for(const m of s){const p=this.getWalletIdFromMagic(m.magic),x=o.get(p),h=x?.encryptedMnemonic;if(!x||!h)throw new Error("Missing secret");const y=m.chainName.trim().toLowerCase();if(l){let f=d.get(p);if(!f){try{f=await ms(h,a.password)}catch{throw new Error("Invalid password")}d.set(p,f)}m.main=f}if(i){if(Pn(y)){let f=d.get(p);if(!f){try{f=await ms(h,a.password)}catch{throw new Error("Invalid password")}d.set(p,f)}const g=En(f),b=_n(r,g.secretKey);m.signMessage=`0x${$e(b)}`,m.publicKey=$e(g.publicKey);continue}if(!u.has(p))if(d.has(p))u.add(p);else{if(!await Bt(h,a.password))throw new Error("Invalid password");u.add(p)}m.signMessage=this.createDeterministicMockSignature({message:r,address:m.address,chainName:m.chainName})}}return s}getWalletIdFromMagic(s){const n=s.indexOf(":");return n===-1?s:s.slice(0,n)}createDeterministicMockSignature({message:s,address:n,chainName:a}){const r=new TextEncoder,i=ct(r.encode(`address:${n}|chain:${a}|message:${s}`)),l=ct(r.encode(`event:${this.eventId}`)),o=new Uint8Array(64);return o.set(i,0),o.set(l,32),`0x${$e(o)}`}}class Dr{constructor(s,n){this.adapter=s,this.eventId=n}hasResponded=!1;async approve(s){await this.respondOnce(Wn.authorizeSignature,s)}async reject(s){await this.respondOnce(Wn.authorizeSignature,null)}async handleMessageSign(s,n,a){const r=s.chainName.trim().toLowerCase();if(Pn(r)){let l;try{l=await ms(n,a)}catch{throw new Error("Invalid password")}const o=En(l),d=_n(s.message,o.secretKey);return{signature:`0x${$e(d)}`,publicKey:$e(o.publicKey)}}if(!await Bt(n,a))throw new Error("Invalid password");{const l=new TextEncoder,o=ct(l.encode(`message:${s.message}`)),d=ct(l.encode(`event:${this.eventId}`)),u=new Uint8Array(64);u.set(o,0),u.set(d,32);const m=ct(l.encode(`pubkey:${s.senderAddress}`));return{signature:`0x${$e(u)}`,publicKey:$e(m)}}}async handleTransferSign(s,n,a){const r=s.chainName.trim().toLowerCase(),i=["transfer",r,s.senderAddress,s.receiveAddress,s.balance,s.fee??"",s.contractInfo?.assetType??s.assetType??"",s.contractInfo?.contractAddress??"",s.contractInfo?.decimals?.toString()??""].join("|");if(Pn(r)){let p;try{p=await ms(n,a)}catch{throw new Error("Invalid password")}const x=En(p),h=_n(i,x.secretKey);return`0x${$e(h)}`}if(!await Bt(n,a))throw new Error("Invalid password");const o=new TextEncoder,d=ct(o.encode(i)),u=ct(o.encode(`event:${this.eventId}`)),m=new Uint8Array(64);return m.set(d,0),m.set(u,32),`0x${$e(m)}`}async handleDestroySign(s,n,a){const r=s.chainName.trim().toLowerCase(),i=["destory",r,s.senderAddress,s.destoryAddress,s.destoryAmount,s.fee??"",s.assetType??""].join("|");if(Pn(r)){let p;try{p=await ms(n,a)}catch{throw new Error("Invalid password")}const x=En(p),h=_n(i,x.secretKey);return`0x${$e(h)}`}if(!await Bt(n,a))throw new Error("Invalid password");const o=new TextEncoder,d=ct(o.encode(i)),u=ct(o.encode(`event:${this.eventId}`)),m=new Uint8Array(64);return m.set(d,0),m.set(u,32),`0x${$e(m)}`}async respondOnce(s,n){if(!this.hasResponded){this.hasResponded=!0;try{await this.adapter.respondWith(this.eventId,s,n)}finally{await this.adapter.removeEventId(this.eventId)}}}}class xh{async getCallerAppInfo(s){throw new Error("DWEB runtime not available in web environment")}async respondWith(s,n,a){throw new Error("DWEB runtime not available in web environment")}async removeEventId(s){}isAvailable(){return!1}}const ys=new xh;function gh(){return typeof window>"u"}function xn(){return!gh()}function vh(){const e={value:null};function s(){return e.value}function n(a){e.value=a}return[s,n]}var Ia,ki;function bh(){if(ki)return Ia;ki=1;var e=typeof Element<"u",s=typeof Map=="function",n=typeof Set=="function",a=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function r(i,l){if(i===l)return!0;if(i&&l&&typeof i=="object"&&typeof l=="object"){if(i.constructor!==l.constructor)return!1;var o,d,u;if(Array.isArray(i)){if(o=i.length,o!=l.length)return!1;for(d=o;d--!==0;)if(!r(i[d],l[d]))return!1;return!0}var m;if(s&&i instanceof Map&&l instanceof Map){if(i.size!==l.size)return!1;for(m=i.entries();!(d=m.next()).done;)if(!l.has(d.value[0]))return!1;for(m=i.entries();!(d=m.next()).done;)if(!r(d.value[1],l.get(d.value[0])))return!1;return!0}if(n&&i instanceof Set&&l instanceof Set){if(i.size!==l.size)return!1;for(m=i.entries();!(d=m.next()).done;)if(!l.has(d.value[0]))return!1;return!0}if(a&&ArrayBuffer.isView(i)&&ArrayBuffer.isView(l)){if(o=i.length,o!=l.length)return!1;for(d=o;d--!==0;)if(i[d]!==l[d])return!1;return!0}if(i.constructor===RegExp)return i.source===l.source&&i.flags===l.flags;if(i.valueOf!==Object.prototype.valueOf&&typeof i.valueOf=="function"&&typeof l.valueOf=="function")return i.valueOf()===l.valueOf();if(i.toString!==Object.prototype.toString&&typeof i.toString=="function"&&typeof l.toString=="function")return i.toString()===l.toString();if(u=Object.keys(i),o=u.length,o!==Object.keys(l).length)return!1;for(d=o;d--!==0;)if(!Object.prototype.hasOwnProperty.call(l,u[d]))return!1;if(e&&i instanceof Element)return!1;for(d=o;d--!==0;)if(!((u[d]==="_owner"||u[d]==="__v"||u[d]==="__o")&&i.$$typeof)&&!r(i[u[d]],l[u[d]]))return!1;return!0}return i!==i&&l!==l}return Ia=function(l,o){try{return r(l,o)}catch(d){if((d.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw d}},Ia}var yh=bh();const Ws=om(yh);function Ml(e){const s=c.useRef(e),n=s.current,a=Ws(n,e);return c.useEffect(()=>{a||(s.current=e)},[e]),a?n:e}var zr=c.createContext(null),Rl=({children:e,value:s})=>t.jsx(zr.Provider,{value:Ml(s),children:e});Rl.displayName="ActivityProvider";var jh=()=>c.useContext(zr);function Nh(){return c.useContext(zr).params}var Dl=c.createContext(null),zl=({children:e,value:s})=>t.jsx(Dl.Provider,{value:Ml(s),children:e});zl.displayName="StackProvider";var wh=()=>c.useContext(Dl),Sh=Object.defineProperty,Ch=Object.defineProperties,kh=Object.getOwnPropertyDescriptors,$n=Object.getOwnPropertySymbols,Ll=Object.prototype.hasOwnProperty,Bl=Object.prototype.propertyIsEnumerable,Ai=(e,s,n)=>s in e?Sh(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n,xe=(e,s)=>{for(var n in s||(s={}))Ll.call(s,n)&&Ai(e,n,s[n]);if($n)for(var n of $n(s))Bl.call(s,n)&&Ai(e,n,s[n]);return e},Ae=(e,s)=>Ch(e,kh(s)),Ah=(e,s)=>{var n={};for(var a in e)Ll.call(e,a)&&s.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&$n)for(var a of $n(e))s.indexOf(a)<0&&Bl.call(e,a)&&(n[a]=e[a]);return n};function Ih(e,s,n){const a=n(e),r=n(s);return a<r?-1:a===r?0:1}var Th=(e,s)=>{const n=[],a=[];return e.forEach(r=>{s(r)?n.push(r):a.push(r)}),[n,a]};function Ol(e,s){return e.map((n,a)=>s(n)?a:void 0).filter(n=>typeof n=="number")}var Ta=0,Ii=0,Fl=()=>{const e=new Date().getTime();return Ii===e?Ta+=1:(Ii=e,Ta=0),(e*1e3+Ta)/1e3};function dt(){return(Fl()*1e3).toString(16)}function ha(e){return e.length===0?void 0:e[e.length-1]}function Ti(e,s){const n=xe({},e);return s.forEach(a=>{delete n[a]}),n}function Ph(e){let s=!1;return()=>{s||(s=!0,e())}}function Eh(e,s){const n=new Map;return[...e].reverse().filter(a=>{const r=s(a);if(r===null)return!0;const i=!!n.get(r);return n.set(r,!0),!i}).reverse()}function Ga(e){return!e.exitedBy}function Qa(e,s){return s.enteredBy.eventDate-e.enteredBy.eventDate}function Pi(e){return e.filter(Ga).sort(Qa)[0]}function _h(e,s,n){const a=[];switch(s.name){case"Replaced":{if(ha(Ol(e,d=>d.id===s.activityId))!==void 0)break;const i=e.slice().sort(Qa).filter(Ga),l=n.now-s.eventDate>=n.transitionDuration;if((s.skipEnterActiveState||l?"enter-done":"enter-active")==="enter-done"){const d=i.findIndex(u=>!(s.skipEnterActiveState&&u.enteredBy.name==="Replaced"&&u.transitionState==="enter-active"));return i.slice(0,d+1).map(u=>e.indexOf(u))}break}case"Popped":{const r=e.filter(Ga).sort(Qa),i=r.slice(0,r.length-1)[0];i&&a.push(e.indexOf(i));break}case"StepPushed":case"StepReplaced":{const r=Pi(e);if(r){if(s.targetActivityId&&s.targetActivityId!==r.id)break;a.push(e.indexOf(r))}break}case"StepPopped":{const r=Pi(e);if(r&&r.steps.length>1){if(s.targetActivityId&&s.targetActivityId!==r.id)break;a.push(e.indexOf(r))}break}}return a}function Ei(e,s){switch(s.name){case"Pushed":case"Replaced":{const n=ha(Ol(e,a=>a.id===s.activityId));return n??e.length}default:return-1}}function _i(e,s){return{id:e.activityId,name:e.activityName,transitionState:s,params:e.activityParams,context:e.activityContext,steps:[{id:e.activityId,params:e.activityParams,enteredBy:e,zIndex:-1}],enteredBy:e,isTop:!1,isActive:!1,isRoot:!1,zIndex:-1}}function Lr(e){return(s,n)=>{const a=e[n.name].bind(e);if(a)return a(s,n);throw new Error(`No reducer for event ${JSON.stringify(n)}`)}}function yt(e){return e}function Mh({transitionDuration:e,now:s,resumedAt:n}){return Lr({Pushed(a,r){const i=s-(n??r.eventDate)>=e,l=r.skipEnterActiveState||i?"enter-done":"enter-active",o=Ei(a,r);return[...a.slice(0,o),_i(r,l),...a.slice(o+1)]},Replaced(a,r){var i,l;const o=s-(n??r.eventDate)>=e,d=Ei(a,r),u=(l=(i=a[d])==null?void 0:i.transitionState)!=null?l:r.skipEnterActiveState||o?"enter-done":"enter-active";return[...a.slice(0,d),_i(r,u),...a.slice(d+1)]},Initialized:yt,ActivityRegistered:yt,Popped:yt,StepPushed:yt,StepReplaced:yt,StepPopped:yt,Paused:yt,Resumed:yt})}function Rs(e){return e}function Rh(e){return Lr({Replaced:(s,n)=>Ae(xe({},s),{exitedBy:n,transitionState:"exit-done"}),Popped:(s,n)=>{var a;const r=e.now-((a=e.resumedAt)!=null?a:n.eventDate)>=e.transitionDuration,i=n.skipExitActiveState||r?"exit-done":"exit-active";return Ae(xe({},s),{exitedBy:n,transitionState:i,params:i==="exit-done"?s.steps[0].params:s.params,steps:i==="exit-done"?[s.steps[0]]:s.steps})},StepPushed:(s,n)=>{var a;const r={id:n.stepId,params:n.stepParams,enteredBy:n,zIndex:s.zIndex,hasZIndex:(a=n.hasZIndex)!=null?a:!1};return Ae(xe({},s),{params:n.stepParams,steps:[...s.steps,r]})},StepReplaced:(s,n)=>{var a;const r={id:n.stepId,params:n.stepParams,enteredBy:n,zIndex:s.zIndex,hasZIndex:(a=n.hasZIndex)!=null?a:!1};return Ae(xe({},s),{params:n.stepParams,steps:[...s.steps.slice(0,s.steps.length-1),r]})},StepPopped:(s,n)=>{var a;s.steps.pop();const r=(a=ha(s.steps))==null?void 0:a.params;return Ae(xe({},s),{params:r??s.params})},Initialized:Rs,ActivityRegistered:Rs,Pushed:Rs,Paused:Rs,Resumed:Rs})}function ot(e){return(s,n)=>s.globalTransitionState==="paused"?Ae(xe({},s),{pausedEvents:s.pausedEvents?[...s.pausedEvents,n]:[n]}):e(s,n)}function Ke(e,s){return(n,a)=>{const r=Mh({transitionDuration:n.transitionDuration,now:s.now,resumedAt:s.resumedAt}),i=Rh({transitionDuration:n.transitionDuration,now:s.now,resumedAt:s.resumedAt}),l=r(n.activities,a),o=_h(n.activities,a,{transitionDuration:n.transitionDuration,now:s.now});for(const m of o)l[m]=i(l[m],a);const d=l.find(m=>m.transitionState==="enter-active"||m.transitionState==="exit-active"),u=n.globalTransitionState==="paused"?"paused":d?"loading":"idle";return e(Ae(xe({},n),{activities:l,globalTransitionState:u}),a)}}function rs(e,s){return Ae(xe({},e),{events:[...e.events,s]})}function Wl(e){return Lr({Initialized:ot(Ke((s,n)=>Ae(xe({},s),{transitionDuration:n.transitionDuration,events:[...s.events,n]}),e)),ActivityRegistered:ot(Ke((s,n)=>Ae(xe({},s),{registeredActivities:[...s.registeredActivities,xe({name:n.activityName},n.activityParamsSchema?{paramsSchema:n.activityParamsSchema}:null)],events:[...s.events,n]}),e)),Paused:ot(Ke((s,n)=>Ae(xe({},s),{globalTransitionState:"paused",events:[...s.events,n]}),e)),Resumed:Ke((s,n)=>{if(s.globalTransitionState!=="paused"||!s.pausedEvents)return Ae(xe({},s),{events:[...s.events,n]});const a=Wl({now:e.now,resumedAt:n.eventDate}),r=s,{pausedEvents:i}=r,l=Ah(r,["pausedEvents"]),o=i.reduce(a,Ae(xe({},l),{globalTransitionState:"idle"}));return Ae(xe({},o),{events:[...o.events,n]})},e),Pushed:ot(Ke(rs,e)),Replaced:ot(Ke(rs,e)),Popped:ot(Ke(rs,e)),StepPushed:ot(Ke(rs,e)),StepReplaced:ot(Ke(rs,e)),StepPopped:ot(Ke(rs,e))})}function Pa(e,s){return e.filter(n=>n.name===s)}function Mn(e,s){return Ae(xe({id:dt(),eventDate:Fl()},s),{name:e})}function Dh(e){if(e.length===0)throw new Error("events parameter is empty");if(Pa(e,"Initialized").length>1)throw new Error("InitializedEvent can only exist once");const n=Pa(e,"ActivityRegistered"),a=new Set(n.map(i=>i.activityName));if(Pa(e,"Pushed").some(i=>!a.has(i.activityName)))throw new Error("the corresponding activity does not exist")}function Ea(e,s){const n=Eh([...e].sort((m,p)=>m.eventDate-p.eventDate),m=>m.id);Dh(n);const a=Wl({now:s}),r=n.reduce(a,{activities:[],globalTransitionState:"idle",registeredActivities:[],transitionDuration:0,events:[]}),i=r.activities.filter(m=>m.transitionState==="enter-active"||m.transitionState==="enter-done"||m.transitionState==="exit-active"),l=i.filter(m=>m.transitionState==="enter-active"||m.transitionState==="enter-done"),o=i[i.length-1],d=l[l.length-1];return Ae(xe({},r),{activities:r.activities.map(m=>{let p=i.findIndex(({id:y})=>y===m.id);const x=i.slice(0,p);for(const y of x)for(const f of y.steps)f.hasZIndex&&(p+=1);const h=m.steps.reduce((y,f)=>{var g;const b=ha(y),v=(g=b?.zIndex)!=null?g:p;return[...y,Ae(xe({},f),{zIndex:v+(f.hasZIndex?1:0)})]},[]);return xe(xe({id:m.id,name:m.name,transitionState:m.transitionState,params:m.params,steps:h,enteredBy:m.enteredBy,zIndex:p,isTop:o?.id===m.id,isActive:d?.id===m.id,isRoot:p===0||p===1&&m.transitionState==="enter-active"&&m.enteredBy.name==="Replaced"},m.exitedBy?{exitedBy:m.exitedBy}:null),m.context?{context:m.context}:null)}).sort((m,p)=>Ih(m,p,x=>x.id))})}function zh(e,s){var n,a,r,i,l,o,d,u;const m=[];!Ws(e,s)&&m.push({_TAG:"%SOMETHING_CHANGED%"});const x=e.globalTransitionState!=="paused"&&s.globalTransitionState==="paused",h=e.globalTransitionState==="paused"&&s.globalTransitionState!=="paused";x&&m.push({_TAG:"PAUSED"}),h&&m.push({_TAG:"RESUMED"});for(let y=0;y<Math.max(e.activities.length,s.activities.length);y+=1){const f=e.activities[y],g=s.activities[y],b=f?.transitionState==="exit-done"||f?.transitionState==="exit-active",v=g?.transitionState==="enter-active"||g?.transitionState==="enter-done";if(f&&g&&f.id===g.id)for(let j=0;j<Math.max(((n=f.steps)!=null?n:[]).length,((a=g.steps)!=null?a:[]).length);j+=1){const w=f.steps[j],N=g.steps[j];!w&&N?m.push({_TAG:"STEP_PUSHED",activity:g,step:N}):w&&!N?m.push({_TAG:"STEP_POPPED",activity:g}):f.steps.length===g.steps.length&&w.id!==N.id&&m.push({_TAG:"STEP_REPLACED",activity:g,step:N})}!f&&g?m.push({_TAG:g.enteredBy.name==="Pushed"?"PUSHED":"REPLACED",activity:g}):b&&v?m.push({_TAG:g.enteredBy.name==="Pushed"?"PUSHED":"REPLACED",activity:g}):f&&g&&f.id===g.id&&!Ws(Ti(f,["isActive","isTop","isRoot","transitionState","zIndex"]),Ti(g,["isActive","isTop","isRoot","transitionState","zIndex"]))&&g.enteredBy.name==="Replaced"&&!Ws(f.enteredBy,g.enteredBy)&&m.push({_TAG:"REPLACED",activity:g})}for(let y=Math.max(e.activities.length,s.activities.length)-1;y>=0;y-=1){const f=((r=e.activities[y])==null?void 0:r.transitionState)==="enter-done"||((i=e.activities[y])==null?void 0:i.transitionState)==="enter-active",g=((l=s.activities[y])==null?void 0:l.transitionState)==="exit-active"||((o=s.activities[y])==null?void 0:o.transitionState)==="exit-done",b=((d=s.activities[y+1])==null?void 0:d.enteredBy.name)==="Replaced"&&((u=s.activities[y+1])==null?void 0:u.transitionState)==="enter-done";f&&g&&!b&&m.push({_TAG:"POPPED",activity:s.activities[y]})}return m}var Lh={Pushed:"onBeforePush",Replaced:"onBeforeReplace",Popped:"onBeforePop",StepPushed:"onBeforeStepPush",StepReplaced:"onBeforeStepReplace",StepPopped:"onBeforeStepPop",Paused:"onBeforePause",Resumed:"onBeforeResume"};function jt(e,s,n,a){let r=!1,i=xe({},s);for(const l of n){const o=l[Lh[e]];o&&o({actionParams:xe({},i),actions:Ae(xe({},a),{preventDefault:()=>{r=!0},overrideActionParams:d=>{i=xe(xe({},i),d)}})})}return{isPrevented:r,nextActionParams:i}}function Bh({dispatchEvent:e,pluginInstances:s,actions:n}){return{push(a){const{isPrevented:r,nextActionParams:i}=jt("Pushed",a,s,n);r||e("Pushed",i)},replace(a){const{isPrevented:r,nextActionParams:i}=jt("Replaced",a,s,n);r||e("Replaced",i)},pop(a={}){const{isPrevented:r,nextActionParams:i}=jt("Popped",a,s,n);r||e("Popped",i)},stepPush(a){const{isPrevented:r,nextActionParams:i}=jt("StepPushed",a,s,n);r||e("StepPushed",i)},stepReplace(a){const{isPrevented:r,nextActionParams:i}=jt("StepReplaced",a,s,n);r||e("StepReplaced",i)},stepPop(a={}){const{isPrevented:r,nextActionParams:i}=jt("StepPopped",a,s,n);r||e("StepPopped",i)},pause(a={}){const{isPrevented:r,nextActionParams:i}=jt("Paused",a,s,n);r||e("Paused",i)},resume(a={}){const{isPrevented:r,nextActionParams:i}=jt("Resumed",a,s,n);r||e("Resumed",i)}}}function Oh(e,s,n){e.forEach(a=>{s.forEach(r=>{var i,l,o,d,u,m,p,x,h;switch(a._TAG){case"PUSHED":(i=r.onPushed)==null||i.call(r,{actions:n,effect:a});break;case"REPLACED":(l=r.onReplaced)==null||l.call(r,{actions:n,effect:a});break;case"POPPED":(o=r.onPopped)==null||o.call(r,{actions:n,effect:a});break;case"STEP_PUSHED":(d=r.onStepPushed)==null||d.call(r,{actions:n,effect:a});break;case"STEP_REPLACED":(u=r.onStepReplaced)==null||u.call(r,{actions:n,effect:a});break;case"STEP_POPPED":(m=r.onStepPopped)==null||m.call(r,{actions:n,effect:a});break;case"PAUSED":(p=r.onPaused)==null||p.call(r,{actions:n,effect:a});break;case"RESUMED":(x=r.onResumed)==null||x.call(r,{actions:n,effect:a});break;case"%SOMETHING_CHANGED%":(h=r.onChanged)==null||h.call(r,{actions:n,effect:a});break}})})}var Fh=1e3,Wh=Fh/60;function Mi(e){var s,n,a,r;const i=[],o=[{key:"@stackflow/core",onChanged(){i.forEach(g=>g())}},...e.plugins.map(g=>g())],[d,u]=Th(e.initialEvents,g=>g.name==="Pushed"||g.name==="StepPushed"),m=o.reduce((g,b)=>{var v,j,w;return(w=(j=b.overrideInitialEvents)==null?void 0:j.call(b,{initialEvents:g,initialContext:(v=e.initialContext)!=null?v:{}}))!=null?w:g},d);m.length>0&&d.length>0&&m!==d&&((n=(s=e.handlers)==null?void 0:s.onInitialActivityIgnored)==null||n.call(s,m)),m.length===0&&((r=(a=e.handlers)==null?void 0:a.onInitialActivityNotFound)==null||r.call(a));const x={value:[...u,...m]},h={value:Ea(x.value,new Date().getTime())},y={getStack(){return h.value},dispatchEvent(g,b){const v=Mn(g,b),j=Ea([...x.value,v],new Date().getTime());x.value.push(v),f(j);const w=setInterval(()=>{const N=Ea(x.value,new Date().getTime());Ws(h.value,N)||f(N),N.globalTransitionState==="idle"&&clearInterval(w)},Wh)},push:()=>{},replace:()=>{},pop:()=>{},stepPush:()=>{},stepReplace:()=>{},stepPop:()=>{},pause:()=>{},resume:()=>{}},f=g=>{const b=zh(h.value,g);h.value=g,Oh(b,o,y)};return Object.assign(y,Bh({dispatchEvent:y.dispatchEvent,pluginInstances:o,actions:y})),{actions:y,init:Ph(()=>{o.forEach(g=>{var b;(b=g.onInit)==null||b.call(g,{actions:y})})}),pullEvents:()=>x.value,subscribe(g){return i.push(g),function(){const v=i.findIndex(j=>j===g);v>-1&&i.splice(v,1)}},pluginInstances:o}}var $l=c.createContext(null);function $h(){const e=c.useContext($l);if(e===null)throw new Error("useActivityComponentMap must be used within ActivityComponentMapProvider");return e}function Hh({children:e,value:s}){return t.jsx($l.Provider,{value:s,children:e})}var Hn=e=>s=>s.find(({id:n})=>n===e);function qh(e){return!e.exitedBy}function Vh(e,s){return s.enteredBy.eventDate-e.enteredBy.eventDate}function qn(e){return e.filter(qh).sort(Vh)[0]}function zt(){return dt()}function Vn(){return dt()}var Ri,Uh=(Ri=pr.useDeferredValue)!=null?Ri:e=>e,Di,Jh=(Di=pr.useSyncExternalStore)!=null?Di:(e,s)=>{const[n,a]=c.useState(()=>s());return c.useEffect(()=>e(()=>{a(()=>s())})),n},zi,Hl=(zi=pr.useTransition)!=null?zi:()=>[!1,e=>e()],ql=c.createContext(null),Vl=c.createContext(null),Ul=({coreStore:e,children:s})=>{const n=Jh(e.subscribe,e.actions.getStack,e.actions.getStack),a=Uh(n);return t.jsx(Vl.Provider,{value:a,children:t.jsx(ql.Provider,{value:e.actions,children:s})})};Ul.displayName="CoreProvider";var Jl=()=>c.useContext(ql),Kl=()=>c.useContext(Vl),Gl=c.createContext(null),Ql=({children:e,value:s})=>t.jsx(Gl.Provider,{value:s,children:e});Ql.displayName="PluginsProvider";function Yl(){return c.useContext(Gl)}function Kh(e){return typeof e=="object"&&e!==null&&"then"in e&&typeof e.then=="function"}var Te={PENDING:"pending",FULFILLED:"fulfilled",REJECTED:"rejected"};function Br(e){if(e.status===Te.PENDING)return{status:Te.PENDING};if(e.status===Te.FULFILLED&&"value"in e)return{status:Te.FULFILLED,value:e.value};if(e.status===Te.REJECTED&&"reason"in e)return{status:Te.REJECTED,reason:e.reason};throw new Error("Invalid promise state")}function Gh(e){if("status"in e&&Object.values(Te).some(n=>n===e.status))return e;const s=Object.assign(e,{status:Te.PENDING});return s.then(n=>{s.status=Te.FULFILLED,s.value=n},n=>{s.status=Te.REJECTED,s.reason=n}),s}function Rn(e){return Kh(e)?Gh(e instanceof Promise?e:Promise.resolve(e)):Object.assign(Promise.resolve(e),{status:Te.FULFILLED,value:e})}function Qh(e){return Object.assign(Promise.reject(e),{status:Te.REJECTED,reason:e})}function Yh(e){const s=Rn(e),n=Br(s);if(n.status===Te.FULFILLED)return n.value;throw n.status===Te.REJECTED?n.reason:s}var Xh=Object.defineProperty,Li=Object.getOwnPropertySymbols,Zh=Object.prototype.hasOwnProperty,ex=Object.prototype.propertyIsEnumerable,Bi=(e,s,n)=>s in e?Xh(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n,tx=(e,s)=>{for(var n in s||(s={}))Zh.call(s,n)&&Bi(e,n,s[n]);if(Li)for(var n of Li(s))ex.call(s,n)&&Bi(e,n,s[n]);return e},sx=(e,s,n)=>new Promise((a,r)=>{var i=d=>{try{o(n.next(d))}catch(u){r(u)}},l=d=>{try{o(n.throw(d))}catch(u){r(u)}},o=d=>d.done?a(d.value):Promise.resolve(d.value).then(i,l);o((n=n.apply(e,s)).next())});function nx(e){let s=null;const n=()=>((!s||Br(s).status===Te.REJECTED)&&(s=e()),s);return{Component:r=>{const{default:i}=Yh(n());return t.jsx(i,tx({},r))},preload:()=>sx(this,null,function*(){yield n()})}}var ax=Symbol("STRUCTURED_ACTIVITY_COMPONENT_TYPE");function rx(e){return e!==null&&typeof e=="object"&&ax in e}var _a=new WeakMap;function ix(e){if(_a.has(e))return _a.get(e);const{Component:s}=nx(()=>{const n=e.content,a=Rn(typeof n=="function"?n():{default:n}),r=Br(a);return r.status===Te.FULFILLED?Rn({default:r.value.default.component}):r.status===Te.REJECTED?Qh(r.reason):Rn(a.then(i=>({default:i.default.component})))});return _a.set(e,s),s}var ox=Object.defineProperty,lx=Object.defineProperties,cx=Object.getOwnPropertyDescriptors,Oi=Object.getOwnPropertySymbols,dx=Object.prototype.hasOwnProperty,ux=Object.prototype.propertyIsEnumerable,Ya=(e,s,n)=>s in e?ox(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n,Pt=(e,s)=>{for(var n in s||(s={}))dx.call(s,n)&&Ya(e,n,s[n]);if(Oi)for(var n of Oi(s))ux.call(s,n)&&Ya(e,n,s[n]);return e},Ma=(e,s)=>lx(e,cx(s)),Fi=(e,s,n)=>Ya(e,typeof s!="symbol"?s+"":s,n),Xl=({plugin:e,initialContext:s})=>{const n=$h(),a=Kl(),r=Yl();return e.render({stack:Ma(Pt({},a),{render(i){return{activities:Pt(Pt({},a),i).activities.map(o=>Ma(Pt({},o),{key:o.id,render(d){const u=n[o.name];let m=rx(u)?fx(u,o.params):t.jsx(u,{params:o.params});return r.forEach(p=>{var x,h;m=(h=(x=p.wrapActivity)==null?void 0:x.call(p,{activity:Ma(Pt({},o),{render:()=>m}),initialContext:s}))!=null?h:m}),t.jsx(Rl,{value:Pt(Pt({},o),d),children:m},o.id)}}))}}}),initialContext:s})};Xl.displayName="PluginRenderer";var mx=Xl;function fx(e,s){const{layout:n,loading:a,errorHandler:r}=e,i=ix(e);return[o=>a?.component?t.jsx(c.Suspense,{fallback:t.jsx(a.component,{params:s}),children:o}):o,o=>{var d;if(!r)return o;const u=(d=r.boundary)!=null?d:px;return t.jsx(u,{renderFallback:(m,p)=>t.jsx(r.component,{params:s,error:m,reset:p}),children:o})},o=>n?.component?t.jsx(n.component,{params:s,children:o}):o].reduce((o,d)=>d(o),t.jsx(i,{params:s}))}var px=class extends c.Component{constructor(){super(...arguments),Fi(this,"state",{hasError:!1,error:null}),Fi(this,"reset",()=>this.setState({hasError:!1,error:null}))}render(){return this.state.hasError?this.props.renderFallback(this.state.error,this.reset):this.props.children}static getDerivedStateFromError(e){return{hasError:!0,error:e}}},hx=Object.defineProperty,xx=Object.defineProperties,gx=Object.getOwnPropertyDescriptors,Wi=Object.getOwnPropertySymbols,vx=Object.prototype.hasOwnProperty,bx=Object.prototype.propertyIsEnumerable,$i=(e,s,n)=>s in e?hx(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n,yx=(e,s)=>{for(var n in s||(s={}))vx.call(s,n)&&$i(e,n,s[n]);if(Wi)for(var n of Wi(s))bx.call(s,n)&&$i(e,n,s[n]);return e},jx=(e,s)=>xx(e,gx(s)),Zl=({initialContext:e})=>{const s=Kl(),n=Yl(),a=n.filter(i=>!!i.render);c.useEffect(()=>{a.length===0&&console.warn(`Stackflow - There is no rendering plugin, so "<Stack />" doesn't render anything. If you want to render some UI, use "@stackflow/plugin-renderer-basic" or add another rendering plugin.`)},[a]);let r=t.jsx(t.Fragment,{children:a.map(i=>t.jsx(mx,{plugin:i,initialContext:e},i.key))});return n.forEach(i=>{var l,o;r=(o=(l=i.wrapStack)==null?void 0:l.call(i,{stack:jx(yx({},s),{render(){return r}}),initialContext:e}))!=null?o:r}),t.jsx(zl,{value:s,children:r})};Zl.displayName="MainRenderer";var Nx=Zl,wx=Object.defineProperty,Hi=Object.getOwnPropertySymbols,Sx=Object.prototype.hasOwnProperty,Cx=Object.prototype.propertyIsEnumerable,qi=(e,s,n)=>s in e?wx(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n,Vi=(e,s)=>{for(var n in s||(s={}))Sx.call(s,n)&&qi(e,n,s[n]);if(Hi)for(var n of Hi(s))Cx.call(s,n)&&qi(e,n,s[n]);return e};function Ra(e){return e?e.animate==null?{skipActiveState:!1}:{skipActiveState:!e.animate}:{skipActiveState:!1}}function ln(){const e=Jl(),[s]=Hl();return c.useMemo(()=>({pending:s,push(n,a,r){const i=zt();return e?.push({activityId:i,activityName:n,activityParams:a,skipEnterActiveState:Ra(r).skipActiveState}),{activityId:i}},replace(n,a,r){var i;const l=zt();return e?.replace({activityId:(i=r?.activityId)!=null?i:zt(),activityName:n,activityParams:a,skipEnterActiveState:Ra(r).skipActiveState}),{activityId:l}},pop(n,a){let r=1,i={};typeof n=="object"&&(i=Vi({},n)),typeof n=="number"&&(r=n),a&&(i=Vi({},a));for(let l=0;l<r;l+=1)e?.pop({skipExitActiveState:l===0?Ra(i).skipActiveState:!0})}}),[e?.push,e?.replace,e?.pop,s])}var kx=()=>{const e=Jl(),[s]=Hl();return c.useMemo(()=>({pending:s,stepPush(n,a){const r=e?.getStack().activities,i=a?.targetActivityId?Hn(a.targetActivityId):qn,l=r&&i(r);if(!l)throw new Error("The target activity is not found.");const o=typeof n=="function"?n(l.params):n,d=Vn();e?.stepPush({stepId:d,stepParams:o,targetActivityId:a?.targetActivityId})},stepReplace(n,a){const r=e?.getStack().activities,i=a?.targetActivityId?Hn(a.targetActivityId):qn,l=r&&i(r);if(!l)throw new Error("The target activity is not found.");const o=typeof n=="function"?n(l.params):n,d=Vn();e?.stepReplace({stepId:d,stepParams:o,targetActivityId:a?.targetActivityId})},stepPop(n){e?.stepPop({targetActivityId:n?.targetActivityId})}}),[e?.stepPush,e?.stepReplace,e?.stepPop,e?.getStack,s])},Ax=Object.defineProperty,Ix=Object.defineProperties,Tx=Object.getOwnPropertyDescriptors,Ui=Object.getOwnPropertySymbols,Px=Object.prototype.hasOwnProperty,Ex=Object.prototype.propertyIsEnumerable,Ji=(e,s,n)=>s in e?Ax(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n,gn=(e,s)=>{for(var n in s||(s={}))Px.call(s,n)&&Ji(e,n,s[n]);if(Ui)for(var n of Ui(s))Ex.call(s,n)&&Ji(e,n,s[n]);return e},_x=(e,s)=>Ix(e,Tx(s));function Da(e){return e?e.animate==null?{skipActiveState:!1}:{skipActiveState:!e.animate}:{skipActiveState:!1}}function Mx(e){var s;const n=((s=e.plugins)!=null?s:[]).flat(Number.POSITIVE_INFINITY).map(u=>u),a=Object.entries(e.activities).reduce((u,[m,p])=>_x(gn({},u),{[m]:"component"in p?p.component:p}),{}),r=()=>new Date().getTime()-e.transitionDuration*2,i=Mi({initialEvents:[Mn("Initialized",{transitionDuration:e.transitionDuration,eventDate:r()}),...Object.entries(e.activities).map(([u,m])=>Mn("ActivityRegistered",gn({activityName:u,eventDate:r()},"component"in m?{activityParamsSchema:m.paramsSchema}:null)))],plugins:[]}),[l,o]=vh(),d=c.memo(u=>{const m=c.useMemo(()=>{const p=l();if(xn()&&p)return p;const x=e.initialActivity?[Mn("Pushed",{activityId:zt(),activityName:e.initialActivity(),activityParams:{},eventDate:r(),skipEnterActiveState:!1})]:[],h=Mi({initialEvents:[...i.pullEvents(),...x],initialContext:u.initialContext,plugins:n,handlers:{onInitialActivityIgnored:y=>{xn()&&console.warn(`Stackflow - Some plugin overrides an "initialActivity" option. The "initialActivity" option you set to "${y[0].activityName}" in the "stackflow" is ignored.`)},onInitialActivityNotFound:()=>{xn()&&console.warn("Stackflow - There is no initial activity. If you want to set the initial activity, add the `initialActivity` option of the `stackflow()` function or add a plugin that sets the initial activity. (e.g. `@stackflow/plugin-history-sync`)")}}});return xn()&&(h.init(),o(h)),h},[]);return t.jsx(Ql,{value:m.pluginInstances,children:t.jsx(Ul,{coreStore:m,children:t.jsx(Hh,{value:a,children:t.jsx(Nx,{initialContext:u.initialContext})})})})});return d.displayName="Stack",{activities:e.activities,Stack:d,useFlow:ln,useStepFlow:kx,addActivity(u){if(l()){console.warn("Stackflow - `addActivity()` API cannot be called after a `<Stack />` component has been rendered");return}a[u.name]=c.memo(u.component),i.actions.dispatchEvent("ActivityRegistered",{activityName:u.name,activityParamsSchema:u.paramsSchema,eventDate:r()})},addPlugin(u){if(l()){console.warn("Stackflow - `addPlugin()` API cannot be called after a `<Stack />` component has been rendered");return}[u].flat(Number.POSITIVE_INFINITY).map(m=>m).forEach(m=>{n.push(m)})},actions:{getStack(){var u,m;return(m=(u=l())==null?void 0:u.actions.getStack())!=null?m:i.actions.getStack()},dispatchEvent(u,m){var p;return(p=l())==null?void 0:p.actions.dispatchEvent(u,m)},push(u,m,p){var x;const h=zt();return(x=l())==null||x.actions.push({activityId:h,activityName:u,activityParams:m,skipEnterActiveState:Da(p).skipActiveState}),{activityId:h}},replace(u,m,p){var x,h,y;const f=(x=p?.activityId)!=null?x:zt();return(y=l())==null||y.actions.replace({activityId:(h=p?.activityId)!=null?h:zt(),activityName:u,activityParams:m,skipEnterActiveState:Da(p).skipActiveState}),{activityId:f}},pop(u,m){var p;let x=1,h={};typeof u=="object"&&(h=gn({},u)),typeof u=="number"&&(x=u),m&&(h=gn({},m));for(let y=0;y<x;y+=1)(p=l())==null||p.actions.pop({skipExitActiveState:y===0?Da(h).skipActiveState:!0})},stepPush(u,m){var p,x;const h=(p=l())==null?void 0:p.actions.getStack().activities,y=m?.targetActivityId?Hn(m.targetActivityId):qn,f=h&&y(h);if(!f)throw new Error("The target activity is not found.");const g=typeof u=="function"?u(f.params):u,b=Vn();return(x=l())==null?void 0:x.actions.stepPush({stepId:b,stepParams:g,targetActivityId:m?.targetActivityId})},stepReplace(u,m){var p,x;const h=(p=l())==null?void 0:p.actions.getStack().activities,y=m?.targetActivityId?Hn(m.targetActivityId):qn,f=h&&y(h);if(!f)throw new Error("The target activity is not found.");const g=typeof u=="function"?u(f.params):u,b=Vn();return(x=l())==null?void 0:x.actions.stepReplace({stepId:b,stepParams:g,targetActivityId:m?.targetActivityId})},stepPop(u){var m;return(m=l())==null?void 0:m.actions.stepPop({targetActivityId:u?.targetActivityId})}}}}function Rx(){return()=>({key:"plugin-renderer-basic",render({stack:e}){return t.jsx(t.Fragment,{children:e.render().activities.filter(s=>s.transitionState!=="exit-done").map(s=>t.jsx(c.Fragment,{children:s.render()},s.key))})}})}function Dx(e){var s=e.match(/^var\((.*)\)$/);return s?s[1]:e}function cn(e,s){var n={};{var a=e;for(var r in a){var i=a[r];i!=null&&(n[Dx(r)]=i)}}return Object.defineProperty(n,"toString",{value:function(){return Object.keys(this).map(o=>"".concat(o,":").concat(this[o])).join(";")},writable:!1}),n}function zx(e,s){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(e)}function Lx(e){var s=zx(e,"string");return typeof s=="symbol"?s:String(s)}function Bx(e,s,n){return s=Lx(s),s in e?Object.defineProperty(e,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[s]=n,e}function Ki(e,s){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);s&&(a=a.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,a)}return n}function Gi(e){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?Ki(Object(n),!0).forEach(function(a){Bx(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ki(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function Qi(e,s){var n={};for(var a in e)n[a]=s(e[a],a);return n}var Ox=(e,s,n)=>{for(var a of Object.keys(e)){var r;if(e[a]!==((r=s[a])!==null&&r!==void 0?r:n[a]))return!1}return!0},It=e=>{var s=n=>{var a=e.defaultClassName,r=Gi(Gi({},e.defaultVariants),n);for(var i in r){var l,o=(l=r[i])!==null&&l!==void 0?l:e.defaultVariants[i];if(o!=null){var d=o;typeof d=="boolean"&&(d=d===!0?"true":"false");var u=e.variantClassNames[i][d];u&&(a+=" "+u)}}for(var[m,p]of e.compoundVariants)Ox(m,r,e.defaultVariants)&&(a+=" "+p);return a};return s.variants=()=>Object.keys(e.variantClassNames),s.classNames={get base(){return e.defaultClassName.split(" ")[0]},get variants(){return Qi(e.variantClassNames,n=>Qi(n,a=>a.split(" ")[0]))}},s},Fx=Object.defineProperty,Yi=Object.getOwnPropertySymbols,Wx=Object.prototype.hasOwnProperty,$x=Object.prototype.propertyIsEnumerable,Xi=(e,s,n)=>s in e?Fx(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n,Hx=(e,s)=>{for(var n in s||(s={}))Wx.call(s,n)&&Xi(e,n,s[n]);if(Yi)for(var n of Yi(s))$x.call(s,n)&&Xi(e,n,s[n]);return e};function Or(){const[e,s]=c.useReducer(()=>!0,!1);return c.useEffect(()=>{s()},[]),e}function es(){return jh()}function ec(){const e=es(),s=Or();return Hx({},s?{"data-stackflow-activity-id":e?.id,"data-stackflow-activity-is-active":e?.isActive,"data-stackflow-activity-transition-state":e?.transitionState}:null)}function tc(e,s,n){const a=()=>{s.forEach(r=>{e.removeEventListener(r,a)}),n()};s.forEach(r=>{e.addEventListener(r,a)})}var qx=e=>(e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}),Ze=()=>{};function Xa(e){requestAnimationFrame(()=>{requestAnimationFrame(()=>{e()})})}function Vx({outerRef:e,innerRef:s,enable:n}){const[a,r]=c.useState(void 0);return c.useEffect(()=>{const i=e&&"current"in e&&e.current,l=s.current;return!n||!i||!l?Ze:qx(()=>{const d=i.clientWidth,u=l.offsetLeft,m=l.clientWidth,p=d-u-m,x=Math.max(u,p);r(d-2*x)})}),{maxWidth:a}}function Fr(e){const[s,n]=c.useState(void 0);return c.useEffect(()=>{Xa(()=>{n(e)})},[e]),s}function Ux(){return wh()}function Wr({ref:e}){const s=Ux();c.useEffect(()=>{if(!s)return;const n=e.current;if(!n||s.globalTransitionState==="idle")return;const a=r=>{r.preventDefault(),r.stopPropagation()};return n.addEventListener("touchstart",a,{capture:!0}),n.addEventListener("touchmove",a,{capture:!0}),n.addEventListener("touchend",a,{capture:!0}),n.addEventListener("touchcancel",a,{capture:!0}),()=>{n.removeEventListener("touchstart",a,{capture:!0}),n.removeEventListener("touchmove",a,{capture:!0}),n.removeEventListener("touchend",a,{capture:!0}),n.removeEventListener("touchcancel",a,{capture:!0})}},[s?.globalTransitionState])}var Ds={};function xt({styleName:e,refs:s,effect:n,effectDeps:a}){const r=es();c.useEffect(()=>r?(Ds[e]||(Ds[e]=new Map),Ds[e].set(r.zIndex,{refs:s,hasEffect:!!n}),()=>{Ds[e].delete(r.zIndex)}):Ze,[r?.id,s,n]),c.useEffect(()=>{if(!r||!n)return Ze;const i=(()=>{let o=[];for(let d=1;d<=r.zIndex;d+=1){const u=Ds[e].get(r.zIndex-d);if(u?.refs&&(o=[...o,...u.refs]),u?.hasEffect)break}return o})(),l=n({activityTransitionState:r.transitionState,refs:i});return()=>{l?.()}},[r?.transitionState,...a??[]])}function Jx({refs:e}){xt({styleName:"hide",refs:e,effect:({activityTransitionState:s,refs:n})=>{const a=()=>{n.forEach(r=>{if(!r.current)return;const i=r.current;i.style.display=""})};return s==="enter-done"?(n.forEach(r=>{if(!r.current)return;const i=r.current;i.style.display="none"}),()=>{a()}):(a(),Ze)}})}function Kx({refs:e,transitionDuration:s,offsetStyles:n,hasEffect:a=!1}){xt({styleName:"offset",refs:e,effect:a?({activityTransitionState:r,refs:i})=>{const l=()=>{Xa(()=>{i.forEach(o=>{if(!o.current)return;const d=o.current;d.style.transform="",d.style.opacity="",tc(d,["transitionend","transitioncancel"],()=>{d.style.transition=""})})})};switch(r){case"enter-active":case"enter-done":return i.forEach(o=>{o.current&&(o.current.style.transition=s,o.current.style.transform=n.transform,o.current.style.opacity=n.opacity)}),r==="enter-done"?()=>{l()}:Ze;case"exit-active":case"exit-done":return Xa(()=>{l()}),Ze;default:return Ze}}:void 0})}var vn="--stackflow-swipe-back-ratio";function Gx({dimRef:e,edgeRef:s,paperRef:n,appBarRef:a,offset:r,transitionDuration:i,preventSwipeBack:l,moveAppBarTogether:o,getActivityTransitionState:d,onSwipeStart:u,onSwipeMove:m,onSwipeEnd:p,onTransitionEnd:x}){xt({styleName:"swipe-back",refs:o&&a?[n,a]:[n],effect:({refs:h})=>{if(l||!e.current||!s.current||!n.current)return Ze;const y=e.current,f=s.current,g=n.current,b=a?.current;let v=null,j=null,w=null,N=[];const M=()=>{v=null,j=null,w=null,N=[]};let S=!1;function A({dx:k,ratio:T}){S||(S=!0,requestAnimationFrame(()=>{y.style.opacity=`${1-T}`,y.style.transition="0s",g.style.overflowY="hidden",g.style.transform=`translate3d(${k}px, 0, 0)`,g.style.transition="0s",o&&b&&(b.style.overflowY="hidden",b.style.transform=`translate3d(${k}px, 0, 0)`,b.style.transition="0s"),b?.style.setProperty(vn,String(T)),h.forEach(C=>{var L,_;C.current&&(C.current.style.transform=`translate3d(${-1*(1-T)*r}px, 0, 0)`,C.current.style.transition="0s",((L=C.current.parentElement)==null?void 0:L.style.display)==="none"&&(C.current.parentElement.style.display="block"),(_=C.current.parentElement)==null||_.style.setProperty(vn,String(T)))}),S=!1}))}function I({swiped:k}){return new Promise(T=>{requestAnimationFrame(()=>{y.style.opacity=`${k?0:1}`,y.style.transition=i,g.style.overflowY="hidden",g.style.transform=`translateX(${k?"100%":"0"})`,g.style.transition=i,o&&b&&(b.style.overflowY="hidden",b.style.transform=`translateX(${k?"100%":"0"})`,b.style.transition=i),h.forEach(L=>{L.current&&(L.current.style.transition=i,L.current.style.transform=`translate3d(${k?"0":`-${r/16}rem`}, 0, 0)`)});const C=[...N];T(),tc(g,["transitionend","transitioncancel"],()=>{const L=k||d()==="exit-active"||d()==="exit-done";y.style.opacity="",g.style.overflowY="",g.style.transform="",o&&b&&(b.style.overflowY="",b.style.transform="",b.style.removeProperty("transition")),b?.style.removeProperty(vn),h.forEach((_,R)=>{var B;if(!_.current)return;const $=C[R];L?(_.current.style.transition="",_.current.style.transform="",_.current.parentElement&&(_.current.parentElement.style.display="")):$&&(_.current.style.transition=$.style.transition,_.current.style.transform=$.style.transform,_.current.parentElement&&$.parentElement&&(_.current.parentElement.style.display=$.parentElement.style.display)),(B=_.current.parentElement)==null||B.style.removeProperty(vn)}),x?.({swiped:k})})})})}const P=k=>{var T;const{activeElement:C}=document;(T=C?.blur)==null||T.call(C),v=w=k.touches[0].clientX,j=Date.now(),N=h.map(L=>L.current?{style:{transform:L.current.style.transform,transition:L.current.style.transition},parentElement:L.current.parentElement?{style:{display:L.current.parentElement.style.display}}:void 0}:{style:{transform:"",transition:""}}),u?.()},D=k=>{if(!v){M();return}w=k.touches[0].clientX;const T=w-v,C=T/g.clientWidth;A({dx:T,ratio:C}),m?.({dx:T,ratio:C})},E=()=>{if(!v||!j||!w){M();return}const k=Date.now(),C=(w-v)/(k-j)>1||w/g.clientWidth>.4;p?.({swiped:C}),Promise.resolve().then(()=>I({swiped:C})).then(()=>M())};return f.addEventListener("touchstart",P,{passive:!0}),f.addEventListener("touchmove",D,{passive:!0}),f.addEventListener("touchend",E,{passive:!0}),f.addEventListener("touchcancel",E,{passive:!0}),()=>{f.removeEventListener("touchstart",P),f.removeEventListener("touchmove",D),f.removeEventListener("touchend",E),f.removeEventListener("touchcancel",E)}},effectDeps:[l]})}function Ks(){var e;const s=es();return((e=s?.zIndex)!=null?e:0)*5}var Qx=Object.defineProperty,Yx=Object.defineProperties,Xx=Object.getOwnPropertyDescriptors,Zi=Object.getOwnPropertySymbols,Zx=Object.prototype.hasOwnProperty,eg=Object.prototype.propertyIsEnumerable,eo=(e,s,n)=>s in e?Qx(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n,Mt=(e,s)=>{for(var n in s||(s={}))Zx.call(s,n)&&eo(e,n,s[n]);if(Zi)for(var n of Zi(s))eg.call(s,n)&&eo(e,n,s[n]);return e},$s=(e,s)=>Yx(e,Xx(s)),tg=e=>t.jsx("svg",{className:e.className,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.7241 2.76052C17.105 3.16043 17.0896 3.79341 16.6897 4.17431L8.45 12.0222L16.6896 19.8689C17.0896 20.2498 17.105 20.8827 16.7242 21.2827C16.3433 21.6826 15.7103 21.6981 15.3104 21.3172L6.31037 12.7464C6.11218 12.5576 6.00001 12.2959 6 12.0222C5.99999 11.7486 6.11215 11.4868 6.31032 11.2981L15.3103 2.72608C15.7102 2.34518 16.3432 2.3606 16.7241 2.76052Z",fill:"currentColor"})}),to=tg,sg=e=>t.jsx("svg",{className:e.className,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M20.7071 4.70711C21.0976 4.31658 21.0976 3.68342 20.7071 3.29289C20.3166 2.90237 19.6834 2.90237 19.2929 3.29289L12 10.5858L4.70711 3.29289C4.31658 2.90237 3.68342 2.90237 3.29289 3.29289C2.90237 3.68342 2.90237 4.31658 3.29289 4.70711L10.5858 12L3.29289 19.2929C2.90237 19.6834 2.90237 20.3166 3.29289 20.7071C3.68342 21.0976 4.31658 21.0976 4.70711 20.7071L12 13.4142L19.2929 20.7071C19.6834 21.0976 20.3166 21.0976 20.7071 20.7071C21.0976 20.3166 21.0976 19.6834 20.7071 19.2929L13.4142 12L20.7071 4.70711Z",fill:"currentColor"})}),so=sg,W={backgroundColor:"var(--stackflow-plugin-basic-ui-background-color)",backgroundImage:"var(--stackflow-plugin-basic-ui-background-image)",dimBackgroundColor:"var(--stackflow-plugin-basic-ui-dim-background-color)",dimHeight:"var(--stackflow-plugin-basic-ui-dim-height)",transitionDuration:"var(--stackflow-plugin-basic-ui-transition-duration)",computedTransitionDuration:"var(--stackflow-plugin-basic-ui-computed-transition-duration)",defaultTransitionOffSet:"var(--stackflow-plugin-basic-ui-default-transition-off-set)",appBar:{borderColor:"var(--stackflow-plugin-basic-ui-app-bar-border-color)",borderColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-border-color-transition-duration)",borderSize:"var(--stackflow-plugin-basic-ui-app-bar-border-size)",height:"var(--stackflow-plugin-basic-ui-app-bar-height)",heightTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-height-transition-duration)",minHeight:"var(--stackflow-plugin-basic-ui-app-bar-min-height)",iconColor:"var(--stackflow-plugin-basic-ui-app-bar-icon-color)",iconColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-icon-color-transition-duration)",textColor:"var(--stackflow-plugin-basic-ui-app-bar-text-color)",textColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-text-color-transition-duration)",backgroundColor:"var(--stackflow-plugin-basic-ui-app-bar-background-color)",backgroundColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-background-color-transition-duration)",backgroundImage:"var(--stackflow-plugin-basic-ui-app-bar-background-image)",backgroundImageTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-background-image-transition-duration)",overflow:"var(--stackflow-plugin-basic-ui-app-bar-overflow)",minSafeAreaInsetTop:"var(--stackflow-plugin-basic-ui-app-bar-min-safe-area-inset-top)",containerPadding:"var(--stackflow-plugin-basic-ui-app-bar-container-padding)",itemGap:"var(--stackflow-plugin-basic-ui-app-bar-item-gap)",fontSize:"var(--stackflow-plugin-basic-ui-app-bar-font-size)",lineHeight:"var(--stackflow-plugin-basic-ui-app-bar-line-height)",hitSlop:"var(--stackflow-plugin-basic-ui-app-bar-hit-slop)"},bottomSheet:{borderRadius:"var(--stackflow-plugin-basic-ui-bottom-sheet-border-radius)"},modal:{borderRadius:"var(--stackflow-plugin-basic-ui-modal-border-radius)",maxWidth:"var(--stackflow-plugin-basic-ui-modal-max-width)"},edge:{width:"var(--stackflow-plugin-basic-ui-edge-width)"}},ng=It({defaultClassName:"_1q6dj2j2",variantClassNames:{theme:{android:"_1q6dj2j0",cupertino:"_1q6dj2j1"}},defaultVariants:{},compoundVariants:[]});function ag(e){return e.filter(s=>s!=null)}function dn(e){return Object.entries(e).reduce((s,[n,a])=>(a!=null&&(s[n]=a),s),{})}var sc=c.createContext({theme:"android"}),rg=sc.Provider;function nc(){return c.useContext(sc)}var ig=e=>()=>({key:"basic-ui",wrapStack({stack:s,initialContext:n}){var a,r,i,l,o,d,u,m,p,x,h,y,f,g,b,v,j;const w=typeof e=="function"?e({initialContext:n}):e;return t.jsx(rg,{value:$s(Mt({},w),{theme:(a=n?.theme)!=null?a:w.theme}),children:t.jsx("div",{className:ag([ng({theme:(r=n?.theme)!=null?r:w.theme}),w.rootClassName]).join(" "),style:cn(dn({[W.backgroundColor]:w.backgroundColor,[W.backgroundImage]:w.backgroundImage,[W.dimBackgroundColor]:w.dimBackgroundColor,[W.dimHeight]:w.dimHeight,[W.transitionDuration]:`${s.transitionDuration}ms`,[W.computedTransitionDuration]:s.globalTransitionState==="loading"?`${s.transitionDuration}ms`:"0ms",[W.defaultTransitionOffSet]:w.defaultTransitionOffSet,[W.appBar.borderColor]:(i=w.appBar)==null?void 0:i.borderColor,[W.appBar.borderSize]:(l=w.appBar)==null?void 0:l.borderSize,[W.appBar.height]:(o=w.appBar)==null?void 0:o.height,[W.appBar.minHeight]:(d=w.appBar)==null?void 0:d.minHeight,[W.appBar.iconColor]:(u=w.appBar)==null?void 0:u.iconColor,[W.appBar.textColor]:(m=w.appBar)==null?void 0:m.textColor,[W.appBar.minSafeAreaInsetTop]:(p=w.appBar)==null?void 0:p.minSafeAreaInsetTop,[W.bottomSheet.borderRadius]:(x=w.bottomSheet)==null?void 0:x.borderRadius,[W.modal.borderRadius]:(h=w.modal)==null?void 0:h.borderRadius,[W.appBar.containerPadding]:(y=w.appBar)==null?void 0:y.containerPadding,[W.appBar.fontSize]:(f=w.appBar)==null?void 0:f.fontSize,[W.appBar.lineHeight]:(g=w.appBar)==null?void 0:g.lineHeight,[W.appBar.hitSlop]:(b=w.appBar)==null?void 0:b.hitSlop,[W.appBar.itemGap]:(v=w.appBar)==null?void 0:v.itemGap,[W.edge.width]:(j=w.edge)==null?void 0:j.width})),children:s.render()})})}}),og=It({defaultClassName:"_1yk3a452 dhthxq4 dhthxq0 dhthxqh _1yk3a451",variantClassNames:{activityEnterStyle:{slideInLeft:"_1yk3a453"},enterStyle:{cover:"_1yk3a454"},border:{true:"_1yk3a455"},modalPresentationStyle:{fullScreen:"_1yk3a456"}},defaultVariants:{},compoundVariants:[[{activityEnterStyle:"slideInLeft",enterStyle:"cover"},"_1yk3a457"]]}),no="_1yk3a45b dhthxq9 dhthxq7 dhthxqb dhthxqf dhthxqi",lg="dhthxq9 dhthxq7 dhthxq8 _1yk3a450",cg="_1yk3a45e",dg="_1yk3a45f dhthxqi dhthxq4 dhthxq2 dhthxqf",ug="_1yk3a45g dhthxqc dhthxqd dhthxq0",mg="_1yk3a45b dhthxq9 dhthxq7 dhthxqb dhthxqf dhthxqi",fg="_1yk3a459 dhthxqa dhthxq7 _1yk3a451",pg="_1yk3a45a dhthxq9 dhthxq7 dhthxq1 _1yk3a450",hg="_1yk3a45h dhthxq9 dhthxq7 dhthxq1 dhthxq5 _1yk3a450",xg="_1yk3a458",gg=It({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_1dlf434a","enter-done":"_1dlf434b","exit-active":"_1dlf434c","exit-done":"_1dlf434d"},hasAppBar:{true:"_1dlf434j"}},defaultVariants:{},compoundVariants:[]}),vg="_1dlf434k dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 _1dlf4347 _1dlf4349",bg=It({defaultClassName:"_1dlf434r dhthxq4 dhthxq2 dhthxq3 dhthxq1",variantClassNames:{hasAppBar:{true:"_1dlf434s"}},defaultVariants:{},compoundVariants:[]}),yg="_1dlf434a",jg="_1dlf434b",Ng="_1dlf434c",wg="_1dlf434d",Sg=It({defaultClassName:"_1dlf434l dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 _1dlf4348 _1dlf4349",variantClassNames:{hasAppBar:{true:"_1dlf434m dhthxqg"},modalPresentationStyle:{fullScreen:"_1dlf434n"},activityEnterStyle:{slideInLeft:"_1dlf434o"}},defaultVariants:{},compoundVariants:[]}),Cg=It({defaultClassName:"_1dlf434p dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3",variantClassNames:{hasAppBar:{true:"_1dlf434q"}},defaultVariants:{},compoundVariants:[]}),ls={transitionDuration:"var(--_1dlf4340)",zIndexes:{dim:"var(--_1dlf4341)",paper:"var(--_1dlf4342)",edge:"var(--_1dlf4343)",appBar:"var(--_1dlf4344)"},appBar:{center:{mainWidth:"var(--_1dlf4346)"}}},ac=c.forwardRef(({title:e,renderLeft:s,renderRight:n,backButton:a,closeButton:r,closeButtonLocation:i="left",border:l=!0,modalPresentationStyle:o,activityEnterStyle:d,iconColor:u,iconColorTransitionDuration:m,textColor:p,textColorTransitionDuration:x,borderColor:h,borderColorTransitionDuration:y,borderSize:f,height:g,heightTransitionDuration:b,overflow:v,backgroundColor:j,backgroundColorTransitionDuration:w,backgroundImage:N,backgroundImageTransitionDuration:M,onTopClick:S,enterStyle:A,className:I,minHeight:P,fontSize:D,lineHeight:E,hitSlop:k,containerPadding:T,itemGap:C},L)=>{var _,R;const B=ln(),$=es(),K=ec();Or();const ee=nc(),V=(_=ee.appBar)==null?void 0:_.closeButton,G=(R=ee.appBar)==null?void 0:R.backButton,me=c.useRef(null),{maxWidth:U}=Vx({outerRef:L,innerRef:me,enable:ee.theme==="cupertino"}),Y=(ee.theme==="cupertino"&&o!=="fullScreen"||d==="slideInLeft")&&A!=="cover",ue=Z=>{a&&"onClick"in a&&a.onClick&&a.onClick(Z),Z.defaultPrevented||B.pop()},ae=()=>{var Z,ie;return!$||$.isRoot?null:!a&&!G?t.jsx("button",{type:"button","aria-label":"Go Back",className:no,onClick:ue,children:t.jsx(to,{})}):a&&"render"in a&&a.render?(Z=a.render)==null?void 0:Z.call(a):G&&"render"in G&&G.render?(ie=G.render)==null?void 0:ie.call(G):t.jsx("button",{type:"button",className:no,"aria-label":a&&"ariaLabel"in a?a.ariaLabel:G&&"ariaLabel"in G?G.ariaLabel:void 0,onClick:ue,children:a&&"renderIcon"in a&&a.renderIcon?a.renderIcon():G&&"renderIcon"in G&&G.renderIcon?G.renderIcon():o==="fullScreen"?t.jsx(so,{}):t.jsx(to,{})})},O=Z=>{var ie;r&&"onClick"in r&&r.onClick&&r.onClick(Z),!Z.defaultPrevented&&V&&"onClick"in V&&((ie=V.onClick)==null||ie.call(V,Z))},ne=()=>{var Z;const ie=!$||$.isRoot,we=oe=>oe&&"render"in oe&&oe.render||oe&&"renderIcon"in oe&&oe.renderIcon||oe&&"onClick"in oe&&oe.onClick;return!(we(r)||we((Z=ee.appBar)==null?void 0:Z.closeButton))||!ie?null:r&&"render"in r&&r.render?r.render():V&&"render"in V&&V.render?V.render():t.jsx("button",{type:"button",className:mg,"aria-label":r&&"ariaLabel"in r?r.ariaLabel:V&&"ariaLabel"in V?V.ariaLabel:void 0,onClick:O,children:r&&"renderIcon"in r&&r.renderIcon?r.renderIcon():V&&"renderIcon"in V&&V.renderIcon?V.renderIcon():t.jsx(so,{})})};return t.jsxs("div",$s(Mt({ref:L,className:ia(og({border:l,modalPresentationStyle:o,activityEnterStyle:d,enterStyle:A}),I),style:cn(dn({[W.appBar.iconColor]:u,[W.appBar.iconColorTransitionDuration]:m,[W.appBar.textColor]:p,[W.appBar.textColorTransitionDuration]:x,[W.appBar.borderColor]:h,[W.appBar.borderColorTransitionDuration]:y,[W.appBar.borderSize]:f,[W.appBar.height]:g,[W.appBar.heightTransitionDuration]:b,[W.appBar.overflow]:v,[W.appBar.backgroundColor]:j??(Y?W.backgroundColor:"transparent"),[W.appBar.backgroundColorTransitionDuration]:w,[W.appBar.backgroundImage]:N??(Y?W.appBar.backgroundImage:"none"),[W.appBar.backgroundImageTransitionDuration]:M,[ls.appBar.center.mainWidth]:`${U}px`,[W.appBar.minHeight]:P,[W.appBar.containerPadding]:T,[W.appBar.fontSize]:D,[W.appBar.hitSlop]:k,[W.appBar.lineHeight]:E,[W.appBar.itemGap]:C})),"data-part":"appBar"},K),{children:[t.jsx("div",{className:xg}),t.jsxs("div",{className:fg,children:[t.jsxs("div",{className:pg,children:[i==="left"&&ne(),ae(),s?.()]}),t.jsx("div",{ref:me,className:lg,children:t.jsxs("div",{className:cg,children:[typeof e=="string"?t.jsx("div",{className:ug,children:e}):e,t.jsx("button",{className:dg,type:"button",onClick:S})]})}),t.jsxs("div",{className:hg,children:[n?.(),i==="right"&&ne()]})]})]}))});ac.displayName="AppBar";var kg=ac,Ag=32,ao=80,Ig=c.createContext(null),Tg=({backgroundColor:e,backgroundImage:s,dimBackgroundColor:n,appBar:a,preventSwipeBack:r,CUPERTINO_ONLY_modalPresentationStyle:i,ANDROID_ONLY_activityEnterStyle:l,className:o,children:d})=>{var u;const m=nc(),p=es(),x=ec();Or();const{pop:h}=ln(),y=c.useRef(null),f=c.useRef(null),g=c.useRef(null),b=c.useRef(null),v=c.useRef(null),j=c.useRef(null),w=m.theme==="cupertino"?i:void 0,N=m.theme==="android"?l:void 0,M=r||w==="fullScreen",S=!!a,A=Ks();let I,P,D,E;m.theme==="cupertino"?(I=A+(w==="fullScreen"?2:0),P=A+(S&&w!=="fullScreen"?a.enterStyle==="cover"?2:1:3),D=A+4,E=A+7):(I=A,P=A+(N==="slideInLeft"&&a?.enterStyle!=="cover"?0:2),D=A+4,E=A+(N==="slideInLeft"?6:4));const k=(u=p?.transitionState)!=null?u:"enter-done",T=Fr(k);Jx({refs:[y]}),Kx({refs:(m.theme==="cupertino"||N==="slideInLeft")&&a?.enterStyle!=="cover"?[g]:[g,v],offsetStyles:m.theme==="cupertino"?{transform:`translate3d(-${ao/16}rem, 0, 0)`,opacity:"1"}:N==="slideInLeft"?{transform:"translate3d(-50%, 0, 0)",opacity:"0"}:{transform:`translate3d(0, -${Ag/16}rem, 0)`,opacity:"1"},transitionDuration:W.computedTransitionDuration,hasEffect:w!=="fullScreen"}),Gx({dimRef:f,edgeRef:b,paperRef:g,appBarRef:v,offset:ao,transitionDuration:W.transitionDuration,moveAppBarTogether:a?.enterStyle==="cover",preventSwipeBack:M||m.theme!=="cupertino",getActivityTransitionState(){const L=g.current,_=L?.parentElement;return _?_.classList.contains(yg)?"enter-active":_.classList.contains(jg)?"enter-done":_.classList.contains(Ng)?"exit-active":_.classList.contains(wg)?"exit-done":null:null},onSwipeEnd({swiped:L}){L&&h()}});const C=L=>{var _,R;(_=a?.onTopClick)==null||_.call(a,L),L.defaultPrevented||(R=j.current)==null||R.scroll({top:0,behavior:"smooth"})};return Wr({ref:y}),t.jsx(Ig.Provider,{value:c.useMemo(()=>({scroll({top:L}){var _;(_=j?.current)==null||_.scroll({top:L,behavior:"smooth"})},zIndices:{dim:I,paper:P,edge:D,appBar:E}}),[j,I,P,D,E]),children:t.jsxs("div",$s(Mt({ref:y,className:ia(gg({hasAppBar:S,transitionState:k==="enter-done"||k==="exit-done"?k:T}),o),style:cn(dn({[W.backgroundColor]:e,[W.backgroundImage]:s,[W.dimBackgroundColor]:n,[W.appBar.height]:a?.height,[W.appBar.heightTransitionDuration]:a?.heightTransitionDuration,[ls.zIndexes.dim]:`${I}`,[ls.zIndexes.paper]:`${P}`,[ls.zIndexes.edge]:`${D}`,[ls.zIndexes.appBar]:`${E}`,[ls.transitionDuration]:k==="enter-active"||k==="exit-active"?W.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"AppScreen"},x),{children:[N!=="slideInLeft"&&t.jsx("div",Mt({ref:f,className:vg,"data-part":"dim"},x)),a&&t.jsx(kg,$s(Mt({},a),{ref:v,modalPresentationStyle:w,activityEnterStyle:N,onTopClick:C})),t.jsx("div",$s(Mt({ref:g,className:Sg({hasAppBar:S,modalPresentationStyle:w,activityEnterStyle:N}),"data-part":"paper"},x),{children:t.jsx("div",{ref:j,className:Cg({hasAppBar:S}),children:d})}),p?.id),!p?.isRoot&&m.theme==="cupertino"&&!M&&t.jsx("div",Mt({ref:b,className:bg({hasAppBar:S}),"data-part":"edge"},x))]}))})},ce=Tg,Pg=It({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_1ht38h04","enter-done":"_1ht38h05","exit-active":"_1ht38h06","exit-done":"_1ht38h07"}},defaultVariants:{},compoundVariants:[]}),Eg="_1ht38h0d dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc dhthxqa dhthxq7 _1ht38h03",_g="_1ht38h0e dhthxqc _1ht38h03",za={transitionDuration:"var(--_1ht38h00)",zIndexes:{dim:"var(--_1ht38h01)",paper:"var(--_1ht38h02)"}},rc=({borderRadius:e="1rem",backgroundColor:s,backgroundImage:n,dimBackgroundColor:a,paperRef:r,onOutsideClick:i,children:l,className:o})=>{var d;const u=es(),{pop:m}=ln(),p=c.useRef(null),x=c.useRef(null);xt({styleName:"hide",refs:[p]}),xt({styleName:"offset",refs:[x]}),xt({styleName:"swipe-back",refs:[x]});const h=c.useRef(!1),y=j=>{i?.(j),!j.defaultPrevented&&(h.current||(h.current=!0,m()))},f=j=>{j.stopPropagation()},g=Ks()+3,b=Ks()+4,v=(d=u?.transitionState)!=null?d:"enter-done";return Wr({ref:p}),t.jsx("div",{className:ia(Pg({transitionState:Fr(v)}),o),ref:p,style:cn(dn({[W.bottomSheet.borderRadius]:e,[W.backgroundColor]:s,[W.backgroundImage]:n,[W.dimBackgroundColor]:a,[za.zIndexes.dim]:`${g}`,[za.zIndexes.paper]:`${b}`,[za.transitionDuration]:v==="enter-active"||v==="exit-active"?W.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"BottomSheet","data-stackflow-activity-id":u?.id,"data-stackflow-activity-is-active":u?.isActive,children:t.jsx("div",{className:Eg,ref:x,onClick:y,children:t.jsx("div",{className:_g,ref:r,onClick:f,children:l})})})};rc.displayName="BottomSheet";var Mg=rc,Rg=It({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_5ozg8c4","enter-done":"_5ozg8c5","exit-active":"_5ozg8c6","exit-done":"_5ozg8c7"}},defaultVariants:{},compoundVariants:[]}),Dg="_5ozg8cd dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc dhthxq9 dhthxq7 dhthxqb _5ozg8c3",zg="_5ozg8ce dhthxqc _5ozg8c3",La={transitionDuration:"var(--_5ozg8c0)",zIndexes:{dim:"var(--_5ozg8c1)",paper:"var(--_5ozg8c2)"}},ic=({backgroundColor:e,backgroundImage:s,dimBackgroundColor:n,borderRadius:a="1rem",maxWidth:r,onOutsideClick:i,children:l,className:o})=>{var d;const u=es(),{pop:m}=ln(),p=c.useRef(null),x=c.useRef(null);xt({styleName:"hide",refs:[p]}),xt({styleName:"offset",refs:[x]}),xt({styleName:"swipe-back",refs:[x]});const h=c.useRef(!1),y=j=>{i?.(j),!j.defaultPrevented&&(h.current||(h.current=!0,m()))},f=j=>{j.stopPropagation()},g=Ks()+3,b=Ks()+4,v=(d=u?.transitionState)!=null?d:"enter-done";return Wr({ref:p}),t.jsx("div",{className:ia(Rg({transitionState:Fr(v)}),o),ref:p,style:cn(dn({[W.backgroundColor]:e,[W.backgroundImage]:s,[W.dimBackgroundColor]:n,[W.modal.borderRadius]:a,[W.modal.maxWidth]:r,[La.zIndexes.dim]:`${g}`,[La.zIndexes.paper]:`${b}`,[La.transitionDuration]:v==="enter-active"||v==="exit-active"?W.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"Modal","data-stackflow-activity-id":u?.id,"data-stackflow-activity-is-active":u?.isActive,children:t.jsx("div",{className:Dg,ref:x,onClick:y,children:t.jsx("div",{className:zg,onClick:f,children:l})})})};ic.displayName="Modal";var Lg=ic,Bg=Object.defineProperty,J=(e,s)=>Bg(e,"name",{value:s,configurable:!0}),ps=class{type=3;name="";prefix="";value="";suffix="";modifier=3;constructor(e,s,n,a,r,i){this.type=e,this.name=s,this.prefix=n,this.value=a,this.suffix=r,this.modifier=i}hasCustomName(){return this.name!==""&&typeof this.name!="number"}};J(ps,"Part");var Og=/[$_\p{ID_Start}]/u,Fg=/[$_\u200C\u200D\p{ID_Continue}]/u,Za=".*";function oc(e,s){return(s?/^[\x00-\xFF]*$/:/^[\x00-\x7F]*$/).test(e)}J(oc,"isASCII");function $r(e,s=!1){let n=[],a=0;for(;a<e.length;){let r=e[a],i=J(function(l){if(!s)throw new TypeError(l);n.push({type:"INVALID_CHAR",index:a,value:e[a++]})},"ErrorOrInvalid");if(r==="*"){n.push({type:"ASTERISK",index:a,value:e[a++]});continue}if(r==="+"||r==="?"){n.push({type:"OTHER_MODIFIER",index:a,value:e[a++]});continue}if(r==="\\"){n.push({type:"ESCAPED_CHAR",index:a++,value:e[a++]});continue}if(r==="{"){n.push({type:"OPEN",index:a,value:e[a++]});continue}if(r==="}"){n.push({type:"CLOSE",index:a,value:e[a++]});continue}if(r===":"){let l="",o=a+1;for(;o<e.length;){let d=e.substr(o,1);if(o===a+1&&Og.test(d)||o!==a+1&&Fg.test(d)){l+=e[o++];continue}break}if(!l){i(`Missing parameter name at ${a}`);continue}n.push({type:"NAME",index:a,value:l}),a=o;continue}if(r==="("){let l=1,o="",d=a+1,u=!1;if(e[d]==="?"){i(`Pattern cannot start with "?" at ${d}`);continue}for(;d<e.length;){if(!oc(e[d],!1)){i(`Invalid character '${e[d]}' at ${d}.`),u=!0;break}if(e[d]==="\\"){o+=e[d++]+e[d++];continue}if(e[d]===")"){if(l--,l===0){d++;break}}else if(e[d]==="("&&(l++,e[d+1]!=="?")){i(`Capturing groups are not allowed at ${d}`),u=!0;break}o+=e[d++]}if(u)continue;if(l){i(`Unbalanced pattern at ${a}`);continue}if(!o){i(`Missing pattern at ${a}`);continue}n.push({type:"REGEX",index:a,value:o}),a=d;continue}n.push({type:"CHAR",index:a,value:e[a++]})}return n.push({type:"END",index:a,value:""}),n}J($r,"lexer");function Hr(e,s={}){let n=$r(e);s.delimiter??="/#?",s.prefixes??="./";let a=`[^${De(s.delimiter)}]+?`,r=[],i=0,l=0,o=new Set,d=J(v=>{if(l<n.length&&n[l].type===v)return n[l++].value},"tryConsume"),u=J(()=>d("OTHER_MODIFIER")??d("ASTERISK"),"tryConsumeModifier"),m=J(v=>{let j=d(v);if(j!==void 0)return j;let{type:w,index:N}=n[l];throw new TypeError(`Unexpected ${w} at ${N}, expected ${v}`)},"mustConsume"),p=J(()=>{let v="",j;for(;j=d("CHAR")??d("ESCAPED_CHAR");)v+=j;return v},"consumeText"),x=J(v=>v,"DefaultEncodePart"),h=s.encodePart||x,y="",f=J(v=>{y+=v},"appendToPendingFixedValue"),g=J(()=>{y.length&&(r.push(new ps(3,"","",h(y),"",3)),y="")},"maybeAddPartFromPendingFixedValue"),b=J((v,j,w,N,M)=>{let S=3;switch(M){case"?":S=1;break;case"*":S=0;break;case"+":S=2;break}if(!j&&!w&&S===3){f(v);return}if(g(),!j&&!w){if(!v)return;r.push(new ps(3,"","",h(v),"",S));return}let A;w?w==="*"?A=Za:A=w:A=a;let I=2;A===a?(I=1,A=""):A===Za&&(I=0,A="");let P;if(j?P=j:w&&(P=i++),o.has(P))throw new TypeError(`Duplicate name '${P}'.`);o.add(P),r.push(new ps(I,P,h(v),A,h(N),S))},"addPart");for(;l<n.length;){let v=d("CHAR"),j=d("NAME"),w=d("REGEX");if(!j&&!w&&(w=d("ASTERISK")),j||w){let M=v??"";s.prefixes.indexOf(M)===-1&&(f(M),M=""),g();let S=u();b(M,j,w,"",S);continue}let N=v??d("ESCAPED_CHAR");if(N){f(N);continue}if(d("OPEN")){let M=p(),S=d("NAME"),A=d("REGEX");!S&&!A&&(A=d("ASTERISK"));let I=p();m("CLOSE");let P=u();b(M,S,A,I,P);continue}g(),m("END")}return r}J(Hr,"parse");function De(e){return e.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}J(De,"escapeString");function er(e){return e&&e.ignoreCase?"ui":"u"}J(er,"flags");function lc(e,s,n){return qr(Hr(e,n),s,n)}J(lc,"stringToRegexp");function Lt(e){switch(e){case 0:return"*";case 1:return"?";case 2:return"+";case 3:return""}}J(Lt,"modifierToString");function qr(e,s,n={}){n.delimiter??="/#?",n.prefixes??="./",n.sensitive??=!1,n.strict??=!1,n.end??=!0,n.start??=!0,n.endsWith="";let a=n.start?"^":"";for(let o of e){if(o.type===3){o.modifier===3?a+=De(o.value):a+=`(?:${De(o.value)})${Lt(o.modifier)}`;continue}s&&s.push(o.name);let d=`[^${De(n.delimiter)}]+?`,u=o.value;if(o.type===1?u=d:o.type===0&&(u=Za),!o.prefix.length&&!o.suffix.length){o.modifier===3||o.modifier===1?a+=`(${u})${Lt(o.modifier)}`:a+=`((?:${u})${Lt(o.modifier)})`;continue}if(o.modifier===3||o.modifier===1){a+=`(?:${De(o.prefix)}(${u})${De(o.suffix)})`,a+=Lt(o.modifier);continue}a+=`(?:${De(o.prefix)}`,a+=`((?:${u})(?:`,a+=De(o.suffix),a+=De(o.prefix),a+=`(?:${u}))*)${De(o.suffix)})`,o.modifier===0&&(a+="?")}let r=`[${De(n.endsWith)}]|$`,i=`[${De(n.delimiter)}]`;if(n.end)return n.strict||(a+=`${i}?`),n.endsWith.length?a+=`(?=${r})`:a+="$",new RegExp(a,er(n));n.strict||(a+=`(?:${i}(?=${r}))?`);let l=!1;if(e.length){let o=e[e.length-1];o.type===3&&o.modifier===3&&(l=n.delimiter.indexOf(o)>-1)}return l||(a+=`(?=${i}|${r})`),new RegExp(a,er(n))}J(qr,"partsToRegexp");var St={delimiter:"",prefixes:"",sensitive:!0,strict:!0},Wg={delimiter:".",prefixes:"",sensitive:!0,strict:!0},$g={delimiter:"/",prefixes:"/",sensitive:!0,strict:!0};function cc(e,s){return e.length?e[0]==="/"?!0:!s||e.length<2?!1:(e[0]=="\\"||e[0]=="{")&&e[1]=="/":!1}J(cc,"isAbsolutePathname");function Vr(e,s){return e.startsWith(s)?e.substring(s.length,e.length):e}J(Vr,"maybeStripPrefix");function dc(e,s){return e.endsWith(s)?e.substr(0,e.length-s.length):e}J(dc,"maybeStripSuffix");function Ur(e){return!e||e.length<2?!1:e[0]==="["||(e[0]==="\\"||e[0]==="{")&&e[1]==="["}J(Ur,"treatAsIPv6Hostname");var uc=["ftp","file","http","https","ws","wss"];function Jr(e){if(!e)return!0;for(let s of uc)if(e.test(s))return!0;return!1}J(Jr,"isSpecialScheme");function mc(e,s){if(e=Vr(e,"#"),s||e==="")return e;let n=new URL("https://example.com");return n.hash=e,n.hash?n.hash.substring(1,n.hash.length):""}J(mc,"canonicalizeHash");function fc(e,s){if(e=Vr(e,"?"),s||e==="")return e;let n=new URL("https://example.com");return n.search=e,n.search?n.search.substring(1,n.search.length):""}J(fc,"canonicalizeSearch");function pc(e,s){return s||e===""?e:Ur(e)?Qr(e):Gr(e)}J(pc,"canonicalizeHostname");function hc(e,s){if(s||e==="")return e;let n=new URL("https://example.com");return n.password=e,n.password}J(hc,"canonicalizePassword");function xc(e,s){if(s||e==="")return e;let n=new URL("https://example.com");return n.username=e,n.username}J(xc,"canonicalizeUsername");function gc(e,s,n){if(n||e==="")return e;if(s&&!uc.includes(s))return new URL(`${s}:${e}`).pathname;let a=e[0]=="/";return e=new URL(a?e:"/-"+e,"https://example.com").pathname,a||(e=e.substring(2,e.length)),e}J(gc,"canonicalizePathname");function vc(e,s,n){return Kr(s)===e&&(e=""),n||e===""?e:Yr(e)}J(vc,"canonicalizePort");function bc(e,s){return e=dc(e,":"),s||e===""?e:xa(e)}J(bc,"canonicalizeProtocol");function Kr(e){switch(e){case"ws":case"http":return"80";case"wws":case"https":return"443";case"ftp":return"21";default:return""}}J(Kr,"defaultPortForProtocol");function xa(e){if(e==="")return e;if(/^[-+.A-Za-z0-9]*$/.test(e))return e.toLowerCase();throw new TypeError(`Invalid protocol '${e}'.`)}J(xa,"protocolEncodeCallback");function yc(e){if(e==="")return e;let s=new URL("https://example.com");return s.username=e,s.username}J(yc,"usernameEncodeCallback");function jc(e){if(e==="")return e;let s=new URL("https://example.com");return s.password=e,s.password}J(jc,"passwordEncodeCallback");function Gr(e){if(e==="")return e;if(/[\t\n\r #%/:<>?@[\]^\\|]/g.test(e))throw new TypeError(`Invalid hostname '${e}'`);let s=new URL("https://example.com");return s.hostname=e,s.hostname}J(Gr,"hostnameEncodeCallback");function Qr(e){if(e==="")return e;if(/[^0-9a-fA-F[\]:]/g.test(e))throw new TypeError(`Invalid IPv6 hostname '${e}'`);return e.toLowerCase()}J(Qr,"ipv6HostnameEncodeCallback");function Yr(e){if(e===""||/^[0-9]*$/.test(e)&&parseInt(e)<=65535)return e;throw new TypeError(`Invalid port '${e}'.`)}J(Yr,"portEncodeCallback");function Nc(e){if(e==="")return e;let s=new URL("https://example.com");return s.pathname=e[0]!=="/"?"/-"+e:e,e[0]!=="/"?s.pathname.substring(2,s.pathname.length):s.pathname}J(Nc,"standardURLPathnameEncodeCallback");function wc(e){return e===""?e:new URL(`data:${e}`).pathname}J(wc,"pathURLPathnameEncodeCallback");function Sc(e){if(e==="")return e;let s=new URL("https://example.com");return s.search=e,s.search.substring(1,s.search.length)}J(Sc,"searchEncodeCallback");function Cc(e){if(e==="")return e;let s=new URL("https://example.com");return s.hash=e,s.hash.substring(1,s.hash.length)}J(Cc,"hashEncodeCallback");var kc=class{#r;#n=[];#t={};#e=0;#a=1;#c=0;#o=0;#f=0;#p=0;#h=!1;constructor(e){this.#r=e}get result(){return this.#t}parse(){for(this.#n=$r(this.#r,!0);this.#e<this.#n.length;this.#e+=this.#a){if(this.#a=1,this.#n[this.#e].type==="END"){if(this.#o===0){this.#b(),this.#d()?this.#s(9,1):this.#u()?this.#s(8,1):this.#s(7,0);continue}else if(this.#o===2){this.#m(5);continue}this.#s(10,0);break}if(this.#f>0)if(this.#k())this.#f-=1;else continue;if(this.#C()){this.#f+=1;continue}switch(this.#o){case 0:this.#y()&&this.#m(1);break;case 1:if(this.#y()){this.#T();let e=7,s=1;this.#N()?(e=2,s=3):this.#h&&(e=2),this.#s(e,s)}break;case 2:this.#g()?this.#m(3):(this.#v()||this.#u()||this.#d())&&this.#m(5);break;case 3:this.#w()?this.#s(4,1):this.#g()&&this.#s(5,1);break;case 4:this.#g()&&this.#s(5,1);break;case 5:this.#A()?this.#p+=1:this.#I()&&(this.#p-=1),this.#S()&&!this.#p?this.#s(6,1):this.#v()?this.#s(7,0):this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 6:this.#v()?this.#s(7,0):this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 7:this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 8:this.#d()&&this.#s(9,1);break}}this.#t.hostname!==void 0&&this.#t.port===void 0&&(this.#t.port="")}#s(e,s){switch(this.#o){case 0:break;case 1:this.#t.protocol=this.#l();break;case 2:break;case 3:this.#t.username=this.#l();break;case 4:this.#t.password=this.#l();break;case 5:this.#t.hostname=this.#l();break;case 6:this.#t.port=this.#l();break;case 7:this.#t.pathname=this.#l();break;case 8:this.#t.search=this.#l();break;case 9:this.#t.hash=this.#l();break}this.#o!==0&&e!==10&&([1,2,3,4].includes(this.#o)&&[6,7,8,9].includes(e)&&(this.#t.hostname??=""),[1,2,3,4,5,6].includes(this.#o)&&[8,9].includes(e)&&(this.#t.pathname??=this.#h?"/":""),[1,2,3,4,5,6,7].includes(this.#o)&&e===9&&(this.#t.search??="")),this.#j(e,s)}#j(e,s){this.#o=e,this.#c=this.#e+s,this.#e+=s,this.#a=0}#b(){this.#e=this.#c,this.#a=0}#m(e){this.#b(),this.#o=e}#x(e){return e<0&&(e=this.#n.length-e),e<this.#n.length?this.#n[e]:this.#n[this.#n.length-1]}#i(e,s){let n=this.#x(e);return n.value===s&&(n.type==="CHAR"||n.type==="ESCAPED_CHAR"||n.type==="INVALID_CHAR")}#y(){return this.#i(this.#e,":")}#N(){return this.#i(this.#e+1,"/")&&this.#i(this.#e+2,"/")}#g(){return this.#i(this.#e,"@")}#w(){return this.#i(this.#e,":")}#S(){return this.#i(this.#e,":")}#v(){return this.#i(this.#e,"/")}#u(){if(this.#i(this.#e,"?"))return!0;if(this.#n[this.#e].value!=="?")return!1;let e=this.#x(this.#e-1);return e.type!=="NAME"&&e.type!=="REGEX"&&e.type!=="CLOSE"&&e.type!=="ASTERISK"}#d(){return this.#i(this.#e,"#")}#C(){return this.#n[this.#e].type=="OPEN"}#k(){return this.#n[this.#e].type=="CLOSE"}#A(){return this.#i(this.#e,"[")}#I(){return this.#i(this.#e,"]")}#l(){let e=this.#n[this.#e],s=this.#x(this.#c).index;return this.#r.substring(s,e.index)}#T(){let e={};Object.assign(e,St),e.encodePart=xa;let s=lc(this.#l(),void 0,e);this.#h=Jr(s)}};J(kc,"Parser");var Ba=["protocol","username","password","hostname","port","pathname","search","hash"],Nt="*";function tr(e,s){if(typeof e!="string")throw new TypeError("parameter 1 is not of type 'string'.");let n=new URL(e,s);return{protocol:n.protocol.substring(0,n.protocol.length-1),username:n.username,password:n.password,hostname:n.hostname,port:n.port,pathname:n.pathname,search:n.search!==""?n.search.substring(1,n.search.length):void 0,hash:n.hash!==""?n.hash.substring(1,n.hash.length):void 0}}J(tr,"extractValues");function Ge(e,s){return s?us(e):e}J(Ge,"processBaseURLString");function cs(e,s,n){let a;if(typeof s.baseURL=="string")try{a=new URL(s.baseURL),s.protocol===void 0&&(e.protocol=Ge(a.protocol.substring(0,a.protocol.length-1),n)),!n&&s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.username===void 0&&(e.username=Ge(a.username,n)),!n&&s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.username===void 0&&s.password===void 0&&(e.password=Ge(a.password,n)),s.protocol===void 0&&s.hostname===void 0&&(e.hostname=Ge(a.hostname,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&(e.port=Ge(a.port,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&(e.pathname=Ge(a.pathname,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&s.search===void 0&&(e.search=Ge(a.search.substring(1,a.search.length),n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&s.search===void 0&&s.hash===void 0&&(e.hash=Ge(a.hash.substring(1,a.hash.length),n))}catch{throw new TypeError(`invalid baseURL '${s.baseURL}'.`)}if(typeof s.protocol=="string"&&(e.protocol=bc(s.protocol,n)),typeof s.username=="string"&&(e.username=xc(s.username,n)),typeof s.password=="string"&&(e.password=hc(s.password,n)),typeof s.hostname=="string"&&(e.hostname=pc(s.hostname,n)),typeof s.port=="string"&&(e.port=vc(s.port,e.protocol,n)),typeof s.pathname=="string"){if(e.pathname=s.pathname,a&&!cc(e.pathname,n)){let r=a.pathname.lastIndexOf("/");r>=0&&(e.pathname=Ge(a.pathname.substring(0,r+1),n)+e.pathname)}e.pathname=gc(e.pathname,e.protocol,n)}return typeof s.search=="string"&&(e.search=fc(s.search,n)),typeof s.hash=="string"&&(e.hash=mc(s.hash,n)),e}J(cs,"applyInit");function us(e){return e.replace(/([+*?:{}()\\])/g,"\\$1")}J(us,"escapePatternString");function Ac(e){return e.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}J(Ac,"escapeRegexpString");function Ic(e,s){s.delimiter??="/#?",s.prefixes??="./",s.sensitive??=!1,s.strict??=!1,s.end??=!0,s.start??=!0,s.endsWith="";let n=".*",a=`[^${Ac(s.delimiter)}]+?`,r=/[$_\u200C\u200D\p{ID_Continue}]/u,i="";for(let l=0;l<e.length;++l){let o=e[l];if(o.type===3){if(o.modifier===3){i+=us(o.value);continue}i+=`{${us(o.value)}}${Lt(o.modifier)}`;continue}let d=o.hasCustomName(),u=!!o.suffix.length||!!o.prefix.length&&(o.prefix.length!==1||!s.prefixes.includes(o.prefix)),m=l>0?e[l-1]:null,p=l<e.length-1?e[l+1]:null;if(!u&&d&&o.type===1&&o.modifier===3&&p&&!p.prefix.length&&!p.suffix.length)if(p.type===3){let x=p.value.length>0?p.value[0]:"";u=r.test(x)}else u=!p.hasCustomName();if(!u&&!o.prefix.length&&m&&m.type===3){let x=m.value[m.value.length-1];u=s.prefixes.includes(x)}u&&(i+="{"),i+=us(o.prefix),d&&(i+=`:${o.name}`),o.type===2?i+=`(${o.value})`:o.type===1?d||(i+=`(${a})`):o.type===0&&(!d&&(!m||m.type===3||m.modifier!==3||u||o.prefix!=="")?i+="*":i+=`(${n})`),o.type===1&&d&&o.suffix.length&&r.test(o.suffix[0])&&(i+="\\"),i+=us(o.suffix),u&&(i+="}"),o.modifier!==3&&(i+=Lt(o.modifier))}return i}J(Ic,"partsToPattern");var Tc=class{#r;#n={};#t={};#e={};#a={};#c=!1;constructor(e={},s,n){try{let a;if(typeof s=="string"?a=s:n=s,typeof e=="string"){let o=new kc(e);if(o.parse(),e=o.result,a===void 0&&typeof e.protocol!="string")throw new TypeError("A base URL must be provided for a relative constructor string.");e.baseURL=a}else{if(!e||typeof e!="object")throw new TypeError("parameter 1 is not of type 'string' and cannot convert to dictionary.");if(a)throw new TypeError("parameter 1 is not of type 'string'.")}typeof n>"u"&&(n={ignoreCase:!1});let r={ignoreCase:n.ignoreCase===!0},i={pathname:Nt,protocol:Nt,username:Nt,password:Nt,hostname:Nt,port:Nt,search:Nt,hash:Nt};this.#r=cs(i,e,!0),Kr(this.#r.protocol)===this.#r.port&&(this.#r.port="");let l;for(l of Ba){if(!(l in this.#r))continue;let o={},d=this.#r[l];switch(this.#t[l]=[],l){case"protocol":Object.assign(o,St),o.encodePart=xa;break;case"username":Object.assign(o,St),o.encodePart=yc;break;case"password":Object.assign(o,St),o.encodePart=jc;break;case"hostname":Object.assign(o,Wg),Ur(d)?o.encodePart=Qr:o.encodePart=Gr;break;case"port":Object.assign(o,St),o.encodePart=Yr;break;case"pathname":Jr(this.#n.protocol)?(Object.assign(o,$g,r),o.encodePart=Nc):(Object.assign(o,St,r),o.encodePart=wc);break;case"search":Object.assign(o,St,r),o.encodePart=Sc;break;case"hash":Object.assign(o,St,r),o.encodePart=Cc;break}try{this.#a[l]=Hr(d,o),this.#n[l]=qr(this.#a[l],this.#t[l],o),this.#e[l]=Ic(this.#a[l],o),this.#c=this.#c||this.#a[l].some(u=>u.type===2)}catch{throw new TypeError(`invalid ${l} pattern '${this.#r[l]}'.`)}}}catch(a){throw new TypeError(`Failed to construct 'URLPattern': ${a.message}`)}}get[Symbol.toStringTag](){return"URLPattern"}test(e={},s){let n={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof e!="string"&&s)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof e>"u")return!1;try{typeof e=="object"?n=cs(n,e,!1):n=cs(n,tr(e,s),!1)}catch{return!1}let a;for(a of Ba)if(!this.#n[a].exec(n[a]))return!1;return!0}exec(e={},s){let n={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof e!="string"&&s)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof e>"u")return;try{typeof e=="object"?n=cs(n,e,!1):n=cs(n,tr(e,s),!1)}catch{return null}let a={};s?a.inputs=[e,s]:a.inputs=[e];let r;for(r of Ba){let i=this.#n[r].exec(n[r]);if(!i)return null;let l={};for(let[o,d]of this.#t[r].entries())if(typeof d=="string"||typeof d=="number"){let u=i[o+1];l[d]=u}a[r]={input:n[r]??"",groups:l}}return a}static compareComponent(e,s,n){let a=J((o,d)=>{for(let u of["type","modifier","prefix","value","suffix"]){if(o[u]<d[u])return-1;if(o[u]!==d[u])return 1}return 0},"comparePart"),r=new ps(3,"","","","",3),i=new ps(0,"","","","",3),l=J((o,d)=>{let u=0;for(;u<Math.min(o.length,d.length);++u){let m=a(o[u],d[u]);if(m)return m}return o.length===d.length?0:a(o[u]??r,d[u]??r)},"comparePartList");return!s.#e[e]&&!n.#e[e]?0:s.#e[e]&&!n.#e[e]?l(s.#a[e],[i]):!s.#e[e]&&n.#e[e]?l([i],n.#a[e]):l(s.#a[e],n.#a[e])}get protocol(){return this.#e.protocol}get username(){return this.#e.username}get password(){return this.#e.password}get hostname(){return this.#e.hostname}get port(){return this.#e.port}get pathname(){return this.#e.pathname}get search(){return this.#e.search}get hash(){return this.#e.hash}get hasRegExpGroups(){return this.#c}};J(Tc,"URLPattern");globalThis.URLPattern||(globalThis.URLPattern=Tc);const Hg=c.createContext({requestHistoryTick:()=>{}}),Pc=({children:e,requestHistoryTick:s})=>{const n=c.useMemo(()=>({requestHistoryTick:s}),[s]);return t.jsx(Hg.Provider,{value:n,children:e})};Pc.__docgenInfo={description:"",methods:[],displayName:"HistoryQueueProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},requestHistoryTick:{required:!0,tsType:{name:"signature",type:"function",raw:"(cb: (resolve: () => void) => void) => void",signature:{arguments:[{type:{name:"signature",type:"function",raw:"(resolve: () => void) => void",signature:{arguments:[{type:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},name:"resolve"}],return:{name:"void"}}},name:"cb"}],return:{name:"void"}}},description:""}}};function js(){return js=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},js.apply(null,arguments)}var Xe;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Xe||(Xe={}));var Un=function(e){return e},ro="beforeunload",qg="popstate";function Vg(e){e===void 0&&(e={});var s=e,n=s.window,a=n===void 0?document.defaultView:n,r=a.history;function i(){var S=a.location,A=S.pathname,I=S.search,P=S.hash,D=r.state||{};return[D.idx,Un({pathname:A,search:I,hash:P,state:D.usr||null,key:D.key||"default"})]}var l=null;function o(){if(l)h.call(l),l=null;else{var S=Xe.Pop,A=i(),I=A[0],P=A[1];if(h.length){if(I!=null){var D=m-I;D&&(l={action:S,location:P,retry:function(){N(D*-1)}},N(D))}}else v(S)}}a.addEventListener(qg,o);var d=Xe.Pop,u=i(),m=u[0],p=u[1],x=Jn(),h=Jn();m==null&&(m=0,r.replaceState(js({},r.state,{idx:m}),""));function y(S){return typeof S=="string"?S:Ec(S)}function f(S,A){return A===void 0&&(A=null),Un(js({pathname:p.pathname,hash:"",search:""},typeof S=="string"?nr(S):S,{state:A,key:sr()}))}function g(S,A){return[{usr:S.state,key:S.key,idx:A},y(S)]}function b(S,A,I){return!h.length||(h.call({action:S,location:A,retry:I}),!1)}function v(S){d=S;var A=i();m=A[0],p=A[1],x.call({action:d,location:p})}function j(S,A){var I=Xe.Push,P=f(S,A);function D(){j(S,A)}if(b(I,P,D)){var E=g(P,m+1),k=E[0],T=E[1];try{r.pushState(k,"",T)}catch{a.location.assign(T)}v(I)}}function w(S,A){var I=Xe.Replace,P=f(S,A);function D(){w(S,A)}if(b(I,P,D)){var E=g(P,m),k=E[0],T=E[1];r.replaceState(k,"",T),v(I)}}function N(S){r.go(S)}var M={get action(){return d},get location(){return p},createHref:y,push:j,replace:w,go:N,back:function(){N(-1)},forward:function(){N(1)},listen:function(A){return x.push(A)},block:function(A){var I=h.push(A);return h.length===1&&a.addEventListener(ro,oo),function(){I(),h.length||a.removeEventListener(ro,oo)}}};return M}function Ug(e){e===void 0&&(e={});var s=e,n=s.initialEntries,a=n===void 0?["/"]:n,r=s.initialIndex,i=a.map(function(j){var w=Un(js({pathname:"/",search:"",hash:"",state:null,key:sr()},typeof j=="string"?nr(j):j));return w}),l=io(r??i.length-1,0,i.length-1),o=Xe.Pop,d=i[l],u=Jn(),m=Jn();function p(j){return typeof j=="string"?j:Ec(j)}function x(j,w){return w===void 0&&(w=null),Un(js({pathname:d.pathname,search:"",hash:""},typeof j=="string"?nr(j):j,{state:w,key:sr()}))}function h(j,w,N){return!m.length||(m.call({action:j,location:w,retry:N}),!1)}function y(j,w){o=j,d=w,u.call({action:o,location:d})}function f(j,w){var N=Xe.Push,M=x(j,w);function S(){f(j,w)}h(N,M,S)&&(l+=1,i.splice(l,i.length,M),y(N,M))}function g(j,w){var N=Xe.Replace,M=x(j,w);function S(){g(j,w)}h(N,M,S)&&(i[l]=M,y(N,M))}function b(j){var w=io(l+j,0,i.length-1),N=Xe.Pop,M=i[w];function S(){b(j)}h(N,M,S)&&(l=w,y(N,M))}var v={get index(){return l},get action(){return o},get location(){return d},createHref:p,push:f,replace:g,go:b,back:function(){b(-1)},forward:function(){b(1)},listen:function(w){return u.push(w)},block:function(w){return m.push(w)}};return v}function io(e,s,n){return Math.min(Math.max(e,s),n)}function oo(e){e.preventDefault(),e.returnValue=""}function Jn(){var e=[];return{get length(){return e.length},push:function(n){return e.push(n),function(){e=e.filter(function(a){return a!==n})}},call:function(n){e.forEach(function(a){return a&&a(n)})}}}function sr(){return Math.random().toString(36).substr(2,8)}function Ec(e){var s=e.pathname,n=s===void 0?"/":s,a=e.search,r=a===void 0?"":a,i=e.hash,l=i===void 0?"":i;return r&&r!=="?"&&(n+=r.charAt(0)==="?"?r:"?"+r),l&&l!=="#"&&(n+=l.charAt(0)==="#"?l:"#"+l),n}function nr(e){var s={};if(e){var n=e.indexOf("#");n>=0&&(s.hash=e.substr(n),e=e.substr(0,n));var a=e.indexOf("?");a>=0&&(s.search=e.substr(a),e=e.substr(0,a)),e&&(s.pathname=e)}return s}const Jg=c.createContext([]);function _c(e){return e.name==="Pushed"||e.name==="Popped"||e.name==="Replaced"}function Kg(e){return e.name==="StepPushed"||e.name==="StepPopped"||e.name==="StepReplaced"}function Gg(e){return _c(e)||Kg(e)}const Rt={IDLE:"idle",PROGRESS:"progress",SUCCEEDED:"succeeded",FAILED:"failed"};function Mc(e){return e===Rt.SUCCEEDED||e===Rt.FAILED}class Qg{targetId;initialSetupProcess;focusCount;previousActivationTrigger;constructor(s,n){this.targetId=s,this.initialSetupProcess=n,this.focusCount=0,this.previousActivationTrigger=null}captureStackChange(s){const n=this.initialSetupProcess.getStatus();if(!Mc(n))return;const a=s.activities.find(i=>i.id===this.targetId);if(!a||!a.isActive)return;const r=s.events.findLast(_c);!r||this.previousActivationTrigger&&r.eventDate<=this.previousActivationTrigger.eventDate||(this.focusCount++,this.previousActivationTrigger=r)}getActivationCount(){return this.focusCount}getTargetId(){return this.targetId}}const{parse:Yg,stringify:Xg}=JSON,{keys:Zg}=Object,Gs=String,Rc="string",lo={},Xr="object",Dc=(e,s)=>s,ev=e=>e instanceof Gs?Gs(e):e,tv=(e,s)=>typeof s===Rc?new Gs(s):s,zc=(e,s,n,a)=>{const r=[];for(let i=Zg(n),{length:l}=i,o=0;o<l;o++){const d=i[o],u=n[d];if(u instanceof Gs){const m=e[u];typeof m===Xr&&!s.has(m)?(s.add(m),n[d]=lo,r.push({k:d,a:[e,s,m,a]})):n[d]=a.call(n,d,m)}else n[d]!==lo&&(n[d]=a.call(n,d,u))}for(let{length:i}=r,l=0;l<i;l++){const{k:o,a:d}=r[l];n[o]=a.call(n,o,zc.apply(null,d))}return n},co=(e,s,n)=>{const a=Gs(s.push(n)-1);return e.set(n,a),a},sv=(e,s)=>{const n=Yg(e,tv).map(ev),a=n[0],r=s||Dc,i=typeof a===Xr&&a?zc(n,new Set,a,r):a;return r.call({"":i},"",i)},nv=(e,s,n)=>{const a=Dc,r=new Map,i=[],l=[];let o=+co(r,i,a.call({"":e},"",e)),d=!o;for(;o<i.length;)d=!0,l[o]=Xg(i[o++],u,n);return"["+l.join(",")+"]";function u(m,p){if(d)return d=!d,p;const x=a.call(this,m,p);switch(typeof x){case Xr:if(x===null)return x;case Rc:return r.get(x)||co(r,i,x)}return x}},Lc="@biochain/plugin-navigation-sync";function Bc(e){return{_TAG:Lc,flattedState:nv({activity:e.activity,step:e.step})}}function av(e){return typeof e=="object"&&e!==null&&"_TAG"in e&&"flattedState"in e&&typeof e._TAG=="string"&&e._TAG===Lc&&typeof e.flattedState=="string"}function bn(e){try{return av(e)?sv(e.flattedState):null}catch{return null}}function uo({history:e,pathname:s,state:n,useHash:a}){const r=a?`${e.location.pathname}#${s}`:s;e.push(r,Bc(n))}function Oa({history:e,pathname:s,state:n,useHash:a}){const r=a?`${e.location.pathname}#${s}`:s;e.replace(r,Bc(n))}function mo(e){return e.length===0?void 0:e[e.length-1]}const rv=e=>{let s=Promise.resolve();return{requestHistoryTick:a=>{s=s.then(()=>new Promise(r=>{const i=e.listen(()=>{i(),r()});a(()=>{i(),r()})}))}}};function Oc(e){return new URL(e,"file://")}function ar(e){const s={};return e.forEach((n,a)=>{s[a]=n}),s}function yn(e){return e.endsWith("/")?e:`${e}/`}function fo(e){return e.toString().length>0?`?${e}`:e}function We({path:e,decode:s},n){const a=e==="*"||e==="/*",r=a?[]:Array.from(e.matchAll(/:([A-Za-z0-9_]+)/g)).map(u=>u[1]).filter(Boolean),i=Array.from(new Set(r)),l=a?Number.POSITIVE_INFINITY:i.length,o=a?"*":yn(e),d=a?null:new URLPattern({pathname:o});return{fill(u){if(a){const h=new URLSearchParams(Object.entries(u).reduce((y,[f,g])=>g?{...y,[f]:g}:y,{}));return yn("/")+fo(h)}let m=e;for(const h of i){const y=u[h];if(y===void 0)throw new Error(`Missing route param: ${h}`);m=m.replace(`:${h}`,encodeURIComponent(y))}m=yn(m);const p={...u};i.forEach(h=>{delete p[h]});const x=new URLSearchParams(Object.entries(p).reduce((h,[y,f])=>({...h,...f?{[y]:f}:null}),{}));return m+fo(x)},parse(u){const m=Oc(u);if(a){const b={...ar(m.searchParams)};return s?s(b):b}if(!d)return null;const p=yn(m.pathname),x=d.exec({pathname:p}),h=ar(m.searchParams);if(!x)return null;const y=x.pathname.groups,f={...h};for(const[g,b]of Object.entries(y))b!==void 0&&(f[g]=b);return s?s(f):f},variableCount:l}}class iv{status;pendingNavigations;dispatchedEvents;baseNavigationEvents;constructor(s,n=[]){this.status=s.length>0?Rt.IDLE:Rt.SUCCEEDED,this.pendingNavigations=s.slice(),this.dispatchedEvents=[],this.baseNavigationEvents=n}captureNavigationOpportunity(s){if(Mc(this.status))return[];if(s&&s.globalTransitionState!=="idle")return[];if(this.pendingNavigations.length===0)return this.status=Rt.SUCCEEDED,[];const n=s?s.events.filter(Gg):[];if(!(this.verifyAllDispatchedEventsAreInNavigationHistory(n)&&this.verifyNoUnknownNavigationEvents(n)))return this.pendingNavigations=[],this.status=Rt.FAILED,[];const a=this.pendingNavigations.shift();if(!a)return[];const r=a();return this.dispatchedEvents.push(...r),this.status=Rt.PROGRESS,r}getStatus(){return this.status}verifyAllDispatchedEventsAreInNavigationHistory(s){const n=new Set(s.map(a=>a.id));return this.dispatchedEvents.every(a=>n.has(a.id))}verifyNoUnknownNavigationEvents(s){const n=new Set([...this.baseNavigationEvents,...this.dispatchedEvents].map(a=>a.id));return s.every(a=>n.has(a.id))}}function ov(e){return typeof e=="string"?{path:e}:e}function lv(e){return(Array.isArray(e)?e:[e]).map(ov)}function cv(e){return Object.keys(e).flatMap(n=>{const a=e[n];return a?lv(a).map(r=>({activityName:n,...r})):[]})}class dv{latestlyBookedSession=Promise.resolve();acquire(){return new Promise(s=>{this.latestlyBookedSession=this.latestlyBookedSession.then(()=>new Promise(n=>s({release:()=>n()})))})}async runExclusively(s){const{release:n}=await this.acquire();try{return await s()}finally{n()}}}class uv{subscribers=[];publishLock=new dv;subscribe(s){return this.subscribers.push(s),()=>{this.subscribers=this.subscribers.filter(n=>n!==s)}}publish(s){const n=this.subscribers.slice();return this.publishLock.runExclusively(()=>Promise.allSettled(n.map(a=>a(s))))}}const mv=c.createContext([]),Zr=e=>t.jsx(mv.Provider,{value:e.routes,children:e.children});Zr.displayName="RoutesProvider";Zr.__docgenInfo={description:"",methods:[],displayName:"RoutesProvider",props:{routes:{required:!0,tsType:{name:"Array",elements:[{name:"ActivityRoute",elements:[{name:"T"}],raw:"ActivityRoute<T>"}],raw:"ActivityRoute<T>[]"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const fv=/^:[\w-]+$/,pv=3,hv=1,xv=10,gv=-2,po=e=>e==="*";function ho(e){const s=e.split("/");let n=s.length;return s.some(po)&&(n+=gv),s.filter(a=>!po(a)).reduce((a,r)=>a+(fv.test(r)?pv:r===""?hv:xv),n)}function vv(e){return[...e].sort((s,n)=>ho(n.path)-ho(s.path))}const bv=1e3,yv=60*bv;function jv(e){"config"in e&&e.config.decorate("historySync",{makeTemplate:We,urlPatternOptions:e.urlPatternOptions});const s=e.history??(typeof window>"u"?Ug({}):Vg({window})),{location:n}=s,a="routes"in e?e.routes:e.config.activities.reduce((i,l)=>({...i,[l.name]:l.route}),{}),r=vv(cv(a));return()=>{let i=0,l=!1,o=null;const d=[],u=new uv,{requestHistoryTick:m}=rv(s),p=f=>u.subscribe(async()=>f());let x=null;const h=()=>{const f=d.map(g=>({activityId:g.getTargetId(),activationCount:g.getActivationCount()}));return(!x||x.length!==f.length||x.some(({activityId:g,activationCount:b})=>f.some(({activityId:v,activationCount:j})=>v===g&&j!==b)))&&(x=f),x},y=f=>{let g=!1;for(const b of d){const v=b.getActivationCount();b.captureStackChange(f),v!==b.getActivationCount()&&(g=!0)}g&&u.publish()};return{key:"plugin-history-sync",wrapStack({stack:f}){const g=c.useSyncExternalStore(p,h,h);return t.jsx(Pc,{requestHistoryTick:m,children:t.jsx(Zr,{routes:r,children:t.jsx(Jg.Provider,{value:g,children:f.render()})})})},overrideInitialEvents({initialContext:f}){const g=bn(s.location.state);if(g)return[{...g.activity.enteredBy,name:"Pushed"},...g.step?.enteredBy.name==="StepPushed"||g.step?.enteredBy.name==="StepReplaced"?[{...g.step.enteredBy,name:"StepPushed"}]:[]];function b(){return f?.req?.path&&typeof f.req.path=="string"?f.req.path:e.useHash?n.hash.split("#")[1]??"/":n.pathname+n.search}const v=b(),j=e.fallbackActivity({initialContext:f}),w=r.find(I=>We(I,e.urlPatternOptions).parse(v)!==null)??r.find(I=>I.activityName===j),M=We(w,e.urlPatternOptions).parse(v)??{},S=Object.entries(M).reduce((I,[P,D])=>(typeof D=="string"&&(I[P]=D),I),{}),A=w.defaultHistory?.(S)??[];return o=new iv([...A.map(({activityName:I,activityParams:P,additionalSteps:D=[]})=>()=>{const E=[{name:"Pushed",id:dt(),activityId:dt(),activityName:I,activityParams:{...P},activityContext:{path:v,lazyActivityComponentRenderContext:{shouldRenderImmediately:!0}}},...D.map(({stepParams:k,hasZIndex:T})=>({name:"StepPushed",id:dt(),stepId:dt(),stepParams:k,hasZIndex:T}))];for(const k of E)k.name==="Pushed"&&d.push(new Qg(k.activityId,o));return E}),()=>[{name:"Pushed",id:dt(),activityId:dt(),activityName:w.activityName,activityParams:We(w,e.urlPatternOptions).parse(v)??ar(Oc(v).searchParams),activityContext:{path:v,lazyActivityComponentRenderContext:{shouldRenderImmediately:!0}}}]]),o.captureNavigationOpportunity(null).map(I=>({...I,eventDate:Date.now()-yv}))},onInit({actions:{getStack:f,dispatchEvent:g,push:b,stepPush:v}}){const j=f(),w=j.activities[0],N=r.find(I=>I.activityName===w.name),M=We(N,e.urlPatternOptions),S=mo(w.steps);m(()=>{l=!0,Oa({history:s,pathname:M.fill(w.params),state:{activity:w,step:S},useHash:e.useHash})});const A=I=>{if(l){l=!1;return}const P=bn(I.location.state);if(!P)return;const D=P.activity,E=P.activity.id,k=P.step,{activities:T}=f(),C=T.find(G=>G.isActive);if(!C)return;const L=mo(C.steps),_=T.find(G=>G.id===E),R=C.steps.find(G=>G.id===k?.id),B=()=>C.id>E,$=()=>C.id<E,K=()=>C.id===E,ee=()=>K()?!!(!k||L&&L.id>k.id):!1,V=()=>K()?!!(!L||k&&L.id<k.id):!1;if(B()&&(g("Popped",{}),!_&&(i+=1,b({...D.enteredBy}),k?.enteredBy.name==="StepPushed"||k?.enteredBy.name==="StepReplaced"))){const{enteredBy:G}=k;i+=1,v({...G})}if(ee()){if(!R&&k&&(k?.enteredBy.name==="StepPushed"||k?.enteredBy.name==="StepReplaced")){const{enteredBy:G}=k;i+=1,v({...G})}g("StepPopped",{})}if($()&&(i+=1,b({activityId:D.id,activityName:D.name,activityParams:D.params})),V()){if(!k)return;i+=1,v({stepId:k.id,stepParams:k.params})}};s.listen(A),o?.captureNavigationOpportunity(j).forEach(I=>I.name==="Pushed"?b(I):v(I)),y(j)},onPushed({effect:{activity:f}}){if(i){i-=1;return}const g=r.find(v=>v.activityName===f.name),b=We(g,e.urlPatternOptions);m(()=>{l=!0,uo({history:s,pathname:b.fill(f.params),state:{activity:f},useHash:e.useHash})})},onStepPushed({effect:{activity:f,step:g}}){if(i){i-=1;return}const b=r.find(j=>j.activityName===f.name),v=We(b,e.urlPatternOptions);m(()=>{l=!0,uo({history:s,pathname:v.fill(f.params),state:{activity:f,step:g},useHash:e.useHash})})},onReplaced({effect:{activity:f}}){if(!f.isActive)return;const g=r.find(v=>v.activityName===f.name),b=We(g,e.urlPatternOptions);m(()=>{l=!0,Oa({history:s,pathname:b.fill(f.params),state:{activity:f},useHash:e.useHash})})},onStepReplaced({effect:{activity:f,step:g}}){if(!f.isActive)return;const b=r.find(j=>j.activityName===f.name),v=We(b,e.urlPatternOptions);m(()=>{l=!0,Oa({history:s,pathname:v.fill(f.params),state:{activity:f,step:g},useHash:e.useHash})})},onBeforePush({actionParams:f,actions:{overrideActionParams:g}}){if(!f.activityContext||!("path"in f.activityContext)){const b=r.find(w=>w.activityName===f.activityName),j=We(b,e.urlPatternOptions).fill(f.activityParams);g({...f,activityContext:{...f.activityContext,path:j}})}},onBeforeReplace({actionParams:f,actions:{overrideActionParams:g,getStack:b}}){if(!f.activityContext||!("path"in f.activityContext)){const N=r.find(A=>A.activityName===f.activityName),S=We(N,e.urlPatternOptions).fill(f.activityParams);g({...f,activityContext:{...f.activityContext,path:S}})}const{activities:v}=b(),j=v.filter(N=>N.transitionState==="enter-active"||N.transitionState==="enter-done"),w=j.length>0?j[j.length-1]:null;if(w)for(let N=0;N<w.steps.length-1;N+=1)m(M=>{bn(s.location.state)?M():(l=!0,s.back())}),m(()=>{l=!0,s.back()})},onBeforeStepPop({actions:{getStack:f}}){const{activities:g}=f();(g.find(v=>v.isActive)?.steps.length??0)>1&&m(()=>{l=!0,s.back()})},onBeforePop({actions:{getStack:f}}){const{activities:g}=f(),b=g.find(v=>v.isActive);if(b){const{isRoot:v,steps:j}=b,w=v?0:j.length;for(let N=0;N<w;N+=1)m(M=>{bn(s.location.state)?M():(l=!0,s.back())}),m(()=>{l=!0,s.back()})}},onChanged({actions:{getStack:f,push:g,stepPush:b}}){const v=f();o?.captureNavigationOpportunity(v).forEach(j=>j.name==="Pushed"?g(j):b(j)),y(v)}}}}function Fc(){const{t:e}=F(["settings","common"]),[s,n]=c.useState(!1),a=()=>{n(!0);const r="./";window.location.href=`${r}clear.html`};return t.jsx("div",{className:"flex min-h-screen flex-col items-center justify-center bg-background p-6",children:t.jsxs("div",{className:"flex flex-col items-center gap-6 text-center max-w-sm",children:[t.jsx("div",{className:"bg-destructive/10 flex size-20 items-center justify-center rounded-full",children:t.jsx(qe,{className:"text-destructive size-10"})}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("h1",{className:"text-xl font-bold",children:e("settings:storage.migrationRequired","")}),t.jsx("p",{className:"text-muted-foreground text-sm",children:e("settings:storage.migrationDesc","")})]}),t.jsx("div",{className:"bg-destructive/5 rounded-lg p-4 w-full",children:t.jsxs("ul",{className:"text-destructive space-y-2 text-sm text-left",children:[t.jsxs("li",{children:[" ",e("settings:clearData.item1","")]}),t.jsxs("li",{children:[" ",e("settings:clearData.item2","")]}),t.jsxs("li",{children:[" ",e("settings:clearData.item3","")]})]})}),t.jsxs(q,{variant:"destructive",onClick:a,className:"w-full gap-2",disabled:s,children:[t.jsx(Qt,{className:"size-4"}),e("settings:clearData.confirm","")]})]})})}Fc.__docgenInfo={description:`


 Stackflow context  useFlow()`,methods:[],displayName:"MigrationRequiredView"};const Nv={all:["balance"],wallet:e=>["balance",e],chain:(e,s)=>["balance",e,s]};function wv(e,s){return nn({queryKey:Nv.chain(e??"",s??""),queryFn:async()=>!e||!s?[]:(await ye.refreshBalance(e,s),(await Ln(async()=>{const{walletStore:i}=await Promise.resolve().then(()=>ph);return{walletStore:i}},void 0,import.meta.url)).walletStore.state.wallets.find(i=>i.id===e)?.chainAddresses.find(i=>i.chain===s)?.tokens??[]),enabled:!!e&&!!s,staleTime:30*1e3,gcTime:300*1e3,refetchInterval:60*1e3,refetchIntervalInBackground:!1,refetchOnWindowFocus:!0})}const xo={all:["transactionHistory"],wallet:e=>["transactionHistory",e],filtered:(e,s)=>["transactionHistory",e,s]};function Sv(e){return{id:e.id,type:e.type,status:e.status,amount:e.amount,symbol:e.symbol,address:e.address,timestamp:e.timestamp,hash:e.hash,chain:e.chain,fee:e.fee,feeSymbol:e.feeSymbol,feeDecimals:e.feeDecimals,blockNumber:e.blockNumber,confirmations:e.confirmations,from:e.from,to:e.to,action:e.action,direction:e.direction,assets:e.assets,contract:e.contract}}function ei(e){const[s,n]=c.useState({chain:"all",period:"all"}),a=lm(),r=nn({queryKey:xo.filtered(e??"",s),queryFn:async()=>{if(!e)return[];const l={chain:s.chain??"all",period:s.period??"all",type:void 0,status:void 0};return(await Ko.getHistory({walletId:e,filter:l})).map(Sv)},enabled:!!e,staleTime:30*1e3,gcTime:300*1e3,refetchOnWindowFocus:!0}),i=async()=>{await a.invalidateQueries({queryKey:xo.wallet(e??"")})};return{transactions:r.data??[],isLoading:r.isLoading,isFetching:r.isFetching,error:r.error?.message,filter:s,setFilter:n,refresh:i}}const Cv={all:["addressBalance"],query:(e,s)=>["addressBalance",e,s]};function kv(e,s,n=!0){return nn({queryKey:Cv.query(e,s),queryFn:async()=>{if(!e||!s)return{balance:null,error:"Missing chain or address"};try{const a=Ss(e);if(!a.supportsNativeBalance)return{balance:null,error:`Chain ${e} does not support balance query`};const r=a.getNativeBalance;return r?{balance:await r(s),error:null}:{balance:null,error:`No balance provider for chain: ${e}`}}catch(a){return{balance:null,error:a instanceof Error?a.message:String(a)}}},enabled:n&&!!e&&!!s,staleTime:30*1e3,gcTime:300*1e3})}const Av={all:["addressTransactions"],address:(e,s)=>["addressTransactions",e,s]};function Iv({chainId:e,address:s,limit:n=20,enabled:a=!0}){return nn({queryKey:Av.address(e,s),queryFn:async()=>{if(!e||!s)return[];const r=Ss(e);if(!r.supportsTransactionHistory)return console.warn(`[useAddressTransactionsQuery] Chain ${e} does not support transaction history`),[];const i=r.getTransactionHistory;return i?i(s,n):[]},enabled:a&&!!e&&!!s.trim(),staleTime:30*1e3,gcTime:300*1e3})}const go={ethereum:"Ethereum",bitcoin:"Bitcoin",tron:"Tron",binance:"BSC",bfmeta:"BFMeta",ccchain:"CCChain",pmchain:"PMChain",bfchainv2:"BFChain V2",btgmeta:"BTGMeta",biwmeta:"BIWMeta",ethmeta:"ETHMeta",malibu:"Malibu"};function Wc(){const{push:e}=se(),s=Mr(),n=Zt(),a=Rr(),{t:r}=F(["home","wallet","common","transaction"]),i=zo(),l=El(),o=Pl(),d=Xt(),u=Le(),m=u?.id??null,p=At(),x=Al(),h=go[p]??p,y=Il();Ho();const[f,g]=c.useState("assets"),{isFetching:b}=wv(u?.id,p),{transactions:v,isLoading:j,setFilter:w}=ei(u?.id);c.useEffect(()=>{w(T=>({...T,chain:p}))},[p,w]);const N=c.useCallback(async T=>{await s.write({text:T}),await a.impact("light"),n.show(r("home:wallet.addressCopied"))},[s,a,n,r]),M=c.useCallback(T=>{T!==m&&ye.setCurrentWallet(T),e("ChainSelectorJob",{})},[e,m]),S=c.useCallback(T=>{const C=d.find(L=>L.id===T);C&&e("WalletConfigActivity",{walletId:T,walletName:C.name})},[e,d]),A=c.useCallback(T=>{ye.setCurrentWallet(T)},[]),I=c.useCallback(()=>{e("WalletAddJob",{})},[e]),P=c.useCallback(()=>{e("WalletListJob",{})},[e]),D=c.useCallback(()=>{e("AddressBalanceActivity",{})},[e]),E=c.useCallback(()=>{e("AddressTransactionsActivity",{})},[e]),k=c.useCallback(T=>{T.id&&e("TransactionDetailActivity",{txId:T.id})},[e]);return i?t.jsx(Fc,{}):l?!o||!u?t.jsx(Tv,{}):t.jsxs("div",{"data-testid":"wallet-home",className:"flex h-full flex-col overflow-y-auto bg-background",children:[t.jsxs("div",{className:"pt-2 pb-1",children:[t.jsx(mm,{wallets:d,currentWalletId:m,selectedChain:p,chainPreferences:x,chainNames:go,onWalletChange:A,onCopyAddress:N,onOpenChainSelector:M,onOpenSettings:S,onOpenWalletList:P,onAddWallet:I,onOpenAddressBalance:D,onOpenAddressTransactions:E}),t.jsxs("div",{className:"mt-2 flex justify-center gap-8 px-6",children:[t.jsxs("button",{onClick:()=>e("SendActivity",{}),"data-testid":"wallet-home-send-button",className:"group flex flex-col items-center gap-1.5",children:[t.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:t.jsx(Cl,{className:"size-5"})}),t.jsx("span",{className:"text-xs font-medium",children:r("home:wallet.send")})]}),t.jsxs("button",{onClick:()=>e("ReceiveActivity",{}),"data-testid":"wallet-home-receive-button",className:"group flex flex-col items-center gap-1.5",children:[t.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:t.jsx(ah,{className:"size-5"})}),t.jsx("span",{className:"text-xs font-medium",children:r("home:wallet.receive")})]}),t.jsxs("button",{onClick:()=>e("ScannerActivity",{}),"data-testid":"wallet-home-scan-button",className:"group flex flex-col items-center gap-1.5",children:[t.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:t.jsx($m,{className:"size-5"})}),t.jsx("span",{className:"text-xs font-medium",children:r("common:a11y.scan")})]})]})]}),t.jsx("div",{className:"flex-1 pt-3",children:t.jsx(Rm,{activeTab:f,onTabChange:g,className:"h-full",testIdPrefix:"wallet-home-content-tabs",children:T=>T==="assets"?t.jsx("div",{className:"p-4","data-testid":"wallet-home-assets-panel",children:t.jsx(_m,{tokens:y.map(C=>({symbol:C.symbol,name:C.name,chain:p,balance:C.balance,decimals:C.decimals,fiatValue:C.fiatValue?String(C.fiatValue):void 0,change24h:C.change24h,icon:C.icon})),refreshing:b,onTokenClick:C=>{console.log("Token clicked:",C.symbol)},emptyTitle:r("home:wallet.noAssets"),emptyDescription:r("home:wallet.noAssetsOnChain",{chain:h}),testId:"token-list"})}):t.jsxs("div",{className:"p-4","data-testid":"wallet-home-history-panel",children:[t.jsx(gr,{transactions:v.slice(0,5),loading:j,onTransactionClick:k,emptyTitle:r("transaction:history.emptyTitle"),emptyDescription:r("transaction:history.emptyDesc"),testId:"transaction-list"}),t.jsx("button",{onClick:()=>e("HistoryActivity",{chain:v.length>0?p:"all"}),className:"mt-3 w-full rounded-lg bg-muted/60 py-2.5 text-sm font-medium text-muted-foreground transition-colors hover:bg-muted",children:v.length>0?r("transaction:history.viewAll",{count:v.length}):r("transaction:history.viewAllChains")})]})})}),t.jsx("div",{className:"shrink-0 h-[var(--tab-bar-height)]"})]}):t.jsx("div",{className:"flex h-full items-center justify-center",children:t.jsx(_e,{size:"lg"})})}function Tv(){const{push:e}=se(),{t:s}=F("home");return t.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-6 p-6 text-center",children:[t.jsx("div",{className:"bg-primary/10 rounded-full p-6",children:t.jsx(kt,{className:"text-primary size-12"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold",children:s("welcome.title")}),t.jsx("p",{className:"text-muted-foreground mt-2",children:s("welcome.subtitle")})]}),t.jsxs("div",{className:"flex w-full max-w-xs flex-col gap-3",children:[t.jsx(et,{variant:"mint",className:"w-full","data-testid":"create-wallet-button",onClick:()=>e("WalletCreateActivity",{}),children:s("welcome.createWallet")}),t.jsx(q,{variant:"outline",className:"w-full","data-testid":"import-wallet-button",onClick:()=>e("OnboardingRecoverActivity",{}),children:s("welcome.importWallet")})]})]})}Wc.__docgenInfo={description:"",methods:[],displayName:"WalletTab"};const Pv=br(["defi","nft","tools","games","social","exchange","other"]),Ev=yr([ut(!0),gs({timeout:Jt().int().positive().optional()}).passthrough()]),_v=br(["auto","dark","light"]),Mv=br(["stack","mine"]),$c=gs({id:H(),name:H(),description:H(),longDescription:H().optional(),icon:H(),url:H(),version:H(),author:H().optional(),website:H().optional(),category:Pv.optional(),tags:mt(H()).optional(),permissions:mt(H()).optional(),chains:mt(H()).optional(),screenshots:mt(H()).optional(),minWalletVersion:H().optional(),publishedAt:H().optional(),updatedAt:H().optional(),beta:ft().optional(),officialScore:Jt().min(0).max(100).optional(),communityScore:Jt().min(0).max(100).optional(),splashScreen:Ev.optional(),capsuleTheme:_v.optional(),targetDesktop:Mv.optional(),themeColor:H().optional(),themeColorFrom:H().optional(),themeColorTo:H().optional()}).passthrough(),Hc=gs({name:H(),version:H(),updated:H(),icon:H().optional(),search:gs({urlTemplate:H()}).passthrough().optional(),apps:mt($c)}).passthrough();gs({version:H(),data:mt($c)}).passthrough();const Rv="bfm_ecosystem",Dv=1,Ns="ecosystem_source_payloads",zv=gs({url:H(),etag:H().optional(),lastUpdated:H(),payload:Hc});let jn=null,zs=null;function Lv(){if(typeof indexedDB>"u")throw new Error("indexedDB is not available in this environment")}function Bv(e){return new Promise((s,n)=>{e.onsuccess=()=>s(e.result),e.onerror=()=>n(e.error??new Error("IndexedDB request failed"))})}function qc(e){return new Promise((s,n)=>{e.oncomplete=()=>s(),e.onerror=()=>n(e.error??new Error("IndexedDB transaction failed")),e.onabort=()=>n(e.error??new Error("IndexedDB transaction aborted"))})}async function Vc(){if(Lv(),jn)return jn;if(zs)return zs;zs=new Promise((e,s)=>{const n=indexedDB.open(Rv,Dv);n.onupgradeneeded=()=>{const a=n.result;a.objectStoreNames.contains(Ns)||a.createObjectStore(Ns,{keyPath:"url"})},n.onsuccess=()=>e(n.result),n.onerror=()=>s(n.error??new Error("Failed to open IndexedDB"))});try{return jn=await zs,jn}finally{zs=null}}async function Ov(e){const n=(await Vc()).transaction([Ns],"readwrite");n.objectStore(Ns).put(e),await qc(n)}async function Uc(e){const n=(await Vc()).transaction([Ns],"readonly"),a=n.objectStore(Ns),r=await Bv(a.get(e));await qc(n);const i=zv.safeParse(r);return i.success?i.data:(console.warn("[EcosystemStorage] Invalid source payload record:",i.error.issues[0]),null)}const Fv=15,Wv=1440*60*1e3;function $v(e){return Math.floor(e.getTime()/Wv)}function Hv(e=new Date){const s=$v(e);return Fv*(s+1)%100}function vo(e,s=new Date){const n=typeof e.officialScore=="number"?e.officialScore:0,a=typeof e.communityScore=="number"?e.communityScore:0,r=Hv(s),i=100-r;return(n*r+a*i)/100}function qv(e){const s=typeof document<"u"?document.baseURI:"file:///",n=new URL(e,s).toString();return a=>a.startsWith("http://")||a.startsWith("https://")||a.startsWith("data:")?a:new URL(a,n).toString()}const Vv=1e4;let qt=[];const Dn=[];function Jc(){const e=[...qt];Dn.forEach(s=>s(e))}function Uv(e){return Dn.push(e),()=>{const s=Dn.indexOf(e);s>=0&&Dn.splice(s,1)}}function Jv(e){return/^[a-z0-9]+(?:\.[a-z0-9-]+)+$/i.test(e)}function Kc(e,s,n){if(!Jv(e.id))return console.warn(`[Registry] Invalid appId "${e.id}" from source "${s.url}", skipping`),null;const a=qv(s.url);return{...e,icon:a(e.icon),url:a(e.url),screenshots:e.screenshots?.map(a),splashScreen:e.splashScreen,sourceUrl:s.url,sourceName:s.name,sourceIcon:s.icon??(n.icon?a(n.icon):void 0)}}function Kv(e,s,n=Vv){const a=new AbortController,r=setTimeout(()=>a.abort(),n);return fetch(e,{...s,signal:a.signal}).finally(()=>clearTimeout(r))}async function Gv(e,s){const n=await Uc(e),a=s?void 0:n?.etag;try{const r=await Kv(e,{method:"GET",headers:{Accept:"application/json",...a!==void 0?{"If-None-Match":a}:{}}});if(r.status===304)return n?.payload??null;if(!r.ok)return console.warn(`[Registry] Failed to fetch source: ${e}`,r.status,r.statusText),n?.payload??null;const i=await r.json(),l=Hc.safeParse(i);if(!l.success)return console.warn(`[Registry] Invalid source JSON: ${e}`,l.error),n?.payload??null;const o=l.data,d=r.headers.get("ETag")??void 0;return await Ov({url:e,payload:o,...d!==void 0?{etag:d}:{},lastUpdated:new Date().toISOString()}),o}catch(r){const i=r instanceof Error&&r.name==="AbortError"?"request timeout":r instanceof Error?r.message:String(r);return console.warn(`[Registry] Error fetching source: ${e}`,i),n?.payload??null}}async function Gc(){const e=Go.getEnabledSources(Js.state),s=await Promise.all(e.map(async r=>{const i=await Uc(r.url);return{source:r,cached:i}})),n=[],a=new Set;for(const{source:r,cached:i}of s){const l=i?.payload;if(l)for(const o of l.apps??[]){const d=Kc(o,r,l);if(d){if(a.has(d.id)){console.warn(`[Registry] Duplicate appId "${d.id}" detected, skipping later entry`);continue}a.add(d.id),n.push(d)}}}qt=n,Jc()}let bo="";Js.subscribe(()=>{const e=JSON.stringify(Js.state.sources);e!==bo&&(bo=e,Gc())});async function Qc(e){await Gc(),e?.refresh===!0&&ti({force:!1})}async function ti(e){const s=e?.force===!0,n=Go.getEnabledSources(Js.state),a=await Promise.all(n.map(async l=>{const o=await Gv(l.url,s);return o&&fs.updateSourceTimestamp(l.url),{source:l,payload:o}})),r=[],i=new Set;for(const{source:l,payload:o}of a)if(o)for(const d of o.apps??[]){const u=Kc(d,l,o);if(u){if(i.has(u.id)){console.warn(`[Registry] Duplicate appId "${u.id}" detected, skipping later entry`);continue}i.add(u.id),r.push(u)}}return qt=r,Jc(),console.log(`[Registry] Loaded ${qt.length} apps from ${n.length} sources`),[...qt]}function Qv(){return[...qt]}function yo(e){return qt.find(s=>s.id===e)}const Yc="ecosystem_my_apps",Yv={teleport:"xin.dweb.teleport",forge:"xin.dweb.forge"};function un(e){return Yv[e]??e}function Vt(){try{const e=localStorage.getItem(Yc),s=e?JSON.parse(e):[],n=s.map(a=>({...a,appId:un(a.appId)}));return JSON.stringify(s)!==JSON.stringify(n)&&ga(n),n}catch{return[]}}function ga(e){localStorage.setItem(Yc,JSON.stringify(e))}function Xv(e){return Vt().some(s=>s.appId===un(e))}function Xc(e){e=un(e);const s=Vt();s.some(n=>n.appId===e)||(s.unshift({appId:e,installedAt:Date.now(),lastUsedAt:Date.now()}),ga(s))}function Zc(e){e=un(e);const s=Vt(),n=s.find(a=>a.appId===e);n&&(n.lastUsedAt=Date.now(),ga(s))}function Zv(e){e=un(e);const s=Vt().filter(n=>n.appId!==e);ga(s)}function ed(){const{push:e}=se(),s=c.useRef(null),[n,a]=c.useState([]),[r,i]=c.useState([]),[l,o]=c.useState(!0);c.useEffect(()=>{const f=Uv(g=>a(g));return Qc({refresh:!0}).then(()=>{a(Qv()),i(Vt()),o(!1)}),()=>f()},[]),Vm();const d=c.useCallback(f=>{e("MiniappDetailActivity",{appId:encodeURIComponent(f.id)})},[e]),u=c.useCallback(f=>{Xc(f.id),Zc(f.id),i(Vt()),fs.setActiveSubPage("mine"),s.current?.slideTo("mine"),requestAnimationFrame(()=>{Qo(f.id,{...f,targetDesktop:"mine"})})},[]),m=c.useCallback(f=>{Zv(f),i(Vt())},[]),p=c.useMemo(()=>r.map(f=>({...f,app:n.find(g=>g.id===f.appId)})).filter(f=>!!f.app).map(({app:f,lastUsedAt:g})=>({app:f,lastUsed:g})),[r,n]),x=c.useMemo(()=>n.length===0?[]:[...n].sort((f,g)=>vo(g)-vo(f)).slice(0,2),[n]),h=c.useMemo(()=>{const f=new Set(x.map(g=>g.id));return[...n].filter(g=>!f.has(g.id)).sort((g,b)=>(b.officialScore??0)-(g.officialScore??0)).slice(0,6)},[n,x]),y=c.useMemo(()=>[...n].sort((f,g)=>(g.communityScore??0)-(f.communityScore??0)).slice(0,10),[n]);return l?t.jsx("div",{className:"flex h-full items-center justify-center",children:t.jsx(_e,{size:"lg"})}):t.jsx(Zm,{ref:s,showDiscoverPage:!0,showStackPage:"auto",apps:n,myApps:p,featuredApps:x,recommendedApps:h,hotApps:y,onAppOpen:u,onAppDetail:d,onAppRemove:m})}ed.__docgenInfo={description:"",methods:[],displayName:"EcosystemTab"};function Ee({icon:e,label:s,value:n,showChevron:a=!0,disabled:r=!1,onClick:i,trailing:l,className:o,testId:d}){const u=i?"button":"div";return t.jsxs(u,{type:i?"button":void 0,onClick:r?void 0:i,disabled:r,"data-testid":d,className:z("bg-background flex w-full items-center gap-3 rounded-xl px-4 py-3.5","transition-colors",i&&!r&&"hover:bg-muted/50 active:bg-muted",r&&"cursor-not-allowed",o),children:[e&&t.jsx("span",{className:"bg-muted text-foreground flex size-8 shrink-0 items-center justify-center rounded-lg",children:e}),t.jsx("span",{className:z("flex-1 text-left text-sm font-medium",r&&"text-muted-foreground"),children:s}),l??t.jsxs(t.Fragment,{children:[n&&t.jsx("span",{className:"text-muted-foreground text-sm",children:n}),a&&i&&t.jsx(Be,{className:"text-muted-foreground/50 size-5"})]})]})}Ee.__docgenInfo={description:"",methods:[],displayName:"SettingsItem",props:{icon:{required:!1,tsType:{name:"union",raw:"ReactNode | undefined",elements:[{name:"ReactNode"},{name:"undefined"}]},description:""},label:{required:!0,tsType:{name:"string"},description:""},value:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},showChevron:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"",defaultValue:{value:"true",computed:!1}},disabled:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"",defaultValue:{value:"false",computed:!1}},onClick:{required:!1,tsType:{name:"union",raw:"(() => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},trailing:{required:!1,tsType:{name:"union",raw:"ReactNode | undefined",elements:[{name:"ReactNode"},{name:"undefined"}]},description:""},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:" className"},testId:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:" ID"}}};function Bs({title:e,children:s,className:n}){return t.jsxs("section",{className:z("space-y-1",n),children:[e&&t.jsx("h3",{className:"mb-2 px-1 text-xs font-medium uppercase text-muted-foreground",children:e}),t.jsx("div",{className:"overflow-hidden rounded-xl bg-card shadow-sm",children:s})]})}Bs.__docgenInfo={description:"",methods:[],displayName:"SettingsSection",props:{title:{required:!1,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},className:{required:!1,tsType:{name:"string"},description:" className"}}};const eb=[{value:"system",icon:$p},{value:"light",icon:mh},{value:"dark",icon:Qp}];function td({open:e,onOpenChange:s}){const{t:n}=F("settings"),a=hr(),r=i=>{tn.setTheme(i),s(!1)};return t.jsx(Ot,{open:e,onOpenChange:s,children:t.jsxs(Ft,{side:"bottom",className:"rounded-t-2xl",children:[t.jsx(Wt,{children:t.jsx($t,{children:n("appearance.title")})}),t.jsx("div",{className:"mt-4 space-y-2",children:eb.map(({value:i,icon:l})=>t.jsxs("button",{onClick:()=>r(i),className:z("flex w-full items-center gap-3 rounded-xl p-4 transition-colors",a===i?"bg-primary/10 text-primary":"hover:bg-muted"),children:[t.jsx(l,{size:24}),t.jsx("span",{className:"flex-1 text-left font-medium",children:n(`appearance.${i}`)}),a===i&&t.jsx(je,{size:20})]},i))})]})})}td.__docgenInfo={description:"",methods:[],displayName:"AppearanceSheet",props:{open:{required:!0,tsType:{name:"boolean"},description:""},onOpenChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(open: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"open"}],return:{name:"void"}}},description:""}}};function va(e){const s=e.apis.find(r=>r.type==="biowallet-v1"),n=s?.endpoint??null,a=s?.config?.path??e.id;return{apiUrl:n,apiPath:a}}async function tb(e,s){return{amount:(await Xo(e).transaction.estimateFee({from:s,to:s,amount:Me.fromRaw("1",e.decimals,e.symbol)})).standard.amount,symbol:e.symbol}}async function sb(e,s){const a=await Xo(e).asset.getNativeBalance(s);return{assetType:a.symbol,name:e.name,amount:a.amount,decimals:a.amount.decimals}}async function jo({chainConfig:e,walletId:s,password:n,fromAddress:a,toAddress:r,amount:i,twoStepSecret:l}){let o;try{o=await ur.getMnemonic(s,n)}catch(m){return m instanceof mr&&m.code===fr.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:m instanceof Error?m.message:""}}if(!i.isPositive())return{status:"error",message:""};const{apiUrl:d,apiPath:u}=va(e);if(!d)return{status:"error",message:"API URL "};try{console.log("[submitBioforestTransfer] Starting transfer:",{apiUrl:d,apiPath:u,fromAddress:a,toAddress:r,amount:i.toRawString()});const m=await vr(d,u,a);if(console.log("[submitBioforestTransfer] Address info:",{hasSecondPubKey:!!m.secondPublicKey}),m.secondPublicKey&&!l)return console.log("[submitBioforestTransfer] Pay password required"),{status:"password_required",secondPublicKey:m.secondPublicKey};if(l&&m.secondPublicKey){console.log("[submitBioforestTransfer] Verifying pay password...");const h=await Bm(e.id,o,l,m.secondPublicKey);if(console.log("[submitBioforestTransfer] Pay password verification result:",h),!h)return{status:"error",message:""}}console.log("[submitBioforestTransfer] Creating transaction...");const p=await Om({rpcUrl:d,chainId:e.id,apiPath:u,mainSecret:o,paySecret:l,from:a,to:r,amount:i.toRawString(),assetType:e.symbol}),x=p.signature;return console.log("[submitBioforestTransfer] Transaction created:",x?.slice(0,20)),console.log("[submitBioforestTransfer] Broadcasting..."),await Fm(d,u,p).catch(h=>{console.warn("[submitBioforestTransfer] Broadcast warning (may still succeed):",h.message)}),console.log("[submitBioforestTransfer] SUCCESS! txHash:",x),{status:"ok",txHash:x}}catch(m){console.error("[submitBioforestTransfer] FAILED:",m);const p=m instanceof Error?m.message:String(m);return p.includes("insufficient")||p.includes("")?{status:"error",message:""}:p.includes("fee")||p.includes("")?{status:"error",message:""}:{status:"error",message:p||""}}}async function nb({chainConfig:e,walletId:s,password:n,fromAddress:a,newTwoStepSecret:r}){let i;try{i=await ur.getMnemonic(s,n)}catch(d){return d instanceof mr&&d.code===fr.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:d instanceof Error?d.message:""}}const{apiUrl:l,apiPath:o}=va(e);if(!l)return{status:"error",message:"API URL "};try{if((await vr(l,o,a)).secondPublicKey)return{status:"already_set"};console.log("[submitSetTwoStepSecret] Creating signature transaction...");const u=await Lm({rpcUrl:l,chainId:e.id,apiPath:o,mainSecret:i,newPaySecret:r});return console.log("[submitSetTwoStepSecret] Pay password set successfully:",u.txHash),{status:"ok",txHash:u.txHash}}catch(d){console.error("[submitSetTwoStepSecret] Failed to set pay password:",d);const u=d instanceof Error?d.message:String(d);return u.includes("fee")||u.includes("")?{status:"error",message:""}:{status:"error",message:u||""}}}async function ab(e){const{apiUrl:s,apiPath:n}=va(e);if(!s)return null;try{const a=await zm(s,n,e.id);return{amount:Me.fromRaw(a,e.decimals,e.symbol),symbol:e.symbol}}catch(a){return console.error("[getSetTwoStepSecretFee] Failed to get fee:",a),null}}async function rb(e,s){const{apiUrl:n,apiPath:a}=va(e);if(!n)return!1;try{return!!(await vr(n,a,s)).secondPublicKey}catch{return!1}}const ge=Mg,sd=Lg;function Kn({title:e,children:s,className:n}){return t.jsxs("div",{className:z("bg-background rounded-t-2xl",n),children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e&&t.jsx("div",{className:"border-b border-border px-4 pb-4",children:t.jsx("h2",{className:"text-center text-lg font-semibold",children:e})}),s,t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}Kn.__docgenInfo={description:"Standard sheet content wrapper with handle, title, and safe area",methods:[],displayName:"SheetContent",props:{title:{required:!1,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const ib={ethereum:"Ethereum",bitcoin:"Bitcoin",tron:"Tron",binance:"BSC",bfmeta:"BFMeta",ccchain:"CCChain",pmchain:"PMChain",bfchainv2:"BFChain V2",btgmeta:"BTGMeta",biwmeta:"BIWMeta",ethmeta:"ETHMeta",malibu:"Malibu"};function ob(e,s=10,n=8){return e.length<=s+n+3?e:`${e.slice(0,s)}...${e.slice(-n)}`}const nd=()=>{const{t:e}=F(["home","common"]),{pop:s}=se(),n=Le(),a=At(),r=Tl(),i=l=>{ye.setSelectedChain(l),s()};return t.jsx(ge,{children:t.jsxs("div",{className:"bg-background rounded-t-2xl",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),t.jsx("div",{className:"border-b border-border px-4 pb-4",children:t.jsx("h2",{className:"text-center text-lg font-semibold",children:e("home:wallet.selectNetwork")})}),t.jsx("div",{"data-testid":"chain-sheet",className:"max-h-[60vh] space-y-2 overflow-y-auto p-4",children:r.map(l=>{const o=n?.chainAddresses.find(d=>d.chain===l);return t.jsxs("button",{"data-testid":`chain-option-${l}`,onClick:()=>i(l),className:`flex w-full items-center gap-3 rounded-xl p-4 transition-colors ${l===a?"bg-primary/10 ring-1 ring-primary":"bg-muted/50 hover:bg-muted"}`,children:[t.jsx(vs,{chain:l,size:"md"}),t.jsxs("div",{className:"flex-1 text-left",children:[t.jsx("div",{className:"font-medium",children:ib[l]??l}),t.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:o?.address?ob(o.address):"---"})]}),l===a&&t.jsx(je,{className:"size-5 text-primary"})]},l)})}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};nd.__docgenInfo={description:"",methods:[],displayName:"ChainSelectorJob"};const No={"/":"MainTabsActivity","/wallet/list":"WalletListActivity","/wallet/create":"WalletCreateActivity","/send":"SendActivity","/receive":"ReceiveActivity","/settings":"SettingsActivity","/settings/language":"SettingsLanguageActivity","/settings/currency":"SettingsCurrencyActivity","/settings/chains":"SettingsChainsActivity","/settings/mnemonic":"SettingsMnemonicActivity","/settings/wallet-lock":"SettingsWalletLockActivity","/settings/wallet-chains":"SettingsWalletChainsActivity","/settings/storage":"SettingsStorageActivity","/history":"HistoryActivity","/scanner":"ScannerActivity","/onboarding/recover":"OnboardingRecoverActivity","/address-book":"AddressBookActivity","/notifications":"NotificationsActivity","/staking":"StakingActivity","/welcome":"WelcomeActivity"},lb=[{pattern:/^\/wallet\/([^/]+)$/,activity:"WalletConfigActivity",paramExtractor:e=>({walletId:e[1]??""})},{pattern:/^\/transaction\/([^/]+)$/,activity:"TransactionDetailActivity",paramExtractor:e=>({txId:e[1]??""})},{pattern:/^\/authorize\/address\/([^/]+)$/,activity:"AuthorizeAddressActivity",paramExtractor:e=>({id:e[1]??""})},{pattern:/^\/authorize\/signature\/([^/]+)$/,activity:"AuthorizeSignatureActivity",paramExtractor:e=>({id:e[1]??""})},{pattern:/^\/token\/([^/]+)$/,activity:"TokenDetailActivity",paramExtractor:e=>({tokenId:e[1]??""})}];function cb(e){if(No[e])return{activity:No[e],params:{}};for(const{pattern:s,activity:n,paramExtractor:a}of lb){const r=e.match(s);if(r)return{activity:n,params:a(r)}}return null}function fe(){const e=se();return{navigate:a=>{const r=typeof a=="string"?{to:a}:a,i=cb(r.to);if(!i){console.warn(`[useNavigation] Unknown route: ${r.to}`);return}const l={...i.params,...r.search??{}};r.replace?e.replace(i.activity,l,{animate:!0}):e.push(i.activity,l,{animate:!0})},goBack:()=>{e.pop()}}}const ad=c.createContext({});function he({params:e,children:s}){return t.jsx(ad.Provider,{value:e,children:s})}function be(){return c.useContext(ad)}he.__docgenInfo={description:"",methods:[],displayName:"ActivityParamsProvider",props:{params:{required:!0,tsType:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""}}};function db(){const{t:e}=F("wallet"),{pop:s}=se(),{walletId:n}=be(),r=Xt().find(u=>u.id===n),[i,l]=c.useState(r?.name??"");c.useEffect(()=>{r&&l(r.name)},[r]);const o=c.useCallback(()=>{if(!r)return;const u=i.trim();u&&(ye.updateWalletName(r.id,u),s())},[r,i,s]);if(!r)return null;const d=i.trim().length>0&&i.trim()!==r.name;return t.jsx(ge,{children:t.jsxs("div",{className:"bg-background rounded-t-2xl",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),t.jsx("div",{className:"border-b border-border px-4 pb-4",children:t.jsx("h2",{className:"text-center text-lg font-semibold",children:e("editSheet.renameTitle")})}),t.jsxs("div",{className:"space-y-6 p-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{htmlFor:"wallet-name",className:"text-sm font-medium",children:e("editSheet.walletName")}),t.jsx("input",{id:"wallet-name",type:"text",value:i,onChange:u=>l(u.target.value),placeholder:e("editSheet.walletNamePlaceholder"),maxLength:20,className:z("w-full rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")}),t.jsxs("p",{className:"text-right text-xs text-muted-foreground",children:[i.length,"/20"]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("button",{onClick:o,disabled:!d,className:z("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:e("editSheet.save")}),t.jsx("button",{onClick:()=>s(),className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:e("editSheet.cancel")})]})]}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const rd=({params:e})=>t.jsx(he,{params:e,children:t.jsx(db,{})});rd.__docgenInfo={description:"",methods:[],displayName:"WalletRenameJob"};function ub(){const{t:e}=F("wallet"),{pop:s}=se(),{navigate:n}=fe(),{walletId:a}=be(),i=Xt().find(h=>h.id===a),[l,o]=c.useState([]),[d,u]=c.useState(!1),[m,p]=c.useState(!1),x=c.useCallback(async h=>{if(!(!i||h.length<4)){if(!i.encryptedMnemonic){ye.deleteWallet(i.id),n({to:"/"});return}p(!0),u(!1);try{const y=Kt(h);if(!await Bt(i.encryptedMnemonic,y)){u(!0),o([]);return}ye.deleteWallet(i.id),n({to:"/"})}catch{u(!0),o([])}finally{p(!1)}}},[i,n]);return i?t.jsx(ge,{children:t.jsxs("div",{className:"bg-background rounded-t-2xl",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),t.jsx("div",{className:"border-b border-border px-4 pb-4",children:t.jsx("h2",{className:"text-center text-lg font-semibold",children:e("editSheet.deleteTitle")})}),t.jsxs("div",{className:"space-y-6 p-4",children:[t.jsx("p",{className:"text-center text-muted-foreground",children:e("editSheet.deleteWarning",{name:i.name})}),t.jsx(ks,{value:l,onChange:o,onComplete:x,minPoints:4,error:d,disabled:m}),t.jsx("div",{className:"space-y-3",children:t.jsx("button",{onClick:()=>s(),disabled:m,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:e("editSheet.cancel")})})]}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}):null}const id=({params:e})=>t.jsx(he,{params:e,children:t.jsx(ub,{})});id.__docgenInfo={description:"",methods:[],displayName:"WalletDeleteJob"};let Gn=null,si=null;function ts(e,s){Gn=e,si=null}function mb(){Gn=null,si=null}function fb(){const{t:e}=F("security"),{pop:s}=se(),{title:n,description:a,biometricAvailable:r}=be(),[i,l]=c.useState([]),[o,d]=c.useState(!1),[u,m]=c.useState(!1),p=c.useRef(null),x=c.useRef(null),h=c.useRef(null),y=c.useRef(!1);!y.current&&Gn&&(x.current=Gn,h.current=si,mb(),y.current=!0);const f=n??e("patternLock.unlockTitle"),g=r==="true"&&h.current,b=c.useCallback(()=>{p.current&&(clearTimeout(p.current),p.current=null),d(!1)},[]),v=c.useCallback(N=>{o&&N.length>0&&b(),l(N)},[o,b]),j=c.useCallback(async N=>{const M=x.current;if(!(N.length<4||!M)){m(!0),b();try{const S=Kt(N);await M(S)?s():(d(!0),l([]),p.current=setTimeout(()=>{d(!1)},1500))}catch{d(!0),l([]),p.current=setTimeout(()=>{d(!1)},1500)}finally{m(!1)}}},[s,b]),w=c.useCallback(async()=>{const N=h.current;if(N){m(!0),b();try{await N()?s():(d(!0),p.current=setTimeout(()=>{d(!1)},1500))}catch{d(!0),p.current=setTimeout(()=>{d(!1)},1500)}finally{m(!1)}}},[s,b]);return t.jsx(ge,{"data-testid":"wallet-lock-dialog",children:t.jsxs("div",{className:"bg-background rounded-t-2xl",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),t.jsxs("div",{className:"px-4 pb-4 text-center",children:[t.jsx("h2",{className:"text-lg font-semibold",children:f}),a&&t.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:a})]}),t.jsx("div",{className:"px-4 pb-4",children:t.jsx(ks,{value:i,onChange:v,onComplete:j,minPoints:4,error:o,disabled:u,"data-testid":"wallet-lock-pattern"})}),t.jsxs("div",{className:"space-y-3 px-4 pb-4",children:[g&&t.jsxs("button",{type:"button",onClick:w,disabled:u,className:z("flex w-full items-center justify-center gap-2 rounded-full border border-border py-3 font-medium transition-colors","hover:bg-muted","disabled:cursor-not-allowed disabled:opacity-50"),children:[t.jsx(Vp,{className:"size-5"}),t.jsx("span",{children:e("walletLock.biometric")})]}),t.jsx("button",{type:"button",onClick:()=>s(),disabled:u,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:e("walletLock.cancel")})]}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const od=({params:e})=>t.jsx(he,{params:e,children:t.jsx(fb,{})});od.__docgenInfo={description:"",methods:[],displayName:"WalletLockConfirmJob"};let pb=null;function hb(){const{t:e}=F(["security","transaction","common"]),{pop:s}=se(),{title:n,description:a}=be(),[r,i]=c.useState(""),[l,o]=c.useState(),[d,u]=c.useState(!1),m=c.useRef(null);c.useRef(!1).current;const x=n??e("security:twoStepSecret.confirmTitle"),h=a??e("security:twoStepSecret.confirmDesc"),y=c.useCallback(async g=>{g.preventDefault();const b=m.current;if(!(!r.trim()||!b)){u(!0),o(void 0);try{await b(r)?s():o(e("security:twoStepSecret.notMatch"))}catch{o(e("security:twoStepSecret.notMatch"))}finally{u(!1)}}},[r,s,e]),f=r.trim().length>0&&!d;return t.jsx(ge,{"data-testid":"two-step-secret-dialog",children:t.jsxs("div",{className:"bg-background rounded-t-2xl",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),t.jsx("div",{className:"border-b border-border px-4 pb-4",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx(oa,{className:"size-5 text-primary"}),t.jsx("h2",{className:"text-center text-lg font-semibold",children:x})]})}),t.jsxs("form",{onSubmit:y,className:"space-y-6 p-4",children:[t.jsx("p",{className:"text-center text-muted-foreground text-sm",children:h}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Bn,{value:r,onChange:g=>i(g.target.value),placeholder:e("security:twoStepSecret.inputPlaceholder"),disabled:d,"aria-describedby":l?"two-step-secret-error":void 0,"data-testid":"two-step-secret-input"}),l&&t.jsxs("div",{id:"two-step-secret-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[t.jsx(Yt,{className:"size-4"}),t.jsx("span",{children:l})]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("button",{type:"submit",disabled:!f,"data-testid":"two-step-secret-confirm-button",className:z("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:e(d?"security:walletLock.verifying":"common:confirm")}),t.jsx("button",{type:"button",onClick:()=>s(),disabled:d,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:e("security:walletLock.cancel")})]})]}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const ld=({params:e})=>t.jsx(he,{params:e,children:t.jsx(hb,{})});ld.__docgenInfo={description:"",methods:[],displayName:"TwoStepSecretConfirmJob"};function ni({status:e,txHash:s,title:n,description:a,errorMessage:r,checkConfirmed:i,onStatusChange:l,onDone:o,onRetry:d,onViewDetails:u,onShare:m,pollInterval:p=1e4,maxPollAttempts:x=18,children:h}){const{t:y}=F(["transaction","common"]),[f,g]=c.useState(e);c.useEffect(()=>{g(e)},[e]),c.useEffect(()=>{if(f!=="broadcasted"||!i)return;let S=!1,A=0;const I=async()=>{if(!(S||A>=x)){A++,A===1&&(g("confirming"),l?.("confirming"));try{await i()&&!S?(g("confirmed"),l?.("confirmed")):!S&&A<x&&setTimeout(I,p)}catch{!S&&A<x&&setTimeout(I,p)}}},P=setTimeout(I,3e3);return()=>{S=!0,clearTimeout(P)}},[f,i,l,p,x]);const b=()=>{switch(f){case"broadcasting":return n?.broadcasting??y("transaction:txStatus.broadcasting");case"broadcasted":return n?.broadcasted??y("transaction:txStatus.broadcasted");case"confirming":return n?.confirming??y("transaction:txStatus.confirming");case"confirmed":return n?.confirmed??y("transaction:txStatus.confirmed");case"failed":return n?.failed??y("transaction:txStatus.failed")}},v=()=>{if(f==="failed"&&r)return r;switch(f){case"broadcasting":return a?.broadcasting??y("transaction:txStatus.broadcastingDesc");case"broadcasted":return a?.broadcasted??y("transaction:txStatus.broadcastedDesc");case"confirming":return a?.confirming??y("transaction:txStatus.confirmingDesc");case"confirmed":return a?.confirmed??y("transaction:txStatus.confirmedDesc");case"failed":return a?.failed??y("transaction:txStatus.failedDesc")}},j=()=>{switch(f){case"broadcasting":case"confirming":return t.jsx(Ve,{className:"size-8 animate-spin"});case"broadcasted":return t.jsx(je,{className:"size-8"});case"confirmed":return t.jsx(je,{className:"size-8"});case"failed":return t.jsx(Yt,{className:"size-8"})}},w=()=>{switch(f){case"broadcasting":case"confirming":return"bg-blue-100 text-blue-600";case"broadcasted":return"bg-blue-100 text-blue-600";case"confirmed":return"bg-green-100 text-green-600";case"failed":return"bg-red-100 text-red-600"}},N=f==="confirmed"||f==="broadcasted"||f==="confirming",M=f==="failed"&&d;return t.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 p-8",children:[t.jsx("div",{className:z("flex size-16 items-center justify-center rounded-full",w()),children:j()}),t.jsx("h2",{className:"text-lg font-semibold",children:b()}),t.jsx("p",{className:"text-center text-sm text-muted-foreground",children:v()}),s&&t.jsxs("p",{className:"text-xs text-muted-foreground font-mono truncate max-w-full px-4",children:[s.slice(0,16),"...",s.slice(-16)]}),h,N&&t.jsxs("div",{className:"flex w-full max-w-xs flex-col gap-2",children:[o&&t.jsx("button",{type:"button",onClick:o,"data-testid":"tx-status-done-button",className:z("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90"),children:y("common:done")}),t.jsxs("div",{className:"flex gap-2",children:[u&&t.jsx("button",{type:"button",onClick:u,"data-testid":"tx-status-view-details-button",className:"flex-1 rounded-full border border-border py-2 text-sm font-medium transition-colors hover:bg-muted",children:y("transaction:txStatus.viewDetails")}),m&&t.jsx("button",{type:"button",onClick:m,"data-testid":"tx-status-share-button",className:"flex-1 rounded-full border border-border py-2 text-sm font-medium transition-colors hover:bg-muted",children:y("common:share")})]})]}),M&&t.jsx("button",{type:"button",onClick:d,"data-testid":"tx-status-retry-button",className:z("w-full max-w-xs rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90"),children:y("common:retry")})]})}ni.__docgenInfo={description:"",methods:[],displayName:"TxStatusDisplay",props:{status:{required:!0,tsType:{name:"union",raw:'"broadcasting" | "broadcasted" | "confirming" | "confirmed" | "failed"',elements:[{name:"literal",value:'"broadcasting"'},{name:"literal",value:'"broadcasted"'},{name:"literal",value:'"confirming"'},{name:"literal",value:'"confirmed"'},{name:"literal",value:'"failed"'}]},description:""},txHash:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},title:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  broadcasting?: string;
  broadcasted?: string;
  confirming?: string;
  confirmed?: string;
  failed?: string;
}`,signature:{properties:[{key:"broadcasting",value:{name:"string",required:!1}},{key:"broadcasted",value:{name:"string",required:!1}},{key:"confirming",value:{name:"string",required:!1}},{key:"confirmed",value:{name:"string",required:!1}},{key:"failed",value:{name:"string",required:!1}}]}},description:""},description:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  broadcasting?: string;
  broadcasted?: string;
  confirming?: string;
  confirmed?: string;
  failed?: string;
}`,signature:{properties:[{key:"broadcasting",value:{name:"string",required:!1}},{key:"broadcasted",value:{name:"string",required:!1}},{key:"confirming",value:{name:"string",required:!1}},{key:"confirmed",value:{name:"string",required:!1}},{key:"failed",value:{name:"string",required:!1}}]}},description:""},errorMessage:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},checkConfirmed:{required:!1,tsType:{name:"union",raw:"(() => Promise<boolean>) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},onStatusChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(status: TxStatus) => void",signature:{arguments:[{type:{name:"union",raw:'"broadcasting" | "broadcasted" | "confirming" | "confirmed" | "failed"',elements:[{name:"literal",value:'"broadcasting"'},{name:"literal",value:'"broadcasted"'},{name:"literal",value:'"confirming"'},{name:"literal",value:'"confirmed"'},{name:"literal",value:'"failed"'}]},name:"status"}],return:{name:"void"}}},description:""},onDone:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onRetry:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onViewDetails:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onShare:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},pollInterval:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"10000",computed:!1}},maxPollAttempts:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"18",computed:!1}},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};let Hs=null,Qn=null;function cd(e,s){Hs=e,Qn=s}function wo(){Hs=null,Qn=null}function xb(){const{t:e}=F(["transaction","common"]),{pop:s}=se();be();const n=c.useRef(Hs),a=c.useRef(Qn),r=c.useRef(!1);!r.current&&Hs&&(n.current=Hs,a.current=Qn,wo(),r.current=!0);const i=n.current,[l,o]=c.useState(i?.currentFee??""),[d,u]=c.useState();c.useEffect(()=>()=>{wo()},[]);const m=c.useCallback(b=>{if(!i)return;const v=parseFloat(b),j=parseFloat(i.minFee);if(isNaN(v)||v<=0)return e("transaction:feeEdit.invalidFee");if(v<j)return e("transaction:feeEdit.belowMinFee",{minFee:i.minFee,symbol:i.symbol})},[i,e]),p=c.useCallback(b=>{const v=b.target.value;(v===""||/^\d*\.?\d*$/.test(v))&&(o(v),u(void 0))},[]),x=c.useCallback(b=>{o(b),u(void 0)},[]),h=c.useCallback(b=>{b.preventDefault();const v=m(l);if(v){u(v);return}a.current?.({fee:l}),s()},[l,m,s]),y=c.useCallback(()=>{s()},[s]);if(!i)return null;const f=[{label:e("transaction:feeEdit.presetMin"),value:i.minFee}],g=i.presets??f;return t.jsx(sd,{children:t.jsxs("div",{className:"bg-background rounded-2xl p-4","data-testid":"fee-edit-modal",children:[t.jsx("h2",{className:"mb-4 text-center text-lg font-semibold",children:e("transaction:feeEdit.title")}),t.jsxs("form",{onSubmit:h,className:"space-y-4",children:[t.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 text-sm text-muted-foreground",children:[t.jsxs("p",{children:[e("transaction:feeEdit.currentFee"),": ",i.currentFee," ",i.symbol]}),t.jsxs("p",{children:[e("transaction:feeEdit.minFee"),": ",i.minFee," ",i.symbol]})]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:g.map(b=>t.jsx("button",{type:"button",onClick:()=>x(b.value),className:z("rounded-full px-3 py-1 text-sm transition-colors",l===b.value?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:b.label},b.value))}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium",children:e("transaction:feeEdit.customFee")}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(He,{type:"text",inputMode:"decimal",value:l,onChange:p,placeholder:i.minFee,className:z(d&&"border-destructive"),"data-testid":"fee-input"}),t.jsx("span",{className:"shrink-0 text-sm text-muted-foreground",children:i.symbol})]}),d&&t.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-destructive",children:[t.jsx(Yt,{className:"size-4"}),t.jsx("span",{children:d})]})]}),t.jsxs("div",{className:"flex gap-3 pt-2",children:[t.jsx(q,{type:"button",variant:"outline",onClick:y,className:"flex-1",children:e("common:cancel")}),t.jsx(q,{type:"submit",className:"flex-1",disabled:!l,children:e("common:confirm")})]})]})]})})}const dd=({params:e})=>t.jsx(he,{params:e,children:t.jsx(xb,{})});dd.__docgenInfo={description:"",methods:[],displayName:"FeeEditJob"};let qs=null,Yn=null,Xn=null,Zn="";function gb(e,s,n){qs=e,Yn=n??null,s&&(Xn=s.amount,Zn=s.symbol)}function vb(){qs=null,Yn=null,Xn=null,Zn=""}function bb(){const{t:e}=F(["security","transaction","common"]),{pop:s,push:n}=se(),{chainId:a,chainIcon:r,chainSymbol:i,address:l,chainName:o}=be(),[d,u]=c.useState(""),[m,p]=c.useState(""),[x,h]=c.useState([]),[y,f]=c.useState(!1),[g,b]=c.useState("input"),[v,j]=c.useState(),[w,N]=c.useState(!1),[M,S]=c.useState("idle"),[A,I]=c.useState(),[P,D]=c.useState(null),E=c.useRef(qs),k=c.useRef(Yn),T=c.useRef({amount:Xn,symbol:Zn}),C=P??T.current.amount?.toDisplayString()??"0";c.useEffect(()=>(qs&&!E.current&&(E.current=qs,k.current=Yn,T.current={amount:Xn,symbol:Zn}),()=>{vb()}),[]);const L=c.useCallback(()=>{const B=T.current.amount?.toDisplayString()??"0";cd({currentFee:C,minFee:B,symbol:T.current.symbol},$=>{D($.fee)}),n("FeeEditJob",{})},[C,n]),_=c.useCallback(()=>{if(j(void 0),g==="input"){if(!d.trim())return;b("confirm")}else if(g==="confirm"){if(d!==m){j(e("security:twoStepSecret.notMatch"));return}b("walletLock")}},[g,d,m,e]),R=c.useCallback(async B=>{const $=E.current;if(B.length<4||!$)return;N(!0),S("broadcasting"),j(void 0),f(!1);const K=Kt(B);try{const ee=await $(d,K);ee.success?(I(ee.txHash),S("broadcasted")):(S("idle"),f(!0),h([]),j(ee.error??e("security:twoStepSecret.setFailed")))}catch{S("idle"),f(!0),h([]),j(e("security:twoStepSecret.setFailed"))}finally{N(!1)}},[d,e]);return M!=="idle"?t.jsx(ge,{children:t.jsxs("div",{className:"bg-background rounded-t-2xl",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),t.jsx(ni,{status:M,txHash:A,title:{confirmed:e("security:twoStepSecret.txConfirmed")},description:{confirmed:e("security:twoStepSecret.setSuccessDesc")},checkConfirmed:k.current??void 0,onStatusChange:S,onDone:()=>s()}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}):t.jsx(ge,{children:t.jsxs("div",{className:"bg-background rounded-t-2xl","data-testid":"set-two-step-secret-dialog",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),t.jsxs("div",{className:"border-b border-border px-4 pb-4",children:[t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx(oa,{className:"size-5 text-primary"}),t.jsx("h2",{className:"text-center text-lg font-semibold",children:e("security:twoStepSecret.setTitle")})]}),a&&l?t.jsx("div",{className:"mt-2 flex justify-center",children:t.jsx(Mm,{chainId:a,chainIcon:r,chainSymbol:i,address:l,size:"sm"})}):o?t.jsx("p",{className:"mt-1 text-center text-sm text-muted-foreground",children:o}):null]}),t.jsxs("div",{className:"space-y-6 p-4",children:[T.current.amount&&t.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-muted/50 p-3",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:e("security:twoStepSecret.feeInfo")}),t.jsx(jr,{amount:C,symbol:T.current.symbol,editable:!0,onEdit:L})]}),t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("div",{className:z("size-2 rounded-full",g==="input"?"bg-primary":"bg-muted")}),t.jsx("div",{className:z("size-2 rounded-full",g==="confirm"?"bg-primary":"bg-muted")}),t.jsx("div",{className:z("size-2 rounded-full",g==="walletLock"?"bg-primary":"bg-muted")})]}),g==="input"&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-center text-sm text-muted-foreground",children:e("security:twoStepSecret.inputDesc")}),t.jsx(Bn,{value:d,onChange:B=>u(B.target.value),placeholder:e("security:twoStepSecret.inputPlaceholder"),"aria-describedby":v?"two-step-secret-error":void 0,"data-testid":"new-two-step-secret-input"})]}),g==="confirm"&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-center text-sm text-muted-foreground",children:e("security:twoStepSecret.confirmDesc")}),t.jsx(Bn,{value:m,onChange:B=>p(B.target.value),placeholder:e("security:twoStepSecret.confirmPlaceholder"),"aria-describedby":v?"two-step-secret-error":void 0,"data-testid":"confirm-two-step-secret-input"})]}),g==="walletLock"&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-center text-sm text-muted-foreground",children:e("security:twoStepSecret.walletLockDesc")}),t.jsx(ks,{value:x,onChange:h,onComplete:R,minPoints:4,error:y,disabled:w,"data-testid":"wallet-lock-pattern"})]}),v&&t.jsxs("div",{id:"two-step-secret-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[t.jsx(Yt,{className:"size-4"}),t.jsx("span",{children:v})]}),t.jsxs("div",{className:"space-y-3",children:[g!=="walletLock"&&t.jsx("button",{type:"button",onClick:_,"data-testid":"set-two-step-secret-next-button",className:z("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90"),children:e("common:next")}),t.jsx("button",{type:"button",onClick:()=>{g==="input"?s():g==="confirm"?(b("input"),j(void 0)):(b("confirm"),j(void 0),f(!1),h([]))},disabled:w,"data-testid":"set-two-step-secret-cancel-button",className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:e(g==="input"?"common:cancel":"common:back")})]})]}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const ud=({params:e})=>t.jsx(he,{params:e,children:t.jsx(bb,{})});ud.__docgenInfo={description:"",methods:[],displayName:"SetTwoStepSecretJob"};let rr=null;function yb(){rr=null}const jb=[{value:"english",label:"English"},{value:"zh-Hans",label:""},{value:"zh-Hant",label:""}],Nb=[12,15,18,21,24,36];function wb(){const{t:e}=F("onboarding"),{pop:s}=se(),{language:n,length:a}=be(),[r,i]=c.useState({language:n||"english",length:Number(a)||12}),l=u=>{i(m=>({...m,language:u}))},o=u=>{i(m=>({...m,length:u}))},d=()=>{rr&&rr(r),yb(),s()};return t.jsx(ge,{children:t.jsxs("div",{className:"bg-background rounded-t-2xl",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),t.jsx("div",{className:"border-b border-border px-4 pb-4",children:t.jsx("h2",{className:"text-center text-lg font-semibold",children:e("create.mnemonicOptions.title")})}),t.jsxs("div",{className:"space-y-6 p-4",children:[t.jsxs("div",{className:"space-y-3",children:[t.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:e("create.mnemonicOptions.language")}),t.jsx("div",{className:"space-y-1",role:"radiogroup",children:jb.map(u=>t.jsxs("button",{type:"button",role:"radio","aria-checked":r.language===u.value,onClick:()=>l(u.value),className:z("flex w-full items-center justify-between rounded-lg px-4 py-3","transition-colors hover:bg-muted/50",r.language===u.value&&"bg-muted"),children:[t.jsx("span",{className:"text-sm",children:u.label}),r.language===u.value&&t.jsx(je,{className:"size-5 text-primary"})]},u.value))})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:e("create.mnemonicOptions.wordCount")}),t.jsx("div",{className:"grid grid-cols-3 gap-2",role:"radiogroup",children:Nb.map(u=>t.jsxs("button",{type:"button",role:"radio","aria-checked":r.length===u,onClick:()=>o(u),className:z("flex items-center justify-center rounded-lg py-3 text-sm font-medium","transition-colors",r.length===u?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:[u," ",e("create.mnemonicOptions.words")]},u))})]}),t.jsx("button",{type:"button",onClick:d,className:z("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90"),children:e("create.mnemonicOptions.confirm")})]}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const md=({params:e})=>t.jsx(he,{params:e,children:t.jsx(wb,{})});md.__docgenInfo={description:"",methods:[],displayName:"MnemonicOptionsJob"};const Fa=3,Sb=10;function Cb(){const{t:e}=F("common"),{pop:s}=se(),{contactId:n}=be(),a=Ne(hs,P=>P.contacts),r=n?a.find(P=>P.id===n):null,[i,l]=c.useState(""),[o,d]=c.useState([{id:crypto.randomUUID(),label:"",address:""}]),[u,m]=c.useState(""),[p,x]=c.useState(()=>Math.floor(Math.random()*1e4)),[h,y]=c.useState(!1),f=!!r;c.useEffect(()=>{r&&(l(r.name),d(r.addresses.length>0?r.addresses.map(P=>({id:P.id,label:P.label||"",address:P.address})):[{id:crypto.randomUUID(),label:"",address:""}]),m(r.memo??""),y(!1))},[r]);const g=c.useCallback(()=>{x(Math.floor(Math.random()*1e4)),y(!0)},[]),b=o.find(P=>P.address.trim())?.address.trim(),v=!f||h?b?Ht(b,p):void 0:r?.avatar||(b?Ht(b,p):void 0),j=c.useCallback(()=>{o.length>=Fa||d(P=>[...P,{id:crypto.randomUUID(),label:"",address:""}])},[o.length]),w=c.useCallback(P=>{d(D=>D.length<=1?D:D.filter(E=>E.id!==P))},[]),N=c.useCallback((P,D,E)=>{d(k=>k.map(T=>T.id===P?{...T,[D]:E}:T))},[]),M=c.useCallback(()=>{const P=i.trim(),D=u.trim(),E=o.filter(T=>T.address.trim()).map((T,C)=>({id:T.id,address:T.address.trim(),label:T.label.trim()||void 0,isDefault:C===0}));if(!P||E.length===0)return;const k=!f||h?E[0]?Ht(E[0].address,p):void 0:r?.avatar;f&&r?xs.updateContact(r.id,{name:P,avatar:k,addresses:E,memo:D||void 0}):xs.addContact({name:P,addresses:E,avatar:k,memo:D||void 0}),s()},[i,o,u,p,f,r,s]),S=o.some(P=>P.address.trim()),A=i.trim().length>0&&S,I=o.length<Fa;return t.jsx(ge,{children:t.jsxs("div",{className:"bg-background rounded-t-2xl",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),t.jsx("div",{className:"border-b border-border px-4 pb-4",children:t.jsx("h2",{className:"text-center text-lg font-semibold",children:e(f?"contact.editTitle":"contact.addTitle")})}),t.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:t.jsxs("div",{className:"space-y-4 p-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("button",{type:"button",onClick:g,disabled:!b,className:"group relative shrink-0",title:e("addressBook.changeAvatar"),children:[t.jsx(da,{src:v,size:56}),b&&t.jsx("div",{className:"bg-background/80 absolute inset-0 flex items-center justify-center rounded-full opacity-0 transition-opacity group-hover:opacity-100",children:t.jsx(an,{className:"text-primary size-5"})})]}),t.jsx("input",{id:"contact-name",type:"text",value:i,onChange:P=>l(P.target.value),placeholder:e("contact.namePlaceholder"),maxLength:20,className:z("flex-1 rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm font-medium",children:e("contact.addresses")}),t.jsxs("span",{className:"text-muted-foreground text-xs",children:[o.length,"/",Fa]})]}),o.map((P,D)=>t.jsxs("div",{className:"space-y-2 rounded-xl border border-border p-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"text",value:P.label,onChange:E=>N(P.id,"label",E.target.value),placeholder:e("contact.addressLabelPlaceholder"),maxLength:Sb,className:z("w-24 shrink-0 rounded-lg border border-border bg-muted/50 px-3 py-2 text-sm","focus:outline-none focus:ring-2 focus:ring-primary")}),o.length>1&&t.jsx("button",{type:"button",onClick:()=>w(P.id),className:"text-muted-foreground hover:text-destructive shrink-0 p-1",children:t.jsx(Qt,{className:"size-4"})}),D===0&&t.jsx("span",{className:"bg-primary/10 text-primary rounded px-1.5 py-0.5 text-xs",children:"Default"})]}),t.jsx("input",{type:"text",value:P.address,onChange:E=>N(P.id,"address",E.target.value),placeholder:e("contact.addressPlaceholder"),className:z("w-full rounded-lg border border-border bg-background px-3 py-2 font-mono text-sm","focus:outline-none focus:ring-2 focus:ring-primary")})]},P.id)),I&&t.jsxs("button",{type:"button",onClick:j,className:"flex w-full items-center justify-center gap-2 rounded-xl border border-dashed border-border py-3 text-sm text-muted-foreground hover:border-primary hover:text-primary",children:[t.jsx(kt,{className:"size-4"}),e("contact.addAddress")]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("label",{htmlFor:"contact-memo",className:"flex items-center gap-2 text-sm font-medium",children:[t.jsx(el,{className:"size-4"}),e("contact.memoOptional")]}),t.jsx("textarea",{id:"contact-memo",value:u,onChange:P=>m(P.target.value),placeholder:e("contact.memoPlaceholder"),maxLength:100,rows:2,className:z("w-full resize-none rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")})]}),t.jsxs("div",{className:"space-y-3 pt-2",children:[t.jsx("button",{onClick:M,disabled:!A,className:z("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:e(f?"contact.save":"contact.add")}),t.jsx("button",{onClick:()=>s(),className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:e("contact.cancel")})]})]})}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const fd=({params:e})=>t.jsx(he,{params:e,children:t.jsx(Cb,{})});fd.__docgenInfo={description:"",methods:[],displayName:"ContactEditJob"};function kb(e,s=8,n=6){return e.length<=s+n+3?e:`${e.slice(0,s)}...${e.slice(-n)}`}function Ab(){const{t:e}=F("common"),{pop:s}=se(),{chainType:n}=be(),a=n,[r,i]=c.useState(""),l=Ne(hs),o=c.useMemo(()=>{let u=l.contacts;return r&&(u=na.searchContacts(l,r)),u=[...u].sort((m,p)=>p.updatedAt-m.updatedAt),u.map(m=>{const p=m.addresses.map(h=>({...h,isValidForCurrentChain:a?gf(h.address,a):!0})),x=p.some(h=>h.isValidForCurrentChain);return{contact:m,addresses:p,hasValidAddress:x}})},[l,r,a]),d=(u,m)=>{const p=new CustomEvent("contact-picker-select",{detail:{contact:u,address:m}});window.dispatchEvent(p),s()};return t.jsx(ge,{children:t.jsxs("div",{className:"bg-background rounded-t-2xl",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),t.jsx("div",{className:"border-border border-b px-4 pb-4",children:t.jsx("h2",{className:"text-center text-lg font-semibold",children:e("contact.selectAddress")})}),t.jsx("div",{className:"border-border border-b p-4",children:t.jsxs("div",{className:"bg-muted/50 flex items-center gap-2 rounded-xl px-3 py-2",children:[t.jsx(rn,{className:"text-muted-foreground size-4"}),t.jsx("input",{type:"text",value:r,onChange:u=>i(u.target.value),placeholder:e("addressBook.searchPlaceholder"),className:"placeholder:text-muted-foreground min-w-0 flex-1 bg-transparent text-sm outline-none"})]})}),t.jsx("div",{className:"max-h-[50vh] overflow-y-auto",children:o.length===0?t.jsx("div",{className:"text-muted-foreground py-12 text-center text-sm",children:e(r?"addressBook.noResults":"contact.noContacts")}):t.jsx("div",{className:"divide-border divide-y",children:o.map(({contact:u,addresses:m,hasValidAddress:p})=>t.jsxs("div",{className:z(!p&&"opacity-50"),children:[t.jsxs("div",{className:"flex items-center gap-3 px-4 pt-3 pb-2",children:[t.jsx(da,{src:u.avatar||(m[0]?.address?Ht(m[0].address):void 0),size:40,className:"shrink-0"}),t.jsx("p",{className:"min-w-0 flex-1 truncate font-medium",children:u.name})]}),t.jsx("div",{className:"space-y-1 pb-3 pl-[56px] pr-4",children:m.map(x=>{const h=!x.isValidForCurrentChain,y=x.label;return t.jsxs("button",{onClick:()=>!h&&d(u,x),disabled:h,className:z("flex min-h-[44px] w-full items-center gap-3 rounded-xl px-3 py-2.5 transition-colors",h?"cursor-not-allowed opacity-50":"hover:bg-muted/50 active:bg-muted"),children:[t.jsx("p",{className:z("min-w-0 flex-1 truncate text-left font-mono text-sm",h?"text-muted-foreground/50":"text-foreground"),children:kb(x.address)}),t.jsxs("div",{className:"flex shrink-0 items-center gap-2",children:[y&&t.jsx("span",{className:z("max-w-[5rem] truncate rounded-md bg-muted px-2 py-0.5 text-xs",h?"text-muted-foreground/50":"text-muted-foreground"),children:y}),x.isDefault&&t.jsx("span",{className:"bg-primary/10 text-primary rounded-md px-2 py-0.5 text-xs",children:"Default"})]})]},x.id)})})]},u.id))})}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const pd=({params:e})=>t.jsx(he,{params:e,children:t.jsx(Ab,{})});pd.__docgenInfo={description:"",methods:[],displayName:"ContactPickerJob"};const hd=()=>{const{t:e}=F(["wallet","home"]),{pop:s}=se(),{navigate:n}=fe(),a=()=>{s(),n({to:"/wallet/create"})},r=()=>{s(),n({to:"/onboarding/recover"})};return t.jsx(ge,{children:t.jsxs("div",{className:"bg-background rounded-t-2xl",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),t.jsx("div",{className:"border-b border-border px-4 pb-4",children:t.jsx("h2",{className:"text-center text-lg font-semibold",children:e("wallet:add")})}),t.jsxs("div",{className:"space-y-3 p-4",children:[t.jsxs("button",{onClick:a,className:z("flex w-full items-center gap-4 rounded-xl p-4 transition-colors","bg-muted/50 hover:bg-muted active:bg-muted/80"),children:[t.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10",children:t.jsx(kt,{className:"size-6 text-primary"})}),t.jsxs("div",{className:"flex-1 text-left",children:[t.jsx("div",{className:"font-semibold",children:e("home:welcome.createWallet")}),t.jsx("div",{className:"text-sm text-muted-foreground",children:e("wallet:createDesc")})]})]}),t.jsxs("button",{onClick:r,className:z("flex w-full items-center gap-4 rounded-xl p-4 transition-colors","bg-muted/50 hover:bg-muted active:bg-muted/80"),children:[t.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10",children:t.jsx(wr,{className:"size-6 text-primary"})}),t.jsxs("div",{className:"flex-1 text-left",children:[t.jsx("div",{className:"font-semibold",children:e("home:welcome.importWallet")}),t.jsx("div",{className:"text-sm text-muted-foreground",children:e("wallet:importDesc")})]})]})]}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};hd.__docgenInfo={description:"",methods:[],displayName:"WalletAddJob"};const xd=()=>{const{t:e}=F(["wallet","common"]),{pop:s,push:n}=se(),a=Xt(),i=Le()?.id,{getWalletTheme:l}=Ho(),o=qo(),d=m=>{ye.setCurrentWallet(m),s()},u=()=>{s(),n("WalletAddJob",{})};return t.jsx(ge,{children:t.jsxs("div",{className:"bg-background rounded-t-2xl",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),t.jsx("div",{className:"border-b border-border px-4 pb-4",children:t.jsx("h2",{className:"text-center text-lg font-semibold",children:e("common:a11y.tabWallet")})}),t.jsx("div",{className:"max-h-[50vh] space-y-2 overflow-y-auto p-4",children:a.map(m=>{const p=m.id===i,x=m.chainAddresses[0]?.address,h=x?`${x.slice(0,6)}...${x.slice(-4)}`:"---",y=l(m.id);return t.jsxs("button",{onClick:()=>d(m.id),className:z("flex w-full items-center gap-3 rounded-xl p-4 transition-all","active:scale-[0.98]",p?"bg-primary/10 ring-2 ring-primary":"bg-muted/50 hover:bg-muted"),children:[t.jsx(bf,{themeHue:y,size:"md",watermarkIconUrl:o[m.chain]}),t.jsxs("div",{className:"min-w-0 flex-1 text-left",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"truncate font-medium",children:m.name}),p&&t.jsx(yf,{className:"size-4 shrink-0 text-primary"})]}),t.jsx("p",{className:"truncate font-mono text-xs text-muted-foreground",children:h})]})]},m.id)})}),t.jsx("div",{className:"border-t border-border p-4",children:t.jsxs("button",{onClick:u,className:z("flex w-full items-center justify-center gap-2 rounded-xl p-4","bg-muted/50 hover:bg-muted active:bg-muted/80 transition-colors"),children:[t.jsx(kt,{className:"size-5"}),t.jsx("span",{className:"font-medium",children:e("wallet:add")})]})}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};xd.__docgenInfo={description:"",methods:[],displayName:"WalletListJob"};let ir=null;function Ib(e){ir=e}const gd=()=>{const{t:e}=F(["onboarding","common"]),{pop:s}=se(),[n,a]=c.useState(!1),r=()=>{s()},i=()=>{n&&(s(),ir?.(),ir=null)};return t.jsx(sd,{children:t.jsxs("div",{className:"bg-background mx-4 max-w-sm rounded-2xl p-5",children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"rounded-full bg-amber-500/15 p-2",children:t.jsx(qe,{className:"size-5 text-amber-600","aria-hidden":"true"})}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsx("h2",{className:"text-base font-semibold",children:e("onboarding:securityWarning.title")}),t.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:e("onboarding:securityWarning.message")})]})]}),t.jsxs("label",{className:"mt-4 flex cursor-pointer items-center gap-2 text-sm",children:[t.jsx(tl,{checked:n,onCheckedChange:a}),t.jsx("span",{children:e("onboarding:securityWarning.acknowledge")})]}),t.jsxs("div",{className:"mt-5 flex gap-2",children:[t.jsx(q,{type:"button",variant:"outline",className:"flex-1",onClick:r,children:e("common:cancel")}),t.jsx(q,{type:"button",className:"flex-1",onClick:i,disabled:!n,children:e("common:confirm")})]})]})})};gd.__docgenInfo={description:"",methods:[],displayName:"SecurityWarningJob"};let Vs=null;function Tb(e,s){Vs={onConfirm:e,minFee:s?.minFee,onFeeChange:s?.onFeeChange}}function So(){Vs=null}function Pb(e){return e.length<=16?e:`${e.slice(0,10)}...${e.slice(-6)}`}function Eb(){const{t:e}=F("transaction"),{pop:s,push:n}=se(),a=be(),[r,i]=c.useState(!1),[l,o]=c.useState(!1),[d,u]=c.useState(!1),[m,p]=c.useState(null),x=c.useRef(Vs),h=c.useRef(!1);!h.current&&Vs&&(x.current=Vs,So(),h.current=!0),c.useEffect(()=>()=>{So()},[]);const y=a.feeLoading==="true",f=a.feeFiatValue?parseFloat(a.feeFiatValue):void 0,g=m??a.feeAmount,b=!!x.current?.onFeeChange,v=c.useCallback(async()=>{try{await Fs.write({text:a.toAddress}),o(!0),setTimeout(()=>o(!1),2e3)}catch{console.error("Failed to copy address")}},[a.toAddress]),j=c.useCallback(()=>{i(S=>!S)},[]),w=c.useCallback(()=>{const S=x.current;S?.onFeeChange&&(cd({currentFee:g,minFee:S.minFee??a.feeAmount,symbol:a.feeSymbol},A=>{p(A.fee),S.onFeeChange?.(A.fee)}),n("FeeEditJob",{}))},[g,a.feeAmount,a.feeSymbol,n]),N=c.useCallback(async()=>{const S=x.current;if(console.log("[TransferConfirmJob] handleConfirm called, hasCallback:",!!S?.onConfirm),!(!S?.onConfirm||d)){u(!0);try{s(),console.log("[TransferConfirmJob] Executing callback..."),await S.onConfirm(),console.log("[TransferConfirmJob] Callback executed")}finally{u(!1)}}},[d,s]),M=c.useCallback(()=>{s()},[s]);return t.jsx(ge,{"data-testid":"transfer-confirm-sheet",children:t.jsx(Kn,{title:e("confirmSheet.title"),children:t.jsxs("div",{className:"space-y-6 p-4",children:[t.jsxs("div",{className:"text-center",children:[t.jsxs("p",{className:"text-3xl font-bold",children:[a.amount," ",a.symbol]}),a.fiatValue&&t.jsxs("p",{className:"text-muted-foreground mt-1",children:[" $",a.fiatValue]})]}),t.jsxs("div",{className:"bg-muted/30 space-y-4 rounded-xl p-4",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx("p",{className:"text-muted-foreground text-sm",children:e("confirmSheet.toAddress")}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{type:"button",onClick:j,className:"hover:text-primary flex min-w-0 flex-1 items-center gap-1 text-left font-mono text-sm",children:[t.jsx("span",{className:z("min-w-0",r?"break-all":"truncate"),children:r?a.toAddress:Pb(a.toAddress)}),r?t.jsx(Pr,{className:"size-4 shrink-0"}):t.jsx(Sr,{className:"size-4 shrink-0"})]}),t.jsx("button",{type:"button",onClick:v,className:"text-muted-foreground hover:text-foreground shrink-0 p-1","aria-label":e(l?"confirmSheet.copied":"confirmSheet.copyAddress"),children:l?t.jsx(je,{className:"size-4 text-green-500"}):t.jsx(On,{className:"size-4"})})]})]}),t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsx("p",{className:"text-muted-foreground text-sm",children:e("confirmSheet.networkFee")}),t.jsx(jr,{amount:g,symbol:a.feeSymbol,...f!==void 0&&{fiatValue:f},isLoading:y,editable:b,onEdit:w})]})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{type:"button","data-testid":"cancel-transfer-button",onClick:M,className:"border-border hover:bg-muted flex-1 rounded-full border py-3 font-medium transition-colors",disabled:d,children:e("confirmSheet.cancel")}),t.jsx("button",{type:"button","data-testid":"confirm-transfer-button",onClick:N,disabled:d||y,className:z("flex-1 rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:e(d?"confirmSheet.confirming":"confirmSheet.confirm")})]})]})})})}const vd=({params:e})=>t.jsx(he,{params:e,children:t.jsx(Eb,{})});vd.__docgenInfo={description:"",methods:[],displayName:"TransferConfirmJob"};let ea=null;function _b(e){ea=e}function Mb(){ea=null}function Rb(){const{t:e}=F(["security","transaction","common"]),{pop:s,push:n}=se(),{title:a}=be(),r=Mr(),i=Zt(),[l,o]=c.useState("wallet_lock"),[d,u]=c.useState([]),[m,p]=c.useState(""),[x,h]=c.useState("idle"),[y,f]=c.useState(),[g,b]=c.useState(),[v,j]=c.useState(!1),[w,N]=c.useState(!1),M=c.useRef(null),S=c.useRef(""),A=c.useRef(!1);!A.current&&ea&&(M.current=ea,Mb(),A.current=!0);const I=l==="wallet_lock"?a??e("security:walletLock.verifyTitle"):e("transaction:sendPage.twoStepSecretTitle"),P=c.useCallback(async T=>{const C=M.current;if(T.length<4||!C)return;N(!0),b(void 0),j(!1);const L=Kt(T);S.current=L;try{const _=await C(L);if(_.status==="ok"){_.txHash&&f(_.txHash),h("broadcasted");return}if(_.status==="wallet_lock_invalid"){j(!0),u([]);return}if(_.status==="two_step_secret_required"){o("two_step_secret"),b(void 0);return}_.status==="error"&&b(_.message??e("security:walletLock.error"))}catch{j(!0),u([])}finally{N(!1)}},[e]),D=c.useCallback(async()=>{const T=M.current;if(!(!m.trim()||!T)){N(!0),b(void 0);try{const C=await T(S.current,m);if(C.status==="ok"){C.txHash&&f(C.txHash),h("broadcasted");return}(C.status==="two_step_secret_invalid"||C.status==="error")&&b(C.message??e("transaction:sendPage.twoStepSecretError"))}catch{b(e("transaction:sendPage.twoStepSecretError"))}finally{N(!1)}}},[m,e]),E=c.useCallback(T=>{T.preventDefault(),l==="two_step_secret"&&D()},[l,D]),k=m.trim().length>0&&!w;return x!=="idle"?t.jsx(ge,{children:t.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:t.jsxs("div",{className:"bg-background rounded-t-2xl",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),t.jsx(ni,{status:x,txHash:y,title:{broadcasted:e("transaction:sendResult.success"),confirmed:e("transaction:sendResult.success")},description:{broadcasted:e("transaction:txStatus.broadcastedDesc"),confirmed:e("transaction:txStatus.confirmedDesc")},onStatusChange:h,onDone:()=>s(),onViewDetails:()=>{s(),y&&n("TransactionDetailActivity",{txId:y})},onShare:async()=>{y&&(await r.write({text:y}),i.show(e("common:copied")))}}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}):l==="wallet_lock"?t.jsx(ge,{children:t.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:t.jsx(Kn,{title:I,children:t.jsxs("div",{className:"p-4",children:[t.jsx(ks,{value:d,onChange:u,onComplete:P,minPoints:4,error:v,disabled:w,"data-testid":"transfer-wallet-lock-pattern"}),t.jsx("button",{type:"button",onClick:()=>s(),disabled:w,className:"mt-4 w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:e("common:cancel")})]})})})}):t.jsx(ge,{children:t.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:t.jsx(Kn,{title:I,children:t.jsxs("form",{onSubmit:E,className:"space-y-6 p-4",children:[t.jsxs("div",{className:"flex items-center justify-center gap-2 text-primary mb-2",children:[t.jsx(oa,{className:"size-5"}),t.jsx("span",{className:"text-sm",children:e("transaction:sendPage.twoStepSecretDescription")})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Bn,{value:m,onChange:T=>p(T.target.value),placeholder:e("transaction:sendPage.twoStepSecretPlaceholder"),disabled:w,"aria-describedby":g?"two-step-error":void 0,"data-testid":"two-step-secret-input",autoFocus:!0}),m.length>0&&m.length<6&&t.jsx("div",{className:"absolute right-10 top-1/2 -translate-y-1/2",children:t.jsx("span",{className:"text-xs text-amber-500",children:e("security:twoStepSecret.lengthHint",{count:m.length})})})]}),g&&t.jsxs("div",{id:"two-step-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[t.jsx(Yt,{className:"size-4"}),t.jsx("span",{children:g})]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("button",{type:"submit","data-testid":"two-step-confirm-button",disabled:!k,className:z("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:e(w?"common:verifying":"common:confirm")}),t.jsx("button",{type:"button",onClick:()=>s(),disabled:w,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:e("common:cancel")})]})]})})})})}const bd=({params:e})=>t.jsx(he,{params:e,children:t.jsx(Rb,{})});bd.__docgenInfo={description:"",methods:[],displayName:"TransferWalletLockJob"};const Db=150;function zb(){const{t:e}=F("scanner"),{pop:s}=se(),n=_l(),{chainType:a,title:r,hint:i}=be(),l=c.useRef(null),o=c.useRef(null),d=c.useRef(null),u=c.useRef(null),m=c.useRef(!1),p=c.useRef(!1),x=c.useRef(!1),[h,y]=c.useState(!1),[f,g]=c.useState(!1),[b,v]=c.useState(null),[j,w]=c.useState(null),N=wf(a),M=c.useCallback(k=>{if(k===j)return;w(k);const T=sl(k),C=N(k,T);if(C===!0){v({type:"success",text:e("scanSuccess")}),"vibrate"in navigator&&navigator.vibrate(100),m.current=!1;const L=Sf();setTimeout(()=>{s(),setTimeout(()=>{L?.({content:k,parsed:T})},100)},300)}else v({type:"error",text:e(C,{defaultValue:C})}),setTimeout(()=>{v(null),w(null)},3e3)},[j,N,e,s]),S=c.useCallback(()=>{if(m.current)return;m.current=!0,o.current||(o.current=document.createElement("canvas"));const k=async()=>{if(!(!m.current||!l.current||!u.current)){try{const T=await u.current.scanFromVideo(l.current,o.current??void 0);T&&M(T.content)}catch(T){console.error("[ScannerJob] Scan error:",T)}m.current&&setTimeout(k,Db)}};k()},[M]),A=c.useCallback(()=>{m.current=!1,d.current&&(d.current.getTracks().forEach(k=>k.stop()),d.current=null),y(!1)},[]),I=c.useCallback(async()=>{if(!x.current){if(x.current=!0,!navigator.mediaDevices?.getUserMedia){console.error("[ScannerJob] mediaDevices not available"),v({type:"error",text:e("error")}),x.current=!1;return}try{try{if(!await n.checkPermission()&&!await n.requestPermission()){v({type:"error",text:e("permissionDenied")}),x.current=!1;return}}catch(T){console.warn("[ScannerJob] Permission check failed, trying direct access:",T)}if(!p.current){x.current=!1;return}const k=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});if(!p.current){k.getTracks().forEach(T=>T.stop()),x.current=!1;return}if(d.current=k,l.current){l.current.srcObject=k;try{await l.current.play(),p.current&&(y(!0),S())}catch(T){if(T instanceof DOMException&&T.name==="AbortError")console.debug("[ScannerJob] Play interrupted, will retry on next mount");else throw T}}}catch(k){if(console.error("[ScannerJob] Camera error:",k),!p.current){x.current=!1;return}k instanceof DOMException?k.name==="NotAllowedError"?v({type:"error",text:e("permissionDenied")}):k.name==="NotFoundError"?v({type:"error",text:e("noCameraFound",{defaultValue:e("error")})}):k.name==="AbortError"||v({type:"error",text:e("error")}):v({type:"error",text:e("error")})}finally{x.current=!1}}},[n,S,e]);c.useEffect(()=>(p.current=!0,u.current=nl({useWorker:!0}),I(),()=>{p.current=!1,A(),u.current?.destroy(),u.current=null}),[]);const P=c.useCallback(()=>{const k=document.createElement("input");k.type="file",k.accept="image/*",k.onchange=async T=>{const C=T.target.files?.[0];if(!(!C||!u.current))try{const L=new Image,_=URL.createObjectURL(C);L.onload=async()=>{URL.revokeObjectURL(_);const R=document.createElement("canvas");R.width=L.width,R.height=L.height;const B=R.getContext("2d");if(!B||!u.current){v({type:"error",text:e("noQrFound")});return}B.drawImage(L,0,0);const $=await u.current.scanFromCanvas(R);$?M($.content):v({type:"error",text:e("noQrFound")})},L.onerror=()=>{URL.revokeObjectURL(_),v({type:"error",text:e("noQrFound")})},L.src=_}catch{v({type:"error",text:e("noQrFound")})}},k.click()},[M,e]),D=c.useCallback(async()=>{if(d.current){const k=d.current.getVideoTracks()[0];if(k)try{await k.applyConstraints({advanced:[{torch:!f}]}),g(!f)}catch{}}},[f]),E=c.useCallback(()=>{A(),s()},[A,s]);return t.jsx(ge,{children:t.jsxs("div",{className:"flex h-[80vh] flex-col overflow-hidden rounded-t-2xl bg-black",children:[t.jsx("div",{className:"flex justify-center py-2",children:t.jsx("div",{className:"h-1 w-10 rounded-full bg-white/30"})}),t.jsxs("div",{className:"flex items-center justify-between px-4 pb-2",children:[t.jsx(q,{variant:"ghost",size:"icon",onClick:E,className:"text-white hover:bg-white/20","data-testid":"scanner-close-button",children:t.jsx(ma,{className:"size-6"})}),t.jsx("h2",{className:"text-lg font-medium text-white","data-testid":"scanner-title",children:r??e("title")}),t.jsx(q,{variant:"ghost",size:"icon",onClick:D,className:z("text-white hover:bg-white/20",f&&"text-yellow-400"),"data-testid":"scanner-flash-button",children:t.jsx(jl,{className:"size-6"})})]}),t.jsxs("div",{className:"relative flex-1",children:[t.jsx("video",{ref:l,className:z("absolute inset-0 size-full object-cover",!h&&"hidden"),playsInline:!0,muted:!0,"data-testid":"scanner-video"}),!h&&!b&&t.jsx("div",{className:"flex size-full items-center justify-center",children:t.jsx("p",{className:"text-white/60",children:e("initializing")})}),t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsxs("div",{className:"relative size-64","data-testid":"scanner-viewfinder",children:[t.jsx("div",{className:z("absolute top-0 left-0 size-8 border-t-4 border-l-4",b?.type==="success"?"border-green-500":"border-primary")}),t.jsx("div",{className:z("absolute top-0 right-0 size-8 border-t-4 border-r-4",b?.type==="success"?"border-green-500":"border-primary")}),t.jsx("div",{className:z("absolute bottom-0 left-0 size-8 border-b-4 border-l-4",b?.type==="success"?"border-green-500":"border-primary")}),t.jsx("div",{className:z("absolute right-0 bottom-0 size-8 border-r-4 border-b-4",b?.type==="success"?"border-green-500":"border-primary")}),h&&!b&&t.jsx("div",{className:"animate-scan bg-primary absolute right-2 left-2 h-0.5"})]})}),t.jsx("div",{className:"absolute inset-x-0 bottom-24 px-4 text-center",children:b?t.jsx("div",{className:z("inline-block rounded-lg px-4 py-2",b.type==="error"&&"bg-red-500/80 text-white",b.type==="success"&&"bg-green-500/80 text-white",b.type==="info"&&"bg-black/50 text-white"),"data-testid":"scanner-message",children:b.text}):h?t.jsx("p",{className:"text-white/80","data-testid":"scanner-hint",children:i??(a?e("scanPromptChain",{chain:a}):e("scanPrompt"))}):null})]}),t.jsx("div",{className:"flex justify-center gap-8 bg-black/50 py-6",children:t.jsxs(q,{variant:"ghost",size:"lg",onClick:P,className:"flex flex-col items-center text-white hover:bg-white/20","data-testid":"scanner-gallery-button",children:[t.jsx(bl,{className:"mb-1 size-6"}),t.jsx("span",{className:"text-xs",children:e("gallery")})]})}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)] bg-black"})]})})}const yd=({params:e})=>t.jsx(he,{params:e,children:t.jsx(zb,{})});yd.__docgenInfo={description:"",methods:[],displayName:"ScannerJob"};function Lb(){const{t:e}=F("common"),{pop:s}=se(),n=be(),[a,r]=c.useState(n.name||""),[i,l]=c.useState(n.memo||""),[o,d]=c.useState(0),[u,m]=c.useState(!1),[p,x]=c.useState(!1),h=(()=>{try{return JSON.parse(n.addresses||"[]")}catch{return[]}})(),y=c.useCallback(()=>{d(b=>b+1)},[]),f=c.useCallback(async()=>{if(!(!a.trim()||h.length===0)){m(!0);try{const b=n.avatar||(h[0]?.address?Ht(h[0].address,o):void 0);xs.addContact({name:a.trim(),addresses:h.map((v,j)=>({id:`addr-${j}`,address:v.address,label:v.label,isDefault:j===0})),memo:i.trim()||void 0,avatar:b}),x(!0),setTimeout(()=>s(),500)}catch(b){console.error("[ContactAddConfirmJob] Save error:",b)}finally{m(!1)}}},[a,i,h,n.avatar,o,s]),g=c.useCallback(()=>{s()},[s]);return t.jsx(ge,{children:t.jsxs("div",{className:"bg-background rounded-t-2xl pb-[env(safe-area-inset-bottom)]",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),t.jsx("div",{className:"border-border border-b px-4 pb-4",children:t.jsx("h2",{className:"text-center text-lg font-semibold",children:e("addressBook.addContact")})}),t.jsxs("div",{className:"space-y-4 p-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("button",{type:"button",onClick:y,className:"group relative",title:e("addressBook.changeAvatar"),children:[t.jsx(da,{src:n.avatar||(h[0]?.address?Ht(h[0].address,o):void 0),size:48}),!n.avatar&&t.jsx("div",{className:"bg-background/80 absolute inset-0 flex items-center justify-center rounded-full opacity-0 transition-opacity group-hover:opacity-100",children:t.jsx(an,{className:"text-primary size-5"})})]}),t.jsx(He,{value:a,onChange:b=>r(b.target.value),placeholder:e("addressBook.namePlaceholder"),className:"flex-1"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-muted-foreground text-sm",children:e("addressBook.addresses")}),t.jsx("div",{className:"space-y-2",children:h.map((b,v)=>{const j=vf(b.address),w=b.label||j.chainType?.toUpperCase()||"";return t.jsxs("div",{className:"bg-muted/50 flex items-center gap-3 rounded-lg p-3",children:[t.jsx(Cr,{className:"text-muted-foreground size-5 shrink-0"}),t.jsxs("div",{className:"min-w-0 flex-1",children:[w&&t.jsx("div",{className:"text-muted-foreground text-xs",children:w}),t.jsx("div",{className:"truncate font-mono text-sm",children:b.address})]})]},v)})})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-muted-foreground text-sm",children:e("addressBook.memo")}),t.jsx(He,{value:i,onChange:b=>l(b.target.value),placeholder:e("addressBook.memoPlaceholder")})]})]}),t.jsxs("div",{className:"flex gap-3 p-4",children:[t.jsx(q,{variant:"outline",onClick:g,disabled:u||p,className:"flex-1",children:e("cancel")}),t.jsx(q,{onClick:f,disabled:!a.trim()||h.length===0||u||p,className:z("flex-1",p&&"bg-green-500"),children:p?t.jsxs(t.Fragment,{children:[t.jsx(je,{className:"mr-1 size-4"}),e("saved")]}):e(u?"saving":"save")})]})]})})}const jd=({params:e})=>t.jsx(he,{params:e,children:t.jsx(Lb,{})});jd.__docgenInfo={description:"",methods:[],displayName:"ContactAddConfirmJob"};function Bb(){const{t:e}=F("common"),{pop:s}=se(),n=be(),a=c.useRef(null),[r,i]=c.useState(!1),l=c.useMemo(()=>{try{return JSON.parse(n.addresses||"[]")}catch{return[]}},[n.addresses]),o=c.useMemo(()=>Nf({name:n.name,addresses:l,avatar:n.avatar}),[n.name,l,n.avatar]),d=c.useCallback(async()=>{const m=a.current;if(!(!m||r)){i(!0);try{const{snapdom:p}=await Ln(async()=>{const{snapdom:x}=await import("./snapdom-CO8q8LPW.js").then(h=>h.s);return{snapdom:x}},__vite__mapDeps([0,1]),import.meta.url);await p.download(m,{type:"png",filename:`contact-${n.name}.png`,scale:2,quality:1})}catch(p){console.error("Download failed:",p)}finally{i(!1)}}},[n.name,r]),u=c.useCallback(async()=>{const m=a.current;if(!(!m||!navigator.share)){i(!0);try{const{snapdom:p}=await Ln(async()=>{const{snapdom:f}=await import("./snapdom-CO8q8LPW.js").then(g=>g.s);return{snapdom:f}},__vite__mapDeps([0,1]),import.meta.url),h=await(await p(m,{scale:2})).toBlob(),y=new File([h],`contact-${n.name}.png`,{type:"image/png"});await navigator.share({title:e("addressBook.shareContact"),text:`${n.name} - ${l.map(f=>`${f.label||""}: ${f.address}`).join(", ")}`,files:[y]})}catch{}finally{i(!1)}}},[n.name,l,e,r]);return t.jsx(ge,{children:t.jsxs("div",{className:"bg-background rounded-t-2xl pb-[env(safe-area-inset-bottom)]",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),t.jsxs("div",{className:"flex items-center justify-between border-b px-4 pb-4",children:[t.jsx(q,{variant:"ghost",size:"icon",onClick:()=>s(),children:t.jsx(ma,{className:"size-5"})}),t.jsx("h2",{className:"text-lg font-semibold",children:e("addressBook.shareContact")}),t.jsx("div",{className:"w-10"})]}),t.jsxs("div",{className:"flex flex-col items-center p-6",children:[t.jsx("div",{ref:a,children:t.jsx(kf,{name:n.name,avatar:n.avatar,addresses:l,qrContent:o})}),t.jsx("p",{className:"text-muted-foreground mt-4 text-center text-sm",children:e("addressBook.scanToAdd")})]}),t.jsxs("div",{className:"flex gap-3 p-4",children:[t.jsxs(q,{variant:"outline",onClick:d,disabled:r,className:"flex-1",children:[r?t.jsx(Ve,{className:"mr-2 size-4 animate-spin"}):t.jsx(wr,{className:"mr-2 size-4"}),e("download")]}),"share"in navigator&&t.jsxs(q,{onClick:u,disabled:r,className:"flex-1",children:[r?t.jsx(Ve,{className:"mr-2 size-4 animate-spin"}):t.jsx(Fn,{className:"mr-2 size-4"}),e("share")]})]})]})})}const Nd=({params:e})=>t.jsx(he,{params:e,children:t.jsx(Bb,{})});Nd.__docgenInfo={description:"",methods:[],displayName:"ContactShareJob"};function Ob(){const{t:e}=F(["settings","common"]),{pop:s}=se(),[n,a]=c.useState(!1),r=c.useCallback(()=>{a(!0);const i="./";window.location.href=`${i}clear.html`},[]);return t.jsx(ge,{children:t.jsxs("div",{className:"bg-background rounded-t-2xl",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsx("div",{className:"flex justify-center",children:t.jsx("div",{className:"bg-destructive/10 flex size-16 items-center justify-center rounded-full",children:t.jsx(qe,{className:"text-destructive size-8"})})}),t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-lg font-semibold",children:e("settings:clearData.title")}),t.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:e("settings:clearData.warning")})]}),t.jsx("div",{className:"bg-destructive/5 rounded-lg p-4",children:t.jsxs("ul",{className:"text-destructive space-y-2 text-sm",children:[t.jsxs("li",{children:[" ",e("settings:clearData.item1")]}),t.jsxs("li",{children:[" ",e("settings:clearData.item2")]}),t.jsxs("li",{children:[" ",e("settings:clearData.item3")]})]})}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx(q,{variant:"outline",className:"flex-1",onClick:()=>s(),disabled:n,children:e("common:cancel")}),t.jsx(q,{variant:"destructive",className:"flex-1",onClick:r,disabled:n,children:e("settings:clearData.confirm")})]})]}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const wd=()=>t.jsx(Ob,{});wd.__docgenInfo={description:"",methods:[],displayName:"ClearDataConfirmJob"};function Fb(e){if(!e)return;if(e.startsWith("0x")){const n=ca(e);if(n)return n}const s=Qm(e);return Ja[s],s}function Wb(){const{t:e}=F("common"),{pop:s}=se(),{chain:n,exclude:a,appName:r,appIcon:i}=be(),l=c.useMemo(()=>Fb(n),[n]),o=Ne(Ce),d=Ue.getCurrentWallet(o),u=c.useMemo(()=>{const h=a?.toLowerCase();return o.wallets.map(y=>{const f=l?y.chainAddresses.find(g=>g.chain===l):y.chainAddresses[0];return!f||h&&f.address.toLowerCase()===h?null:{id:y.id,name:y.name,address:f.address,themeHue:y.themeHue,chainIconUrl:void 0}}).filter(y=>y!==null)},[o.wallets,l,a]),m=c.useMemo(()=>{const h=new Map;return o.wallets.forEach(y=>{const f=l?y.chainAddresses.find(g=>g.chain===l):y.chainAddresses[0];f&&h.set(y.id,{wallet:y,chainAddress:f})}),h},[o.wallets,l]),p=h=>{const y=m.get(h);if(!y)return;const f=new CustomEvent("wallet-picker-select",{detail:{address:y.chainAddress.address,chain:y.chainAddress.chain,name:y.wallet.name,publicKey:y.chainAddress.publicKey}});window.dispatchEvent(f),s()},x=()=>{const h=new CustomEvent("wallet-picker-cancel");window.dispatchEvent(h),s()};return t.jsx(ge,{children:t.jsxs("div",{className:"bg-background rounded-t-2xl",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),t.jsx(Yo,{title:e("selectWallet",""),description:`${r||e("unknownDApp"," DApp")} ${e("requestsAccess","")}`,appName:r,appIcon:i}),t.jsx("div",{className:"max-h-[50vh] overflow-y-auto p-4",children:u.length===0?t.jsx("div",{className:"text-muted-foreground py-12 text-center text-sm",children:l?e("noWalletsForChain"," {{chain}} ",{chain:l}):e("noWallets","")}):t.jsx(jf,{wallets:u,currentWalletId:d?.id,onSelect:p,showAddButton:!1})}),t.jsx("div",{className:"border-border border-t p-4",children:t.jsx("button",{onClick:x,className:"bg-muted hover:bg-muted/80 w-full rounded-xl py-3 font-medium transition-colors",children:e("cancel","")})}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Sd=({params:e})=>t.jsx(he,{params:e,children:t.jsx(Wb,{})});Sd.__docgenInfo={description:"",methods:[],displayName:"WalletPickerJob"};function $b(){const{t:e}=F("common"),{pop:s,push:n}=se(),{message:a,address:r,appName:i,appIcon:l,chainName:o}=be(),d=Le(),[u,m]=c.useState(!1),p=c.useCallback(()=>{u||(ts(async y=>{m(!0);try{const f=d?.encryptedMnemonic;if(!f)return console.error("[SigningConfirmJob] No encrypted mnemonic found"),!1;const g=`miniapp_sign_${Date.now()}`,v=await new Dr(ys,g).handleMessageSign({chainName:o||"bioforest",senderAddress:r,message:a},f,y),j=new CustomEvent("signing-confirm",{detail:{confirmed:!0,signature:v.signature,publicKey:v.publicKey}});return window.dispatchEvent(j),s(),!0}catch(f){return console.error("[SigningConfirmJob] Signing failed:",f),!1}finally{m(!1)}}),n("WalletLockConfirmJob",{title:e("sign","")}))},[u,d,o,r,a,s,n,e]),x=c.useCallback(()=>{const y=new CustomEvent("signing-confirm",{detail:{confirmed:!1}});window.dispatchEvent(y),s()},[s]),h=a.startsWith("0x")&&/^0x[0-9a-fA-F]+$/.test(a);return t.jsx(ge,{children:t.jsxs("div",{className:"bg-background rounded-t-2xl",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),t.jsxs("div",{className:"border-border border-b px-4 pb-4",children:[t.jsx("div",{className:"mx-auto mb-3 flex size-14 items-center justify-center rounded-2xl bg-primary/10 overflow-hidden",children:l?t.jsx("img",{src:l,alt:i,className:"size-full object-cover"}):t.jsx(la,{className:"size-8 text-primary"})}),t.jsx("h2",{className:"text-center text-lg font-semibold",children:e("signMessage","")}),t.jsx("p",{className:"text-muted-foreground mt-1 text-center text-sm",children:i||e("unknownDApp"," DApp")})]}),t.jsxs("div",{className:"space-y-4 p-4",children:[t.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[t.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:e("signingAddress","")}),t.jsx(Ct,{address:r,copyable:!1,className:"text-sm"})]}),t.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[t.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:e("message","")}),t.jsx("div",{className:"max-h-40 overflow-y-auto",children:t.jsx("pre",{className:"whitespace-pre-wrap break-all font-mono text-sm",children:a})})]}),h&&t.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[t.jsx(qe,{className:"size-5 shrink-0 text-amber-600"}),t.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:e("hexDataWarning","")})]})]}),t.jsxs("div",{className:"flex gap-3 p-4",children:[t.jsx("button",{onClick:x,disabled:u,className:"bg-muted hover:bg-muted/80 disabled:opacity-50 flex-1 rounded-xl py-3 font-medium transition-colors",children:e("cancel","")}),t.jsx("button",{onClick:p,disabled:u,className:z("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","disabled:opacity-50 flex items-center justify-center gap-2"),children:u?t.jsxs(t.Fragment,{children:[t.jsx(Ve,{className:"size-4 animate-spin"}),e("signing","...")]}):e("sign","")})]}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Cd=({params:e})=>t.jsx(he,{params:e,children:t.jsx($b,{})});Cd.__docgenInfo={description:"",methods:[],displayName:"SigningConfirmJob"};const Hb={bio_requestAccounts:{icon:Cr,label:"",description:""},bio_createTransaction:{icon:el,label:"",description:"/"},bio_signMessage:{icon:Ca,label:"",description:""},bio_signTypedData:{icon:Ca,label:"",description:""},bio_signTransaction:{icon:Ca,label:"",description:""},bio_sendTransaction:{icon:Lp,label:"",description:""}};function qb(){const{t:e}=F("common"),{pop:s}=se(),{appName:n,appIcon:a,permissions:r}=be(),i=(()=>{try{return JSON.parse(r)}catch{return[]}})(),l=()=>{const d=new CustomEvent("permission-request",{detail:{approved:!0,permissions:i}});window.dispatchEvent(d),s()},o=()=>{const d=new CustomEvent("permission-request",{detail:{approved:!1}});window.dispatchEvent(d),s()};return t.jsx(ge,{children:t.jsxs("div",{className:"bg-background rounded-t-2xl",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),t.jsxs("div",{className:"border-border border-b px-4 pb-4",children:[t.jsx("div",{className:"mx-auto mb-3 flex size-14 items-center justify-center rounded-2xl bg-primary/10",children:a?t.jsx("img",{src:a,alt:n,className:"size-10 rounded-xl"}):t.jsx(la,{className:"text-primary size-8"})}),t.jsx("h2",{className:"text-center text-lg font-semibold",children:n}),t.jsx("p",{className:"text-muted-foreground mt-1 text-center text-sm",children:e("requestsPermissions","")})]}),t.jsxs("div",{className:"p-4",children:[t.jsx("div",{className:"space-y-3",children:i.map(d=>{const u=Hb[d];if(!u)return null;const m=u.icon;return t.jsxs("div",{className:"bg-muted/50 flex items-center gap-3 rounded-xl p-3",children:[t.jsx("div",{className:"bg-primary/10 flex size-10 shrink-0 items-center justify-center rounded-full",children:t.jsx(m,{className:"text-primary size-5"})}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsx("p",{className:"font-medium",children:u.label}),t.jsx("p",{className:"text-muted-foreground text-sm",children:u.description})]})]},d)})}),t.jsxs("div",{className:"mt-4 flex items-center gap-2 text-sm text-muted-foreground",children:[t.jsx(al,{className:"size-4"}),t.jsx("span",{children:e("permissionNote","")})]})]}),t.jsxs("div",{className:"flex gap-3 p-4",children:[t.jsx("button",{onClick:o,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors",children:e("reject","")}),t.jsx("button",{onClick:l,className:z("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90"),children:e("approve","")})]}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const kd=({params:e})=>t.jsx(he,{params:e,children:t.jsx(qb,{})});kd.__docgenInfo={description:"",methods:[],displayName:"PermissionRequestJob"};function Vb(){const{t:e}=F("common"),{pop:s,push:n}=se(),a=be(),{appName:r,appIcon:i,from:l,to:o,amount:d,chain:u,asset:m}=a,p=Le(),[x,h]=c.useState(!1),y=c.useCallback(()=>{x||(ts(async b=>{h(!0);try{const v=p?.encryptedMnemonic;if(!v)return console.error("[MiniappTransferConfirmJob] No encrypted mnemonic found"),!1;const j=`miniapp_transfer_${Date.now()}`,w=new Dr(ys,j),N={chainName:u,senderAddress:l,receiveAddress:o,balance:d};m&&(N.assetType=m);const S=await w.handleTransferSign(N,v,b),A=new CustomEvent("miniapp-transfer-confirm",{detail:{confirmed:!0,txHash:S}});return window.dispatchEvent(A),s(),!0}catch(v){return console.error("[MiniappTransferConfirmJob] Transfer failed:",v),!1}finally{h(!1)}}),n("WalletLockConfirmJob",{title:e("confirmTransfer","")}))},[x,p,u,l,o,d,m,s,n,e]),f=c.useCallback(()=>{const b=new CustomEvent("miniapp-transfer-confirm",{detail:{confirmed:!1}});window.dispatchEvent(b),s()},[s]),g=m||u.toUpperCase();return t.jsx(ge,{children:t.jsxs("div",{className:"bg-background rounded-t-2xl",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),t.jsxs("div",{className:"border-border border-b px-4 pb-4",children:[t.jsx("div",{className:"mx-auto mb-3 flex size-14 items-center justify-center rounded-2xl bg-primary/10 overflow-hidden",children:i?t.jsx("img",{src:i,alt:r,className:"size-full object-cover"}):t.jsx(la,{className:"size-8 text-primary"})}),t.jsx("h2",{className:"text-center text-lg font-semibold",children:e("confirmTransfer","")}),t.jsxs("p",{className:"text-muted-foreground mt-1 text-center text-sm",children:[r||e("unknownDApp"," DApp")," ",e("requestsTransfer","")]})]}),t.jsxs("div",{className:"space-y-4 p-4",children:[t.jsx("div",{className:"bg-muted/50 rounded-xl p-4 text-center",children:t.jsx(os,{value:d,symbol:g,size:"xl",weight:"bold",decimals:8})}),t.jsxs("div",{className:"bg-muted/50 rounded-xl p-4 space-y-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"text-muted-foreground text-xs w-10 shrink-0",children:e("from","")}),t.jsx(Ct,{address:l,copyable:!0,className:"flex-1 text-sm"})]}),t.jsx("div",{className:"flex justify-center",children:t.jsx(ua,{className:"size-4 text-muted-foreground"})}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"text-muted-foreground text-xs w-10 shrink-0",children:e("to","")}),t.jsx(Ct,{address:o,copyable:!0,className:"flex-1 text-sm"})]})]}),t.jsxs("div",{className:"bg-muted/50 rounded-xl p-3 flex items-center justify-between",children:[t.jsx("span",{className:"text-muted-foreground text-sm",children:e("network","")}),t.jsx("span",{className:"text-sm font-medium",children:u})]}),t.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[t.jsx(qe,{className:"size-5 shrink-0 text-amber-600 mt-0.5"}),t.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:e("transferWarning","")})]})]}),t.jsxs("div",{className:"flex gap-3 p-4",children:[t.jsx("button",{onClick:f,disabled:x,className:"bg-muted hover:bg-muted/80 disabled:opacity-50 flex-1 rounded-xl py-3 font-medium transition-colors",children:e("cancel","")}),t.jsx("button",{onClick:y,disabled:x,className:z("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","disabled:opacity-50 flex items-center justify-center gap-2"),children:x?t.jsxs(t.Fragment,{children:[t.jsx(Ve,{className:"size-4 animate-spin"}),e("confirming","...")]}):e("confirm","")})]}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Ad=({params:e})=>t.jsx(he,{params:e,children:t.jsx(Vb,{})});Ad.__docgenInfo={description:"",methods:[],displayName:"MiniappTransferConfirmJob"};function Ub(e,s){const n=s.startsWith("0x"),a=n?s.toLowerCase():s;for(const r of Ce.state.wallets)if(r.chainAddresses.find(l=>l.chain!==e?!1:n||l.address.startsWith("0x")?l.address.toLowerCase()===a:l.address===a))return r.id;return null}function Jb(){const{t:e}=F("common"),{pop:s,push:n}=se(),a=be(),{appName:r,appIcon:i,from:l,chain:o,unsignedTx:d}=a,[u,m]=c.useState(!1),p=c.useMemo(()=>{try{return JSON.parse(d)}catch{return null}},[d]),x=c.useMemo(()=>Ub(o,l),[o,l]),h=c.useCallback(()=>{u||p&&x&&(ts(async g=>{m(!0);try{const b=await Um({walletId:x,password:g,from:l,chainId:o,unsignedTx:p}),v=new CustomEvent("miniapp-sign-transaction-confirm",{detail:{confirmed:!0,signedTx:b}});return window.dispatchEvent(v),s(),!0}catch(b){return console.error("[MiniappSignTransactionJob] signTransaction failed:",b),!1}finally{m(!1)}}),n("WalletLockConfirmJob",{title:e("signTransaction","")}))},[o,l,u,s,n,e,p,x]),y=c.useCallback(()=>{const g=new CustomEvent("miniapp-sign-transaction-confirm",{detail:{confirmed:!1}});window.dispatchEvent(g),s()},[s]),f=c.useMemo(()=>{if(!p)return"";try{return JSON.stringify(p.data,null,2)}catch{return String(p.data)}},[p]);return t.jsx(ge,{children:t.jsxs("div",{className:"bg-background rounded-t-2xl",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),t.jsxs("div",{className:"border-border border-b px-4 pb-4",children:[t.jsx("div",{className:"mx-auto mb-3 flex size-14 items-center justify-center rounded-2xl bg-primary/10 overflow-hidden",children:i?t.jsx("img",{src:i,alt:r,className:"size-full object-cover"}):t.jsx(la,{className:"size-8 text-primary"})}),t.jsx("h2",{className:"text-center text-lg font-semibold",children:e("signTransaction","")}),t.jsx("p",{className:"text-muted-foreground mt-1 text-center text-sm",children:r||e("unknownDApp"," DApp")})]}),t.jsxs("div",{className:"space-y-4 p-4",children:[!p&&t.jsx("div",{className:"rounded-xl bg-destructive/10 p-3 text-sm text-destructive",children:e("invalidTransaction","")}),p&&!x&&t.jsx("div",{className:"rounded-xl bg-amber-50 p-3 text-sm text-amber-800 dark:bg-amber-950/30 dark:text-amber-200",children:e("signingAddressNotFound","")}),t.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[t.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:e("network","")}),t.jsx("p",{className:"text-sm font-medium",children:o})]}),t.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[t.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:e("signingAddress","")}),t.jsx("p",{className:"text-sm font-mono break-all",children:l})]}),t.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[t.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:e("transaction","")}),t.jsx("div",{className:"max-h-44 overflow-y-auto",children:t.jsx("pre",{className:"whitespace-pre-wrap break-all font-mono text-xs",children:f})})]}),t.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[t.jsx(qe,{className:"size-5 shrink-0 text-amber-600 mt-0.5"}),t.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:e("signTxWarning","")})]})]}),t.jsxs("div",{className:"flex gap-3 p-4",children:[t.jsx("button",{onClick:y,disabled:u,className:"bg-muted hover:bg-muted/80 disabled:opacity-50 flex-1 rounded-xl py-3 font-medium transition-colors",children:e("cancel","")}),t.jsx("button",{onClick:h,disabled:u||!p||!x,className:z("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","disabled:opacity-50 flex items-center justify-center gap-2"),children:u?t.jsxs(t.Fragment,{children:[t.jsx(Ve,{className:"size-4 animate-spin"}),e("signing","...")]}):e("sign","")})]}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Id=({params:e})=>t.jsx(he,{params:e,children:t.jsx(Jb,{})});Id.__docgenInfo={description:"",methods:[],displayName:"MiniappSignTransactionJob"};function Co(e){const s=ca(e);if(s&&Ja[s])return Ja[s];try{return`Chain ${Ym(e)}`}catch{return e}}function ko(e){return ca(e)}function Kb(){const{t:e}=F("common"),{pop:s}=se(),{fromChainId:n,toChainId:a,appName:r,appIcon:i}=be(),l=Co(n),o=Co(a),d=ko(n),u=ko(a),m=()=>{const x=new CustomEvent("chain-switch-confirm",{detail:{approved:!0,toChainId:a}});window.dispatchEvent(x),s()},p=()=>{const x=new CustomEvent("chain-switch-confirm",{detail:{approved:!1}});window.dispatchEvent(x),s()};return t.jsx(ge,{children:t.jsxs("div",{className:"bg-background rounded-t-2xl",children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),t.jsx(Yo,{title:e("switchNetwork",""),description:`${r||e("unknownDApp"," DApp")} ${e("requestsNetworkSwitch","")}`,appName:r,appIcon:i}),t.jsxs("div",{className:"flex items-center justify-center gap-4 px-6 py-8",children:[t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[d?t.jsx(vs,{chain:d,size:"lg"}):t.jsx("div",{className:"bg-muted flex size-12 items-center justify-center rounded-full",children:t.jsx(qe,{className:"text-muted-foreground size-6"})}),t.jsx("span",{className:"text-muted-foreground text-sm",children:l})]}),t.jsx(Ap,{className:"text-primary size-8"}),t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[u?t.jsx(vs,{chain:u,size:"lg"}):t.jsx("div",{className:"bg-muted flex size-12 items-center justify-center rounded-full",children:t.jsx(qe,{className:"text-muted-foreground size-6"})}),t.jsx("span",{className:"font-medium",children:o})]})]}),t.jsx("div",{className:"bg-warning/10 border-warning/20 mx-4 mb-4 rounded-lg border p-3",children:t.jsx("p",{className:"text-warning text-sm",children:e("chainSwitchWarning","")})}),t.jsxs("div",{className:"flex gap-3 p-4",children:[t.jsx("button",{onClick:p,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors",children:e("cancel","")}),t.jsx("button",{onClick:m,className:"bg-primary hover:bg-primary/90 text-primary-foreground flex-1 rounded-xl py-3 font-medium transition-colors",children:e("confirm","")})]}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Td=({params:e})=>t.jsx(he,{params:e,children:t.jsx(Kb,{})});Td.__docgenInfo={description:"",methods:[],displayName:"ChainSwitchConfirmJob"};const Gb={"zh-CN":"","zh-TW":"",en:"English",ja:"",ko:"",ar:""},Qb={USD:"USD ($)",CNY:"CNY ()",EUR:"EUR ()",JPY:"JPY ()",KRW:"KRW ()"};function ai(){const{navigate:e}=fe(),{push:s}=se(),{t:n}=F(["settings","common","security"]),a=Le(),r=sn(),i=xr(),l=hr(),[o,d]=c.useState(!1),[u,m]=c.useState("loading");c.useEffect(()=>{async function y(){if(!a){m("unavailable");return}const f=a.chainAddresses.find(g=>g.chain==="bfmeta"||g.chain==="bfm");if(!f){m("unavailable");return}try{const g=Us.getChainById(qa.state,"bfmeta");if(!g){m("unavailable");return}const b=await rb(g,f.address);m(b?"set":"not_set")}catch{m("unavailable")}}y()},[a]);const p=()=>n(`settings:appearance.${l}`),x=()=>{switch(u){case"loading":return"...";case"set":return n("security:twoStepSecret.alreadySet");case"not_set":return n("security:twoStepSecret.notSet");default:return n("settings:notSupported")}},h=async()=>{if(u!=="not_set"||!a)return;const y=a.chainAddresses.find(b=>b.chain==="bfmeta"||b.chain==="bfm");if(!y)return;const f=Us.getChainById(qa.state,"bfmeta");if(!f)return;const g=await ab(f);gb(async(b,v)=>{const j=await nb({chainConfig:f,walletId:a.id,password:v,fromAddress:y.address,newTwoStepSecret:b});return j.status==="ok"?(m("set"),{success:!0,txHash:j.txHash}):j.status==="password"?{success:!1,error:n("security:passwordConfirm.verifying")}:j.status==="already_set"?(m("set"),{success:!1,error:n("security:twoStepSecret.alreadySet")}):{success:!1,error:j.message}},g??void 0,async()=>{const{getAddressInfo:b}=await Ln(async()=>{const{getAddressInfo:N}=await import("./index-Ar-6A-5n.js").then(M=>M.o);return{getAddressInfo:N}},__vite__mapDeps([2,3,4,1,5,6,7,8,9,10]),import.meta.url),v=f.apis.find(N=>N.type==="biowallet-v1"),j=v?.endpoint,w=v?.config?.path??f.id;if(!j)return!1;try{return!!(await b(j,w,y.address)).secondPublicKey}catch{return!1}}),s("SetTwoStepSecretJob",{chainName:"BioForest Chain"})};return t.jsxs("div",{className:"bg-muted/30 flex h-full flex-col overflow-y-auto",children:[t.jsx(Q,{title:n("common:a11y.tabSettings")}),t.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[a&&t.jsxs("div",{className:"bg-card flex items-center gap-4 rounded-xl p-4 shadow-sm",children:[t.jsx("div",{className:"bg-primary/10 flex size-14 items-center justify-center rounded-full text-2xl",children:a.name.slice(0,1)}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h2",{className:"font-semibold",children:a.name}),t.jsx("p",{className:"text-muted-foreground text-sm",children:n("settings:chainAddressCount",{count:a.chainAddresses.length})})]})]}),t.jsxs(Bs,{title:n("settings:sections.walletManagement"),children:[t.jsx(Ee,{icon:t.jsx(Cr,{size:20}),label:n("settings:items.walletManagement"),onClick:()=>e({to:`/wallet/${a?.id??""}`})}),t.jsx("div",{className:"bg-border mx-4 h-px"}),t.jsx(Ee,{icon:t.jsx(Sl,{size:20}),label:n("settings:items.walletChains"),onClick:()=>e({to:"/settings/wallet-chains"}),testId:"wallet-chains-button"}),t.jsx("div",{className:"bg-border mx-4 h-px"}),t.jsx(Ee,{icon:t.jsx(yp,{size:20}),label:n("settings:items.addressBook"),onClick:()=>e({to:"/address-book"}),testId:"address-book-button"})]}),t.jsxs(Bs,{title:n("settings:sections.security"),children:[t.jsx(Ee,{icon:t.jsx(oa,{size:20}),label:n("settings:items.appLock"),value:n("settings:notSupported"),disabled:!0}),t.jsx("div",{className:"bg-border mx-4 h-px"}),t.jsx(Ee,{icon:t.jsx(kr,{size:20}),label:n("settings:items.viewMnemonic"),onClick:()=>e({to:"/settings/mnemonic"})}),t.jsx("div",{className:"bg-border mx-4 h-px"}),t.jsx(Ee,{icon:t.jsx(Er,{size:20}),label:n("settings:items.changeWalletLock"),onClick:()=>e({to:"/settings/wallet-lock"})}),t.jsx("div",{className:"bg-border mx-4 h-px"}),t.jsx(Ee,{icon:t.jsx(ff,{size:20}),label:n("security:twoStepSecret.setup"),value:x(),onClick:h,disabled:u==="set"||u==="unavailable",testId:"set-pay-password-button"})]}),t.jsxs(Bs,{title:n("settings:sections.preferences"),children:[t.jsx(Ee,{icon:t.jsx(Jp,{size:20}),label:n("settings:items.language"),value:Gb[r],onClick:()=>e({to:"/settings/language"})}),t.jsx("div",{className:"bg-border mx-4 h-px"}),t.jsx(Ee,{icon:t.jsx(Dp,{size:20}),label:n("settings:items.currency"),value:Qb[i],onClick:()=>e({to:"/settings/currency"})}),t.jsx("div",{className:"bg-border mx-4 h-px"}),t.jsx(Ee,{icon:t.jsx(eh,{size:20}),label:n("settings:items.appearance"),value:p(),onClick:()=>d(!0)}),t.jsx("div",{className:"bg-border mx-4 h-px"}),t.jsx(Ee,{icon:t.jsx(Xp,{size:20}),label:n("settings:items.chainConfig"),onClick:()=>e({to:"/settings/chains"})}),t.jsx("div",{className:"bg-border mx-4 h-px"}),t.jsx(Ee,{icon:t.jsx(kl,{size:20}),label:"",onClick:()=>e({to:"/settings/sources"})})]}),t.jsxs(Bs,{title:n("settings:sections.about"),children:[t.jsx(Ee,{icon:t.jsx(If,{size:20}),label:n("settings:items.aboutApp"),value:"v1.0.0",onClick:()=>{}}),t.jsx("div",{className:"bg-border mx-4 h-px"}),t.jsx(Ee,{icon:t.jsx(Nl,{size:20}),label:n("settings:items.storage"),onClick:()=>e({to:"/settings/storage"}),testId:"storage-button"})]}),t.jsx("div",{className:"h-[var(--tab-bar-height)]"})]}),t.jsx(td,{open:o,onOpenChange:d})]})}ai.__docgenInfo={description:"",methods:[],displayName:"SettingsPage"};function Pd(){return t.jsx(ai,{})}Pd.__docgenInfo={description:`SettingsTab - 

 SettingsPage `,methods:[],displayName:"SettingsTab"};function Yb(e,s){let n=e.toString();const a=n.startsWith("-");a&&(n=n.slice(1)),n=n.padStart(s,"0");let[r,i]=[n.slice(0,n.length-s),n.slice(n.length-s)];return i=i.replace(/(0+)$/,""),`${a?"-":""}${r||"0"}${i?`.${i}`:""}`}const Ed=({params:e})=>{const{push:s}=se(),[n,a]=c.useState(e.tab||"wallet");return c.useEffect(()=>(Jm(),di().setPermissionRequestCallback(async(r,i,l)=>{const o=Km.state.apps.get(r)?.manifest.icon;return new Promise(d=>{const u=window.setTimeout(()=>d(!1),3e4),m=p=>{window.clearTimeout(u);const x=p.detail;d(x?.approved===!0)};window.addEventListener("permission-request",m,{once:!0}),s("PermissionRequestJob",{appName:i,appIcon:o,permissions:JSON.stringify(l)})})}),ui(async r=>{const i=r?.app?.name,l=r?.app?.icon;return new Promise(o=>{const d=window.setTimeout(()=>o(null),3e4),u=()=>{window.clearTimeout(d),window.removeEventListener("wallet-picker-select",m),window.removeEventListener("wallet-picker-cancel",p)},m=x=>{u();const h=x.detail;o({address:h.address,chain:h.chain,name:h.name})},p=()=>{u(),o(null)};window.addEventListener("wallet-picker-select",m),window.addEventListener("wallet-picker-cancel",p),s("WalletPickerJob",{chain:r?.chain,exclude:r?.exclude,...i?{appName:i}:{},...l?{appIcon:l}:{}})})}),mi(()=>{const r=Ce.state,i=Ue.getCurrentWallet(r);return i?i.chainAddresses.map(l=>({address:l.address,chain:l.chain,name:i.name})):[]}),fi(async r=>new Promise(i=>{const l=window.setTimeout(()=>i(null),6e4),o=d=>{window.clearTimeout(l);const u=d.detail;if(u?.confirmed&&u.signature&&u.publicKey){i({signature:u.signature,publicKey:u.publicKey});return}i(null)};window.addEventListener("signing-confirm",o,{once:!0}),s("SigningConfirmJob",{message:r.message,address:r.address,appName:r.app.name,appIcon:r.app.icon??"",chainName:"bioforest"})})),pi(async r=>new Promise(i=>{const l=window.setTimeout(()=>i(null),6e4),o=d=>{window.clearTimeout(l);const u=d.detail;if(u?.confirmed&&u.txHash){i({txHash:u.txHash});return}i(null)};window.addEventListener("miniapp-transfer-confirm",o,{once:!0}),s("MiniappTransferConfirmJob",{appName:r.app.name,appIcon:r.app.icon??"",from:r.from,to:r.to,amount:r.amount,chain:r.chain,...r.asset?{asset:r.asset}:{}})})),hi(async r=>new Promise(i=>{const l=window.setTimeout(()=>i(null),6e4),o=d=>{window.clearTimeout(l);const u=d.detail;if(u?.confirmed&&u.signedTx){i(u.signedTx);return}i(null)};window.addEventListener("miniapp-sign-transaction-confirm",o,{once:!0}),s("MiniappSignTransactionJob",{appName:r.app.name,appIcon:r.app.icon??"",from:r.from,chain:r.chain,unsignedTx:JSON.stringify(r.unsignedTx)})})),xi(async r=>{const i=r.app?.name,l=r.app?.icon;return new Promise(o=>{const d=window.setTimeout(()=>o(null),3e4),u=()=>{window.clearTimeout(d),window.removeEventListener("wallet-picker-select",m),window.removeEventListener("wallet-picker-cancel",p)},m=x=>{u();const h=x.detail;o({address:h.address,chain:h.chain,name:h.name})},p=()=>{u(),o(null)};window.addEventListener("wallet-picker-select",m),window.addEventListener("wallet-picker-cancel",p),s("WalletPickerJob",{chain:r.chainId,...i?{appName:i}:{},...l?{appIcon:l}:{}})})}),gi(async r=>new Promise(i=>{const l=window.setTimeout(()=>i(!1),3e4),o=d=>{window.clearTimeout(l);const u=d.detail;i(u?.approved===!0)};window.addEventListener("chain-switch-confirm",o,{once:!0}),s("ChainSwitchConfirmJob",{fromChainId:r.fromChainId,toChainId:r.toChainId,appName:r.appName,appIcon:r.appIcon})})),vi(async r=>new Promise(i=>{const l=window.setTimeout(()=>i(null),6e4),o=d=>{window.clearTimeout(l);const u=d.detail;if(u?.confirmed&&u.signature){i({signature:u.signature});return}i(null)};window.addEventListener("signing-confirm",o,{once:!0}),s("SigningConfirmJob",{message:r.message,address:r.address,appName:r.appName,chainName:"ethereum"})})),bi(async r=>{const{from:i,to:l,value:o,chainId:d}=r.tx;if(!i||!l)return null;const u=BigInt(o??"0x0"),m=Yb(u,18),p=d?ca(d):null;return new Promise(x=>{const h=window.setTimeout(()=>x(null),6e4),y=f=>{window.clearTimeout(h);const g=f.detail;if(g?.confirmed&&g.txHash){x({txHash:g.txHash});return}x(null)};window.addEventListener("miniapp-transfer-confirm",y,{once:!0}),s("MiniappTransferConfirmJob",{appName:r.appName,from:i,to:l,amount:m,chain:p??"ethereum"})})}),yi(async r=>{const i=r?.app?.name,l=r?.app?.icon;return new Promise(o=>{const d=window.setTimeout(()=>o(null),3e4),u=()=>{window.clearTimeout(d),window.removeEventListener("wallet-picker-select",m),window.removeEventListener("wallet-picker-cancel",p)},m=x=>{u();const h=x.detail;o({address:h.address,chain:h.chain,name:h.name})},p=()=>{u(),o(null)};window.addEventListener("wallet-picker-select",m),window.addEventListener("wallet-picker-cancel",p),s("WalletPickerJob",{chain:"tron",...i?{appName:i}:{},...l?{appIcon:l}:{}})})}),()=>{di().setPermissionRequestCallback(null),ui(null),xi(null),gi(null),vi(null),bi(null),yi(null),mi(null),fi(null),pi(null),hi(null)}),[s]),t.jsx(ce,{children:t.jsx(Im,{children:t.jsxs("div",{className:"bg-background relative h-dvh",children:[t.jsx(c.Activity,{mode:n==="wallet"?"visible":"hidden",children:t.jsx(Wc,{})}),t.jsx("div",{style:{display:n==="ecosystem"?"contents":"none"},children:t.jsx(ed,{})}),t.jsx(c.Activity,{mode:n==="settings"?"visible":"hidden",children:t.jsx(Pd,{})}),t.jsx(Tm,{activeTab:n,onTabChange:a})]})})})};Ed.__docgenInfo={description:"",methods:[],displayName:"MainTabsActivity"};function _d(){const{t:e}=F("wallet"),{navigate:s,goBack:n}=fe(),{push:a}=se(),r=Ne(Ce,m=>m.wallets),i=Ne(Ce,m=>m.currentWalletId),l=c.useCallback(m=>{ye.setCurrentWallet(m)},[]),o=c.useCallback(m=>{s({to:`/wallet/${m}`})},[s]),d=c.useCallback(()=>{a("WalletAddJob",{})},[a]),u=c.useCallback(()=>{n()},[n]);return t.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("list.title"),onBack:u,rightAction:t.jsx("button",{onClick:d,className:z("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":e("add"),children:t.jsx(kt,{className:"size-5"})})}),t.jsx("div",{className:"flex-1 p-4",children:r.length===0?t.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[t.jsx("p",{className:"text-muted-foreground",children:e("list.empty")}),t.jsx("button",{onClick:d,className:z("bg-primary rounded-full px-6 py-2.5 text-sm font-medium text-primary-foreground","hover:bg-primary/90 active:bg-primary/80"),children:e("add")})]}):t.jsx("div",{className:"space-y-3",children:r.map(m=>t.jsx(Xb,{wallet:m,isActive:m.id===i,onSelect:()=>l(m.id),onDetail:()=>o(m.id),t:e},m.id))})})]})}function Xb({wallet:e,isActive:s,onSelect:n,onDetail:a,t:r}){const i=e.chainAddresses.reduce((l,o)=>l+o.tokens.reduce((d,u)=>d+u.fiatValue,0),0);return t.jsxs("div",{className:z("bg-card rounded-xl p-4 shadow-sm transition-colors",s&&"ring-primary ring-2"),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("button",{onClick:n,className:z("flex size-12 items-center justify-center rounded-full text-lg font-semibold",s?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),children:e.name.slice(0,1)}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("h3",{className:"truncate font-semibold",children:e.name}),s&&t.jsxs("span",{className:"text-primary flex items-center gap-1 text-xs",children:[t.jsx(je,{className:"size-3"}),r("list.current")]})]}),t.jsx("p",{className:"text-muted-foreground text-sm",children:r("list.chainAddresses",{count:e.chainAddresses.length})})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"text-right",children:t.jsxs("p",{className:"font-semibold",children:["$",i.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})}),t.jsx("button",{onClick:a,className:z("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":r("list.viewDetail"),children:t.jsx(Be,{className:"text-muted-foreground size-5"})})]})]}),t.jsx("p",{className:"text-muted-foreground mt-2 truncate font-mono text-xs",children:e.address})]})}_d.__docgenInfo={description:"",methods:[],displayName:"WalletListPage"};const Md=()=>t.jsx(ce,{children:t.jsx(_d,{})});Md.__docgenInfo={description:"",methods:[],displayName:"WalletListActivity"};function Zb(){const{t:e}=F("wallet"),{walletId:s,mode:n="default"}=be(),{goBack:a,navigate:r}=fe(),l=Xt().find(u=>u.id===s),o=()=>{r({to:"/",replace:!0})};if(!l)return t.jsxs("div",{className:"flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("detail.title"),onBack:a}),t.jsx("div",{className:"flex-1 p-4",children:t.jsx(bs,{variant:"error",children:e("detail.notFound")})})]});const d=e(n==="edit-only"?"detail.editTitle":"detail.title");return t.jsxs("div",{className:"flex min-h-screen flex-col",children:[t.jsx(Q,{title:d,...n!=="edit-only"&&{onBack:a}}),t.jsxs("div",{className:"flex-1 p-4",children:[t.jsx(ba,{mode:n,walletId:s,onEditOnlyComplete:o}),n==="default"&&t.jsx("div",{className:"mt-6",children:t.jsx(bs,{variant:"warning",children:e("detail.securityWarning")})})]})]})}const Rd=({params:e})=>t.jsx(ce,{children:t.jsx(he,{params:e,children:t.jsx(Zb,{})})});Rd.__docgenInfo={description:"",methods:[],displayName:"WalletConfigActivity"};const ey=["pattern","mnemonic","verify","chains","theme"];function Dd(){const{goBack:e,navigate:s}=fe(),{t:n}=F("onboarding"),a=en(),[r,i]=c.useState("pattern"),[l,o]=c.useState(""),[d]=c.useState(()=>{if(typeof window<"u"){const E=window.__E2E_MNEMONIC__;if(typeof E=="string"&&E.trim())return E.trim().split(/\s+/);if(Array.isArray(E)&&E.every(k=>typeof k=="string"))return E}return Ef()}),[u,m]=c.useState(!0),[p,x]=c.useState(!1),[h,y]=c.useState([]),[f,g]=c.useState(!1),[b,v]=c.useState(!1),[j,w]=c.useState(null),N=ey.indexOf(r)+1;c.useEffect(()=>{!f&&a.length>0&&(y(il(a)),g(!0))},[a,f]);const M=()=>{r==="mnemonic"?(i("pattern"),o("")):r==="verify"?i("mnemonic"):r==="chains"?i("verify"):r==="theme"||e()},S=E=>{o(E),i("mnemonic")},A=()=>{(p||!u)&&i("verify")},I=()=>{i("chains")},P=async()=>{if(!b){v(!0);try{const E=d.join(" "),T=(await Zo({mnemonic:E,selectedChainIds:h,chainConfigs:a})).map(({chainId:R,address:B,publicKey:$})=>({chain:R,address:B,publicKey:$??"",tokens:[]})),C=T[0];if(!C)throw new Error("No chain addresses derived");const L=Ua(C.address),_=await ye.createWallet({name:n("create.defaultWalletName"),keyType:"mnemonic",address:C.address,chain:C.chain,chainAddresses:T,themeHue:L},E,l,L);w(_.id),i("theme")}catch(E){console.error(n("create.createFailed"),E)}finally{v(!1)}}},D=()=>{s({to:"/",replace:!0})};return t.jsxs("div",{className:"flex min-h-screen flex-col",children:[t.jsx(Q,{title:n("create.title"),onBack:M}),t.jsx("div",{className:"px-4 pt-4",children:t.jsx(wt,{total:5,current:N})}),t.jsxs("div",{className:"flex-1 p-4",children:[r==="pattern"&&t.jsx("div",{"data-testid":"pattern-step",children:t.jsx(Nr,{onComplete:S,minPoints:4})}),r==="mnemonic"&&t.jsx("div",{"data-testid":"mnemonic-step",children:t.jsx(ty,{mnemonic:d,hidden:u,copied:p,onToggleHidden:()=>m(!u),onCopy:()=>x(!0),onContinue:A})}),r==="verify"&&t.jsx("div",{"data-testid":"verify-step",children:t.jsx(sy,{mnemonic:d,onContinue:I})}),r==="chains"&&t.jsx("div",{"data-testid":"chain-selector-step",children:t.jsx(ny,{chains:a,selectedChains:h,selectionCount:h.length,onSelectionChange:y,onComplete:P,completeLabel:n("create.nextStep"),isSubmitting:b})}),r==="theme"&&j&&t.jsx("div",{"data-testid":"theme-step",children:t.jsx(ba,{mode:"edit-only",walletId:j,onEditOnlyComplete:D})})]})]})}function ty({mnemonic:e,hidden:s,copied:n,onToggleHidden:a,onCopy:r,onContinue:i}){const{t:l}=F("onboarding"),o=n||!s;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsx(on,{icon:Er,variant:"warning",size:"lg",className:"mx-auto mb-4"}),t.jsx("h2",{className:"text-xl font-bold",children:l("create.backupMnemonic")}),t.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:l("create.backupHint")})]}),t.jsx(bs,{variant:"warning",children:l("create.mnemonicWarning")}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm font-medium",children:l("create.mnemonicTitle")}),t.jsxs("button",{type:"button","data-testid":"toggle-mnemonic-button",onClick:a,className:"text-primary flex items-center gap-1 text-sm",children:[s?t.jsx(kr,{className:"size-4"}):t.jsx(ll,{className:"size-4"}),l(s?"create.mnemonicShow":"create.mnemonicHide")]})]}),t.jsx(rl,{words:e,hidden:s,onCopy:r})]}),t.jsxs(et,{variant:"mint",className:"w-full","data-testid":"mnemonic-backed-up-button",disabled:!o,onClick:i,children:[l(o?"create.mnemonicBackedUp":"create.mnemonicViewFirst"),o&&t.jsx(Be,{className:"ml-2 size-4"})]})]})}function sy({mnemonic:e,onContinue:s}){const{t:n}=F(["onboarding","common"]),[a]=c.useState(()=>Array.from({length:e.length},(p,x)=>x).sort(()=>Math.random()-.5).slice(0,3).sort((p,x)=>p-x)),[r,i]=c.useState({}),l=a.every(u=>{const m=e[u],p=r[u];return m&&p&&p.toLowerCase()===m.toLowerCase()}),o=(u,m)=>{i(p=>({...p,[u]:m}))},d=u=>{const m=e[u],p=r[u];if(p&&m&&p.toLowerCase()!==m.toLowerCase())return n("create.wordIncorrect")};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsx(on,{icon:As,variant:"success",size:"lg",className:"mx-auto mb-4"}),t.jsx("h2",{className:"text-xl font-bold",children:n("create.verifyTitle")}),t.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("create.verifyDesc")})]}),t.jsx("div",{className:"space-y-4",children:a.map(u=>t.jsx(Tf,{label:n("create.wordN",{n:u+1}),error:d(u),children:t.jsx(He,{"data-testid":`verify-word-input-${u}`,"data-verify-index":u,value:r[u]||"",onChange:m=>o(u,m.target.value),className:z(d(u)&&"border-destructive focus-visible:ring-destructive"),placeholder:n("create.wordNPlaceholder",{n:u+1}),autoCapitalize:"off",autoCorrect:"off"})},u))}),t.jsx(et,{variant:"mint",className:"w-full","data-testid":"verify-next-button",disabled:!l,onClick:s,children:n("common:next")})]})}function ny({chains:e,selectedChains:s,selectionCount:n,isSubmitting:a,completeLabel:r,onSelectionChange:i,onComplete:l}){const{t:o}=F(["onboarding","common"]);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsx(on,{icon:As,variant:"success",size:"lg",className:"mx-auto mb-4"}),t.jsx("h2",{className:"text-xl font-bold",children:o("chainSelector.title")}),t.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:o("chainSelector.subtitle")})]}),e.length===0?t.jsx("div",{className:"flex justify-center py-10",children:t.jsx(_e,{})}):t.jsx(Ar,{"data-testid":"chain-selector",chains:e,selectedChains:s,onSelectionChange:i}),t.jsx(et,{variant:"mint",className:"w-full","data-testid":"chain-selector-complete-button",disabled:n===0||a,onClick:l,children:r})]})}Dd.__docgenInfo={description:"",methods:[],displayName:"WalletCreatePage"};const zd=()=>t.jsx(ce,{children:t.jsx(Dd,{})});zd.__docgenInfo={description:"",methods:[],displayName:"WalletCreateActivity"};const ay={ETH:{amount:"0.002",symbol:"ETH"},USDT:{amount:"0.003",symbol:"ETH"},USDC:{amount:"0.003",symbol:"ETH"},BTC:{amount:"0.0001",symbol:"BTC"},TRX:{amount:"1",symbol:"TRX"},BFM:{amount:"0.1",symbol:"BFM"}},Ao={step:"input",asset:null,toAddress:"",amount:null,addressError:null,amountError:null,feeAmount:null,feeSymbol:"",feeLoading:!1,isSubmitting:!1,resultStatus:null,txHash:null,errorMessage:null};async function ry(e,s){const n=Ss(e.id);if(!n.supportsFeeEstimate)throw new Error(`Chain ${e.id} does not support fee estimation`);return{amount:(await n.estimateFee({from:s,to:s,amount:Me.fromRaw("1",e.decimals,e.symbol)})).standard.amount,symbol:e.symbol}}async function iy({chainConfig:e,walletId:s,password:n,fromAddress:a,toAddress:r,amount:i}){let l;try{l=await ur.getMnemonic(s,n)}catch(o){return o instanceof mr&&o.code===fr.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:o instanceof Error?o.message:""}}if(!i.isPositive())return{status:"error",message:""};try{const o=Ss(e.id);if(!o.supportsFullTransaction)return{status:"error",message:`: ${e.id}`};console.log("[submitWeb3Transfer] Starting transfer:",{chain:e.id,type:e.type,fromAddress:a,toAddress:r,amount:i.toRawString()});const d=rm(l);console.log("[submitWeb3Transfer] Building transaction...");const u=await o.buildTransaction({from:a,to:r,amount:i});console.log("[submitWeb3Transfer] Signing transaction...");const m=await o.signTransaction(u,d);console.log("[submitWeb3Transfer] Broadcasting transaction...");const p=await o.broadcastTransaction(m);return console.log("[submitWeb3Transfer] SUCCESS! txHash:",p),{status:"ok",txHash:p}}catch(o){console.error("[submitWeb3Transfer] FAILED:",o);const d=o instanceof Error?o.message:String(o);return d.includes("insufficient")||d.includes("")?{status:"error",message:""}:d.includes("fee")||d.includes("")||d.includes("gas")?{status:"error",message:""}:d.includes("not yet implemented")||d.includes("not supported")?{status:"error",message:""}:{status:"error",message:d||""}}}function oy(e,s){const n=Ss(e.id);return n.supportsAddressValidation?!s||s.trim()===""?"":n.isValidAddress(s)?null:"":""}function Ld(e,s){return e.trim()?s?Af(e):Hm(e):!1}function ly(e,s){return e.trim()?Ld(e,s)?null:"":""}function cy(e,s){return e?s?e.isPositive()?e.gt(s.amount)?"":null:"":null:""}function dy(e){const{toAddress:s,amount:n,asset:a,isBioforestChain:r,feeLoading:i}=e;return!a||!n||i?!1:s.trim()!==""&&Ld(s,r)&&n.isPositive()&&n.lte(a.amount)}function uy(e,s,n){if(!e)return{status:"error",message:""};const a=s.amount;if(e.add(n).lte(a))return{status:"ok"};if(!e.eq(a))return{status:"error",message:""};const r=a.sub(n);return r.isPositive()?{status:"ok",adjustedAmount:r}:{status:"error",message:""}}async function my(e){e(s=>({...s,step:"sending",isSubmitting:!0}));try{if(await new Promise(n=>setTimeout(n,2e3)),Math.random()>.2)return e(n=>({...n,step:"result",isSubmitting:!1,resultStatus:"success",txHash:`0x${Math.random().toString(16).slice(2)}${Math.random().toString(16).slice(2)}`,errorMessage:null})),{status:"ok"};throw new Error("")}catch(s){return e(n=>({...n,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:s instanceof Error?s.message:""})),{status:"error"}}}function fy(e={}){const{initialAsset:s,useMock:n=!0,walletId:a,fromAddress:r,chainConfig:i}=e,[l,o]=c.useState({...Ao,asset:s??null}),d=i?.chainKind==="bioforest",u=i?.chainKind==="evm"||i?.chainKind==="tron"||i?.chainKind==="bitcoin",m=c.useCallback(N=>u&&i?oy(i,N):ly(N,d),[d,u,i]),p=c.useCallback((N,M)=>cy(N,M),[]),x=c.useCallback(N=>{o(M=>({...M,toAddress:N,addressError:null}))},[]),h=c.useCallback(N=>{o(M=>({...M,amount:N,amountError:null}))},[]),y=c.useCallback(N=>{if(o(S=>({...S,asset:N,feeLoading:!0})),n||!d&&!u||!i||!r){setTimeout(()=>{const S=ay[N.assetType]??{amount:"0.001",symbol:N.assetType},A=Me.fromFormatted(S.amount,N.decimals,S.symbol);o(I=>({...I,feeAmount:A,feeSymbol:S.symbol,feeLoading:!1}))},300);return}(async()=>{try{const S=u?await ry(i,r):await tb(i,r);o(A=>({...A,feeAmount:S.amount,feeSymbol:S.symbol,feeLoading:!1}))}catch(S){o(A=>({...A,feeLoading:!1,errorMessage:S instanceof Error?S.message:""}))}})()},[i,r,d,u,n]);c.useEffect(()=>{if(n||!d||!i||!r)return;let N=!1;return(async()=>{try{const M=await sb(i,r);if(N)return;o(S=>({...S,asset:M}))}catch{if(N)return}})(),()=>{N=!0}},[i,r,d,n]);const f=c.useMemo(()=>dy({toAddress:l.toAddress,amount:l.amount,asset:l.asset,isBioforestChain:d,feeLoading:l.feeLoading}),[d,l.amount,l.asset,l.toAddress,l.feeLoading]),g=c.useCallback(()=>{const N=m(l.toAddress),M=l.asset?p(l.amount,l.asset):"";if(N||M)return o(S=>({...S,addressError:N,amountError:M})),!1;if(l.asset&&l.feeAmount&&l.amount){const S=uy(l.amount,l.asset,l.feeAmount);if(S.status==="error")return o(A=>({...A,amountError:S.message})),!1;S.adjustedAmount&&o(A=>({...A,amount:S.adjustedAmount??A.amount}))}return o(S=>({...S,step:"confirm",addressError:null,amountError:null})),!0},[l.toAddress,l.amount,l.asset,l.feeAmount,m,p]),b=c.useCallback(()=>{o(N=>({...N,step:"input"}))},[]),v=c.useCallback(async N=>{if(console.log("[useSend.submit] Called with:",{useMock:n,chainType:i?.type,walletId:a,fromAddress:r}),n)return console.log("[useSend.submit] Using mock transfer"),(await my(o)).status==="ok"?{status:"ok"}:{status:"error"};if(!i)return console.log("[useSend.submit] No chain config"),o(I=>({...I,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:""})),{status:"error"};if(i.chainKind==="evm"||i.chainKind==="tron"||i.chainKind==="bitcoin"){if(console.log("[useSend.submit] Using Web3 transfer for:",i.type),!a||!r||!l.asset||!l.amount)return o(P=>({...P,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:""})),{status:"error"};o(P=>({...P,step:"sending",isSubmitting:!0,errorMessage:null}));const I=await iy({chainConfig:i,walletId:a,password:N,fromAddress:r,toAddress:l.toAddress,amount:l.amount});return I.status==="password"?(o(P=>({...P,step:"confirm",isSubmitting:!1})),{status:"password"}):I.status==="error"?(o(P=>({...P,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:I.message})),{status:"error"}):(o(P=>({...P,step:"result",isSubmitting:!1,resultStatus:"success",txHash:I.txHash,errorMessage:null})),{status:"ok",txHash:I.txHash})}if(i.type!=="bioforest")return console.log("[useSend.submit] Chain type not supported:",i.type),o(I=>({...I,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:`: ${i.type}`})),{status:"error"};if(!a||!r||!l.asset)return o(I=>({...I,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:""})),{status:"error"};const M=m(l.toAddress),S=p(l.amount,l.asset);if(M||S)return o(I=>({...I,addressError:M,amountError:S})),{status:"error"};if(o(I=>({...I,step:"sending",isSubmitting:!0,errorMessage:null})),!l.amount)return o(I=>({...I,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:""})),{status:"error"};const A=await jo({chainConfig:i,walletId:a,password:N,fromAddress:r,toAddress:l.toAddress,amount:l.amount});return A.status==="password"?(o(I=>({...I,step:"confirm",isSubmitting:!1})),{status:"password"}):A.status==="password_required"?(o(I=>({...I,step:"confirm",isSubmitting:!1})),{status:"two_step_secret_required",secondPublicKey:A.secondPublicKey}):A.status==="error"?(o(I=>({...I,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:A.message})),{status:"error"}):(o(I=>({...I,step:"result",isSubmitting:!1,resultStatus:"success",txHash:A.txHash,errorMessage:null})),{status:"ok",txHash:A.txHash})},[i,r,l.amount,l.asset,l.toAddress,n,m,p,a]),j=c.useCallback(async(N,M)=>{if(!i||!a||!r)return{status:"error"};if(o(A=>({...A,step:"sending",isSubmitting:!0,resultStatus:null,txHash:null,errorMessage:null})),!l.amount)return o(A=>({...A,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:""})),{status:"error"};const S=await jo({chainConfig:i,walletId:a,password:N,fromAddress:r,toAddress:l.toAddress,amount:l.amount,twoStepSecret:M});return S.status==="password"?(o(A=>({...A,step:"confirm",isSubmitting:!1})),{status:"password"}):S.status==="error"?(o(A=>({...A,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:S.message})),{status:"error"}):S.status==="password_required"?(o(A=>({...A,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:""})),{status:"error"}):(o(A=>({...A,step:"result",isSubmitting:!1,resultStatus:"success",txHash:S.txHash,errorMessage:null})),{status:"ok",txHash:S.txHash})},[i,r,l.amount,l.toAddress,a]),w=c.useCallback(()=>{o({...Ao,asset:s??null})},[s]);return{state:l,setToAddress:x,setAmount:h,setAsset:y,goToConfirm:g,goBack:b,submit:v,submitWithTwoStepSecret:j,reset:w,canProceed:f}}const py={ethereum:"Ethereum",bitcoin:"Bitcoin",tron:"Tron",binance:"BSC",bfmeta:"BFMeta",ccchain:"CCChain",pmchain:"PMChain",bfchainv2:"BFChain V2",btgmeta:"BTGMeta",biwmeta:"BIWMeta",ethmeta:"ETHMeta",malibu:"Malibu"};function Bd(){const{t:e}=F(["transaction","common","security"]),{goBack:s}=fe(),{push:n}=se(),a=Zt(),r=Rr(),i=c.useRef(!1),{address:l,amount:o}=be(),d=At(),u=Le(),m=_r(),p=aa(),x=p.snapshot?Us.getChainById(p,d):null,h=x?.name??py[d]??d,y=c.useMemo(()=>{if(!x)return null;const _=m?.tokens.find(R=>R.symbol===x.symbol)?.balance??"0";return{assetType:x.symbol,name:x.name,amount:Me.fromFormatted(_,x.decimals,x.symbol),decimals:x.decimals}},[x,m?.tokens]),{state:f,setToAddress:g,setAmount:b,setAsset:v,goToConfirm:j,submit:w,submitWithTwoStepSecret:N,reset:M,canProceed:S}=fy({initialAsset:y??void 0,useMock:!1,walletId:u?.id,fromAddress:m?.address,chainConfig:x});c.useEffect(()=>{y&&v(y)},[y,v]),c.useEffect(()=>{if(l&&!f.toAddress&&g(l),o&&!f.amount&&f.asset){const L=Me.tryFromFormatted(o,f.asset.decimals,f.asset.assetType);L&&b(L)}},[l,o,f.toAddress,f.amount,f.asset,g,b]),c.useEffect(()=>{const L=_=>{g(_.detail.address.address)};return window.addEventListener("contact-picker-select",L),()=>window.removeEventListener("contact-picker-select",L)},[g]),c.useEffect(()=>{if(f.resultStatus==="success"&&f.toAddress){const L=na.getContactByAddress(hs.state,f.toAddress);L&&tn.trackRecentContact(L.contact.id)}},[f.resultStatus,f.toAddress]);const A=c.useCallback(()=>{n("ContactPickerJob",{chainType:d})},[n,d]),I=f.asset?.amount??null,P=f.asset?.assetType??"TOKEN",D=c.useCallback(()=>{Cf(({content:L,parsed:_})=>{let R=L;(_.type==="address"||_.type==="payment")&&(R=_.address),g(R),r.impact("success"),a.show(e("sendPage.scanSuccess"))}),n("ScannerJob",{chainType:h??d})},[n,d,h,g,r,a,e]),E=()=>{j()&&(r.impact("light"),Tb(async()=>{i.current||(i.current=!0,await r.impact("medium"),_b(async(L,_)=>{if(!_){const B=await w(L);return B.status==="password"?{status:"wallet_lock_invalid"}:B.status==="two_step_secret_required"?{status:"two_step_secret_required"}:B.status==="ok"?(i.current=!1,{status:"ok",txHash:B.txHash}):{status:"error",message:""}}const R=await N(L,_);return R.status==="ok"?(i.current=!1,{status:"ok",txHash:R.txHash}):R.status==="password"?{status:"two_step_secret_invalid",message:""}:{status:"error",message:R.status==="error"?"":""}}),n("TransferWalletLockJob",{title:e("security:walletLock.verifyTitle")}))}),n("TransferConfirmJob",{amount:f.amount?.toFormatted()??"0",symbol:P,toAddress:f.toAddress,feeAmount:f.feeAmount?.toFormatted()??"0",feeSymbol:f.feeSymbol,feeLoading:f.feeLoading?"true":"false"}))},k=()=>{f.resultStatus==="success"&&r.impact("success"),s()},T=()=>{M()},C=()=>{f.txHash&&a.show(e("sendPage.explorerNotImplemented"))};return!u||!m?t.jsxs("div",{className:"flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("sendPage.title"),onBack:s}),t.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:t.jsx("p",{className:"text-muted-foreground",children:e("history.noWallet")})})]}):f.step==="result"||f.step==="sending"?t.jsxs("div",{className:"flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("sendPage.resultTitle")}),t.jsx(Rf,{status:f.step==="sending"?"pending":f.resultStatus??"pending",amount:f.amount?.toFormatted()??"0",symbol:P,toAddress:f.toAddress,txHash:f.txHash??void 0,errorMessage:f.errorMessage??void 0,onDone:k,onRetry:f.resultStatus==="failed"?T:void 0,onViewExplorer:f.resultStatus==="success"?C:void 0})]}):t.jsxs("div",{className:"flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("sendPage.title"),onBack:s}),t.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[t.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx(vs,{chain:d,size:"sm"}),t.jsx("span",{className:"text-sm font-medium",children:h})]}),m?.address&&t.jsxs("div",{className:"flex items-center justify-center gap-1 text-xs text-muted-foreground",children:[t.jsxs("span",{children:[e("sendPage.from"),":"]}),t.jsxs("span",{className:"font-mono",children:[m.address.slice(0,8),"...",m.address.slice(-6)]})]})]}),t.jsx(qm,{label:e("sendPage.toAddressLabel"),value:f.toAddress,onChange:g,placeholder:e("sendPage.toAddressPlaceholder",{chain:h}),onScan:D,onContactPicker:A,chainType:d,error:f.addressError??void 0}),t.jsx(Mf,{label:e("sendPage.amountLabel"),value:f.amount??void 0,onChange:b,balance:I??void 0,symbol:P,error:f.amountError??void 0,fiatValue:f.amount?f.amount.toNumber().toFixed(2):void 0}),t.jsx(bs,{variant:"info",children:e("sendPage.networkWarning",{chain:h})}),t.jsx("div",{className:"pt-4",children:t.jsxs(et,{variant:"mint",className:"w-full","data-testid":"send-continue-button",disabled:!S,onClick:E,children:[e("sendPage.continue"),t.jsx(Be,{className:"-mr-4 ml-2 size-4"})]})})]})]})}Bd.__docgenInfo={description:"",methods:[],displayName:"SendPage"};const Od=({params:e})=>t.jsx(ce,{children:t.jsx(he,{params:e,children:t.jsx(Pf,{children:t.jsx(Bd,{})})})});Od.__docgenInfo={description:"",methods:[],displayName:"SendActivity"};const hy={ethereum:"Ethereum",bitcoin:"Bitcoin",tron:"Tron",binance:"BSC",bfmeta:"BFMeta",ccchain:"CCChain",pmchain:"PMChain",bfchainv2:"BFChain V2",btgmeta:"BTGMeta",biwmeta:"BIWMeta",ethmeta:"ETHMeta",malibu:"Malibu"};function Fd(){const{t:e}=F("transaction"),{goBack:s}=fe(),n=Mr(),a=Zt(),r=Rr(),i=_r(),l=At(),o=hy[l]??l,[d,u]=c.useState(!1),m=i?.address||"",p=async()=>{m&&(await n.write({text:m}),await r.impact("light"),u(!0),a.show(e("receivePage.addressCopied")),setTimeout(()=>u(!1),2e3))},x=async()=>{if(navigator.share&&m)try{await navigator.share({title:e("receivePage.shareTitle"),text:m}),await r.impact("success")}catch{}};return t.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("receivePage.title"),onBack:s}),t.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[t.jsxs("div",{className:"text-muted-foreground flex items-center justify-center gap-2",children:[t.jsx(vs,{chain:l,size:"sm"}),t.jsx("span",{className:"text-sm",children:o})]}),t.jsxs("div",{className:"bg-card flex flex-col items-center gap-4 rounded-2xl p-6 shadow-sm",children:[t.jsx(zf,{address:m,chain:l,size:200}),t.jsx("p",{className:"text-muted-foreground text-center text-sm",children:e("receivePage.scanQrCode")})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-muted-foreground text-sm font-medium",children:e("receivePage.receiveAddress")}),t.jsx("div",{className:"border-border bg-card rounded-xl border p-4",children:t.jsx(Ct,{address:m,copyable:!0})})]}),t.jsxs("div",{className:"flex gap-3 pt-4",children:[t.jsx(q,{variant:"outline",className:"flex-1",onClick:p,children:d?t.jsxs(t.Fragment,{children:[t.jsx(je,{className:"mr-2 size-4"}),e("receivePage.copied")]}):t.jsxs(t.Fragment,{children:[t.jsx(On,{className:"mr-2 size-4"}),e("receivePage.copyAddress")]})}),t.jsxs(et,{variant:"mint",className:"flex-1",onClick:x,children:[t.jsx(ch,{className:"mr-2 size-4"}),e("receivePage.share")]})]}),t.jsx(bs,{variant:"info",children:e("receivePage.networkWarning",{chain:o})})]})]})}Fd.__docgenInfo={description:"",methods:[],displayName:"ReceivePage"};const Wd=()=>t.jsx(ce,{children:t.jsx(Fd,{})});Wd.__docgenInfo={description:"",methods:[],displayName:"ReceiveActivity"};const $d=()=>t.jsx(ce,{children:t.jsx(ai,{})});$d.__docgenInfo={description:"",methods:[],displayName:"SettingsActivity"};const xy={"zh-CN":"","zh-TW":"",en:"English",ar:""};function Hd(){const{goBack:e}=fe(),{t:s}=F("settings"),n=sn(),a=r=>{tn.setLanguage(r),e()};return t.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[t.jsx(Q,{title:s("languagePage.title"),onBack:e}),t.jsxs("div",{className:"flex-1 p-4",children:[t.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:Object.keys($o).map((r,i)=>t.jsxs("div",{children:[i>0&&t.jsx("div",{className:"bg-border mx-4 h-px"}),t.jsxs("button",{onClick:()=>a(r),className:z("flex w-full items-center justify-between px-4 py-3.5","hover:bg-muted/50 active:bg-muted transition-colors",r===n&&"bg-primary/5"),children:[t.jsx("span",{className:"text-sm font-medium",children:xy[r]}),r===n&&t.jsx(je,{className:"text-primary size-5"})]})]},r))}),t.jsx("p",{className:"text-muted-foreground mt-4 px-1 text-xs",children:s("languagePage.hint")})]})]})}Hd.__docgenInfo={description:"",methods:[],displayName:"LanguagePage"};const qd=()=>t.jsx(ce,{children:t.jsx(Hd,{})});qd.__docgenInfo={description:"",methods:[],displayName:"SettingsLanguageActivity"};function Vd(){const{t:e}=F("settings"),{goBack:s}=fe(),n=xr(),a=r=>{tn.setCurrency(r),s()};return t.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("currency.title"),onBack:s}),t.jsxs("div",{className:"flex-1 p-4",children:[t.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:Object.keys(Va).map((r,i)=>t.jsxs("div",{children:[i>0&&t.jsx("div",{className:"bg-border mx-4 h-px"}),t.jsxs("button",{onClick:()=>a(r),className:z("flex w-full items-center justify-between px-4 py-3.5","hover:bg-muted/50 active:bg-muted transition-colors",r===n&&"bg-primary/5"),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"text-muted-foreground text-base font-semibold",children:Va[r].symbol}),t.jsx("span",{className:"text-sm font-medium",children:e(`currency.names.${r}`)})]}),r===n&&t.jsx(je,{className:"text-primary size-5"})]})]},r))}),t.jsx("p",{className:"text-muted-foreground mt-4 px-1 text-xs",children:e("currency.hint")})]})]})}Vd.__docgenInfo={description:"",methods:[],displayName:"CurrencyPage"};const Ud=()=>t.jsx(ce,{children:t.jsx(Vd,{})});Ud.__docgenInfo={description:"",methods:[],displayName:"SettingsCurrencyActivity"};function gy(e){const{children:s,open:n,defaultOpen:a=!1,onOpenChange:r,onOpenChangeComplete:i,actionsRef:l,handle:o,triggerId:d,defaultTriggerId:u=null}=e,m=ef(),p=!!m,x=dl(()=>o?.store??new nf({open:n??a,activeTriggerId:d!==void 0?d:u,modal:!0,disablePointerDismissal:!0,nested:p,role:"alertdialog"})).current;x.useControlledProp("open",n,a),x.useControlledProp("activeTriggerId",d,u),x.useSyncedValue("nested",p),x.useContextCallback("onOpenChange",r),x.useContextCallback("onOpenChangeComplete",i);const h=x.useState("payload");tf({store:x,actionsRef:l,parentContext:m?.store.context});const y=c.useMemo(()=>({store:x}),[x]);return t.jsx(sf.Provider,{value:y,children:typeof s=="function"?s({payload:h}):s})}function Jd({...e}){return t.jsx(gy,{"data-slot":"alert-dialog",...e})}function Kd({...e}){return t.jsx(cf,{"data-slot":"alert-dialog-portal",...e})}function Gd({className:e,...s}){return t.jsx(df,{"data-slot":"alert-dialog-overlay",className:z("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 bg-black/10 duration-100 supports-backdrop-filter:backdrop-blur-xs fixed inset-0 isolate z-50",e),...s})}function Qd({className:e,size:s="default",...n}){return t.jsxs(Kd,{children:[t.jsx(Gd,{}),t.jsx(af,{"data-slot":"alert-dialog-content","data-size":s,className:z("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 data-closed:zoom-out-95 data-open:zoom-in-95 bg-background ring-foreground/10 gap-4 rounded-xl p-4 ring-1 duration-100 data-[size=default]:max-w-xs data-[size=sm]:max-w-xs data-[size=default]:sm:max-w-sm group/alert-dialog-content fixed top-1/2 left-1/2 z-50 grid w-full -translate-x-1/2 -translate-y-1/2 outline-none",e),...n})]})}function Yd({className:e,...s}){return t.jsx("div",{"data-slot":"alert-dialog-header",className:z("grid grid-rows-[auto_1fr] place-items-center gap-1.5 text-center has-data-[slot=alert-dialog-media]:grid-rows-[auto_auto_1fr] has-data-[slot=alert-dialog-media]:gap-x-4 sm:group-data-[size=default]/alert-dialog-content:place-items-start sm:group-data-[size=default]/alert-dialog-content:text-left sm:group-data-[size=default]/alert-dialog-content:has-data-[slot=alert-dialog-media]:grid-rows-[auto_1fr]",e),...s})}function Xd({className:e,...s}){return t.jsx("div",{"data-slot":"alert-dialog-footer",className:z("bg-muted/50 -mx-4 -mb-4 rounded-b-xl border-t p-4 flex flex-col-reverse gap-2 group-data-[size=sm]/alert-dialog-content:grid group-data-[size=sm]/alert-dialog-content:grid-cols-2 sm:flex-row sm:justify-end",e),...s})}function Zd({className:e,...s}){return t.jsx(rf,{"data-slot":"alert-dialog-title",className:z("text-sm font-medium sm:group-data-[size=default]/alert-dialog-content:group-has-data-[slot=alert-dialog-media]/alert-dialog-content:col-start-2",e),...s})}function eu({className:e,...s}){return t.jsx(of,{"data-slot":"alert-dialog-description",className:z("text-muted-foreground *:[a]:hover:text-foreground text-sm text-balance md:text-pretty *:[a]:underline *:[a]:underline-offset-3",e),...s})}function tu({className:e,...s}){return t.jsx(q,{"data-slot":"alert-dialog-action",className:z(e),...s})}function su({className:e,variant:s="outline",size:n="default",...a}){return t.jsx(lf,{"data-slot":"alert-dialog-cancel",className:z(e),render:t.jsx(q,{variant:s,size:n}),...a})}Jd.__docgenInfo={description:"",methods:[],displayName:"AlertDialog"};tu.__docgenInfo={description:"",methods:[],displayName:"AlertDialogAction"};su.__docgenInfo={description:"",methods:[],displayName:"AlertDialogCancel",props:{variant:{defaultValue:{value:'"outline"',computed:!1},required:!1},size:{defaultValue:{value:'"default"',computed:!1},required:!1}}};Qd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogContent",props:{size:{required:!1,tsType:{name:"union",raw:'"default" | "sm"',elements:[{name:"literal",value:'"default"'},{name:"literal",value:'"sm"'}]},description:"",defaultValue:{value:'"default"',computed:!1}}}};eu.__docgenInfo={description:"",methods:[],displayName:"AlertDialogDescription"};Xd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogFooter"};Yd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogHeader"};Gd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogOverlay"};Kd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogPortal"};Zd.__docgenInfo={description:"",methods:[],displayName:"AlertDialogTitle"};function Io(e){if(typeof e!="object"||e===null||Array.isArray(e))return null;const s=e.id;return typeof s=="string"&&s.trim()!==""?s:null}function vy(e){try{const s=JSON.parse(e),n=Array.isArray(s)?s.map(Io):[Io(s)];return Array.from(new Set(n.filter(a=>typeof a=="string")))}catch{return[]}}function by(e,s){switch(s){case"default":return e("chainConfig.source.default");case"subscription":return e("chainConfig.source.subscription");case"manual":return e("chainConfig.source.manual")}}function yy(e){switch(e){case"default":return"bg-muted text-muted-foreground";case"subscription":return"bg-blue-500/10 text-blue-600";case"manual":return"bg-amber-500/10 text-amber-700"}}function jy(e){const s=new Map;for(const n of e)s.set(n.id,n);return s}function nu(){const{goBack:e}=fe(),{t:s}=F("settings"),n=Zt(),a=en(),r=Lo(),i=Bo(),l=Oo(),o=Fo(),d=c.useMemo(()=>jy(i),[i]),[u,m]=c.useState("default"),[p,x]=c.useState(""),[h,y]=c.useState(!1),[f,g]=c.useState([]),b=c.useRef(null),v=c.useRef(null),j=c.useRef(!1);c.useEffect(()=>{_t.initialize()},[]),c.useEffect(()=>{r?.url&&m(r.url)},[r?.url]),c.useEffect(()=>{const I=j.current;if(j.current=l,!I||l)return;const P=b.current;if(P){if(b.current=null,o){n.show(o);return}n.show(s(`chainConfig.toast.${P}`)),P==="manualAdded"&&x("")}},[o,l,s,n]);const w=async()=>{b.current="subscriptionSaved",await _t.setSubscriptionUrl(u)},N=async()=>{b.current="subscriptionRefreshed",await _t.refreshSubscription()},M=async()=>{const I=vy(p),P=new Set(a.map(E=>E.id)),D=I.filter(E=>P.has(E));if(D.length>0){v.current=p,g(D),y(!0);return}b.current="manualAdded",await _t.addManualConfig(p)},S=()=>{v.current=null,g([]),y(!1)},A=async()=>{const I=v.current;v.current=null,g([]),y(!1),I&&(b.current="manualAdded",await _t.addManualConfig(I))};return t.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[t.jsx(Q,{title:s("chainConfig.title"),onBack:e}),t.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[t.jsx(Jd,{open:h,onOpenChange:I=>{I?y(I):S()},children:t.jsxs(Qd,{children:[t.jsxs(Yd,{children:[t.jsx(Zd,{children:s("chainConfig.manual.duplicate.title")}),t.jsx(eu,{children:s("chainConfig.manual.duplicate.description")})]}),t.jsx("div",{className:"bg-muted/50 text-muted-foreground rounded-lg px-3 py-2 text-xs font-mono break-all",children:f.join(", ")}),t.jsxs(Xd,{children:[t.jsx(su,{onClick:S,children:s("chainConfig.manual.duplicate.cancel")}),t.jsx(tu,{onClick:A,disabled:l,children:s("chainConfig.manual.duplicate.replace")})]})]})}),o&&t.jsx("div",{className:"border-destructive/20 bg-destructive/5 text-destructive rounded-xl border px-4 py-3 text-sm",children:o}),t.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:t.jsxs("div",{className:"space-y-3 px-4 py-4",children:[t.jsxs("div",{className:"flex items-center justify-between gap-3",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.subscription.title")}),t.jsx("div",{className:"text-muted-foreground text-xs",children:t.jsx(fl,{ns:"settings",i18nKey:"chainConfig.subscription.description",components:{code:t.jsx("code",{className:"font-mono"})}})})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(q,{type:"button",variant:"outline",size:"icon","data-testid":"refresh-subscription-button",onClick:N,disabled:l,"aria-label":s("chainConfig.subscription.refreshAriaLabel"),children:t.jsx(an,{className:z("size-4",l&&"animate-spin")})}),t.jsx(q,{type:"button","data-testid":"save-subscription-button",onClick:w,disabled:l,children:s("chainConfig.subscription.save")})]})]}),t.jsx(He,{"data-testid":"subscription-url-input",value:u,onChange:I=>m(I.target.value),placeholder:s("chainConfig.subscription.placeholder"),disabled:l,autoCapitalize:"off",autoCorrect:"off",spellCheck:!1}),r?.lastUpdated&&t.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.subscription.lastUpdated",{value:r.lastUpdated})})]})}),t.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm","data-testid":"manual-add-section",children:t.jsxs("div",{className:"space-y-3 px-4 py-4",children:[t.jsxs("div",{className:"flex items-center justify-between gap-3",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.manual.title")}),t.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.manual.description")})]}),t.jsxs(q,{type:"button",variant:"outline","data-testid":"add-chain-button",onClick:M,disabled:l||p.trim()==="",children:[t.jsx(kt,{className:"size-4"}),s("chainConfig.manual.add")]})]}),t.jsx("textarea",{"data-testid":"manual-config-textarea",value:p,onChange:I=>x(I.target.value),placeholder:s("chainConfig.manual.placeholder"),rows:5,disabled:l,className:z("bg-background w-full resize-none rounded-lg border px-3 py-3 text-sm","placeholder:text-muted-foreground","focus:ring-ring focus:ring-2 focus:ring-offset-2 focus:outline-none","disabled:cursor-not-allowed disabled:opacity-50"),autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})]})}),t.jsxs("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:[t.jsxs("div",{className:"px-4 py-3",children:[t.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.list.title")}),t.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.list.description")})]}),t.jsx("div",{className:"bg-border h-px"}),t.jsxs("div",{children:[a.map((I,P)=>{const D=d.get(I.id),E=D?.kind==="incompatible_major",k=by(s,I.source);return t.jsxs("div",{"data-testid":`chain-item-${I.id}`,children:[P>0&&t.jsx("div",{className:"bg-border mx-4 h-px"}),t.jsx("div",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"truncate text-sm font-medium",children:I.name}),t.jsx("span",{className:z("rounded px-2 py-0.5 text-xs",yy(I.source)),children:k})]}),t.jsxs("div",{className:"text-muted-foreground mt-1 flex flex-wrap gap-x-3 gap-y-1 text-xs",children:[t.jsx("span",{className:"font-mono",children:I.id}),t.jsxs("span",{children:["v",I.version]}),t.jsx("span",{children:I.chainKind}),t.jsx("span",{children:I.symbol})]}),D?.kind==="incompatible_major"&&t.jsxs("div",{className:"mt-2 flex items-start gap-2 rounded-lg bg-amber-500/10 px-3 py-2 text-xs text-amber-800",children:[t.jsx(qe,{className:"mt-0.5 size-4 shrink-0"}),t.jsx("div",{children:s("chainConfig.warning.incompatibleMajor",{version:D.version,supportedMajor:D.supportedMajor})})]})]}),t.jsx(tl,{checked:I.enabled,onCheckedChange:T=>{_t.setChainEnabled(I.id,T)},disabled:l||E,className:z(E&&"cursor-not-allowed opacity-60")})]})})]},I.id)}),a.length===0&&t.jsx("div",{className:"text-muted-foreground px-4 py-8 text-center text-sm",children:s("chainConfig.list.empty")})]})]}),t.jsx("div",{className:"text-muted-foreground px-1 text-xs",children:s("chainConfig.hint")})]})]})}nu.__docgenInfo={description:"",methods:[],displayName:"ChainConfigPage"};const au=()=>t.jsx(ce,{children:t.jsx(nu,{})});au.__docgenInfo={description:"",methods:[],displayName:"SettingsChainsActivity"};const Ny=3e4;function ru(){const{t:e}=F("settings"),{goBack:s}=fe(),{push:n}=se(),a=Le(),i=(a?.keyType??"mnemonic")==="arbitrary",[l,o]=c.useState(""),[d,u]=c.useState(!0),m=c.useRef(!1);c.useEffect(()=>{if(l.length>0&&!d){const h=setTimeout(()=>{u(!0)},Ny);return()=>clearTimeout(h)}},[l.length,d]),c.useEffect(()=>{const h=()=>{document.hidden&&l.length>0&&u(!0)};return document.addEventListener("visibilitychange",h),()=>{document.removeEventListener("visibilitychange",h)}},[l.length]),c.useEffect(()=>{m.current||!a?.encryptedMnemonic||(m.current=!0,ts(async h=>{try{const y=await ms(a.encryptedMnemonic,h);return o(y),u(!1),!0}catch{return!1}}),n("WalletLockConfirmJob",{title:e("viewMnemonic.verifyTitle"),description:e(i?"viewMnemonic.verifyDescKey":"viewMnemonic.verifyDescMnemonic")}))},[a,n,e,i]);const p=()=>{u(h=>!h)};if(!a)return t.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[t.jsx(Q,{title:e(i?"viewMnemonic.titleKey":"viewMnemonic.titleMnemonic"),onBack:s}),t.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:t.jsx("p",{className:"text-muted-foreground",children:e("viewMnemonic.noWallet")})})]});const x=i?[]:l.trim().split(/\s+/).filter(Boolean);return t.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[t.jsx(Q,{title:e(i?"viewMnemonic.titleKey":"viewMnemonic.titleMnemonic"),onBack:s}),t.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[t.jsxs("div",{className:"flex gap-3 rounded-xl bg-amber-500/10 p-4",children:[t.jsx(qe,{className:"size-5 shrink-0 text-amber-500"}),t.jsxs("div",{className:"space-y-1 text-sm",children:[t.jsx("p",{className:"font-medium text-amber-700 dark:text-amber-400",children:e("viewMnemonic.securityTip")}),t.jsx("p",{className:"text-muted-foreground",children:e(i?"viewMnemonic.securityWarningKey":"viewMnemonic.securityWarningMnemonic")})]})]}),l.length>0&&t.jsxs("div",{className:"bg-card space-y-4 rounded-xl p-4 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm font-medium",children:i?e("viewMnemonic.charCount",{count:l.length}):e("viewMnemonic.wordCount",{count:x.length})}),t.jsx("button",{onClick:p,className:z("flex items-center gap-1.5 rounded-full px-3 py-1.5 text-xs font-medium","bg-muted hover:bg-muted/80 transition-colors"),children:d?t.jsxs(t.Fragment,{children:[t.jsx(kr,{className:"size-3.5"}),e("viewMnemonic.show")]}):t.jsxs(t.Fragment,{children:[t.jsx(ll,{className:"size-3.5"}),e("viewMnemonic.hide")]})})]}),i?t.jsx("textarea",{value:l,readOnly:!0,rows:4,"data-testid":"secret-textarea",className:z("bg-background w-full resize-none rounded-lg border px-3 py-3 font-mono text-sm","focus:outline-none",d?"[-webkit-text-security:disc]":"[-webkit-text-security:none]")}):t.jsx(rl,{words:x,hidden:d}),!d&&t.jsx("p",{className:"text-muted-foreground text-center text-xs",children:e("viewMnemonic.autoHideNote")})]})]})]})}ru.__docgenInfo={description:"",methods:[],displayName:"ViewMnemonicPage"};const iu=()=>t.jsx(ce,{children:t.jsx(ru,{})});iu.__docgenInfo={description:"",methods:[],displayName:"SettingsMnemonicActivity"};function ou(){const{t:e}=F("settings"),{goBack:s}=fe(),n=Le(),[a,r]=c.useState("verify"),[i,l]=c.useState("pattern"),[o,d]=c.useState([]),[u,m]=c.useState(!1),[p,x]=c.useState(!1),h=c.useRef(null),[y,f]=c.useState([]),[g,b]=c.useState(!1),[v,j]=c.useState(null),[w,N]=c.useState(null),M=c.useCallback(()=>{h.current&&(clearTimeout(h.current),h.current=null),m(!1)},[]),S=c.useCallback(E=>{u&&E.length>0&&M(),d(E)},[u,M]),A=c.useCallback(async E=>{if(n?.encryptedMnemonic){x(!0),M();try{const k=Kt(E);await Bt(n.encryptedMnemonic,k)?(d(E),r("setup")):(m(!0),d([]),h.current=setTimeout(()=>{m(!1)},1500))}catch{m(!0),d([]),h.current=setTimeout(()=>{m(!1)},1500)}finally{x(!1)}}},[n,M]),I=c.useCallback((E,k)=>{f(E),b(k),j(null)},[]),P=c.useCallback(async()=>{if(n?.encryptedWalletLock){x(!0),j(null);try{if(!ol(y)){j(e("changeWalletLock.invalidMnemonic")),x(!1);return}const E=y.join(" ");await ye.verifyMnemonic(n.id,E)?(N(E),r("setup")):j(e("changeWalletLock.mnemonicVerifyFailed"))}catch{j(e("changeWalletLock.mnemonicVerifyFailed"))}finally{x(!1)}}},[n,y,e]),D=c.useCallback(async E=>{if(n)try{if(i==="mnemonic"&&w)await ye.resetWalletLockByMnemonic(n.id,w,E);else{const k=Kt(o);await ye.updateWalletLock(n.id,k,E)}r("success"),setTimeout(()=>{s()},2e3)}catch{r("verify"),d([]),N(null)}},[n,i,w,o,s]);return n?a==="success"?t.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("changeWalletLock.title")}),t.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[t.jsx("div",{className:"bg-green-500/10 flex size-16 items-center justify-center rounded-full",children:t.jsx(je,{className:"text-green-500 size-8"})}),t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-lg font-semibold",children:e("changeWalletLock.success")}),t.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:e("changeWalletLock.returning")})]})]})]}):a==="verify"?t.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("changeWalletLock.title"),onBack:s}),t.jsx("div",{className:"flex-1 p-4",children:i==="pattern"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-6 text-center",children:[t.jsx("h2",{className:"text-xl font-bold",children:e("changeWalletLock.verifyTitle")}),t.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:e("changeWalletLock.verifyDesc")})]}),t.jsx(ks,{value:o,onChange:S,onComplete:A,minPoints:4,error:u,disabled:p,"data-testid":"verify-pattern-lock"}),t.jsx("div",{className:"mt-8 text-center",children:t.jsx("button",{type:"button",onClick:()=>l("mnemonic"),className:"text-primary hover:text-primary/80 text-sm underline","data-testid":"switch-to-mnemonic",children:e("changeWalletLock.forgotPattern")})})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-6 text-center",children:[t.jsx("h2",{className:"text-xl font-bold",children:e("changeWalletLock.mnemonicVerifyTitle")}),t.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:e("changeWalletLock.mnemonicVerifyDesc")})]}),t.jsx(Lf,{wordCount:12,onChange:I}),v&&t.jsx("p",{className:"text-destructive mt-4 text-center text-sm",children:v}),t.jsxs("div",{className:"mt-6 space-y-3",children:[t.jsx(q,{onClick:P,disabled:!g||p,className:"w-full","data-testid":"verify-mnemonic-button",children:e(p?"changeWalletLock.verifying":"changeWalletLock.verifyMnemonic")}),t.jsx("button",{type:"button",onClick:()=>{l("pattern"),f([]),j(null)},className:"text-muted-foreground hover:text-foreground w-full text-center text-sm","data-testid":"switch-to-pattern",children:e("changeWalletLock.usePattern")})]})]})})]}):t.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("changeWalletLock.title"),onBack:()=>{r("verify"),d([])}}),t.jsx("div",{className:"flex-1 p-4",children:t.jsx(Nr,{onComplete:D,minPoints:4})})]}):t.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("changeWalletLock.title"),onBack:s}),t.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:t.jsx("p",{className:"text-muted-foreground",children:e("changeWalletLock.noWallet")})})]})}ou.__docgenInfo={description:"",methods:[],displayName:"ChangeWalletLockPage"};const lu=()=>t.jsx(ce,{children:t.jsx(ou,{})});lu.__docgenInfo={description:"",methods:[],displayName:"SettingsWalletLockActivity"};function wy(e){const s=c.useRef(!0);s.current&&(s.current=!1,e())}const cu=c.createContext(null),du=c.createContext(null);function st(){const e=c.useContext(cu);if(e===null)throw new Error(fa(60));return e}function uu(){const e=c.useContext(du);if(e===null)throw new Error(fa(61));return e}const Sy=(e,s)=>Object.is(e,s);function ws(e,s,n){return e==null||s==null?Object.is(e,s):n(e,s)}function Wa(e,s,n){return!e||e.length===0?!1:e.some(a=>a===void 0?!1:ws(a,s,n))}function or(e,s,n){return!e||e.length===0?-1:e.findIndex(a=>a===void 0?!1:ws(a,s,n))}function Cy(e,s,n){return e.filter(a=>!ws(a,s,n))}function lr(e){if(e==null)return"";if(typeof e=="string")return e;try{return JSON.stringify(e)}catch{return String(e)}}function ky(e){return e!=null&&e.length>0&&typeof e[0]=="object"&&e[0]!=null&&"items"in e[0]}function Os(e,s){if(s&&e!=null)return s(e)??"";if(e&&typeof e=="object"){if("label"in e&&e.label!=null)return String(e.label);if("value"in e)return String(e.value)}return lr(e)}function ds(e,s){return s&&e!=null?s(e)??"":e&&typeof e=="object"&&"value"in e&&"label"in e?lr(e.value):lr(e)}function Ay(e,s,n){if(n&&e!=null)return n(e);if(e&&typeof e=="object"&&"label"in e&&e.label!=null)return e.label;if(s&&!Array.isArray(s))return s[e]??Os(e,n);if(Array.isArray(s)){const a=ky(s)?s.flatMap(r=>r.items):s;if(e==null){const r=a.find(i=>i.value==null);return r&&r.label!=null?r.label:Os(e,n)}if(typeof e!="object"){const r=a.find(i=>i&&i.value===e);return r&&r.label!=null?r.label:Os(e,n)}if("value"in e){const r=a.find(i=>i&&i.value===e.value);if(r&&r.label!=null)return r.label}}return Os(e,n)}function Iy(e,s){return!Array.isArray(e)||e.length===0?"":e.map(n=>Os(n,s)).join(", ")}const X={id:pe(e=>e.id),modal:pe(e=>e.modal),multiple:pe(e=>e.multiple),items:pe(e=>e.items),itemToStringLabel:pe(e=>e.itemToStringLabel),itemToStringValue:pe(e=>e.itemToStringValue),isItemEqualToValue:pe(e=>e.isItemEqualToValue),value:pe(e=>e.value),open:pe(e=>e.open),mounted:pe(e=>e.mounted),forceMount:pe(e=>e.forceMount),transitionStatus:pe(e=>e.transitionStatus),openMethod:pe(e=>e.openMethod),activeIndex:pe(e=>e.activeIndex),selectedIndex:pe(e=>e.selectedIndex),isActive:pe((e,s)=>e.activeIndex===s),isSelected:pe((e,s,n)=>{const a=e.isItemEqualToValue,r=e.value;return e.multiple?Array.isArray(r)&&r.some(i=>ws(i,n,a)):e.selectedIndex===s&&e.selectedIndex!==null?!0:ws(r,n,a)}),isSelectedByFocus:pe((e,s)=>e.selectedIndex===s),popupProps:pe(e=>e.popupProps),triggerProps:pe(e=>e.triggerProps),triggerElement:pe(e=>e.triggerElement),positionerElement:pe(e=>e.positionerElement),listElement:pe(e=>e.listElement),scrollUpArrowVisible:pe(e=>e.scrollUpArrowVisible),scrollDownArrowVisible:pe(e=>e.scrollDownArrowVisible),hasScrollArrows:pe(e=>e.hasScrollArrows),serializedValue:pe(e=>{const{multiple:s,value:n,itemToStringValue:a}=e;return s&&Array.isArray(n)&&n.length===0?"":ds(n,a)})};function Ty(e,s){const n=c.useRef(e),a=Ye(s);ze(()=>{n.current!==e&&a(n.current)},[e,a]),ze(()=>{n.current=e},[e])}function Py(e){const{id:s,value:n,defaultValue:a=null,onValueChange:r,open:i,defaultOpen:l=!1,onOpenChange:o,name:d,disabled:u=!1,readOnly:m=!1,required:p=!1,modal:x=!0,actionsRef:h,inputRef:y,onOpenChangeComplete:f,items:g,multiple:b=!1,itemToStringLabel:v,itemToStringValue:j,isItemEqualToValue:w=Sy,highlightItemOnHover:N=!0,children:M}=e,{clearErrors:S}=Sm(),{setDirty:A,shouldValidateOnChange:I,validityData:P,setFilled:D,name:E,disabled:k,validation:T}=Uo(),{controlId:C}=Jo(),L=Cm({id:s}),_=k||u,R=E??d,[B,$]=ci({controlled:n,default:b?a??ji:a,name:"Select",state:"value"}),[K,ee]=ci({controlled:i,default:l,name:"Select",state:"open"}),V=c.useRef([]),G=c.useRef([]),me=c.useRef(null),U=c.useRef(null),Y=c.useRef(0),ue=c.useRef(null),ae=c.useRef([]),O=c.useRef(!1),ne=c.useRef(!1),Z=c.useRef(null),ie=c.useRef({allowSelectedMouseUp:!1,allowUnselectedMouseUp:!1}),we=c.useRef(!1),{mounted:oe,setMounted:ve,transitionStatus:Re}=Ir(K),{openMethod:Oe,triggerProps:Se,reset:ke}=Bf(K),re=dl(()=>new Hf({id:L,modal:x,multiple:b,itemToStringLabel:v,itemToStringValue:j,isItemEqualToValue:w,value:B,open:K,mounted:oe,transitionStatus:Re,items:g,forceMount:!1,openMethod:null,activeIndex:null,selectedIndex:null,popupProps:{},triggerProps:{},triggerElement:null,positionerElement:null,listElement:null,scrollUpArrowVisible:!1,scrollDownArrowVisible:!1,hasScrollArrows:!1})).current,Fe=te(re,X.activeIndex),nt=te(re,X.selectedIndex),at=te(re,X.triggerElement),Pe=te(re,X.positionerElement),Is=c.useMemo(()=>b&&Array.isArray(B)&&B.length===0?"":ds(B,j),[b,B,j]),ya=c.useMemo(()=>b&&Array.isArray(B)?B.map(le=>ds(le,j)):ds(B,j),[b,B,j]),mn=Tr(re.state.triggerElement);km({id:L,commit:T.commit,value:B,controlRef:mn,name:R,getValue:()=>ya});const Ts=c.useRef(B);ze(()=>{B!==Ts.current&&re.set("forceMount",!0)},[re,B]),ze(()=>{D(B!==null)},[B,D]),ze(function(){if(K)return;const Ie=ae.current;if(b){const bt=Array.isArray(B)?B:[];if(bt.length===0){re.set("selectedIndex",null);return}const it=bt[bt.length-1],hn=or(Ie,it,w);re.set("selectedIndex",hn===-1?null:hn);return}const vt=or(Ie,B,w);re.set("selectedIndex",vt===-1?null:vt)},[b,K,B,ae,w,re]),Ty(B,()=>{S(R),A(B!==P.initialValue),I()?T.commit(B):T.commit(B,!0)});const ss=Ye((le,Ie)=>{if(o?.(le,Ie),!Ie.isCanceled&&(ee(le),!le&&re.state.activeIndex!==null)){const vt=V.current[re.state.activeIndex];queueMicrotask(()=>{vt?.setAttribute("tabindex","-1")})}}),ns=Ye(()=>{ve(!1),re.set("activeIndex",null),ke(),f?.(!1)});pa({enabled:!h,open:K,ref:me,onComplete(){K||ns()}}),c.useImperativeHandle(h,()=>({unmount:ns}),[ns]);const gt=Ye((le,Ie)=>{r?.(le,Ie),!Ie.isCanceled&&$(le)}),Je=Ye(()=>{const le=re.state.listElement||me.current;if(!le)return;const Ie=le.scrollTop,vt=le.scrollTop+le.clientHeight,bt=Ie>1,it=vt<le.scrollHeight-1;re.state.scrollUpArrowVisible!==bt&&re.set("scrollUpArrowVisible",bt),re.state.scrollDownArrowVisible!==it&&re.set("scrollDownArrowVisible",it)}),rt=fm({open:K,onOpenChange:ss,elements:{reference:at,floating:Pe}}),Ps=Of(rt,{enabled:!m&&!_,event:"mousedown"}),fn=Ff(rt,{bubbles:!1}),ja=pm(rt,{enabled:!m&&!_,listRef:V,activeIndex:Fe,selectedIndex:nt,disabledIndices:ji,onNavigate(le){le===null&&!K||re.set("activeIndex",le)},focusItemOnHover:!1}),Na=hm(rt,{enabled:!m&&!_&&(K||!b),listRef:G,activeIndex:Fe,selectedIndex:nt,onMatch(le){K?re.set("activeIndex",le):gt(ae.current[le],pt("none"))},onTypingChange(le){O.current=le}}),{getReferenceProps:Es,getFloatingProps:as,getItemProps:pn}=Wf([Ps,fn,ja,Na]),_s=c.useMemo(()=>ul(Es(),Se),[Es,Se]);wy(()=>{re.update({popupProps:as(),triggerProps:_s})}),ze(()=>{re.update({id:L,modal:x,multiple:b,value:B,open:K,mounted:oe,transitionStatus:Re,popupProps:as(),triggerProps:_s,items:g,itemToStringLabel:v,itemToStringValue:j,isItemEqualToValue:w,openMethod:Oe})},[re,L,x,b,B,K,oe,Re,as,_s,g,v,j,w,Oe]);const Tt=c.useMemo(()=>({store:re,name:R,required:p,disabled:_,readOnly:m,multiple:b,itemToStringLabel:v,itemToStringValue:j,highlightItemOnHover:N,setValue:gt,setOpen:ss,listRef:V,popupRef:me,scrollHandlerRef:U,handleScrollArrowVisibility:Je,scrollArrowsMountedCountRef:Y,getItemProps:pn,events:rt.context.events,valueRef:ue,valuesRef:ae,labelsRef:G,typingRef:O,selectionRef:ie,selectedItemTextRef:Z,validation:T,onOpenChangeComplete:f,keyboardActiveRef:ne,alignItemWithTriggerActiveRef:we,initialValueRef:Ts}),[re,R,p,_,m,b,v,j,N,gt,ss,pn,rt.context.events,T,f,Je]),Ms=ml(y,T.inputRef),wa=b&&Array.isArray(B)&&B.length>0,Sa=c.useMemo(()=>!b||!Array.isArray(B)||!R?null:B.map(le=>{const Ie=ds(le,j);return t.jsx("input",{type:"hidden",name:R,value:Ie},Ie)}),[b,B,R,j]);return t.jsx(cu.Provider,{value:Tt,children:t.jsxs(du.Provider,{value:rt,children:[M,t.jsx("input",{...T.getInputValidationProps({onFocus(){re.state.triggerElement?.focus()},onChange(le){if(le.nativeEvent.defaultPrevented)return;const Ie=le.target.value,vt=pt(xl,le.nativeEvent);function bt(){if(b)return;const it=ae.current.find(hn=>ds(hn,j).toLowerCase()===Ie.toLowerCase());it!=null&&(A(it!==P.initialValue),gt(it,vt),I()&&T.commit(it))}re.set("forceMount",!0),queueMicrotask(bt)}}),id:s||C||void 0,name:b?void 0:R,value:Is,disabled:_,required:p&&!wa,readOnly:m,ref:Ms,style:$f,tabIndex:-1,"aria-hidden":!0}),Sa]})})}const Nn=2,Ey={...Vf,...Am,value:()=>null},_y=c.forwardRef(function(s,n){const{render:a,className:r,disabled:i=!1,nativeButton:l=!0,...o}=s,{setTouched:d,setFocused:u,validationMode:m,state:p,disabled:x}=Uo(),{labelId:h}=Jo(),{store:y,setOpen:f,selectionRef:g,validation:b,readOnly:v,alignItemWithTriggerActiveRef:j,disabled:w,keyboardActiveRef:N}=st(),M=x||w||i,S=te(y,X.open),A=te(y,X.value),I=te(y,X.triggerProps),P=te(y,X.positionerElement),D=te(y,X.listElement),E=te(y,X.serializedValue),k=Tr(P),T=c.useRef(null),C=Dt(),L=Dt(),{getButtonProps:_,buttonRef:R}=gl({disabled:M,native:l}),B=Ye(U=>{y.set("triggerElement",U)}),$=ml(n,T,R,B),K=Dt(),ee=Dt();c.useEffect(()=>{if(S)return ee.start(200,()=>{g.current.allowUnselectedMouseUp=!0,K.start(200,()=>{g.current.allowSelectedMouseUp=!0})}),()=>{K.clear(),ee.clear()};g.current={allowSelectedMouseUp:!1,allowUnselectedMouseUp:!1},L.clear()},[S,g,L,K,ee]);const V=c.useMemo(()=>D?.id??qf(P)?.id,[D,P]),G=ul(I,{role:"combobox","aria-expanded":S?"true":"false","aria-haspopup":"listbox","aria-controls":S?V:void 0,"aria-labelledby":h,"aria-readonly":v||void 0,tabIndex:M?-1:0,ref:$,onFocus(U){u(!0),S&&j.current&&f(!1,pt(sp,U.nativeEvent)),C.start(0,()=>{y.set("forceMount",!0)})},onBlur(){d(!0),u(!1),m==="onBlur"&&b.commit(A)},onPointerMove(){N.current=!1},onKeyDown(){N.current=!0},onMouseDown(U){if(S)return;const Y=Ka(U.currentTarget);function ue(ae){if(!T.current)return;const O=ae.target;if(wi(T.current,O)||wi(k.current,O)||O===T.current)return;const ne=xm(T.current);ae.clientX>=ne.left-Nn&&ae.clientX<=ne.right+Nn&&ae.clientY>=ne.top-Nn&&ae.clientY<=ne.bottom+Nn||f(!1,pt(np,ae))}L.start(0,()=>{Y.addEventListener("mouseup",ue,{once:!0})})}},b.getValidationProps,o,_);G.role="combobox";const me=c.useMemo(()=>({...p,open:S,disabled:M,value:A,readOnly:v,placeholder:!E}),[p,S,M,A,v,E]);return tt("button",s,{ref:[n,T],state:me,stateAttributesMapping:Ey,props:G})}),My={value:()=>null},Ry=c.forwardRef(function(s,n){const{className:a,render:r,children:i,...l}=s,{store:o,valueRef:d}=st(),u=te(o,X.value),m=te(o,X.items),p=te(o,X.itemToStringLabel),x=te(o,X.serializedValue),h=c.useMemo(()=>({value:u,placeholder:!x}),[u,x]),y=typeof i=="function"?i(u):i??(Array.isArray(u)?Iy(u,p):Ay(u,m,p));return tt("span",s,{state:h,ref:[n,d],props:[{children:y},l],stateAttributesMapping:My})}),Dy=c.forwardRef(function(s,n){const{className:a,render:r,...i}=s,{store:l}=st(),o=te(l,X.open),d=c.useMemo(()=>({open:o}),[o]);return tt("span",s,{state:d,ref:n,props:[{"aria-hidden":!0,children:""},i],stateAttributesMapping:Uf})}),zy=c.createContext(void 0),Ly=c.forwardRef(function(s,n){const{store:a}=st(),r=te(a,X.mounted),i=te(a,X.forceMount);return r||i?t.jsx(zy.Provider,{value:!0,children:t.jsx(Jf,{ref:n,...s})}):null}),mu=c.createContext(void 0);function ri(){const e=c.useContext(mu);if(!e)throw new Error(fa(59));return e}function ta(e,s){e&&Object.assign(e.style,s)}const fu={position:"relative",maxHeight:"100%",overflowX:"hidden",overflowY:"auto"},By={position:"fixed"},Oy=c.forwardRef(function(s,n){const{anchor:a,positionMethod:r="absolute",className:i,render:l,side:o="bottom",align:d="center",sideOffset:u=0,alignOffset:m=0,collisionBoundary:p="clipping-ancestors",collisionPadding:x,arrowPadding:h=5,sticky:y=!1,disableAnchorTracking:f,alignItemWithTrigger:g=!0,collisionAvoidance:b=Kf,...v}=s,{store:j,listRef:w,labelsRef:N,alignItemWithTriggerActiveRef:M,selectedItemTextRef:S,valuesRef:A,initialValueRef:I,popupRef:P,setValue:D}=st(),E=uu(),k=te(j,X.open),T=te(j,X.mounted),C=te(j,X.modal),L=te(j,X.value),_=te(j,X.openMethod),R=te(j,X.positionerElement),B=te(j,X.triggerElement),$=te(j,X.isItemEqualToValue),K=c.useRef(null),ee=c.useRef(null),[V,G]=c.useState(g),me=T&&V&&_!=="touch";!T&&V!==g&&G(g),ze(()=>{T||(X.scrollUpArrowVisible(j.state)&&j.set("scrollUpArrowVisible",!1),X.scrollDownArrowVisible(j.state)&&j.set("scrollDownArrowVisible",!1))},[j,T]),c.useImperativeHandle(M,()=>me),Gf((me||C)&&k&&_!=="touch",B);const U=gm({anchor:a,floatingRootContext:E,positionMethod:r,mounted:T,side:o,sideOffset:u,align:d,alignOffset:m,arrowPadding:h,collisionBoundary:p,collisionPadding:x,sticky:y,disableAnchorTracking:f??me,collisionAvoidance:b,keepMounted:!0}),Y=me?"none":U.side,ue=me?By:U.positionerStyles,ae=c.useMemo(()=>{const ve={};return k||(ve.pointerEvents="none"),{role:"presentation",hidden:!T,style:{...ue,...ve}}},[k,T,ue]),O=c.useMemo(()=>({open:k,side:Y,align:U.align,anchorHidden:U.anchorHidden}),[k,Y,U.align,U.anchorHidden]),ne=Ye(ve=>{j.set("positionerElement",ve)}),Z=tt("div",s,{ref:[n,ne],state:O,stateAttributesMapping:pl,props:[ae,v]}),ie=c.useRef(0),we=Ye(ve=>{if(ve.size===0&&ie.current===0||A.current.length===0)return;const Re=ie.current;if(ie.current=ve.size,ve.size===Re)return;const Oe=pt(xl);if(Re!==0&&!j.state.multiple&&L!==null&&or(A.current,L,$)===-1){const ke=I.current,Fe=ke!=null&&Wa(A.current,ke,$)?ke:null;D(Fe,Oe),Fe===null&&(j.set("selectedIndex",null),S.current=null)}if(Re!==0&&j.state.multiple&&Array.isArray(L)){const Se=L.filter(ke=>Wa(A.current,ke,$));(Se.length!==L.length||Se.some(ke=>!Wa(L,ke,$)))&&(D(Se,Oe),Se.length===0&&(j.set("selectedIndex",null),S.current=null))}if(k&&me){j.update({scrollUpArrowVisible:!1,scrollDownArrowVisible:!1});const Se={height:""};ta(R,Se),ta(P.current,Se)}}),oe=c.useMemo(()=>({...U,side:Y,alignItemWithTriggerActive:me,setControlledAlignItemWithTrigger:G,scrollUpArrowRef:K,scrollDownArrowRef:ee}),[U,Y,me,G]);return t.jsx(vm,{elementsRef:w,labelsRef:N,onMapChange:we,children:t.jsxs(mu.Provider,{value:oe,children:[T&&C&&t.jsx(Qf,{inert:Yf(!k),cutout:B}),Z]})})});function pu(e){const s=e.currentTarget.getBoundingClientRect();return s.top+1<=e.clientY&&e.clientY<=s.bottom-1&&s.left+1<=e.clientX&&e.clientX<=s.right-1}const wn="base-ui-disable-scrollbar",cr={className:wn,element:t.jsx("style",{href:wn,precedence:"base-ui:low",children:`.${wn}{scrollbar-width:none}.${wn}::-webkit-scrollbar{display:none}`})},Fy={...pl,...hl},Wy=c.forwardRef(function(s,n){const{render:a,className:r,...i}=s,{store:l,popupRef:o,onOpenChangeComplete:d,setOpen:u,valueRef:m,selectedItemTextRef:p,keyboardActiveRef:x,multiple:h,handleScrollArrowVisibility:y,scrollHandlerRef:f}=st(),{side:g,align:b,alignItemWithTriggerActive:v,setControlledAlignItemWithTrigger:j,scrollDownArrowRef:w,scrollUpArrowRef:N}=ri(),M=bm()!=null,S=uu(),A=Dt(),I=te(l,X.id),P=te(l,X.open),D=te(l,X.mounted),E=te(l,X.popupProps),k=te(l,X.transitionStatus),T=te(l,X.triggerElement),C=te(l,X.positionerElement),L=te(l,X.listElement),_=c.useRef(0),R=c.useRef(!1),B=c.useRef(0),$=c.useRef(!1),K=c.useRef({}),ee=Xf(),V=Ye(Y=>{if(!C||!o.current||!$.current)return;if(R.current||!v){y();return}const ue=C.style.top==="0px",ae=C.style.bottom==="0px",O=C.getBoundingClientRect().height,ne=Ka(C),Z=getComputedStyle(C),ie=parseFloat(Z.marginTop),we=parseFloat(Z.marginBottom),oe=ne.documentElement.clientHeight-ie-we,ve=Y.scrollTop,Re=Y.scrollHeight,Oe=Y.clientHeight,Se=Re-Oe;let ke=null,re=null,Fe=!1;if(ue){const nt=Se-ve,at=O+nt,Pe=Math.min(at,oe);ke=Pe,Pe!==oe?re=Se:Fe=!0}else if(ae){const nt=ve-0,at=O+nt,Pe=Math.min(at,oe),Is=at-oe;ke=Pe,Pe!==oe?re=0:(Fe=!0,ve<Se&&(re=ve-(nt-Is)))}ke!=null&&(C.style.height=`${ke}px`),re!=null&&(Y.scrollTop=re),Fe&&(R.current=!0),y()});c.useImperativeHandle(f,()=>V,[V]),pa({open:P,ref:o,onComplete(){P&&d?.(!0)}});const G=c.useMemo(()=>({open:P,transitionStatus:k,side:g,align:b}),[P,k,g,b]);ze(()=>{!C||!o.current||Object.keys(K.current).length||(K.current={top:C.style.top||"0",left:C.style.left||"0",right:C.style.right,height:C.style.height,bottom:C.style.bottom,minHeight:C.style.minHeight,maxHeight:C.style.maxHeight,marginTop:C.style.marginTop,marginBottom:C.style.marginBottom})},[o,C]),ze(()=>{D||v||($.current=!1,R.current=!1,_.current=0,B.current=0,ta(C,K.current))},[D,v,C,o]),ze(()=>{const Y=o.current;if(!(!D||!T||!C||!Y)){if(!v){$.current=!0,ee.request(y);return}queueMicrotask(()=>{const ue=getComputedStyle(C),ae=getComputedStyle(Y),O=Ka(T),ne=Ni(C),Z=T.getBoundingClientRect(),ie=C.getBoundingClientRect(),we=Z.left,oe=Z.height,ve=L||Y,Re=ve.scrollHeight,Oe=parseFloat(ae.borderBottomWidth),Se=parseFloat(ue.marginTop)||10,ke=parseFloat(ue.marginBottom)||10,re=parseFloat(ue.minHeight)||100,Fe=5,nt=5,at=20,Pe=O.documentElement.clientHeight-Se-ke,Is=O.documentElement.clientWidth,ya=Pe-Z.bottom+oe,mn=p.current,Ts=m.current;let ss=0,ns=0;if(mn&&Ts){const Tt=Ts.getBoundingClientRect(),Ms=mn.getBoundingClientRect(),wa=Tt.left-we,Sa=Ms.left-ie.left,le=Tt.top-Z.top+Tt.height/2,Ie=Ms.top-ie.top+Ms.height/2;ss=wa-Sa,ns=Ie-le}const gt=ya+ns+ke+Oe;let Je=Math.min(Pe,gt);const rt=Pe-Se-ke,Ps=gt-Je,fn=Math.max(Fe,we+ss),ja=Is-nt,Na=Math.max(0,fn+ie.width-ja);C.style.left=`${fn-Na}px`,C.style.height=`${Je}px`,C.style.maxHeight="auto",C.style.marginTop=`${Se}px`,C.style.marginBottom=`${ke}px`,Y.style.height="100%";const Es=ve.scrollHeight-ve.clientHeight,as=Ps>=Es;as&&(Je=Math.min(Pe,ie.height)-(Ps-Es));const pn=Z.top<at||Z.bottom>Pe-at||Je<Math.min(Re,re),_s=(ne.visualViewport?.scale??1)!==1&&Zf;if(pn||_s){$.current=!0,ta(C,K.current),rp.flushSync(()=>j(!1));return}if(as){const Tt=Math.max(0,Pe-gt);C.style.top=ie.height>=rt?"0":`${Tt}px`,C.style.height=`${Je}px`,ve.scrollTop=ve.scrollHeight-ve.clientHeight,_.current=Math.max(re,Je)}else C.style.bottom="0",_.current=Math.max(re,Je),ve.scrollTop=Ps;_.current===Pe&&(R.current=!0),y(),setTimeout(()=>{$.current=!0})})}},[l,D,C,T,m,p,o,y,v,j,ee,w,N,L]),c.useEffect(()=>{if(!v||!C||!D)return;const Y=Ni(C);function ue(ae){u(!1,pt(ap,ae))}return Y.addEventListener("resize",ue),()=>{Y.removeEventListener("resize",ue)}},[u,v,C,D]);const me={...L?{role:"presentation","aria-orientation":void 0}:{role:"listbox","aria-multiselectable":h||void 0,id:`${I}-list`},onKeyDown(Y){x.current=!0,M&&tp.has(Y.key)&&Y.stopPropagation()},onMouseMove(){x.current=!1},onPointerLeave(Y){if(pu(Y)||Y.pointerType==="touch")return;const ue=Y.currentTarget;A.start(0,()=>{l.set("activeIndex",null),ue.focus({preventScroll:!0})})},onScroll(Y){L||f.current?.(Y.currentTarget)},...v&&{style:L?{height:"100%"}:fu}},U=tt("div",s,{ref:[n,o],state:G,stateAttributesMapping:Fy,props:[E,me,ym(k),{className:!L&&v?cr.className:void 0},i]});return t.jsxs(c.Fragment,{children:[cr.element,t.jsx(ep,{context:S,modal:!1,disabled:!D,restoreFocus:!0,children:U})]})}),$y=c.forwardRef(function(s,n){const{className:a,render:r,...i}=s,{store:l,scrollHandlerRef:o}=st(),{alignItemWithTriggerActive:d}=ri(),u=te(l,X.hasScrollArrows),m=te(l,X.openMethod),p=te(l,X.multiple),h={id:`${te(l,X.id)}-list`,role:"listbox","aria-multiselectable":p||void 0,onScroll(f){o.current?.(f.currentTarget)},...d&&{style:fu},className:u&&m!=="touch"?cr.className:void 0},y=Ye(f=>{l.set("listElement",f)});return tt("div",s,{ref:[n,y],props:[h,i]})}),hu=c.createContext(void 0);function ii(){const e=c.useContext(hu);if(!e)throw new Error(fa(57));return e}const Hy=c.memo(c.forwardRef(function(s,n){const{render:a,className:r,value:i=null,label:l,disabled:o=!1,nativeButton:d=!1,...u}=s,m=c.useRef(null),p=jm({label:l,textRef:m,indexGuessBehavior:Nm.GuessFromOrder}),{store:x,getItemProps:h,setOpen:y,setValue:f,selectionRef:g,typingRef:b,valuesRef:v,keyboardActiveRef:j,multiple:w,highlightItemOnHover:N}=st(),M=Dt(),S=te(x,X.isActive,p.index),A=te(x,X.isSelected,p.index,i),I=te(x,X.isSelectedByFocus,p.index),P=te(x,X.isItemEqualToValue),D=p.index,E=D!==-1,k=c.useRef(null),T=Tr(D);ze(()=>{if(!E)return;const U=v.current;return U[D]=i,()=>{delete U[D]}},[E,D,i,v]),ze(()=>{if(!E)return;const U=x.state.value;let Y=U;w&&Array.isArray(U)&&U.length>0&&(Y=U[U.length-1]),Y!==void 0&&ws(Y,i,P)&&x.set("selectedIndex",D)},[E,D,w,P,x,i]);const C=c.useMemo(()=>({disabled:o,selected:A,highlighted:S}),[o,A,S]),L=h({active:S,selected:A});L.onFocus=void 0,L.id=void 0;const _=c.useRef(null),R=c.useRef("mouse"),B=c.useRef(!1),{getButtonProps:$,buttonRef:K}=gl({disabled:o,focusableWhenDisabled:!0,native:d});function ee(U){const Y=x.state.value;if(w){const ue=Array.isArray(Y)?Y:[],ae=A?Cy(ue,i,P):[...ue,i];f(ae,pt(ka,U))}else f(i,pt(ka,U)),y(!1,pt(ka,U))}const V={role:"option","aria-selected":A,"aria-disabled":o||void 0,tabIndex:S?0:-1,onFocus(){x.set("activeIndex",D)},onMouseEnter(){!j.current&&x.state.selectedIndex===null&&x.set("activeIndex",D)},onMouseMove(){N&&x.set("activeIndex",D)},onMouseLeave(U){!N||j.current||pu(U)||M.start(0,()=>{x.state.activeIndex===D&&x.set("activeIndex",null)})},onTouchStart(){g.current={allowSelectedMouseUp:!1,allowUnselectedMouseUp:!1}},onKeyDown(U){_.current=U.key,x.set("activeIndex",D)},onClick(U){B.current=!1,!(U.type==="keydown"&&_.current===null)&&(o||_.current===" "&&b.current||R.current!=="touch"&&!S||(_.current=null,ee(U.nativeEvent)))},onPointerEnter(U){R.current=U.pointerType},onPointerDown(U){R.current=U.pointerType,B.current=!0},onMouseUp(U){if(o)return;if(B.current){B.current=!1;return}const Y=!g.current.allowSelectedMouseUp&&A,ue=!g.current.allowUnselectedMouseUp&&!A;Y||ue||R.current!=="touch"&&!S||ee(U.nativeEvent)}},G=tt("div",s,{ref:[K,n,p.ref,k],state:C,props:[L,V,u,$]}),me=c.useMemo(()=>({selected:A,indexRef:T,textRef:m,selectedByFocus:I,hasRegistered:E}),[A,T,m,I,E]);return t.jsx(hu.Provider,{value:me,children:G})})),qy=c.forwardRef(function(s,n){const a=s.keepMounted??!1,{selected:r}=ii();return a||r?t.jsx(Vy,{...s,ref:n}):null}),Vy=c.memo(c.forwardRef((e,s)=>{const{render:n,className:a,keepMounted:r,...i}=e,{selected:l}=ii(),o=c.useRef(null),{transitionStatus:d,setMounted:u}=Ir(l),m=c.useMemo(()=>({selected:l,transitionStatus:d}),[l,d]),p=tt("span",e,{ref:[s,o],state:m,props:[{"aria-hidden":!0,children:""},i],stateAttributesMapping:hl});return pa({open:l,ref:o,onComplete(){l||u(!1)}}),p})),Uy=c.memo(c.forwardRef(function(s,n){const{indexRef:a,textRef:r,selectedByFocus:i,hasRegistered:l}=ii(),{selectedItemTextRef:o}=st(),{className:d,render:u,...m}=s,p=c.useCallback(h=>{if(!h||!l)return;const y=o.current===null||!o.current.isConnected;(i||y&&a.current===0)&&(o.current=h)},[o,a,i,l]);return tt("div",s,{ref:[p,n,r],props:m})})),xu=c.forwardRef(function(s,n){const{render:a,className:r,direction:i,keepMounted:l=!1,...o}=s,{store:d,popupRef:u,listRef:m,handleScrollArrowVisibility:p,scrollArrowsMountedCountRef:x}=st(),{side:h,scrollDownArrowRef:y,scrollUpArrowRef:f}=ri(),g=i==="up"?X.scrollUpArrowVisible:X.scrollDownArrowVisible,b=te(d,g),v=te(d,X.openMethod),j=b&&v!=="touch",w=Dt(),N=i==="up"?f:y,{transitionStatus:M,setMounted:S}=Ir(j);ze(()=>(x.current+=1,d.state.hasScrollArrows||d.set("hasScrollArrows",!0),()=>{x.current=Math.max(0,x.current-1),x.current===0&&d.state.hasScrollArrows&&d.set("hasScrollArrows",!1)}),[d,x]),pa({open:j,ref:N,onComplete(){j||S(!1)}});const A=c.useMemo(()=>({direction:i,visible:j,side:h,transitionStatus:M}),[i,j,h,M]),P=tt("div",s,{ref:[n,N],state:A,props:[{"aria-hidden":!0,children:i==="up"?"":"",style:{position:"absolute"},onMouseMove(E){if(E.movementX===0&&E.movementY===0||w.isStarted())return;d.set("activeIndex",null);function k(){const T=d.state.listElement??u.current;if(!T)return;d.set("activeIndex",null),p();const C=T.scrollTop===0,L=Math.round(T.scrollTop+T.clientHeight)>=T.scrollHeight;if(m.current.length===0&&(i==="up"?d.set("scrollUpArrowVisible",!C):d.set("scrollDownArrowVisible",!L)),i==="up"&&C||i==="down"&&L){w.clear();return}if((d.state.listElement||u.current)&&m.current&&m.current.length>0){const R=m.current,B=N.current?.offsetHeight||0;if(i==="up"){let $=0;const K=T.scrollTop+B;for(let V=0;V<R.length;V+=1){const G=R[V];if(G&&G.offsetTop>=K){$=V;break}}const ee=Math.max(0,$-1);if(ee<$){const V=R[ee];V&&(T.scrollTop=Math.max(0,V.offsetTop-B))}else T.scrollTop=0}else{let $=R.length-1;const K=T.scrollTop+T.clientHeight-B;for(let V=0;V<R.length;V+=1){const G=R[V];if(G&&G.offsetTop+G.offsetHeight>K){$=Math.max(0,V-1);break}}const ee=Math.min(R.length-1,$+1);if(ee>$){const V=R[ee];V&&(T.scrollTop=V.offsetTop+V.offsetHeight-T.clientHeight+B)}else T.scrollTop=T.scrollHeight-T.clientHeight}}w.start(40,k)}w.start(40,k)},onMouseLeave(){w.clear()}},o]});return j||l?P:null}),Jy=c.forwardRef(function(s,n){return t.jsx(xu,{...s,ref:n,direction:"down"})}),Ky=c.forwardRef(function(s,n){return t.jsx(xu,{...s,ref:n,direction:"up"})}),sa=Py;function Qs({className:e,...s}){return t.jsx(Ry,{"data-slot":"select-value",className:z("flex flex-1 text-left",e),...s})}function Ys({className:e,size:s="default",children:n,...a}){return t.jsxs(_y,{"data-slot":"select-trigger","data-size":s,className:z("border-input data-[placeholder]:text-muted-foreground dark:bg-input/30 dark:hover:bg-input/50 focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:aria-invalid:border-destructive/50 gap-1.5 rounded-lg border bg-transparent py-2 pr-2 pl-2.5 text-sm transition-colors select-none focus-visible:ring-[3px] aria-invalid:ring-[3px] data-[size=default]:h-8 data-[size=sm]:h-7 data-[size=sm]:rounded-[min(var(--radius-md),10px)] *:data-[slot=select-value]:flex *:data-[slot=select-value]:gap-1.5 [&_svg:not([class*='size-'])]:size-4 flex w-fit items-center justify-between whitespace-nowrap outline-none disabled:cursor-not-allowed disabled:opacity-50 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center [&_svg]:pointer-events-none [&_svg]:shrink-0",e),...a,children:[n,t.jsx(Dy,{render:t.jsx(ih,{className:"text-muted-foreground size-4 pointer-events-none"})})]})}function Xs({className:e,children:s,side:n="bottom",sideOffset:a=4,align:r="center",alignOffset:i=0,alignItemWithTrigger:l=!0,...o}){return t.jsx(Ly,{children:t.jsx(Oy,{side:n,sideOffset:a,align:r,alignOffset:i,alignItemWithTrigger:l,className:"isolate z-50",children:t.jsxs(Wy,{"data-slot":"select-content",className:z("bg-popover text-popover-foreground data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 data-closed:zoom-out-95 data-open:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 ring-foreground/10 min-w-36 rounded-lg shadow-md ring-1 duration-100 relative isolate z-50 max-h-(--available-height) w-(--anchor-width) origin-(--transform-origin) overflow-x-hidden overflow-y-auto",e),...o,children:[t.jsx(gu,{}),t.jsx($y,{children:s}),t.jsx(vu,{})]})})})}function Gt({className:e,children:s,...n}){return t.jsxs(Hy,{"data-slot":"select-item",className:z("focus:bg-accent focus:text-accent-foreground not-data-[variant=destructive]:focus:**:text-accent-foreground gap-1.5 rounded-md py-1 pr-8 pl-1.5 text-sm [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2 relative flex w-full cursor-default items-center outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0",e),...n,children:[t.jsx(Uy,{className:"flex flex-1 gap-2 shrink-0 whitespace-nowrap",children:s}),t.jsx(qy,{render:t.jsx("span",{className:"pointer-events-none absolute right-2 flex size-4 items-center justify-center"}),children:t.jsx(je,{className:"pointer-events-none"})})]})}function gu({className:e,...s}){return t.jsx(Ky,{"data-slot":"select-scroll-up-button",className:z("bg-popover z-10 flex cursor-default items-center justify-center py-1 [&_svg:not([class*='size-'])]:size-4 top-0 w-full",e),...s,children:t.jsx(Pr,{})})}function vu({className:e,...s}){return t.jsx(Jy,{"data-slot":"select-scroll-down-button",className:z("bg-popover z-10 flex cursor-default items-center justify-center py-1 [&_svg:not([class*='size-'])]:size-4 bottom-0 w-full",e),...s,children:t.jsx(Sr,{})})}Xs.__docgenInfo={description:"",methods:[],displayName:"SelectContent",props:{side:{defaultValue:{value:'"bottom"',computed:!1},required:!1},sideOffset:{defaultValue:{value:"4",computed:!1},required:!1},align:{defaultValue:{value:'"center"',computed:!1},required:!1},alignOffset:{defaultValue:{value:"0",computed:!1},required:!1},alignItemWithTrigger:{defaultValue:{value:"true",computed:!1},required:!1}}};Gt.__docgenInfo={description:"",methods:[],displayName:"SelectItem"};vu.__docgenInfo={description:"",methods:[],displayName:"SelectScrollDownButton"};gu.__docgenInfo={description:"",methods:[],displayName:"SelectScrollUpButton"};Ys.__docgenInfo={description:"",methods:[],displayName:"SelectTrigger",props:{size:{required:!1,tsType:{name:"union",raw:'"sm" | "default"',elements:[{name:"literal",value:'"sm"'},{name:"literal",value:'"default"'}]},description:"",defaultValue:{value:'"default"',computed:!1}}}};Qs.__docgenInfo={description:"",methods:[],displayName:"SelectValue"};function bu({initialChain:e}){const{navigate:s,goBack:n}=fe(),a=Le(),r=ra(),i=At(),{t:l}=F(["transaction","common"]),{transactions:o,isLoading:d,isFetching:u,filter:m,setFilter:p,refresh:x}=ei(a?.id),h=c.useMemo(()=>[{value:"all",label:l("history.filter.allTime")},{value:"7d",label:l("history.filter.days7")},{value:"30d",label:l("history.filter.days30")},{value:"90d",label:l("history.filter.days90")}],[l]),y=c.useMemo(()=>[{value:"all",label:l("history.filter.allChains")},...r.map(v=>({value:v.id,label:v.name}))],[l,r]);c.useEffect(()=>{const v=e??i;v&&m.chain!==v&&p({...m,chain:v})},[]);const f=c.useCallback(v=>{if(!v.id){console.warn("[TransactionHistory] Transaction has no id:",v);return}s({to:`/transaction/${v.id}`})},[s]),g=c.useCallback(v=>{p({...m,chain:v})},[m,p]),b=c.useCallback(v=>{p({...m,period:v})},[m,p]);return a?t.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[t.jsx(Q,{title:l("transaction:history.title"),onBack:n,rightAction:t.jsx("button",{onClick:x,disabled:u,className:z("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80",u&&"animate-spin"),"aria-label":l("common:a11y.refresh"),children:t.jsx(an,{className:"size-5"})})}),t.jsxs("div",{className:"bg-card border-b px-4 py-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(wl,{className:"text-muted-foreground size-4"}),t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("span",{className:"text-muted-foreground text-xs",children:l("history.filter.chainLabel")}),t.jsxs(sa,{value:m.chain||"all",onValueChange:v=>g(v),children:[t.jsx(Ys,{size:"sm","aria-label":l("common:a11y.selectChain"),children:t.jsx(Qs,{children:y.find(v=>v.value===(m.chain||"all"))?.label})}),t.jsx(Xs,{children:y.map(v=>t.jsx(Gt,{value:v.value,children:v.label},v.value))})]})]}),t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("span",{className:"text-muted-foreground text-xs",children:l("history.filter.periodLabel")}),t.jsxs(sa,{value:m.period||"all",onValueChange:v=>b(v),children:[t.jsx(Ys,{size:"sm","aria-label":l("common:a11y.selectPeriod"),children:t.jsx(Qs,{children:h.find(v=>v.value===(m.period||"all"))?.label})}),t.jsx(Xs,{children:h.map(v=>t.jsx(Gt,{value:v.value,children:v.label},v.value))})]})]})]}),t.jsx("p",{className:"text-muted-foreground mt-2 text-xs",children:l("transaction:history.totalRecords",{count:o.length})})]}),t.jsx("div",{className:"flex-1 p-4",children:t.jsx(gr,{transactions:o,loading:d,onTransactionClick:f,emptyTitle:l("transaction:history.emptyTitle"),emptyDescription:l("transaction:history.emptyDesc"),showChainIcon:!0})})]}):t.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[t.jsx(Q,{title:l("transaction:history.title"),onBack:n}),t.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:t.jsx("p",{className:"text-muted-foreground",children:l("transaction:history.noWallet")})})]})}bu.__docgenInfo={description:"",methods:[],displayName:"TransactionHistoryPage",props:{initialChain:{required:!1,tsType:{name:"union",raw:"ChainType | 'all' | undefined",elements:[{name:"ChainType"},{name:"literal",value:"'all'"},{name:"undefined"}]},description:"'all' "}}};const yu=()=>{const e=Nh();return t.jsx(ce,{children:t.jsx(bu,{initialChain:e.chain})})};yu.__docgenInfo={description:"",methods:[],displayName:"HistoryActivity"};function Gy(e){if(!e)return null;const[s,n]=e.split("--");return!s||!n?null:{chainId:s,hash:n}}function Qy(e){if(!e)return!1;if(e.type==="swap")return(e.assets??[]).length<2;if(e.type==="approve"||e.type==="interaction"){const s=e.contract?.method,n=e.contract?.methodId;return!s&&!n}return!1}function ju(){const{t:e}=F(["transaction","common"]),{goBack:s}=fe(),{txId:n}=be(),a=Le(),r=aa(),{transactions:i,isLoading:l}=ei(a?.id),[o,d]=c.useState(!1),u=c.useMemo(()=>i.find(R=>R.id===n),[i,n]),m=c.useMemo(()=>Gy(n),[n]),p=nn({queryKey:["transaction-detail",n],queryFn:async()=>Ko.getTransaction({id:n}),enabled:!!a?.id&&!!n&&(!u||Qy(u)),staleTime:3e4}),h=p.data??void 0??u,y=l||p.isLoading,f=c.useMemo(()=>{const R=h?.chain??m?.chainId;return R?Us.getChainById(r,R):null},[r,m?.chainId,h?.chain]),g=c.useMemo(()=>{const R=f?.explorer?.queryTx,B=h?.hash??m?.hash;return!R||!B?null:R.replace(":signature",B)},[f?.explorer?.queryTx,m?.hash,h?.hash]),b=c.useCallback(async()=>{h?.hash&&(await Fs.write({text:h.hash}),d(!0),setTimeout(()=>d(!1),2e3))},[h?.hash]),v=c.useCallback(async()=>{m?.hash&&(await Fs.write({text:m.hash}),d(!0),setTimeout(()=>d(!1),2e3))},[m?.hash]),[j,w]=c.useState(!1),N=c.useCallback(async()=>{g&&(await Fs.write({text:g}),w(!0),setTimeout(()=>w(!1),2e3))},[g]),M=c.useCallback(()=>{s()},[s]);if(!a)return t.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("detail.title"),onBack:M}),t.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:t.jsx("p",{className:"text-muted-foreground",children:e("history.noWallet")})})]});if(y)return t.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("detail.title"),onBack:M}),t.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[t.jsx(Aa,{className:"h-48"}),t.jsx(Aa,{className:"h-64"}),t.jsx(Aa,{className:"h-32"})]})]});if(p.error instanceof Wm){const R=m?.hash;return t.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("detail.title"),onBack:M}),t.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[t.jsx("div",{className:"bg-card flex items-center justify-center rounded-xl p-6 shadow-sm",children:t.jsx("p",{className:"text-muted-foreground",children:e("detail.invalidData")})}),R&&t.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[t.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:e("detail.hash")}),t.jsx("p",{className:"text-muted-foreground font-mono text-xs break-all",children:R}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:v,className:z("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80"),children:o?t.jsxs(t.Fragment,{children:[t.jsx(je,{className:"text-green-500 size-4"}),t.jsx("span",{className:"text-sm",children:e("detail.copied")})]}):t.jsxs(t.Fragment,{children:[t.jsx(On,{className:"size-4"}),t.jsx("span",{className:"text-sm",children:e("detail.copyHash")})]})}),t.jsx("button",{onClick:N,disabled:!g,className:z("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:j?t.jsxs(t.Fragment,{children:[t.jsx(je,{className:"text-green-500 size-4"}),t.jsx("span",{className:"text-sm",children:e("detail.copied")})]}):t.jsxs(t.Fragment,{children:[t.jsx(Fn,{className:"size-4"}),t.jsx("span",{className:"text-sm",children:e("detail.share")})]})})]})]})]})]})}if(!h)return t.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("detail.title"),onBack:M}),t.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:t.jsx("p",{className:"text-muted-foreground",children:e("detail.notFound")})})]});const S=h.type,A=pf(S),I=A.Icon,P=h.type==="swap"?h.assets?.[0]:void 0,D=h.type==="swap"?h.assets?.[1]:void 0,E=h.contract?.address||h.to,k=h.contract?.method,T=h.contract?.methodId,C=k?e(`method.${k}`,{defaultValue:k}):null,L=P?Me.fromRaw(P.value,P.decimals,P.symbol):null,_=D?Me.fromRaw(D.value,D.decimals,D.symbol):null;return t.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("detail.title"),onBack:M}),t.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[t.jsxs("div",{className:"bg-card flex flex-col items-center gap-3 rounded-xl p-6 shadow-sm",children:[t.jsx("div",{className:z("flex size-16 items-center justify-center rounded-full",A.bg),children:t.jsx(I,{className:z("size-8",A.color)})}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-muted-foreground text-sm",children:e(`type.${h.type}`,{defaultValue:h.type})}),h.type==="swap"&&L&&_?t.jsxs("div",{className:z("flex items-center justify-center gap-2",A.color),children:[t.jsx(os,{value:L.toNumber(),symbol:L.symbol,decimals:L.decimals,sign:"never",color:"default",weight:"normal",size:"lg"}),t.jsx("span",{className:"text-lg",children:""}),t.jsx(os,{value:_.toNumber(),symbol:_.symbol,decimals:_.decimals,sign:"never",color:"default",weight:"normal",size:"lg"})]}):t.jsx(os,{value:h.type==="send"?-Math.abs(h.amount.toNumber()):h.amount.toNumber(),symbol:h.symbol,sign:A.amountSign,color:"default",weight:"normal",size:"xl",className:A.color})]}),t.jsx(op,{status:hf(h.status).badgeStatus,label:e(`transaction:status.${h.status}`)})]}),t.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[t.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:e("detail.info")}),h.from&&h.to?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center justify-between py-2",children:[t.jsx("span",{className:"text-muted-foreground text-sm",children:e("detail.fromAddress")}),t.jsx(Ct,{address:h.from,copyable:!0,className:"text-sm"})]}),t.jsx("div",{className:"bg-border h-px"}),t.jsxs("div",{className:"flex items-center justify-between py-2",children:[t.jsx("span",{className:"text-muted-foreground text-sm",children:e("detail.toAddress")}),t.jsx(Ct,{address:h.to,copyable:!0,className:"text-sm"})]})]}):t.jsxs("div",{className:"flex items-center justify-between py-2",children:[t.jsx("span",{className:"text-muted-foreground text-sm",children:h.type==="send"?e("detail.toAddress"):e("detail.fromAddress")}),t.jsx(Ct,{address:h.address,copyable:!0,className:"text-sm"})]}),t.jsx("div",{className:"bg-border h-px"}),h.type==="swap"&&(P||D)&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center justify-between py-2",children:[t.jsx("span",{className:"text-muted-foreground text-sm",children:e("detail.swapFrom")}),t.jsx("span",{className:"text-sm font-medium",children:P?t.jsx(os,{value:Me.fromRaw(P.value,P.decimals,P.symbol).toNumber(),symbol:P.symbol,decimals:P.decimals,sign:"never",color:"default",size:"sm"}):"-"})]}),t.jsx("div",{className:"bg-border h-px"}),t.jsxs("div",{className:"flex items-center justify-between py-2",children:[t.jsx("span",{className:"text-muted-foreground text-sm",children:e("detail.swapTo")}),t.jsx("span",{className:"text-sm font-medium",children:D?t.jsx(os,{value:Me.fromRaw(D.value,D.decimals,D.symbol).toNumber(),symbol:D.symbol,decimals:D.decimals,sign:"never",color:"default",size:"sm"}):"-"})]}),t.jsx("div",{className:"bg-border h-px"})]}),(h.type==="approve"||h.type==="interaction"||h.type==="swap")&&E&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center justify-between py-2",children:[t.jsx("span",{className:"text-muted-foreground text-sm",children:e("detail.contractAddress")}),t.jsx(Ct,{address:E,copyable:!0,className:"text-sm"})]}),(h.type==="approve"||h.type==="interaction")&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"bg-border h-px"}),t.jsxs("div",{className:"flex items-center justify-between py-2",children:[t.jsx("span",{className:"text-muted-foreground text-sm",children:e("detail.method")}),t.jsx("span",{className:"text-sm font-medium font-mono",children:C||T||e("common:unknown")})]}),h.type==="approve"&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"bg-border h-px"}),t.jsxs("div",{className:"flex items-center justify-between py-2",children:[t.jsx("span",{className:"text-muted-foreground text-sm",children:e("detail.spender")}),t.jsx("span",{className:"text-sm font-medium",children:e("common:unknown")})]}),t.jsx("div",{className:"bg-border h-px"}),t.jsxs("div",{className:"flex items-center justify-between py-2",children:[t.jsx("span",{className:"text-muted-foreground text-sm",children:e("detail.allowance")}),t.jsx("span",{className:"text-sm font-medium",children:e("common:unknown")})]})]})]}),t.jsx("div",{className:"bg-border h-px"})]}),t.jsxs("div",{className:"flex items-center justify-between py-2",children:[t.jsx("span",{className:"text-muted-foreground text-sm",children:e("detail.time")}),t.jsx(ip,{value:h.timestamp,format:"datetime",className:"text-sm"})]}),t.jsx("div",{className:"bg-border h-px"}),t.jsxs("div",{className:"flex items-center justify-between py-2",children:[t.jsx("span",{className:"text-muted-foreground text-sm",children:e("detail.network")}),t.jsx("span",{className:"text-sm font-medium capitalize",children:h.chain})]}),h.fee&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"bg-border h-px"}),t.jsxs("div",{className:"flex items-center justify-between py-2",children:[t.jsx("span",{className:"text-muted-foreground text-sm",children:e("detail.fee")}),t.jsx(jr,{amount:h.fee.toNumber(),symbol:h.feeSymbol||h.symbol,className:"text-sm"})]})]}),h.blockNumber&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"bg-border h-px"}),t.jsxs("div",{className:"flex items-center justify-between py-2",children:[t.jsx("span",{className:"text-muted-foreground text-sm",children:e("detail.blockHeight")}),t.jsx("span",{className:"text-sm font-medium",children:h.blockNumber.toLocaleString()})]})]}),h.confirmations!==void 0&&h.confirmations>0&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"bg-border h-px"}),t.jsxs("div",{className:"flex items-center justify-between py-2",children:[t.jsx("span",{className:"text-muted-foreground text-sm",children:e("detail.confirmations")}),t.jsx("span",{className:"text-sm font-medium",children:h.confirmations})]})]})]}),h.hash&&t.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[t.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:e("detail.hash")}),t.jsx("p",{className:"text-muted-foreground font-mono text-xs break-all",children:h.hash}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:b,className:z("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80"),children:o?t.jsxs(t.Fragment,{children:[t.jsx(je,{className:"text-green-500 size-4"}),t.jsx("span",{className:"text-sm",children:e("detail.copied")})]}):t.jsxs(t.Fragment,{children:[t.jsx(On,{className:"size-4"}),t.jsx("span",{className:"text-sm",children:e("detail.copyHash")})]})}),t.jsx("button",{onClick:N,disabled:!g,className:z("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:j?t.jsxs(t.Fragment,{children:[t.jsx(je,{className:"text-green-500 size-4"}),t.jsx("span",{className:"text-sm",children:e("detail.copied")})]}):t.jsxs(t.Fragment,{children:[t.jsx(Fn,{className:"size-4"}),t.jsx("span",{className:"text-sm",children:e("detail.share")})]})})]})]})]})]})}ju.__docgenInfo={description:"",methods:[],displayName:"TransactionDetailPage"};const Nu=({params:e})=>t.jsx(ce,{children:t.jsx(he,{params:e,children:t.jsx(ju,{})})});Nu.__docgenInfo={description:"",methods:[],displayName:"TransactionDetailActivity"};const Yy=150;function wu({onScan:e,className:s}){const{t:n}=F("scanner"),{t:a}=F("common"),{navigate:r,goBack:i}=fe(),{push:l}=se(),o=_l(),d=c.useRef(null),u=c.useRef(null),m=c.useRef(null),p=c.useRef(null),x=c.useRef(!1),h=c.useRef(null),y=c.useRef(e),[f,g]=c.useState("idle"),[b,v]=c.useState(null),[j,w]=c.useState(!1);c.useEffect(()=>{y.current=e},[e]);const N=c.useCallback(E=>{if(E===h.current)return;h.current=E,g("success"),x.current=!1,"vibrate"in navigator&&navigator.vibrate(100);const k=sl(E);if(y.current)y.current(E,k);else switch(k.type){case"address":case"payment":r({to:"/send",search:{address:k.address,chain:k.chain,amount:k.type==="payment"?k.amount:void 0}});break;case"deeplink":r({to:k.path,search:k.params});break;case"contact":l("ContactAddConfirmJob",{name:k.name,addresses:JSON.stringify(k.addresses),memo:k.memo,avatar:k.avatar});break;case"unknown":r({to:"/send",search:{address:k.content}});break}},[r,l]),M=c.useCallback(()=>{if(x.current)return;x.current=!0,u.current||(u.current=document.createElement("canvas"));const E=async()=>{if(!(!x.current||!d.current||!p.current)){try{const k=await p.current.scanFromVideo(d.current,u.current??void 0);if(k){N(k.content);return}}catch(k){console.error("[Scanner] Scan error:",k)}x.current&&setTimeout(E,Yy)}};E()},[N]),S=c.useCallback(()=>{x.current=!1,m.current&&(m.current.getTracks().forEach(E=>E.stop()),m.current=null)},[]),A=c.useCallback(async()=>{S(),g("requesting"),h.current=null;try{if(!await o.checkPermission()&&!await o.requestPermission()){g("denied");return}const k=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});m.current=k,d.current&&(d.current.srcObject=k,await d.current.play(),M()),g("scanning")}catch(E){console.error("Camera error:",E),g("error"),v(E instanceof Error?E.message:"Camera initialization failed")}},[o,M,S]);c.useEffect(()=>(p.current=nl({useWorker:!0}),A(),()=>{S(),p.current?.destroy(),p.current=null}),[]);const I=c.useCallback(()=>{S(),i()},[S,i]),P=c.useCallback(()=>{const E=document.createElement("input");E.type="file",E.accept="image/*",E.onchange=async k=>{const T=k.target.files?.[0];if(T)try{const C=new Image,L=URL.createObjectURL(T);C.onload=async()=>{URL.revokeObjectURL(L);const _=document.createElement("canvas");_.width=C.width,_.height=C.height;const R=_.getContext("2d");if(!R||!p.current){v(n("noQrFound")),g("error");return}R.drawImage(C,0,0);const B=await p.current.scanFromCanvas(_);B?N(B.content):(v(n("noQrFound")),g("error"))},C.onerror=()=>{URL.revokeObjectURL(L),v(n("noQrFound")),g("error")},C.src=L}catch{v(n("noQrFound")),g("error")}},E.click()},[N,n]),D=c.useCallback(async()=>{if(m.current){const E=m.current.getVideoTracks()[0];if(E)try{await E.applyConstraints({advanced:[{torch:!j}]}),w(!j)}catch{}}},[j]);return t.jsxs("div",{className:z("relative flex h-screen flex-col bg-black",s),children:[t.jsxs("div",{className:"absolute top-0 right-0 left-0 z-10 flex items-center justify-between p-4",children:[t.jsx(q,{variant:"ghost",size:"icon","data-testid":"back-button",onClick:I,className:"text-white","aria-label":a("a11y.back"),children:t.jsx(ma,{className:"size-6"})}),t.jsx("h1",{"data-testid":"page-title",className:"text-lg font-medium text-white",children:n("title")}),t.jsx(q,{variant:"ghost",size:"icon",onClick:D,className:z("text-white",j&&"text-yellow-400"),"aria-label":n(j?"flashOff":"flashOn"),children:t.jsx(jl,{className:"size-6"})})]}),t.jsxs("div",{className:"relative flex-1",children:[t.jsx("video",{ref:d,className:z("absolute inset-0 size-full object-cover",f!=="scanning"&&f!=="success"&&"invisible"),playsInline:!0,muted:!0}),t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsxs("div",{className:"relative size-64",children:[t.jsx("div",{className:z("absolute top-0 left-0 size-8 border-t-4 border-l-4",f==="success"?"border-green-500":"border-primary")}),t.jsx("div",{className:z("absolute top-0 right-0 size-8 border-t-4 border-r-4",f==="success"?"border-green-500":"border-primary")}),t.jsx("div",{className:z("absolute bottom-0 left-0 size-8 border-b-4 border-l-4",f==="success"?"border-green-500":"border-primary")}),t.jsx("div",{className:z("absolute right-0 bottom-0 size-8 border-r-4 border-b-4",f==="success"?"border-green-500":"border-primary")}),f==="scanning"&&t.jsx("div",{className:"animate-scan bg-primary absolute right-2 left-2 h-0.5"})]})}),t.jsxs("div",{className:"absolute inset-x-0 bottom-32 text-center",children:[f==="idle"&&t.jsx("p",{className:"text-white/80",children:n("initializing")}),f==="requesting"&&t.jsx("p",{className:"text-white/80",children:n("requestingPermission")}),f==="scanning"&&t.jsx("p",{className:"text-white/80",children:n("scanPrompt")}),f==="success"&&t.jsx("div",{className:"space-y-2",children:t.jsx("p",{className:"text-green-400",children:n("scanSuccess")})}),f==="denied"&&t.jsxs("div",{className:"space-y-2",children:[t.jsx("p",{className:"text-red-400",children:n("permissionDenied")}),t.jsx(q,{variant:"outline","data-testid":"retry-button",onClick:A,children:n("retry")})]}),f==="error"&&t.jsxs("div",{className:"space-y-2",children:[t.jsx("p",{className:"text-red-400",children:b||n("error")}),t.jsx(q,{variant:"outline","data-testid":"retry-button",onClick:A,children:n("retry")})]})]})]}),t.jsxs("div",{className:"absolute inset-x-0 bottom-0 flex justify-center gap-8 pb-8",children:[t.jsxs(q,{variant:"ghost",size:"lg","data-testid":"gallery-button",onClick:P,className:"flex flex-col items-center text-white",children:[t.jsx(bl,{className:"mb-1 size-6"}),t.jsx("span",{className:"text-xs",children:n("gallery")})]}),t.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-white/20",children:t.jsx(Ep,{className:"size-8 text-white"})}),t.jsx("div",{className:"w-16"})," "]})]})}wu.__docgenInfo={description:"",methods:[],displayName:"ScannerPage",props:{onScan:{required:!1,tsType:{name:"union",raw:"((content: string, parsed: ParsedQRContent) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:"Callback when QR code is scanned"},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"Custom class name"}}};const Su=()=>t.jsx(ce,{children:t.jsx(wu,{})});Su.__docgenInfo={description:"",methods:[],displayName:"ScannerActivity"};const Xy=300*1e3,zn={ethereum:"Ethereum",bitcoin:"Bitcoin",tron:"Tron",binance:"BSC",bsc:"BSC",bfmeta:"BFMeta",ccchain:"CCChain",pmchain:"PMChain",bfchainv2:"BFChain V2",btgmeta:"BTGMeta",biwmeta:"BIWMeta",ethmeta:"ETHMeta",malibu:"Malibu",ccc:"CCChain"};function Cu(e){if(e)return e}function Zy(e){return e.map(s=>({id:s.id,name:s.name,address:s.address,balance:""}))}function ej(e,s){const n=new Map;for(const a of e)for(const r of a.chainAddresses){const i=Cu(r.chain);if(!i)continue;const l=n.get(i)??[];l.push({address:r.address,isDefault:a.id===s}),n.set(i,l)}return Array.from(n.entries()).map(([a,r])=>({chain:a,name:zn[a]??a,addresses:r.map(i=>({address:i.address,isDefault:i.isDefault}))}))}function To(e){const s=e?.trim().toLowerCase();return s==="true"||s==="1"}function ku(){const{t:e}=F("authorize"),{t:s}=F("common"),{navigate:n,goBack:a}=fe(),{push:r}=se(),i=Zt(),{id:l,type:o,chainName:d,signMessage:u,getMain:m}=be(),p=Ne(Ce,O=>O.currentWalletId),x=Ne(Ce,O=>O.wallets),h=Ne(Ce,Ue.getCurrentWallet),[y,f]=c.useState(null),[g,b]=c.useState(null),[v,j]=c.useState(!1),w=c.useMemo(()=>Zy(x),[x]),N=h?.id??x[0]?.id,[M,S]=c.useState(N),A=c.useMemo(()=>Cu(d),[d]),[I,P]=c.useState(A);c.useEffect(()=>P(A),[A]);const[D,E]=c.useState(void 0),[k,T]=c.useState(()=>new Set(x.map(O=>O.id))),[C,L]=c.useState(!1);c.useEffect(()=>{S(N)},[N]),c.useEffect(()=>{T(new Set(x.map(O=>O.id)))},[x]);const _=c.useMemo(()=>{const O=["viewAddress","viewPublicKey"];return u?.trim()&&O.push("signMessage"),To(m)&&O.push("getMain"),O},[m,u]),R=c.useMemo(()=>new hh(ys,l),[l]),B=c.useMemo(()=>!!u?.trim(),[u]),$=c.useMemo(()=>To(m),[m]),K=B||$;c.useEffect(()=>{let O=!1;async function ne(){b(null);try{const Z=await ys.getCallerAppInfo(l);if(O)return;f(Z)}catch{if(O)return;b(e("error.authFailed"))}}return ne(),()=>{O=!0}},[l,e]),c.useEffect(()=>{const O=window.setTimeout(()=>{(async()=>(await R.reject("timeout"),i.show({message:e("error.timeout"),position:"center"}),n({to:"/"})))()},Xy);return()=>{window.clearTimeout(O)}},[R,n,e,i]);const ee=c.useMemo(()=>M?x.find(O=>O.id===M)??null:null,[M,x]),V=c.useMemo(()=>ej(x,p),[x,p]),G=c.useMemo(()=>h?h.chainAddresses.map(O=>O.chain):[],[h]),me=c.useMemo(()=>{if(!(!h||!I))return h.chainAddresses.find(O=>O.chain===I)?.address},[h,I]);c.useEffect(()=>{o==="network"&&(I||P(V[0]?.chain))},[V,I,o]);const U=c.useMemo(()=>x.length===0?!1:o==="main"?!!ee:o==="network"?I?(V.find(O=>O.chain===I)?.addresses.length??0)>0:!1:k.size>0,[V,I,ee,k.size,o,x.length]),Y=c.useCallback(()=>{a()},[a]),ue=c.useCallback(async()=>{if(!v){j(!0);try{await R.reject("rejected"),n({to:"/"})}finally{j(!1)}}},[R,v,n]),ae=c.useCallback(async()=>{if(!(!U||v)){if(K){ts(async O=>{j(!0);try{const ne=u?.trim()??"";let Z=[],ie=[];if(o==="main"){if(!ee)return!1;Z=R.handleMainAddresses(ee),ie=[ee]}else if(o==="network"){if(!I)return!1;Z=R.handleNetworkAddresses(x,I),ie=x}else{const we=x.filter(oe=>k.has(oe.id));Z=R.handleAllAddresses(we),ie=we}return Z=await R.applySensitiveOptions(Z,ie,{password:O,signMessage:ne,getMain:$}),await R.approve(Z),n({to:"/"}),!0}catch{return!1}finally{j(!1)}}),r("WalletLockConfirmJob",{title:e("passwordConfirm.title")});return}j(!0);try{let O=[];if(o==="main"){if(!ee)return;O=R.handleMainAddresses(ee)}else if(o==="network"){if(!I)return;O=R.handleNetworkAddresses(x,I)}else{const ne=x.filter(Z=>k.has(Z.id));O=R.handleAllAddresses(ne)}await R.approve(O),n({to:"/"})}finally{j(!1)}}},[R,U,v,n,K,$,r,I,ee,k,u,e,o,x]);return o==="network"&&d&&!A?t.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[t.jsx(Q,{title:e("title.address"),onBack:Y}),t.jsx("div",{className:"flex-1 p-4",children:t.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[t.jsx("p",{className:"text-sm text-destructive",children:e("error.unknownChain")}),t.jsx("div",{className:"mt-4",children:t.jsx(q,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]}):g?t.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[t.jsx(Q,{title:e("title.address"),onBack:Y}),t.jsx("div",{className:"flex-1 p-4",children:t.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[t.jsx("p",{className:"text-sm text-destructive",children:g}),t.jsx("div",{className:"mt-4",children:t.jsx(q,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]}):t.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[t.jsx(Q,{title:e("title.address"),onBack:Y}),t.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[y&&t.jsx(vl,{appInfo:y}),t.jsx("div",{className:"px-1 text-sm text-foreground",children:e("address.shareWith")}),t.jsx(cp,{permissions:_}),t.jsx("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:t.jsxs("div",{className:"text-sm text-muted-foreground",children:[o==="main"&&e("address.scope.main"),o==="network"&&e("address.scope.network",{chainName:zn[I??""]??I??""}),o==="all"&&e("address.scope.all")]})}),t.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[o==="main"&&t.jsx(dp,{wallets:w,...M?{selectedId:M}:{},onSelect:O=>S(O.id)}),o==="network"&&h&&I&&t.jsx("div",{className:"aspect-[1.6/1] w-full",children:t.jsx(Vo,{wallet:h,chain:I,chainName:zn[I]??I,address:me,priority:"low",onOpenChainSelector:A?void 0:()=>L(!0)})}),o==="all"&&t.jsxs("div",{className:"space-y-2",children:[x.length===0&&t.jsx("div",{className:"py-6 text-center text-sm text-muted-foreground",children:e("address.noWallets")}),x.map(O=>{const ne=k.has(O.id);return t.jsxs("button",{type:"button",onClick:()=>{T(Z=>{const ie=new Set(Z);return ie.has(O.id)?ie.delete(O.id):ie.add(O.id),ie})},className:z("flex w-full items-center justify-between rounded-lg border px-3 py-2 text-left transition-colors","hover:bg-muted/50",ne?"border-primary bg-primary/5":"border-border bg-background"),"aria-pressed":ne,children:[t.jsxs("div",{className:"min-w-0",children:[t.jsx("div",{className:"truncate text-sm font-medium",children:O.name}),t.jsx("div",{className:"truncate font-mono text-xs text-muted-foreground",children:O.address})]}),t.jsx("div",{className:z("flex size-5 items-center justify-center rounded border",ne?"border-primary bg-primary text-primary-foreground":"border-border bg-background"),"aria-hidden":"true",children:ne?"":""})]},O.id)})]})]})]}),t.jsx("div",{className:"sticky bottom-0 border-t border-border bg-background p-4 safe-area-inset-bottom",children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx(q,{type:"button",variant:"outline",className:"flex-1",onClick:ue,disabled:v,children:e("button.reject")}),t.jsx(q,{type:"button",className:"flex-1",onClick:ae,disabled:!U||v,children:e("button.approve")})]})}),C&&t.jsx("div",{className:"fixed inset-0 z-50 bg-black/50",onClick:()=>L(!1),children:t.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-background rounded-t-2xl",onClick:O=>O.stopPropagation(),children:[t.jsx("div",{className:"flex justify-center py-3",children:t.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),t.jsx("div",{className:"border-b border-border px-4 pb-4",children:t.jsx("h2",{className:"text-center text-lg font-semibold",children:e("address.selectNetwork")})}),t.jsx("div",{className:"max-h-[60vh] space-y-2 overflow-y-auto p-4",children:G.map(O=>{const ne=h?.chainAddresses.find(Z=>Z.chain===O);return t.jsxs("button",{onClick:()=>{P(O),L(!1)},className:z("flex w-full items-center gap-3 rounded-xl p-4 transition-colors",O===I?"bg-primary/10 ring-1 ring-primary":"bg-muted/50 hover:bg-muted"),children:[t.jsx(vs,{chain:O,size:"md"}),t.jsxs("div",{className:"flex-1 text-left",children:[t.jsx("div",{className:"font-medium",children:zn[O]??O}),t.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:ne?.address?tj(ne.address):"---"})]}),O===I&&t.jsx(je,{className:"size-5 text-primary"})]},O)})}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})]})}function tj(e,s=10,n=8){return e.length<=s+n+3?e:`${e.slice(0,s)}...${e.slice(-n)}`}ku.__docgenInfo={description:"",methods:[],displayName:"AddressAuthPage"};const Au=({params:e})=>t.jsx(ce,{children:t.jsx(he,{params:e,children:t.jsx(ku,{})})});Au.__docgenInfo={description:"",methods:[],displayName:"AuthorizeAddressActivity"};const sj=300*1e3;function Po(e){return typeof e=="object"&&e!==null}function Qe(e,s){const n=e[s];if(typeof n=="string")return n;if(typeof n=="number"&&Number.isFinite(n))return String(n)}function nj(e,s,n){const a=Qe(e,s)?.trim();return a?{ok:!0,value:a}:{ok:!1,error:`signaturedata ${n}`}}function Et(e,s){for(const n of s){const a=Qe(e,n.key)?.trim();if(a)return{ok:!0,value:a}}return{ok:!1,error:`signaturedata ${s.map(n=>n.label).join(" / ")}`}}function aj(e){if(typeof e=="string"){const s=e.trim().toLowerCase();return s==="message"?{ok:!0,value:"message"}:s==="transfer"?{ok:!0,value:"transfer"}:s==="destroy"||s==="destory"?{ok:!0,value:"destory"}:{ok:!1,error:`${e}`}}return typeof e=="number"&&Number.isInteger(e)?e===0?{ok:!0,value:"message"}:e===1?{ok:!0,value:"transfer"}:e===7?{ok:!0,value:"destory"}:{ok:!1,error:`${e}`}:{ok:!1,error:"signaturedata.type "}}function rj(e){if(e===void 0||e.trim()==="")return{ok:!1,error:" signaturedata "};let s;try{s=JSON.parse(e)}catch{return{ok:!1,error:"signaturedata  JSON"}}if(!Array.isArray(s))return{ok:!1,error:"signaturedata  JSON "};if(s.length===0)return{ok:!1,error:"signaturedata "};const n=s[0];if(!Po(n))return{ok:!1,error:"signaturedata[0] "};const a=aj(n.type);if(!a.ok)return a;const r=Et(n,[{key:"chainName",label:"chainName"},{key:"chain",label:"chain"}]);if(!r.ok)return r;const i=r.value;if(a.value==="message"){const l=Et(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!l.ok)return l;const o=nj(n,"message","message");return o.ok?{ok:!0,item:{type:"message",payload:{chainName:i,senderAddress:l.value,message:o.value}}}:o}if(a.value==="transfer"){const l=Et(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!l.ok)return l;const o=Et(n,[{key:"receiveAddress",label:"receiveAddress"},{key:"to",label:"to"}]);if(!o.ok)return o;const d=Et(n,[{key:"balance",label:"balance"},{key:"amount",label:"amount"}]);if(!d.ok)return d;const u=Qe(n,"fee")?.trim(),m=Qe(n,"assetType")?.trim();let p;const x=n.contractInfo;if(Po(x)){const h=Qe(x,"assetType")?.trim(),y=x.decimals,f=Qe(x,"contractAddress")?.trim(),g=typeof y=="number"&&Number.isFinite(y)?y:typeof y=="string"&&y.trim()!==""?Number(y):void 0;h&&f&&typeof g=="number"&&Number.isFinite(g)&&(p={assetType:h,contractAddress:f,decimals:g})}return{ok:!0,item:{type:"transfer",payload:{chainName:i,senderAddress:l.value,receiveAddress:o.value,balance:d.value,...u?{fee:u}:{},...m?{assetType:m}:{},...p?{contractInfo:p}:{}}}}}{const l=Et(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!l.ok)return l;const o=Et(n,[{key:"destoryAmount",label:"destoryAmount"},{key:"amount",label:"amount"}]);if(!o.ok)return o;const d=Qe(n,"destoryAddress")?.trim()??Qe(n,"to")?.trim()??l.value,u=Qe(n,"fee")?.trim(),m=Qe(n,"assetType")?.trim();return{ok:!0,item:{type:"destory",payload:{chainName:i,senderAddress:l.value,destoryAddress:d,destoryAmount:o.value,...u?{fee:u}:{},...m?{assetType:m}:{}}}}}}function ij(e){return typeof e=="object"&&e!==null&&"senderAddress"in e&&"receiveAddress"in e&&"balance"in e}function oj(e){return typeof e=="object"&&e!==null&&"senderAddress"in e&&"message"in e&&!("receiveAddress"in e)}function lj(e){return typeof e=="object"&&e!==null&&"senderAddress"in e&&"destoryAddress"in e&&"destoryAmount"in e}function Eo(e){return e.contractInfo?.assetType?e.contractInfo.assetType.toUpperCase():e.assetType?e.assetType.toUpperCase():{ethereum:"ETH",bitcoin:"BTC",tron:"TRX",binance:"BNB",bsc:"BNB"}[e.chainName?.toLowerCase()??""]??"TOKEN"}function cj(e,s,n){const a=parseFloat(e)||0,r=parseFloat(s)||0,i=parseFloat(n??"0")||0,l=r+i;return{sufficient:a>=l,required:l.toString()}}function Iu(){const{t:e}=F("authorize"),{t:s}=F("common"),{navigate:n,goBack:a}=fe(),{push:r}=se(),i=Zt(),{id:l,signaturedata:o}=be(),d=Ne(Ce,Ue.getCurrentWallet),[u,m]=c.useState(null),[p,x]=c.useState(null),[h,y]=c.useState(null),[f,g]=c.useState(!1),b=c.useMemo(()=>new Dr(ys,l),[l]);c.useEffect(()=>{let D=!1;async function E(){y(null);try{const k=rj(o);if(!k.ok){y(k.error);return}const T=await ys.getCallerAppInfo(l);if(D)return;m(T);const C={eventId:l,type:k.item.type,payload:k.item.payload,appName:T.appName,appHome:T.origin,appLogo:T.appIcon};x(C)}catch{if(D)return;y(e("error.authFailed"))}}return E(),()=>{D=!0}},[l,o,e]),c.useEffect(()=>{const D=window.setTimeout(()=>{(async()=>(await b.reject("timeout"),i.show({message:e("error.timeout"),position:"center"}),n({to:"/"})))()},sj);return()=>{window.clearTimeout(D)}},[b,n,e,i]);const v=c.useMemo(()=>!p||!ij(p.payload)?null:p.payload,[p]),j=c.useMemo(()=>!p||!oj(p.payload)?null:p.payload,[p]),w=c.useMemo(()=>!p||!lj(p.payload)?null:p.payload,[p]),N=c.useMemo(()=>{if(!d)return{sufficient:!0,required:"0",walletBalance:"0"};const D=v?{chainName:v.chainName,amount:v.balance,fee:v.fee}:w?{chainName:w.chainName,amount:w.destoryAmount,fee:w.fee}:null;if(!D)return{sufficient:!0,required:"0",walletBalance:"0"};const k=d.chainAddresses.find(C=>C.chain.toLowerCase()===D.chainName?.toLowerCase())?"1.0":"0";return{...cj(k,D.amount,D.fee),walletBalance:k}},[d,w,v]),M=c.useMemo(()=>v?Eo(v):w?Eo(w):"TOKEN",[w,v]),S=c.useCallback(()=>{a()},[a]),A=c.useCallback(async()=>{if(!f){g(!0);try{await b.reject(N.sufficient?"rejected":"insufficient_balance"),n({to:"/"})}finally{g(!1)}}},[b,N.sufficient,f,n]),I=c.useCallback(()=>{N.sufficient&&(f||(ts(async D=>{g(!0);try{const E=d?.encryptedMnemonic;if(!E||!p)return!1;let k;if(p.type==="message"){if(!j)return!1;k=await b.handleMessageSign(j,E,D)}else if(p.type==="transfer"){if(!v)return!1;k=await b.handleTransferSign(v,E,D)}else if(p.type==="destory"){if(!w)return!1;k=await b.handleDestroySign(w,E,D)}else return!1;return await b.approve(k),n({to:"/"}),!0}catch{return!1}finally{g(!1)}}),r("WalletLockConfirmJob",{title:e("button.confirm")})))},[b,N.sufficient,d?.encryptedMnemonic,w,f,j,n,r,p,e,v]);if(h)return t.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[t.jsx(Q,{title:e("title.signature"),onBack:S}),t.jsx("div",{className:"flex-1 p-4",children:t.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[t.jsx("p",{className:"text-sm text-destructive",children:h}),t.jsx("div",{className:"mt-4",children:t.jsx(q,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]});const P=p?.type==="message"?e("signature.type.message"):p?.type==="destory"?e("signature.type.destroy"):e("title.signature");return t.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[t.jsx(Q,{title:P,onBack:S}),t.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[u&&t.jsx(vl,{appInfo:u}),t.jsx("div",{className:"px-1 text-sm text-foreground",children:e("signature.reviewTransaction")}),v&&t.jsxs(t.Fragment,{children:[t.jsx(Si,{from:v.senderAddress,to:v.receiveAddress,amount:`${v.balance} ${M}`,...v.fee?{fee:`${v.fee} ${M}`}:{},chainId:v.chainName}),!N.sufficient&&t.jsx(Ci,{balance:N.walletBalance,required:N.required,symbol:M})]}),j&&t.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[t.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:e("signature.messageToSign")}),t.jsx("div",{className:z("rounded-lg bg-muted/50 p-3","font-mono text-sm whitespace-pre-wrap break-all","max-h-48 overflow-y-auto"),children:j.message})]}),w&&t.jsxs(t.Fragment,{children:[t.jsx(Si,{from:w.senderAddress,to:w.destoryAddress,amount:`${w.destoryAmount} ${M}`,...w.fee?{fee:`${w.fee} ${M}`}:{},chainId:w.chainName}),!N.sufficient&&t.jsx(Ci,{balance:N.walletBalance,required:N.required,symbol:M})]}),p&&t.jsx("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:t.jsxs("div",{className:"text-sm text-muted-foreground",children:[p.type==="transfer"&&e("signature.type.transfer"),p.type==="message"&&e("signature.type.message"),p.type==="destory"&&e("signature.type.destroy")]})})]}),t.jsx("div",{className:"sticky bottom-0 border-t border-border bg-background p-4 safe-area-inset-bottom",children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx(q,{type:"button",variant:"outline",className:"flex-1",onClick:A,disabled:f,children:e("button.reject")}),t.jsx(q,{type:"button",className:"flex-1",onClick:I,disabled:f||!N.sufficient,children:e("button.confirm")})]})})]})}Iu.__docgenInfo={description:"",methods:[],displayName:"SignatureAuthPage"};const Tu=({params:e})=>t.jsx(ce,{children:t.jsx(he,{params:e,children:t.jsx(Iu,{})})});Tu.__docgenInfo={description:"",methods:[],displayName:"AuthorizeSignatureActivity"};function Pu({walletName:e,onEnterWallet:s,className:n}){const{t:a}=F("onboarding");return t.jsxs("div",{"data-testid":"import-success-step",className:z("flex min-h-screen flex-col items-center justify-center px-6 py-8",n),children:[t.jsx("div",{className:"mb-6 flex size-20 items-center justify-center rounded-full bg-green-100 dark:bg-green-900/30",children:t.jsx(As,{className:"size-10 text-green-600 dark:text-green-400"})}),t.jsx("h1",{"data-testid":"success-message",className:"mb-2 text-2xl font-bold",children:a("import.success.title")}),t.jsx("p",{className:"text-muted-foreground mb-8 text-center",children:t.jsx(fl,{i18nKey:"import.success.description",ns:"onboarding",values:{name:e},components:{bold:t.jsx("span",{className:"text-foreground font-medium"})}})}),t.jsx("div",{className:"w-full max-w-xs",children:t.jsxs("button",{type:"button","data-testid":"enter-wallet-button",onClick:s,className:z("flex w-full items-center justify-center gap-2 rounded-full py-3 font-medium transition-colors","bg-primary hover:bg-primary/90 text-primary-foreground"),children:[t.jsx("span",{children:a("import.success.enterWallet")}),t.jsx(Be,{className:"size-5"})]})})]})}Pu.__docgenInfo={description:"Success screen shown after wallet import",methods:[],displayName:"ImportWalletSuccess",props:{walletName:{required:!0,tsType:{name:"string"},description:"Wallet name"},onEnterWallet:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback when user chooses to enter wallet"},className:{required:!1,tsType:{name:"string"},description:"Additional class name"}}};function dj(e){if(!ol(e))throw new Error("Invalid mnemonic");return im(e.join(" "))}function uj(e){return new Set(e.map(s=>s.address.toLowerCase()))}const $a={isDuplicate:!1,type:"none"};function mj(e){const[s,n]=c.useState($a),[a,r]=c.useState(!1),[i,l]=c.useState(null),o=c.useCallback(async u=>{r(!0),l(null);try{const m=dj(u),p=uj(m),x=await e.getAllAddresses();for(const g of x)if(p.has(g.address.toLowerCase())){const b={isDuplicate:!0,type:"address",matchedWallet:{id:g.walletId,name:g.walletName,importType:"mnemonic",matchedAddress:g.address}};return n(b),b}const y=(await e.getAllMainWallets()).filter(g=>g.importType==="privateKey");for(const g of y)for(const b of g.addresses)if(p.has(b.address.toLowerCase())){const v={isDuplicate:!0,type:"privateKey",matchedWallet:{id:g.id,name:g.name,importType:"privateKey",matchedAddress:b.address}};return n(v),v}const f={isDuplicate:!1,type:"none"};return n(f),f}catch(m){const p=m instanceof Error?m.message:"";return l(p),$a}finally{r(!1)}},[e]),d=c.useCallback(()=>{n($a),l(null)},[]);return{result:s,isChecking:a,error:i,check:o,reset:d}}const fj={getAllAddresses:async()=>[],getAllMainWallets:async()=>[],findWalletByAddress:async()=>null};function Eu(){const{navigate:e,goBack:s}=fe(),{push:n}=se(),{t:a}=F(["onboarding","common","wallet"]),r=en(),i=aa().snapshot,l=Wo(),[o,d]=c.useState("keyType"),[u,m]=c.useState("mnemonic"),[p,x]=c.useState(!1),[h,y]=c.useState([]),[f,g]=c.useState(""),[b,v]=c.useState(null),[j,w]=c.useState([]),[N,M]=c.useState(!1),[S,A]=c.useState(""),[I,P]=c.useState(null),[D,E]=c.useState([]),[k,T]=c.useState(!1);c.useEffect(()=>{!k&&r.length>0&&(E(il(r)),T(!0))},[r,k]);const C=mj(fj),L=(()=>{switch(o){case"keyType":return 1;case"mnemonic":case"arbitrary":return 2;case"collision":return 2;case"pattern":return 3;case"chains":return 4;case"theme":return 5;case"success":return 5;default:return 1}})(),_=c.useCallback(()=>{switch(o){case"keyType":s();break;case"mnemonic":case"arbitrary":d("keyType"),C.reset();break;case"collision":d("mnemonic"),C.reset();break;case"pattern":d(u==="arbitrary"?"arbitrary":"mnemonic");break;case"chains":d("pattern");break;case"theme":d("chains");break}},[o,s,C,u]),R=c.useCallback(()=>{d("pattern")},[]),B=c.useCallback(ae=>{A(ae),d("chains")},[]),$=c.useCallback(()=>{if(u==="mnemonic"){d("mnemonic");return}if(p){d("arbitrary");return}Ib(()=>{x(!0),d("arbitrary")}),n("SecurityWarningJob",{})},[u,p,n]),K=c.useCallback(async ae=>{y(ae.mnemonic);const O=await C.check(ae.mnemonic);if(O.isDuplicate){if(O.type==="address"){console.log("Duplicate detected:",O.matchedWallet?.name);return}else if(O.type==="privateKey"){d("collision");return}}R()},[C,R]),ee=c.useCallback(async()=>{R()},[R]),V=c.useCallback(()=>{d("mnemonic"),C.reset()},[C]),G=c.useCallback(async(ae,O)=>{M(!0);try{const ne=ae.join(" "),ie=(await Zo({mnemonic:ne,selectedChainIds:D,chainConfigs:r})).map(({chainId:Re,address:Oe,publicKey:Se})=>({chain:Re,address:Oe,publicKey:Se??"",tokens:[]})),we=ie[0];if(!we)throw new Error("No chain addresses derived");const oe=Ua(we.address),ve=await ye.createWallet({name:a("wallet:defaultName"),keyType:"mnemonic",address:we.address,chain:we.chain,chainAddresses:ie,themeHue:oe},ne,O,oe);P(ve.id),d("theme")}catch(ne){console.error(":",ne)}finally{M(!1)}},[r,D,a]),me=c.useCallback(async ae=>{const O=f.trim();if(O&&j.length!==0){M(!0);try{const ne=j[0];if(!ne)throw new Error("No enabled bioforest chains");const Z=Ua(ne.address),ie=j.map(oe=>({chain:oe.chainId,address:oe.address,publicKey:"",tokens:[]})),we=await ye.createWallet({name:a("wallet:defaultName"),keyType:"arbitrary",address:ne.address,chain:ne.chainId,chainAddresses:ie,themeHue:Z},O,ae,Z);P(we.id),d("theme")}catch(ne){console.error(":",ne)}finally{M(!1)}}},[j,f,a]),U=c.useCallback(()=>{e({to:"/",replace:!0})},[e]),Y=c.useCallback(async()=>{if(!N){if(u==="arbitrary"){await me(S);return}h.length!==0&&await G(h,S)}},[me,G,N,u,h,S]),ue=c.useCallback(()=>{e({to:"/"})},[e]);return t.jsxs("div",{className:"flex min-h-screen flex-col",children:[o==="keyType"&&t.jsxs(t.Fragment,{children:[t.jsx(Q,{title:a("onboarding:keyType.title"),onBack:_}),t.jsx("div",{className:"px-4 pt-4",children:t.jsx(wt,{total:5,current:L})}),t.jsxs("div",{"data-testid":"key-type-step",className:"flex-1 space-y-6 p-4",children:[t.jsx(up,{value:u,onChange:ae=>{m(ae),ae==="mnemonic"&&(g(""),w([]))}}),t.jsx(q,{type:"button","data-testid":"continue-button",onClick:$,className:"w-full",children:a("common:continue")})]})]}),o==="mnemonic"&&t.jsxs(t.Fragment,{children:[t.jsx(Q,{title:a("onboarding:recover.title"),onBack:_}),t.jsx("div",{className:"px-4 pt-4",children:t.jsx(wt,{total:5,current:L})}),t.jsx("div",{"data-testid":"mnemonic-step",className:"flex-1 p-4",children:t.jsx(_f,{onSubmit:K,isSubmitting:C.isChecking})})]}),o==="arbitrary"&&t.jsxs(t.Fragment,{children:[t.jsx(Q,{title:a("onboarding:keyType.arbitrary"),onBack:_}),t.jsx("div",{className:"px-4 pt-4",children:t.jsx(wt,{total:5,current:L})}),t.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[t.jsx(mp,{value:f,onChange:ae=>{v(null),g(ae)},disabled:N}),b&&t.jsxs("div",{className:"bg-destructive/10 text-destructive flex items-start gap-2 rounded-lg px-3 py-2 text-sm",children:[t.jsx(Yt,{className:"mt-0.5 size-4 shrink-0"}),t.jsx("span",{children:b})]}),t.jsx(fp,{secret:f,enabledBioforestChainConfigs:i?l:void 0,onDerived:w}),t.jsxs(q,{type:"button",className:"w-full",disabled:N||f.trim()!==""&&j.length===0,onClick:()=>{if(!f.trim()){v(a("onboarding:arbitraryKey.required"));return}R()},children:[N&&t.jsx(Ve,{className:"size-4 animate-spin"}),a("common:continue")]})]})]}),o==="collision"&&t.jsxs(t.Fragment,{children:[t.jsx(Q,{title:a("onboarding:recover.addressConflict"),onBack:_}),t.jsx("div",{className:"px-4 pt-4",children:t.jsx(wt,{total:5,current:L})}),t.jsx("div",{className:"flex-1 p-4",children:t.jsx(pp,{result:C.result,onConfirm:ee,onCancel:V,isLoading:N})})]}),o==="pattern"&&t.jsxs(t.Fragment,{children:[t.jsx(Q,{title:a("onboarding:recover.setWalletLock"),onBack:_}),t.jsx("div",{className:"px-4 pt-4",children:t.jsx(wt,{total:5,current:L})}),t.jsx("div",{"data-testid":"pattern-step",className:"flex-1 p-4",children:t.jsx(Nr,{onComplete:B,minPoints:4})})]}),o==="chains"&&t.jsxs(t.Fragment,{children:[t.jsx(Q,{title:a("onboarding:chainSelector.title"),onBack:_}),t.jsx("div",{className:"px-4 pt-4",children:t.jsx(wt,{total:5,current:L})}),t.jsx("div",{"data-testid":"chains-step",className:"flex-1 p-4",children:t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsx(on,{icon:As,variant:"success",size:"lg",className:"mx-auto mb-4"}),t.jsx("h2",{className:"text-xl font-bold",children:a("onboarding:chainSelector.title")}),t.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:a("onboarding:chainSelector.subtitle")})]}),r.length===0?t.jsx("div",{className:"flex justify-center py-10",children:t.jsx(_e,{})}):t.jsx(Ar,{"data-testid":"chain-selector",chains:r,selectedChains:D,onSelectionChange:E}),t.jsx(et,{variant:"mint",className:"w-full","data-testid":"chains-continue-button",disabled:D.length===0,onClick:Y,children:a("common:next")})]})})]}),o==="theme"&&I&&t.jsxs(t.Fragment,{children:[t.jsx(Q,{title:a("onboarding:create.themeTitle")}),t.jsx("div",{className:"px-4 pt-4",children:t.jsx(wt,{total:5,current:L})}),t.jsx("div",{"data-testid":"theme-step",className:"flex-1 p-4",children:t.jsx(ba,{mode:"edit-only",walletId:I,onEditOnlyComplete:U})})]}),o==="success"&&t.jsx(Pu,{walletName:a("wallet:defaultName"),onEnterWallet:ue})]})}Eu.__docgenInfo={description:`Onboarding recover wallet page
Implements wallet recovery with duplicate detection per openspec/changes/add-wallet-recover-duplicate-guards`,methods:[],displayName:"OnboardingRecoverPage"};const _u=()=>t.jsx(ce,{children:t.jsx(Eu,{})});_u.__docgenInfo={description:"",methods:[],displayName:"OnboardingRecoverActivity"};const Sn={symbol:"USDT",balance:1234.56,fiatValue:"1234.56"},pj=[{id:"1",type:"send",status:"confirmed",amount:Me.fromFormatted("100",6,"USDT"),symbol:"USDT",address:"0xabcd...1234",timestamp:new Date(Date.now()-36e5)},{id:"2",type:"receive",status:"confirmed",amount:Me.fromFormatted("500",6,"USDT"),symbol:"USDT",address:"0x1234...abcd",timestamp:new Date(Date.now()-864e5)}];function Mu(){const{t:e}=F("token"),{navigate:s,goBack:n}=fe();return t.jsxs("div",{className:"flex min-h-screen flex-col",children:[t.jsx(Q,{title:Sn.symbol,onBack:n}),t.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[t.jsx("div",{className:"text-center",children:t.jsx(hp,{value:Sn.balance,symbol:Sn.symbol,fiatValue:Sn.fiatValue,size:"lg"})}),t.jsxs("div",{className:"flex gap-3",children:[t.jsxs(et,{variant:"mint",className:"flex-1",onClick:()=>s({to:"/send",search:{address:void 0,chain:void 0,amount:void 0}}),children:[t.jsx(xf,{className:"mr-2 size-4"}),e("detail.send")]}),t.jsxs(et,{variant:"blue",className:"flex-1",onClick:()=>s({to:"/receive"}),children:[t.jsx(ua,{className:"mr-2 size-4"}),e("detail.receive")]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"mb-3 text-lg font-semibold",children:e("detail.transactionHistory")}),t.jsx(gr,{transactions:pj,emptyTitle:e("detail.noTransactions"),emptyDescription:e("detail.noTransactionsDesc")})]})]})]})}Mu.__docgenInfo={description:"",methods:[],displayName:"TokenDetailPage"};const Ru=({params:e})=>t.jsx(ce,{children:t.jsx(he,{params:e,children:t.jsx(Mu,{})})});Ru.__docgenInfo={description:"",methods:[],displayName:"TokenDetailActivity"};function Du(){const{t:e}=F("common"),{goBack:s}=fe(),{push:n}=se(),r=Ne(hs).contacts,i=Ne(Ce,Ue.getCurrentWallet),[l,o]=c.useState(""),d=c.useRef(null),u=c.useMemo(()=>l.trim()?na.searchContacts(hs.state,l.trim()):r,[r,l]),m=c.useCallback(()=>{s()},[s]),p=c.useCallback(()=>{n("ContactEditJob",{})},[n]),x=c.useCallback(f=>{n("ContactEditJob",{contactId:f.id})},[n]),h=c.useCallback(f=>{n("ContactShareJob",{name:f.name,addresses:JSON.stringify(f.addresses.map(g=>({address:g.address,label:g.label}))),memo:f.memo,avatar:f.avatar})},[n]),y=c.useCallback(f=>{d.current=f,i?.encryptedMnemonic?(ts(async g=>{try{return await Bt(i.encryptedMnemonic,g)?(xs.deleteContact(f.id),d.current=null,!0):!1}catch{return!1}}),n("WalletLockConfirmJob",{title:e("addressBook.deleteTitle"),description:e("addressBook.deleteConfirm",{name:f.name})})):(xs.deleteContact(f.id),d.current=null)},[i?.encryptedMnemonic,n,e]);return t.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("addressBook.title"),onBack:m,rightAction:t.jsx("button",{onClick:p,className:z("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":e("a11y.addContact"),"data-testid":"address-book-add-button",children:t.jsx(kt,{className:"size-5"})})}),t.jsx("div",{className:"px-4 py-2",children:t.jsxs("div",{className:"relative",children:[t.jsx(rn,{className:"text-muted-foreground absolute top-1/2 left-3 size-4 -translate-y-1/2"}),t.jsx("input",{type:"text",value:l,onChange:f=>o(f.target.value),placeholder:e("addressBook.searchPlaceholder"),className:z("border-border bg-background w-full rounded-xl border py-2.5 pr-4 pl-10","focus:ring-primary focus:ring-2 focus:outline-none")})]})}),t.jsx("div",{className:"flex-1 p-4",children:u.length===0?t.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[t.jsx(mf,{className:"text-muted-foreground/50 size-12"}),t.jsx("p",{className:"text-muted-foreground",children:e(l?"addressBook.noResults":"addressBook.noContacts")}),!l&&t.jsx("button",{onClick:p,className:z("bg-primary rounded-full px-6 py-2.5 text-sm font-medium text-primary-foreground","hover:bg-primary/90 active:bg-primary/80"),children:e("contact.addTitle")})]}):t.jsx("div",{className:"space-y-2",children:u.map(f=>t.jsx(hj,{contact:f,onShare:()=>h(f),onEdit:()=>x(f),onDelete:()=>y(f)},f.id))})})]})}function hj({contact:e,onEdit:s,onDelete:n,onShare:a}){const{t:r}=F("common"),[i,l]=c.useState(!1);return t.jsx("div",{className:z("bg-card rounded-xl p-4 shadow-sm","transition-colors"),children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(da,{src:e.avatar||(e.addresses[0]?.address?Ht(e.addresses[0].address):void 0),size:40}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsx("h3",{className:"truncate font-medium",children:e.name}),e.addresses.length>0&&t.jsxs("p",{className:"text-muted-foreground truncate font-mono text-xs",children:[e.addresses[0]?.address,e.addresses.length>1&&` (+${e.addresses.length-1})`]}),e.memo&&t.jsx("p",{className:"text-muted-foreground mt-1 truncate text-xs",children:e.memo})]}),t.jsxs("div",{className:"relative",children:[t.jsx("button",{onClick:()=>l(!i),className:z("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":r("a11y.moreActions"),children:t.jsx(wm,{className:"text-muted-foreground size-4"})}),i&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>l(!1)}),t.jsxs("div",{className:"bg-popover border-border absolute top-full right-0 z-20 mt-1 w-32 rounded-lg border py-1 shadow-lg",children:[t.jsx("button",{onClick:()=>{l(!1),a()},className:"hover:bg-muted w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.shareContact")}),t.jsx("button",{onClick:()=>{l(!1),s()},className:"hover:bg-muted w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.edit")}),t.jsx("button",{onClick:()=>{l(!1),n()},className:"text-destructive hover:bg-destructive/10 w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.delete")})]})]})]})]})})}Du.__docgenInfo={description:"",methods:[],displayName:"AddressBookPage"};const zu=()=>t.jsx(ce,{children:t.jsx(Du,{})});zu.__docgenInfo={description:"",methods:[],displayName:"AddressBookActivity"};const Lu={notifications:[],unreadCount:0,isInitialized:!1},lt=new cm(Lu),dr="bfm_notifications";function Cn(e){try{localStorage.setItem(dr,JSON.stringify(e))}catch(s){console.error("Failed to persist notifications:",s)}}function kn(e){return e.filter(s=>!s.read).length}const Ls={initialize:()=>{try{const e=localStorage.getItem(dr);if(e){const s=JSON.parse(e);lt.setState(()=>({notifications:s,unreadCount:kn(s),isInitialized:!0}))}else lt.setState(s=>({...s,isInitialized:!0}))}catch(e){console.error("Failed to initialize notifications:",e),lt.setState(s=>({...s,isInitialized:!0}))}},add:e=>{const s={...e,id:crypto.randomUUID(),timestamp:Date.now(),read:!1};return lt.setState(n=>{const a=[s,...n.notifications];return Cn(a),{...n,notifications:a,unreadCount:kn(a)}}),s},markRead:e=>{lt.setState(s=>{const n=s.notifications.map(a=>a.id===e?{...a,read:!0}:a);return Cn(n),{...s,notifications:n,unreadCount:kn(n)}})},markAllRead:()=>{lt.setState(e=>{const s=e.notifications.map(n=>({...n,read:!0}));return Cn(s),{...e,notifications:s,unreadCount:0}})},remove:e=>{lt.setState(s=>{const n=s.notifications.filter(a=>a.id!==e);return Cn(n),{...s,notifications:n,unreadCount:kn(n)}})},clearAll:()=>{localStorage.removeItem(dr),lt.setState(()=>Lu)}},xj={transaction:{icon:"",bg:"bg-blue-100 dark:bg-blue-900/30"},security:{icon:"",bg:"bg-red-100 dark:bg-red-900/30"},system:{icon:"",bg:"bg-gray-100 dark:bg-gray-800/30"}};function gj(){const{t:e}=F("notification"),s=sn();return c.useCallback(n=>{const r=Date.now()-n,i=Math.floor(r/6e4),l=Math.floor(r/36e5),o=Math.floor(r/864e5);return i<1?e("time.justNow"):i<60?e("time.minutesAgo",{count:i}):l<24?e("time.hoursAgo",{count:l}):o<7?e("time.daysAgo",{count:o}):new Date(n).toLocaleDateString(s)},[e,s])}function vj({notification:e,onRead:s,onRemove:n,formatRelativeTime:a,t:r}){const i=xj[e.type],l=c.useCallback(()=>{e.read||s(e.id)},[e.id,e.read,s]);return t.jsxs("div",{onClick:l,className:z("flex cursor-pointer items-start gap-3 rounded-xl p-4 transition-colors",e.read?"bg-muted/30":"bg-card shadow-sm"),children:[t.jsx("div",{className:z("flex size-10 shrink-0 items-center justify-center rounded-full",i.bg),children:t.jsx("span",{className:"text-lg",children:i.icon})}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsx("h4",{className:z("font-medium",e.read&&"text-muted-foreground"),children:e.title}),t.jsx("span",{className:"text-muted-foreground shrink-0 text-xs",children:a(e.timestamp)})]}),t.jsx("p",{className:z("mt-1 text-sm",e.read?"text-muted-foreground":"text-foreground/80"),children:e.message}),!e.read&&t.jsx("div",{className:"bg-primary mt-2 flex size-2 rounded-full","aria-label":r("unread")})]}),t.jsx("button",{onClick:o=>{o.stopPropagation(),n(e.id)},className:"text-muted-foreground hover:text-destructive shrink-0 p-1","aria-label":r("delete"),children:t.jsx(Qt,{className:"size-4"})})]})}function bj({notifications:e,onRead:s,onRemove:n,formatRelativeTime:a,t:r,language:i}){const l=c.useMemo(()=>{const o=new Map,d=new Date().toLocaleDateString(i),u=new Date(Date.now()-864e5).toLocaleDateString(i);for(const m of e){const p=new Date(m.timestamp).toLocaleDateString(i);let x=p;p===d?x=r("time.today"):p===u&&(x=r("time.yesterday"));const h=o.get(x)||[];o.set(x,[...h,m])}return o},[e,i,r]);return e.length===0?t.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[t.jsx("div",{className:"bg-muted mb-4 flex size-16 items-center justify-center rounded-full",children:t.jsx(xp,{className:"text-muted-foreground size-8"})}),t.jsx("h3",{className:"text-lg font-medium",children:r("empty.title")}),t.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:r("empty.desc")})]}):t.jsx("div",{className:"space-y-6",children:Array.from(l.entries()).map(([o,d])=>t.jsxs("div",{children:[t.jsx("h3",{className:"text-muted-foreground mb-2 text-sm font-medium",children:o}),t.jsx("div",{className:"space-y-2",children:d.map(u=>t.jsx(vj,{notification:u,onRead:s,onRemove:n,formatRelativeTime:a,t:r},u.id))})]},o))})}function Bu(){const{t:e}=F("notification"),s=sn(),n=gj(),{goBack:a}=fe(),r=Ne(lt);c.useEffect(()=>{r.isInitialized||Ls.initialize()},[r.isInitialized]);const i=c.useCallback(u=>{Ls.markRead(u)},[]),l=c.useCallback(u=>{Ls.remove(u)},[]),o=c.useCallback(()=>{Ls.markAllRead()},[]),d=c.useCallback(()=>{Ls.clearAll()},[]);return t.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("title"),onBack:a,rightAction:r.unreadCount>0?t.jsxs("button",{onClick:o,className:"text-primary hover:bg-primary/10 flex items-center gap-1 rounded-full px-3 py-1.5 text-sm","aria-label":e("markAllRead"),children:[t.jsx(je,{className:"size-4"}),e("markAllRead")]}):void 0}),t.jsx("div",{className:"bg-card border-b px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("p",{className:"text-muted-foreground text-sm",children:r.unreadCount>0?e("unreadCount",{count:r.unreadCount}):e("noUnread")}),r.notifications.length>0&&t.jsxs(q,{variant:"ghost",size:"sm",onClick:d,className:"text-destructive",children:[t.jsx(Qt,{className:"mr-1 size-4"}),e("clear")]})]})}),t.jsx("div",{className:"flex-1 p-4",children:t.jsx(bj,{notifications:r.notifications,onRead:i,onRemove:l,formatRelativeTime:n,t:e,language:s})})]})}Bu.__docgenInfo={description:"",methods:[],displayName:"NotificationCenterPage"};const Ou=()=>t.jsx(ce,{children:t.jsx(Bu,{})});Ou.__docgenInfo={description:"",methods:[],displayName:"NotificationsActivity"};function yj(e){const s=e.toNumber();return s>=1e9?`${(s/1e9).toFixed(2)}B`:s>=1e6?`${(s/1e6).toFixed(2)}M`:s>=1e3?`${(s/1e3).toFixed(2)}K`:s.toFixed(Math.min(5,8))}function Fu({item:e,onMint:s,className:n}){const{t:a}=F("staking"),r=[{label:a("totalMinted",{asset:e.assetType}),value:e.totalMinted},{label:a("totalCirculation",{asset:e.assetType}),value:e.totalCirculation},{label:a("totalBurned",{asset:e.assetType}),value:e.totalBurned},{label:a("totalStaked",{asset:e.externalAssetType}),value:e.totalStaked}];return t.jsxs("div",{className:z("overflow-hidden rounded-xl shadow-md","bg-gradient-to-b from-primary/90 to-primary",n),children:[t.jsxs("div",{className:"relative grid grid-cols-2 gap-3 p-4",children:[r.map((i,l)=>t.jsxs("div",{className:"flex flex-col items-center text-center",children:[t.jsx("span",{className:"text-lg font-semibold text-amber-300",children:yj(i.value)}),t.jsx("span",{className:"text-xs text-primary-foreground/70",children:i.label})]},l)),t.jsx("div",{className:"pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 opacity-20",children:t.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-white/20 text-2xl font-bold text-white",children:e.chain.charAt(0)})})]}),t.jsxs("div",{className:"flex items-center justify-between bg-card px-4 py-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ht,{symbol:e.externalAssetType,size:"sm"}),t.jsxs("div",{className:"text-xs",children:[t.jsx("div",{className:"font-medium text-foreground",children:e.externalAssetType}),t.jsx("div",{className:"text-muted-foreground",children:e.externalChain})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ht,{symbol:e.assetType,size:"sm"}),t.jsxs("div",{className:"text-xs",children:[t.jsx("div",{className:"font-medium text-foreground",children:e.assetType}),t.jsx("div",{className:"text-muted-foreground",children:e.chain})]})]}),t.jsx(q,{size:"sm",variant:"default",className:"rounded-full px-4",onClick:()=>s?.(e),children:a("mint")})]})]})]})}Fu.__docgenInfo={description:"Staking pool card component",methods:[],displayName:"StakingPoolCard",props:{item:{required:!0,tsType:{name:"StakingOverviewItem"},description:""},onMint:{required:!1,tsType:{name:"union",raw:"((item: StakingOverviewItem) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const jj=[{value:"all",label:"allNetworks"},{value:"ETH",label:"Ethereum"},{value:"BSC",label:"BNB Chain"},{value:"TRON",label:"Tron"},{value:"BFMeta",label:"BFMeta"},{value:"BFChain",label:"BFChain"}];function Wu({onMint:e,className:s}){const{t:n}=F("staking"),[a,r]=c.useState(""),[i,l]=c.useState("all"),[o,d]=c.useState(!1),[u,m]=c.useState([]),[p,x]=c.useState(!0);c.useEffect(()=>{let f=!0;return x(!0),Ut.getOverview().then(g=>{f&&(m(g),x(!1))}),()=>{f=!1}},[]);const h=c.useMemo(()=>{let f=u;if(a.trim()){const g=a.toLowerCase();f=f.filter(b=>b.assetType.toLowerCase().includes(g)||b.externalAssetType.toLowerCase().includes(g)||b.chain.toLowerCase().includes(g)||b.externalChain.toLowerCase().includes(g))}return i!=="all"&&(f=f.filter(g=>g.chain===i||g.externalChain===i)),f},[u,a,i]),y=f=>{l(f),d(!1)};return p?t.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[t.jsx(_e,{size:"lg"}),t.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):t.jsxs("div",{className:z("space-y-4",s),children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx(rn,{className:"text-muted-foreground absolute top-1/2 left-3 size-4 -translate-y-1/2"}),t.jsx(He,{type:"text",placeholder:n("searchPlaceholder"),value:a,onChange:f=>r(f.target.value),className:"pl-9"})]}),t.jsxs(Ot,{open:o,onOpenChange:d,children:[t.jsx(uf,{render:t.jsxs(q,{variant:"outline",size:"icon",className:"relative",children:[t.jsx(wl,{className:"size-4"}),i!=="all"&&t.jsx("span",{className:"bg-primary absolute -top-1 -right-1 size-2 rounded-full"})]})}),t.jsxs(Ft,{side:"bottom",className:"h-[60vh]",children:[t.jsx(Wt,{children:t.jsx($t,{children:n("selectNetwork")})}),t.jsx("div",{className:"mt-4 space-y-2",children:jj.map(f=>t.jsxs("button",{onClick:()=>y(f.value),className:z("flex w-full items-center justify-between rounded-lg px-4 py-3 text-left transition-colors",i===f.value?"bg-primary/10 text-primary":"hover:bg-muted"),children:[t.jsx("span",{children:f.value==="all"?n("allNetworks"):f.label}),i===f.value&&t.jsx("span",{className:"text-primary",children:""})]},f.value))})]})]})]}),h.length===0?t.jsx("div",{className:"flex flex-col items-center justify-center py-20",children:t.jsx("p",{className:"text-muted-foreground",children:n("noResults")})}):t.jsx("div",{className:"space-y-4",children:h.map((f,g)=>t.jsx(Fu,{item:f,onMint:e},`${f.chain}-${f.assetType}-${g}`))})]})}Wu.__docgenInfo={description:"Staking overview panel with search and filter",methods:[],displayName:"StakingOverviewPanel",props:{onMint:{required:!1,tsType:{name:"signature",type:"function",raw:"(item: StakingOverviewItem) => void",signature:{arguments:[{type:{name:"StakingOverviewItem"},name:"item"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Nj=["ETH","BSC","TRON"],An={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron",BFMeta:"BFMeta",BFChain:"BFChain",CCChain:"CCChain",PMChain:"PMChain"},_o={ETH:{BFM:"1000.00",USDT:"5000.00"},BSC:{BFM:"2500.00",USDT:"10000.00",BFC:"500.00"},TRON:{USDT:"8000.00"}};function wj(e,s){if(!e)return[];const n=[];for(const[a,r]of Object.entries(e))for(const[i,l]of Object.entries(r)){const o=l.supportChain[s];o&&n.push({asset:o.assetType,targetChain:a,targetAsset:i})}return n}function $u({onSuccess:e,className:s}){const{t:n}=F("staking"),[a,r]=c.useState("BSC"),[i,l]=c.useState(""),[o,d]=c.useState(""),[u,m]=c.useState(""),[p,x]=c.useState(""),[h,y]=c.useState(!1),[f,g]=c.useState(!1),[b,v]=c.useState(!0),[j,w]=c.useState(!1),[N,M]=c.useState(null);c.useEffect(()=>{let C=!0;return Ut.getRechargeConfig().then(L=>{C&&(M(L),v(!1))}),()=>{C=!1}},[]);const S=c.useMemo(()=>wj(N,a),[N,a]);c.useEffect(()=>{const C=S[0];C&&!i&&(l(C.asset),d(C.targetChain),m(C.targetAsset))},[S,i]);const A=c.useCallback(C=>{r(C),l(""),d(""),m(""),x(""),y(!1)},[]),I=c.useCallback(C=>{l(C.asset),d(C.targetChain),m(C.targetAsset),g(!1)},[]),P=c.useMemo(()=>_o[a]?.[i]??"0.00",[a,i]),D=c.useCallback(()=>{x(P.replace(/,/g,""))},[P]),E=c.useMemo(()=>{if(!p)return null;const C=parseFloat(p);if(isNaN(C)||C<=0)return n("invalidAmount");const L=parseFloat(P.replace(/,/g,""));return C>L?n("insufficientBalance"):null},[p,P,n]),k=c.useMemo(()=>a&&i&&o&&u&&p&&!E&&!j,[a,i,o,u,p,E,j]),T=c.useCallback(async()=>{if(k){w(!0);try{const C=p.replace(/,/g,""),L={sourceChain:a,sourceAsset:i,amount:Me.fromFormatted(C,18,i),targetChain:o,targetAsset:u},_=await Ut.submitMint(L);e?.(_.id)}finally{w(!1)}}},[k,a,i,p,o,u,e]);return b?t.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[t.jsx(_e,{size:"lg"}),t.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):t.jsxs("div",{className:z("space-y-4",s),children:[t.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[t.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("sourceChain")}),t.jsxs("button",{type:"button",onClick:()=>y(!0),className:"bg-background mb-3 flex w-full items-center justify-between rounded-lg px-3 py-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"bg-muted flex size-6 items-center justify-center rounded-full text-xs font-bold",children:a.charAt(0)}),t.jsx("span",{className:"font-medium",children:An[a]})]}),t.jsx(Be,{className:"text-muted-foreground size-4"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{type:"button",onClick:()=>g(!0),className:"bg-background flex shrink-0 items-center gap-2 rounded-lg px-3 py-2",children:[t.jsx(ht,{symbol:i||"?",size:"sm"}),t.jsx("span",{className:"font-medium",children:i||n("selectToken")}),t.jsx(Be,{className:"text-muted-foreground size-4"})]}),t.jsx("div",{className:"flex-1",children:t.jsx(He,{type:"text",inputMode:"decimal",placeholder:"0.00",value:p,onChange:C=>x(C.target.value),className:"border-0 bg-transparent text-right text-lg font-semibold"})})]}),t.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs",children:[t.jsxs("span",{className:"text-muted-foreground",children:[n("availableBalance"),": ",P]}),t.jsx(q,{type:"button",variant:"ghost",size:"sm",className:"text-primary h-auto px-2 py-1 text-xs",onClick:D,children:n("max")})]}),E&&t.jsx("div",{className:"text-destructive mt-2 text-xs",children:E})]}),t.jsx("div",{className:"flex justify-center",children:t.jsx("div",{className:"bg-muted rounded-full p-2",children:t.jsx(ua,{className:"text-muted-foreground size-4"})})}),t.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[t.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("targetChain")}),t.jsxs("div",{className:"bg-background flex items-center justify-between rounded-lg px-3 py-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"bg-primary/20 text-primary flex size-6 items-center justify-center rounded-full text-xs font-bold",children:o.charAt(0)||"?"}),t.jsx("span",{className:"font-medium",children:An[o]||n("selectToken")})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ht,{symbol:u||"?",size:"sm"}),t.jsx("span",{className:"font-medium",children:u||"-"})]})]}),t.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-muted-foreground",children:n("amount")}),t.jsxs("span",{className:"font-semibold",children:[p||"0.00"," ",u]})]})]}),t.jsx(q,{type:"button",size:"lg",className:"w-full",disabled:!k,onClick:T,children:j?t.jsxs(t.Fragment,{children:[t.jsx(_e,{size:"sm"}),t.jsx("span",{className:"ml-2",children:n("confirm")})]}):n("confirm")}),t.jsx(Ot,{open:h,onOpenChange:y,children:t.jsxs(Ft,{side:"bottom",className:"h-[50vh]",children:[t.jsx(Wt,{children:t.jsx($t,{children:n("selectChain")})}),t.jsx("div",{className:"mt-4 space-y-2",children:Nj.map(C=>t.jsxs("button",{onClick:()=>A(C),className:z("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",a===C?"bg-primary/10 text-primary":"hover:bg-muted"),children:[t.jsx("div",{className:"bg-muted flex size-8 items-center justify-center rounded-full text-sm font-bold",children:C.charAt(0)}),t.jsx("span",{className:"font-medium",children:An[C]}),a===C&&t.jsx("span",{className:"text-primary ml-auto",children:""})]},C))})]})}),t.jsx(Ot,{open:f,onOpenChange:g,children:t.jsxs(Ft,{side:"bottom",className:"h-[60vh]",children:[t.jsx(Wt,{children:t.jsx($t,{children:n("selectToken")})}),t.jsx("div",{className:"mt-4 space-y-2",children:S.length===0?t.jsx("p",{className:"text-muted-foreground py-8 text-center",children:n("noResults")}):S.map(C=>t.jsxs("button",{onClick:()=>I(C),className:z("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",i===C.asset?"bg-primary/10 text-primary":"hover:bg-muted"),children:[t.jsx(ht,{symbol:C.asset,size:"md"}),t.jsxs("div",{className:"flex-1 text-left",children:[t.jsx("div",{className:"font-medium",children:C.asset}),t.jsxs("div",{className:"text-muted-foreground text-xs",children:[" ",An[C.targetChain]," (",C.targetAsset,")"]})]}),t.jsx("div",{className:"text-muted-foreground text-right text-sm",children:_o[a]?.[C.asset]??"0.00"}),i===C.asset&&t.jsx("span",{className:"text-primary",children:""})]},`${C.targetChain}-${C.asset}`))})]})})]})}$u.__docgenInfo={description:"Mint form component",methods:[],displayName:"MintForm",props:{onSuccess:{required:!1,tsType:{name:"signature",type:"function",raw:"(txId: string) => void",signature:{arguments:[{type:{name:"string"},name:"txId"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Sj=["BFMeta","BFChain","CCChain","PMChain"],In={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron",BFMeta:"BFMeta",BFChain:"BFChain",CCChain:"CCChain",PMChain:"PMChain"},Mo={BFMeta:{BFM:"5000.00",USDT:"2500.00"},BFChain:{BFC:"1000.00"},CCChain:{},PMChain:{}};function Cj(e,s){if(!e)return[];const n=s.toLowerCase(),a=e[n];if(!a)return[];const r=[];for(const[i,l]of Object.entries(a)){const o=[];l.supportChain.ETH&&o.push("ETH"),l.supportChain.BSC&&o.push("BSC"),l.supportChain.TRON&&o.push("TRON"),o.length>0&&r.push({asset:i,targetChains:o})}return r}function Hu({onSuccess:e,className:s}){const{t:n}=F("staking"),[a,r]=c.useState("BFMeta"),[i,l]=c.useState(""),[o,d]=c.useState(""),[u,m]=c.useState(""),[p,x]=c.useState(!1),[h,y]=c.useState(!1),[f,g]=c.useState(!1),[b,v]=c.useState(!0),[j,w]=c.useState(!1),[N,M]=c.useState(null);c.useEffect(()=>{let _=!0;return Ut.getRechargeConfig().then(R=>{_&&(M(R),v(!1))}),()=>{_=!1}},[]);const S=c.useMemo(()=>Cj(N,a),[N,a]),A=c.useMemo(()=>i?S.find(R=>R.asset===i)?.targetChains??[]:[],[S,i]);c.useEffect(()=>{const _=S[0];if(_&&!i){l(_.asset);const R=_.targetChains[0];R&&d(R)}},[S,i]);const I=c.useCallback(_=>{r(_),l(""),d(""),m(""),x(!1)},[]),P=c.useCallback(_=>{l(_.asset);const R=_.targetChains[0];R&&d(R),y(!1)},[]),D=c.useCallback(_=>{d(_),g(!1)},[]),E=c.useMemo(()=>Mo[a]?.[i]??"0.00",[a,i]),k=c.useCallback(()=>{m(E.replace(/,/g,""))},[E]),T=c.useMemo(()=>{if(!u)return null;const _=parseFloat(u);if(isNaN(_)||_<=0)return n("invalidAmount");const R=parseFloat(E.replace(/,/g,""));return _>R?n("insufficientBalance"):null},[u,E,n]),C=c.useMemo(()=>a&&i&&o&&u&&!T&&!j,[a,i,o,u,T,j]),L=c.useCallback(async()=>{if(!(!C||!o)){w(!0);try{const _=u.replace(/,/g,""),R={sourceChain:a,sourceAsset:i,amount:Me.fromFormatted(_,8,i),targetChain:o,targetAsset:i},B=await Ut.submitBurn(R);e?.(B.id)}finally{w(!1)}}},[C,a,i,u,o,e]);return b?t.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[t.jsx(_e,{size:"lg"}),t.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):t.jsxs("div",{className:z("space-y-4",s),children:[t.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[t.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("sourceChain")}),t.jsxs("button",{type:"button",onClick:()=>x(!0),className:"bg-background mb-3 flex w-full items-center justify-between rounded-lg px-3 py-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"bg-primary/20 text-primary flex size-6 items-center justify-center rounded-full text-xs font-bold",children:a.charAt(0)}),t.jsx("span",{className:"font-medium",children:In[a]})]}),t.jsx(Be,{className:"text-muted-foreground size-4"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{type:"button",onClick:()=>y(!0),className:"bg-background flex shrink-0 items-center gap-2 rounded-lg px-3 py-2",children:[t.jsx(ht,{symbol:i||"?",size:"sm"}),t.jsx("span",{className:"font-medium",children:i||n("selectToken")}),t.jsx(Be,{className:"text-muted-foreground size-4"})]}),t.jsx("div",{className:"flex-1",children:t.jsx(He,{type:"text",inputMode:"decimal",placeholder:"0.00",value:u,onChange:_=>m(_.target.value),className:"border-0 bg-transparent text-right text-lg font-semibold"})})]}),t.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs",children:[t.jsxs("span",{className:"text-muted-foreground",children:[n("availableBalance"),": ",E]}),t.jsx(q,{type:"button",variant:"ghost",size:"sm",className:"text-primary h-auto px-2 py-1 text-xs",onClick:k,children:n("max")})]}),T&&t.jsx("div",{className:"text-destructive mt-2 text-xs",children:T})]}),t.jsx("div",{className:"flex justify-center",children:t.jsx("div",{className:"bg-muted rounded-full p-2",children:t.jsx(ua,{className:"text-muted-foreground size-4"})})}),t.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[t.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("targetChain")}),t.jsxs("button",{type:"button",onClick:()=>g(!0),disabled:A.length===0,className:"bg-background flex w-full items-center justify-between rounded-lg px-3 py-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"bg-muted flex size-6 items-center justify-center rounded-full text-xs font-bold",children:o?o.charAt(0):"?"}),t.jsx("span",{className:"font-medium",children:o?In[o]:n("selectChain")})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ht,{symbol:i||"?",size:"sm"}),t.jsx("span",{className:"font-medium",children:i||"-"}),t.jsx(Be,{className:"text-muted-foreground size-4"})]})]}),t.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-muted-foreground",children:n("amount")}),t.jsxs("span",{className:"font-semibold",children:[u||"0.00"," ",i]})]})]}),t.jsx(q,{type:"button",size:"lg",className:"w-full",disabled:!C,onClick:L,children:j?t.jsxs(t.Fragment,{children:[t.jsx(_e,{size:"sm"}),t.jsx("span",{className:"ml-2",children:n("confirm")})]}):n("confirm")}),t.jsx(Ot,{open:p,onOpenChange:x,children:t.jsxs(Ft,{side:"bottom",className:"h-[50vh]",children:[t.jsx(Wt,{children:t.jsx($t,{children:n("selectChain")})}),t.jsx("div",{className:"mt-4 space-y-2",children:Sj.map(_=>t.jsxs("button",{onClick:()=>I(_),className:z("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",a===_?"bg-primary/10 text-primary":"hover:bg-muted"),children:[t.jsx("div",{className:"bg-primary/20 text-primary flex size-8 items-center justify-center rounded-full text-sm font-bold",children:_.charAt(0)}),t.jsx("span",{className:"font-medium",children:In[_]}),a===_&&t.jsx("span",{className:"text-primary ml-auto",children:""})]},_))})]})}),t.jsx(Ot,{open:h,onOpenChange:y,children:t.jsxs(Ft,{side:"bottom",className:"h-[60vh]",children:[t.jsx(Wt,{children:t.jsx($t,{children:n("selectToken")})}),t.jsx("div",{className:"mt-4 space-y-2",children:S.length===0?t.jsx("p",{className:"text-muted-foreground py-8 text-center",children:n("noResults")}):S.map(_=>t.jsxs("button",{onClick:()=>P(_),className:z("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",i===_.asset?"bg-primary/10 text-primary":"hover:bg-muted"),children:[t.jsx(ht,{symbol:_.asset,size:"md"}),t.jsxs("div",{className:"flex-1 text-left",children:[t.jsx("div",{className:"font-medium",children:_.asset}),t.jsxs("div",{className:"text-muted-foreground text-xs",children:[" ",_.targetChains.join(", ")]})]}),t.jsx("div",{className:"text-muted-foreground text-right text-sm",children:Mo[a]?.[_.asset]??"0.00"}),i===_.asset&&t.jsx("span",{className:"text-primary",children:""})]},_.asset))})]})}),t.jsx(Ot,{open:f,onOpenChange:g,children:t.jsxs(Ft,{side:"bottom",className:"h-[50vh]",children:[t.jsx(Wt,{children:t.jsx($t,{children:n("selectChain")})}),t.jsx("div",{className:"mt-4 space-y-2",children:A.map(_=>t.jsxs("button",{onClick:()=>D(_),className:z("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",o===_?"bg-primary/10 text-primary":"hover:bg-muted"),children:[t.jsx("div",{className:"bg-muted flex size-8 items-center justify-center rounded-full text-sm font-bold",children:_.charAt(0)}),t.jsx("span",{className:"font-medium",children:In[_]}),o===_&&t.jsx("span",{className:"text-primary ml-auto",children:""})]},_))})]})})]})}Hu.__docgenInfo={description:"Burn form component",methods:[],displayName:"BurnForm",props:{onSuccess:{required:!1,tsType:{name:"signature",type:"function",raw:"(txId: string) => void",signature:{arguments:[{type:{name:"string"},name:"txId"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Ro={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron",BFMeta:"BFMeta",BFChain:"BFChain",CCChain:"CCChain",PMChain:"PMChain"};function kj({status:e}){switch(e){case"pending":return t.jsx(lp,{className:"size-4 text-yellow-500"});case"confirming":return t.jsx(Ve,{className:"size-4 animate-spin text-blue-500"});case"confirmed":return t.jsx(As,{className:"size-4 text-green-500"});case"failed":return t.jsx(gp,{className:"text-destructive size-4"})}}function Aj(e){const n=Date.now()-e;return n<6e4?"Just now":n<36e5?`${Math.floor(n/6e4)}m ago`:n<864e5?`${Math.floor(n/36e5)}h ago`:new Date(e).toLocaleDateString()}function Ij(e){const s=e.toNumber();return s>=1e6?`${(s/1e6).toFixed(2)}M`:s>=1e3?`${(s/1e3).toFixed(2)}K`:s.toFixed(4)}function Tj({record:e,onClick:s}){const{t:n}=F("staking"),a=e.type==="mint",r=a?Cp:yl;return t.jsxs("button",{type:"button",onClick:s,className:"bg-card hover:bg-muted/50 flex w-full items-center gap-3 rounded-lg p-3 text-left transition-colors",children:[t.jsx("div",{className:z("flex size-10 items-center justify-center rounded-full",a?"bg-green-500/10":"bg-orange-500/10"),children:t.jsx(r,{className:z("size-5",a?"text-green-500":"text-orange-500")})}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-medium",children:n(a?"mint":"burn")}),t.jsx(kj,{status:e.status})]}),t.jsxs("div",{className:"text-muted-foreground flex items-center gap-1 text-xs",children:[t.jsx("span",{children:Ro[e.sourceChain]}),t.jsx("span",{children:""}),t.jsx("span",{children:Ro[e.targetChain]})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"flex items-center justify-end gap-1",children:[t.jsx(ht,{symbol:e.sourceAsset,size:"sm"}),t.jsx("span",{className:"font-medium",children:Ij(e.sourceAmount)})]}),t.jsx("div",{className:"text-muted-foreground text-xs",children:Aj(e.createdAt)})]})]})}function qu({filterType:e="all",onRecordClick:s,className:n}){const{t:a}=F("staking"),[r,i]=c.useState([]),[l,o]=c.useState(!0),[d,u]=c.useState(e==="all"?"all":e);c.useEffect(()=>{let h=!0;return o(!0),Ut.getTransactions().then(y=>{h&&(i(y),o(!1))}),()=>{h=!1}},[]);const m=c.useMemo(()=>d==="all"?r:r.filter(h=>h.type===d),[r,d]),p=[{id:"all",label:a("history")},{id:"mint",label:a("mint")},{id:"burn",label:a("burn")}],x=c.useCallback(()=>{o(!0),Ut.getTransactions().then(h=>{i(h),o(!1)})},[]);return l?t.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[t.jsx(_e,{size:"lg"}),t.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:a("loading")})]}):t.jsxs("div",{className:z("space-y-4",n),children:[t.jsxs("div",{className:"flex items-center gap-2",children:[p.map(h=>t.jsx(q,{type:"button",variant:d===h.id?"default":"outline",size:"sm",onClick:()=>u(h.id),children:h.label},h.id)),t.jsx(q,{type:"button",variant:"ghost",size:"sm",className:"ml-auto",onClick:x,children:a("refresh")})]}),m.length===0?t.jsx("div",{className:"flex flex-col items-center justify-center py-12",children:t.jsx("p",{className:"text-muted-foreground",children:a("noTransactions")})}):t.jsx("div",{className:"space-y-2",children:m.map(h=>t.jsx(Tj,{record:h,onClick:()=>s?.(h)},h.id))})]})}qu.__docgenInfo={description:"Staking record list component",methods:[],displayName:"StakingRecordList",props:{filterType:{required:!1,tsType:{name:"union",raw:"StakingTxType | 'all'",elements:[{name:"StakingTxType"},{name:"literal",value:"'all'"}]},description:"Filter by transaction type",defaultValue:{value:"'all'",computed:!1}},onRecordClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(record: StakingTransaction) => void",signature:{arguments:[{type:{name:"StakingTransaction"},name:"record"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};function Vu(){const{t:e}=F("staking"),{goBack:s}=fe(),[n,a]=c.useState("overview"),r=[{id:"overview",label:e("overview")},{id:"mint",label:e("mint")},{id:"burn",label:e("burn")},{id:"history",label:e("history")}],i=l=>{a("mint")};return t.jsxs("div",{className:"flex min-h-screen flex-col bg-background",children:[t.jsx(Q,{title:e("title"),onBack:s}),t.jsx("div",{className:"flex border-b border-border px-4",children:r.map(l=>t.jsx("button",{onClick:()=>a(l.id),className:z("flex-1 py-3 text-sm font-medium transition-colors",n===l.id?"border-b-2 border-primary text-primary":"text-muted-foreground hover:text-foreground"),children:l.label},l.id))}),t.jsxs("div",{className:"flex-1 p-4",children:[n==="overview"&&t.jsx(Wu,{onMint:i}),n==="mint"&&t.jsx(Pj,{}),n==="burn"&&t.jsx(Ej,{}),n==="history"&&t.jsx(qu,{})]})]})}function Pj(){const{t:e}=F("staking"),s=n=>{console.log("Mint transaction submitted:",n)};return t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:e("mintDescription")}),t.jsx($u,{onSuccess:s})]})}function Ej(){const{t:e}=F("staking"),s=n=>{console.log("Burn transaction submitted:",n)};return t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:e("burnDescription")}),t.jsx(Hu,{onSuccess:s})]})}Vu.__docgenInfo={description:"Staking page with tab navigation",methods:[],displayName:"StakingPage"};const Uu=()=>t.jsx(ce,{children:t.jsx(Vu,{})});Uu.__docgenInfo={description:"",methods:[],displayName:"StakingActivity"};const _j=Cs({assetType:H(),decimals:Jt(),amount:H().optional(),useDefaultDecimals:ft().optional(),logoUrl:H().optional(),contractAddress:H().optional()}),Mj=Cs({address:H(),symbol:H(),addressKey:H(),mainWalletId:H(),chain:H(),mnemonic:H().optional(),privateKey:H(),publicKey:H().optional(),isCustomAssets:ft().optional(),isFreezed:ft().optional(),assets:mt(_j),name:H(),prohibitChangeName:ft().optional(),index:Jt().optional(),purpose:yr([ut(44),ut(49),ut(84),ut(86)]).optional()}),Rj=Cs({chainName:H(),addressKey:H(),address:H(),symbol:H(),mainWalletId:H(),index:Jt().optional(),purpose:yr([ut(44),ut(49),ut(84),ut(86)]).optional()});Cs({name:H(),skipBackup:ft().optional(),importPhrase:H(),importType:H(),addressKeyList:mt(Rj),mainWalletId:H(),headSculpture:H(),createTimestamp:Jt(),lastBitcoinAddressKey:H().optional()});Cs({addressBookId:H(),name:H(),address:H(),chainList:mt(H()).optional(),remarks:H().optional(),iconName:H().optional(),symbol:H().optional()});Cs({password:H(),passwordTips:H().optional(),lastWalletActivate:Mj.optional(),walletLock:ft().optional(),fingerprintLock:ft().optional(),fingerprintPay:ft().optional()});const Dj=c.createContext(null);function zj(){return c.useContext(Dj)}const Lj="keyapp_welcome_shown";function Tn(){localStorage.setItem(Lj,"1")}function Ju(){const{t:e}=F("guide"),{navigate:s}=fe(),[n,a]=c.useState(0),r=zj(),i=c.useMemo(()=>[{icon:t.jsx(Cl,{className:"text-primary size-16"}),title:e("welcome.slides.transfer.title"),description:e("welcome.slides.transfer.description")},{icon:t.jsx(Sl,{className:"text-primary size-16"}),title:e("welcome.slides.multichain.title"),description:e("welcome.slides.multichain.description")},{icon:t.jsx(vp,{className:"text-primary size-16"}),title:e("welcome.slides.security.title"),description:e("welcome.slides.security.description")}],[e]),l=i[n];if(!l)return null;const o=c.useCallback(()=>{Tn(),s({to:"/wallet/create"})},[s]),d=c.useCallback(()=>{Tn(),s({to:"/onboarding/recover"})},[s]),u=c.useCallback(()=>{Tn(),s({to:"/onboarding/migrate"})},[s]),m=c.useCallback(()=>{Tn(),s({to:"/"})},[s]),p=c.useCallback(()=>{n<i.length-1&&a(y=>y+1)},[n,i.length]),x=n===i.length-1,h=r?.shouldPromptMigration;return t.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[t.jsx("div",{className:"flex justify-end p-4",children:t.jsx(q,{variant:"ghost",size:"sm","data-testid":"skip-button",onClick:m,children:e("welcome.skip")})}),t.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center px-8",children:[t.jsx("div",{className:"bg-primary/10 mb-8 flex size-32 items-center justify-center rounded-full",children:l.icon}),t.jsx("h1",{className:"mb-4 text-center text-2xl font-bold",children:l.title}),t.jsx("p",{className:"text-muted-foreground mb-8 max-w-sm text-center",children:l.description}),t.jsx("div",{className:"mb-8 flex gap-2",children:i.map((y,f)=>t.jsx("button",{"data-testid":`slide-dot-${f}`,onClick:()=>a(f),className:z("size-2 rounded-full transition-colors",f===n?"bg-primary":"bg-muted-foreground/30"),"aria-label":e("welcome.goToSlide",{number:f+1})},f))})]}),t.jsx("div",{className:"p-6",children:x?t.jsxs("div",{className:"flex flex-col gap-3",children:[h&&t.jsxs(q,{"data-testid":"migrate-button",onClick:u,className:"w-full",size:"lg",variant:"default",children:[t.jsx(wr,{className:"mr-2 size-4"}),e("welcome.migrateFromMpay",{defaultValue:" mpay "})]}),t.jsx(q,{"data-testid":"get-started-button",onClick:o,className:"w-full",size:"lg",variant:h?"outline":"default",children:e("welcome.getStarted")}),t.jsx(q,{"data-testid":"have-wallet-button",onClick:d,variant:"outline",className:"w-full",size:"lg",children:e("welcome.haveWallet")})]}):t.jsxs(q,{"data-testid":"next-button",onClick:p,className:"w-full",size:"lg",children:[e("welcome.next"),t.jsx(Be,{className:"ml-2 size-4"})]})})]})}Ju.__docgenInfo={description:"",methods:[],displayName:"WelcomeScreen"};const Ku=()=>t.jsx(ce,{children:t.jsx(Ju,{})});Ku.__docgenInfo={description:"",methods:[],displayName:"WelcomeActivity"};function Gu(){const{t:e}=F(["wallet","onboarding","security","common"]),{goBack:s}=fe(),n=Le(),a=en(),r=At(),[i,l]=c.useState("select"),[o,d]=c.useState([]),[u,m]=c.useState([]),[p,x]=c.useState(!1),h=c.useRef(!1);c.useEffect(()=>{!h.current&&n&&(d(n.chainAddresses.map(b=>b.chain)),h.current=!0)},[n]);const y=c.useCallback(()=>{if(!n)return!1;const b=new Set(n.chainAddresses.map(v=>v.chain));return b.size!==o.length?!0:o.some(v=>!b.has(v))},[n,o]),f=c.useCallback(()=>{if(!y()){s();return}l("verify")},[y,s]),g=c.useCallback(async b=>{if(!(!n||b.length<4)){x(!1),l("saving");try{const v=Kt(b);await ye.updateWalletChainAddresses(n.id,o,v,a),!o.includes(r)&&o.length>0&&ye.setSelectedChain(o[0]),l("success"),setTimeout(()=>{s()},1500)}catch(v){console.error("Failed to update chain addresses:",v),v instanceof Error&&v.message.includes("decrypt")?(x(!0),m([]),l("verify"),setTimeout(()=>{x(!1)},1500)):l("select")}}},[n,o,a,s]);return n?i==="saving"?t.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("wallet:chains.title")}),t.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[t.jsx(_e,{size:"lg"}),t.jsx("p",{className:"text-muted-foreground",children:e("wallet:chains.saving")})]})]}):i==="success"?t.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("wallet:chains.title")}),t.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[t.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-green-500/10",children:t.jsx(je,{className:"size-8 text-green-500"})}),t.jsx("p",{className:"font-medium",children:e("wallet:chains.success")})]})]}):i==="verify"?t.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("wallet:chains.verifyTitle"),onBack:()=>{l("select"),m([])}}),t.jsxs("div",{className:"flex-1 p-4",children:[t.jsxs("div",{className:"mb-6 text-center",children:[t.jsx("h2",{className:"text-xl font-bold",children:e("wallet:chains.verifyTitle")}),t.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:e("wallet:chains.verifyDesc")})]}),t.jsx(ks,{value:u,onChange:m,onComplete:g,minPoints:4,error:p,"data-testid":"wallet-chains-pattern"})]})]}):t.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("wallet:chains.title"),onBack:s}),t.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[t.jsxs("div",{className:"text-center",children:[t.jsx(on,{icon:As,variant:"success",size:"lg",className:"mx-auto mb-4"}),t.jsx("h2",{className:"text-xl font-bold",children:e("onboarding:chainSelector.title")}),t.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:e("onboarding:chainSelector.subtitle")})]}),a.length===0?t.jsx("div",{className:"flex justify-center py-10",children:t.jsx(_e,{})}):t.jsx(Ar,{"data-testid":"wallet-chains-selector",chains:a,selectedChains:o,onSelectionChange:d}),t.jsx(et,{variant:"mint",className:"w-full","data-testid":"wallet-chains-save",disabled:o.length===0,onClick:f,children:y()?e("common:save"):e("common:done")})]})]}):t.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("wallet:chains.title"),onBack:s}),t.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:t.jsx(bs,{variant:"warning",children:e("wallet:chains.noWallet")})})]})}Gu.__docgenInfo={description:"",methods:[],displayName:"WalletChainsPage"};const Qu=()=>t.jsx(ce,{children:t.jsx(Gu,{})});Qu.__docgenInfo={description:"",methods:[],displayName:"SettingsWalletChainsActivity"};function Ha(e){if(e===0)return"0 B";const s=1024,n=["B","KB","MB","GB"],a=Math.floor(Math.log(e)/Math.log(s));return`${parseFloat((e/Math.pow(s,a)).toFixed(2))} ${n[a]}`}function Yu(){const{t:e}=F(["settings","common"]),{goBack:s}=fe(),{push:n}=se(),[a,r]=c.useState(null),[i,l]=c.useState(!0),o=c.useCallback(async()=>{l(!0);try{if(navigator.storage&&navigator.storage.estimate){const u=await navigator.storage.estimate();r({usage:u.usage??0,quota:u.quota??0})}}catch(u){console.error("Failed to get storage estimate:",u)}finally{l(!1)}},[]);c.useEffect(()=>{o()},[o]);const d=a?a.usage/a.quota*100:0;return t.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("settings:storage.title"),onBack:s}),t.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[t.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx("div",{className:"bg-primary/10 flex size-10 items-center justify-center rounded-full",children:t.jsx(Nl,{className:"text-primary size-5"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium",children:e("settings:storage.usage")}),t.jsx("p",{className:"text-muted-foreground text-sm",children:e("settings:storage.basedOn")})]})]}),i?t.jsx("div",{className:"flex justify-center py-8",children:t.jsx(Ve,{className:"text-muted-foreground size-6 animate-spin"})}):a?t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"bg-muted h-3 w-full overflow-hidden rounded-full",children:t.jsx("div",{className:"bg-primary h-full rounded-full transition-all",style:{width:`${Math.min(d,100)}%`}})}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsxs("span",{className:"text-muted-foreground",children:[e("settings:storage.used"),": ",Ha(a.usage)]}),t.jsxs("span",{className:"text-muted-foreground",children:[e("settings:storage.total"),": ",Ha(a.quota)]})]})]}),t.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 space-y-1",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{children:e("settings:storage.usagePercent")}),t.jsxs("span",{className:"font-medium",children:[d.toFixed(2),"%"]})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{children:e("settings:storage.available")}),t.jsx("span",{className:"font-medium",children:Ha(a.quota-a.usage)})]})]})]}):t.jsx("p",{className:"text-muted-foreground text-center py-4",children:e("settings:storage.unavailable")})]}),t.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[t.jsx("h3",{className:"font-medium mb-2",children:e("settings:storage.clearTitle")}),t.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:e("settings:storage.clearDesc")}),t.jsxs(q,{variant:"destructive",className:"w-full",onClick:()=>n("ClearDataConfirmJob",{}),children:[t.jsx(Qt,{className:"size-4 mr-2"}),e("settings:items.clearData")]})]})]})]})}Yu.__docgenInfo={description:"",methods:[],displayName:"SettingsStoragePage"};const Xu=()=>t.jsx(ce,{children:t.jsx(Yu,{})});Xu.__docgenInfo={description:"",methods:[],displayName:"SettingsStorageActivity"};const Zu=()=>{const{t:e}=F("common"),{pop:s}=se(),n=Ne(Js),[a,r]=c.useState(!1),[i,l]=c.useState(""),[o,d]=c.useState(""),[u,m]=c.useState(!1),[p,x]=c.useState(null),h=async()=>{if(!i.trim()){x(" URL");return}try{new URL(i)}catch{x(" URL ");return}if(n.sources.some(b=>b.url===i)){x("");return}fs.addSource(i,o||""),l(""),d(""),r(!1),x(null)},y=b=>{fs.removeSource(b)},f=b=>{fs.toggleSource(b)},g=async()=>{m(!0);try{await ti()}catch(b){console.error("Refresh failed:",b)}m(!1)};return t.jsx(ce,{children:t.jsxs("div",{className:"flex flex-col min-h-full bg-background",children:[t.jsx("div",{className:"sticky top-0 z-10 bg-background border-b",children:t.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[t.jsx("button",{onClick:()=>s(),className:"p-1.5 rounded-full hover:bg-muted transition-colors","aria-label":e("back",""),children:t.jsx(cl,{className:"size-5",stroke:1.5})}),t.jsx("h1",{className:"flex-1 text-lg font-semibold",children:""}),t.jsx("button",{onClick:g,disabled:u,className:"p-1.5 rounded-full hover:bg-muted transition-colors","aria-label":e("refresh",""),children:t.jsx(an,{className:z("size-5",u&&"animate-spin"),stroke:1.5})})]})}),t.jsxs("div",{className:"flex-1 p-4 space-y-3",children:[n.sources.map(b=>t.jsx(Bj,{source:b,onToggle:()=>f(b.url),onRemove:()=>y(b.url)},b.url)),n.sources.length===0&&t.jsx("div",{className:"text-center py-12 text-muted-foreground",children:""})]}),a?t.jsxs("div",{className:"border-t p-4 bg-background space-y-3",children:[t.jsx("input",{type:"url",value:i,onChange:b=>{l(b.target.value),x(null)},placeholder:" URL (https://...)",className:"w-full px-3 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary",autoFocus:!0}),t.jsx("input",{type:"text",value:o,onChange:b=>d(b.target.value),placeholder:" ()",className:"w-full px-3 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary"}),p&&t.jsx("p",{className:"text-sm text-destructive",children:p}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>{r(!1),l(""),d(""),x(null)},className:"flex-1 py-2 rounded-lg bg-muted hover:bg-muted/80 font-medium",children:""}),t.jsx("button",{onClick:h,className:"flex-1 py-2 rounded-lg bg-primary text-primary-foreground hover:bg-primary/90 font-medium",children:""})]})]}):t.jsx("div",{className:"border-t p-4",children:t.jsxs("button",{onClick:()=>r(!0),className:"w-full py-3 rounded-xl border-2 border-dashed border-muted-foreground/30 hover:border-primary hover:bg-primary/5 transition-colors flex items-center justify-center gap-2 text-muted-foreground hover:text-primary",children:[t.jsx(kt,{className:"size-5",stroke:1.5}),t.jsx("span",{children:""})]})}),t.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};function Bj({source:e,onToggle:s,onRemove:n}){const a=e.url==="/ecosystem.json";return t.jsx("div",{className:z("rounded-xl border p-4 transition-colors",e.enabled?"bg-card":"bg-muted/30 opacity-60"),children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"rounded-full bg-primary/10 p-2 shrink-0",children:t.jsx(kl,{className:"size-5 text-primary"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("h3",{className:"font-medium truncate",children:e.name}),a&&t.jsx("span",{className:"text-xs bg-primary/10 text-primary px-1.5 py-0.5 rounded",children:""})]}),t.jsx("p",{className:"text-sm text-muted-foreground truncate mt-0.5",children:e.url}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[" ",new Date(e.lastUpdated).toLocaleDateString()]})]}),t.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[t.jsx("button",{onClick:s,className:z("p-2 rounded-full transition-colors",e.enabled?"bg-green-100 text-green-600 hover:bg-green-200":"bg-muted text-muted-foreground hover:bg-muted/80"),"aria-label":e.enabled?"":"",children:e.enabled?t.jsx(je,{className:"size-4",stroke:2}):t.jsx(ma,{className:"size-4",stroke:2})}),!a&&t.jsx("button",{onClick:n,className:"p-2 rounded-full text-muted-foreground hover:text-destructive hover:bg-destructive/10 transition-colors","aria-label":"",children:t.jsx(Qt,{className:"size-4",stroke:1.5})})]})]})})}Zu.__docgenInfo={description:"",methods:[],displayName:"SettingsSourcesActivity"};const Do={defi:"DeFi",nft:"NFT",tools:"",games:"",social:"",exchange:"",other:""};function Oj({permission:e,isLast:s}){const n=Gm[e],a=n?.risk??"medium",r=a==="high"?qe:al,i=a==="high"?"text-red-500":a==="medium"?"text-amber-500":"text-green-500";return t.jsxs("div",{className:z("flex items-start gap-3 py-3",!s&&"border-b border-border/50"),children:[t.jsx(r,{className:z("size-5 mt-0.5 shrink-0",i),stroke:1.5}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"font-medium text-sm",children:n?.name??e}),t.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:n?.description??""})]})]})}function is({label:e,value:s,isLink:n=!1,href:a}){const r=t.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-border/50 last:border-0",children:[t.jsx("span",{className:"text-muted-foreground text-sm",children:e}),t.jsxs("span",{className:z("text-sm font-medium",n&&"text-primary flex items-center gap-1"),children:[s,n&&t.jsx(Be,{className:"size-4"})]})]});return n&&a?t.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",children:r}):r}const em=({params:e})=>{const{t:s}=F("common"),{pop:n}=se(),[a,r]=c.useState(null),[i,l]=c.useState(!0),[o,d]=c.useState(!1),[u,m]=c.useState(!1);c.useEffect(()=>{let g=!1;return(async()=>{l(!0),await Qc();let v=yo(e.appId);v||(await ti({force:!1}),v=yo(e.appId)),!g&&(r(v??null),m(Xv(e.appId)),l(!1))})(),()=>{g=!0}},[e.appId]);const p=c.useCallback(()=>{a&&(Xc(a.id),m(!0))},[a]),x=c.useCallback(()=>{a&&(Zc(a.id),fs.setActiveSubPage("mine"),Qo(a.id,{...a,targetDesktop:"mine"}),n())},[a,n]);if(i)return t.jsx(ce,{children:t.jsx("div",{className:"flex min-h-screen items-center justify-center bg-background",children:t.jsx(_e,{size:"lg"})})});if(!a)return t.jsx(ce,{children:t.jsxs("div",{className:"flex min-h-screen flex-col items-center justify-center bg-background gap-4",children:[t.jsx("p",{className:"text-muted-foreground",children:""}),t.jsx("button",{onClick:()=>n(),className:"px-4 py-2 bg-primary text-primary-foreground rounded-full text-sm font-medium",children:""})]})});const h=a.longDescription??a.description,y=h.length>150,f=o||!y?h:h.slice(0,150)+"...";return t.jsx(ce,{children:t.jsxs("div",{className:"flex min-h-screen flex-col bg-background detail-scroll-container",children:[t.jsx("div",{className:"sticky top-0 z-20 bg-background/80 backdrop-blur-xl border-b border-border/50",children:t.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[t.jsx("button",{onClick:()=>n(),className:"p-1.5 -ml-1.5 rounded-full hover:bg-muted transition-colors",children:t.jsx(cl,{className:"size-5",stroke:1.5})}),t.jsx("span",{className:"font-semibold truncate max-w-[200px] detail-header-title",children:a.name}),t.jsx("button",{className:"p-1.5 -mr-1.5 rounded-full hover:bg-muted transition-colors",children:t.jsx(Fn,{className:"size-5",stroke:1.5})})]})}),t.jsxs("div",{className:"flex-1 overflow-y-auto detail-scroller",children:[t.jsxs("div",{className:"px-5 pt-4 pb-5",children:[t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx(Xm,{src:a.icon,name:a.name,size:"2xl",shadow:"lg",className:"shrink-0"}),t.jsxs("div",{className:"flex-1 min-w-0 pt-1",children:[t.jsx("h1",{className:"text-xl font-bold truncate",children:a.name}),t.jsx("p",{className:"text-sm text-muted-foreground mt-0.5 truncate",children:a.author??""}),u?t.jsx("button",{onClick:x,className:"mt-4 px-8 py-2 bg-primary text-primary-foreground rounded-full text-sm font-semibold",children:""}):t.jsx("button",{onClick:p,className:"mt-4 px-8 py-2 bg-primary text-primary-foreground rounded-full text-sm font-semibold",children:""})]})]}),t.jsxs("div",{className:"flex items-center gap-4 mt-5 text-xs text-muted-foreground",children:[a.category&&t.jsx("span",{className:"font-medium text-foreground",children:Do[a.category]??a.category}),a.beta&&t.jsx("span",{className:"px-2 py-0.5 bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400 rounded-full font-medium",children:"Beta"}),t.jsxs("span",{children:["v",a.version]})]})]}),a.screenshots&&a.screenshots.length>0&&t.jsx("div",{className:"border-t border-border/50",children:t.jsxs("div",{className:"px-5 py-4",children:[t.jsx("h2",{className:"text-lg font-bold mb-4",children:""}),t.jsx("div",{className:"flex gap-3 overflow-x-auto pb-2 -mx-5 px-5 snap-x snap-mandatory",style:{scrollbarWidth:"none"},children:a.screenshots.map((g,b)=>t.jsx("div",{className:"w-[220px] aspect-[9/19.5] rounded-2xl bg-muted overflow-hidden shrink-0 snap-center shadow-lg ring-1 ring-black/5",children:t.jsx("img",{src:g,alt:`${a.name} screenshot ${b+1}`,className:"w-full h-full object-cover",loading:"lazy",onError:v=>{v.currentTarget.parentElement.style.display="none"}})},b))})]})}),t.jsxs("div",{className:"border-t border-border/50 px-5 py-4",children:[t.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:f}),y&&t.jsxs("button",{onClick:()=>d(!o),className:"text-primary text-sm font-medium mt-2 flex items-center gap-1",children:[o?"":"",o?t.jsx(Pr,{className:"size-4"}):t.jsx(Sr,{className:"size-4"})]})]}),a.chains&&a.chains.length>0&&t.jsxs("div",{className:"border-t border-border/50 px-5 py-4",children:[t.jsx("h2",{className:"text-lg font-bold mb-3",children:""}),t.jsx("div",{className:"flex flex-wrap gap-2",children:a.chains.map(g=>t.jsx("span",{className:"px-3 py-1.5 bg-muted rounded-full text-sm font-medium",children:g},g))})]}),a.permissions&&a.permissions.length>0&&t.jsxs("div",{className:"border-t border-border/50 px-5 py-4",children:[t.jsx("h2",{className:"text-lg font-bold mb-1",children:""}),t.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:""}),t.jsx("div",{className:"bg-muted/50 rounded-2xl px-4",children:a.permissions.map((g,b)=>t.jsx(Oj,{permission:g,isLast:b===a.permissions.length-1},g))})]}),a.tags&&a.tags.length>0&&t.jsxs("div",{className:"border-t border-border/50 px-5 py-4",children:[t.jsx("h2",{className:"text-lg font-bold mb-3",children:""}),t.jsx("div",{className:"flex flex-wrap gap-2",children:a.tags.map(g=>t.jsxs("span",{className:"px-3 py-1.5 bg-primary/10 text-primary rounded-full text-sm font-medium",children:["#",g]},g))})]}),t.jsxs("div",{className:"border-t border-border/50 px-5 py-4",children:[t.jsx("h2",{className:"text-lg font-bold mb-2",children:""}),t.jsxs("div",{className:"bg-muted/50 rounded-2xl px-4",children:[a.author&&t.jsx(is,{label:"",value:a.author}),t.jsx(is,{label:"",value:a.version}),a.category&&t.jsx(is,{label:"",value:Do[a.category]??a.category}),a.publishedAt&&t.jsx(is,{label:"",value:a.publishedAt}),a.updatedAt&&t.jsx(is,{label:"",value:a.updatedAt}),a.website&&t.jsx(is,{label:"",value:"",isLink:!0,href:a.website})]})]}),t.jsx("div",{className:"h-8"})]})]})})};em.__docgenInfo={description:"",methods:[],displayName:"MiniappDetailActivity"};function Zs({className:e,...s}){return t.jsx("label",{"data-slot":"label",className:z("gap-2 text-sm leading-none font-medium group-data-[disabled=true]:opacity-50 peer-disabled:opacity-50 flex items-center select-none group-data-[disabled=true]:pointer-events-none peer-disabled:cursor-not-allowed",e),...s})}Zs.__docgenInfo={description:"",methods:[],displayName:"Label"};function oi({className:e,size:s="default",...n}){return t.jsx("div",{"data-slot":"card","data-size":s,className:z("ring-foreground/10 bg-card text-card-foreground gap-4 overflow-hidden rounded-xl py-4 text-sm ring-1 has-data-[slot=card-footer]:pb-0 has-[>img:first-child]:pt-0 data-[size=sm]:gap-3 data-[size=sm]:py-3 data-[size=sm]:has-data-[slot=card-footer]:pb-0 *:[img:first-child]:rounded-t-xl *:[img:last-child]:rounded-b-xl group/card flex flex-col",e),...n})}function li({className:e,...s}){return t.jsx("div",{"data-slot":"card-content",className:z("px-4 group-data-[size=sm]/card:px-3",e),...s})}oi.__docgenInfo={description:"",methods:[],displayName:"Card",props:{size:{required:!1,tsType:{name:"union",raw:'"default" | "sm"',elements:[{name:"literal",value:'"default"'},{name:"literal",value:'"sm"'}]},description:"",defaultValue:{value:'"default"',computed:!1}}}};li.__docgenInfo={description:"",methods:[],displayName:"CardContent"};function tm(){const{t:e}=F(["common","wallet"]),{goBack:s}=fe(),n=ra(),[a,r]=c.useState("ethereum"),[i,l]=c.useState(""),[o,d]=c.useState(""),[u,m]=c.useState(""),{data:p,isLoading:x,isFetching:h}=kv(u,o,!!u&&!!o),y=c.useCallback(()=>{i.trim()&&(d(i.trim()),m(a))},[i,a]),f=c.useCallback(v=>{v.key==="Enter"&&y()},[y]),g=n.filter(v=>v.chainKind==="evm"),b=n.filter(v=>v.chainKind!=="evm");return t.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("common:addressLookup.balanceTitle"),onBack:s}),t.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Zs,{children:e("common:addressLookup.chain")}),t.jsxs(sa,{value:a,onValueChange:r,children:[t.jsx(Ys,{children:t.jsx(Qs,{})}),t.jsxs(Xs,{children:[g.length>0&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:"EVM"}),g.map(v=>t.jsx(Gt,{value:v.id,children:v.name},v.id))]}),b.length>0&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:e("common:addressLookup.otherChains")}),b.map(v=>t.jsx(Gt,{value:v.id,children:v.name},v.id))]})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Zs,{children:e("common:addressLookup.address")}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(He,{placeholder:e("common:addressLookup.addressPlaceholder"),value:i,onChange:v=>l(v.target.value),onKeyDown:f,className:"flex-1 font-mono text-sm"}),t.jsx(q,{onClick:y,disabled:!i.trim()||h,children:h?t.jsx(_e,{size:"sm"}):t.jsx(rn,{className:"size-4"})})]})]}),o&&t.jsx(oi,{className:z("transition-all",x&&"opacity-50"),children:t.jsx(li,{className:"pt-6",children:p?.error?t.jsxs("div",{className:"flex items-center gap-3 text-destructive",children:[t.jsx(Yt,{className:"size-5 shrink-0"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:e("common:addressLookup.error")}),t.jsx("div",{className:"text-sm opacity-80",children:p.error})]})]}):p?.balance?t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"bg-primary/10 flex size-12 items-center justify-center rounded-full",children:t.jsx(Op,{className:"text-primary size-6"})}),t.jsxs("div",{children:[t.jsxs("div",{className:"text-2xl font-bold",children:[p.balance.amount.toFormatted()," ",p.balance.symbol]}),t.jsx("div",{className:"text-muted-foreground text-sm",children:e("common:addressLookup.onChain",{chain:n.find(v=>v.id===u)?.name??u})})]})]}):x?t.jsx("div",{className:"flex items-center justify-center py-4",children:t.jsx(_e,{size:"lg"})}):null})}),!1]})]})}tm.__docgenInfo={description:"",methods:[],displayName:"AddressBalancePage"};const sm=()=>t.jsx(ce,{children:t.jsx(tm,{})});sm.__docgenInfo={description:"",methods:[],displayName:"AddressBalanceActivity"};function Fj(e,s){return(parseFloat(e)/Math.pow(10,s)).toLocaleString(void 0,{maximumFractionDigits:6})}function Wj(e){return new Date(e).toLocaleString()}function $j({tx:e,address:s}){const n=e.direction==="out"||e.from.toLowerCase()===s.toLowerCase(),a=e.assets.find(o=>o.assetType==="native"||o.assetType==="token"),r=a?a.value:"0",i=a?a.symbol:"",l=a?a.decimals:0;return t.jsxs("div",{className:"flex items-center gap-3 py-3 border-b last:border-b-0",children:[t.jsx("div",{className:`p-2 rounded-full ${n?"bg-red-100 text-red-600":"bg-green-100 text-green-600"}`,children:n?t.jsx(yl,{className:"size-4"}):t.jsx(wp,{className:"size-4"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"text-sm font-medium truncate",children:n?`To: ${e.to}`:`From: ${e.from}`}),t.jsx("div",{className:"text-xs text-muted-foreground",children:Wj(e.timestamp)})]}),t.jsxs("div",{className:`text-sm font-medium ${n?"text-red-600":"text-green-600"}`,children:[n?"-":"+",Fj(r,l)," ",i]})]})}function nm(){const{t:e}=F(["common","wallet"]),{goBack:s}=fe(),n=ra(),[a,r]=c.useState("bfmeta"),[i,l]=c.useState(""),[o,d]=c.useState(""),u=c.useMemo(()=>n.find(N=>N.id===a),[n,a]),m=c.useMemo(()=>{if(!u)return!1;try{return Ss(a).supportsTransactionHistory}catch{return!1}},[a,u]),{data:p,isLoading:x,isError:h,refetch:y}=Iv({chainId:a,address:o,enabled:!!o}),f=c.useMemo(()=>{if(!u?.explorer||!o.trim())return null;const{queryAddress:N,url:M}=u.explorer;return N?N.replace(":address",o.trim()):`${M}/address/${o.trim()}`},[u,o]),g=c.useCallback(()=>{i.trim()&&d(i.trim())},[i]),b=c.useCallback(N=>{N.key==="Enter"&&g()},[g]),v=c.useCallback(()=>{f&&window.open(f,"_blank","noopener,noreferrer")},[f]),j=n.filter(N=>N.chainKind==="evm"),w=n.filter(N=>N.chainKind!=="evm");return t.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[t.jsx(Q,{title:e("common:addressLookup.transactionsTitle"),onBack:s}),t.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Zs,{children:e("common:addressLookup.chain")}),t.jsxs(sa,{value:a,onValueChange:r,children:[t.jsx(Ys,{children:t.jsx(Qs,{})}),t.jsxs(Xs,{children:[j.length>0&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:"EVM"}),j.map(N=>t.jsx(Gt,{value:N.id,children:N.name},N.id))]}),w.length>0&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:e("common:addressLookup.otherChains")}),w.map(N=>t.jsx(Gt,{value:N.id,children:N.name},N.id))]})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Zs,{children:e("common:addressLookup.address")}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(He,{placeholder:e("common:addressLookup.addressPlaceholder"),value:i,onChange:N=>l(N.target.value),onKeyDown:b,className:"flex-1 font-mono text-sm"}),t.jsx(q,{onClick:g,disabled:!i.trim()||x,children:x?t.jsx(Ve,{className:"size-4 animate-spin"}):t.jsx(rn,{className:"size-4"})})]})]}),o&&t.jsx(oi,{children:t.jsxs(li,{className:"pt-6",children:[x?t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx(Ve,{className:"size-6 animate-spin text-muted-foreground"})}):h?t.jsx("div",{className:"text-center py-8 text-destructive",children:e("common:addressLookup.queryError")}):p&&p.length>0?t.jsx("div",{className:"divide-y",children:p.map(N=>t.jsx($j,{tx:N,address:o},N.hash))}):t.jsx("div",{className:"text-center py-8 text-muted-foreground",children:m?t.jsx("p",{children:e("common:addressLookup.noTransactions")}):t.jsx("p",{children:e("common:addressLookup.useExplorerHint")})}),f&&t.jsx("div",{className:"mt-4 pt-4 border-t",children:t.jsxs(q,{variant:m?"outline":"default",size:"sm",className:"w-full gap-2",onClick:v,children:[t.jsx(Df,{className:"size-4"}),e("common:addressLookup.viewOnExplorer",{name:u?.name??a})]})})]})})]})]})}nm.__docgenInfo={description:"",methods:[],displayName:"AddressTransactionsPage"};const am=()=>t.jsx(ce,{children:t.jsx(nm,{})});am.__docgenInfo={description:"",methods:[],displayName:"AddressTransactionsActivity"};const{useFlow:se}=Mx({transitionDuration:350,plugins:[Rx(),ig({theme:"cupertino"}),jv({routes:{MainTabsActivity:"/",WalletListActivity:"/wallet/list",WalletConfigActivity:"/wallet/:walletId",WalletCreateActivity:"/wallet/create",SendActivity:"/send",ReceiveActivity:"/receive",SettingsActivity:"/settings",SettingsLanguageActivity:"/settings/language",SettingsCurrencyActivity:"/settings/currency",SettingsChainsActivity:"/settings/chains",SettingsMnemonicActivity:"/settings/mnemonic",SettingsWalletLockActivity:"/settings/wallet-lock",SettingsWalletChainsActivity:"/settings/wallet-chains",SettingsStorageActivity:"/settings/storage",HistoryActivity:"/history",TransactionDetailActivity:"/transaction/:txId",ScannerActivity:"/scanner",AuthorizeAddressActivity:"/authorize/address/:id",AuthorizeSignatureActivity:"/authorize/signature/:id",OnboardingRecoverActivity:"/onboarding/recover",TokenDetailActivity:"/token/:tokenId",AddressBookActivity:"/address-book",NotificationsActivity:"/notifications",StakingActivity:"/staking",WelcomeActivity:"/welcome",SettingsSourcesActivity:"/settings/sources",MiniappDetailActivity:"/miniapp/:appId/detail",AddressBalanceActivity:"/address-balance",AddressTransactionsActivity:"/address-transactions",ChainSelectorJob:"/job/chain-selector",WalletRenameJob:"/job/wallet-rename/:walletId",WalletDeleteJob:"/job/wallet-delete/:walletId",WalletLockConfirmJob:"/job/wallet-lock-confirm",TwoStepSecretConfirmJob:"/job/two-step-secret-confirm",SetTwoStepSecretJob:"/job/set-two-step-secret",MnemonicOptionsJob:"/job/mnemonic-options",ContactEditJob:"/job/contact-edit",ContactPickerJob:"/job/contact-picker",WalletAddJob:"/job/wallet-add",WalletListJob:"/job/wallet-list",SecurityWarningJob:"/job/security-warning",TransferConfirmJob:"/job/transfer-confirm",TransferWalletLockJob:"/job/transfer-wallet-lock",FeeEditJob:"/job/fee-edit",ScannerJob:"/job/scanner",ContactAddConfirmJob:"/job/contact-add-confirm",ContactShareJob:"/job/contact-share",ClearDataConfirmJob:"/job/clear-data-confirm",WalletPickerJob:"/job/wallet-picker",SigningConfirmJob:"/job/signing-confirm",PermissionRequestJob:"/job/permission-request",MiniappTransferConfirmJob:"/job/miniapp-transfer-confirm",MiniappSignTransactionJob:"/job/miniapp-sign-transaction",ChainSwitchConfirmJob:"/job/chain-switch-confirm"},fallbackActivity:()=>"MainTabsActivity",useHash:!0,urlPatternOptions:{segmentValueCharset:"a-zA-Z0-9-._~ %"}})],activities:{MainTabsActivity:Ed,WalletListActivity:Md,WalletConfigActivity:Rd,WalletCreateActivity:zd,SendActivity:Od,ReceiveActivity:Wd,SettingsActivity:$d,SettingsLanguageActivity:qd,SettingsCurrencyActivity:Ud,SettingsChainsActivity:au,SettingsMnemonicActivity:iu,SettingsWalletLockActivity:lu,SettingsWalletChainsActivity:Qu,SettingsStorageActivity:Xu,HistoryActivity:yu,TransactionDetailActivity:Nu,ScannerActivity:Su,AuthorizeAddressActivity:Au,AuthorizeSignatureActivity:Tu,OnboardingRecoverActivity:_u,TokenDetailActivity:Ru,AddressBookActivity:zu,NotificationsActivity:Ou,StakingActivity:Uu,WelcomeActivity:Ku,SettingsSourcesActivity:Zu,MiniappDetailActivity:em,AddressBalanceActivity:sm,AddressTransactionsActivity:am,ChainSelectorJob:nd,WalletRenameJob:rd,WalletDeleteJob:id,WalletLockConfirmJob:od,TwoStepSecretConfirmJob:ld,SetTwoStepSecretJob:ud,MnemonicOptionsJob:md,ContactEditJob:fd,ContactPickerJob:pd,WalletAddJob:hd,WalletListJob:xd,SecurityWarningJob:gd,TransferConfirmJob:vd,TransferWalletLockJob:bd,FeeEditJob:dd,ScannerJob:yd,ContactAddConfirmJob:jd,ContactShareJob:Nd,ClearDataConfirmJob:wd,WalletPickerJob:Sd,SigningConfirmJob:Cd,PermissionRequestJob:kd,MiniappTransferConfirmJob:Ad,MiniappSignTransactionJob:Id,ChainSwitchConfirmJob:Td}});function Hj(e,s){const n=Math.abs(e-s);return Math.min(n,360-n)}function qj(e,s,n=30){if(s.length===0)return 1;let a=180;for(const r of s){const i=Hj(e,r);i<a&&(a=i)}return a<n?a/n:1}function Vj(e){return um.map(s=>({...s,weight:qj(s.hue,e)}))}function ba({mode:e,walletId:s,onEditOnlyComplete:n,className:a}){const{t:r}=F(["wallet","onboarding","common"]),{push:i}=se(),l=Xt(),o=l.find(R=>R.id===s),d=At(),u=qo(),[m,p]=c.useState(e==="edit-only"?"edit":e),[x,h]=c.useState(""),[y,f]=c.useState(0),g=c.useRef(null),[b,v]=c.useState(!1),j=c.useMemo(()=>l.filter(R=>R.id!==s).map(R=>R.themeHue),[l,s]),w=c.useMemo(()=>Vj(j),[j]);c.useEffect(()=>{o&&(h(o.name),f(o.themeHue))},[o]);const N=c.useMemo(()=>o?.chainAddresses.find(R=>R.chain===d)??o?.chainAddresses[0],[o,d]),M=c.useCallback(R=>{if(!g.current)return;const B=g.current.getBoundingClientRect(),K=Math.max(0,Math.min(R-B.left,B.width))/B.width,ee=Math.round(K*3600)/10;f(ee)},[]),S=R=>{R.stopPropagation(),v(!0),M(R.clientX)},A=R=>{R.stopPropagation(),v(!0),R.touches[0]&&M(R.touches[0].clientX)};c.useEffect(()=>{if(!b)return;const R=K=>M(K.clientX),B=K=>{K.touches[0]&&M(K.touches[0].clientX)},$=()=>v(!1);return document.addEventListener("mousemove",R),document.addEventListener("mouseup",$),document.addEventListener("touchmove",B),document.addEventListener("touchend",$),()=>{document.removeEventListener("mousemove",R),document.removeEventListener("mouseup",$),document.removeEventListener("touchmove",B),document.removeEventListener("touchend",$)}},[b,M]);const I=c.useCallback(()=>{i("ChainSelectorJob",{})},[i]),P=c.useCallback(()=>{o&&(h(o.name),f(o.themeHue)),p("edit")},[o]),D=c.useCallback(async()=>{if(!o)return;const R=x.trim();R&&R!==o.name&&await ye.updateWalletName(o.id,R),y!==o.themeHue&&await ye.updateWalletThemeHue(o.id,y),p("default")},[o,x,y]),E=c.useCallback(()=>{o&&(h(o.name),f(o.themeHue)),p("default")},[o]),k=c.useCallback(async()=>{if(!o)return;const R=x.trim();R&&R!==o.name&&await ye.updateWalletName(o.id,R),y!==o.themeHue&&await ye.updateWalletThemeHue(o.id,y),n?.()},[o,x,y,n]),T=c.useCallback(async()=>{o&&(await ye.setCurrentWallet(o.id),i("SettingsMnemonicActivity",{}))},[o,i]),C=c.useCallback(()=>{o&&i("WalletDeleteJob",{walletId:o.id})},[o,i]);if(!o)return t.jsx("div",{className:z("text-muted-foreground p-4 text-center",a),children:r("wallet:detail.notFound")});const L=m==="edit"||e==="edit-only"?y:o.themeHue,_=m==="edit"||e==="edit-only";return t.jsxs("div",{className:z("space-y-6",a),children:[t.jsx("div",{className:"flex justify-center px-4",children:t.jsx("div",{className:"aspect-[1.6/1] w-full max-w-[360px]",children:t.jsx(Vo,{wallet:{...o,name:_?x:o.name,themeHue:L},themeHue:L,walletNameTestId:"wallet-config-preview-name",chain:N?.chain,chainName:N?.chain||"",address:N?.address||o.address,chainIconUrl:u[N?.chain??""],onOpenChainSelector:I})})}),_?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-muted-foreground text-sm",children:r("onboarding:theme.walletName")}),t.jsx(He,{value:x,onChange:R=>h(R.target.value),placeholder:r("wallet:defaultName"),maxLength:20,className:"text-center"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-muted-foreground",children:r("onboarding:theme.customColor")}),t.jsxs("span",{className:"text-muted-foreground font-mono",children:[y.toFixed(1),""]})]}),t.jsxs("div",{ref:g,className:"relative h-8 cursor-pointer touch-none rounded-full",style:{background:"linear-gradient(to right, oklch(0.6 0.25 0), oklch(0.6 0.25 60), oklch(0.6 0.25 120), oklch(0.6 0.25 180), oklch(0.6 0.25 240), oklch(0.6 0.25 300), oklch(0.6 0.25 360))"},onMouseDown:S,onTouchStart:A,children:[j.map((R,B)=>t.jsx("div",{className:"absolute top-0 h-full w-0.5 bg-black/30",style:{left:`${R/360*100}%`},title:r("onboarding:theme.usedColor")},B)),t.jsx("div",{className:"absolute top-1/2 -translate-x-1/2 -translate-y-1/2",style:{left:`${y/360*100}%`},children:t.jsx("div",{className:"size-6 rounded-full border-2 border-white shadow-md",style:{backgroundColor:`oklch(0.6 0.25 ${y})`}})})]})]}),t.jsx("div",{className:"flex flex-wrap justify-center gap-3",children:w.map(R=>{const B=Math.abs(y-R.hue)<.5,$=R.weight<.5;return t.jsx("button",{type:"button",onClick:()=>f(R.hue),className:z("relative size-10 rounded-full transition-all","ring-offset-background focus-visible:ring-ring focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:outline-none",B&&"ring-primary ring-2 ring-offset-2",$&&"opacity-50"),style:{backgroundColor:R.color},title:R.name,children:B&&t.jsx(je,{className:"absolute inset-0 m-auto size-5 text-white drop-shadow-md"})},R.hue)})})]}),e==="edit-only"?t.jsx(q,{className:"w-full",onClick:k,disabled:!x.trim(),"data-testid":"theme-complete-button",style:{"--primary-hue":y,"--primary":`oklch(var(--primary-lightness) var(--primary-saturation) ${y})`},children:r("common:confirm")}):t.jsxs("div",{className:"flex gap-2",children:[t.jsx(q,{variant:"outline",className:"flex-1",onClick:E,children:r("common:cancel")}),t.jsx(q,{className:"flex-1",onClick:D,disabled:!x.trim(),style:{"--primary-hue":y,"--primary":`oklch(var(--primary-lightness) var(--primary-saturation) ${y})`},children:r("common:save")})]})]}):t.jsxs("div",{className:"flex justify-center gap-8",children:[t.jsxs("button",{onClick:P,className:"group flex flex-col items-center gap-1.5",children:[t.jsx("div",{className:"bg-primary/10 text-primary group-hover:bg-primary/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:t.jsx(sh,{className:"size-5"})}),t.jsx("span",{className:"text-xs font-medium",children:r("wallet:detail.editName")})]}),t.jsxs("button",{onClick:T,className:"group flex flex-col items-center gap-1.5",children:[t.jsx("div",{className:"bg-primary/10 text-primary group-hover:bg-primary/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:t.jsx(Er,{className:"size-5"})}),t.jsx("span",{className:"text-xs font-medium",children:r("wallet:detail.exportMnemonic")})]}),t.jsxs("button",{onClick:C,className:"group flex flex-col items-center gap-1.5",children:[t.jsx("div",{className:"bg-destructive/10 text-destructive group-hover:bg-destructive/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:t.jsx(Qt,{className:"size-5"})}),t.jsx("span",{className:"text-destructive text-xs font-medium",children:r("wallet:detail.deleteWallet")})]})]})]})}ba.__docgenInfo={description:`
- default: + edit
- edit:  default  default
- edit-only: / onEditOnlyComplete`,methods:[],displayName:"WalletConfig",props:{mode:{required:!0,tsType:{name:"union",raw:"'edit-only' | 'default' | 'edit'",elements:[{name:"literal",value:"'edit-only'"},{name:"literal",value:"'default'"},{name:"literal",value:"'edit'"}]},description:""},walletId:{required:!0,tsType:{name:"string"},description:""},onEditOnlyComplete:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};export{Du as A,nu as C,Jp as I,Hd as L,Bu as N,Fd as R,Ee as S,ju as T,ru as V,ba as W,nm as a,bu as b,lt as c,ou as d,Vd as e,Bs as f,ai as g,_d as h,Ls as n};
