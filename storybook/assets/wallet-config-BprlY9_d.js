const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./snapdom-CO8q8LPW.js","./preload-helper-PPVm8Dsz.js","./index-BVzIq5_8.js","./schemas-BX8BzOgD.js","./chain-config-DW44byg9.js","./index-D0E7N0oa.js","./bioforest-D91I-84E.js","./iframe-g2b0m8DI.js","./iframe-COlAjlj5.css","./address-format-Bt4Tl7ZW.js","./amount-BQsqQYGO.js"])))=>i.map(i=>d[i]);
import{A as _e,w as me,B as de,J as Lt,K as pt,I as Ci,u as At,h as tt,k as un,x as mn,y as fn,f as Ft,a as Wt,e as pn,d as Vn,b as us,L as Vd,E as Si,F as ki,G as Ai,H as Ti,c as ct,C as hn,M as Kd,D as Ii}from"./chain-config-DW44byg9.js";import{u as le,r as l,N as Gd,g as Qd,j as e,R as ua,aJ as ma,aH as ms,aI as fs,O as fa,aK as Pi,P as Kn,S as Yd,t as Xd}from"./iframe-g2b0m8DI.js";import{a as xn,c as M}from"./utils-CDN07tui.js";import{u as Ei,d as Gn,W as Zd}from"./useWalletTheme-BgCuKn0J.js";import{W as eu,u as _i}from"./wallet-card-carousel-BmAQCyM3.js";import{W as Mi}from"./wallet-card-Ddaln5uG.js";import{I as Pe}from"./input-bgLkMY40.js";import{B as $}from"./button-CkH5a8bp.js";import{S as tu}from"./swiper-sync-context-D4c_xKZw.js";import{T as su}from"./TabBar-RqDNHhg4.js";import{u as ps,t as Ri,h as nu,c as au,W as ru,C as iu,s as jt}from"./token-item-DkSJ-y5E.js";import{L as be}from"./loading-spinner-BKRfkk18.js";import{u as L}from"./useTranslation-Cu2h0njW.js";import{I as Se}from"./IconAlertTriangle-BX3363qR.js";import{b as Tt,I as gn,a as hs}from"./IconTrash-COIP1dsh.js";import{G as Ee}from"./gradient-button-Bxl7tD7d.js";import{c as pa,I as Di}from"./web-wmJrEV3C.js";import{t as ou}from"./web-C48KhOIf.js";import"./index-D0E7N0oa.js";import"./breakpoint-wIg8UP9C.js";import{_ as os}from"./preload-helper-PPVm8Dsz.js";import{A as ce}from"./amount-BQsqQYGO.js";import{g as xs,i as zi,l as vn,m as cu,s as lu,v as Bi,n as du,o as Li,p as uu,q as mu,r as fu,I as pu}from"./index-BVzIq5_8.js";import{c as se}from"./createReactComponent-Cuq699P7.js";import{I as $s,a as Oi,b as Pn,c as bn,d as hu,g as xu,e as gu,f as vu}from"./transaction-item-91IuR5c8.js";import{I as bu,i as yu,A as ju}from"./address-input-Cm8HX0EM.js";import{I as st}from"./IconPlus-gaw-z2dW.js";import{e as Nt,I as ha,H as Ie,u as Nu,l as Fi,J as wu,K as Cu,L as Za,d as Su,M as er,N as tr,O as sr,P as nr,Q as ar,R as rr,S as ir,T as or,U as cr,V as lr,W as ku}from"./index-DaW5WteN.js";import{g as yn,n as Au,C as Qn,p as Tu}from"./index-Ddwf1R_9.js";import{a as xa,j as ga,l as $e,o as $t,n as wt,s as W,b as Ue,c as qe,i as Vt}from"./schemas-BX8BzOgD.js";import{a as Iu}from"./my-apps-page-DzsmjCL3.js";import{E as Pu,c as Wi}from"./ecosystem-desktop-BYK-sEbq.js";import"./miniapp-splash-screen-C7l9BEg6.js";import"./swiper-141A4hTv.js";/* empty css                     */import{P as H}from"./page-header-BGsHKDUn.js";import{I as Ce}from"./IconChevronRight-DnbWrSD5.js";import{S as ht,a as xt,b as gt,c as vt,u as Eu,f as _u,D as Mu,g as Ru,h as Du,i as zu,j as Bu,k as Lu,l as Ou,m as Fu,n as Wu}from"./sheet-qKOY-h9y.js";import{I as fe}from"./IconCheck-C48_yMgZ.js";import{createBioforestAdapter as $i,deriveWalletChainAddresses as qi}from"./index-8IVDuJeQ.js";import{C as Ct}from"./chain-icon-COt1uHxx.js";import{p as St,P as Kt}from"./pattern-lock-DQcepsy9.js";import{P as qs}from"./password-input-DVd80mqS.js";import{I as It}from"./IconAlertCircle-CUQDCVam.js";import{F as va}from"./fee-display-Bwlema-B.js";import{I as ke}from"./IconLoader2-Djaw_jtx.js";import{g as bt,C as jn,I as $u}from"./contact-avatar-DXqkji0z.js";import{I as gs,P as ba}from"./pattern-lock-setup-KD25Fgbv.js";import{i as qu,d as Hu}from"./address-format-Bt4Tl7ZW.js";import{I as vs}from"./IconSearch-DX39uvQM.js";import{I as ya}from"./IconDownload-X1at1lSm.js";import{W as Uu}from"./wallet-mini-card-DAe4T2aE.js";import{I as Ju,W as Vu}from"./wallet-list-C3jOAsrC.js";import{C as Hi}from"./checkbox-BDHjh8qs.js";import{I as Ui,A as Ji,S as Hs,a as Us,b as Js,c as Vs,d as qt}from"./asset-selector-hWQAN1bM.js";import{I as Vi}from"./IconChevronDown-BUNW6xut.js";import{p as Ki,g as Ku}from"./qr-parser-CQk8zDFR.js";import{c as Gi}from"./index-D6xuhotd.js";import{g as Gu,a as Qu,b as Yu}from"./scanner-validators-YRGmuXyx.js";import{I as Nn}from"./IconX-Dho8Gi5m.js";import{I as ja}from"./IconWallet-BSnEKzL1.js";import{C as Xu}from"./contact-card-fY8xT9m6.js";import{i as Ds,c as zs,X as Bs,o as Te,G as Fe,a as Zu}from"./bioforest-D91I-84E.js";import{A as He}from"./address-display-C7nFi0cW.js";import{I as Qi}from"./IconShieldCheck-u41z_njd.js";import{A as lt}from"./amount-display-p3kKhEyv.js";import{I as Na}from"./IconEye-DzO7GDXG.js";import{I as em}from"./IconInfoCircle-Ds2ezTBJ.js";import{A as kt,P as Ze,F as tm,E as Yi,C as dr}from"./copyable-text-BhO3508M.js";import{I as bs}from"./icon-circle-BPhKNUJn.js";import{M as Xi}from"./mnemonic-display-Dc9C5C6U.js";import{g as Zi,C as wa}from"./chain-selector-DhEq0Ya9.js";import{g as sm,v as eo,R as nm}from"./recover-wallet-form-Ds8U8Ldi.js";import{I as to}from"./IconEyeOff-DxQWbyvQ.js";import{I as Gt}from"./IconCircleCheck-WR4e0BUZ.js";import"./asset-item-ByVMX1sq.js";import"./asset-list-CGPXm7_L.js";import{A as so}from"./amount-input-YYZFcd7_.js";import{S as no,I as Yn,a as ao}from"./send-result-DK4atiZG.js";import{A as am}from"./qr-code-C7yKKB09.js";import{d as rm}from"./useRenderElement-CculAx30.js";import{T as ro}from"./Trans-DPebWkIv.js";import{M as im}from"./mnemonic-input-CP7F9fy-.js";import{T as io}from"./transaction-list-CtSNixvf.js";import"./empty-state-Djr2ZYm8.js";import{b as En}from"./skeleton-BkqRBCyh.js";import"./animated-number-D2KYFGet.js";import{T as om}from"./time-display-BRjqNmbb.js";import{T as cm,I as lm}from"./transaction-status-DgePTOMr.js";import{A as oo}from"./AppInfoCard-DFlUdV-W.js";import{P as dm}from"./PermissionList-D3RgLE7z.js";import{W as um}from"./wallet-selector-DYNhADHH.js";import{T as Je}from"./token-icon-uu9a5B4t.js";import{T as ur}from"./TransactionDetails-CR3IkJMu.js";import{B as mr}from"./BalanceWarning-CKhqiFqQ.js";import{K as mm}from"./key-type-selector-Bd7A8e_3.js";import{A as fm}from"./arbitrary-key-input-CQlhvGgc.js";import{C as pm}from"./chain-address-preview-BkKWXepo.js";import{C as hm}from"./collision-confirm-dialog-C0XFKuHN.js";import{B as xm}from"./balance-display-DS10TsW2.js";import{I as gm}from"./dropdown-menu-pacyIMP3.js";import{I as vm}from"./IconBell-Uq-XHWgQ.js";import{I as bm}from"./IconCircleX-CPLaLebK.js";import{I as ym}from"./IconShield-e5jYc2Wb.js";const jm=[["path",{d:"M20 6v12a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2z",key:"svg-0"}],["path",{d:"M10 16h6",key:"svg-1"}],["path",{d:"M13 11m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-2"}],["path",{d:"M4 8h3",key:"svg-3"}],["path",{d:"M4 12h3",key:"svg-4"}],["path",{d:"M4 16h3",key:"svg-5"}]],Nm=se("outline","address-book","AddressBook",jm);const wm=[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 15h10.55",key:"svg-1"}],["path",{d:"M6.551 4.938l3.26 10.034",key:"svg-2"}],["path",{d:"M17.032 4.636l-8.535 6.201",key:"svg-3"}],["path",{d:"M20.559 14.51l-8.535 -6.201",key:"svg-4"}],["path",{d:"M12.257 20.916l3.261 -10.034",key:"svg-5"}]],co=se("outline","aperture","Aperture",wm);const Cm=[["path",{d:"M17 7l-10 10",key:"svg-0"}],["path",{d:"M16 17l-9 0l0 -9",key:"svg-1"}]],Sm=se("outline","arrow-down-left","ArrowDownLeft",Cm);const km=[["path",{d:"M7 7l10 10",key:"svg-0"}],["path",{d:"M17 8l0 9l-9 0",key:"svg-1"}]],Am=se("outline","arrow-down-right","ArrowDownRight",km);const Tm=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M13 18l6 -6",key:"svg-1"}],["path",{d:"M13 6l6 6",key:"svg-2"}]],lo=se("outline","arrow-right","ArrowRight",Tm);const Im=[["path",{d:"M17 7l-10 10",key:"svg-0"}],["path",{d:"M8 7l9 0l0 9",key:"svg-1"}]],uo=se("outline","arrow-up-right","ArrowUpRight",Im);const Pm=[["path",{d:"M3 12h1m8 -9v1m8 8h1m-15.4 -6.4l.7 .7m12.1 -.7l-.7 .7",key:"svg-0"}],["path",{d:"M9 16a5 5 0 1 1 6 0a3.5 3.5 0 0 0 -1 3a2 2 0 0 1 -4 0a3.5 3.5 0 0 0 -1 -3",key:"svg-1"}],["path",{d:"M9.7 17l4.6 0",key:"svg-2"}]],mo=se("outline","bulb","Bulb",Pm);const Em=[["path",{d:"M5 7h1a2 2 0 0 0 2 -2a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1a2 2 0 0 0 2 2h1a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-9a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M9 13a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-1"}]],_m=se("outline","camera","Camera",Em);const Mm=[["path",{d:"M14 10m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-0"}],["path",{d:"M21 12a9 9 0 1 1 -18 0a9 9 0 0 1 18 0z",key:"svg-1"}],["path",{d:"M12.5 11.5l-4 4l1.5 1.5",key:"svg-2"}],["path",{d:"M12 15l-1.5 -1.5",key:"svg-3"}]],Ca=se("outline","circle-key","CircleKey",Mm);const Rm=[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M14.8 9a2 2 0 0 0 -1.8 -1h-2a2 2 0 1 0 0 4h2a2 2 0 1 1 0 4h-2a2 2 0 0 1 -1.8 -1",key:"svg-1"}],["path",{d:"M12 7v10",key:"svg-2"}]],Dm=se("outline","coin","Coin",Rm);const zm=[["path",{d:"M16.7 8a3 3 0 0 0 -2.7 -2h-4a3 3 0 0 0 0 6h4a3 3 0 0 1 0 6h-4a3 3 0 0 1 -2.7 -2",key:"svg-0"}],["path",{d:"M12 3v3m0 12v3",key:"svg-1"}]],Bm=se("outline","currency-dollar","CurrencyDollar",zm);const Lm=[["path",{d:"M6 12l6 -9l6 9l-6 9z",key:"svg-0"}],["path",{d:"M6 12l6 -3l6 3l-6 2z",key:"svg-1"}]],Om=se("outline","currency-ethereum","CurrencyEthereum",Lm);const Fm=[["path",{d:"M12 6m-8 0a8 3 0 1 0 16 0a8 3 0 1 0 -16 0",key:"svg-0"}],["path",{d:"M4 6v6a8 3 0 0 0 16 0v-6",key:"svg-1"}],["path",{d:"M4 12v6a8 3 0 0 0 16 0v-6",key:"svg-2"}]],fo=se("outline","database","Database",Fm);const Wm=[["path",{d:"M3 5a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v10a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1v-10z",key:"svg-0"}],["path",{d:"M7 20h10",key:"svg-1"}],["path",{d:"M9 16v4",key:"svg-2"}],["path",{d:"M15 16v4",key:"svg-3"}]],$m=se("outline","device-desktop","DeviceDesktop",Wm);const qm=[["path",{d:"M4 4h16v2.172a2 2 0 0 1 -.586 1.414l-4.414 4.414v7l-6 2v-8.5l-4.48 -4.928a2 2 0 0 1 -.52 -1.345v-2.227z",key:"svg-0"}]],po=se("outline","filter","Filter",qm);const Hm=[["path",{d:"M18.9 7a8 8 0 0 1 1.1 5v1a6 6 0 0 0 .8 3",key:"svg-0"}],["path",{d:"M8 11a4 4 0 0 1 8 0v1a10 10 0 0 0 2 6",key:"svg-1"}],["path",{d:"M12 11v2a14 14 0 0 0 2.5 8",key:"svg-2"}],["path",{d:"M8 15a18 18 0 0 0 1.8 6",key:"svg-3"}],["path",{d:"M4.9 19a22 22 0 0 1 -.9 -7v-1a8 8 0 0 1 12 -6.95",key:"svg-4"}]],Um=se("outline","fingerprint","Fingerprint",Hm);const Jm=[["path",{d:"M9 6.371c0 4.418 -2.239 6.629 -5 6.629",key:"svg-0"}],["path",{d:"M4 6.371h7",key:"svg-1"}],["path",{d:"M5 9c0 2.144 2.252 3.908 6 4",key:"svg-2"}],["path",{d:"M12 20l4 -9l4 9",key:"svg-3"}],["path",{d:"M19.1 18h-6.2",key:"svg-4"}],["path",{d:"M6.694 3l.793 .582",key:"svg-5"}]],Vm=se("outline","language","Language",Jm);const Km=[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]],ho=se("outline","link","Link",Km);const Gm=[["path",{d:"M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z",key:"svg-0"}]],Qm=se("outline","moon","Moon",Gm);const Ym=[["path",{d:"M6 9a6 6 0 1 0 12 0a6 6 0 0 0 -12 0",key:"svg-0"}],["path",{d:"M12 3c1.333 .333 2 2.333 2 6s-.667 5.667 -2 6",key:"svg-1"}],["path",{d:"M12 3c-1.333 .333 -2 2.333 -2 6s.667 5.667 2 6",key:"svg-2"}],["path",{d:"M6 9h12",key:"svg-3"}],["path",{d:"M3 20h7",key:"svg-4"}],["path",{d:"M14 20h7",key:"svg-5"}],["path",{d:"M10 20a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-6"}],["path",{d:"M12 15v3",key:"svg-7"}]],Xm=se("outline","network","Network",Ym);const Zm=[["path",{d:"M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25",key:"svg-0"}],["path",{d:"M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}],["path",{d:"M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-3"}]],ef=se("outline","palette","Palette",Zm);const tf=[["path",{d:"M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4",key:"svg-0"}],["path",{d:"M13.5 6.5l4 4",key:"svg-1"}],["path",{d:"M16 19h6",key:"svg-2"}]],sf=se("outline","pencil-minus","PencilMinus",tf);const nf=[["path",{d:"M4 4m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M7 17l0 .01",key:"svg-1"}],["path",{d:"M14 4m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M7 7l0 .01",key:"svg-3"}],["path",{d:"M4 14m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-4"}],["path",{d:"M17 7l0 .01",key:"svg-5"}],["path",{d:"M14 14l3 0",key:"svg-6"}],["path",{d:"M20 14l0 .01",key:"svg-7"}],["path",{d:"M14 14l0 3",key:"svg-8"}],["path",{d:"M14 20l3 0",key:"svg-9"}],["path",{d:"M17 17l3 0",key:"svg-10"}],["path",{d:"M20 17l0 3",key:"svg-11"}]],af=se("outline","qrcode","Qrcode",nf);const rf=[["path",{d:"M10 14l11 -11",key:"svg-0"}],["path",{d:"M21 3l-6.5 18a.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a.55 .55 0 0 1 0 -1l18 -6.5",key:"svg-1"}]],xo=se("outline","send","Send",rf);const of=[["path",{d:"M8 9h-1a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-8a2 2 0 0 0 -2 -2h-1",key:"svg-0"}],["path",{d:"M12 14v-11",key:"svg-1"}],["path",{d:"M9 6l3 -3l3 3",key:"svg-2"}]],cf=se("outline","share-2","Share2",of);const lf=[["path",{d:"M6 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-0"}],["path",{d:"M18 6m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-1"}],["path",{d:"M18 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-2"}],["path",{d:"M8.7 10.7l6.6 -3.4",key:"svg-3"}],["path",{d:"M8.7 13.3l6.6 3.4",key:"svg-4"}]],Ks=se("outline","share","Share",lf);const df=[["path",{d:"M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7",key:"svg-1"}]],uf=se("outline","sun","Sun",df);const mf=[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 9h16.8",key:"svg-1"}],["path",{d:"M3.6 15h16.8",key:"svg-2"}],["path",{d:"M11.5 3a17 17 0 0 0 0 18",key:"svg-3"}],["path",{d:"M12.5 3a17 17 0 0 1 0 18",key:"svg-4"}]],go=se("outline","world","World",mf);function Pt(){return le(me,t=>t.wallets)}function ye(){return le(me,t=>_e.getCurrentWallet(t))}function Ke(){return le(me,t=>t.selectedChain)}function vo(){return le(me,t=>t.chainPreferences)}function wn(){return le(me,t=>_e.getCurrentChainAddress(t))}function Cn(){return le(me,t=>_e.getCurrentChainTokens(t))}function bo(){return le(me,t=>_e.getAvailableChains(t))}function yo(){return le(me,t=>_e.hasWallet(t))}function jo(){return le(me,t=>t.isInitialized)}const ff=Object.freeze(Object.defineProperty({__proto__:null,addressBookActions:Wt,addressBookSelectors:pn,addressBookStore:Ft,chainConfigActions:ct,chainConfigSelectors:tt,chainConfigStore:Vn,currencies:Kn,languages:Pi,preferencesActions:ms,preferencesStore:Xd,useAvailableChains:bo,useChainConfigError:Ti,useChainConfigLoading:Ai,useChainConfigMigrationRequired:Ci,useChainConfigState:At,useChainConfigSubscription:Si,useChainConfigWarnings:ki,useChainConfigs:us,useChainPreferences:vo,useCurrency:fa,useCurrentChainAddress:wn,useCurrentChainTokens:Cn,useCurrentWallet:ye,useEnabledBioforestChainConfigs:Ii,useEnabledChains:hn,useHasWallet:yo,useLanguage:fs,useSelectedChain:Ke,useTheme:ma,useWalletInitialized:jo,useWallets:Pt,walletActions:de,walletSelectors:_e,walletStore:me},Symbol.toStringTag,{value:"Module"})),pf={all:["balance"],wallet:t=>["balance",t],chain:(t,s)=>["balance",t,s]};function hf(t,s){return ps({queryKey:pf.chain(t??"",s??""),queryFn:async()=>{if(!t||!s)return{tokens:[],supported:!1,fallbackReason:"Missing walletId or chain"};const n=await de.refreshBalance(t,s);return{tokens:(await os(async()=>{const{walletStore:c}=await Promise.resolve().then(()=>ff);return{walletStore:c}},void 0,import.meta.url)).walletStore.state.wallets.find(c=>c.id===t)?.chainAddresses.find(c=>c.chain===s)?.tokens??[],supported:n?.supported??!0,fallbackReason:n?.fallbackReason}},enabled:!!t&&!!s,staleTime:30*1e3,gcTime:300*1e3,refetchInterval:60*1e3,refetchIntervalInBackground:!1,refetchOnWindowFocus:!0})}const fr={all:["transactionHistory"],wallet:t=>["transactionHistory",t],filtered:(t,s)=>["transactionHistory",t,s]};function xf(t){return{id:t.id,type:t.type,status:t.status,amount:t.amount,symbol:t.symbol,address:t.address,timestamp:t.timestamp,hash:t.hash,chain:t.chain,fee:t.fee,feeSymbol:t.feeSymbol,feeDecimals:t.feeDecimals,blockNumber:t.blockNumber,confirmations:t.confirmations,from:t.from,to:t.to,action:t.action,direction:t.direction,assets:t.assets,contract:t.contract}}function Sa(t){const[s,n]=l.useState({chain:"all",period:"all"}),a=Gd(),r=ps({queryKey:fr.filtered(t??"",s),queryFn:async()=>{if(!t)return[];const c={chain:s.chain??"all",period:s.period??"all",type:void 0,status:void 0};return(await Ri.getHistory({walletId:t,filter:c})).map(xf)},enabled:!!t,staleTime:30*1e3,gcTime:300*1e3,refetchOnWindowFocus:!0}),o=async()=>{await a.invalidateQueries({queryKey:fr.wallet(t??"")})};return{transactions:r.data??[],isLoading:r.isLoading,isFetching:r.isFetching,error:r.error?.message,filter:s,setFilter:n,refresh:o}}function ka(){return pa}function nt(){return ou}function Sn(){return nu}function No(){return au}const Gs={authorizeAddress:"/wallet/authorize/address",authorizeSignature:"/wallet/authorize/signature"};class gf{constructor(s,n){this.adapter=s,this.eventId=n}hasResponded=!1;handleNetworkAddresses(s,n){const a=n.trim().toLowerCase();if(!a)return[];const r=[];for(const o of s)for(const c of o.chainAddresses)String(c.chain).toLowerCase()===a&&r.push({name:o.name,address:c.address,chainName:c.chain,publicKey:"",magic:`${o.id}:${c.chain}`,signMessage:""});return r}handleMainAddresses(s){return s.chainAddresses.map(n=>({name:s.name,address:n.address,chainName:n.chain,publicKey:"",magic:`${s.id}:${n.chain}`,signMessage:""}))}async handleMainAddressesSigned(s,n){const a=this.handleMainAddresses(s);return await this.applySensitiveOptions(a,[s],{password:n.password,signMessage:n.signMessage,getMain:!1})}handleAllAddresses(s){const n=[];for(const a of s)n.push(...this.handleMainAddresses(a));return n}async handleAllAddressesSigned(s,n){const a=this.handleAllAddresses(s);return await this.applySensitiveOptions(a,s,{password:n.password,signMessage:n.signMessage,getMain:!1})}async handleNetworkAddressesSigned(s,n,a){const r=this.handleNetworkAddresses(s,n);return await this.applySensitiveOptions(r,s,{password:a.password,signMessage:a.signMessage,getMain:!1})}async applySensitiveOptions(s,n,a){return await this.applyPasswordProtectedFields(s,n,a)}async approve(s){await this.respondOnce(Gs.authorizeAddress,s)}async reject(s){await this.respondOnce(Gs.authorizeAddress,null)}async respondOnce(s,n){if(!this.hasResponded){this.hasResponded=!0;try{await this.adapter.respondWith(this.eventId,s,n)}finally{await this.adapter.removeEventId(this.eventId)}}}async applyPasswordProtectedFields(s,n,a){const r=a.signMessage?.trim()??"",o=!!r,c=!!a.getMain;if(!o&&!c)return s;const i=new Map;for(const m of n)i.set(m.id,m);const d=new Map,u=new Set;for(const m of s){const f=this.getWalletIdFromMagic(m.magic),h=i.get(f),g=h?.encryptedMnemonic;if(!h||!g)throw new Error("Missing secret");const v=m.chainName.trim().toLowerCase();if(c){let p=d.get(f);if(!p){try{p=await Lt(g,a.password)}catch{throw new Error("Invalid password")}d.set(f,p)}m.main=p}if(o){if(Ds(v)){let p=d.get(f);if(!p){try{p=await Lt(g,a.password)}catch{throw new Error("Invalid password")}d.set(f,p)}const b=zs(p),y=Bs(r,b.secretKey);m.signMessage=`0x${Te(y)}`,m.publicKey=Te(b.publicKey);continue}if(!u.has(f))if(d.has(f))u.add(f);else{if(!await pt(g,a.password))throw new Error("Invalid password");u.add(f)}m.signMessage=this.createDeterministicMockSignature({message:r,address:m.address,chainName:m.chainName})}}return s}getWalletIdFromMagic(s){const n=s.indexOf(":");return n===-1?s:s.slice(0,n)}createDeterministicMockSignature({message:s,address:n,chainName:a}){const r=new TextEncoder,o=Fe(r.encode(`address:${n}|chain:${a}|message:${s}`)),c=Fe(r.encode(`event:${this.eventId}`)),i=new Uint8Array(64);return i.set(o,0),i.set(c,32),`0x${Te(i)}`}}class Aa{constructor(s,n){this.adapter=s,this.eventId=n}hasResponded=!1;async approve(s){await this.respondOnce(Gs.authorizeSignature,s)}async reject(s){await this.respondOnce(Gs.authorizeSignature,null)}async handleMessageSign(s,n,a){const r=s.chainName.trim().toLowerCase();if(Ds(r)){let c;try{c=await Lt(n,a)}catch{throw new Error("Invalid password")}const i=zs(c),d=Bs(s.message,i.secretKey);return{signature:`0x${Te(d)}`,publicKey:Te(i.publicKey)}}if(!await pt(n,a))throw new Error("Invalid password");{const c=new TextEncoder,i=Fe(c.encode(`message:${s.message}`)),d=Fe(c.encode(`event:${this.eventId}`)),u=new Uint8Array(64);u.set(i,0),u.set(d,32);const m=Fe(c.encode(`pubkey:${s.senderAddress}`));return{signature:`0x${Te(u)}`,publicKey:Te(m)}}}async handleTransferSign(s,n,a){const r=s.chainName.trim().toLowerCase(),o=["transfer",r,s.senderAddress,s.receiveAddress,s.balance,s.fee??"",s.contractInfo?.assetType??s.assetType??"",s.contractInfo?.contractAddress??"",s.contractInfo?.decimals?.toString()??""].join("|");if(Ds(r)){let f;try{f=await Lt(n,a)}catch{throw new Error("Invalid password")}const h=zs(f),g=Bs(o,h.secretKey);return`0x${Te(g)}`}if(!await pt(n,a))throw new Error("Invalid password");const i=new TextEncoder,d=Fe(i.encode(o)),u=Fe(i.encode(`event:${this.eventId}`)),m=new Uint8Array(64);return m.set(d,0),m.set(u,32),`0x${Te(m)}`}async handleDestroySign(s,n,a){const r=s.chainName.trim().toLowerCase(),o=["destory",r,s.senderAddress,s.destoryAddress,s.destoryAmount,s.fee??"",s.assetType??""].join("|");if(Ds(r)){let f;try{f=await Lt(n,a)}catch{throw new Error("Invalid password")}const h=zs(f),g=Bs(o,h.secretKey);return`0x${Te(g)}`}if(!await pt(n,a))throw new Error("Invalid password");const i=new TextEncoder,d=Fe(i.encode(o)),u=Fe(i.encode(`event:${this.eventId}`)),m=new Uint8Array(64);return m.set(d,0),m.set(u,32),`0x${Te(m)}`}async respondOnce(s,n){if(!this.hasResponded){this.hasResponded=!0;try{await this.adapter.respondWith(this.eventId,s,n)}finally{await this.adapter.removeEventId(this.eventId)}}}}class vf{async getCallerAppInfo(s){throw new Error("DWEB runtime not available in web environment")}async respondWith(s,n,a){throw new Error("DWEB runtime not available in web environment")}async removeEventId(s){}isAvailable(){return!1}}const Ht=new vf,bf={all:["addressBalance"],query:(t,s)=>["addressBalance",t,s]};function yf(t,s,n=!0){return ps({queryKey:bf.query(t,s),queryFn:async()=>{if(!t||!s)return{balance:null,error:"Missing chain or address",supported:!1};const r=await xs(t).getNativeBalance(s);return zi(r)?{balance:r.data,error:null,supported:!0}:{balance:r.data,error:r.reason,supported:!1}},enabled:n&&!!t&&!!s,staleTime:30*1e3,gcTime:300*1e3})}const jf={all:["addressTransactions"],address:(t,s)=>["addressTransactions",t,s]};function Nf({chainId:t,address:s,limit:n=20,enabled:a=!0}){return ps({queryKey:jf.address(t,s),queryFn:async()=>{if(!t||!s)return{transactions:[],supported:!1,fallbackReason:"Missing chain or address"};const o=await xs(t).getTransactionHistory(s,n);return zi(o)?{transactions:o.data,supported:!0}:{transactions:o.data,supported:!1,fallbackReason:o.reason}},enabled:a&&!!t&&!!s.trim(),staleTime:30*1e3,gcTime:300*1e3})}function wf(){return typeof window>"u"}function ws(){return!wf()}function Cf(){const t={value:null};function s(){return t.value}function n(a){t.value=a}return[s,n]}var _n,pr;function Sf(){if(pr)return _n;pr=1;var t=typeof Element<"u",s=typeof Map=="function",n=typeof Set=="function",a=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function r(o,c){if(o===c)return!0;if(o&&c&&typeof o=="object"&&typeof c=="object"){if(o.constructor!==c.constructor)return!1;var i,d,u;if(Array.isArray(o)){if(i=o.length,i!=c.length)return!1;for(d=i;d--!==0;)if(!r(o[d],c[d]))return!1;return!0}var m;if(s&&o instanceof Map&&c instanceof Map){if(o.size!==c.size)return!1;for(m=o.entries();!(d=m.next()).done;)if(!c.has(d.value[0]))return!1;for(m=o.entries();!(d=m.next()).done;)if(!r(d.value[1],c.get(d.value[0])))return!1;return!0}if(n&&o instanceof Set&&c instanceof Set){if(o.size!==c.size)return!1;for(m=o.entries();!(d=m.next()).done;)if(!c.has(d.value[0]))return!1;return!0}if(a&&ArrayBuffer.isView(o)&&ArrayBuffer.isView(c)){if(i=o.length,i!=c.length)return!1;for(d=i;d--!==0;)if(o[d]!==c[d])return!1;return!0}if(o.constructor===RegExp)return o.source===c.source&&o.flags===c.flags;if(o.valueOf!==Object.prototype.valueOf&&typeof o.valueOf=="function"&&typeof c.valueOf=="function")return o.valueOf()===c.valueOf();if(o.toString!==Object.prototype.toString&&typeof o.toString=="function"&&typeof c.toString=="function")return o.toString()===c.toString();if(u=Object.keys(o),i=u.length,i!==Object.keys(c).length)return!1;for(d=i;d--!==0;)if(!Object.prototype.hasOwnProperty.call(c,u[d]))return!1;if(t&&o instanceof Element)return!1;for(d=i;d--!==0;)if(!((u[d]==="_owner"||u[d]==="__v"||u[d]==="__o")&&o.$$typeof)&&!r(o[u[d]],c[u[d]]))return!1;return!0}return o!==o&&c!==c}return _n=function(c,i){try{return r(c,i)}catch(d){if((d.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw d}},_n}var kf=Sf();const ss=Qd(kf);function wo(t){const s=l.useRef(t),n=s.current,a=ss(n,t);return l.useEffect(()=>{a||(s.current=t)},[t]),a?n:t}var Ta=l.createContext(null),Co=({children:t,value:s})=>e.jsx(Ta.Provider,{value:wo(s),children:t});Co.displayName="ActivityProvider";var Af=()=>l.useContext(Ta);function Tf(){return l.useContext(Ta).params}var So=l.createContext(null),ko=({children:t,value:s})=>e.jsx(So.Provider,{value:wo(s),children:t});ko.displayName="StackProvider";var If=()=>l.useContext(So),Pf=Object.defineProperty,Ef=Object.defineProperties,_f=Object.getOwnPropertyDescriptors,Qs=Object.getOwnPropertySymbols,Ao=Object.prototype.hasOwnProperty,To=Object.prototype.propertyIsEnumerable,hr=(t,s,n)=>s in t?Pf(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,ie=(t,s)=>{for(var n in s||(s={}))Ao.call(s,n)&&hr(t,n,s[n]);if(Qs)for(var n of Qs(s))To.call(s,n)&&hr(t,n,s[n]);return t},pe=(t,s)=>Ef(t,_f(s)),Mf=(t,s)=>{var n={};for(var a in t)Ao.call(t,a)&&s.indexOf(a)<0&&(n[a]=t[a]);if(t!=null&&Qs)for(var a of Qs(t))s.indexOf(a)<0&&To.call(t,a)&&(n[a]=t[a]);return n};function Rf(t,s,n){const a=n(t),r=n(s);return a<r?-1:a===r?0:1}var Df=(t,s)=>{const n=[],a=[];return t.forEach(r=>{s(r)?n.push(r):a.push(r)}),[n,a]};function Io(t,s){return t.map((n,a)=>s(n)?a:void 0).filter(n=>typeof n=="number")}var Mn=0,xr=0,Po=()=>{const t=new Date().getTime();return xr===t?Mn+=1:(xr=t,Mn=0),(t*1e3+Mn)/1e3};function We(){return(Po()*1e3).toString(16)}function kn(t){return t.length===0?void 0:t[t.length-1]}function gr(t,s){const n=ie({},t);return s.forEach(a=>{delete n[a]}),n}function zf(t){let s=!1;return()=>{s||(s=!0,t())}}function Bf(t,s){const n=new Map;return[...t].reverse().filter(a=>{const r=s(a);if(r===null)return!0;const o=!!n.get(r);return n.set(r,!0),!o}).reverse()}function Xn(t){return!t.exitedBy}function Zn(t,s){return s.enteredBy.eventDate-t.enteredBy.eventDate}function vr(t){return t.filter(Xn).sort(Zn)[0]}function Lf(t,s,n){const a=[];switch(s.name){case"Replaced":{if(kn(Io(t,d=>d.id===s.activityId))!==void 0)break;const o=t.slice().sort(Zn).filter(Xn),c=n.now-s.eventDate>=n.transitionDuration;if((s.skipEnterActiveState||c?"enter-done":"enter-active")==="enter-done"){const d=o.findIndex(u=>!(s.skipEnterActiveState&&u.enteredBy.name==="Replaced"&&u.transitionState==="enter-active"));return o.slice(0,d+1).map(u=>t.indexOf(u))}break}case"Popped":{const r=t.filter(Xn).sort(Zn),o=r.slice(0,r.length-1)[0];o&&a.push(t.indexOf(o));break}case"StepPushed":case"StepReplaced":{const r=vr(t);if(r){if(s.targetActivityId&&s.targetActivityId!==r.id)break;a.push(t.indexOf(r))}break}case"StepPopped":{const r=vr(t);if(r&&r.steps.length>1){if(s.targetActivityId&&s.targetActivityId!==r.id)break;a.push(t.indexOf(r))}break}}return a}function br(t,s){switch(s.name){case"Pushed":case"Replaced":{const n=kn(Io(t,a=>a.id===s.activityId));return n??t.length}default:return-1}}function yr(t,s){return{id:t.activityId,name:t.activityName,transitionState:s,params:t.activityParams,context:t.activityContext,steps:[{id:t.activityId,params:t.activityParams,enteredBy:t,zIndex:-1}],enteredBy:t,isTop:!1,isActive:!1,isRoot:!1,zIndex:-1}}function Ia(t){return(s,n)=>{const a=t[n.name].bind(t);if(a)return a(s,n);throw new Error(`No reducer for event ${JSON.stringify(n)}`)}}function Qe(t){return t}function Of({transitionDuration:t,now:s,resumedAt:n}){return Ia({Pushed(a,r){const o=s-(n??r.eventDate)>=t,c=r.skipEnterActiveState||o?"enter-done":"enter-active",i=br(a,r);return[...a.slice(0,i),yr(r,c),...a.slice(i+1)]},Replaced(a,r){var o,c;const i=s-(n??r.eventDate)>=t,d=br(a,r),u=(c=(o=a[d])==null?void 0:o.transitionState)!=null?c:r.skipEnterActiveState||i?"enter-done":"enter-active";return[...a.slice(0,d),yr(r,u),...a.slice(d+1)]},Initialized:Qe,ActivityRegistered:Qe,Popped:Qe,StepPushed:Qe,StepReplaced:Qe,StepPopped:Qe,Paused:Qe,Resumed:Qe})}function Qt(t){return t}function Ff(t){return Ia({Replaced:(s,n)=>pe(ie({},s),{exitedBy:n,transitionState:"exit-done"}),Popped:(s,n)=>{var a;const r=t.now-((a=t.resumedAt)!=null?a:n.eventDate)>=t.transitionDuration,o=n.skipExitActiveState||r?"exit-done":"exit-active";return pe(ie({},s),{exitedBy:n,transitionState:o,params:o==="exit-done"?s.steps[0].params:s.params,steps:o==="exit-done"?[s.steps[0]]:s.steps})},StepPushed:(s,n)=>{var a;const r={id:n.stepId,params:n.stepParams,enteredBy:n,zIndex:s.zIndex,hasZIndex:(a=n.hasZIndex)!=null?a:!1};return pe(ie({},s),{params:n.stepParams,steps:[...s.steps,r]})},StepReplaced:(s,n)=>{var a;const r={id:n.stepId,params:n.stepParams,enteredBy:n,zIndex:s.zIndex,hasZIndex:(a=n.hasZIndex)!=null?a:!1};return pe(ie({},s),{params:n.stepParams,steps:[...s.steps.slice(0,s.steps.length-1),r]})},StepPopped:(s,n)=>{var a;s.steps.pop();const r=(a=kn(s.steps))==null?void 0:a.params;return pe(ie({},s),{params:r??s.params})},Initialized:Qt,ActivityRegistered:Qt,Pushed:Qt,Paused:Qt,Resumed:Qt})}function Le(t){return(s,n)=>s.globalTransitionState==="paused"?pe(ie({},s),{pausedEvents:s.pausedEvents?[...s.pausedEvents,n]:[n]}):t(s,n)}function Me(t,s){return(n,a)=>{const r=Of({transitionDuration:n.transitionDuration,now:s.now,resumedAt:s.resumedAt}),o=Ff({transitionDuration:n.transitionDuration,now:s.now,resumedAt:s.resumedAt}),c=r(n.activities,a),i=Lf(n.activities,a,{transitionDuration:n.transitionDuration,now:s.now});for(const m of i)c[m]=o(c[m],a);const d=c.find(m=>m.transitionState==="enter-active"||m.transitionState==="exit-active"),u=n.globalTransitionState==="paused"?"paused":d?"loading":"idle";return t(pe(ie({},n),{activities:c,globalTransitionState:u}),a)}}function Mt(t,s){return pe(ie({},t),{events:[...t.events,s]})}function Eo(t){return Ia({Initialized:Le(Me((s,n)=>pe(ie({},s),{transitionDuration:n.transitionDuration,events:[...s.events,n]}),t)),ActivityRegistered:Le(Me((s,n)=>pe(ie({},s),{registeredActivities:[...s.registeredActivities,ie({name:n.activityName},n.activityParamsSchema?{paramsSchema:n.activityParamsSchema}:null)],events:[...s.events,n]}),t)),Paused:Le(Me((s,n)=>pe(ie({},s),{globalTransitionState:"paused",events:[...s.events,n]}),t)),Resumed:Me((s,n)=>{if(s.globalTransitionState!=="paused"||!s.pausedEvents)return pe(ie({},s),{events:[...s.events,n]});const a=Eo({now:t.now,resumedAt:n.eventDate}),r=s,{pausedEvents:o}=r,c=Mf(r,["pausedEvents"]),i=o.reduce(a,pe(ie({},c),{globalTransitionState:"idle"}));return pe(ie({},i),{events:[...i.events,n]})},t),Pushed:Le(Me(Mt,t)),Replaced:Le(Me(Mt,t)),Popped:Le(Me(Mt,t)),StepPushed:Le(Me(Mt,t)),StepReplaced:Le(Me(Mt,t)),StepPopped:Le(Me(Mt,t))})}function Rn(t,s){return t.filter(n=>n.name===s)}function Ls(t,s){return pe(ie({id:We(),eventDate:Po()},s),{name:t})}function Wf(t){if(t.length===0)throw new Error("events parameter is empty");if(Rn(t,"Initialized").length>1)throw new Error("InitializedEvent can only exist once");const n=Rn(t,"ActivityRegistered"),a=new Set(n.map(o=>o.activityName));if(Rn(t,"Pushed").some(o=>!a.has(o.activityName)))throw new Error("the corresponding activity does not exist")}function Dn(t,s){const n=Bf([...t].sort((m,f)=>m.eventDate-f.eventDate),m=>m.id);Wf(n);const a=Eo({now:s}),r=n.reduce(a,{activities:[],globalTransitionState:"idle",registeredActivities:[],transitionDuration:0,events:[]}),o=r.activities.filter(m=>m.transitionState==="enter-active"||m.transitionState==="enter-done"||m.transitionState==="exit-active"),c=o.filter(m=>m.transitionState==="enter-active"||m.transitionState==="enter-done"),i=o[o.length-1],d=c[c.length-1];return pe(ie({},r),{activities:r.activities.map(m=>{let f=o.findIndex(({id:v})=>v===m.id);const h=o.slice(0,f);for(const v of h)for(const p of v.steps)p.hasZIndex&&(f+=1);const g=m.steps.reduce((v,p)=>{var b;const y=kn(v),x=(b=y?.zIndex)!=null?b:f;return[...v,pe(ie({},p),{zIndex:x+(p.hasZIndex?1:0)})]},[]);return ie(ie({id:m.id,name:m.name,transitionState:m.transitionState,params:m.params,steps:g,enteredBy:m.enteredBy,zIndex:f,isTop:i?.id===m.id,isActive:d?.id===m.id,isRoot:f===0||f===1&&m.transitionState==="enter-active"&&m.enteredBy.name==="Replaced"},m.exitedBy?{exitedBy:m.exitedBy}:null),m.context?{context:m.context}:null)}).sort((m,f)=>Rf(m,f,h=>h.id))})}function $f(t,s){var n,a,r,o,c,i,d,u;const m=[];!ss(t,s)&&m.push({_TAG:"%SOMETHING_CHANGED%"});const h=t.globalTransitionState!=="paused"&&s.globalTransitionState==="paused",g=t.globalTransitionState==="paused"&&s.globalTransitionState!=="paused";h&&m.push({_TAG:"PAUSED"}),g&&m.push({_TAG:"RESUMED"});for(let v=0;v<Math.max(t.activities.length,s.activities.length);v+=1){const p=t.activities[v],b=s.activities[v],y=p?.transitionState==="exit-done"||p?.transitionState==="exit-active",x=b?.transitionState==="enter-active"||b?.transitionState==="enter-done";if(p&&b&&p.id===b.id)for(let j=0;j<Math.max(((n=p.steps)!=null?n:[]).length,((a=b.steps)!=null?a:[]).length);j+=1){const N=p.steps[j],w=b.steps[j];!N&&w?m.push({_TAG:"STEP_PUSHED",activity:b,step:w}):N&&!w?m.push({_TAG:"STEP_POPPED",activity:b}):p.steps.length===b.steps.length&&N.id!==w.id&&m.push({_TAG:"STEP_REPLACED",activity:b,step:w})}!p&&b?m.push({_TAG:b.enteredBy.name==="Pushed"?"PUSHED":"REPLACED",activity:b}):y&&x?m.push({_TAG:b.enteredBy.name==="Pushed"?"PUSHED":"REPLACED",activity:b}):p&&b&&p.id===b.id&&!ss(gr(p,["isActive","isTop","isRoot","transitionState","zIndex"]),gr(b,["isActive","isTop","isRoot","transitionState","zIndex"]))&&b.enteredBy.name==="Replaced"&&!ss(p.enteredBy,b.enteredBy)&&m.push({_TAG:"REPLACED",activity:b})}for(let v=Math.max(t.activities.length,s.activities.length)-1;v>=0;v-=1){const p=((r=t.activities[v])==null?void 0:r.transitionState)==="enter-done"||((o=t.activities[v])==null?void 0:o.transitionState)==="enter-active",b=((c=s.activities[v])==null?void 0:c.transitionState)==="exit-active"||((i=s.activities[v])==null?void 0:i.transitionState)==="exit-done",y=((d=s.activities[v+1])==null?void 0:d.enteredBy.name)==="Replaced"&&((u=s.activities[v+1])==null?void 0:u.transitionState)==="enter-done";p&&b&&!y&&m.push({_TAG:"POPPED",activity:s.activities[v]})}return m}var qf={Pushed:"onBeforePush",Replaced:"onBeforeReplace",Popped:"onBeforePop",StepPushed:"onBeforeStepPush",StepReplaced:"onBeforeStepReplace",StepPopped:"onBeforeStepPop",Paused:"onBeforePause",Resumed:"onBeforeResume"};function Ye(t,s,n,a){let r=!1,o=ie({},s);for(const c of n){const i=c[qf[t]];i&&i({actionParams:ie({},o),actions:pe(ie({},a),{preventDefault:()=>{r=!0},overrideActionParams:d=>{o=ie(ie({},o),d)}})})}return{isPrevented:r,nextActionParams:o}}function Hf({dispatchEvent:t,pluginInstances:s,actions:n}){return{push(a){const{isPrevented:r,nextActionParams:o}=Ye("Pushed",a,s,n);r||t("Pushed",o)},replace(a){const{isPrevented:r,nextActionParams:o}=Ye("Replaced",a,s,n);r||t("Replaced",o)},pop(a={}){const{isPrevented:r,nextActionParams:o}=Ye("Popped",a,s,n);r||t("Popped",o)},stepPush(a){const{isPrevented:r,nextActionParams:o}=Ye("StepPushed",a,s,n);r||t("StepPushed",o)},stepReplace(a){const{isPrevented:r,nextActionParams:o}=Ye("StepReplaced",a,s,n);r||t("StepReplaced",o)},stepPop(a={}){const{isPrevented:r,nextActionParams:o}=Ye("StepPopped",a,s,n);r||t("StepPopped",o)},pause(a={}){const{isPrevented:r,nextActionParams:o}=Ye("Paused",a,s,n);r||t("Paused",o)},resume(a={}){const{isPrevented:r,nextActionParams:o}=Ye("Resumed",a,s,n);r||t("Resumed",o)}}}function Uf(t,s,n){t.forEach(a=>{s.forEach(r=>{var o,c,i,d,u,m,f,h,g;switch(a._TAG){case"PUSHED":(o=r.onPushed)==null||o.call(r,{actions:n,effect:a});break;case"REPLACED":(c=r.onReplaced)==null||c.call(r,{actions:n,effect:a});break;case"POPPED":(i=r.onPopped)==null||i.call(r,{actions:n,effect:a});break;case"STEP_PUSHED":(d=r.onStepPushed)==null||d.call(r,{actions:n,effect:a});break;case"STEP_REPLACED":(u=r.onStepReplaced)==null||u.call(r,{actions:n,effect:a});break;case"STEP_POPPED":(m=r.onStepPopped)==null||m.call(r,{actions:n,effect:a});break;case"PAUSED":(f=r.onPaused)==null||f.call(r,{actions:n,effect:a});break;case"RESUMED":(h=r.onResumed)==null||h.call(r,{actions:n,effect:a});break;case"%SOMETHING_CHANGED%":(g=r.onChanged)==null||g.call(r,{actions:n,effect:a});break}})})}var Jf=1e3,Vf=Jf/60;function jr(t){var s,n,a,r;const o=[],i=[{key:"@stackflow/core",onChanged(){o.forEach(b=>b())}},...t.plugins.map(b=>b())],[d,u]=Df(t.initialEvents,b=>b.name==="Pushed"||b.name==="StepPushed"),m=i.reduce((b,y)=>{var x,j,N;return(N=(j=y.overrideInitialEvents)==null?void 0:j.call(y,{initialEvents:b,initialContext:(x=t.initialContext)!=null?x:{}}))!=null?N:b},d);m.length>0&&d.length>0&&m!==d&&((n=(s=t.handlers)==null?void 0:s.onInitialActivityIgnored)==null||n.call(s,m)),m.length===0&&((r=(a=t.handlers)==null?void 0:a.onInitialActivityNotFound)==null||r.call(a));const h={value:[...u,...m]},g={value:Dn(h.value,new Date().getTime())},v={getStack(){return g.value},dispatchEvent(b,y){const x=Ls(b,y),j=Dn([...h.value,x],new Date().getTime());h.value.push(x),p(j);const N=setInterval(()=>{const w=Dn(h.value,new Date().getTime());ss(g.value,w)||p(w),w.globalTransitionState==="idle"&&clearInterval(N)},Vf)},push:()=>{},replace:()=>{},pop:()=>{},stepPush:()=>{},stepReplace:()=>{},stepPop:()=>{},pause:()=>{},resume:()=>{}},p=b=>{const y=$f(g.value,b);g.value=b,Uf(y,i,v)};return Object.assign(v,Hf({dispatchEvent:v.dispatchEvent,pluginInstances:i,actions:v})),{actions:v,init:zf(()=>{i.forEach(b=>{var y;(y=b.onInit)==null||y.call(b,{actions:v})})}),pullEvents:()=>h.value,subscribe(b){return o.push(b),function(){const x=o.findIndex(j=>j===b);x>-1&&o.splice(x,1)}},pluginInstances:i}}var _o=l.createContext(null);function Kf(){const t=l.useContext(_o);if(t===null)throw new Error("useActivityComponentMap must be used within ActivityComponentMapProvider");return t}function Gf({children:t,value:s}){return e.jsx(_o.Provider,{value:s,children:t})}var Ys=t=>s=>s.find(({id:n})=>n===t);function Qf(t){return!t.exitedBy}function Yf(t,s){return s.enteredBy.eventDate-t.enteredBy.eventDate}function Xs(t){return t.filter(Qf).sort(Yf)[0]}function mt(){return We()}function Zs(){return We()}var Nr,Xf=(Nr=ua.useDeferredValue)!=null?Nr:t=>t,wr,Zf=(wr=ua.useSyncExternalStore)!=null?wr:(t,s)=>{const[n,a]=l.useState(()=>s());return l.useEffect(()=>t(()=>{a(()=>s())})),n},Cr,Mo=(Cr=ua.useTransition)!=null?Cr:()=>[!1,t=>t()],Ro=l.createContext(null),Do=l.createContext(null),zo=({coreStore:t,children:s})=>{const n=Zf(t.subscribe,t.actions.getStack,t.actions.getStack),a=Xf(n);return e.jsx(Do.Provider,{value:a,children:e.jsx(Ro.Provider,{value:t.actions,children:s})})};zo.displayName="CoreProvider";var Bo=()=>l.useContext(Ro),Lo=()=>l.useContext(Do),Oo=l.createContext(null),Fo=({children:t,value:s})=>e.jsx(Oo.Provider,{value:s,children:t});Fo.displayName="PluginsProvider";function Wo(){return l.useContext(Oo)}function ep(t){return typeof t=="object"&&t!==null&&"then"in t&&typeof t.then=="function"}var ge={PENDING:"pending",FULFILLED:"fulfilled",REJECTED:"rejected"};function Pa(t){if(t.status===ge.PENDING)return{status:ge.PENDING};if(t.status===ge.FULFILLED&&"value"in t)return{status:ge.FULFILLED,value:t.value};if(t.status===ge.REJECTED&&"reason"in t)return{status:ge.REJECTED,reason:t.reason};throw new Error("Invalid promise state")}function tp(t){if("status"in t&&Object.values(ge).some(n=>n===t.status))return t;const s=Object.assign(t,{status:ge.PENDING});return s.then(n=>{s.status=ge.FULFILLED,s.value=n},n=>{s.status=ge.REJECTED,s.reason=n}),s}function Os(t){return ep(t)?tp(t instanceof Promise?t:Promise.resolve(t)):Object.assign(Promise.resolve(t),{status:ge.FULFILLED,value:t})}function sp(t){return Object.assign(Promise.reject(t),{status:ge.REJECTED,reason:t})}function np(t){const s=Os(t),n=Pa(s);if(n.status===ge.FULFILLED)return n.value;throw n.status===ge.REJECTED?n.reason:s}var ap=Object.defineProperty,Sr=Object.getOwnPropertySymbols,rp=Object.prototype.hasOwnProperty,ip=Object.prototype.propertyIsEnumerable,kr=(t,s,n)=>s in t?ap(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,op=(t,s)=>{for(var n in s||(s={}))rp.call(s,n)&&kr(t,n,s[n]);if(Sr)for(var n of Sr(s))ip.call(s,n)&&kr(t,n,s[n]);return t},cp=(t,s,n)=>new Promise((a,r)=>{var o=d=>{try{i(n.next(d))}catch(u){r(u)}},c=d=>{try{i(n.throw(d))}catch(u){r(u)}},i=d=>d.done?a(d.value):Promise.resolve(d.value).then(o,c);i((n=n.apply(t,s)).next())});function lp(t){let s=null;const n=()=>((!s||Pa(s).status===ge.REJECTED)&&(s=t()),s);return{Component:r=>{const{default:o}=np(n());return e.jsx(o,op({},r))},preload:()=>cp(this,null,function*(){yield n()})}}var dp=Symbol("STRUCTURED_ACTIVITY_COMPONENT_TYPE");function up(t){return t!==null&&typeof t=="object"&&dp in t}var zn=new WeakMap;function mp(t){if(zn.has(t))return zn.get(t);const{Component:s}=lp(()=>{const n=t.content,a=Os(typeof n=="function"?n():{default:n}),r=Pa(a);return r.status===ge.FULFILLED?Os({default:r.value.default.component}):r.status===ge.REJECTED?sp(r.reason):Os(a.then(o=>({default:o.default.component})))});return zn.set(t,s),s}var fp=Object.defineProperty,pp=Object.defineProperties,hp=Object.getOwnPropertyDescriptors,Ar=Object.getOwnPropertySymbols,xp=Object.prototype.hasOwnProperty,gp=Object.prototype.propertyIsEnumerable,ea=(t,s,n)=>s in t?fp(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,it=(t,s)=>{for(var n in s||(s={}))xp.call(s,n)&&ea(t,n,s[n]);if(Ar)for(var n of Ar(s))gp.call(s,n)&&ea(t,n,s[n]);return t},Bn=(t,s)=>pp(t,hp(s)),Tr=(t,s,n)=>ea(t,typeof s!="symbol"?s+"":s,n),$o=({plugin:t,initialContext:s})=>{const n=Kf(),a=Lo(),r=Wo();return t.render({stack:Bn(it({},a),{render(o){return{activities:it(it({},a),o).activities.map(i=>Bn(it({},i),{key:i.id,render(d){const u=n[i.name];let m=up(u)?bp(u,i.params):e.jsx(u,{params:i.params});return r.forEach(f=>{var h,g;m=(g=(h=f.wrapActivity)==null?void 0:h.call(f,{activity:Bn(it({},i),{render:()=>m}),initialContext:s}))!=null?g:m}),e.jsx(Co,{value:it(it({},i),d),children:m},i.id)}}))}}}),initialContext:s})};$o.displayName="PluginRenderer";var vp=$o;function bp(t,s){const{layout:n,loading:a,errorHandler:r}=t,o=mp(t);return[i=>a?.component?e.jsx(l.Suspense,{fallback:e.jsx(a.component,{params:s}),children:i}):i,i=>{var d;if(!r)return i;const u=(d=r.boundary)!=null?d:yp;return e.jsx(u,{renderFallback:(m,f)=>e.jsx(r.component,{params:s,error:m,reset:f}),children:i})},i=>n?.component?e.jsx(n.component,{params:s,children:i}):i].reduce((i,d)=>d(i),e.jsx(o,{params:s}))}var yp=class extends l.Component{constructor(){super(...arguments),Tr(this,"state",{hasError:!1,error:null}),Tr(this,"reset",()=>this.setState({hasError:!1,error:null}))}render(){return this.state.hasError?this.props.renderFallback(this.state.error,this.reset):this.props.children}static getDerivedStateFromError(t){return{hasError:!0,error:t}}},jp=Object.defineProperty,Np=Object.defineProperties,wp=Object.getOwnPropertyDescriptors,Ir=Object.getOwnPropertySymbols,Cp=Object.prototype.hasOwnProperty,Sp=Object.prototype.propertyIsEnumerable,Pr=(t,s,n)=>s in t?jp(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,kp=(t,s)=>{for(var n in s||(s={}))Cp.call(s,n)&&Pr(t,n,s[n]);if(Ir)for(var n of Ir(s))Sp.call(s,n)&&Pr(t,n,s[n]);return t},Ap=(t,s)=>Np(t,wp(s)),qo=({initialContext:t})=>{const s=Lo(),n=Wo(),a=n.filter(o=>!!o.render);l.useEffect(()=>{a.length===0&&console.warn(`Stackflow - There is no rendering plugin, so "<Stack />" doesn't render anything. If you want to render some UI, use "@stackflow/plugin-renderer-basic" or add another rendering plugin.`)},[a]);let r=e.jsx(e.Fragment,{children:a.map(o=>e.jsx(vp,{plugin:o,initialContext:t},o.key))});return n.forEach(o=>{var c,i;r=(i=(c=o.wrapStack)==null?void 0:c.call(o,{stack:Ap(kp({},s),{render(){return r}}),initialContext:t}))!=null?i:r}),e.jsx(ko,{value:s,children:r})};qo.displayName="MainRenderer";var Tp=qo,Ip=Object.defineProperty,Er=Object.getOwnPropertySymbols,Pp=Object.prototype.hasOwnProperty,Ep=Object.prototype.propertyIsEnumerable,_r=(t,s,n)=>s in t?Ip(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Mr=(t,s)=>{for(var n in s||(s={}))Pp.call(s,n)&&_r(t,n,s[n]);if(Er)for(var n of Er(s))Ep.call(s,n)&&_r(t,n,s[n]);return t};function Ln(t){return t?t.animate==null?{skipActiveState:!1}:{skipActiveState:!t.animate}:{skipActiveState:!1}}function ys(){const t=Bo(),[s]=Mo();return l.useMemo(()=>({pending:s,push(n,a,r){const o=mt();return t?.push({activityId:o,activityName:n,activityParams:a,skipEnterActiveState:Ln(r).skipActiveState}),{activityId:o}},replace(n,a,r){var o;const c=mt();return t?.replace({activityId:(o=r?.activityId)!=null?o:mt(),activityName:n,activityParams:a,skipEnterActiveState:Ln(r).skipActiveState}),{activityId:c}},pop(n,a){let r=1,o={};typeof n=="object"&&(o=Mr({},n)),typeof n=="number"&&(r=n),a&&(o=Mr({},a));for(let c=0;c<r;c+=1)t?.pop({skipExitActiveState:c===0?Ln(o).skipActiveState:!0})}}),[t?.push,t?.replace,t?.pop,s])}var _p=()=>{const t=Bo(),[s]=Mo();return l.useMemo(()=>({pending:s,stepPush(n,a){const r=t?.getStack().activities,o=a?.targetActivityId?Ys(a.targetActivityId):Xs,c=r&&o(r);if(!c)throw new Error("The target activity is not found.");const i=typeof n=="function"?n(c.params):n,d=Zs();t?.stepPush({stepId:d,stepParams:i,targetActivityId:a?.targetActivityId})},stepReplace(n,a){const r=t?.getStack().activities,o=a?.targetActivityId?Ys(a.targetActivityId):Xs,c=r&&o(r);if(!c)throw new Error("The target activity is not found.");const i=typeof n=="function"?n(c.params):n,d=Zs();t?.stepReplace({stepId:d,stepParams:i,targetActivityId:a?.targetActivityId})},stepPop(n){t?.stepPop({targetActivityId:n?.targetActivityId})}}),[t?.stepPush,t?.stepReplace,t?.stepPop,t?.getStack,s])},Mp=Object.defineProperty,Rp=Object.defineProperties,Dp=Object.getOwnPropertyDescriptors,Rr=Object.getOwnPropertySymbols,zp=Object.prototype.hasOwnProperty,Bp=Object.prototype.propertyIsEnumerable,Dr=(t,s,n)=>s in t?Mp(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Cs=(t,s)=>{for(var n in s||(s={}))zp.call(s,n)&&Dr(t,n,s[n]);if(Rr)for(var n of Rr(s))Bp.call(s,n)&&Dr(t,n,s[n]);return t},Lp=(t,s)=>Rp(t,Dp(s));function On(t){return t?t.animate==null?{skipActiveState:!1}:{skipActiveState:!t.animate}:{skipActiveState:!1}}function Op(t){var s;const n=((s=t.plugins)!=null?s:[]).flat(Number.POSITIVE_INFINITY).map(u=>u),a=Object.entries(t.activities).reduce((u,[m,f])=>Lp(Cs({},u),{[m]:"component"in f?f.component:f}),{}),r=()=>new Date().getTime()-t.transitionDuration*2,o=jr({initialEvents:[Ls("Initialized",{transitionDuration:t.transitionDuration,eventDate:r()}),...Object.entries(t.activities).map(([u,m])=>Ls("ActivityRegistered",Cs({activityName:u,eventDate:r()},"component"in m?{activityParamsSchema:m.paramsSchema}:null)))],plugins:[]}),[c,i]=Cf(),d=l.memo(u=>{const m=l.useMemo(()=>{const f=c();if(ws()&&f)return f;const h=t.initialActivity?[Ls("Pushed",{activityId:mt(),activityName:t.initialActivity(),activityParams:{},eventDate:r(),skipEnterActiveState:!1})]:[],g=jr({initialEvents:[...o.pullEvents(),...h],initialContext:u.initialContext,plugins:n,handlers:{onInitialActivityIgnored:v=>{ws()&&console.warn(`Stackflow - Some plugin overrides an "initialActivity" option. The "initialActivity" option you set to "${v[0].activityName}" in the "stackflow" is ignored.`)},onInitialActivityNotFound:()=>{ws()&&console.warn("Stackflow - There is no initial activity. If you want to set the initial activity, add the `initialActivity` option of the `stackflow()` function or add a plugin that sets the initial activity. (e.g. `@stackflow/plugin-history-sync`)")}}});return ws()&&(g.init(),i(g)),g},[]);return e.jsx(Fo,{value:m.pluginInstances,children:e.jsx(zo,{coreStore:m,children:e.jsx(Gf,{value:a,children:e.jsx(Tp,{initialContext:u.initialContext})})})})});return d.displayName="Stack",{activities:t.activities,Stack:d,useFlow:ys,useStepFlow:_p,addActivity(u){if(c()){console.warn("Stackflow - `addActivity()` API cannot be called after a `<Stack />` component has been rendered");return}a[u.name]=l.memo(u.component),o.actions.dispatchEvent("ActivityRegistered",{activityName:u.name,activityParamsSchema:u.paramsSchema,eventDate:r()})},addPlugin(u){if(c()){console.warn("Stackflow - `addPlugin()` API cannot be called after a `<Stack />` component has been rendered");return}[u].flat(Number.POSITIVE_INFINITY).map(m=>m).forEach(m=>{n.push(m)})},actions:{getStack(){var u,m;return(m=(u=c())==null?void 0:u.actions.getStack())!=null?m:o.actions.getStack()},dispatchEvent(u,m){var f;return(f=c())==null?void 0:f.actions.dispatchEvent(u,m)},push(u,m,f){var h;const g=mt();return(h=c())==null||h.actions.push({activityId:g,activityName:u,activityParams:m,skipEnterActiveState:On(f).skipActiveState}),{activityId:g}},replace(u,m,f){var h,g,v;const p=(h=f?.activityId)!=null?h:mt();return(v=c())==null||v.actions.replace({activityId:(g=f?.activityId)!=null?g:mt(),activityName:u,activityParams:m,skipEnterActiveState:On(f).skipActiveState}),{activityId:p}},pop(u,m){var f;let h=1,g={};typeof u=="object"&&(g=Cs({},u)),typeof u=="number"&&(h=u),m&&(g=Cs({},m));for(let v=0;v<h;v+=1)(f=c())==null||f.actions.pop({skipExitActiveState:v===0?On(g).skipActiveState:!0})},stepPush(u,m){var f,h;const g=(f=c())==null?void 0:f.actions.getStack().activities,v=m?.targetActivityId?Ys(m.targetActivityId):Xs,p=g&&v(g);if(!p)throw new Error("The target activity is not found.");const b=typeof u=="function"?u(p.params):u,y=Zs();return(h=c())==null?void 0:h.actions.stepPush({stepId:y,stepParams:b,targetActivityId:m?.targetActivityId})},stepReplace(u,m){var f,h;const g=(f=c())==null?void 0:f.actions.getStack().activities,v=m?.targetActivityId?Ys(m.targetActivityId):Xs,p=g&&v(g);if(!p)throw new Error("The target activity is not found.");const b=typeof u=="function"?u(p.params):u,y=Zs();return(h=c())==null?void 0:h.actions.stepReplace({stepId:y,stepParams:b,targetActivityId:m?.targetActivityId})},stepPop(u){var m;return(m=c())==null?void 0:m.actions.stepPop({targetActivityId:u?.targetActivityId})}}}}function Fp(){return()=>({key:"plugin-renderer-basic",render({stack:t}){return e.jsx(e.Fragment,{children:t.render().activities.filter(s=>s.transitionState!=="exit-done").map(s=>e.jsx(l.Fragment,{children:s.render()},s.key))})}})}function Wp(t){var s=t.match(/^var\((.*)\)$/);return s?s[1]:t}function js(t,s){var n={};{var a=t;for(var r in a){var o=a[r];o!=null&&(n[Wp(r)]=o)}}return Object.defineProperty(n,"toString",{value:function(){return Object.keys(this).map(i=>"".concat(i,":").concat(this[i])).join(";")},writable:!1}),n}function $p(t,s){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var a=n.call(t,s);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function qp(t){var s=$p(t,"string");return typeof s=="symbol"?s:String(s)}function Hp(t,s,n){return s=qp(s),s in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,t}function zr(t,s){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);s&&(a=a.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,a)}return n}function Br(t){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?zr(Object(n),!0).forEach(function(a){Hp(t,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zr(Object(n)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))})}return t}function Lr(t,s){var n={};for(var a in t)n[a]=s(t[a],a);return n}var Up=(t,s,n)=>{for(var a of Object.keys(t)){var r;if(t[a]!==((r=s[a])!==null&&r!==void 0?r:n[a]))return!1}return!0},at=t=>{var s=n=>{var a=t.defaultClassName,r=Br(Br({},t.defaultVariants),n);for(var o in r){var c,i=(c=r[o])!==null&&c!==void 0?c:t.defaultVariants[o];if(i!=null){var d=i;typeof d=="boolean"&&(d=d===!0?"true":"false");var u=t.variantClassNames[o][d];u&&(a+=" "+u)}}for(var[m,f]of t.compoundVariants)Up(m,r,t.defaultVariants)&&(a+=" "+f);return a};return s.variants=()=>Object.keys(t.variantClassNames),s.classNames={get base(){return t.defaultClassName.split(" ")[0]},get variants(){return Lr(t.variantClassNames,n=>Lr(n,a=>a.split(" ")[0]))}},s},Jp=Object.defineProperty,Or=Object.getOwnPropertySymbols,Vp=Object.prototype.hasOwnProperty,Kp=Object.prototype.propertyIsEnumerable,Fr=(t,s,n)=>s in t?Jp(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,Gp=(t,s)=>{for(var n in s||(s={}))Vp.call(s,n)&&Fr(t,n,s[n]);if(Or)for(var n of Or(s))Kp.call(s,n)&&Fr(t,n,s[n]);return t};function Ea(){const[t,s]=l.useReducer(()=>!0,!1);return l.useEffect(()=>{s()},[]),t}function Et(){return Af()}function Ho(){const t=Et(),s=Ea();return Gp({},s?{"data-stackflow-activity-id":t?.id,"data-stackflow-activity-is-active":t?.isActive,"data-stackflow-activity-transition-state":t?.transitionState}:null)}function Uo(t,s,n){const a=()=>{s.forEach(r=>{t.removeEventListener(r,a)}),n()};s.forEach(r=>{t.addEventListener(r,a)})}var Qp=t=>(t(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}),Be=()=>{};function ta(t){requestAnimationFrame(()=>{requestAnimationFrame(()=>{t()})})}function Yp({outerRef:t,innerRef:s,enable:n}){const[a,r]=l.useState(void 0);return l.useEffect(()=>{const o=t&&"current"in t&&t.current,c=s.current;return!n||!o||!c?Be:Qp(()=>{const d=o.clientWidth,u=c.offsetLeft,m=c.clientWidth,f=d-u-m,h=Math.max(u,f);r(d-2*h)})}),{maxWidth:a}}function _a(t){const[s,n]=l.useState(void 0);return l.useEffect(()=>{ta(()=>{n(t)})},[t]),s}function Xp(){return If()}function Ma({ref:t}){const s=Xp();l.useEffect(()=>{if(!s)return;const n=t.current;if(!n||s.globalTransitionState==="idle")return;const a=r=>{r.preventDefault(),r.stopPropagation()};return n.addEventListener("touchstart",a,{capture:!0}),n.addEventListener("touchmove",a,{capture:!0}),n.addEventListener("touchend",a,{capture:!0}),n.addEventListener("touchcancel",a,{capture:!0}),()=>{n.removeEventListener("touchstart",a,{capture:!0}),n.removeEventListener("touchmove",a,{capture:!0}),n.removeEventListener("touchend",a,{capture:!0}),n.removeEventListener("touchcancel",a,{capture:!0})}},[s?.globalTransitionState])}var Yt={};function Ve({styleName:t,refs:s,effect:n,effectDeps:a}){const r=Et();l.useEffect(()=>r?(Yt[t]||(Yt[t]=new Map),Yt[t].set(r.zIndex,{refs:s,hasEffect:!!n}),()=>{Yt[t].delete(r.zIndex)}):Be,[r?.id,s,n]),l.useEffect(()=>{if(!r||!n)return Be;const o=(()=>{let i=[];for(let d=1;d<=r.zIndex;d+=1){const u=Yt[t].get(r.zIndex-d);if(u?.refs&&(i=[...i,...u.refs]),u?.hasEffect)break}return i})(),c=n({activityTransitionState:r.transitionState,refs:o});return()=>{c?.()}},[r?.transitionState,...a??[]])}function Zp({refs:t}){Ve({styleName:"hide",refs:t,effect:({activityTransitionState:s,refs:n})=>{const a=()=>{n.forEach(r=>{if(!r.current)return;const o=r.current;o.style.display=""})};return s==="enter-done"?(n.forEach(r=>{if(!r.current)return;const o=r.current;o.style.display="none"}),()=>{a()}):(a(),Be)}})}function eh({refs:t,transitionDuration:s,offsetStyles:n,hasEffect:a=!1}){Ve({styleName:"offset",refs:t,effect:a?({activityTransitionState:r,refs:o})=>{const c=()=>{ta(()=>{o.forEach(i=>{if(!i.current)return;const d=i.current;d.style.transform="",d.style.opacity="",Uo(d,["transitionend","transitioncancel"],()=>{d.style.transition=""})})})};switch(r){case"enter-active":case"enter-done":return o.forEach(i=>{i.current&&(i.current.style.transition=s,i.current.style.transform=n.transform,i.current.style.opacity=n.opacity)}),r==="enter-done"?()=>{c()}:Be;case"exit-active":case"exit-done":return ta(()=>{c()}),Be;default:return Be}}:void 0})}var Ss="--stackflow-swipe-back-ratio";function th({dimRef:t,edgeRef:s,paperRef:n,appBarRef:a,offset:r,transitionDuration:o,preventSwipeBack:c,moveAppBarTogether:i,getActivityTransitionState:d,onSwipeStart:u,onSwipeMove:m,onSwipeEnd:f,onTransitionEnd:h}){Ve({styleName:"swipe-back",refs:i&&a?[n,a]:[n],effect:({refs:g})=>{if(c||!t.current||!s.current||!n.current)return Be;const v=t.current,p=s.current,b=n.current,y=a?.current;let x=null,j=null,N=null,w=[];const S=()=>{x=null,j=null,N=null,w=[]};let C=!1;function T({dx:A,ratio:R}){C||(C=!0,requestAnimationFrame(()=>{v.style.opacity=`${1-R}`,v.style.transition="0s",b.style.overflowY="hidden",b.style.transform=`translate3d(${A}px, 0, 0)`,b.style.transition="0s",i&&y&&(y.style.overflowY="hidden",y.style.transform=`translate3d(${A}px, 0, 0)`,y.style.transition="0s"),y?.style.setProperty(Ss,String(R)),g.forEach(E=>{var B,P;E.current&&(E.current.style.transform=`translate3d(${-1*(1-R)*r}px, 0, 0)`,E.current.style.transition="0s",((B=E.current.parentElement)==null?void 0:B.style.display)==="none"&&(E.current.parentElement.style.display="block"),(P=E.current.parentElement)==null||P.style.setProperty(Ss,String(R)))}),C=!1}))}function k({swiped:A}){return new Promise(R=>{requestAnimationFrame(()=>{v.style.opacity=`${A?0:1}`,v.style.transition=o,b.style.overflowY="hidden",b.style.transform=`translateX(${A?"100%":"0"})`,b.style.transition=o,i&&y&&(y.style.overflowY="hidden",y.style.transform=`translateX(${A?"100%":"0"})`,y.style.transition=o),g.forEach(B=>{B.current&&(B.current.style.transition=o,B.current.style.transform=`translate3d(${A?"0":`-${r/16}rem`}, 0, 0)`)});const E=[...w];R(),Uo(b,["transitionend","transitioncancel"],()=>{const B=A||d()==="exit-active"||d()==="exit-done";v.style.opacity="",b.style.overflowY="",b.style.transform="",i&&y&&(y.style.overflowY="",y.style.transform="",y.style.removeProperty("transition")),y?.style.removeProperty(Ss),g.forEach((P,z)=>{var q;if(!P.current)return;const K=E[z];B?(P.current.style.transition="",P.current.style.transform="",P.current.parentElement&&(P.current.parentElement.style.display="")):K&&(P.current.style.transition=K.style.transition,P.current.style.transform=K.style.transform,P.current.parentElement&&K.parentElement&&(P.current.parentElement.style.display=K.parentElement.style.display)),(q=P.current.parentElement)==null||q.style.removeProperty(Ss)}),h?.({swiped:A})})})})}const I=A=>{var R;const{activeElement:E}=document;(R=E?.blur)==null||R.call(E),x=N=A.touches[0].clientX,j=Date.now(),w=g.map(B=>B.current?{style:{transform:B.current.style.transform,transition:B.current.style.transition},parentElement:B.current.parentElement?{style:{display:B.current.parentElement.style.display}}:void 0}:{style:{transform:"",transition:""}}),u?.()},D=A=>{if(!x){S();return}N=A.touches[0].clientX;const R=N-x,E=R/b.clientWidth;T({dx:R,ratio:E}),m?.({dx:R,ratio:E})},_=()=>{if(!x||!j||!N){S();return}const A=Date.now(),E=(N-x)/(A-j)>1||N/b.clientWidth>.4;f?.({swiped:E}),Promise.resolve().then(()=>k({swiped:E})).then(()=>S())};return p.addEventListener("touchstart",I,{passive:!0}),p.addEventListener("touchmove",D,{passive:!0}),p.addEventListener("touchend",_,{passive:!0}),p.addEventListener("touchcancel",_,{passive:!0}),()=>{p.removeEventListener("touchstart",I),p.removeEventListener("touchmove",D),p.removeEventListener("touchend",_),p.removeEventListener("touchcancel",_)}},effectDeps:[c]})}function cs(){var t;const s=Et();return((t=s?.zIndex)!=null?t:0)*5}var sh=Object.defineProperty,nh=Object.defineProperties,ah=Object.getOwnPropertyDescriptors,Wr=Object.getOwnPropertySymbols,rh=Object.prototype.hasOwnProperty,ih=Object.prototype.propertyIsEnumerable,$r=(t,s,n)=>s in t?sh(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,dt=(t,s)=>{for(var n in s||(s={}))rh.call(s,n)&&$r(t,n,s[n]);if(Wr)for(var n of Wr(s))ih.call(s,n)&&$r(t,n,s[n]);return t},ns=(t,s)=>nh(t,ah(s)),oh=t=>e.jsx("svg",{className:t.className,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.7241 2.76052C17.105 3.16043 17.0896 3.79341 16.6897 4.17431L8.45 12.0222L16.6896 19.8689C17.0896 20.2498 17.105 20.8827 16.7242 21.2827C16.3433 21.6826 15.7103 21.6981 15.3104 21.3172L6.31037 12.7464C6.11218 12.5576 6.00001 12.2959 6 12.0222C5.99999 11.7486 6.11215 11.4868 6.31032 11.2981L15.3103 2.72608C15.7102 2.34518 16.3432 2.3606 16.7241 2.76052Z",fill:"currentColor"})}),qr=oh,ch=t=>e.jsx("svg",{className:t.className,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M20.7071 4.70711C21.0976 4.31658 21.0976 3.68342 20.7071 3.29289C20.3166 2.90237 19.6834 2.90237 19.2929 3.29289L12 10.5858L4.70711 3.29289C4.31658 2.90237 3.68342 2.90237 3.29289 3.29289C2.90237 3.68342 2.90237 4.31658 3.29289 4.70711L10.5858 12L3.29289 19.2929C2.90237 19.6834 2.90237 20.3166 3.29289 20.7071C3.68342 21.0976 4.31658 21.0976 4.70711 20.7071L12 13.4142L19.2929 20.7071C19.6834 21.0976 20.3166 21.0976 20.7071 20.7071C21.0976 20.3166 21.0976 19.6834 20.7071 19.2929L13.4142 12L20.7071 4.70711Z",fill:"currentColor"})}),Hr=ch,F={backgroundColor:"var(--stackflow-plugin-basic-ui-background-color)",backgroundImage:"var(--stackflow-plugin-basic-ui-background-image)",dimBackgroundColor:"var(--stackflow-plugin-basic-ui-dim-background-color)",dimHeight:"var(--stackflow-plugin-basic-ui-dim-height)",transitionDuration:"var(--stackflow-plugin-basic-ui-transition-duration)",computedTransitionDuration:"var(--stackflow-plugin-basic-ui-computed-transition-duration)",defaultTransitionOffSet:"var(--stackflow-plugin-basic-ui-default-transition-off-set)",appBar:{borderColor:"var(--stackflow-plugin-basic-ui-app-bar-border-color)",borderColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-border-color-transition-duration)",borderSize:"var(--stackflow-plugin-basic-ui-app-bar-border-size)",height:"var(--stackflow-plugin-basic-ui-app-bar-height)",heightTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-height-transition-duration)",minHeight:"var(--stackflow-plugin-basic-ui-app-bar-min-height)",iconColor:"var(--stackflow-plugin-basic-ui-app-bar-icon-color)",iconColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-icon-color-transition-duration)",textColor:"var(--stackflow-plugin-basic-ui-app-bar-text-color)",textColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-text-color-transition-duration)",backgroundColor:"var(--stackflow-plugin-basic-ui-app-bar-background-color)",backgroundColorTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-background-color-transition-duration)",backgroundImage:"var(--stackflow-plugin-basic-ui-app-bar-background-image)",backgroundImageTransitionDuration:"var(--stackflow-plugin-basic-ui-app-bar-background-image-transition-duration)",overflow:"var(--stackflow-plugin-basic-ui-app-bar-overflow)",minSafeAreaInsetTop:"var(--stackflow-plugin-basic-ui-app-bar-min-safe-area-inset-top)",containerPadding:"var(--stackflow-plugin-basic-ui-app-bar-container-padding)",itemGap:"var(--stackflow-plugin-basic-ui-app-bar-item-gap)",fontSize:"var(--stackflow-plugin-basic-ui-app-bar-font-size)",lineHeight:"var(--stackflow-plugin-basic-ui-app-bar-line-height)",hitSlop:"var(--stackflow-plugin-basic-ui-app-bar-hit-slop)"},bottomSheet:{borderRadius:"var(--stackflow-plugin-basic-ui-bottom-sheet-border-radius)"},modal:{borderRadius:"var(--stackflow-plugin-basic-ui-modal-border-radius)",maxWidth:"var(--stackflow-plugin-basic-ui-modal-max-width)"},edge:{width:"var(--stackflow-plugin-basic-ui-edge-width)"}},lh=at({defaultClassName:"_1q6dj2j2",variantClassNames:{theme:{android:"_1q6dj2j0",cupertino:"_1q6dj2j1"}},defaultVariants:{},compoundVariants:[]});function dh(t){return t.filter(s=>s!=null)}function Ns(t){return Object.entries(t).reduce((s,[n,a])=>(a!=null&&(s[n]=a),s),{})}var Jo=l.createContext({theme:"android"}),uh=Jo.Provider;function Vo(){return l.useContext(Jo)}var mh=t=>()=>({key:"basic-ui",wrapStack({stack:s,initialContext:n}){var a,r,o,c,i,d,u,m,f,h,g,v,p,b,y,x,j;const N=typeof t=="function"?t({initialContext:n}):t;return e.jsx(uh,{value:ns(dt({},N),{theme:(a=n?.theme)!=null?a:N.theme}),children:e.jsx("div",{className:dh([lh({theme:(r=n?.theme)!=null?r:N.theme}),N.rootClassName]).join(" "),style:js(Ns({[F.backgroundColor]:N.backgroundColor,[F.backgroundImage]:N.backgroundImage,[F.dimBackgroundColor]:N.dimBackgroundColor,[F.dimHeight]:N.dimHeight,[F.transitionDuration]:`${s.transitionDuration}ms`,[F.computedTransitionDuration]:s.globalTransitionState==="loading"?`${s.transitionDuration}ms`:"0ms",[F.defaultTransitionOffSet]:N.defaultTransitionOffSet,[F.appBar.borderColor]:(o=N.appBar)==null?void 0:o.borderColor,[F.appBar.borderSize]:(c=N.appBar)==null?void 0:c.borderSize,[F.appBar.height]:(i=N.appBar)==null?void 0:i.height,[F.appBar.minHeight]:(d=N.appBar)==null?void 0:d.minHeight,[F.appBar.iconColor]:(u=N.appBar)==null?void 0:u.iconColor,[F.appBar.textColor]:(m=N.appBar)==null?void 0:m.textColor,[F.appBar.minSafeAreaInsetTop]:(f=N.appBar)==null?void 0:f.minSafeAreaInsetTop,[F.bottomSheet.borderRadius]:(h=N.bottomSheet)==null?void 0:h.borderRadius,[F.modal.borderRadius]:(g=N.modal)==null?void 0:g.borderRadius,[F.appBar.containerPadding]:(v=N.appBar)==null?void 0:v.containerPadding,[F.appBar.fontSize]:(p=N.appBar)==null?void 0:p.fontSize,[F.appBar.lineHeight]:(b=N.appBar)==null?void 0:b.lineHeight,[F.appBar.hitSlop]:(y=N.appBar)==null?void 0:y.hitSlop,[F.appBar.itemGap]:(x=N.appBar)==null?void 0:x.itemGap,[F.edge.width]:(j=N.edge)==null?void 0:j.width})),children:s.render()})})}}),fh=at({defaultClassName:"_1yk3a452 dhthxq4 dhthxq0 dhthxqh _1yk3a451",variantClassNames:{activityEnterStyle:{slideInLeft:"_1yk3a453"},enterStyle:{cover:"_1yk3a454"},border:{true:"_1yk3a455"},modalPresentationStyle:{fullScreen:"_1yk3a456"}},defaultVariants:{},compoundVariants:[[{activityEnterStyle:"slideInLeft",enterStyle:"cover"},"_1yk3a457"]]}),Ur="_1yk3a45b dhthxq9 dhthxq7 dhthxqb dhthxqf dhthxqi",ph="dhthxq9 dhthxq7 dhthxq8 _1yk3a450",hh="_1yk3a45e",xh="_1yk3a45f dhthxqi dhthxq4 dhthxq2 dhthxqf",gh="_1yk3a45g dhthxqc dhthxqd dhthxq0",vh="_1yk3a45b dhthxq9 dhthxq7 dhthxqb dhthxqf dhthxqi",bh="_1yk3a459 dhthxqa dhthxq7 _1yk3a451",yh="_1yk3a45a dhthxq9 dhthxq7 dhthxq1 _1yk3a450",jh="_1yk3a45h dhthxq9 dhthxq7 dhthxq1 dhthxq5 _1yk3a450",Nh="_1yk3a458",wh=at({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_1dlf434a","enter-done":"_1dlf434b","exit-active":"_1dlf434c","exit-done":"_1dlf434d"},hasAppBar:{true:"_1dlf434j"}},defaultVariants:{},compoundVariants:[]}),Ch="_1dlf434k dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 _1dlf4347 _1dlf4349",Sh=at({defaultClassName:"_1dlf434r dhthxq4 dhthxq2 dhthxq3 dhthxq1",variantClassNames:{hasAppBar:{true:"_1dlf434s"}},defaultVariants:{},compoundVariants:[]}),kh="_1dlf434a",Ah="_1dlf434b",Th="_1dlf434c",Ih="_1dlf434d",Ph=at({defaultClassName:"_1dlf434l dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 _1dlf4348 _1dlf4349",variantClassNames:{hasAppBar:{true:"_1dlf434m dhthxqg"},modalPresentationStyle:{fullScreen:"_1dlf434n"},activityEnterStyle:{slideInLeft:"_1dlf434o"}},defaultVariants:{},compoundVariants:[]}),Eh=at({defaultClassName:"_1dlf434p dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3",variantClassNames:{hasAppBar:{true:"_1dlf434q"}},defaultVariants:{},compoundVariants:[]}),Dt={transitionDuration:"var(--_1dlf4340)",zIndexes:{dim:"var(--_1dlf4341)",paper:"var(--_1dlf4342)",edge:"var(--_1dlf4343)",appBar:"var(--_1dlf4344)"},appBar:{center:{mainWidth:"var(--_1dlf4346)"}}},Ko=l.forwardRef(({title:t,renderLeft:s,renderRight:n,backButton:a,closeButton:r,closeButtonLocation:o="left",border:c=!0,modalPresentationStyle:i,activityEnterStyle:d,iconColor:u,iconColorTransitionDuration:m,textColor:f,textColorTransitionDuration:h,borderColor:g,borderColorTransitionDuration:v,borderSize:p,height:b,heightTransitionDuration:y,overflow:x,backgroundColor:j,backgroundColorTransitionDuration:N,backgroundImage:w,backgroundImageTransitionDuration:S,onTopClick:C,enterStyle:T,className:k,minHeight:I,fontSize:D,lineHeight:_,hitSlop:A,containerPadding:R,itemGap:E},B)=>{var P,z;const q=ys(),K=Et(),oe=Ho();Ea();const Y=Vo(),J=(P=Y.appBar)==null?void 0:P.closeButton,G=(z=Y.appBar)==null?void 0:z.backButton,re=l.useRef(null),{maxWidth:je}=Yp({outerRef:B,innerRef:re,enable:Y.theme==="cupertino"}),Ge=(Y.theme==="cupertino"&&i!=="fullScreen"||d==="slideInLeft")&&T!=="cover",_t=X=>{a&&"onClick"in a&&a.onClick&&a.onClick(X),X.defaultPrevented||q.pop()},he=()=>{var X,ue;return!K||K.isRoot?null:!a&&!G?e.jsx("button",{type:"button","aria-label":"Go Back",className:Ur,onClick:_t,children:e.jsx(qr,{})}):a&&"render"in a&&a.render?(X=a.render)==null?void 0:X.call(a):G&&"render"in G&&G.render?(ue=G.render)==null?void 0:ue.call(G):e.jsx("button",{type:"button",className:Ur,"aria-label":a&&"ariaLabel"in a?a.ariaLabel:G&&"ariaLabel"in G?G.ariaLabel:void 0,onClick:_t,children:a&&"renderIcon"in a&&a.renderIcon?a.renderIcon():G&&"renderIcon"in G&&G.renderIcon?G.renderIcon():i==="fullScreen"?e.jsx(Hr,{}):e.jsx(qr,{})})},O=X=>{var ue;r&&"onClick"in r&&r.onClick&&r.onClick(X),!X.defaultPrevented&&J&&"onClick"in J&&((ue=J.onClick)==null||ue.call(J,X))},te=()=>{var X;const ue=!K||K.isRoot,we=xe=>xe&&"render"in xe&&xe.render||xe&&"renderIcon"in xe&&xe.renderIcon||xe&&"onClick"in xe&&xe.onClick;return!(we(r)||we((X=Y.appBar)==null?void 0:X.closeButton))||!ue?null:r&&"render"in r&&r.render?r.render():J&&"render"in J&&J.render?J.render():e.jsx("button",{type:"button",className:vh,"aria-label":r&&"ariaLabel"in r?r.ariaLabel:J&&"ariaLabel"in J?J.ariaLabel:void 0,onClick:O,children:r&&"renderIcon"in r&&r.renderIcon?r.renderIcon():J&&"renderIcon"in J&&J.renderIcon?J.renderIcon():e.jsx(Hr,{})})};return e.jsxs("div",ns(dt({ref:B,className:xn(fh({border:c,modalPresentationStyle:i,activityEnterStyle:d,enterStyle:T}),k),style:js(Ns({[F.appBar.iconColor]:u,[F.appBar.iconColorTransitionDuration]:m,[F.appBar.textColor]:f,[F.appBar.textColorTransitionDuration]:h,[F.appBar.borderColor]:g,[F.appBar.borderColorTransitionDuration]:v,[F.appBar.borderSize]:p,[F.appBar.height]:b,[F.appBar.heightTransitionDuration]:y,[F.appBar.overflow]:x,[F.appBar.backgroundColor]:j??(Ge?F.backgroundColor:"transparent"),[F.appBar.backgroundColorTransitionDuration]:N,[F.appBar.backgroundImage]:w??(Ge?F.appBar.backgroundImage:"none"),[F.appBar.backgroundImageTransitionDuration]:S,[Dt.appBar.center.mainWidth]:`${je}px`,[F.appBar.minHeight]:I,[F.appBar.containerPadding]:R,[F.appBar.fontSize]:D,[F.appBar.hitSlop]:A,[F.appBar.lineHeight]:_,[F.appBar.itemGap]:E})),"data-part":"appBar"},oe),{children:[e.jsx("div",{className:Nh}),e.jsxs("div",{className:bh,children:[e.jsxs("div",{className:yh,children:[o==="left"&&te(),he(),s?.()]}),e.jsx("div",{ref:re,className:ph,children:e.jsxs("div",{className:hh,children:[typeof t=="string"?e.jsx("div",{className:gh,children:t}):t,e.jsx("button",{className:xh,type:"button",onClick:C})]})}),e.jsxs("div",{className:jh,children:[n?.(),o==="right"&&te()]})]})]}))});Ko.displayName="AppBar";var _h=Ko,Mh=32,Jr=80,Rh=l.createContext(null),Dh=({backgroundColor:t,backgroundImage:s,dimBackgroundColor:n,appBar:a,preventSwipeBack:r,CUPERTINO_ONLY_modalPresentationStyle:o,ANDROID_ONLY_activityEnterStyle:c,className:i,children:d})=>{var u;const m=Vo(),f=Et(),h=Ho();Ea();const{pop:g}=ys(),v=l.useRef(null),p=l.useRef(null),b=l.useRef(null),y=l.useRef(null),x=l.useRef(null),j=l.useRef(null),N=m.theme==="cupertino"?o:void 0,w=m.theme==="android"?c:void 0,S=r||N==="fullScreen",C=!!a,T=cs();let k,I,D,_;m.theme==="cupertino"?(k=T+(N==="fullScreen"?2:0),I=T+(C&&N!=="fullScreen"?a.enterStyle==="cover"?2:1:3),D=T+4,_=T+7):(k=T,I=T+(w==="slideInLeft"&&a?.enterStyle!=="cover"?0:2),D=T+4,_=T+(w==="slideInLeft"?6:4));const A=(u=f?.transitionState)!=null?u:"enter-done",R=_a(A);Zp({refs:[v]}),eh({refs:(m.theme==="cupertino"||w==="slideInLeft")&&a?.enterStyle!=="cover"?[b]:[b,x],offsetStyles:m.theme==="cupertino"?{transform:`translate3d(-${Jr/16}rem, 0, 0)`,opacity:"1"}:w==="slideInLeft"?{transform:"translate3d(-50%, 0, 0)",opacity:"0"}:{transform:`translate3d(0, -${Mh/16}rem, 0)`,opacity:"1"},transitionDuration:F.computedTransitionDuration,hasEffect:N!=="fullScreen"}),th({dimRef:p,edgeRef:y,paperRef:b,appBarRef:x,offset:Jr,transitionDuration:F.transitionDuration,moveAppBarTogether:a?.enterStyle==="cover",preventSwipeBack:S||m.theme!=="cupertino",getActivityTransitionState(){const B=b.current,P=B?.parentElement;return P?P.classList.contains(kh)?"enter-active":P.classList.contains(Ah)?"enter-done":P.classList.contains(Th)?"exit-active":P.classList.contains(Ih)?"exit-done":null:null},onSwipeEnd({swiped:B}){B&&g()}});const E=B=>{var P,z;(P=a?.onTopClick)==null||P.call(a,B),B.defaultPrevented||(z=j.current)==null||z.scroll({top:0,behavior:"smooth"})};return Ma({ref:v}),e.jsx(Rh.Provider,{value:l.useMemo(()=>({scroll({top:B}){var P;(P=j?.current)==null||P.scroll({top:B,behavior:"smooth"})},zIndices:{dim:k,paper:I,edge:D,appBar:_}}),[j,k,I,D,_]),children:e.jsxs("div",ns(dt({ref:v,className:xn(wh({hasAppBar:C,transitionState:A==="enter-done"||A==="exit-done"?A:R}),i),style:js(Ns({[F.backgroundColor]:t,[F.backgroundImage]:s,[F.dimBackgroundColor]:n,[F.appBar.height]:a?.height,[F.appBar.heightTransitionDuration]:a?.heightTransitionDuration,[Dt.zIndexes.dim]:`${k}`,[Dt.zIndexes.paper]:`${I}`,[Dt.zIndexes.edge]:`${D}`,[Dt.zIndexes.appBar]:`${_}`,[Dt.transitionDuration]:A==="enter-active"||A==="exit-active"?F.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"AppScreen"},h),{children:[w!=="slideInLeft"&&e.jsx("div",dt({ref:p,className:Ch,"data-part":"dim"},h)),a&&e.jsx(_h,ns(dt({},a),{ref:x,modalPresentationStyle:N,activityEnterStyle:w,onTopClick:E})),e.jsx("div",ns(dt({ref:b,className:Ph({hasAppBar:C,modalPresentationStyle:N,activityEnterStyle:w}),"data-part":"paper"},h),{children:e.jsx("div",{ref:j,className:Eh({hasAppBar:C}),children:d})}),f?.id),!f?.isRoot&&m.theme==="cupertino"&&!S&&e.jsx("div",dt({ref:y,className:Sh({hasAppBar:C}),"data-part":"edge"},h))]}))})},Q=Dh,zh=at({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_1ht38h04","enter-done":"_1ht38h05","exit-active":"_1ht38h06","exit-done":"_1ht38h07"}},defaultVariants:{},compoundVariants:[]}),Bh="_1ht38h0d dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc dhthxqa dhthxq7 _1ht38h03",Lh="_1ht38h0e dhthxqc _1ht38h03",Fn={transitionDuration:"var(--_1ht38h00)",zIndexes:{dim:"var(--_1ht38h01)",paper:"var(--_1ht38h02)"}},Go=({borderRadius:t="1rem",backgroundColor:s,backgroundImage:n,dimBackgroundColor:a,paperRef:r,onOutsideClick:o,children:c,className:i})=>{var d;const u=Et(),{pop:m}=ys(),f=l.useRef(null),h=l.useRef(null);Ve({styleName:"hide",refs:[f]}),Ve({styleName:"offset",refs:[h]}),Ve({styleName:"swipe-back",refs:[h]});const g=l.useRef(!1),v=j=>{o?.(j),!j.defaultPrevented&&(g.current||(g.current=!0,m()))},p=j=>{j.stopPropagation()},b=cs()+3,y=cs()+4,x=(d=u?.transitionState)!=null?d:"enter-done";return Ma({ref:f}),e.jsx("div",{className:xn(zh({transitionState:_a(x)}),i),ref:f,style:js(Ns({[F.bottomSheet.borderRadius]:t,[F.backgroundColor]:s,[F.backgroundImage]:n,[F.dimBackgroundColor]:a,[Fn.zIndexes.dim]:`${b}`,[Fn.zIndexes.paper]:`${y}`,[Fn.transitionDuration]:x==="enter-active"||x==="exit-active"?F.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"BottomSheet","data-stackflow-activity-id":u?.id,"data-stackflow-activity-is-active":u?.isActive,children:e.jsx("div",{className:Bh,ref:h,onClick:v,children:e.jsx("div",{className:Lh,ref:r,onClick:p,children:c})})})};Go.displayName="BottomSheet";var Oh=Go,Fh=at({defaultClassName:"dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc",variantClassNames:{transitionState:{"enter-active":"_5ozg8c4","enter-done":"_5ozg8c5","exit-active":"_5ozg8c6","exit-done":"_5ozg8c7"}},defaultVariants:{},compoundVariants:[]}),Wh="_5ozg8cd dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc dhthxq9 dhthxq7 dhthxqb _5ozg8c3",$h="_5ozg8ce dhthxqc _5ozg8c3",Wn={transitionDuration:"var(--_5ozg8c0)",zIndexes:{dim:"var(--_5ozg8c1)",paper:"var(--_5ozg8c2)"}},Qo=({backgroundColor:t,backgroundImage:s,dimBackgroundColor:n,borderRadius:a="1rem",maxWidth:r,onOutsideClick:o,children:c,className:i})=>{var d;const u=Et(),{pop:m}=ys(),f=l.useRef(null),h=l.useRef(null);Ve({styleName:"hide",refs:[f]}),Ve({styleName:"offset",refs:[h]}),Ve({styleName:"swipe-back",refs:[h]});const g=l.useRef(!1),v=j=>{o?.(j),!j.defaultPrevented&&(g.current||(g.current=!0,m()))},p=j=>{j.stopPropagation()},b=cs()+3,y=cs()+4,x=(d=u?.transitionState)!=null?d:"enter-done";return Ma({ref:f}),e.jsx("div",{className:xn(Fh({transitionState:_a(x)}),i),ref:f,style:js(Ns({[F.backgroundColor]:t,[F.backgroundImage]:s,[F.dimBackgroundColor]:n,[F.modal.borderRadius]:a,[F.modal.maxWidth]:r,[Wn.zIndexes.dim]:`${b}`,[Wn.zIndexes.paper]:`${y}`,[Wn.transitionDuration]:x==="enter-active"||x==="exit-active"?F.computedTransitionDuration:"0ms"})),"data-stackflow-component-name":"Modal","data-stackflow-activity-id":u?.id,"data-stackflow-activity-is-active":u?.isActive,children:e.jsx("div",{className:Wh,ref:h,onClick:v,children:e.jsx("div",{className:$h,onClick:p,children:c})})})};Qo.displayName="Modal";var qh=Qo,Hh=Object.defineProperty,U=(t,s)=>Hh(t,"name",{value:s,configurable:!0}),Ot=class{type=3;name="";prefix="";value="";suffix="";modifier=3;constructor(t,s,n,a,r,o){this.type=t,this.name=s,this.prefix=n,this.value=a,this.suffix=r,this.modifier=o}hasCustomName(){return this.name!==""&&typeof this.name!="number"}};U(Ot,"Part");var Uh=/[$_\p{ID_Start}]/u,Jh=/[$_\u200C\u200D\p{ID_Continue}]/u,sa=".*";function Yo(t,s){return(s?/^[\x00-\xFF]*$/:/^[\x00-\x7F]*$/).test(t)}U(Yo,"isASCII");function Ra(t,s=!1){let n=[],a=0;for(;a<t.length;){let r=t[a],o=U(function(c){if(!s)throw new TypeError(c);n.push({type:"INVALID_CHAR",index:a,value:t[a++]})},"ErrorOrInvalid");if(r==="*"){n.push({type:"ASTERISK",index:a,value:t[a++]});continue}if(r==="+"||r==="?"){n.push({type:"OTHER_MODIFIER",index:a,value:t[a++]});continue}if(r==="\\"){n.push({type:"ESCAPED_CHAR",index:a++,value:t[a++]});continue}if(r==="{"){n.push({type:"OPEN",index:a,value:t[a++]});continue}if(r==="}"){n.push({type:"CLOSE",index:a,value:t[a++]});continue}if(r===":"){let c="",i=a+1;for(;i<t.length;){let d=t.substr(i,1);if(i===a+1&&Uh.test(d)||i!==a+1&&Jh.test(d)){c+=t[i++];continue}break}if(!c){o(`Missing parameter name at ${a}`);continue}n.push({type:"NAME",index:a,value:c}),a=i;continue}if(r==="("){let c=1,i="",d=a+1,u=!1;if(t[d]==="?"){o(`Pattern cannot start with "?" at ${d}`);continue}for(;d<t.length;){if(!Yo(t[d],!1)){o(`Invalid character '${t[d]}' at ${d}.`),u=!0;break}if(t[d]==="\\"){i+=t[d++]+t[d++];continue}if(t[d]===")"){if(c--,c===0){d++;break}}else if(t[d]==="("&&(c++,t[d+1]!=="?")){o(`Capturing groups are not allowed at ${d}`),u=!0;break}i+=t[d++]}if(u)continue;if(c){o(`Unbalanced pattern at ${a}`);continue}if(!i){o(`Missing pattern at ${a}`);continue}n.push({type:"REGEX",index:a,value:i}),a=d;continue}n.push({type:"CHAR",index:a,value:t[a++]})}return n.push({type:"END",index:a,value:""}),n}U(Ra,"lexer");function Da(t,s={}){let n=Ra(t);s.delimiter??="/#?",s.prefixes??="./";let a=`[^${Ne(s.delimiter)}]+?`,r=[],o=0,c=0,i=new Set,d=U(x=>{if(c<n.length&&n[c].type===x)return n[c++].value},"tryConsume"),u=U(()=>d("OTHER_MODIFIER")??d("ASTERISK"),"tryConsumeModifier"),m=U(x=>{let j=d(x);if(j!==void 0)return j;let{type:N,index:w}=n[c];throw new TypeError(`Unexpected ${N} at ${w}, expected ${x}`)},"mustConsume"),f=U(()=>{let x="",j;for(;j=d("CHAR")??d("ESCAPED_CHAR");)x+=j;return x},"consumeText"),h=U(x=>x,"DefaultEncodePart"),g=s.encodePart||h,v="",p=U(x=>{v+=x},"appendToPendingFixedValue"),b=U(()=>{v.length&&(r.push(new Ot(3,"","",g(v),"",3)),v="")},"maybeAddPartFromPendingFixedValue"),y=U((x,j,N,w,S)=>{let C=3;switch(S){case"?":C=1;break;case"*":C=0;break;case"+":C=2;break}if(!j&&!N&&C===3){p(x);return}if(b(),!j&&!N){if(!x)return;r.push(new Ot(3,"","",g(x),"",C));return}let T;N?N==="*"?T=sa:T=N:T=a;let k=2;T===a?(k=1,T=""):T===sa&&(k=0,T="");let I;if(j?I=j:N&&(I=o++),i.has(I))throw new TypeError(`Duplicate name '${I}'.`);i.add(I),r.push(new Ot(k,I,g(x),T,g(w),C))},"addPart");for(;c<n.length;){let x=d("CHAR"),j=d("NAME"),N=d("REGEX");if(!j&&!N&&(N=d("ASTERISK")),j||N){let S=x??"";s.prefixes.indexOf(S)===-1&&(p(S),S=""),b();let C=u();y(S,j,N,"",C);continue}let w=x??d("ESCAPED_CHAR");if(w){p(w);continue}if(d("OPEN")){let S=f(),C=d("NAME"),T=d("REGEX");!C&&!T&&(T=d("ASTERISK"));let k=f();m("CLOSE");let I=u();y(S,C,T,k,I);continue}b(),m("END")}return r}U(Da,"parse");function Ne(t){return t.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}U(Ne,"escapeString");function na(t){return t&&t.ignoreCase?"ui":"u"}U(na,"flags");function Xo(t,s,n){return za(Da(t,n),s,n)}U(Xo,"stringToRegexp");function ft(t){switch(t){case 0:return"*";case 1:return"?";case 2:return"+";case 3:return""}}U(ft,"modifierToString");function za(t,s,n={}){n.delimiter??="/#?",n.prefixes??="./",n.sensitive??=!1,n.strict??=!1,n.end??=!0,n.start??=!0,n.endsWith="";let a=n.start?"^":"";for(let i of t){if(i.type===3){i.modifier===3?a+=Ne(i.value):a+=`(?:${Ne(i.value)})${ft(i.modifier)}`;continue}s&&s.push(i.name);let d=`[^${Ne(n.delimiter)}]+?`,u=i.value;if(i.type===1?u=d:i.type===0&&(u=sa),!i.prefix.length&&!i.suffix.length){i.modifier===3||i.modifier===1?a+=`(${u})${ft(i.modifier)}`:a+=`((?:${u})${ft(i.modifier)})`;continue}if(i.modifier===3||i.modifier===1){a+=`(?:${Ne(i.prefix)}(${u})${Ne(i.suffix)})`,a+=ft(i.modifier);continue}a+=`(?:${Ne(i.prefix)}`,a+=`((?:${u})(?:`,a+=Ne(i.suffix),a+=Ne(i.prefix),a+=`(?:${u}))*)${Ne(i.suffix)})`,i.modifier===0&&(a+="?")}let r=`[${Ne(n.endsWith)}]|$`,o=`[${Ne(n.delimiter)}]`;if(n.end)return n.strict||(a+=`${o}?`),n.endsWith.length?a+=`(?=${r})`:a+="$",new RegExp(a,na(n));n.strict||(a+=`(?:${o}(?=${r}))?`);let c=!1;if(t.length){let i=t[t.length-1];i.type===3&&i.modifier===3&&(c=n.delimiter.indexOf(i)>-1)}return c||(a+=`(?=${o}|${r})`),new RegExp(a,na(n))}U(za,"partsToRegexp");var et={delimiter:"",prefixes:"",sensitive:!0,strict:!0},Vh={delimiter:".",prefixes:"",sensitive:!0,strict:!0},Kh={delimiter:"/",prefixes:"/",sensitive:!0,strict:!0};function Zo(t,s){return t.length?t[0]==="/"?!0:!s||t.length<2?!1:(t[0]=="\\"||t[0]=="{")&&t[1]=="/":!1}U(Zo,"isAbsolutePathname");function Ba(t,s){return t.startsWith(s)?t.substring(s.length,t.length):t}U(Ba,"maybeStripPrefix");function ec(t,s){return t.endsWith(s)?t.substr(0,t.length-s.length):t}U(ec,"maybeStripSuffix");function La(t){return!t||t.length<2?!1:t[0]==="["||(t[0]==="\\"||t[0]==="{")&&t[1]==="["}U(La,"treatAsIPv6Hostname");var tc=["ftp","file","http","https","ws","wss"];function Oa(t){if(!t)return!0;for(let s of tc)if(t.test(s))return!0;return!1}U(Oa,"isSpecialScheme");function sc(t,s){if(t=Ba(t,"#"),s||t==="")return t;let n=new URL("https://example.com");return n.hash=t,n.hash?n.hash.substring(1,n.hash.length):""}U(sc,"canonicalizeHash");function nc(t,s){if(t=Ba(t,"?"),s||t==="")return t;let n=new URL("https://example.com");return n.search=t,n.search?n.search.substring(1,n.search.length):""}U(nc,"canonicalizeSearch");function ac(t,s){return s||t===""?t:La(t)?$a(t):Wa(t)}U(ac,"canonicalizeHostname");function rc(t,s){if(s||t==="")return t;let n=new URL("https://example.com");return n.password=t,n.password}U(rc,"canonicalizePassword");function ic(t,s){if(s||t==="")return t;let n=new URL("https://example.com");return n.username=t,n.username}U(ic,"canonicalizeUsername");function oc(t,s,n){if(n||t==="")return t;if(s&&!tc.includes(s))return new URL(`${s}:${t}`).pathname;let a=t[0]=="/";return t=new URL(a?t:"/-"+t,"https://example.com").pathname,a||(t=t.substring(2,t.length)),t}U(oc,"canonicalizePathname");function cc(t,s,n){return Fa(s)===t&&(t=""),n||t===""?t:qa(t)}U(cc,"canonicalizePort");function lc(t,s){return t=ec(t,":"),s||t===""?t:An(t)}U(lc,"canonicalizeProtocol");function Fa(t){switch(t){case"ws":case"http":return"80";case"wws":case"https":return"443";case"ftp":return"21";default:return""}}U(Fa,"defaultPortForProtocol");function An(t){if(t==="")return t;if(/^[-+.A-Za-z0-9]*$/.test(t))return t.toLowerCase();throw new TypeError(`Invalid protocol '${t}'.`)}U(An,"protocolEncodeCallback");function dc(t){if(t==="")return t;let s=new URL("https://example.com");return s.username=t,s.username}U(dc,"usernameEncodeCallback");function uc(t){if(t==="")return t;let s=new URL("https://example.com");return s.password=t,s.password}U(uc,"passwordEncodeCallback");function Wa(t){if(t==="")return t;if(/[\t\n\r #%/:<>?@[\]^\\|]/g.test(t))throw new TypeError(`Invalid hostname '${t}'`);let s=new URL("https://example.com");return s.hostname=t,s.hostname}U(Wa,"hostnameEncodeCallback");function $a(t){if(t==="")return t;if(/[^0-9a-fA-F[\]:]/g.test(t))throw new TypeError(`Invalid IPv6 hostname '${t}'`);return t.toLowerCase()}U($a,"ipv6HostnameEncodeCallback");function qa(t){if(t===""||/^[0-9]*$/.test(t)&&parseInt(t)<=65535)return t;throw new TypeError(`Invalid port '${t}'.`)}U(qa,"portEncodeCallback");function mc(t){if(t==="")return t;let s=new URL("https://example.com");return s.pathname=t[0]!=="/"?"/-"+t:t,t[0]!=="/"?s.pathname.substring(2,s.pathname.length):s.pathname}U(mc,"standardURLPathnameEncodeCallback");function fc(t){return t===""?t:new URL(`data:${t}`).pathname}U(fc,"pathURLPathnameEncodeCallback");function pc(t){if(t==="")return t;let s=new URL("https://example.com");return s.search=t,s.search.substring(1,s.search.length)}U(pc,"searchEncodeCallback");function hc(t){if(t==="")return t;let s=new URL("https://example.com");return s.hash=t,s.hash.substring(1,s.hash.length)}U(hc,"hashEncodeCallback");var xc=class{#r;#n=[];#t={};#e=0;#a=1;#l=0;#o=0;#f=0;#p=0;#h=!1;constructor(t){this.#r=t}get result(){return this.#t}parse(){for(this.#n=Ra(this.#r,!0);this.#e<this.#n.length;this.#e+=this.#a){if(this.#a=1,this.#n[this.#e].type==="END"){if(this.#o===0){this.#b(),this.#d()?this.#s(9,1):this.#u()?this.#s(8,1):this.#s(7,0);continue}else if(this.#o===2){this.#m(5);continue}this.#s(10,0);break}if(this.#f>0)if(this.#k())this.#f-=1;else continue;if(this.#S()){this.#f+=1;continue}switch(this.#o){case 0:this.#y()&&this.#m(1);break;case 1:if(this.#y()){this.#I();let t=7,s=1;this.#N()?(t=2,s=3):this.#h&&(t=2),this.#s(t,s)}break;case 2:this.#g()?this.#m(3):(this.#v()||this.#u()||this.#d())&&this.#m(5);break;case 3:this.#w()?this.#s(4,1):this.#g()&&this.#s(5,1);break;case 4:this.#g()&&this.#s(5,1);break;case 5:this.#A()?this.#p+=1:this.#T()&&(this.#p-=1),this.#C()&&!this.#p?this.#s(6,1):this.#v()?this.#s(7,0):this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 6:this.#v()?this.#s(7,0):this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 7:this.#u()?this.#s(8,1):this.#d()&&this.#s(9,1);break;case 8:this.#d()&&this.#s(9,1);break}}this.#t.hostname!==void 0&&this.#t.port===void 0&&(this.#t.port="")}#s(t,s){switch(this.#o){case 0:break;case 1:this.#t.protocol=this.#c();break;case 2:break;case 3:this.#t.username=this.#c();break;case 4:this.#t.password=this.#c();break;case 5:this.#t.hostname=this.#c();break;case 6:this.#t.port=this.#c();break;case 7:this.#t.pathname=this.#c();break;case 8:this.#t.search=this.#c();break;case 9:this.#t.hash=this.#c();break}this.#o!==0&&t!==10&&([1,2,3,4].includes(this.#o)&&[6,7,8,9].includes(t)&&(this.#t.hostname??=""),[1,2,3,4,5,6].includes(this.#o)&&[8,9].includes(t)&&(this.#t.pathname??=this.#h?"/":""),[1,2,3,4,5,6,7].includes(this.#o)&&t===9&&(this.#t.search??="")),this.#j(t,s)}#j(t,s){this.#o=t,this.#l=this.#e+s,this.#e+=s,this.#a=0}#b(){this.#e=this.#l,this.#a=0}#m(t){this.#b(),this.#o=t}#x(t){return t<0&&(t=this.#n.length-t),t<this.#n.length?this.#n[t]:this.#n[this.#n.length-1]}#i(t,s){let n=this.#x(t);return n.value===s&&(n.type==="CHAR"||n.type==="ESCAPED_CHAR"||n.type==="INVALID_CHAR")}#y(){return this.#i(this.#e,":")}#N(){return this.#i(this.#e+1,"/")&&this.#i(this.#e+2,"/")}#g(){return this.#i(this.#e,"@")}#w(){return this.#i(this.#e,":")}#C(){return this.#i(this.#e,":")}#v(){return this.#i(this.#e,"/")}#u(){if(this.#i(this.#e,"?"))return!0;if(this.#n[this.#e].value!=="?")return!1;let t=this.#x(this.#e-1);return t.type!=="NAME"&&t.type!=="REGEX"&&t.type!=="CLOSE"&&t.type!=="ASTERISK"}#d(){return this.#i(this.#e,"#")}#S(){return this.#n[this.#e].type=="OPEN"}#k(){return this.#n[this.#e].type=="CLOSE"}#A(){return this.#i(this.#e,"[")}#T(){return this.#i(this.#e,"]")}#c(){let t=this.#n[this.#e],s=this.#x(this.#l).index;return this.#r.substring(s,t.index)}#I(){let t={};Object.assign(t,et),t.encodePart=An;let s=Xo(this.#c(),void 0,t);this.#h=Oa(s)}};U(xc,"Parser");var $n=["protocol","username","password","hostname","port","pathname","search","hash"],Xe="*";function aa(t,s){if(typeof t!="string")throw new TypeError("parameter 1 is not of type 'string'.");let n=new URL(t,s);return{protocol:n.protocol.substring(0,n.protocol.length-1),username:n.username,password:n.password,hostname:n.hostname,port:n.port,pathname:n.pathname,search:n.search!==""?n.search.substring(1,n.search.length):void 0,hash:n.hash!==""?n.hash.substring(1,n.hash.length):void 0}}U(aa,"extractValues");function Re(t,s){return s?Bt(t):t}U(Re,"processBaseURLString");function zt(t,s,n){let a;if(typeof s.baseURL=="string")try{a=new URL(s.baseURL),s.protocol===void 0&&(t.protocol=Re(a.protocol.substring(0,a.protocol.length-1),n)),!n&&s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.username===void 0&&(t.username=Re(a.username,n)),!n&&s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.username===void 0&&s.password===void 0&&(t.password=Re(a.password,n)),s.protocol===void 0&&s.hostname===void 0&&(t.hostname=Re(a.hostname,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&(t.port=Re(a.port,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&(t.pathname=Re(a.pathname,n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&s.search===void 0&&(t.search=Re(a.search.substring(1,a.search.length),n)),s.protocol===void 0&&s.hostname===void 0&&s.port===void 0&&s.pathname===void 0&&s.search===void 0&&s.hash===void 0&&(t.hash=Re(a.hash.substring(1,a.hash.length),n))}catch{throw new TypeError(`invalid baseURL '${s.baseURL}'.`)}if(typeof s.protocol=="string"&&(t.protocol=lc(s.protocol,n)),typeof s.username=="string"&&(t.username=ic(s.username,n)),typeof s.password=="string"&&(t.password=rc(s.password,n)),typeof s.hostname=="string"&&(t.hostname=ac(s.hostname,n)),typeof s.port=="string"&&(t.port=cc(s.port,t.protocol,n)),typeof s.pathname=="string"){if(t.pathname=s.pathname,a&&!Zo(t.pathname,n)){let r=a.pathname.lastIndexOf("/");r>=0&&(t.pathname=Re(a.pathname.substring(0,r+1),n)+t.pathname)}t.pathname=oc(t.pathname,t.protocol,n)}return typeof s.search=="string"&&(t.search=nc(s.search,n)),typeof s.hash=="string"&&(t.hash=sc(s.hash,n)),t}U(zt,"applyInit");function Bt(t){return t.replace(/([+*?:{}()\\])/g,"\\$1")}U(Bt,"escapePatternString");function gc(t){return t.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}U(gc,"escapeRegexpString");function vc(t,s){s.delimiter??="/#?",s.prefixes??="./",s.sensitive??=!1,s.strict??=!1,s.end??=!0,s.start??=!0,s.endsWith="";let n=".*",a=`[^${gc(s.delimiter)}]+?`,r=/[$_\u200C\u200D\p{ID_Continue}]/u,o="";for(let c=0;c<t.length;++c){let i=t[c];if(i.type===3){if(i.modifier===3){o+=Bt(i.value);continue}o+=`{${Bt(i.value)}}${ft(i.modifier)}`;continue}let d=i.hasCustomName(),u=!!i.suffix.length||!!i.prefix.length&&(i.prefix.length!==1||!s.prefixes.includes(i.prefix)),m=c>0?t[c-1]:null,f=c<t.length-1?t[c+1]:null;if(!u&&d&&i.type===1&&i.modifier===3&&f&&!f.prefix.length&&!f.suffix.length)if(f.type===3){let h=f.value.length>0?f.value[0]:"";u=r.test(h)}else u=!f.hasCustomName();if(!u&&!i.prefix.length&&m&&m.type===3){let h=m.value[m.value.length-1];u=s.prefixes.includes(h)}u&&(o+="{"),o+=Bt(i.prefix),d&&(o+=`:${i.name}`),i.type===2?o+=`(${i.value})`:i.type===1?d||(o+=`(${a})`):i.type===0&&(!d&&(!m||m.type===3||m.modifier!==3||u||i.prefix!=="")?o+="*":o+=`(${n})`),i.type===1&&d&&i.suffix.length&&r.test(i.suffix[0])&&(o+="\\"),o+=Bt(i.suffix),u&&(o+="}"),i.modifier!==3&&(o+=ft(i.modifier))}return o}U(vc,"partsToPattern");var bc=class{#r;#n={};#t={};#e={};#a={};#l=!1;constructor(t={},s,n){try{let a;if(typeof s=="string"?a=s:n=s,typeof t=="string"){let i=new xc(t);if(i.parse(),t=i.result,a===void 0&&typeof t.protocol!="string")throw new TypeError("A base URL must be provided for a relative constructor string.");t.baseURL=a}else{if(!t||typeof t!="object")throw new TypeError("parameter 1 is not of type 'string' and cannot convert to dictionary.");if(a)throw new TypeError("parameter 1 is not of type 'string'.")}typeof n>"u"&&(n={ignoreCase:!1});let r={ignoreCase:n.ignoreCase===!0},o={pathname:Xe,protocol:Xe,username:Xe,password:Xe,hostname:Xe,port:Xe,search:Xe,hash:Xe};this.#r=zt(o,t,!0),Fa(this.#r.protocol)===this.#r.port&&(this.#r.port="");let c;for(c of $n){if(!(c in this.#r))continue;let i={},d=this.#r[c];switch(this.#t[c]=[],c){case"protocol":Object.assign(i,et),i.encodePart=An;break;case"username":Object.assign(i,et),i.encodePart=dc;break;case"password":Object.assign(i,et),i.encodePart=uc;break;case"hostname":Object.assign(i,Vh),La(d)?i.encodePart=$a:i.encodePart=Wa;break;case"port":Object.assign(i,et),i.encodePart=qa;break;case"pathname":Oa(this.#n.protocol)?(Object.assign(i,Kh,r),i.encodePart=mc):(Object.assign(i,et,r),i.encodePart=fc);break;case"search":Object.assign(i,et,r),i.encodePart=pc;break;case"hash":Object.assign(i,et,r),i.encodePart=hc;break}try{this.#a[c]=Da(d,i),this.#n[c]=za(this.#a[c],this.#t[c],i),this.#e[c]=vc(this.#a[c],i),this.#l=this.#l||this.#a[c].some(u=>u.type===2)}catch{throw new TypeError(`invalid ${c} pattern '${this.#r[c]}'.`)}}}catch(a){throw new TypeError(`Failed to construct 'URLPattern': ${a.message}`)}}get[Symbol.toStringTag](){return"URLPattern"}test(t={},s){let n={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof t!="string"&&s)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof t>"u")return!1;try{typeof t=="object"?n=zt(n,t,!1):n=zt(n,aa(t,s),!1)}catch{return!1}let a;for(a of $n)if(!this.#n[a].exec(n[a]))return!1;return!0}exec(t={},s){let n={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof t!="string"&&s)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof t>"u")return;try{typeof t=="object"?n=zt(n,t,!1):n=zt(n,aa(t,s),!1)}catch{return null}let a={};s?a.inputs=[t,s]:a.inputs=[t];let r;for(r of $n){let o=this.#n[r].exec(n[r]);if(!o)return null;let c={};for(let[i,d]of this.#t[r].entries())if(typeof d=="string"||typeof d=="number"){let u=o[i+1];c[d]=u}a[r]={input:n[r]??"",groups:c}}return a}static compareComponent(t,s,n){let a=U((i,d)=>{for(let u of["type","modifier","prefix","value","suffix"]){if(i[u]<d[u])return-1;if(i[u]!==d[u])return 1}return 0},"comparePart"),r=new Ot(3,"","","","",3),o=new Ot(0,"","","","",3),c=U((i,d)=>{let u=0;for(;u<Math.min(i.length,d.length);++u){let m=a(i[u],d[u]);if(m)return m}return i.length===d.length?0:a(i[u]??r,d[u]??r)},"comparePartList");return!s.#e[t]&&!n.#e[t]?0:s.#e[t]&&!n.#e[t]?c(s.#a[t],[o]):!s.#e[t]&&n.#e[t]?c([o],n.#a[t]):c(s.#a[t],n.#a[t])}get protocol(){return this.#e.protocol}get username(){return this.#e.username}get password(){return this.#e.password}get hostname(){return this.#e.hostname}get port(){return this.#e.port}get pathname(){return this.#e.pathname}get search(){return this.#e.search}get hash(){return this.#e.hash}get hasRegExpGroups(){return this.#l}};U(bc,"URLPattern");globalThis.URLPattern||(globalThis.URLPattern=bc);const Gh=l.createContext({requestHistoryTick:()=>{}}),yc=({children:t,requestHistoryTick:s})=>{const n=l.useMemo(()=>({requestHistoryTick:s}),[s]);return e.jsx(Gh.Provider,{value:n,children:t})};yc.__docgenInfo={description:"",methods:[],displayName:"HistoryQueueProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},requestHistoryTick:{required:!0,tsType:{name:"signature",type:"function",raw:"(cb: (resolve: () => void) => void) => void",signature:{arguments:[{type:{name:"signature",type:"function",raw:"(resolve: () => void) => void",signature:{arguments:[{type:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},name:"resolve"}],return:{name:"void"}}},name:"cb"}],return:{name:"void"}}},description:""}}};function Ut(){return Ut=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)({}).hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Ut.apply(null,arguments)}var ze;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ze||(ze={}));var en=function(t){return t},Vr="beforeunload",Qh="popstate";function Yh(t){t===void 0&&(t={});var s=t,n=s.window,a=n===void 0?document.defaultView:n,r=a.history;function o(){var C=a.location,T=C.pathname,k=C.search,I=C.hash,D=r.state||{};return[D.idx,en({pathname:T,search:k,hash:I,state:D.usr||null,key:D.key||"default"})]}var c=null;function i(){if(c)g.call(c),c=null;else{var C=ze.Pop,T=o(),k=T[0],I=T[1];if(g.length){if(k!=null){var D=m-k;D&&(c={action:C,location:I,retry:function(){w(D*-1)}},w(D))}}else x(C)}}a.addEventListener(Qh,i);var d=ze.Pop,u=o(),m=u[0],f=u[1],h=tn(),g=tn();m==null&&(m=0,r.replaceState(Ut({},r.state,{idx:m}),""));function v(C){return typeof C=="string"?C:jc(C)}function p(C,T){return T===void 0&&(T=null),en(Ut({pathname:f.pathname,hash:"",search:""},typeof C=="string"?ia(C):C,{state:T,key:ra()}))}function b(C,T){return[{usr:C.state,key:C.key,idx:T},v(C)]}function y(C,T,k){return!g.length||(g.call({action:C,location:T,retry:k}),!1)}function x(C){d=C;var T=o();m=T[0],f=T[1],h.call({action:d,location:f})}function j(C,T){var k=ze.Push,I=p(C,T);function D(){j(C,T)}if(y(k,I,D)){var _=b(I,m+1),A=_[0],R=_[1];try{r.pushState(A,"",R)}catch{a.location.assign(R)}x(k)}}function N(C,T){var k=ze.Replace,I=p(C,T);function D(){N(C,T)}if(y(k,I,D)){var _=b(I,m),A=_[0],R=_[1];r.replaceState(A,"",R),x(k)}}function w(C){r.go(C)}var S={get action(){return d},get location(){return f},createHref:v,push:j,replace:N,go:w,back:function(){w(-1)},forward:function(){w(1)},listen:function(T){return h.push(T)},block:function(T){var k=g.push(T);return g.length===1&&a.addEventListener(Vr,Gr),function(){k(),g.length||a.removeEventListener(Vr,Gr)}}};return S}function Xh(t){t===void 0&&(t={});var s=t,n=s.initialEntries,a=n===void 0?["/"]:n,r=s.initialIndex,o=a.map(function(j){var N=en(Ut({pathname:"/",search:"",hash:"",state:null,key:ra()},typeof j=="string"?ia(j):j));return N}),c=Kr(r??o.length-1,0,o.length-1),i=ze.Pop,d=o[c],u=tn(),m=tn();function f(j){return typeof j=="string"?j:jc(j)}function h(j,N){return N===void 0&&(N=null),en(Ut({pathname:d.pathname,search:"",hash:""},typeof j=="string"?ia(j):j,{state:N,key:ra()}))}function g(j,N,w){return!m.length||(m.call({action:j,location:N,retry:w}),!1)}function v(j,N){i=j,d=N,u.call({action:i,location:d})}function p(j,N){var w=ze.Push,S=h(j,N);function C(){p(j,N)}g(w,S,C)&&(c+=1,o.splice(c,o.length,S),v(w,S))}function b(j,N){var w=ze.Replace,S=h(j,N);function C(){b(j,N)}g(w,S,C)&&(o[c]=S,v(w,S))}function y(j){var N=Kr(c+j,0,o.length-1),w=ze.Pop,S=o[N];function C(){y(j)}g(w,S,C)&&(c=N,v(w,S))}var x={get index(){return c},get action(){return i},get location(){return d},createHref:f,push:p,replace:b,go:y,back:function(){y(-1)},forward:function(){y(1)},listen:function(N){return u.push(N)},block:function(N){return m.push(N)}};return x}function Kr(t,s,n){return Math.min(Math.max(t,s),n)}function Gr(t){t.preventDefault(),t.returnValue=""}function tn(){var t=[];return{get length(){return t.length},push:function(n){return t.push(n),function(){t=t.filter(function(a){return a!==n})}},call:function(n){t.forEach(function(a){return a&&a(n)})}}}function ra(){return Math.random().toString(36).substr(2,8)}function jc(t){var s=t.pathname,n=s===void 0?"/":s,a=t.search,r=a===void 0?"":a,o=t.hash,c=o===void 0?"":o;return r&&r!=="?"&&(n+=r.charAt(0)==="?"?r:"?"+r),c&&c!=="#"&&(n+=c.charAt(0)==="#"?c:"#"+c),n}function ia(t){var s={};if(t){var n=t.indexOf("#");n>=0&&(s.hash=t.substr(n),t=t.substr(0,n));var a=t.indexOf("?");a>=0&&(s.search=t.substr(a),t=t.substr(0,a)),t&&(s.pathname=t)}return s}const Zh=l.createContext([]);function Nc(t){return t.name==="Pushed"||t.name==="Popped"||t.name==="Replaced"}function ex(t){return t.name==="StepPushed"||t.name==="StepPopped"||t.name==="StepReplaced"}function tx(t){return Nc(t)||ex(t)}const ut={IDLE:"idle",PROGRESS:"progress",SUCCEEDED:"succeeded",FAILED:"failed"};function wc(t){return t===ut.SUCCEEDED||t===ut.FAILED}class sx{targetId;initialSetupProcess;focusCount;previousActivationTrigger;constructor(s,n){this.targetId=s,this.initialSetupProcess=n,this.focusCount=0,this.previousActivationTrigger=null}captureStackChange(s){const n=this.initialSetupProcess.getStatus();if(!wc(n))return;const a=s.activities.find(o=>o.id===this.targetId);if(!a||!a.isActive)return;const r=s.events.findLast(Nc);!r||this.previousActivationTrigger&&r.eventDate<=this.previousActivationTrigger.eventDate||(this.focusCount++,this.previousActivationTrigger=r)}getActivationCount(){return this.focusCount}getTargetId(){return this.targetId}}const{parse:nx,stringify:ax}=JSON,{keys:rx}=Object,ls=String,Cc="string",Qr={},Ha="object",Sc=(t,s)=>s,ix=t=>t instanceof ls?ls(t):t,ox=(t,s)=>typeof s===Cc?new ls(s):s,kc=(t,s,n,a)=>{const r=[];for(let o=rx(n),{length:c}=o,i=0;i<c;i++){const d=o[i],u=n[d];if(u instanceof ls){const m=t[u];typeof m===Ha&&!s.has(m)?(s.add(m),n[d]=Qr,r.push({k:d,a:[t,s,m,a]})):n[d]=a.call(n,d,m)}else n[d]!==Qr&&(n[d]=a.call(n,d,u))}for(let{length:o}=r,c=0;c<o;c++){const{k:i,a:d}=r[c];n[i]=a.call(n,i,kc.apply(null,d))}return n},Yr=(t,s,n)=>{const a=ls(s.push(n)-1);return t.set(n,a),a},cx=(t,s)=>{const n=nx(t,ox).map(ix),a=n[0],r=s||Sc,o=typeof a===Ha&&a?kc(n,new Set,a,r):a;return r.call({"":o},"",o)},lx=(t,s,n)=>{const a=Sc,r=new Map,o=[],c=[];let i=+Yr(r,o,a.call({"":t},"",t)),d=!i;for(;i<o.length;)d=!0,c[i]=ax(o[i++],u,n);return"["+c.join(",")+"]";function u(m,f){if(d)return d=!d,f;const h=a.call(this,m,f);switch(typeof h){case Ha:if(h===null)return h;case Cc:return r.get(h)||Yr(r,o,h)}return h}},Ac="@biochain/plugin-navigation-sync";function Tc(t){return{_TAG:Ac,flattedState:lx({activity:t.activity,step:t.step})}}function dx(t){return typeof t=="object"&&t!==null&&"_TAG"in t&&"flattedState"in t&&typeof t._TAG=="string"&&t._TAG===Ac&&typeof t.flattedState=="string"}function ks(t){try{return dx(t)?cx(t.flattedState):null}catch{return null}}function Xr({history:t,pathname:s,state:n,useHash:a}){const r=a?`${t.location.pathname}#${s}`:s;t.push(r,Tc(n))}function qn({history:t,pathname:s,state:n,useHash:a}){const r=a?`${t.location.pathname}#${s}`:s;t.replace(r,Tc(n))}function Zr(t){return t.length===0?void 0:t[t.length-1]}const ux=t=>{let s=Promise.resolve();return{requestHistoryTick:a=>{s=s.then(()=>new Promise(r=>{const o=t.listen(()=>{o(),r()});a(()=>{o(),r()})}))}}};function Ic(t){return new URL(t,"file://")}function oa(t){const s={};return t.forEach((n,a)=>{s[a]=n}),s}function As(t){return t.endsWith("/")?t:`${t}/`}function ei(t){return t.toString().length>0?`?${t}`:t}function Ae({path:t,decode:s},n){const a=t==="*"||t==="/*",r=a?[]:Array.from(t.matchAll(/:([A-Za-z0-9_]+)/g)).map(u=>u[1]).filter(Boolean),o=Array.from(new Set(r)),c=a?Number.POSITIVE_INFINITY:o.length,i=a?"*":As(t),d=a?null:new URLPattern({pathname:i});return{fill(u){if(a){const g=new URLSearchParams(Object.entries(u).reduce((v,[p,b])=>b?{...v,[p]:b}:v,{}));return As("/")+ei(g)}let m=t;for(const g of o){const v=u[g];if(v===void 0)throw new Error(`Missing route param: ${g}`);m=m.replace(`:${g}`,encodeURIComponent(v))}m=As(m);const f={...u};o.forEach(g=>{delete f[g]});const h=new URLSearchParams(Object.entries(f).reduce((g,[v,p])=>({...g,...p?{[v]:p}:null}),{}));return m+ei(h)},parse(u){const m=Ic(u);if(a){const y={...oa(m.searchParams)};return s?s(y):y}if(!d)return null;const f=As(m.pathname),h=d.exec({pathname:f}),g=oa(m.searchParams);if(!h)return null;const v=h.pathname.groups,p={...g};for(const[b,y]of Object.entries(v))y!==void 0&&(p[b]=y);return s?s(p):p},variableCount:c}}class mx{status;pendingNavigations;dispatchedEvents;baseNavigationEvents;constructor(s,n=[]){this.status=s.length>0?ut.IDLE:ut.SUCCEEDED,this.pendingNavigations=s.slice(),this.dispatchedEvents=[],this.baseNavigationEvents=n}captureNavigationOpportunity(s){if(wc(this.status))return[];if(s&&s.globalTransitionState!=="idle")return[];if(this.pendingNavigations.length===0)return this.status=ut.SUCCEEDED,[];const n=s?s.events.filter(tx):[];if(!(this.verifyAllDispatchedEventsAreInNavigationHistory(n)&&this.verifyNoUnknownNavigationEvents(n)))return this.pendingNavigations=[],this.status=ut.FAILED,[];const a=this.pendingNavigations.shift();if(!a)return[];const r=a();return this.dispatchedEvents.push(...r),this.status=ut.PROGRESS,r}getStatus(){return this.status}verifyAllDispatchedEventsAreInNavigationHistory(s){const n=new Set(s.map(a=>a.id));return this.dispatchedEvents.every(a=>n.has(a.id))}verifyNoUnknownNavigationEvents(s){const n=new Set([...this.baseNavigationEvents,...this.dispatchedEvents].map(a=>a.id));return s.every(a=>n.has(a.id))}}function fx(t){return typeof t=="string"?{path:t}:t}function px(t){return(Array.isArray(t)?t:[t]).map(fx)}function hx(t){return Object.keys(t).flatMap(n=>{const a=t[n];return a?px(a).map(r=>({activityName:n,...r})):[]})}class xx{latestlyBookedSession=Promise.resolve();acquire(){return new Promise(s=>{this.latestlyBookedSession=this.latestlyBookedSession.then(()=>new Promise(n=>s({release:()=>n()})))})}async runExclusively(s){const{release:n}=await this.acquire();try{return await s()}finally{n()}}}class gx{subscribers=[];publishLock=new xx;subscribe(s){return this.subscribers.push(s),()=>{this.subscribers=this.subscribers.filter(n=>n!==s)}}publish(s){const n=this.subscribers.slice();return this.publishLock.runExclusively(()=>Promise.allSettled(n.map(a=>a(s))))}}const vx=l.createContext([]),Ua=t=>e.jsx(vx.Provider,{value:t.routes,children:t.children});Ua.displayName="RoutesProvider";Ua.__docgenInfo={description:"",methods:[],displayName:"RoutesProvider",props:{routes:{required:!0,tsType:{name:"Array",elements:[{name:"ActivityRoute",elements:[{name:"T"}],raw:"ActivityRoute<T>"}],raw:"ActivityRoute<T>[]"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};const bx=/^:[\w-]+$/,yx=3,jx=1,Nx=10,wx=-2,ti=t=>t==="*";function si(t){const s=t.split("/");let n=s.length;return s.some(ti)&&(n+=wx),s.filter(a=>!ti(a)).reduce((a,r)=>a+(bx.test(r)?yx:r===""?jx:Nx),n)}function Cx(t){return[...t].toSorted((s,n)=>si(n.path)-si(s.path))}const Sx=1e3,kx=60*Sx;function Ax(t){"config"in t&&t.config.decorate("historySync",{makeTemplate:Ae,urlPatternOptions:t.urlPatternOptions});const s=t.history??(typeof window>"u"?Xh({}):Yh({window})),{location:n}=s,a="routes"in t?t.routes:t.config.activities.reduce((o,c)=>({...o,[c.name]:c.route}),{}),r=Cx(hx(a));return()=>{let o=0,c=!1,i=null;const d=[],u=new gx,{requestHistoryTick:m}=ux(s),f=p=>u.subscribe(async()=>p());let h=null;const g=()=>{const p=d.map(b=>({activityId:b.getTargetId(),activationCount:b.getActivationCount()}));return(!h||h.length!==p.length||h.some(({activityId:b,activationCount:y})=>p.some(({activityId:x,activationCount:j})=>x===b&&j!==y)))&&(h=p),h},v=p=>{let b=!1;for(const y of d){const x=y.getActivationCount();y.captureStackChange(p),x!==y.getActivationCount()&&(b=!0)}b&&u.publish()};return{key:"plugin-history-sync",wrapStack({stack:p}){const b=l.useSyncExternalStore(f,g,g);return e.jsx(yc,{requestHistoryTick:m,children:e.jsx(Ua,{routes:r,children:e.jsx(Zh.Provider,{value:b,children:p.render()})})})},overrideInitialEvents({initialContext:p}){const b=ks(s.location.state);if(b)return[{...b.activity.enteredBy,name:"Pushed"},...b.step?.enteredBy.name==="StepPushed"||b.step?.enteredBy.name==="StepReplaced"?[{...b.step.enteredBy,name:"StepPushed"}]:[]];function y(){return p?.req?.path&&typeof p.req.path=="string"?p.req.path:t.useHash?n.hash.split("#")[1]??"/":n.pathname+n.search}const x=y(),j=t.fallbackActivity({initialContext:p}),N=r.find(k=>Ae(k,t.urlPatternOptions).parse(x)!==null)??r.find(k=>k.activityName===j),S=Ae(N,t.urlPatternOptions).parse(x)??{},C=Object.entries(S).reduce((k,[I,D])=>(typeof D=="string"&&(k[I]=D),k),{}),T=N.defaultHistory?.(C)??[];return i=new mx([...T.map(({activityName:k,activityParams:I,additionalSteps:D=[]})=>()=>{const _=[{name:"Pushed",id:We(),activityId:We(),activityName:k,activityParams:{...I},activityContext:{path:x,lazyActivityComponentRenderContext:{shouldRenderImmediately:!0}}},...D.map(({stepParams:A,hasZIndex:R})=>({name:"StepPushed",id:We(),stepId:We(),stepParams:A,hasZIndex:R}))];for(const A of _)A.name==="Pushed"&&d.push(new sx(A.activityId,i));return _}),()=>[{name:"Pushed",id:We(),activityId:We(),activityName:N.activityName,activityParams:Ae(N,t.urlPatternOptions).parse(x)??oa(Ic(x).searchParams),activityContext:{path:x,lazyActivityComponentRenderContext:{shouldRenderImmediately:!0}}}]]),i.captureNavigationOpportunity(null).map(k=>({...k,eventDate:Date.now()-kx}))},onInit({actions:{getStack:p,dispatchEvent:b,push:y,stepPush:x}}){const j=p(),N=j.activities[0],w=r.find(k=>k.activityName===N.name),S=Ae(w,t.urlPatternOptions),C=Zr(N.steps);m(()=>{c=!0,qn({history:s,pathname:S.fill(N.params),state:{activity:N,step:C},useHash:t.useHash})});const T=k=>{if(c){c=!1;return}const I=ks(k.location.state);if(!I)return;const D=I.activity,_=I.activity.id,A=I.step,{activities:R}=p(),E=R.find(G=>G.isActive);if(!E)return;const B=Zr(E.steps),P=R.find(G=>G.id===_),z=E.steps.find(G=>G.id===A?.id),q=()=>E.id>_,K=()=>E.id<_,oe=()=>E.id===_,Y=()=>oe()?!!(!A||B&&B.id>A.id):!1,J=()=>oe()?!!(!B||A&&B.id<A.id):!1;if(q()&&(b("Popped",{}),!P&&(o+=1,y({...D.enteredBy}),A?.enteredBy.name==="StepPushed"||A?.enteredBy.name==="StepReplaced"))){const{enteredBy:G}=A;o+=1,x({...G})}if(Y()){if(!z&&A&&(A?.enteredBy.name==="StepPushed"||A?.enteredBy.name==="StepReplaced")){const{enteredBy:G}=A;o+=1,x({...G})}b("StepPopped",{})}if(K()&&(o+=1,y({activityId:D.id,activityName:D.name,activityParams:D.params})),J()){if(!A)return;o+=1,x({stepId:A.id,stepParams:A.params})}};s.listen(T),i?.captureNavigationOpportunity(j).forEach(k=>k.name==="Pushed"?y(k):x(k)),v(j)},onPushed({effect:{activity:p}}){if(o){o-=1;return}const b=r.find(x=>x.activityName===p.name),y=Ae(b,t.urlPatternOptions);m(()=>{c=!0,Xr({history:s,pathname:y.fill(p.params),state:{activity:p},useHash:t.useHash})})},onStepPushed({effect:{activity:p,step:b}}){if(o){o-=1;return}const y=r.find(j=>j.activityName===p.name),x=Ae(y,t.urlPatternOptions);m(()=>{c=!0,Xr({history:s,pathname:x.fill(p.params),state:{activity:p,step:b},useHash:t.useHash})})},onReplaced({effect:{activity:p}}){if(!p.isActive)return;const b=r.find(x=>x.activityName===p.name),y=Ae(b,t.urlPatternOptions);m(()=>{c=!0,qn({history:s,pathname:y.fill(p.params),state:{activity:p},useHash:t.useHash})})},onStepReplaced({effect:{activity:p,step:b}}){if(!p.isActive)return;const y=r.find(j=>j.activityName===p.name),x=Ae(y,t.urlPatternOptions);m(()=>{c=!0,qn({history:s,pathname:x.fill(p.params),state:{activity:p,step:b},useHash:t.useHash})})},onBeforePush({actionParams:p,actions:{overrideActionParams:b}}){if(!p.activityContext||!("path"in p.activityContext)){const y=r.find(N=>N.activityName===p.activityName),j=Ae(y,t.urlPatternOptions).fill(p.activityParams);b({...p,activityContext:{...p.activityContext,path:j}})}},onBeforeReplace({actionParams:p,actions:{overrideActionParams:b,getStack:y}}){if(!p.activityContext||!("path"in p.activityContext)){const w=r.find(T=>T.activityName===p.activityName),C=Ae(w,t.urlPatternOptions).fill(p.activityParams);b({...p,activityContext:{...p.activityContext,path:C}})}const{activities:x}=y(),j=x.filter(w=>w.transitionState==="enter-active"||w.transitionState==="enter-done"),N=j.length>0?j[j.length-1]:null;if(N)for(let w=0;w<N.steps.length-1;w+=1)m(S=>{ks(s.location.state)?S():(c=!0,s.back())}),m(()=>{c=!0,s.back()})},onBeforeStepPop({actions:{getStack:p}}){const{activities:b}=p();(b.find(x=>x.isActive)?.steps.length??0)>1&&m(()=>{c=!0,s.back()})},onBeforePop({actions:{getStack:p}}){const{activities:b}=p(),y=b.find(x=>x.isActive);if(y){const{isRoot:x,steps:j}=y,N=x?0:j.length;for(let w=0;w<N;w+=1)m(S=>{ks(s.location.state)?S():(c=!0,s.back())}),m(()=>{c=!0,s.back()})}},onChanged({actions:{getStack:p,push:b,stepPush:y}}){const x=p();i?.captureNavigationOpportunity(x).forEach(j=>j.name==="Pushed"?b(j):y(j)),v(x)}}}}function Pc(){const{t}=L(["settings","common"]),[s,n]=l.useState(!1),a=()=>{n(!0);const r="./";window.location.href=`${r}clear.html`};return e.jsx("div",{className:"flex min-h-screen flex-col items-center justify-center bg-background p-6",children:e.jsxs("div",{className:"flex flex-col items-center gap-6 text-center max-w-sm",children:[e.jsx("div",{className:"bg-destructive/10 flex size-20 items-center justify-center rounded-full",children:e.jsx(Se,{className:"text-destructive size-10"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-xl font-bold",children:t("settings:storage.migrationRequired","")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:t("settings:storage.migrationDesc","")})]}),e.jsx("div",{className:"bg-destructive/5 rounded-lg p-4 w-full",children:e.jsxs("ul",{className:"text-destructive space-y-2 text-sm text-left",children:[e.jsxs("li",{children:[" ",t("settings:clearData.item1","")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item2","")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item3","")]})]})}),e.jsxs($,{variant:"destructive",onClick:a,className:"w-full gap-2",disabled:s,children:[e.jsx(Tt,{className:"size-4"}),t("settings:clearData.confirm","")]})]})})}Pc.__docgenInfo={description:`


 Stackflow context  useFlow()`,methods:[],displayName:"MigrationRequiredView"};const ni={ethereum:"Ethereum",bitcoin:"Bitcoin",tron:"Tron",binance:"BSC",bfmeta:"BFMeta",ccchain:"CCChain",pmchain:"PMChain",bfchainv2:"BFChain V2",btgmeta:"BTGMeta",biwmeta:"BIWMeta",ethmeta:"ETHMeta",malibu:"Malibu"};function Ec(){const{push:t}=V(),s=ka(),n=nt(),a=Sn(),{t:r}=L(["home","wallet","common","transaction"]),o=Ci(),c=jo(),i=yo(),d=Pt(),u=ye(),m=u?.id??null,f=Ke(),h=vo(),g=ni[f]??f,v=Cn(),p=At(),y=(p.snapshot?tt.getChainById(p,f):null)?.symbol;Ei();const{data:x,isFetching:j}=hf(u?.id,f),{transactions:N,isLoading:w,setFilter:S}=Sa(u?.id);l.useEffect(()=>{S(P=>({...P,chain:f}))},[f,S]);const C=l.useCallback(async P=>{await s.write({text:P}),await a.impact("light"),n.show(r("home:wallet.addressCopied"))},[s,a,n,r]),T=l.useCallback(P=>{P!==m&&de.setCurrentWallet(P),t("ChainSelectorJob",{})},[t,m]),k=l.useCallback(P=>{const z=d.find(q=>q.id===P);z&&t("WalletConfigActivity",{walletId:P,walletName:z.name})},[t,d]),I=l.useCallback(P=>{de.setCurrentWallet(P)},[]),D=l.useCallback(()=>{t("WalletAddJob",{})},[t]),_=l.useCallback(()=>{t("WalletListJob",{})},[t]),A=l.useCallback(()=>{t("AddressBalanceActivity",{})},[t]),R=l.useCallback(()=>{t("AddressTransactionsActivity",{})},[t]),E=l.useCallback(P=>{P.id&&t("TransactionDetailActivity",{txId:P.id})},[t]),B=l.useCallback((P,z)=>[{label:r("home:wallet.transfer"),icon:e.jsx(lo,{className:"size-4"}),onClick:()=>{a.impact("light"),t("SendActivity",{assetType:P.symbol})}},{label:r("home:wallet.destroy"),icon:e.jsx($s,{className:"size-4"}),onClick:()=>{a.impact("light"),t("DestroyActivity",{assetType:P.symbol,assetLocked:"true"})},variant:"destructive",show:z.canDestroy}],[a,t,r]);return o?e.jsx(Pc,{}):c?!i||!u?e.jsx(Tx,{}):e.jsxs("div",{"data-testid":"wallet-home",className:"flex h-full flex-col overflow-y-auto bg-background",children:[e.jsxs("div",{className:"pt-2 pb-1",children:[e.jsx(eu,{wallets:d,currentWalletId:m,selectedChain:f,chainPreferences:h,chainNames:ni,onWalletChange:I,onCopyAddress:C,onOpenChainSelector:T,onOpenSettings:k,onOpenWalletList:_,onAddWallet:D,onOpenAddressBalance:A,onOpenAddressTransactions:R}),e.jsxs("div",{className:"mt-2 flex justify-center gap-8 px-6",children:[e.jsxs("button",{onClick:()=>t("SendActivity",{}),"data-testid":"wallet-home-send-button",className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:e.jsx(xo,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:r("home:wallet.send")})]}),e.jsxs("button",{onClick:()=>t("ReceiveActivity",{}),"data-testid":"wallet-home-receive-button",className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:e.jsx(af,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:r("home:wallet.receive")})]}),e.jsxs("button",{onClick:()=>t("ScannerActivity",{}),"data-testid":"wallet-home-scan-button",className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10 text-primary transition-all active:scale-95 group-hover:bg-primary/20",children:e.jsx(bu,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:r("common:a11y.scan")})]})]})]}),e.jsx("div",{className:"flex-1 pt-3",children:e.jsx(ru,{chainId:f,chainName:g,tokens:v.map(P=>({symbol:P.symbol,name:P.name,chain:f,balance:P.balance,decimals:P.decimals,fiatValue:P.fiatValue?String(P.fiatValue):void 0,change24h:P.change24h,icon:P.icon})),transactions:N.slice(0,5),tokensRefreshing:j,transactionsLoading:w,tokensSupported:x?.supported??!0,tokensFallbackReason:x?.fallbackReason,onTokenClick:P=>{console.log("Token clicked:",P.symbol)},onTransactionClick:E,mainAssetSymbol:y,tokenMenuItems:B,renderTransactionFooter:()=>e.jsx("button",{onClick:()=>t("HistoryActivity",{chain:N.length>0?f:"all"}),className:"mt-3 w-full rounded-lg bg-muted/60 py-2.5 text-sm font-medium text-muted-foreground transition-colors hover:bg-muted",children:N.length>0?r("transaction:history.viewAll",{count:N.length}):r("transaction:history.viewAllChains")}),testId:"wallet-home"})}),e.jsx("div",{className:"shrink-0 h-[var(--tab-bar-height)]"})]}):e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(be,{size:"lg"})})}function Tx(){const{push:t}=V(),{t:s}=L("home");return e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-6 p-6 text-center",children:[e.jsx("div",{className:"bg-primary/10 rounded-full p-6",children:e.jsx(st,{className:"text-primary size-12"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:s("welcome.title")}),e.jsx("p",{className:"text-muted-foreground mt-2",children:s("welcome.subtitle")})]}),e.jsxs("div",{className:"flex w-full max-w-xs flex-col gap-3",children:[e.jsx(Ee,{variant:"mint",className:"w-full","data-testid":"create-wallet-button",onClick:()=>t("WalletCreateActivity",{}),children:s("welcome.createWallet")}),e.jsx($,{variant:"outline",className:"w-full","data-testid":"import-wallet-button",onClick:()=>t("OnboardingRecoverActivity",{}),children:s("welcome.importWallet")})]})]})}Ec.__docgenInfo={description:"",methods:[],displayName:"WalletTab"};const Ix=xa(["defi","nft","tools","games","social","exchange","other"]),Px=ga([$e(!0),$t({timeout:wt().int().positive().optional()}).passthrough()]),Ex=xa(["auto","dark","light"]),_x=xa(["stack","mine"]),_c=$t({id:W(),name:W(),description:W(),longDescription:W().optional(),icon:W(),url:W(),version:W(),author:W().optional(),website:W().optional(),category:Ix.optional(),tags:qe(W()).optional(),permissions:qe(W()).optional(),chains:qe(W()).optional(),screenshots:qe(W()).optional(),minWalletVersion:W().optional(),publishedAt:W().optional(),updatedAt:W().optional(),beta:Ue().optional(),officialScore:wt().min(0).max(100).optional(),communityScore:wt().min(0).max(100).optional(),splashScreen:Px.optional(),capsuleTheme:Ex.optional(),targetDesktop:_x.optional(),themeColor:W().optional(),themeColorFrom:W().optional(),themeColorTo:W().optional()}).passthrough(),Mc=$t({name:W(),version:W(),updated:W(),icon:W().optional(),search:$t({urlTemplate:W()}).passthrough().optional(),apps:qe(_c)}).passthrough();$t({version:W(),data:qe(_c)}).passthrough();const Mx="bfm_ecosystem",Rx=1,Jt="ecosystem_source_payloads",Dx=$t({url:W(),etag:W().optional(),lastUpdated:W(),payload:Mc});let Ts=null,Xt=null;function zx(){if(typeof indexedDB>"u")throw new Error("indexedDB is not available in this environment")}function Bx(t){return new Promise((s,n)=>{t.onsuccess=()=>s(t.result),t.onerror=()=>n(t.error??new Error("IndexedDB request failed"))})}function Rc(t){return new Promise((s,n)=>{t.oncomplete=()=>s(),t.onerror=()=>n(t.error??new Error("IndexedDB transaction failed")),t.onabort=()=>n(t.error??new Error("IndexedDB transaction aborted"))})}async function Dc(){if(zx(),Ts)return Ts;if(Xt)return Xt;Xt=new Promise((t,s)=>{const n=indexedDB.open(Mx,Rx);n.onupgradeneeded=()=>{const a=n.result;a.objectStoreNames.contains(Jt)||a.createObjectStore(Jt,{keyPath:"url"})},n.onsuccess=()=>t(n.result),n.onerror=()=>s(n.error??new Error("Failed to open IndexedDB"))});try{return Ts=await Xt,Ts}finally{Xt=null}}async function Lx(t){const n=(await Dc()).transaction([Jt],"readwrite");n.objectStore(Jt).put(t),await Rc(n)}async function zc(t){const n=(await Dc()).transaction([Jt],"readonly"),a=n.objectStore(Jt),r=await Bx(a.get(t));await Rc(n);const o=Dx.safeParse(r);return o.success?o.data:(console.warn("[EcosystemStorage] Invalid source payload record:",o.error.issues[0]),null)}const Ox=15,Fx=1440*60*1e3;function Wx(t){return Math.floor(t.getTime()/Fx)}function $x(t=new Date){const s=Wx(t);return Ox*(s+1)%100}function ai(t,s=new Date){const n=typeof t.officialScore=="number"?t.officialScore:0,a=typeof t.communityScore=="number"?t.communityScore:0,r=$x(s),o=100-r;return(n*r+a*o)/100}function qx(t){const s=typeof document<"u"?document.baseURI:"file:///",n=new URL(t,s).toString();return a=>a.startsWith("http://")||a.startsWith("https://")||a.startsWith("data:")?a:new URL(a,n).toString()}const Hx=1e4;let yt=[];const Fs=[];function Bc(){const t=[...yt];Fs.forEach(s=>s(t))}function Ux(t){return Fs.push(t),()=>{const s=Fs.indexOf(t);s>=0&&Fs.splice(s,1)}}function Jx(t){return/^[a-z0-9]+(?:\.[a-z0-9-]+)+$/i.test(t)}function Lc(t,s,n){if(!Jx(t.id))return console.warn(`[Registry] Invalid appId "${t.id}" from source "${s.url}", skipping`),null;const a=qx(s.url);return{...t,icon:a(t.icon),url:a(t.url),screenshots:t.screenshots?.map(a),splashScreen:t.splashScreen,sourceUrl:s.url,sourceName:s.name,sourceIcon:s.icon??(n.icon?a(n.icon):void 0)}}function Vx(t,s,n=Hx){const a=new AbortController,r=setTimeout(()=>a.abort(),n);return fetch(t,{...s,signal:a.signal}).finally(()=>clearTimeout(r))}async function Kx(t,s){const n=await zc(t),a=s?void 0:n?.etag;try{const r=await Vx(t,{method:"GET",headers:{Accept:"application/json",...a!==void 0?{"If-None-Match":a}:{}}});if(r.status===304)return n?.payload??null;if(!r.ok)return console.warn(`[Registry] Failed to fetch source: ${t}`,r.status,r.statusText),n?.payload??null;const o=await r.json(),c=Mc.safeParse(o);if(!c.success)return console.warn(`[Registry] Invalid source JSON: ${t}`,c.error),n?.payload??null;const i=c.data,d=r.headers.get("ETag")??void 0;return await Lx({url:t,payload:i,...d!==void 0?{etag:d}:{},lastUpdated:new Date().toISOString()}),i}catch(r){const o=r instanceof Error&&r.name==="AbortError"?"request timeout":r instanceof Error?r.message:String(r);return console.warn(`[Registry] Error fetching source: ${t}`,o),n?.payload??null}}async function Oc(){const t=ha.getEnabledSources(Nt.state),s=await Promise.all(t.map(async r=>{const o=await zc(r.url);return{source:r,cached:o}})),n=[],a=new Set;for(const{source:r,cached:o}of s){const c=o?.payload;if(c)for(const i of c.apps??[]){const d=Lc(i,r,c);if(d){if(a.has(d.id)){console.warn(`[Registry] Duplicate appId "${d.id}" detected, skipping later entry`);continue}a.add(d.id),n.push(d)}}}yt=n,Bc()}let ri="";Nt.subscribe(()=>{const t=JSON.stringify(Nt.state.sources);t!==ri&&(ri=t,Oc())});async function Fc(t){await Oc(),t?.refresh===!0&&Ja({force:!1})}async function Ja(t){const s=t?.force===!0,n=ha.getEnabledSources(Nt.state),a=await Promise.all(n.map(async c=>{const i=await Kx(c.url,s);return i&&Ie.updateSourceTimestamp(c.url),{source:c,payload:i}})),r=[],o=new Set;for(const{source:c,payload:i}of a)if(i)for(const d of i.apps??[]){const u=Lc(d,c,i);if(u){if(o.has(u.id)){console.warn(`[Registry] Duplicate appId "${u.id}" detected, skipping later entry`);continue}o.add(u.id),r.push(u)}}return yt=r,Bc(),console.log(`[Registry] Loaded ${yt.length} apps from ${n.length} sources`),[...yt]}function Gx(){return[...yt]}function ii(t){return yt.find(s=>s.id===t)}function Wc(){const{push:t}=V(),s=l.useRef(null),[n,a]=l.useState([]),[r,o]=l.useState(!0),c=le(Nt,v=>v.myApps);l.useEffect(()=>{const v=Ux(p=>a(p));return Fc({refresh:!0}).then(()=>{a(Gx()),o(!1)}),()=>v()},[]),Nu();const i=l.useCallback(v=>{t("MiniappDetailActivity",{appId:encodeURIComponent(v.id)})},[t]),d=l.useCallback(v=>{Ie.installApp(v.id),Ie.updateAppLastUsed(v.id),Ie.setActiveSubPage("mine"),s.current?.slideTo("mine"),requestAnimationFrame(()=>{Fi(v.id,{...v,targetDesktop:"mine"})})},[]),u=l.useCallback(v=>{Ie.uninstallApp(v)},[]),m=l.useMemo(()=>c.map(v=>({...v,app:n.find(p=>p.id===v.appId)})).filter(v=>!!v.app).map(({app:v,lastUsedAt:p})=>({app:v,lastUsed:p})),[c,n]),f=l.useMemo(()=>n.length===0?[]:[...n].toSorted((v,p)=>ai(p)-ai(v)).slice(0,2),[n]),h=l.useMemo(()=>{const v=new Set(f.map(p=>p.id));return[...n].filter(p=>!v.has(p.id)).toSorted((p,b)=>(b.officialScore??0)-(p.officialScore??0)).slice(0,6)},[n,f]),g=l.useMemo(()=>[...n].toSorted((v,p)=>(p.communityScore??0)-(v.communityScore??0)).slice(0,10),[n]);return r?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(be,{size:"lg"})}):e.jsx(Pu,{ref:s,showDiscoverPage:!0,showStackPage:"auto",apps:n,myApps:m,featuredApps:f,recommendedApps:h,hotApps:g,onAppOpen:d,onAppDetail:i,onAppRemove:u})}Wc.__docgenInfo={description:"",methods:[],displayName:"EcosystemTab"};function ve({icon:t,label:s,value:n,showChevron:a=!0,disabled:r=!1,onClick:o,trailing:c,className:i,testId:d}){const u=o?"button":"div";return e.jsxs(u,{type:o?"button":void 0,onClick:r?void 0:o,disabled:r,"data-testid":d,className:M("bg-background flex w-full items-center gap-3 rounded-xl px-4 py-3.5","transition-colors",o&&!r&&"hover:bg-muted/50 active:bg-muted",r&&"cursor-not-allowed",i),children:[t&&e.jsx("span",{className:"bg-muted text-foreground flex size-8 shrink-0 items-center justify-center rounded-lg",children:t}),e.jsx("span",{className:M("flex-1 text-left text-sm font-medium",r&&"text-muted-foreground"),children:s}),c??e.jsxs(e.Fragment,{children:[n&&e.jsx("span",{className:"text-muted-foreground text-sm",children:n}),a&&o&&e.jsx(Ce,{className:"text-muted-foreground/50 size-5"})]})]})}ve.__docgenInfo={description:"",methods:[],displayName:"SettingsItem",props:{icon:{required:!1,tsType:{name:"union",raw:"ReactNode | undefined",elements:[{name:"ReactNode"},{name:"undefined"}]},description:""},label:{required:!0,tsType:{name:"string"},description:""},value:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},showChevron:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"",defaultValue:{value:"true",computed:!1}},disabled:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"",defaultValue:{value:"false",computed:!1}},onClick:{required:!1,tsType:{name:"union",raw:"(() => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},trailing:{required:!1,tsType:{name:"union",raw:"ReactNode | undefined",elements:[{name:"ReactNode"},{name:"undefined"}]},description:""},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:" className"},testId:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:" ID"}}};function ts({title:t,children:s,className:n}){return e.jsxs("section",{className:M("space-y-1",n),children:[t&&e.jsx("h3",{className:"mb-2 px-1 text-xs font-medium uppercase text-muted-foreground",children:t}),e.jsx("div",{className:"overflow-hidden rounded-xl bg-card shadow-sm",children:s})]})}ts.__docgenInfo={description:"",methods:[],displayName:"SettingsSection",props:{title:{required:!1,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},className:{required:!1,tsType:{name:"string"},description:" className"}}};const Qx=[{value:"system",icon:$m},{value:"light",icon:uf},{value:"dark",icon:Qm}];function $c({open:t,onOpenChange:s}){const{t:n}=L("settings"),a=ma(),r=o=>{ms.setTheme(o),s(!1)};return e.jsx(ht,{open:t,onOpenChange:s,children:e.jsxs(xt,{side:"bottom",className:"rounded-t-2xl",children:[e.jsx(gt,{children:e.jsx(vt,{children:n("appearance.title")})}),e.jsx("div",{className:"mt-4 space-y-2",children:Qx.map(({value:o,icon:c})=>e.jsxs("button",{onClick:()=>r(o),className:M("flex w-full items-center gap-3 rounded-xl p-4 transition-colors",a===o?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx(c,{size:24}),e.jsx("span",{className:"flex-1 text-left font-medium",children:n(`appearance.${o}`)}),a===o&&e.jsx(fe,{size:20})]},o))})]})})}$c.__docgenInfo={description:"",methods:[],displayName:"AppearanceSheet",props:{open:{required:!0,tsType:{name:"boolean"},description:""},onOpenChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(open: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"open"}],return:{name:"void"}}},description:""}}};function Tn(t){return t.apis.find(n=>n.type==="biowallet-v1")?.endpoint??null}async function Yx(t,s){return{amount:(await $i(t.id).transaction.estimateFee({from:s,to:s,amount:ce.fromRaw("1",t.decimals,t.symbol)})).standard.amount,symbol:t.symbol}}async function Xx(t,s){const a=await $i(t.id).asset.getNativeBalance(s);return{assetType:a.symbol,name:t.name,amount:a.amount,decimals:a.amount.decimals}}async function oi({chainConfig:t,walletId:s,password:n,fromAddress:a,toAddress:r,amount:o,fee:c,twoStepSecret:i}){let d;try{d=await un.getMnemonic(s,n)}catch(m){return m instanceof mn&&m.code===fn.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:m instanceof Error?m.message:""}}if(!o.isPositive())return{status:"error",message:""};const u=Tn(t);if(!u)return{status:"error",message:"API URL "};try{console.log("[submitBioforestTransfer] Starting transfer:",{apiUrl:u,fromAddress:a,toAddress:r,amount:o.toRawString()});const m=await vn(u,a);if(console.log("[submitBioforestTransfer] Address info:",{hasSecondPubKey:!!m.secondPublicKey}),m.secondPublicKey&&!i)return console.log("[submitBioforestTransfer] Pay password required"),{status:"password_required",secondPublicKey:m.secondPublicKey};if(i&&m.secondPublicKey){console.log("[submitBioforestTransfer] Verifying pay password...");const g=await Bi(t.id,d,i,m.secondPublicKey);if(console.log("[submitBioforestTransfer] Pay password verification result:",g),!g)return{status:"error",message:""}}console.log("[submitBioforestTransfer] Creating transaction...");const f=await du({baseUrl:u,chainId:t.id,mainSecret:d,paySecret:i,from:a,to:r,amount:o.toRawString(),assetType:t.symbol,fee:c?.toRawString()}),h=f.signature;return console.log("[submitBioforestTransfer] Transaction created:",h?.slice(0,20)),console.log("[submitBioforestTransfer] Broadcasting..."),await Li(u,f).catch(g=>{console.warn("[submitBioforestTransfer] Broadcast warning (may still succeed):",g.message)}),console.log("[submitBioforestTransfer] SUCCESS! txHash:",h),{status:"ok",txHash:h}}catch(m){console.error("[submitBioforestTransfer] FAILED:",m);const f=m instanceof Error?m.message:String(m);return f.includes("insufficient")||f.includes("")?{status:"error",message:""}:f.includes("fee")||f.includes("")?{status:"error",message:""}:{status:"error",message:f||""}}}async function Zx({chainConfig:t,walletId:s,password:n,fromAddress:a,newTwoStepSecret:r}){let o;try{o=await un.getMnemonic(s,n)}catch(i){return i instanceof mn&&i.code===fn.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:i instanceof Error?i.message:""}}const c=Tn(t);if(!c)return{status:"error",message:"API URL "};try{if((await vn(c,a)).secondPublicKey)return{status:"already_set"};console.log("[submitSetTwoStepSecret] Creating signature transaction...");const d=await lu({baseUrl:c,chainId:t.id,mainSecret:o,newPaySecret:r});return console.log("[submitSetTwoStepSecret] Pay password set successfully:",d.txHash),{status:"ok",txHash:d.txHash}}catch(i){console.error("[submitSetTwoStepSecret] Failed to set pay password:",i);const d=i instanceof Error?i.message:String(i);return d.includes("fee")||d.includes("")?{status:"error",message:""}:{status:"error",message:d||""}}}async function eg(t){const s=Tn(t);if(!s)return null;try{const n=await cu(s,t.id);return{amount:ce.fromRaw(n,t.decimals,t.symbol),symbol:t.symbol}}catch(n){return console.error("[getSetTwoStepSecretFee] Failed to get fee:",n),null}}async function tg(t,s){const n=Tn(t);if(!n)return!1;try{return!!(await vn(n,s)).secondPublicKey}catch{return!1}}const ne=Oh,qc=qh;function sn({title:t,children:s,className:n}){return e.jsxs("div",{className:M("bg-background rounded-t-2xl",n),children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),t&&e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t})}),s,e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}sn.__docgenInfo={description:"Standard sheet content wrapper with handle, title, and safe area",methods:[],displayName:"SheetContent",props:{title:{required:!1,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const sg={ethereum:"Ethereum",bitcoin:"Bitcoin",tron:"Tron",binance:"BSC",bfmeta:"BFMeta",ccchain:"CCChain",pmchain:"PMChain",bfchainv2:"BFChain V2",btgmeta:"BTGMeta",biwmeta:"BIWMeta",ethmeta:"ETHMeta",malibu:"Malibu"};function ng(t,s=10,n=8){return t.length<=s+n+3?t:`${t.slice(0,s)}...${t.slice(-n)}`}const Hc=()=>{const{t}=L(["home","common"]),{pop:s}=V(),n=ye(),a=Ke(),r=bo(),o=c=>{de.setSelectedChain(c),s()};return e.jsx(ne,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("home:wallet.selectNetwork")})}),e.jsx("div",{"data-testid":"chain-sheet",className:"max-h-[60vh] space-y-2 overflow-y-auto p-4",children:r.map(c=>{const i=n?.chainAddresses.find(d=>d.chain===c);return e.jsxs("button",{"data-testid":`chain-option-${c}`,onClick:()=>o(c),className:`flex w-full items-center gap-3 rounded-xl p-4 transition-colors ${c===a?"bg-primary/10 ring-1 ring-primary":"bg-muted/50 hover:bg-muted"}`,children:[e.jsx(Ct,{chain:c,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:sg[c]??c}),e.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:i?.address?ng(i.address):"---"})]}),c===a&&e.jsx(fe,{className:"size-5 text-primary"})]},c)})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};Hc.__docgenInfo={description:"",methods:[],displayName:"ChainSelectorJob"};const ci={"/":"MainTabsActivity","/wallet/list":"WalletListActivity","/wallet/create":"WalletCreateActivity","/send":"SendActivity","/receive":"ReceiveActivity","/settings":"SettingsActivity","/settings/language":"SettingsLanguageActivity","/settings/currency":"SettingsCurrencyActivity","/settings/chains":"SettingsChainsActivity","/settings/mnemonic":"SettingsMnemonicActivity","/settings/wallet-lock":"SettingsWalletLockActivity","/settings/wallet-chains":"SettingsWalletChainsActivity","/settings/storage":"SettingsStorageActivity","/history":"HistoryActivity","/scanner":"ScannerActivity","/onboarding/recover":"OnboardingRecoverActivity","/address-book":"AddressBookActivity","/notifications":"NotificationsActivity","/staking":"StakingActivity","/welcome":"WelcomeActivity"},ag=[{pattern:/^\/wallet\/([^/]+)$/,activity:"WalletConfigActivity",paramExtractor:t=>({walletId:t[1]??""})},{pattern:/^\/transaction\/([^/]+)$/,activity:"TransactionDetailActivity",paramExtractor:t=>({txId:t[1]??""})},{pattern:/^\/authorize\/address\/([^/]+)$/,activity:"AuthorizeAddressActivity",paramExtractor:t=>({id:t[1]??""})},{pattern:/^\/authorize\/signature\/([^/]+)$/,activity:"AuthorizeSignatureActivity",paramExtractor:t=>({id:t[1]??""})},{pattern:/^\/token\/([^/]+)$/,activity:"TokenDetailActivity",paramExtractor:t=>({tokenId:t[1]??""})}];function rg(t){if(ci[t])return{activity:ci[t],params:{}};for(const{pattern:s,activity:n,paramExtractor:a}of ag){const r=t.match(s);if(r)return{activity:n,params:a(r)}}return null}function Z(){const t=V();return{navigate:a=>{const r=typeof a=="string"?{to:a}:a,o=rg(r.to);if(!o){console.warn(`[useNavigation] Unknown route: ${r.to}`);return}const c={...o.params,...r.search};r.replace?t.replace(o.activity,c,{animate:!0}):t.push(o.activity,c,{animate:!0})},goBack:()=>{t.pop()}}}const Uc=l.createContext({});function ee({params:t,children:s}){return e.jsx(Uc.Provider,{value:t,children:s})}function ae(){return l.useContext(Uc)}ee.__docgenInfo={description:"",methods:[],displayName:"ActivityParamsProvider",props:{params:{required:!0,tsType:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""}}};function ig(){const{t}=L("wallet"),{pop:s}=V(),{walletId:n}=ae(),r=Pt().find(u=>u.id===n),[o,c]=l.useState(r?.name??"");l.useEffect(()=>{r&&c(r.name)},[r]);const i=l.useCallback(()=>{if(!r)return;const u=o.trim();u&&(de.updateWalletName(r.id,u),s())},[r,o,s]);if(!r)return null;const d=o.trim().length>0&&o.trim()!==r.name;return e.jsx(ne,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("editSheet.renameTitle")})}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"wallet-name",className:"text-sm font-medium",children:t("editSheet.walletName")}),e.jsx("input",{id:"wallet-name",type:"text",value:o,onChange:u=>c(u.target.value),placeholder:t("editSheet.walletNamePlaceholder"),maxLength:20,className:M("w-full rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")}),e.jsxs("p",{className:"text-right text-xs text-muted-foreground",children:[o.length,"/20"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:i,disabled:!d,className:M("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t("editSheet.save")}),e.jsx("button",{onClick:()=>s(),className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("editSheet.cancel")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Jc=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(ig,{})});Jc.__docgenInfo={description:"",methods:[],displayName:"WalletRenameJob"};function og(){const{t}=L("wallet"),{pop:s}=V(),{navigate:n}=Z(),{walletId:a}=ae(),o=Pt().find(g=>g.id===a),[c,i]=l.useState([]),[d,u]=l.useState(!1),[m,f]=l.useState(!1),h=l.useCallback(async g=>{if(!(!o||g.length<4)){if(!o.encryptedMnemonic){de.deleteWallet(o.id),n({to:"/"});return}f(!0),u(!1);try{const v=St(g);if(!await pt(o.encryptedMnemonic,v)){u(!0),i([]);return}de.deleteWallet(o.id),n({to:"/"})}catch{u(!0),i([])}finally{f(!1)}}},[o,n]);return o?e.jsx(ne,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("editSheet.deleteTitle")})}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsx("p",{className:"text-center text-muted-foreground",children:t("editSheet.deleteWarning",{name:o.name})}),e.jsx(Kt,{value:c,onChange:i,onComplete:h,minPoints:4,error:d,disabled:m}),e.jsx("div",{className:"space-y-3",children:e.jsx("button",{onClick:()=>s(),disabled:m,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("editSheet.cancel")})})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}):null}const Vc=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(og,{})});Vc.__docgenInfo={description:"",methods:[],displayName:"WalletDeleteJob"};let nn=null,Va=null;function rt(t,s){nn=t,Va=null}function cg(){nn=null,Va=null}function lg(){const{t}=L("security"),{pop:s}=V(),{title:n,description:a,biometricAvailable:r}=ae(),[o,c]=l.useState([]),[i,d]=l.useState(!1),[u,m]=l.useState(!1),f=l.useRef(null),h=l.useRef(null),g=l.useRef(null),v=l.useRef(!1);!v.current&&nn&&(h.current=nn,g.current=Va,cg(),v.current=!0);const p=n??t("patternLock.unlockTitle"),b=r==="true"&&g.current,y=l.useCallback(()=>{f.current&&(clearTimeout(f.current),f.current=null),d(!1)},[]),x=l.useCallback(w=>{i&&w.length>0&&y(),c(w)},[i,y]),j=l.useCallback(async w=>{const S=h.current;if(!(w.length<4||!S)){m(!0),y();try{const C=St(w);await S(C)?s():(d(!0),c([]),f.current=setTimeout(()=>{d(!1)},1500))}catch{d(!0),c([]),f.current=setTimeout(()=>{d(!1)},1500)}finally{m(!1)}}},[s,y]),N=l.useCallback(async()=>{const w=g.current;if(w){m(!0),y();try{await w()?s():(d(!0),f.current=setTimeout(()=>{d(!1)},1500))}catch{d(!0),f.current=setTimeout(()=>{d(!1)},1500)}finally{m(!1)}}},[s,y]);return e.jsx(ne,{"data-testid":"wallet-lock-dialog",children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsxs("div",{className:"px-4 pb-4 text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:p}),a&&e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:a})]}),e.jsx("div",{className:"px-4 pb-4",children:e.jsx(Kt,{value:o,onChange:x,onComplete:j,minPoints:4,error:i,disabled:u,"data-testid":"wallet-lock-pattern"})}),e.jsxs("div",{className:"space-y-3 px-4 pb-4",children:[b&&e.jsxs("button",{type:"button",onClick:N,disabled:u,className:M("flex w-full items-center justify-center gap-2 rounded-full border border-border py-3 font-medium transition-colors","hover:bg-muted","disabled:cursor-not-allowed disabled:opacity-50"),children:[e.jsx(Um,{className:"size-5"}),e.jsx("span",{children:t("walletLock.biometric")})]}),e.jsx("button",{type:"button",onClick:()=>s(),disabled:u,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("walletLock.cancel")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Kc=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(lg,{})});Kc.__docgenInfo={description:"",methods:[],displayName:"WalletLockConfirmJob"};let dg=null;function ug(){const{t}=L(["security","transaction","common"]),{pop:s}=V(),{title:n,description:a}=ae(),[r,o]=l.useState(""),[c,i]=l.useState(),[d,u]=l.useState(!1),m=l.useRef(null);l.useRef(!1).current;const h=n??t("security:twoStepSecret.confirmTitle"),g=a??t("security:twoStepSecret.confirmDesc"),v=l.useCallback(async b=>{b.preventDefault();const y=m.current;if(!(!r.trim()||!y)){u(!0),i(void 0);try{await y(r)?s():i(t("security:twoStepSecret.notMatch"))}catch{i(t("security:twoStepSecret.notMatch"))}finally{u(!1)}}},[r,s,t]),p=r.trim().length>0&&!d;return e.jsx(ne,{"data-testid":"two-step-secret-dialog",children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(gn,{className:"size-5 text-primary"}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:h})]})}),e.jsxs("form",{onSubmit:v,className:"space-y-6 p-4",children:[e.jsx("p",{className:"text-center text-muted-foreground text-sm",children:g}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(qs,{value:r,onChange:b=>o(b.target.value),placeholder:t("security:twoStepSecret.inputPlaceholder"),disabled:d,"aria-describedby":c?"two-step-secret-error":void 0,"data-testid":"two-step-secret-input"}),c&&e.jsxs("div",{id:"two-step-secret-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(It,{className:"size-4"}),e.jsx("span",{children:c})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{type:"submit",disabled:!p,"data-testid":"two-step-secret-confirm-button",className:M("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(d?"security:walletLock.verifying":"common:confirm")}),e.jsx("button",{type:"button",onClick:()=>s(),disabled:d,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("security:walletLock.cancel")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Gc=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(ug,{})});Gc.__docgenInfo={description:"",methods:[],displayName:"TwoStepSecretConfirmJob"};function Ka({status:t,txHash:s,title:n,description:a,errorMessage:r,checkConfirmed:o,onStatusChange:c,onDone:i,onRetry:d,onViewDetails:u,onShare:m,pollInterval:f=1e4,maxPollAttempts:h=18,children:g}){const{t:v}=L(["transaction","common"]),[p,b]=l.useState(t);l.useEffect(()=>{b(t)},[t]),l.useEffect(()=>{if(p!=="broadcasted"||!o)return;let C=!1,T=0;const k=async()=>{if(!(C||T>=h)){T++,T===1&&(b("confirming"),c?.("confirming"));try{await o()&&!C?(b("confirmed"),c?.("confirmed")):!C&&T<h&&setTimeout(k,f)}catch{!C&&T<h&&setTimeout(k,f)}}},I=setTimeout(k,3e3);return()=>{C=!0,clearTimeout(I)}},[p,o,c,f,h]);const y=()=>{switch(p){case"broadcasting":return n?.broadcasting??v("transaction:txStatus.broadcasting");case"broadcasted":return n?.broadcasted??v("transaction:txStatus.broadcasted");case"confirming":return n?.confirming??v("transaction:txStatus.confirming");case"confirmed":return n?.confirmed??v("transaction:txStatus.confirmed");case"failed":return n?.failed??v("transaction:txStatus.failed")}},x=()=>{if(p==="failed"&&r)return r;switch(p){case"broadcasting":return a?.broadcasting??v("transaction:txStatus.broadcastingDesc");case"broadcasted":return a?.broadcasted??v("transaction:txStatus.broadcastedDesc");case"confirming":return a?.confirming??v("transaction:txStatus.confirmingDesc");case"confirmed":return a?.confirmed??v("transaction:txStatus.confirmedDesc");case"failed":return a?.failed??v("transaction:txStatus.failedDesc")}},j=()=>{switch(p){case"broadcasting":case"confirming":return e.jsx(ke,{className:"size-8 animate-spin"});case"broadcasted":return e.jsx(fe,{className:"size-8"});case"confirmed":return e.jsx(fe,{className:"size-8"});case"failed":return e.jsx(It,{className:"size-8"})}},N=()=>{switch(p){case"broadcasting":case"confirming":return"bg-blue-100 text-blue-600";case"broadcasted":return"bg-blue-100 text-blue-600";case"confirmed":return"bg-green-100 text-green-600";case"failed":return"bg-red-100 text-red-600"}},w=p==="confirmed"||p==="broadcasted"||p==="confirming",S=p==="failed"&&d;return e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 p-8",children:[e.jsx("div",{className:M("flex size-16 items-center justify-center rounded-full",N()),children:j()}),e.jsx("h2",{className:"text-lg font-semibold",children:y()}),e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:x()}),s&&e.jsxs("p",{className:"text-xs text-muted-foreground font-mono truncate max-w-full px-4",children:[s.slice(0,16),"...",s.slice(-16)]}),g,w&&e.jsxs("div",{className:"flex w-full max-w-xs flex-col gap-2",children:[i&&e.jsx("button",{type:"button",onClick:i,"data-testid":"tx-status-done-button",className:M("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90"),children:v("common:done")}),e.jsxs("div",{className:"flex gap-2",children:[u&&e.jsx("button",{type:"button",onClick:u,"data-testid":"tx-status-view-details-button",className:"flex-1 rounded-full border border-border py-2 text-sm font-medium transition-colors hover:bg-muted",children:v("transaction:txStatus.viewDetails")}),m&&e.jsx("button",{type:"button",onClick:m,"data-testid":"tx-status-share-button",className:"flex-1 rounded-full border border-border py-2 text-sm font-medium transition-colors hover:bg-muted",children:v("common:share")})]})]}),S&&e.jsx("button",{type:"button",onClick:d,"data-testid":"tx-status-retry-button",className:M("w-full max-w-xs rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90"),children:v("common:retry")})]})}Ka.__docgenInfo={description:"",methods:[],displayName:"TxStatusDisplay",props:{status:{required:!0,tsType:{name:"union",raw:'"broadcasting" | "broadcasted" | "confirming" | "confirmed" | "failed"',elements:[{name:"literal",value:'"broadcasting"'},{name:"literal",value:'"broadcasted"'},{name:"literal",value:'"confirming"'},{name:"literal",value:'"confirmed"'},{name:"literal",value:'"failed"'}]},description:""},txHash:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},title:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  broadcasting?: string;
  broadcasted?: string;
  confirming?: string;
  confirmed?: string;
  failed?: string;
}`,signature:{properties:[{key:"broadcasting",value:{name:"string",required:!1}},{key:"broadcasted",value:{name:"string",required:!1}},{key:"confirming",value:{name:"string",required:!1}},{key:"confirmed",value:{name:"string",required:!1}},{key:"failed",value:{name:"string",required:!1}}]}},description:""},description:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  broadcasting?: string;
  broadcasted?: string;
  confirming?: string;
  confirmed?: string;
  failed?: string;
}`,signature:{properties:[{key:"broadcasting",value:{name:"string",required:!1}},{key:"broadcasted",value:{name:"string",required:!1}},{key:"confirming",value:{name:"string",required:!1}},{key:"confirmed",value:{name:"string",required:!1}},{key:"failed",value:{name:"string",required:!1}}]}},description:""},errorMessage:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},checkConfirmed:{required:!1,tsType:{name:"union",raw:"(() => Promise<boolean>) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},onStatusChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(status: TxStatus) => void",signature:{arguments:[{type:{name:"union",raw:'"broadcasting" | "broadcasted" | "confirming" | "confirmed" | "failed"',elements:[{name:"literal",value:'"broadcasting"'},{name:"literal",value:'"broadcasted"'},{name:"literal",value:'"confirming"'},{name:"literal",value:'"confirmed"'},{name:"literal",value:'"failed"'}]},name:"status"}],return:{name:"void"}}},description:""},onDone:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onRetry:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onViewDetails:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onShare:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},pollInterval:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"10000",computed:!1}},maxPollAttempts:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"18",computed:!1}},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};let as=null,an=null;function Qc(t,s){as=t,an=s}function li(){as=null,an=null}function mg(){const{t}=L(["transaction","common"]),{pop:s}=V();ae();const n=l.useRef(as),a=l.useRef(an),r=l.useRef(!1);!r.current&&as&&(n.current=as,a.current=an,li(),r.current=!0);const o=n.current,[c,i]=l.useState(o?.currentFee??""),[d,u]=l.useState();l.useEffect(()=>()=>{li()},[]);const m=l.useCallback(y=>{if(!o)return;const x=parseFloat(y),j=parseFloat(o.minFee);if(isNaN(x)||x<=0)return t("transaction:feeEdit.invalidFee");if(x<j)return t("transaction:feeEdit.belowMinFee",{minFee:o.minFee,symbol:o.symbol})},[o,t]),f=l.useCallback(y=>{const x=y.target.value;(x===""||/^\d*\.?\d*$/.test(x))&&(i(x),u(void 0))},[]),h=l.useCallback(y=>{i(y),u(void 0)},[]),g=l.useCallback(y=>{y.preventDefault();const x=m(c);if(x){u(x);return}a.current?.({fee:c}),s()},[c,m,s]),v=l.useCallback(()=>{s()},[s]);if(!o)return null;const p=[{label:t("transaction:feeEdit.presetMin"),value:o.minFee}],b=o.presets??p;return e.jsx(qc,{children:e.jsxs("div",{className:"bg-background rounded-2xl p-4","data-testid":"fee-edit-modal",children:[e.jsx("h2",{className:"mb-4 text-center text-lg font-semibold",children:t("transaction:feeEdit.title")}),e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 text-sm text-muted-foreground",children:[e.jsxs("p",{children:[t("transaction:feeEdit.currentFee"),": ",o.currentFee," ",o.symbol]}),e.jsxs("p",{children:[t("transaction:feeEdit.minFee"),": ",o.minFee," ",o.symbol]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:b.map(y=>e.jsx("button",{type:"button",onClick:()=>h(y.value),className:M("rounded-full px-3 py-1 text-sm transition-colors",c===y.value?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:y.label},y.value))}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("transaction:feeEdit.customFee")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pe,{type:"text",inputMode:"decimal",value:c,onChange:f,placeholder:o.minFee,className:M(d&&"border-destructive"),"data-testid":"fee-input"}),e.jsx("span",{className:"shrink-0 text-sm text-muted-foreground",children:o.symbol})]}),d&&e.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(It,{className:"size-4"}),e.jsx("span",{children:d})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx($,{type:"button",variant:"outline",onClick:v,className:"flex-1",children:t("common:cancel")}),e.jsx($,{type:"submit",className:"flex-1",disabled:!c,children:t("common:confirm")})]})]})]})})}const Yc=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(mg,{})});Yc.__docgenInfo={description:"",methods:[],displayName:"FeeEditJob"};let rs=null,rn=null,on=null,cn="";function fg(t,s,n){rs=t,rn=n??null,s&&(on=s.amount,cn=s.symbol)}function pg(){rs=null,rn=null,on=null,cn=""}function hg(){const{t}=L(["security","transaction","common"]),{pop:s,push:n}=V(),{chainId:a,chainIcon:r,chainSymbol:o,address:c,chainName:i}=ae(),[d,u]=l.useState(""),[m,f]=l.useState(""),[h,g]=l.useState([]),[v,p]=l.useState(!1),[b,y]=l.useState("input"),[x,j]=l.useState(),[N,w]=l.useState(!1),[S,C]=l.useState("idle"),[T,k]=l.useState(),[I,D]=l.useState(null),_=l.useRef(rs),A=l.useRef(rn),R=l.useRef({amount:on,symbol:cn}),E=I??R.current.amount?.toDisplayString()??"0";l.useEffect(()=>(rs&&!_.current&&(_.current=rs,A.current=rn,R.current={amount:on,symbol:cn}),()=>{pg()}),[]);const B=l.useCallback(()=>{const q=R.current.amount?.toDisplayString()??"0";Qc({currentFee:E,minFee:q,symbol:R.current.symbol},K=>{D(K.fee)}),n("FeeEditJob",{})},[E,n]),P=l.useCallback(()=>{if(j(void 0),b==="input"){if(!d.trim())return;y("confirm")}else if(b==="confirm"){if(d!==m){j(t("security:twoStepSecret.notMatch"));return}y("walletLock")}},[b,d,m,t]),z=l.useCallback(async q=>{const K=_.current;if(q.length<4||!K)return;w(!0),C("broadcasting"),j(void 0),p(!1);const oe=St(q);try{const Y=await K(d,oe);Y.success?(k(Y.txHash),C("broadcasted")):(C("idle"),p(!0),g([]),j(Y.error??t("security:twoStepSecret.setFailed")))}catch{C("idle"),p(!0),g([]),j(t("security:twoStepSecret.setFailed"))}finally{w(!1)}},[d,t]);return S!=="idle"?e.jsx(ne,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx(Ka,{status:S,txHash:T,title:{confirmed:t("security:twoStepSecret.txConfirmed")},description:{confirmed:t("security:twoStepSecret.setSuccessDesc")},checkConfirmed:A.current??void 0,onStatusChange:C,onDone:()=>s()}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}):e.jsx(ne,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl","data-testid":"set-two-step-secret-dialog",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsxs("div",{className:"border-b border-border px-4 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(gn,{className:"size-5 text-primary"}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("security:twoStepSecret.setTitle")})]}),a&&c?e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(iu,{chainId:a,chainIcon:r,chainSymbol:o,address:c,size:"sm"})}):i?e.jsx("p",{className:"mt-1 text-center text-sm text-muted-foreground",children:i}):null]}),e.jsxs("div",{className:"space-y-6 p-4",children:[R.current.amount&&e.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-muted/50 p-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:t("security:twoStepSecret.feeInfo")}),e.jsx(va,{amount:E,symbol:R.current.symbol,editable:!0,onEdit:B})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:M("size-2 rounded-full",b==="input"?"bg-primary":"bg-muted")}),e.jsx("div",{className:M("size-2 rounded-full",b==="confirm"?"bg-primary":"bg-muted")}),e.jsx("div",{className:M("size-2 rounded-full",b==="walletLock"?"bg-primary":"bg-muted")})]}),b==="input"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:t("security:twoStepSecret.inputDesc")}),e.jsx(qs,{value:d,onChange:q=>u(q.target.value),placeholder:t("security:twoStepSecret.inputPlaceholder"),"aria-describedby":x?"two-step-secret-error":void 0,"data-testid":"new-two-step-secret-input"})]}),b==="confirm"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:t("security:twoStepSecret.confirmDesc")}),e.jsx(qs,{value:m,onChange:q=>f(q.target.value),placeholder:t("security:twoStepSecret.confirmPlaceholder"),"aria-describedby":x?"two-step-secret-error":void 0,"data-testid":"confirm-two-step-secret-input"})]}),b==="walletLock"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:t("security:twoStepSecret.walletLockDesc")}),e.jsx(Kt,{value:h,onChange:g,onComplete:z,minPoints:4,error:v,disabled:N,"data-testid":"wallet-lock-pattern"})]}),x&&e.jsxs("div",{id:"two-step-secret-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(It,{className:"size-4"}),e.jsx("span",{children:x})]}),e.jsxs("div",{className:"space-y-3",children:[b!=="walletLock"&&e.jsx("button",{type:"button",onClick:P,"data-testid":"set-two-step-secret-next-button",className:M("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90"),children:t("common:next")}),e.jsx("button",{type:"button",onClick:()=>{b==="input"?s():b==="confirm"?(y("input"),j(void 0)):(y("confirm"),j(void 0),p(!1),g([]))},disabled:N,"data-testid":"set-two-step-secret-cancel-button",className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t(b==="input"?"common:cancel":"common:back")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Xc=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(hg,{})});Xc.__docgenInfo={description:"",methods:[],displayName:"SetTwoStepSecretJob"};let ca=null;function xg(){ca=null}const gg=[{value:"english",label:"English"},{value:"zh-Hans",label:""},{value:"zh-Hant",label:""}],vg=[12,15,18,21,24,36];function bg(){const{t}=L("onboarding"),{pop:s}=V(),{language:n,length:a}=ae(),[r,o]=l.useState({language:n||"english",length:Number(a)||12}),c=u=>{o(m=>({...m,language:u}))},i=u=>{o(m=>({...m,length:u}))},d=()=>{ca&&ca(r),xg(),s()};return e.jsx(ne,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("create.mnemonicOptions.title")})}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:t("create.mnemonicOptions.language")}),e.jsx("div",{className:"space-y-1",role:"radiogroup",children:gg.map(u=>e.jsxs("button",{type:"button",role:"radio","aria-checked":r.language===u.value,onClick:()=>c(u.value),className:M("flex w-full items-center justify-between rounded-lg px-4 py-3","transition-colors hover:bg-muted/50",r.language===u.value&&"bg-muted"),children:[e.jsx("span",{className:"text-sm",children:u.label}),r.language===u.value&&e.jsx(fe,{className:"size-5 text-primary"})]},u.value))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:t("create.mnemonicOptions.wordCount")}),e.jsx("div",{className:"grid grid-cols-3 gap-2",role:"radiogroup",children:vg.map(u=>e.jsxs("button",{type:"button",role:"radio","aria-checked":r.length===u,onClick:()=>i(u),className:M("flex items-center justify-center rounded-lg py-3 text-sm font-medium","transition-colors",r.length===u?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:[u," ",t("create.mnemonicOptions.words")]},u))})]}),e.jsx("button",{type:"button",onClick:d,className:M("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90"),children:t("create.mnemonicOptions.confirm")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const Zc=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(bg,{})});Zc.__docgenInfo={description:"",methods:[],displayName:"MnemonicOptionsJob"};const Hn=3,yg=10;function jg(){const{t}=L("common"),{pop:s}=V(),{contactId:n}=ae(),a=le(Ft,I=>I.contacts),r=n?a.find(I=>I.id===n):null,[o,c]=l.useState(""),[i,d]=l.useState([{id:crypto.randomUUID(),label:"",address:""}]),[u,m]=l.useState(""),[f,h]=l.useState(()=>Math.floor(Math.random()*1e4)),[g,v]=l.useState(!1),p=!!r;l.useEffect(()=>{r&&(c(r.name),d(r.addresses.length>0?r.addresses.map(I=>({id:I.id,label:I.label||"",address:I.address})):[{id:crypto.randomUUID(),label:"",address:""}]),m(r.memo??""),v(!1))},[r]);const b=l.useCallback(()=>{h(Math.floor(Math.random()*1e4)),v(!0)},[]),y=i.find(I=>I.address.trim())?.address.trim(),x=!p||g?y?bt(y,f):void 0:r?.avatar||(y?bt(y,f):void 0),j=l.useCallback(()=>{i.length>=Hn||d(I=>[...I,{id:crypto.randomUUID(),label:"",address:""}])},[i.length]),N=l.useCallback(I=>{d(D=>D.length<=1?D:D.filter(_=>_.id!==I))},[]),w=l.useCallback((I,D,_)=>{d(A=>A.map(R=>R.id===I?{...R,[D]:_}:R))},[]),S=l.useCallback(()=>{const I=o.trim(),D=u.trim(),_=i.filter(R=>R.address.trim()).map((R,E)=>({id:R.id,address:R.address.trim(),label:R.label.trim()||void 0,isDefault:E===0}));if(!I||_.length===0)return;const A=!p||g?_[0]?bt(_[0].address,f):void 0:r?.avatar;p&&r?Wt.updateContact(r.id,{name:I,avatar:A,addresses:_,memo:D||void 0}):Wt.addContact({name:I,addresses:_,avatar:A,memo:D||void 0}),s()},[o,i,u,f,p,r,s]),C=i.some(I=>I.address.trim()),T=o.trim().length>0&&C,k=i.length<Hn;return e.jsx(ne,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t(p?"contact.editTitle":"contact.addTitle")})}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:b,disabled:!y,className:"group relative shrink-0",title:t("addressBook.changeAvatar"),children:[e.jsx(jn,{src:x,size:56}),y&&e.jsx("div",{className:"bg-background/80 absolute inset-0 flex items-center justify-center rounded-full opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx(gs,{className:"text-primary size-5"})})]}),e.jsx("input",{id:"contact-name",type:"text",value:o,onChange:I=>c(I.target.value),placeholder:t("contact.namePlaceholder"),maxLength:20,className:M("flex-1 rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:t("contact.addresses")}),e.jsxs("span",{className:"text-muted-foreground text-xs",children:[i.length,"/",Hn]})]}),i.map((I,D)=>e.jsxs("div",{className:"space-y-2 rounded-xl border border-border p-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:I.label,onChange:_=>w(I.id,"label",_.target.value),placeholder:t("contact.addressLabelPlaceholder"),maxLength:yg,className:M("w-24 shrink-0 rounded-lg border border-border bg-muted/50 px-3 py-2 text-sm","focus:outline-none focus:ring-2 focus:ring-primary")}),i.length>1&&e.jsx("button",{type:"button",onClick:()=>N(I.id),className:"text-muted-foreground hover:text-destructive shrink-0 p-1",children:e.jsx(Tt,{className:"size-4"})}),D===0&&e.jsx("span",{className:"bg-primary/10 text-primary rounded px-1.5 py-0.5 text-xs",children:"Default"})]}),e.jsx("input",{type:"text",value:I.address,onChange:_=>w(I.id,"address",_.target.value),placeholder:t("contact.addressPlaceholder"),className:M("w-full rounded-lg border border-border bg-background px-3 py-2 font-mono text-sm","focus:outline-none focus:ring-2 focus:ring-primary")})]},I.id)),k&&e.jsxs("button",{type:"button",onClick:j,className:"flex w-full items-center justify-center gap-2 rounded-xl border border-dashed border-border py-3 text-sm text-muted-foreground hover:border-primary hover:text-primary",children:[e.jsx(st,{className:"size-4"}),t("contact.addAddress")]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"contact-memo",className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(Oi,{className:"size-4"}),t("contact.memoOptional")]}),e.jsx("textarea",{id:"contact-memo",value:u,onChange:I=>m(I.target.value),placeholder:t("contact.memoPlaceholder"),maxLength:100,rows:2,className:M("w-full resize-none rounded-xl border border-border bg-background px-4 py-3","focus:outline-none focus:ring-2 focus:ring-primary")})]}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsx("button",{onClick:S,disabled:!T,className:M("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(p?"contact.save":"contact.add")}),e.jsx("button",{onClick:()=>s(),className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("contact.cancel")})]})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const el=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(jg,{})});el.__docgenInfo={description:"",methods:[],displayName:"ContactEditJob"};function Ng(t,s=8,n=6){return t.length<=s+n+3?t:`${t.slice(0,s)}...${t.slice(-n)}`}function wg(){const{t}=L("common"),{pop:s}=V(),{chainType:n}=ae(),a=n,[r,o]=l.useState(""),c=le(Ft),i=l.useMemo(()=>{let u=c.contacts;return r&&(u=pn.searchContacts(c,r)),u=[...u].toSorted((m,f)=>f.updatedAt-m.updatedAt),u.map(m=>{const f=m.addresses.map(g=>({...g,isValidForCurrentChain:a?qu(g.address,a):!0})),h=f.some(g=>g.isValidForCurrentChain);return{contact:m,addresses:f,hasValidAddress:h}})},[c,r,a]),d=(u,m)=>{const f=new CustomEvent("contact-picker-select",{detail:{contact:u,address:m}});window.dispatchEvent(f),s()};return e.jsx(ne,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx("div",{className:"border-border border-b px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("contact.selectAddress")})}),e.jsx("div",{className:"border-border border-b p-4",children:e.jsxs("div",{className:"bg-muted/50 flex items-center gap-2 rounded-xl px-3 py-2",children:[e.jsx(vs,{className:"text-muted-foreground size-4"}),e.jsx("input",{type:"text",value:r,onChange:u=>o(u.target.value),placeholder:t("addressBook.searchPlaceholder"),className:"placeholder:text-muted-foreground min-w-0 flex-1 bg-transparent text-sm outline-none"})]})}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto",children:i.length===0?e.jsx("div",{className:"text-muted-foreground py-12 text-center text-sm",children:t(r?"addressBook.noResults":"contact.noContacts")}):e.jsx("div",{className:"divide-border divide-y",children:i.map(({contact:u,addresses:m,hasValidAddress:f})=>e.jsxs("div",{className:M(!f&&"opacity-50"),children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 pt-3 pb-2",children:[e.jsx(jn,{src:u.avatar||(m[0]?.address?bt(m[0].address):void 0),size:40,className:"shrink-0"}),e.jsx("p",{className:"min-w-0 flex-1 truncate font-medium",children:u.name})]}),e.jsx("div",{className:"space-y-1 pb-3 pl-[56px] pr-4",children:m.map(h=>{const g=!h.isValidForCurrentChain,v=h.label;return e.jsxs("button",{onClick:()=>!g&&d(u,h),disabled:g,className:M("flex min-h-[44px] w-full items-center gap-3 rounded-xl px-3 py-2.5 transition-colors",g?"cursor-not-allowed opacity-50":"hover:bg-muted/50 active:bg-muted"),children:[e.jsx("p",{className:M("min-w-0 flex-1 truncate text-left font-mono text-sm",g?"text-muted-foreground/50":"text-foreground"),children:Ng(h.address)}),e.jsxs("div",{className:"flex shrink-0 items-center gap-2",children:[v&&e.jsx("span",{className:M("max-w-[5rem] truncate rounded-md bg-muted px-2 py-0.5 text-xs",g?"text-muted-foreground/50":"text-muted-foreground"),children:v}),h.isDefault&&e.jsx("span",{className:"bg-primary/10 text-primary rounded-md px-2 py-0.5 text-xs",children:"Default"})]})]},h.id)})})]},u.id))})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const tl=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(wg,{})});tl.__docgenInfo={description:"",methods:[],displayName:"ContactPickerJob"};const sl=()=>{const{t}=L(["wallet","home"]),{pop:s}=V(),{navigate:n}=Z(),a=()=>{s(),n({to:"/wallet/create"})},r=()=>{s(),n({to:"/onboarding/recover"})};return e.jsx(ne,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("wallet:add")})}),e.jsxs("div",{className:"space-y-3 p-4",children:[e.jsxs("button",{onClick:a,className:M("flex w-full items-center gap-4 rounded-xl p-4 transition-colors","bg-muted/50 hover:bg-muted active:bg-muted/80"),children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10",children:e.jsx(st,{className:"size-6 text-primary"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-semibold",children:t("home:welcome.createWallet")}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t("wallet:createDesc")})]})]}),e.jsxs("button",{onClick:r,className:M("flex w-full items-center gap-4 rounded-xl p-4 transition-colors","bg-muted/50 hover:bg-muted active:bg-muted/80"),children:[e.jsx("div",{className:"flex size-12 items-center justify-center rounded-full bg-primary/10",children:e.jsx(ya,{className:"size-6 text-primary"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-semibold",children:t("home:welcome.importWallet")}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t("wallet:importDesc")})]})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};sl.__docgenInfo={description:"",methods:[],displayName:"WalletAddJob"};const nl=()=>{const{t}=L(["wallet","common"]),{pop:s,push:n}=V(),a=Pt(),o=ye()?.id,{getWalletTheme:c}=Ei(),i=_i(),d=m=>{de.setCurrentWallet(m),s()},u=()=>{s(),n("WalletAddJob",{})};return e.jsx(ne,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("common:a11y.tabWallet")})}),e.jsx("div",{className:"max-h-[50vh] space-y-2 overflow-y-auto p-4",children:a.map(m=>{const f=m.id===o,h=m.chainAddresses[0]?.address,g=h?`${h.slice(0,6)}...${h.slice(-4)}`:"---",v=c(m.id);return e.jsxs("button",{onClick:()=>d(m.id),className:M("flex w-full items-center gap-3 rounded-xl p-4 transition-all","active:scale-[0.98]",f?"bg-primary/10 ring-2 ring-primary":"bg-muted/50 hover:bg-muted"),children:[e.jsx(Uu,{themeHue:v,size:"md",watermarkIconUrl:i[m.chain]}),e.jsxs("div",{className:"min-w-0 flex-1 text-left",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate font-medium",children:m.name}),f&&e.jsx(Ju,{className:"size-4 shrink-0 text-primary"})]}),e.jsx("p",{className:"truncate font-mono text-xs text-muted-foreground",children:g})]})]},m.id)})}),e.jsx("div",{className:"border-t border-border p-4",children:e.jsxs("button",{onClick:u,className:M("flex w-full items-center justify-center gap-2 rounded-xl p-4","bg-muted/50 hover:bg-muted active:bg-muted/80 transition-colors"),children:[e.jsx(st,{className:"size-5"}),e.jsx("span",{className:"font-medium",children:t("wallet:add")})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};nl.__docgenInfo={description:"",methods:[],displayName:"WalletListJob"};let la=null;function Cg(t){la=t}const al=()=>{const{t}=L(["onboarding","common"]),{pop:s}=V(),[n,a]=l.useState(!1),r=()=>{s()},o=()=>{n&&(s(),la?.(),la=null)};return e.jsx(qc,{children:e.jsxs("div",{className:"bg-background mx-4 max-w-sm rounded-2xl p-5",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"rounded-full bg-amber-500/15 p-2",children:e.jsx(Se,{className:"size-5 text-amber-600","aria-hidden":"true"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h2",{className:"text-base font-semibold",children:t("onboarding:securityWarning.title")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:t("onboarding:securityWarning.message")})]})]}),e.jsxs("label",{className:"mt-4 flex cursor-pointer items-center gap-2 text-sm",children:[e.jsx(Hi,{checked:n,onCheckedChange:a}),e.jsx("span",{children:t("onboarding:securityWarning.acknowledge")})]}),e.jsxs("div",{className:"mt-5 flex gap-2",children:[e.jsx($,{type:"button",variant:"outline",className:"flex-1",onClick:r,children:t("common:cancel")}),e.jsx($,{type:"button",className:"flex-1",onClick:o,disabled:!n,children:t("common:confirm")})]})]})})};al.__docgenInfo={description:"",methods:[],displayName:"SecurityWarningJob"};let is=null;function rl(t,s){is={onConfirm:t,minFee:s?.minFee,onFeeChange:s?.onFeeChange}}function di(){is=null}function Sg(t){return t.length<=16?t:`${t.slice(0,10)}...${t.slice(-6)}`}function kg(){const{t}=L("transaction"),{pop:s,push:n}=V(),a=ae(),[r,o]=l.useState(!1),[c,i]=l.useState(!1),[d,u]=l.useState(!1),[m,f]=l.useState(null),h=l.useRef(is),g=l.useRef(!1);!g.current&&is&&(h.current=is,di(),g.current=!0),l.useEffect(()=>()=>{di()},[]);const v=a.feeLoading==="true",p=a.feeFiatValue?parseFloat(a.feeFiatValue):void 0,b=m??a.feeAmount,y=!!h.current?.onFeeChange,x=l.useCallback(async()=>{try{await pa.write({text:a.toAddress}),i(!0),setTimeout(()=>i(!1),2e3)}catch{console.error("Failed to copy address")}},[a.toAddress]),j=l.useCallback(()=>{o(C=>!C)},[]),N=l.useCallback(()=>{const C=h.current;C?.onFeeChange&&(Qc({currentFee:b,minFee:C.minFee??a.feeAmount,symbol:a.feeSymbol},T=>{f(T.fee),C.onFeeChange?.(T.fee)}),n("FeeEditJob",{}))},[b,a.feeAmount,a.feeSymbol,n]),w=l.useCallback(async()=>{const C=h.current;if(console.log("[TransferConfirmJob] handleConfirm called, hasCallback:",!!C?.onConfirm),!(!C?.onConfirm||d)){u(!0);try{s(),console.log("[TransferConfirmJob] Executing callback..."),await C.onConfirm(),console.log("[TransferConfirmJob] Callback executed")}finally{u(!1)}}},[d,s]),S=l.useCallback(()=>{s()},[s]);return e.jsx(ne,{"data-testid":"transfer-confirm-sheet",children:e.jsx(sn,{title:t("confirmSheet.title"),children:e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-3xl font-bold",children:[a.amount," ",a.symbol]}),a.fiatValue&&e.jsxs("p",{className:"text-muted-foreground mt-1",children:[" $",a.fiatValue]})]}),e.jsxs("div",{className:"bg-muted/30 space-y-4 rounded-xl p-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:t("confirmSheet.toAddress")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:j,className:"hover:text-primary flex min-w-0 flex-1 items-center gap-1 text-left font-mono text-sm",children:[e.jsx("span",{className:M("min-w-0",r?"break-all":"truncate"),children:r?a.toAddress:Sg(a.toAddress)}),r?e.jsx(Ui,{className:"size-4 shrink-0"}):e.jsx(Vi,{className:"size-4 shrink-0"})]}),e.jsx("button",{type:"button",onClick:x,className:"text-muted-foreground hover:text-foreground shrink-0 p-1","aria-label":t(c?"confirmSheet.copied":"confirmSheet.copyAddress"),children:c?e.jsx(fe,{className:"size-4 text-green-500"}):e.jsx(Di,{className:"size-4"})})]})]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:t("confirmSheet.networkFee")}),e.jsx(va,{amount:b,symbol:a.feeSymbol,...p!==void 0&&{fiatValue:p},isLoading:v,editable:y,onEdit:N})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button","data-testid":"cancel-transfer-button",onClick:S,className:"border-border hover:bg-muted flex-1 rounded-full border py-3 font-medium transition-colors",disabled:d,children:t("confirmSheet.cancel")}),e.jsx("button",{type:"button","data-testid":"confirm-transfer-button",onClick:w,disabled:d||v,className:M("flex-1 rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(d?"confirmSheet.confirming":"confirmSheet.confirm")})]})]})})})}const il=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(kg,{})});il.__docgenInfo={description:"",methods:[],displayName:"TransferConfirmJob"};let ln=null;function ol(t){ln=t}function Ag(){ln=null}function Tg(){const{t}=L(["security","transaction","common"]),{pop:s,push:n}=V(),{title:a}=ae(),r=ka(),o=nt(),[c,i]=l.useState("wallet_lock"),[d,u]=l.useState([]),[m,f]=l.useState(""),[h,g]=l.useState("idle"),[v,p]=l.useState(),[b,y]=l.useState(),[x,j]=l.useState(!1),[N,w]=l.useState(!1),S=l.useRef(null),C=l.useRef(""),T=l.useRef(!1);!T.current&&ln&&(S.current=ln,Ag(),T.current=!0);const k=c==="wallet_lock"?a??t("security:walletLock.verifyTitle"):t("transaction:sendPage.twoStepSecretTitle"),I=l.useCallback(async R=>{const E=S.current;if(R.length<4||!E)return;w(!0),y(void 0),j(!1);const B=St(R);C.current=B;try{const P=await E(B);if(P.status==="ok"){P.txHash&&p(P.txHash),g("broadcasted");return}if(P.status==="wallet_lock_invalid"){j(!0),u([]);return}if(P.status==="two_step_secret_required"){i("two_step_secret"),y(void 0);return}P.status==="error"&&y(P.message??t("security:walletLock.error"))}catch{j(!0),u([])}finally{w(!1)}},[t]),D=l.useCallback(async()=>{const R=S.current;if(!(!m.trim()||!R)){w(!0),y(void 0);try{const E=await R(C.current,m);if(E.status==="ok"){E.txHash&&p(E.txHash),g("broadcasted");return}(E.status==="two_step_secret_invalid"||E.status==="error")&&y(E.message??t("transaction:sendPage.twoStepSecretError"))}catch{y(t("transaction:sendPage.twoStepSecretError"))}finally{w(!1)}}},[m,t]),_=l.useCallback(R=>{R.preventDefault(),c==="two_step_secret"&&D()},[c,D]),A=m.trim().length>0&&!N;return h!=="idle"?e.jsx(ne,{children:e.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx(Ka,{status:h,txHash:v,title:{broadcasted:t("transaction:sendResult.success"),confirmed:t("transaction:sendResult.success")},description:{broadcasted:t("transaction:txStatus.broadcastedDesc"),confirmed:t("transaction:txStatus.confirmedDesc")},onStatusChange:g,onDone:()=>s(),onViewDetails:()=>{s(),v&&n("TransactionDetailActivity",{txId:v})},onShare:async()=>{v&&(await r.write({text:v}),o.show(t("common:copied")))}}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}):c==="wallet_lock"?e.jsx(ne,{children:e.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:e.jsx(sn,{title:k,children:e.jsxs("div",{className:"p-4",children:[e.jsx(Kt,{value:d,onChange:u,onComplete:I,minPoints:4,error:x,disabled:N,"data-testid":"transfer-wallet-lock-pattern"}),e.jsx("button",{type:"button",onClick:()=>s(),disabled:N,className:"mt-4 w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("common:cancel")})]})})})}):e.jsx(ne,{children:e.jsx("div",{"data-testid":"transfer-wallet-lock-dialog",children:e.jsx(sn,{title:k,children:e.jsxs("form",{onSubmit:_,className:"space-y-6 p-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-primary mb-2",children:[e.jsx(gn,{className:"size-5"}),e.jsx("span",{className:"text-sm",children:t("transaction:sendPage.twoStepSecretDescription")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(qs,{value:m,onChange:R=>f(R.target.value),placeholder:t("transaction:sendPage.twoStepSecretPlaceholder"),disabled:N,"aria-describedby":b?"two-step-error":void 0,"data-testid":"two-step-secret-input"}),m.length>0&&m.length<6&&e.jsx("div",{className:"absolute right-10 top-1/2 -translate-y-1/2",children:e.jsx("span",{className:"text-xs text-amber-500",children:t("security:twoStepSecret.lengthHint",{count:m.length})})})]}),b&&e.jsxs("div",{id:"two-step-error",className:"flex items-center gap-1.5 text-sm text-destructive",children:[e.jsx(It,{className:"size-4"}),e.jsx("span",{children:b})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{type:"submit","data-testid":"two-step-confirm-button",disabled:!A,className:M("w-full rounded-full py-3 font-medium text-primary-foreground transition-colors","bg-primary hover:bg-primary/90","disabled:cursor-not-allowed disabled:opacity-50"),children:t(N?"common:verifying":"common:confirm")}),e.jsx("button",{type:"button",onClick:()=>s(),disabled:N,className:"w-full py-2 text-center text-sm text-muted-foreground hover:text-foreground",children:t("common:cancel")})]})]})})})})}const cl=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(Tg,{})});cl.__docgenInfo={description:"",methods:[],displayName:"TransferWalletLockJob"};const Ig=150;function Pg(){const{t}=L("scanner"),{pop:s}=V(),n=No(),{chainType:a,title:r,hint:o}=ae(),c=l.useRef(null),i=l.useRef(null),d=l.useRef(null),u=l.useRef(null),m=l.useRef(!1),f=l.useRef(!1),h=l.useRef(!1),[g,v]=l.useState(!1),[p,b]=l.useState(!1),[y,x]=l.useState(null),[j,N]=l.useState(null),w=Gu(a),S=l.useCallback(A=>{if(A===j)return;N(A);const R=Ki(A),E=w(A,R);if(E===!0){x({type:"success",text:t("scanSuccess")}),"vibrate"in navigator&&navigator.vibrate(100),m.current=!1;const B=Qu();setTimeout(()=>{s(),setTimeout(()=>{B?.({content:A,parsed:R})},100)},300)}else x({type:"error",text:t(E,{defaultValue:E})}),setTimeout(()=>{x(null),N(null)},3e3)},[j,w,t,s]),C=l.useCallback(()=>{if(m.current)return;m.current=!0,i.current||(i.current=document.createElement("canvas"));const A=async()=>{if(!(!m.current||!c.current||!u.current)){try{const R=await u.current.scanFromVideo(c.current,i.current??void 0);R&&S(R.content)}catch(R){console.error("[ScannerJob] Scan error:",R)}m.current&&setTimeout(A,Ig)}};A()},[S]),T=l.useCallback(()=>{m.current=!1,d.current&&(d.current.getTracks().forEach(A=>A.stop()),d.current=null),v(!1)},[]),k=l.useCallback(async()=>{if(!h.current){if(h.current=!0,!navigator.mediaDevices?.getUserMedia){console.error("[ScannerJob] mediaDevices not available"),x({type:"error",text:t("error")}),h.current=!1;return}try{try{if(!await n.checkPermission()&&!await n.requestPermission()){x({type:"error",text:t("permissionDenied")}),h.current=!1;return}}catch(R){console.warn("[ScannerJob] Permission check failed, trying direct access:",R)}if(!f.current){h.current=!1;return}const A=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});if(!f.current){A.getTracks().forEach(R=>R.stop()),h.current=!1;return}if(d.current=A,c.current){c.current.srcObject=A;try{await c.current.play(),f.current&&(v(!0),C())}catch(R){if(R instanceof DOMException&&R.name==="AbortError")console.debug("[ScannerJob] Play interrupted, will retry on next mount");else throw R}}}catch(A){if(console.error("[ScannerJob] Camera error:",A),!f.current){h.current=!1;return}A instanceof DOMException?A.name==="NotAllowedError"?x({type:"error",text:t("permissionDenied")}):A.name==="NotFoundError"?x({type:"error",text:t("noCameraFound",{defaultValue:t("error")})}):A.name==="AbortError"||x({type:"error",text:t("error")}):x({type:"error",text:t("error")})}finally{h.current=!1}}},[n,C,t]);l.useEffect(()=>(f.current=!0,u.current=Gi({useWorker:!0}),k(),()=>{f.current=!1,T(),u.current?.destroy(),u.current=null}),[]);const I=l.useCallback(()=>{const A=document.createElement("input");A.type="file",A.accept="image/*",A.onchange=async R=>{const E=R.target.files?.[0];if(!(!E||!u.current))try{const B=new Image,P=URL.createObjectURL(E);B.onload=async()=>{URL.revokeObjectURL(P);const z=document.createElement("canvas");z.width=B.width,z.height=B.height;const q=z.getContext("2d");if(!q||!u.current){x({type:"error",text:t("noQrFound")});return}q.drawImage(B,0,0);const K=await u.current.scanFromCanvas(z);K?S(K.content):x({type:"error",text:t("noQrFound")})},B.onerror=()=>{URL.revokeObjectURL(P),x({type:"error",text:t("noQrFound")})},B.src=P}catch{x({type:"error",text:t("noQrFound")})}},A.click()},[S,t]),D=l.useCallback(async()=>{if(d.current){const A=d.current.getVideoTracks()[0];if(A)try{await A.applyConstraints({advanced:[{torch:!p}]}),b(!p)}catch{}}},[p]),_=l.useCallback(()=>{T(),s()},[T,s]);return e.jsx(ne,{children:e.jsxs("div",{className:"flex h-[80vh] flex-col overflow-hidden rounded-t-2xl bg-black",children:[e.jsx("div",{className:"flex justify-center py-2",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-white/30"})}),e.jsxs("div",{className:"flex items-center justify-between px-4 pb-2",children:[e.jsx($,{variant:"ghost",size:"icon",onClick:_,className:"text-white hover:bg-white/20","data-testid":"scanner-close-button",children:e.jsx(Nn,{className:"size-6"})}),e.jsx("h2",{className:"text-lg font-medium text-white","data-testid":"scanner-title",children:r??t("title")}),e.jsx($,{variant:"ghost",size:"icon",onClick:D,className:M("text-white hover:bg-white/20",p&&"text-yellow-400"),"data-testid":"scanner-flash-button",children:e.jsx(mo,{className:"size-6"})})]}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("video",{ref:c,className:M("absolute inset-0 size-full object-cover",!g&&"hidden"),playsInline:!0,muted:!0,"data-testid":"scanner-video"}),!g&&!y&&e.jsx("div",{className:"flex size-full items-center justify-center",children:e.jsx("p",{className:"text-white/60",children:t("initializing")})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"relative size-64","data-testid":"scanner-viewfinder",children:[e.jsx("div",{className:M("absolute top-0 left-0 size-8 border-t-4 border-l-4",y?.type==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:M("absolute top-0 right-0 size-8 border-t-4 border-r-4",y?.type==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:M("absolute bottom-0 left-0 size-8 border-b-4 border-l-4",y?.type==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:M("absolute right-0 bottom-0 size-8 border-r-4 border-b-4",y?.type==="success"?"border-green-500":"border-primary")}),g&&!y&&e.jsx("div",{className:"animate-scan bg-primary absolute right-2 left-2 h-0.5"})]})}),e.jsx("div",{className:"absolute inset-x-0 bottom-24 px-4 text-center",children:y?e.jsx("div",{className:M("inline-block rounded-lg px-4 py-2",y.type==="error"&&"bg-red-500/80 text-white",y.type==="success"&&"bg-green-500/80 text-white",y.type==="info"&&"bg-black/50 text-white"),"data-testid":"scanner-message",children:y.text}):g?e.jsx("p",{className:"text-white/80","data-testid":"scanner-hint",children:o??(a?t("scanPromptChain",{chain:a}):t("scanPrompt"))}):null})]}),e.jsx("div",{className:"flex justify-center gap-8 bg-black/50 py-6",children:e.jsxs($,{variant:"ghost",size:"lg",onClick:I,className:"flex flex-col items-center text-white hover:bg-white/20","data-testid":"scanner-gallery-button",children:[e.jsx(co,{className:"mb-1 size-6"}),e.jsx("span",{className:"text-xs",children:t("gallery")})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)] bg-black"})]})})}const ll=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(Pg,{})});ll.__docgenInfo={description:"",methods:[],displayName:"ScannerJob"};function Eg(){const{t}=L("common"),{pop:s}=V(),n=ae(),[a,r]=l.useState(n.name||""),[o,c]=l.useState(n.memo||""),[i,d]=l.useState(0),[u,m]=l.useState(!1),[f,h]=l.useState(!1),g=(()=>{try{return JSON.parse(n.addresses||"[]")}catch{return[]}})(),v=l.useCallback(()=>{d(y=>y+1)},[]),p=l.useCallback(async()=>{if(!(!a.trim()||g.length===0)){m(!0);try{const y=n.avatar||(g[0]?.address?bt(g[0].address,i):void 0);Wt.addContact({name:a.trim(),addresses:g.map((x,j)=>({id:`addr-${j}`,address:x.address,label:x.label,isDefault:j===0})),memo:o.trim()||void 0,avatar:y}),h(!0),setTimeout(()=>s(),500)}catch(y){console.error("[ContactAddConfirmJob] Save error:",y)}finally{m(!1)}}},[a,o,g,n.avatar,i,s]),b=l.useCallback(()=>{s()},[s]);return e.jsx(ne,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl pb-[env(safe-area-inset-bottom)]",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx("div",{className:"border-border border-b px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("addressBook.addContact")})}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{type:"button",onClick:v,className:"group relative",title:t("addressBook.changeAvatar"),children:[e.jsx(jn,{src:n.avatar||(g[0]?.address?bt(g[0].address,i):void 0),size:48}),!n.avatar&&e.jsx("div",{className:"bg-background/80 absolute inset-0 flex items-center justify-center rounded-full opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx(gs,{className:"text-primary size-5"})})]}),e.jsx(Pe,{value:a,onChange:y=>r(y.target.value),placeholder:t("addressBook.namePlaceholder"),className:"flex-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm",children:t("addressBook.addresses")}),e.jsx("div",{className:"space-y-2",children:g.map((y,x)=>{const j=Hu(y.address),N=y.label||j.chainType?.toUpperCase()||"";return e.jsxs("div",{className:"bg-muted/50 flex items-center gap-3 rounded-lg p-3",children:[e.jsx(ja,{className:"text-muted-foreground size-5 shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[N&&e.jsx("div",{className:"text-muted-foreground text-xs",children:N}),e.jsx("div",{className:"truncate font-mono text-sm",children:y.address})]})]},x)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm",children:t("addressBook.memo")}),e.jsx(Pe,{value:o,onChange:y=>c(y.target.value),placeholder:t("addressBook.memoPlaceholder")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx($,{variant:"outline",onClick:b,disabled:u||f,className:"flex-1",children:t("cancel")}),e.jsx($,{onClick:p,disabled:!a.trim()||g.length===0||u||f,className:M("flex-1",f&&"bg-green-500"),children:f?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"mr-1 size-4"}),t("saved")]}):t(u?"saving":"save")})]})]})})}const dl=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(Eg,{})});dl.__docgenInfo={description:"",methods:[],displayName:"ContactAddConfirmJob"};function _g(){const{t}=L("common"),{pop:s}=V(),n=ae(),a=l.useRef(null),[r,o]=l.useState(!1),c=l.useMemo(()=>{try{return JSON.parse(n.addresses||"[]")}catch{return[]}},[n.addresses]),i=l.useMemo(()=>Ku({name:n.name,addresses:c,avatar:n.avatar}),[n.name,c,n.avatar]),d=l.useCallback(async()=>{const m=a.current;if(!(!m||r)){o(!0);try{const{snapdom:f}=await os(async()=>{const{snapdom:h}=await import("./snapdom-CO8q8LPW.js").then(g=>g.s);return{snapdom:h}},__vite__mapDeps([0,1]),import.meta.url);await f.download(m,{type:"png",filename:`contact-${n.name}.png`,scale:2,quality:1})}catch(f){console.error("Download failed:",f)}finally{o(!1)}}},[n.name,r]),u=l.useCallback(async()=>{const m=a.current;if(!(!m||!navigator.share)){o(!0);try{const{snapdom:f}=await os(async()=>{const{snapdom:p}=await import("./snapdom-CO8q8LPW.js").then(b=>b.s);return{snapdom:p}},__vite__mapDeps([0,1]),import.meta.url),g=await(await f(m,{scale:2})).toBlob(),v=new File([g],`contact-${n.name}.png`,{type:"image/png"});await navigator.share({title:t("addressBook.shareContact"),text:`${n.name} - ${c.map(p=>`${p.label||""}: ${p.address}`).join(", ")}`,files:[v]})}catch{}finally{o(!1)}}},[n.name,c,t,r]);return e.jsx(ne,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl pb-[env(safe-area-inset-bottom)]",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"flex items-center justify-between border-b px-4 pb-4",children:[e.jsx($,{variant:"ghost",size:"icon",onClick:()=>s(),children:e.jsx(Nn,{className:"size-5"})}),e.jsx("h2",{className:"text-lg font-semibold",children:t("addressBook.shareContact")}),e.jsx("div",{className:"w-10"})]}),e.jsxs("div",{className:"flex flex-col items-center p-6",children:[e.jsx("div",{ref:a,children:e.jsx(Xu,{name:n.name,avatar:n.avatar,addresses:c,qrContent:i})}),e.jsx("p",{className:"text-muted-foreground mt-4 text-center text-sm",children:t("addressBook.scanToAdd")})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsxs($,{variant:"outline",onClick:d,disabled:r,className:"flex-1",children:[r?e.jsx(ke,{className:"mr-2 size-4 animate-spin"}):e.jsx(ya,{className:"mr-2 size-4"}),t("download")]}),"share"in navigator&&e.jsxs($,{onClick:u,disabled:r,className:"flex-1",children:[r?e.jsx(ke,{className:"mr-2 size-4 animate-spin"}):e.jsx(Ks,{className:"mr-2 size-4"}),t("share")]})]})]})})}const ul=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(_g,{})});ul.__docgenInfo={description:"",methods:[],displayName:"ContactShareJob"};function Mg(){const{t}=L(["settings","common"]),{pop:s}=V(),[n,a]=l.useState(!1),r=l.useCallback(()=>{a(!0);const o="./";window.location.href=`${o}clear.html`},[]);return e.jsx(ne,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-destructive/10 flex size-16 items-center justify-center rounded-full",children:e.jsx(Se,{className:"text-destructive size-8"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:t("settings:clearData.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("settings:clearData.warning")})]}),e.jsx("div",{className:"bg-destructive/5 rounded-lg p-4",children:e.jsxs("ul",{className:"text-destructive space-y-2 text-sm",children:[e.jsxs("li",{children:[" ",t("settings:clearData.item1")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item2")]}),e.jsxs("li",{children:[" ",t("settings:clearData.item3")]})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx($,{variant:"outline",className:"flex-1",onClick:()=>s(),disabled:n,children:t("common:cancel")}),e.jsx($,{variant:"destructive",className:"flex-1",onClick:r,disabled:n,children:t("settings:clearData.confirm")})]})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const ml=()=>e.jsx(Mg,{});ml.__docgenInfo={description:"",methods:[],displayName:"ClearDataConfirmJob"};function Rg(t){if(!t)return;if(t.startsWith("0x")){const n=yn(t);if(n)return n}const s=Au(t);return Qn[s],s}function Dg(){const{t}=L("common"),{pop:s}=V(),{chain:n,exclude:a,appName:r,appIcon:o}=ae(),c=l.useMemo(()=>Rg(n),[n]),i=le(me),d=_e.getCurrentWallet(i),u=l.useMemo(()=>{const g=a?.toLowerCase();return i.wallets.map(v=>{const p=c?v.chainAddresses.find(b=>b.chain===c):v.chainAddresses[0];return!p||g&&p.address.toLowerCase()===g?null:{id:v.id,name:v.name,address:p.address,themeHue:v.themeHue,chainIconUrl:void 0}}).filter(v=>v!==null)},[i.wallets,c,a]),m=l.useMemo(()=>{const g=new Map;return i.wallets.forEach(v=>{const p=c?v.chainAddresses.find(b=>b.chain===c):v.chainAddresses[0];p&&g.set(v.id,{wallet:v,chainAddress:p})}),g},[i.wallets,c]),f=g=>{const v=m.get(g);if(!v)return;const p=new CustomEvent("wallet-picker-select",{detail:{address:v.chainAddress.address,chain:v.chainAddress.chain,name:v.wallet.name,publicKey:v.chainAddress.publicKey}});window.dispatchEvent(p),s()},h=()=>{const g=new CustomEvent("wallet-picker-cancel");window.dispatchEvent(g),s()};return e.jsx(ne,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Wi,{title:t("selectWallet",""),description:`${r||t("unknownDApp"," DApp")} ${t("requestsAccess","")}`,appName:r,appIcon:o}),e.jsx("div",{className:"max-h-[50vh] overflow-y-auto p-4",children:u.length===0?e.jsx("div",{className:"text-muted-foreground py-12 text-center text-sm",children:c?t("noWalletsForChain"," {{chain}} ",{chain:c}):t("noWallets","")}):e.jsx(Vu,{wallets:u,currentWalletId:d?.id,onSelect:f,showAddButton:!1})}),e.jsx("div",{className:"border-border border-t p-4",children:e.jsx("button",{onClick:h,className:"bg-muted hover:bg-muted/80 w-full rounded-xl py-3 font-medium transition-colors",children:t("cancel","")})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const fl=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(Dg,{})});fl.__docgenInfo={description:"",methods:[],displayName:"WalletPickerJob"};function zg(){const{t}=L("common"),{pop:s,push:n}=V(),{message:a,address:r,appName:o,appIcon:c,chainName:i}=ae(),d=ye(),[u,m]=l.useState(!1),f=l.useCallback(()=>{u||(rt(async v=>{m(!0);try{const p=d?.encryptedMnemonic;if(!p)return console.error("[SigningConfirmJob] No encrypted mnemonic found"),!1;const b=`miniapp_sign_${Date.now()}`,x=await new Aa(Ht,b).handleMessageSign({chainName:i||"bioforest",senderAddress:r,message:a},p,v),j=new CustomEvent("signing-confirm",{detail:{confirmed:!0,signature:x.signature,publicKey:x.publicKey}});return window.dispatchEvent(j),s(),!0}catch(p){return console.error("[SigningConfirmJob] Signing failed:",p),!1}finally{m(!1)}}),n("WalletLockConfirmJob",{title:t("sign","")}))},[u,d,i,r,a,s,n,t]),h=l.useCallback(()=>{const v=new CustomEvent("signing-confirm",{detail:{confirmed:!1}});window.dispatchEvent(v),s()},[s]),g=a.startsWith("0x")&&/^0x[0-9a-fA-F]+$/.test(a);return e.jsx(ne,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"border-border border-b px-4 pb-4",children:[e.jsx("div",{className:"mx-auto mb-3 flex size-14 items-center justify-center rounded-2xl bg-primary/10 overflow-hidden",children:c?e.jsx("img",{src:c,alt:o,className:"size-full object-cover"}):e.jsx(hs,{className:"size-8 text-primary"})}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("signMessage","")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-center text-sm",children:o||t("unknownDApp"," DApp")})]}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("signingAddress","")}),e.jsx(He,{address:r,copyable:!1,className:"text-sm"})]}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("message","")}),e.jsx("div",{className:"max-h-40 overflow-y-auto",children:e.jsx("pre",{className:"whitespace-pre-wrap break-all font-mono text-sm",children:a})})]}),g&&e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[e.jsx(Se,{className:"size-5 shrink-0 text-amber-600"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:t("hexDataWarning","")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:h,disabled:u,className:"bg-muted hover:bg-muted/80 disabled:opacity-50 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("cancel","")}),e.jsx("button",{onClick:f,disabled:u,className:M("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","disabled:opacity-50 flex items-center justify-center gap-2"),children:u?e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"size-4 animate-spin"}),t("signing","...")]}):t("sign","")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const pl=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(zg,{})});pl.__docgenInfo={description:"",methods:[],displayName:"SigningConfirmJob"};const Bg={bio_requestAccounts:{icon:ja,label:"",description:""},bio_createTransaction:{icon:Oi,label:"",description:"/"},bio_signMessage:{icon:Pn,label:"",description:""},bio_signTypedData:{icon:Pn,label:"",description:""},bio_signTransaction:{icon:Pn,label:"",description:""},bio_sendTransaction:{icon:Bm,label:"",description:""}};function Lg(){const{t}=L("common"),{pop:s}=V(),{appName:n,appIcon:a,permissions:r}=ae(),o=(()=>{try{return JSON.parse(r)}catch{return[]}})(),c=()=>{const d=new CustomEvent("permission-request",{detail:{approved:!0,permissions:o}});window.dispatchEvent(d),s()},i=()=>{const d=new CustomEvent("permission-request",{detail:{approved:!1}});window.dispatchEvent(d),s()};return e.jsx(ne,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"border-border border-b px-4 pb-4",children:[e.jsx("div",{className:"mx-auto mb-3 flex size-14 items-center justify-center rounded-2xl bg-primary/10",children:a?e.jsx("img",{src:a,alt:n,className:"size-10 rounded-xl"}):e.jsx(hs,{className:"text-primary size-8"})}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:n}),e.jsx("p",{className:"text-muted-foreground mt-1 text-center text-sm",children:t("requestsPermissions","")})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"space-y-3",children:o.map(d=>{const u=Bg[d];if(!u)return null;const m=u.icon;return e.jsxs("div",{className:"bg-muted/50 flex items-center gap-3 rounded-xl p-3",children:[e.jsx("div",{className:"bg-primary/10 flex size-10 shrink-0 items-center justify-center rounded-full",children:e.jsx(m,{className:"text-primary size-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium",children:u.label}),e.jsx("p",{className:"text-muted-foreground text-sm",children:u.description})]})]},d)})}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Qi,{className:"size-4"}),e.jsx("span",{children:t("permissionNote","")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:i,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("reject","")}),e.jsx("button",{onClick:c,className:M("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90"),children:t("approve","")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const hl=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(Lg,{})});hl.__docgenInfo={description:"",methods:[],displayName:"PermissionRequestJob"};function Og(){const{t}=L("common"),{pop:s,push:n}=V(),a=ae(),{appName:r,appIcon:o,from:c,to:i,amount:d,chain:u,asset:m}=a,f=ye(),[h,g]=l.useState(!1),v=l.useCallback(()=>{h||(rt(async y=>{g(!0);try{const x=f?.encryptedMnemonic;if(!x)return console.error("[MiniappTransferConfirmJob] No encrypted mnemonic found"),!1;const j=`miniapp_transfer_${Date.now()}`,N=new Aa(Ht,j),w={chainName:u,senderAddress:c,receiveAddress:i,balance:d};m&&(w.assetType=m);const C=await N.handleTransferSign(w,x,y),T=new CustomEvent("miniapp-transfer-confirm",{detail:{confirmed:!0,txHash:C}});return window.dispatchEvent(T),s(),!0}catch(x){return console.error("[MiniappTransferConfirmJob] Transfer failed:",x),!1}finally{g(!1)}}),n("WalletLockConfirmJob",{title:t("confirmTransfer","")}))},[h,f,u,c,i,d,m,s,n,t]),p=l.useCallback(()=>{const y=new CustomEvent("miniapp-transfer-confirm",{detail:{confirmed:!1}});window.dispatchEvent(y),s()},[s]),b=m||u.toUpperCase();return e.jsx(ne,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"border-border border-b px-4 pb-4",children:[e.jsx("div",{className:"mx-auto mb-3 flex size-14 items-center justify-center rounded-2xl bg-primary/10 overflow-hidden",children:o?e.jsx("img",{src:o,alt:r,className:"size-full object-cover"}):e.jsx(hs,{className:"size-8 text-primary"})}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("confirmTransfer","")}),e.jsxs("p",{className:"text-muted-foreground mt-1 text-center text-sm",children:[r||t("unknownDApp"," DApp")," ",t("requestsTransfer","")]})]}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx("div",{className:"bg-muted/50 rounded-xl p-4 text-center",children:e.jsx(lt,{value:d,symbol:b,size:"xl",weight:"bold",decimals:8,fixedDecimals:!0})}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-muted-foreground text-xs w-10 shrink-0",children:t("from","")}),e.jsx(He,{address:c,copyable:!0,className:"flex-1 text-sm"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(bn,{className:"size-4 text-muted-foreground"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-muted-foreground text-xs w-10 shrink-0",children:t("to","")}),e.jsx(He,{address:i,copyable:!0,className:"flex-1 text-sm"})]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3 flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("network","")}),e.jsx("span",{className:"text-sm font-medium",children:u})]}),e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[e.jsx(Se,{className:"size-5 shrink-0 text-amber-600 mt-0.5"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:t("transferWarning","")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:p,disabled:h,className:"bg-muted hover:bg-muted/80 disabled:opacity-50 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("cancel","")}),e.jsx("button",{onClick:v,disabled:h,className:M("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","disabled:opacity-50 flex items-center justify-center gap-2"),children:h?e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"size-4 animate-spin"}),t("confirming","...")]}):t("confirm","")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const xl=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(Og,{})});xl.__docgenInfo={description:"",methods:[],displayName:"MiniappTransferConfirmJob"};function Ga(t){return t.apis.find(n=>n.type==="biowallet-v1")?.endpoint??null}async function gl(t,s,n){const a=Ga(t);return a?(await uu(a,s,n))?.applyAddress??null:null}async function vl(t,s,n){const a=Ga(t);if(!a)return{amount:ce.fromRaw("1000",t.decimals,t.symbol),symbol:t.symbol};try{const r=await mu(a,t.id,s,n);return{amount:ce.fromRaw(r,t.decimals,t.symbol),symbol:t.symbol}}catch(r){return console.warn("[fetchBioforestBurnFee] Failed to get fee:",r),{amount:ce.fromRaw("1000",t.decimals,t.symbol),symbol:t.symbol}}}async function dn({chainConfig:t,walletId:s,password:n,fromAddress:a,recipientAddress:r,assetType:o,amount:c,fee:i,twoStepSecret:d}){let u;try{u=await un.getMnemonic(s,n)}catch(f){return f instanceof mn&&f.code===fn.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:f instanceof Error?f.message:""}}if(!c.isPositive())return{status:"error",message:""};const m=Ga(t);if(!m)return{status:"error",message:"API URL "};try{console.log("[submitBioforestBurn] Starting destroy:",{apiUrl:m,fromAddress:a,recipientAddress:r,assetType:o,amount:c.toRawString()});const f=await vn(m,a);if(console.log("[submitBioforestBurn] Address info:",{hasSecondPubKey:!!f.secondPublicKey}),f.secondPublicKey&&!d)return console.log("[submitBioforestBurn] Pay password required"),{status:"password_required",secondPublicKey:f.secondPublicKey};if(d&&f.secondPublicKey){console.log("[submitBioforestBurn] Verifying pay password...");const v=await Bi(t.id,u,d,f.secondPublicKey);if(console.log("[submitBioforestBurn] Pay password verification result:",v),!v)return{status:"error",message:""}}console.log("[submitBioforestBurn] Creating transaction...");const h=await fu({baseUrl:m,chainId:t.id,mainSecret:u,paySecret:d,from:a,recipientId:r,assetType:o,amount:c.toRawString(),fee:i?.toRawString()}),g=h.signature;return console.log("[submitBioforestBurn] Transaction created:",g?.slice(0,20)),console.log("[submitBioforestBurn] Broadcasting..."),await Li(m,h).catch(v=>{console.warn("[submitBioforestBurn] Broadcast warning (may still succeed):",v.message)}),console.log("[submitBioforestBurn] SUCCESS! txHash:",g),{status:"ok",txHash:g}}catch(f){console.error("[submitBioforestBurn] FAILED:",f);const h=f instanceof Error?f.message:String(f);return h.includes("insufficient")||h.includes("")?{status:"error",message:""}:h.includes("fee")||h.includes("")?{status:"error",message:""}:{status:"error",message:h||""}}}const Fg=Object.freeze(Object.defineProperty({__proto__:null,fetchAssetApplyAddress:gl,fetchBioforestBurnFee:vl,submitBioforestBurn:dn},Symbol.toStringTag,{value:"Module"}));function Wg(){const{t}=L(["common","transaction"]),{pop:s,push:n}=V(),a=ae(),{appName:r,appIcon:o,from:c,amount:i,chain:d,asset:u}=a,m=ye(),f=At(),h=f.snapshot?tt.getChainById(f,d):null,[g,v]=l.useState(!1),p=l.useCallback(()=>{g||(rt(async y=>{v(!0);try{if(!m?.id||!h)return console.error("[MiniappDestroyConfirmJob] Missing wallet or chain config"),!1;const{fetchAssetApplyAddress:x}=await os(async()=>{const{fetchAssetApplyAddress:C}=await Promise.resolve().then(()=>Fg);return{fetchAssetApplyAddress:C}},void 0,import.meta.url),j=await x(h,u,c);if(!j)return console.error("[MiniappDestroyConfirmJob] Failed to get asset apply address"),!1;const N=ce.fromFormatted(i,h.decimals,u),w=await dn({chainConfig:h,walletId:m.id,password:y,fromAddress:c,recipientAddress:j,assetType:u,amount:N});if(w.status==="password")return!1;if(w.status==="error")return console.error("[MiniappDestroyConfirmJob] Destroy failed:",w.message),!1;const S=new CustomEvent("miniapp-destroy-confirm",{detail:{confirmed:!0,txHash:w.txHash}});return window.dispatchEvent(S),s(),!0}catch(x){return console.error("[MiniappDestroyConfirmJob] Destroy failed:",x),!1}finally{v(!1)}}),n("WalletLockConfirmJob",{title:t("transaction:destroyPage.title")}))},[g,m,h,u,c,i,s,n,t]),b=l.useCallback(()=>{const y=new CustomEvent("miniapp-destroy-confirm",{detail:{confirmed:!1}});window.dispatchEvent(y),s()},[s]);return e.jsx(ne,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"border-border border-b px-4 pb-4",children:[e.jsx("div",{className:"mx-auto mb-3 flex size-14 items-center justify-center rounded-2xl bg-destructive/10 overflow-hidden",children:o?e.jsx("img",{src:o,alt:r,className:"size-full object-cover"}):e.jsx(hs,{className:"size-8 text-destructive"})}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("transaction:destroyPage.title")}),e.jsxs("p",{className:"text-muted-foreground mt-1 text-center text-sm",children:[r||t("common:unknownDApp")," ",t("common:requestsDestroy","")]})]}),e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx("div",{className:"bg-destructive/5 rounded-xl p-4 text-center",children:e.jsx(lt,{value:i,symbol:u,size:"xl",weight:"bold",decimals:8,fixedDecimals:!0})}),e.jsx("div",{className:"bg-muted/50 rounded-xl p-4 space-y-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-muted-foreground text-xs w-10 shrink-0",children:t("common:from","")}),e.jsx(He,{address:c,copyable:!0,className:"flex-1 text-sm"})]})}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3 flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("common:network","")}),e.jsx("span",{className:"text-sm font-medium",children:d})]}),e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-destructive/10 p-3",children:[e.jsx(Se,{className:"size-5 shrink-0 text-destructive mt-0.5"}),e.jsx("p",{className:"text-sm text-destructive",children:t("transaction:destroyPage.warning")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:b,disabled:g,className:"bg-muted hover:bg-muted/80 disabled:opacity-50 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("common:cancel","")}),e.jsx("button",{onClick:p,disabled:g,className:M("flex-1 rounded-xl py-3 font-medium transition-colors","bg-destructive text-destructive-foreground hover:bg-destructive/90","disabled:opacity-50 flex items-center justify-center gap-2"),children:g?e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"size-4 animate-spin"}),t("common:confirming","...")]}):e.jsxs(e.Fragment,{children:[e.jsx($s,{className:"size-4"}),t("transaction:destroyPage.confirm")]})})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const bl=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(Wg,{})});bl.__docgenInfo={description:"",methods:[],displayName:"MiniappDestroyConfirmJob"};function $g(t,s){const n=s.startsWith("0x"),a=n?s.toLowerCase():s;for(const r of me.state.wallets)if(r.chainAddresses.find(c=>c.chain!==t?!1:n||c.address.startsWith("0x")?c.address.toLowerCase()===a:c.address===a))return r.id;return null}function qg(){const{t}=L("common"),{pop:s,push:n}=V(),a=ae(),{appName:r,appIcon:o,from:c,chain:i,unsignedTx:d}=a,[u,m]=l.useState(!1),f=l.useMemo(()=>{try{return JSON.parse(d)}catch{return null}},[d]),h=l.useMemo(()=>$g(i,c),[i,c]),g=l.useCallback(()=>{u||f&&h&&(rt(async b=>{m(!0);try{const y=await wu({walletId:h,password:b,from:c,chainId:i,unsignedTx:f}),x=new CustomEvent("miniapp-sign-transaction-confirm",{detail:{confirmed:!0,signedTx:y}});return window.dispatchEvent(x),s(),!0}catch(y){return console.error("[MiniappSignTransactionJob] signTransaction failed:",y),!1}finally{m(!1)}}),n("WalletLockConfirmJob",{title:t("signTransaction","")}))},[i,c,u,s,n,t,f,h]),v=l.useCallback(()=>{const b=new CustomEvent("miniapp-sign-transaction-confirm",{detail:{confirmed:!1}});window.dispatchEvent(b),s()},[s]),p=l.useMemo(()=>{if(!f)return"";try{return JSON.stringify(f.data,null,2)}catch{return String(f.data)}},[f]);return e.jsx(ne,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsxs("div",{className:"border-border border-b px-4 pb-4",children:[e.jsx("div",{className:"mx-auto mb-3 flex size-14 items-center justify-center rounded-2xl bg-primary/10 overflow-hidden",children:o?e.jsx("img",{src:o,alt:r,className:"size-full object-cover"}):e.jsx(hs,{className:"size-8 text-primary"})}),e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("signTransaction","")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-center text-sm",children:r||t("unknownDApp"," DApp")})]}),e.jsxs("div",{className:"space-y-4 p-4",children:[!f&&e.jsx("div",{className:"rounded-xl bg-destructive/10 p-3 text-sm text-destructive",children:t("invalidTransaction","")}),f&&!h&&e.jsx("div",{className:"rounded-xl bg-amber-50 p-3 text-sm text-amber-800 dark:bg-amber-950/30 dark:text-amber-200",children:t("signingAddressNotFound","")}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("network","")}),e.jsx("p",{className:"text-sm font-medium",children:i})]}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("signingAddress","")}),e.jsx("p",{className:"text-sm font-mono break-all",children:c})]}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 text-xs",children:t("transaction","")}),e.jsx("div",{className:"max-h-44 overflow-y-auto",children:e.jsx("pre",{className:"whitespace-pre-wrap break-all font-mono text-xs",children:p})})]}),e.jsxs("div",{className:"flex items-start gap-2 rounded-xl bg-amber-50 p-3 dark:bg-amber-950/30",children:[e.jsx(Se,{className:"size-5 shrink-0 text-amber-600 mt-0.5"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:t("signTxWarning","")})]})]}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:v,disabled:u,className:"bg-muted hover:bg-muted/80 disabled:opacity-50 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("cancel","")}),e.jsx("button",{onClick:g,disabled:u||!f||!h,className:M("flex-1 rounded-xl py-3 font-medium transition-colors","bg-primary text-primary-foreground hover:bg-primary/90","disabled:opacity-50 flex items-center justify-center gap-2"),children:u?e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"size-4 animate-spin"}),t("signing","...")]}):t("sign","")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const yl=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(qg,{})});yl.__docgenInfo={description:"",methods:[],displayName:"MiniappSignTransactionJob"};function ui(t){const s=yn(t);if(s&&Qn[s])return Qn[s];try{return`Chain ${Tu(t)}`}catch{return t}}function mi(t){return yn(t)}function Hg(){const{t}=L("common"),{pop:s}=V(),{fromChainId:n,toChainId:a,appName:r,appIcon:o}=ae(),c=ui(n),i=ui(a),d=mi(n),u=mi(a),m=()=>{const h=new CustomEvent("chain-switch-confirm",{detail:{approved:!0,toChainId:a}});window.dispatchEvent(h),s()},f=()=>{const h=new CustomEvent("chain-switch-confirm",{detail:{approved:!1}});window.dispatchEvent(h),s()};return e.jsx(ne,{children:e.jsxs("div",{className:"bg-background rounded-t-2xl",children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"bg-muted h-1 w-10 rounded-full"})}),e.jsx(Wi,{title:t("switchNetwork",""),description:`${r||t("unknownDApp"," DApp")} ${t("requestsNetworkSwitch","")}`,appName:r,appIcon:o}),e.jsxs("div",{className:"flex items-center justify-center gap-4 px-6 py-8",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[d?e.jsx(Ct,{chain:d,size:"lg"}):e.jsx("div",{className:"bg-muted flex size-12 items-center justify-center rounded-full",children:e.jsx(Se,{className:"text-muted-foreground size-6"})}),e.jsx("span",{className:"text-muted-foreground text-sm",children:c})]}),e.jsx(lo,{className:"text-primary size-8"}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[u?e.jsx(Ct,{chain:u,size:"lg"}):e.jsx("div",{className:"bg-muted flex size-12 items-center justify-center rounded-full",children:e.jsx(Se,{className:"text-muted-foreground size-6"})}),e.jsx("span",{className:"font-medium",children:i})]})]}),e.jsx("div",{className:"bg-warning/10 border-warning/20 mx-4 mb-4 rounded-lg border p-3",children:e.jsx("p",{className:"text-warning text-sm",children:t("chainSwitchWarning","")})}),e.jsxs("div",{className:"flex gap-3 p-4",children:[e.jsx("button",{onClick:f,className:"bg-muted hover:bg-muted/80 flex-1 rounded-xl py-3 font-medium transition-colors",children:t("cancel","")}),e.jsx("button",{onClick:m,className:"bg-primary hover:bg-primary/90 text-primary-foreground flex-1 rounded-xl py-3 font-medium transition-colors",children:t("confirm","")})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})}const jl=({params:t})=>e.jsx(ee,{params:t,children:e.jsx(Hg,{})});jl.__docgenInfo={description:"",methods:[],displayName:"ChainSwitchConfirmJob"};const Ug={"zh-CN":"","zh-TW":"",en:"English",ja:"",ko:"",ar:""},Jg={USD:"USD ($)",CNY:"CNY ()",EUR:"EUR ()",JPY:"JPY ()",KRW:"KRW ()"};function Qa(){const{navigate:t}=Z(),{push:s}=V(),{t:n}=L(["settings","common","security"]),a=ye(),r=fs(),o=fa(),c=ma(),[i,d]=l.useState(!1),[u,m]=l.useState("loading");l.useEffect(()=>{async function v(){if(!a){m("unavailable");return}const p=a.chainAddresses.find(b=>b.chain==="bfmeta"||b.chain==="bfm");if(!p){m("unavailable");return}try{const b=tt.getChainById(Vn.state,"bfmeta");if(!b){m("unavailable");return}const y=await tg(b,p.address);m(y?"set":"not_set")}catch{m("unavailable")}}v()},[a]);const f=()=>n(`settings:appearance.${c}`),h=()=>{switch(u){case"loading":return"...";case"set":return n("security:twoStepSecret.alreadySet");case"not_set":return n("security:twoStepSecret.notSet");default:return n("settings:notSupported")}},g=async()=>{if(u!=="not_set"||!a)return;const v=a.chainAddresses.find(y=>y.chain==="bfmeta"||y.chain==="bfm");if(!v)return;const p=tt.getChainById(Vn.state,"bfmeta");if(!p)return;const b=await eg(p);fg(async(y,x)=>{const j=await Zx({chainConfig:p,walletId:a.id,password:x,fromAddress:v.address,newTwoStepSecret:y});return j.status==="ok"?(m("set"),{success:!0,txHash:j.txHash}):j.status==="password"?{success:!1,error:n("security:passwordConfirm.verifying")}:j.status==="already_set"?(m("set"),{success:!1,error:n("security:twoStepSecret.alreadySet")}):{success:!1,error:j.message}},b??void 0,async()=>{const{getAddressInfo:y}=await os(async()=>{const{getAddressInfo:w}=await import("./index-BVzIq5_8.js").then(S=>S.t);return{getAddressInfo:w}},__vite__mapDeps([2,3,4,1,5,6,7,8,9,10]),import.meta.url),x=p.apis.find(w=>w.type==="biowallet-v1"),j=x?.endpoint,N=x?.config?.path??p.id;if(!j)return!1;try{return!!(await y(j,N,v.address)).secondPublicKey}catch{return!1}}),s("SetTwoStepSecretJob",{chainName:"BioForest Chain"})};return e.jsxs("div",{className:"bg-muted/30 flex h-full flex-col overflow-y-auto",children:[e.jsx(H,{title:n("common:a11y.tabSettings")}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[a&&e.jsxs("div",{className:"bg-card flex items-center gap-4 rounded-xl p-4 shadow-sm",children:[e.jsx("div",{className:"bg-primary/10 flex size-14 items-center justify-center rounded-full text-2xl",children:a.name.slice(0,1)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"font-semibold",children:a.name}),e.jsx("p",{className:"text-muted-foreground text-sm",children:n("settings:chainAddressCount",{count:a.chainAddresses.length})})]})]}),e.jsxs(ts,{title:n("settings:sections.walletManagement"),children:[e.jsx(ve,{icon:e.jsx(ja,{size:20}),label:n("settings:items.walletManagement"),onClick:()=>t({to:`/wallet/${a?.id??""}`})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(ve,{icon:e.jsx(ho,{size:20}),label:n("settings:items.walletChains"),onClick:()=>t({to:"/settings/wallet-chains"}),testId:"wallet-chains-button"}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(ve,{icon:e.jsx(Nm,{size:20}),label:n("settings:items.addressBook"),onClick:()=>t({to:"/address-book"}),testId:"address-book-button"})]}),e.jsxs(ts,{title:n("settings:sections.security"),children:[e.jsx(ve,{icon:e.jsx(gn,{size:20}),label:n("settings:items.appLock"),value:n("settings:notSupported"),disabled:!0}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(ve,{icon:e.jsx(Na,{size:20}),label:n("settings:items.viewMnemonic"),onClick:()=>t({to:"/settings/mnemonic"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(ve,{icon:e.jsx(Ca,{size:20}),label:n("settings:items.changeWalletLock"),onClick:()=>t({to:"/settings/wallet-lock"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(ve,{icon:e.jsx(hu,{size:20}),label:n("security:twoStepSecret.setup"),value:h(),onClick:g,disabled:u==="set"||u==="unavailable",testId:"set-pay-password-button"})]}),e.jsxs(ts,{title:n("settings:sections.preferences"),children:[e.jsx(ve,{icon:e.jsx(Vm,{size:20}),label:n("settings:items.language"),value:Ug[r],onClick:()=>t({to:"/settings/language"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(ve,{icon:e.jsx(Dm,{size:20}),label:n("settings:items.currency"),value:Jg[o],onClick:()=>t({to:"/settings/currency"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(ve,{icon:e.jsx(ef,{size:20}),label:n("settings:items.appearance"),value:f(),onClick:()=>d(!0)}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(ve,{icon:e.jsx(Xm,{size:20}),label:n("settings:items.chainConfig"),onClick:()=>t({to:"/settings/chains"})}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(ve,{icon:e.jsx(go,{size:20}),label:"",onClick:()=>t({to:"/settings/sources"})})]}),e.jsxs(ts,{title:n("settings:sections.about"),children:[e.jsx(ve,{icon:e.jsx(em,{size:20}),label:n("settings:items.aboutApp"),value:"v1.0.0",onClick:()=>{}}),e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx(ve,{icon:e.jsx(fo,{size:20}),label:n("settings:items.storage"),onClick:()=>t({to:"/settings/storage"}),testId:"storage-button"})]}),e.jsx("div",{className:"h-[var(--tab-bar-height)]"})]}),e.jsx($c,{open:i,onOpenChange:d})]})}Qa.__docgenInfo={description:"",methods:[],displayName:"SettingsPage"};function Nl(){return e.jsx(Qa,{})}Nl.__docgenInfo={description:`SettingsTab - 

 SettingsPage `,methods:[],displayName:"SettingsTab"};function Vg(t,s){let n=t.toString();const a=n.startsWith("-");a&&(n=n.slice(1)),n=n.padStart(s,"0");let[r,o]=[n.slice(0,n.length-s),n.slice(n.length-s)];return o=o.replace(/(0+)$/,""),`${a?"-":""}${r||"0"}${o?`.${o}`:""}`}const wl=({params:t})=>{const{push:s}=V(),[n,a]=l.useState(t.tab||"wallet");return l.useEffect(()=>(Cu(),Za().setPermissionRequestCallback(async(r,o,c)=>{const i=Su.state.apps.get(r)?.manifest.icon;return new Promise(d=>{const u=window.setTimeout(()=>d(!1),3e4),m=f=>{window.clearTimeout(u);const h=f.detail;d(h?.approved===!0)};window.addEventListener("permission-request",m,{once:!0}),s("PermissionRequestJob",{appName:o,appIcon:i,permissions:JSON.stringify(c)})})}),er(async r=>{const o=r?.app?.name,c=r?.app?.icon;return new Promise(i=>{const d=window.setTimeout(()=>i(null),3e4),u=()=>{window.clearTimeout(d),window.removeEventListener("wallet-picker-select",m),window.removeEventListener("wallet-picker-cancel",f)},m=h=>{u();const g=h.detail;i({address:g.address,chain:g.chain,name:g.name})},f=()=>{u(),i(null)};window.addEventListener("wallet-picker-select",m),window.addEventListener("wallet-picker-cancel",f),s("WalletPickerJob",{chain:r?.chain,exclude:r?.exclude,...o?{appName:o}:{},...c?{appIcon:c}:{}})})}),tr(()=>{const r=me.state,o=_e.getCurrentWallet(r);return o?o.chainAddresses.map(c=>({address:c.address,chain:c.chain,name:o.name})):[]}),sr(async r=>new Promise(o=>{const c=window.setTimeout(()=>o(null),6e4),i=d=>{window.clearTimeout(c);const u=d.detail;if(u?.confirmed&&u.signature&&u.publicKey){o({signature:u.signature,publicKey:u.publicKey});return}o(null)};window.addEventListener("signing-confirm",i,{once:!0}),s("SigningConfirmJob",{message:r.message,address:r.address,appName:r.app.name,appIcon:r.app.icon??"",chainName:"bioforest"})})),nr(async r=>new Promise(o=>{const c=window.setTimeout(()=>o(null),6e4),i=d=>{window.clearTimeout(c);const u=d.detail;if(u?.confirmed&&u.txHash){o({txHash:u.txHash});return}o(null)};window.addEventListener("miniapp-transfer-confirm",i,{once:!0}),s("MiniappTransferConfirmJob",{appName:r.app.name,appIcon:r.app.icon??"",from:r.from,to:r.to,amount:r.amount,chain:r.chain,...r.asset?{asset:r.asset}:{}})})),ar(async r=>new Promise(o=>{const c=window.setTimeout(()=>o(null),6e4),i=d=>{window.clearTimeout(c);const u=d.detail;if(u?.confirmed&&u.signedTx){o(u.signedTx);return}o(null)};window.addEventListener("miniapp-sign-transaction-confirm",i,{once:!0}),s("MiniappSignTransactionJob",{appName:r.app.name,appIcon:r.app.icon??"",from:r.from,chain:r.chain,unsignedTx:JSON.stringify(r.unsignedTx)})})),rr(async r=>{const o=r.app?.name,c=r.app?.icon;return new Promise(i=>{const d=window.setTimeout(()=>i(null),3e4),u=()=>{window.clearTimeout(d),window.removeEventListener("wallet-picker-select",m),window.removeEventListener("wallet-picker-cancel",f)},m=h=>{u();const g=h.detail;i({address:g.address,chain:g.chain,name:g.name})},f=()=>{u(),i(null)};window.addEventListener("wallet-picker-select",m),window.addEventListener("wallet-picker-cancel",f),s("WalletPickerJob",{chain:r.chainId,...o?{appName:o}:{},...c?{appIcon:c}:{}})})}),ir(async r=>new Promise(o=>{const c=window.setTimeout(()=>o(!1),3e4),i=d=>{window.clearTimeout(c);const u=d.detail;o(u?.approved===!0)};window.addEventListener("chain-switch-confirm",i,{once:!0}),s("ChainSwitchConfirmJob",{fromChainId:r.fromChainId,toChainId:r.toChainId,appName:r.appName,appIcon:r.appIcon})})),or(async r=>new Promise(o=>{const c=window.setTimeout(()=>o(null),6e4),i=d=>{window.clearTimeout(c);const u=d.detail;if(u?.confirmed&&u.signature){o({signature:u.signature});return}o(null)};window.addEventListener("signing-confirm",i,{once:!0}),s("SigningConfirmJob",{message:r.message,address:r.address,appName:r.appName,chainName:"ethereum"})})),cr(async r=>{const{from:o,to:c,value:i,chainId:d}=r.tx;if(!o||!c)return null;const u=BigInt(i??"0x0"),m=Vg(u,18),f=d?yn(d):null;return new Promise(h=>{const g=window.setTimeout(()=>h(null),6e4),v=p=>{window.clearTimeout(g);const b=p.detail;if(b?.confirmed&&b.txHash){h({txHash:b.txHash});return}h(null)};window.addEventListener("miniapp-transfer-confirm",v,{once:!0}),s("MiniappTransferConfirmJob",{appName:r.appName,from:o,to:c,amount:m,chain:f??"ethereum"})})}),lr(async r=>{const o=r?.app?.name,c=r?.app?.icon;return new Promise(i=>{const d=window.setTimeout(()=>i(null),3e4),u=()=>{window.clearTimeout(d),window.removeEventListener("wallet-picker-select",m),window.removeEventListener("wallet-picker-cancel",f)},m=h=>{u();const g=h.detail;i({address:g.address,chain:g.chain,name:g.name})},f=()=>{u(),i(null)};window.addEventListener("wallet-picker-select",m),window.addEventListener("wallet-picker-cancel",f),s("WalletPickerJob",{chain:"tron",...o?{appName:o}:{},...c?{appIcon:c}:{}})})}),()=>{Za().setPermissionRequestCallback(null),er(null),rr(null),ir(null),or(null),cr(null),lr(null),tr(null),sr(null),nr(null),ar(null)}),[s]),e.jsx(Q,{children:e.jsx(tu,{children:e.jsxs("div",{className:"bg-background relative h-dvh",children:[e.jsx(l.Activity,{mode:n==="wallet"?"visible":"hidden",children:e.jsx(Ec,{})}),e.jsx("div",{style:{display:n==="ecosystem"?"contents":"none"},children:e.jsx(Wc,{})}),e.jsx(l.Activity,{mode:n==="settings"?"visible":"hidden",children:e.jsx(Nl,{})}),e.jsx(su,{activeTab:n,onTabChange:a})]})})})};wl.__docgenInfo={description:"",methods:[],displayName:"MainTabsActivity"};function Cl(){const{t}=L("wallet"),{navigate:s,goBack:n}=Z(),{push:a}=V(),r=le(me,m=>m.wallets),o=le(me,m=>m.currentWalletId),c=l.useCallback(m=>{de.setCurrentWallet(m)},[]),i=l.useCallback(m=>{s({to:`/wallet/${m}`})},[s]),d=l.useCallback(()=>{a("WalletAddJob",{})},[a]),u=l.useCallback(()=>{n()},[n]);return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(H,{title:t("list.title"),onBack:u,rightAction:e.jsx("button",{onClick:d,className:M("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":t("add"),children:e.jsx(st,{className:"size-5"})})}),e.jsx("div",{className:"flex-1 p-4",children:r.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[e.jsx("p",{className:"text-muted-foreground",children:t("list.empty")}),e.jsx("button",{onClick:d,className:M("bg-primary rounded-full px-6 py-2.5 text-sm font-medium text-primary-foreground","hover:bg-primary/90 active:bg-primary/80"),children:t("add")})]}):e.jsx("div",{className:"space-y-3",children:r.map(m=>e.jsx(Kg,{wallet:m,isActive:m.id===o,onSelect:()=>c(m.id),onDetail:()=>i(m.id),t},m.id))})})]})}function Kg({wallet:t,isActive:s,onSelect:n,onDetail:a,t:r}){const o=t.chainAddresses.reduce((c,i)=>c+i.tokens.reduce((d,u)=>d+u.fiatValue,0),0);return e.jsxs("div",{className:M("bg-card rounded-xl p-4 shadow-sm transition-colors",s&&"ring-primary ring-2"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:n,className:M("flex size-12 items-center justify-center rounded-full text-lg font-semibold",s?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),children:t.name.slice(0,1)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"truncate font-semibold",children:t.name}),s&&e.jsxs("span",{className:"text-primary flex items-center gap-1 text-xs",children:[e.jsx(fe,{className:"size-3"}),r("list.current")]})]}),e.jsx("p",{className:"text-muted-foreground text-sm",children:r("list.chainAddresses",{count:t.chainAddresses.length})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-semibold",children:["$",o.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})}),e.jsx("button",{onClick:a,className:M("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":r("list.viewDetail"),children:e.jsx(Ce,{className:"text-muted-foreground size-5"})})]})]}),e.jsx("p",{className:"text-muted-foreground mt-2 truncate font-mono text-xs",children:t.address})]})}Cl.__docgenInfo={description:"",methods:[],displayName:"WalletListPage"};const Sl=()=>e.jsx(Q,{children:e.jsx(Cl,{})});Sl.__docgenInfo={description:"",methods:[],displayName:"WalletListActivity"};function Gg(){const{t}=L("wallet"),{walletId:s,mode:n="default"}=ae(),{goBack:a,navigate:r}=Z(),c=Pt().find(u=>u.id===s),i=()=>{r({to:"/",replace:!0})};if(!c)return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(H,{title:t("detail.title"),onBack:a}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(kt,{variant:"error",children:t("detail.notFound")})})]});const d=t(n==="edit-only"?"detail.editTitle":"detail.title");return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(H,{title:d,...n!=="edit-only"&&{onBack:a}}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsx(In,{mode:n,walletId:s,onEditOnlyComplete:i}),n==="default"&&e.jsx("div",{className:"mt-6",children:e.jsx(kt,{variant:"warning",children:t("detail.securityWarning")})})]})]})}const kl=({params:t})=>e.jsx(Q,{children:e.jsx(ee,{params:t,children:e.jsx(Gg,{})})});kl.__docgenInfo={description:"",methods:[],displayName:"WalletConfigActivity"};const Qg=["pattern","mnemonic","verify","chains","theme"];function Al(){const{goBack:t,navigate:s}=Z(),{t:n}=L("onboarding"),a=us(),[r,o]=l.useState("pattern"),[c,i]=l.useState(""),[d]=l.useState(()=>{if(typeof window<"u"){const _=window.__E2E_MNEMONIC__;if(typeof _=="string"&&_.trim())return _.trim().split(/\s+/);if(Array.isArray(_)&&_.every(A=>typeof A=="string"))return _}return sm()}),[u,m]=l.useState(!0),[f,h]=l.useState(!1),[g,v]=l.useState([]),[p,b]=l.useState(!1),[y,x]=l.useState(!1),[j,N]=l.useState(null),w=Qg.indexOf(r)+1;l.useEffect(()=>{!p&&a.length>0&&(v(Zi(a)),b(!0))},[a,p]);const S=()=>{r==="mnemonic"?(o("pattern"),i("")):r==="verify"?o("mnemonic"):r==="chains"?o("verify"):r==="theme"||t()},C=_=>{i(_),o("mnemonic")},T=()=>{(f||!u)&&o("verify")},k=()=>{o("chains")},I=async()=>{if(!y){x(!0);try{const _=d.join(" "),R=(await qi({mnemonic:_,selectedChainIds:g,chainConfigs:a})).map(({chainId:z,address:q,publicKey:K})=>({chain:z,address:q,publicKey:K??"",tokens:[]})),E=R[0];if(!E)throw new Error("No chain addresses derived");const B=Gn(E.address),P=await de.createWallet({name:n("create.defaultWalletName"),keyType:"mnemonic",address:E.address,chain:E.chain,chainAddresses:R,themeHue:B},_,c,B);N(P.id),o("theme")}catch(_){console.error(n("create.createFailed"),_)}finally{x(!1)}}},D=()=>{s({to:"/",replace:!0})};return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(H,{title:n("create.title"),onBack:S}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(Ze,{total:5,current:w})}),e.jsxs("div",{className:"flex-1 p-4",children:[r==="pattern"&&e.jsx("div",{"data-testid":"pattern-step",children:e.jsx(ba,{onComplete:C,minPoints:4})}),r==="mnemonic"&&e.jsx("div",{"data-testid":"mnemonic-step",children:e.jsx(Yg,{mnemonic:d,hidden:u,copied:f,onToggleHidden:()=>m(!u),onCopy:()=>h(!0),onContinue:T})}),r==="verify"&&e.jsx("div",{"data-testid":"verify-step",children:e.jsx(Xg,{mnemonic:d,onContinue:k})}),r==="chains"&&e.jsx("div",{"data-testid":"chain-selector-step",children:e.jsx(Zg,{chains:a,selectedChains:g,selectionCount:g.length,onSelectionChange:v,onComplete:I,completeLabel:n("create.nextStep"),isSubmitting:y})}),r==="theme"&&j&&e.jsx("div",{"data-testid":"theme-step",children:e.jsx(In,{mode:"edit-only",walletId:j,onEditOnlyComplete:D})})]})]})}function Yg({mnemonic:t,hidden:s,copied:n,onToggleHidden:a,onCopy:r,onContinue:o}){const{t:c}=L("onboarding"),i=n||!s;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(bs,{icon:Ca,variant:"warning",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:c("create.backupMnemonic")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:c("create.backupHint")})]}),e.jsx(kt,{variant:"warning",children:c("create.mnemonicWarning")}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:c("create.mnemonicTitle")}),e.jsxs("button",{type:"button","data-testid":"toggle-mnemonic-button",onClick:a,className:"text-primary flex items-center gap-1 text-sm",children:[s?e.jsx(Na,{className:"size-4"}):e.jsx(to,{className:"size-4"}),c(s?"create.mnemonicShow":"create.mnemonicHide")]})]}),e.jsx(Xi,{words:t,hidden:s,onCopy:r})]}),e.jsxs(Ee,{variant:"mint",className:"w-full","data-testid":"mnemonic-backed-up-button",disabled:!i,onClick:o,children:[c(i?"create.mnemonicBackedUp":"create.mnemonicViewFirst"),i&&e.jsx(Ce,{className:"ml-2 size-4"})]})]})}function Xg({mnemonic:t,onContinue:s}){const{t:n}=L(["onboarding","common"]),[a]=l.useState(()=>Array.from({length:t.length},(f,h)=>h).toSorted(()=>Math.random()-.5).slice(0,3).toSorted((f,h)=>f-h)),[r,o]=l.useState({}),c=a.every(u=>{const m=t[u],f=r[u];return m&&f&&f.toLowerCase()===m.toLowerCase()}),i=(u,m)=>{o(f=>({...f,[u]:m}))},d=u=>{const m=t[u],f=r[u];if(f&&m&&f.toLowerCase()!==m.toLowerCase())return n("create.wordIncorrect")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(bs,{icon:Gt,variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:n("create.verifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("create.verifyDesc")})]}),e.jsx("div",{className:"space-y-4",children:a.map(u=>e.jsx(tm,{label:n("create.wordN",{n:u+1}),error:d(u),children:e.jsx(Pe,{"data-testid":`verify-word-input-${u}`,"data-verify-index":u,value:r[u]||"",onChange:m=>i(u,m.target.value),className:M(d(u)&&"border-destructive focus-visible:ring-destructive"),placeholder:n("create.wordNPlaceholder",{n:u+1}),autoCapitalize:"off",autoCorrect:"off"})},u))}),e.jsx(Ee,{variant:"mint",className:"w-full","data-testid":"verify-next-button",disabled:!c,onClick:s,children:n("common:next")})]})}function Zg({chains:t,selectedChains:s,selectionCount:n,isSubmitting:a,completeLabel:r,onSelectionChange:o,onComplete:c}){const{t:i}=L(["onboarding","common"]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(bs,{icon:Gt,variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:i("chainSelector.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:i("chainSelector.subtitle")})]}),t.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(be,{})}):e.jsx(wa,{"data-testid":"chain-selector",chains:t,selectedChains:s,onSelectionChange:o}),e.jsx(Ee,{variant:"mint",className:"w-full","data-testid":"chain-selector-complete-button",disabled:n===0||a,onClick:c,children:r})]})}Al.__docgenInfo={description:"",methods:[],displayName:"WalletCreatePage"};const Tl=()=>e.jsx(Q,{children:e.jsx(Al,{})});Tl.__docgenInfo={description:"",methods:[],displayName:"WalletCreateActivity"};const ev={ETH:{amount:"0.002",symbol:"ETH"},USDT:{amount:"0.003",symbol:"ETH"},USDC:{amount:"0.003",symbol:"ETH"},BTC:{amount:"0.0001",symbol:"BTC"},TRX:{amount:"1",symbol:"TRX"},BFM:{amount:"0.1",symbol:"BFM"}},fi={step:"input",asset:null,toAddress:"",amount:null,addressError:null,amountError:null,feeAmount:null,feeMinAmount:null,feeSymbol:"",feeLoading:!1,isSubmitting:!1,resultStatus:null,txHash:null,errorMessage:null};async function tv(t,s){const n=xs(t.id);if(!n.supportsFeeEstimate)throw new Error(`Chain ${t.id} does not support fee estimation`);return{amount:(await n.estimateFee({from:s,to:s,amount:ce.fromRaw("1",t.decimals,t.symbol)})).standard.amount,symbol:t.symbol}}async function sv({chainConfig:t,walletId:s,password:n,fromAddress:a,toAddress:r,amount:o}){let c;try{c=await un.getMnemonic(s,n)}catch(i){return i instanceof mn&&i.code===fn.DECRYPTION_FAILED?{status:"password"}:{status:"error",message:i instanceof Error?i.message:""}}if(!o.isPositive())return{status:"error",message:""};try{const i=xs(t.id);if(!i.supportsFullTransaction)return{status:"error",message:`: ${t.id}`};console.log("[submitWeb3Transfer] Starting transfer:",{chain:t.id,type:t.type,fromAddress:a,toAddress:r,amount:o.toRawString()});const d=Vd(c);console.log("[submitWeb3Transfer] Building transaction...");const u=await i.buildTransaction({from:a,to:r,amount:o});console.log("[submitWeb3Transfer] Signing transaction...");const m=await i.signTransaction(u,d);console.log("[submitWeb3Transfer] Broadcasting transaction...");const f=await i.broadcastTransaction(m);return console.log("[submitWeb3Transfer] SUCCESS! txHash:",f),{status:"ok",txHash:f}}catch(i){console.error("[submitWeb3Transfer] FAILED:",i);const d=i instanceof Error?i.message:String(i);return d.includes("insufficient")||d.includes("")?{status:"error",message:""}:d.includes("fee")||d.includes("")||d.includes("gas")?{status:"error",message:""}:d.includes("not yet implemented")||d.includes("not supported")?{status:"error",message:""}:{status:"error",message:d||""}}}function nv(t,s){const n=xs(t.id);return n.supportsAddressValidation?!s||s.trim()===""?"":n.isValidAddress(s)?null:"":""}function Il(t,s){return t.trim()?s?Zu(t):yu(t):!1}function av(t,s){return t.trim()?Il(t,s)?null:"":""}function rv(t,s){return t?s?t.isPositive()?t.gt(s.amount)?"":null:"":null:""}function iv(t){const{toAddress:s,amount:n,asset:a,isBioforestChain:r,feeLoading:o}=t;return!a||!n||o?!1:s.trim()!==""&&Il(s,r)&&n.isPositive()&&n.lte(a.amount)}function ov(t,s,n){if(!t)return{status:"error",message:""};const a=s.amount;if(t.add(n).lte(a))return{status:"ok"};if(!t.eq(a))return{status:"error",message:""};const r=a.sub(n);return r.isPositive()?{status:"ok",adjustedAmount:r}:{status:"error",message:""}}async function cv(t){t(s=>({...s,step:"sending",isSubmitting:!0}));try{if(await new Promise(n=>setTimeout(n,2e3)),Math.random()>.2)return t(n=>({...n,step:"result",isSubmitting:!1,resultStatus:"success",txHash:`0x${Math.random().toString(16).slice(2)}${Math.random().toString(16).slice(2)}`,errorMessage:null})),{status:"ok"};throw new Error("")}catch(s){return t(n=>({...n,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:s instanceof Error?s.message:""})),{status:"error"}}}function lv(t={}){const{initialAsset:s,useMock:n=!0,walletId:a,fromAddress:r,chainConfig:o}=t,[c,i]=l.useState({...fi,asset:s??null}),d=o?.chainKind==="bioforest",u=o?.chainKind==="evm"||o?.chainKind==="tron"||o?.chainKind==="bitcoin",m=l.useCallback(S=>u&&o?nv(o,S):av(S,d),[d,u,o]),f=l.useCallback((S,C)=>rv(S,C),[]),h=l.useCallback(S=>{i(C=>({...C,toAddress:S,addressError:null}))},[]),g=l.useCallback(S=>{i(C=>({...C,amount:S,amountError:null}))},[]),v=l.useCallback(S=>{i(C=>{if(!C.feeAmount)return C;const T=ce.fromFormatted(S,C.feeAmount.decimals,C.feeAmount.symbol);return{...C,feeAmount:T}})},[]),p=l.useCallback(S=>{if(i(T=>({...T,asset:S,feeLoading:!0})),n||!d&&!u||!o||!r){setTimeout(()=>{const T=ev[S.assetType]??{amount:"0.001",symbol:S.assetType},k=ce.fromFormatted(T.amount,S.decimals,T.symbol);i(I=>({...I,feeAmount:k,feeMinAmount:k,feeSymbol:T.symbol,feeLoading:!1}))},300);return}(async()=>{try{const T=u?await tv(o,r):await Yx(o,r);i(k=>({...k,feeAmount:T.amount,feeMinAmount:T.amount,feeSymbol:T.symbol,feeLoading:!1}))}catch(T){i(k=>({...k,feeLoading:!1,errorMessage:T instanceof Error?T.message:""}))}})()},[o,r,d,u,n]);l.useEffect(()=>{if(n||!d||!o||!r)return;let S=!1;return(async()=>{try{const C=await Xx(o,r);if(S)return;i(T=>({...T,asset:C}))}catch{if(S)return}})(),()=>{S=!0}},[o,r,d,n]);const b=l.useMemo(()=>iv({toAddress:c.toAddress,amount:c.amount,asset:c.asset,isBioforestChain:d,feeLoading:c.feeLoading}),[d,c.amount,c.asset,c.toAddress,c.feeLoading]),y=l.useCallback(()=>{const S=m(c.toAddress),C=c.asset?f(c.amount,c.asset):"";if(S||C)return i(T=>({...T,addressError:S,amountError:C})),!1;if(c.asset&&c.feeAmount&&c.amount){const T=ov(c.amount,c.asset,c.feeAmount);if(T.status==="error")return i(k=>({...k,amountError:T.message})),!1;T.adjustedAmount&&i(k=>({...k,amount:T.adjustedAmount??k.amount}))}return i(T=>({...T,step:"confirm",addressError:null,amountError:null})),!0},[c.toAddress,c.amount,c.asset,c.feeAmount,m,f]),x=l.useCallback(()=>{i(S=>({...S,step:"input"}))},[]),j=l.useCallback(async S=>{if(console.log("[useSend.submit] Called with:",{useMock:n,chainKind:o?.chainKind,walletId:a,fromAddress:r}),n)return console.log("[useSend.submit] Using mock transfer"),(await cv(i)).status==="ok"?{status:"ok"}:{status:"error"};if(!o)return console.log("[useSend.submit] No chain config"),i(I=>({...I,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:""})),{status:"error"};if(o.chainKind==="evm"||o.chainKind==="tron"||o.chainKind==="bitcoin"){if(console.log("[useSend.submit] Using Web3 transfer for:",o.chainKind),!a||!r||!c.asset||!c.amount)return i(D=>({...D,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:""})),{status:"error"};i(D=>({...D,step:"sending",isSubmitting:!0,errorMessage:null}));const I=await sv({chainConfig:o,walletId:a,password:S,fromAddress:r,toAddress:c.toAddress,amount:c.amount});return I.status==="password"?(i(D=>({...D,step:"confirm",isSubmitting:!1})),{status:"password"}):I.status==="error"?(i(D=>({...D,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:I.message})),{status:"error"}):(i(D=>({...D,step:"result",isSubmitting:!1,resultStatus:"success",txHash:I.txHash,errorMessage:null})),{status:"ok",txHash:I.txHash})}if(o.chainKind!=="bioforest")return console.log("[useSend.submit] Chain type not supported:",o.chainKind),i(I=>({...I,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:`: ${o.chainKind}`})),{status:"error"};if(!a||!r||!c.asset)return i(I=>({...I,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:""})),{status:"error"};const C=m(c.toAddress),T=f(c.amount,c.asset);if(C||T)return i(I=>({...I,addressError:C,amountError:T})),{status:"error"};if(i(I=>({...I,step:"sending",isSubmitting:!0,errorMessage:null})),!c.amount)return i(I=>({...I,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:""})),{status:"error"};const k=await oi({chainConfig:o,walletId:a,password:S,fromAddress:r,toAddress:c.toAddress,amount:c.amount,fee:c.feeAmount??void 0});return k.status==="password"?(i(I=>({...I,step:"confirm",isSubmitting:!1})),{status:"password"}):k.status==="password_required"?(i(I=>({...I,step:"confirm",isSubmitting:!1})),{status:"two_step_secret_required",secondPublicKey:k.secondPublicKey}):k.status==="error"?(i(I=>({...I,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:k.message})),{status:"error"}):(i(I=>({...I,step:"result",isSubmitting:!1,resultStatus:"success",txHash:k.txHash,errorMessage:null})),{status:"ok",txHash:k.txHash})},[o,r,c.amount,c.asset,c.toAddress,n,m,f,a]),N=l.useCallback(async(S,C)=>{if(!o||!a||!r)return{status:"error"};if(i(k=>({...k,step:"sending",isSubmitting:!0,resultStatus:null,txHash:null,errorMessage:null})),!c.amount)return i(k=>({...k,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:""})),{status:"error"};const T=await oi({chainConfig:o,walletId:a,password:S,fromAddress:r,toAddress:c.toAddress,amount:c.amount,fee:c.feeAmount??void 0,twoStepSecret:C});return T.status==="password"?(i(k=>({...k,step:"confirm",isSubmitting:!1})),{status:"password"}):T.status==="error"?(i(k=>({...k,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:T.message})),{status:"error"}):T.status==="password_required"?(i(k=>({...k,step:"result",isSubmitting:!1,resultStatus:"failed",txHash:null,errorMessage:""})),{status:"error"}):(i(k=>({...k,step:"result",isSubmitting:!1,resultStatus:"success",txHash:T.txHash,errorMessage:null})),{status:"ok",txHash:T.txHash})},[o,r,c.amount,c.toAddress,a]),w=l.useCallback(()=>{i({...fi,asset:s??null})},[s]);return{state:c,setToAddress:h,setAmount:g,setAsset:p,setFee:v,goToConfirm:y,goBack:x,submit:j,submitWithTwoStepSecret:N,reset:w,canProceed:b}}const dv={ethereum:"Ethereum",bitcoin:"Bitcoin",tron:"Tron",binance:"BSC",bfmeta:"BFMeta",ccchain:"CCChain",pmchain:"PMChain",bfchainv2:"BFChain V2",btgmeta:"BTGMeta",biwmeta:"BIWMeta",ethmeta:"ETHMeta",malibu:"Malibu"};function Pl(){const{t}=L(["transaction","common","security"]),{goBack:s}=Z(),{push:n}=V(),a=nt(),r=Sn(),o=l.useRef(!1),{address:c,amount:i,assetType:d,assetLocked:u}=ae(),m=u==="true",f=Ke(),h=ye(),g=wn(),v=At(),p=v.snapshot?tt.getChainById(v,f):null,b=p?.name??dv[f]??f,y=Cn(),x=l.useMemo(()=>{if(!p)return null;if(d){const re=y.find(je=>je.symbol.toUpperCase()===d.toUpperCase());if(re)return{assetType:re.symbol,name:re.name,amount:ce.fromFormatted(re.balance,re.decimals??p.decimals,re.symbol),decimals:re.decimals??p.decimals,logoUrl:re.icon}}const G=y.find(re=>re.symbol===p.symbol)?.balance??"0";return{assetType:p.symbol,name:p.name,amount:ce.fromFormatted(G,p.decimals,p.symbol),decimals:p.decimals}},[p,y,d]),{state:j,setToAddress:N,setAmount:w,setAsset:S,setFee:C,goToConfirm:T,submit:k,submitWithTwoStepSecret:I,reset:D,canProceed:_}=lv({initialAsset:x??void 0,useMock:!1,walletId:h?.id,fromAddress:g?.address,chainConfig:p}),A=l.useMemo(()=>j.asset?{symbol:j.asset.assetType,name:j.asset.name??j.asset.assetType,balance:j.asset.amount.toFormatted(),decimals:j.asset.decimals,chain:f,icon:j.asset.logoUrl}:null,[j.asset,f]),R=l.useCallback(J=>{const G={assetType:J.symbol,name:J.name,amount:ce.fromFormatted(J.balance,J.decimals??p?.decimals??8,J.symbol),decimals:J.decimals??p?.decimals??8,logoUrl:J.icon};S(G)},[p?.decimals,S]);l.useEffect(()=>{x&&S(x)},[x,S]),l.useEffect(()=>{if(c&&!j.toAddress&&N(c),i&&!j.amount&&j.asset){const J=ce.tryFromFormatted(i,j.asset.decimals,j.asset.assetType);J&&w(J)}},[c,i,j.toAddress,j.amount,j.asset,N,w]),l.useEffect(()=>{const J=G=>{N(G.detail.address.address)};return window.addEventListener("contact-picker-select",J),()=>window.removeEventListener("contact-picker-select",J)},[N]),l.useEffect(()=>{if(j.resultStatus==="success"&&j.toAddress){const J=pn.getContactByAddress(Ft.state,j.toAddress);J&&ms.trackRecentContact(J.contact.id)}},[j.resultStatus,j.toAddress]);const E=l.useCallback(()=>{n("ContactPickerJob",{chainType:f})},[n,f]),B=j.asset?.amount??null,P=j.asset?.assetType??"TOKEN",z=l.useCallback(()=>{Yu(({content:J,parsed:G})=>{let re=J;(G.type==="address"||G.type==="payment")&&(re=G.address),N(re),r.impact("success"),a.show(t("sendPage.scanSuccess"))}),n("ScannerJob",{chainType:b??f})},[n,f,b,N,r,a,t]),q=()=>{T()&&(r.impact("light"),rl(async()=>{o.current||(o.current=!0,await r.impact("medium"),ol(async(J,G)=>{if(!G){const je=await k(J);return je.status==="password"?{status:"wallet_lock_invalid"}:je.status==="two_step_secret_required"?{status:"two_step_secret_required"}:je.status==="ok"?(o.current=!1,{status:"ok",txHash:je.txHash}):{status:"error",message:""}}const re=await I(J,G);return re.status==="ok"?(o.current=!1,{status:"ok",txHash:re.txHash}):re.status==="password"?{status:"two_step_secret_invalid",message:""}:{status:"error",message:re.status==="error"?"":""}}),n("TransferWalletLockJob",{title:t("security:walletLock.verifyTitle")}))},{minFee:j.feeMinAmount?.toFormatted()??j.feeAmount?.toFormatted()??"0",onFeeChange:C}),n("TransferConfirmJob",{amount:j.amount?.toFormatted()??"0",symbol:P,toAddress:j.toAddress,feeAmount:j.feeAmount?.toFormatted()??"0",feeSymbol:j.feeSymbol,feeLoading:j.feeLoading?"true":"false"}))},K=()=>{j.resultStatus==="success"&&r.impact("success"),s()},oe=()=>{D()},Y=()=>{j.txHash&&a.show(t("sendPage.explorerNotImplemented"))};return!h||!g?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(H,{title:t("sendPage.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("history.noWallet")})})]}):j.step==="result"||j.step==="sending"?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(H,{title:t("sendPage.resultTitle")}),e.jsx(no,{status:j.step==="sending"?"pending":j.resultStatus??"pending",amount:j.amount?.toFormatted()??"0",symbol:P,toAddress:j.toAddress,txHash:j.txHash??void 0,errorMessage:j.errorMessage??void 0,onDone:K,onRetry:j.resultStatus==="failed"?oe:void 0,onViewExplorer:j.resultStatus==="success"?Y:void 0})]}):e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(H,{title:t("sendPage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(Ct,{chain:f,size:"sm"}),e.jsx("span",{className:"text-sm font-medium",children:b})]}),g?.address&&e.jsxs("div",{className:"flex items-center justify-center gap-1 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[t("sendPage.from"),":"]}),e.jsxs("span",{className:"font-mono",children:[g.address.slice(0,8),"...",g.address.slice(-6)]})]})]}),y.length>1&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("sendPage.assetLabel","")}),e.jsx(Ji,{selectedAsset:A,assets:y,onSelect:R,disabled:m,testId:"send-asset-selector"})]}),e.jsx(ju,{label:t("sendPage.toAddressLabel"),value:j.toAddress,onChange:N,placeholder:t("sendPage.toAddressPlaceholder",{chain:b}),onScan:z,onContactPicker:E,chainType:f,error:j.addressError??void 0}),e.jsx(so,{label:t("sendPage.amountLabel"),value:j.amount??void 0,onChange:w,balance:B??void 0,symbol:P,error:j.amountError??void 0,fiatValue:j.amount?j.amount.toNumber().toFixed(2):void 0}),e.jsx(kt,{variant:"info",children:t("sendPage.networkWarning",{chain:b})}),e.jsx("div",{className:"pt-4",children:e.jsxs(Ee,{variant:"mint",className:"w-full","data-testid":"send-continue-button",disabled:!_,onClick:q,children:[t("sendPage.continue"),e.jsx(Ce,{className:"-mr-4 ml-2 size-4"})]})})]})]})}Pl.__docgenInfo={description:"",methods:[],displayName:"SendPage"};const El=({params:t})=>e.jsx(Q,{children:e.jsx(ee,{params:t,children:e.jsx(Yi,{children:e.jsx(Pl,{})})})});El.__docgenInfo={description:"",methods:[],displayName:"SendActivity"};const pi={step:"input",asset:null,amount:null,amountError:null,recipientAddress:null,feeAmount:null,feeMinAmount:null,feeSymbol:"",feeLoading:!1,isSubmitting:!1,resultStatus:null,txHash:null,errorMessage:null},Zt={amount:"0.001",symbol:"BFM"};function uv(t,s){if(!t||!s)return null;if(!t.isPositive())return"";const n=s.amount;return t.gt(n)?"":null}function mv(t={}){const{initialAsset:s,assetLocked:n=!1,useMock:a=!0,walletId:r,fromAddress:o,chainConfig:c}=t,[i,d]=l.useState({...pi,asset:s??null}),u=c?.chainKind==="bioforest",m=l.useCallback((j,N)=>uv(j,N),[]),f=l.useCallback(j=>{d(N=>({...N,amount:j,amountError:null}))},[]),h=l.useCallback(j=>{if(d(w=>({...w,asset:j,amount:null,amountError:null,feeLoading:!0,recipientAddress:null})),a||!u||!c||!o){setTimeout(()=>{d(w=>({...w,recipientAddress:"mock_apply_address",feeAmount:ce.fromFormatted(Zt.amount,j.decimals,Zt.symbol),feeMinAmount:ce.fromFormatted(Zt.amount,j.decimals,Zt.symbol),feeSymbol:c?.symbol??Zt.symbol,feeLoading:!1}))},300);return}(async()=>{try{const w=await gl(c,j.assetType,o);if(!w){d(C=>({...C,feeLoading:!1,errorMessage:""}));return}const S=await vl(c,j.assetType,"1");d(C=>({...C,recipientAddress:w,feeAmount:S.amount,feeMinAmount:S.amount,feeSymbol:S.symbol,feeLoading:!1}))}catch(w){d(S=>({...S,feeLoading:!1,errorMessage:w instanceof Error?w.message:""}))}})()},[c,o,u,a]);l.useEffect(()=>{s&&!i.recipientAddress&&h(s)},[s,h,i.recipientAddress]);const g=l.useMemo(()=>!!(i.asset&&i.amount&&i.amount.isPositive()&&i.recipientAddress&&!i.feeLoading),[i.amount,i.asset,i.recipientAddress,i.feeLoading]),v=l.useCallback(()=>{const j=m(i.amount,i.asset);return j?(d(N=>({...N,amountError:j})),!1):i.recipientAddress?(d(N=>({...N,step:"confirm",amountError:null})),!0):(d(N=>({...N,errorMessage:""})),!1)},[i.amount,i.asset,i.recipientAddress,m]),p=l.useCallback(()=>{d(j=>({...j,step:"input"}))},[]),b=l.useCallback(async j=>{if(console.log("[useBurn.submit] Called with:",{useMock:a,chainKind:c?.chainKind,walletId:r,fromAddress:o}),a)return console.log("[useBurn.submit] Using mock burn"),d(w=>({...w,step:"burning",isSubmitting:!0})),await new Promise(w=>setTimeout(w,1500)),d(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"success",txHash:`mock_burn_tx_${Date.now()}`})),{status:"ok",txHash:`mock_burn_tx_${Date.now()}`};if(!c||c.chainKind!=="bioforest")return d(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:" BioForest "})),{status:"error",message:" BioForest "};if(!r||!o||!i.asset||!i.amount||!i.recipientAddress)return d(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:""})),{status:"error",message:""};d(w=>({...w,step:"burning",isSubmitting:!0,errorMessage:null}));const N=await dn({chainConfig:c,walletId:r,password:j,fromAddress:o,recipientAddress:i.recipientAddress,assetType:i.asset.assetType,amount:i.amount,fee:i.feeAmount??void 0});return N.status==="password"?(d(w=>({...w,step:"confirm",isSubmitting:!1})),{status:"password"}):N.status==="password_required"?(d(w=>({...w,step:"confirm",isSubmitting:!1})),{status:"two_step_secret_required",secondPublicKey:N.secondPublicKey}):N.status==="error"?(d(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:N.message})),{status:"error",message:N.message}):(d(w=>({...w,step:"result",isSubmitting:!1,resultStatus:"success",txHash:N.txHash})),{status:"ok",txHash:N.txHash})},[c,o,i.amount,i.asset,i.feeAmount,i.recipientAddress,a,r]),y=l.useCallback(async(j,N)=>{if(!c||!r||!o||!i.asset||!i.amount||!i.recipientAddress)return{status:"error",message:""};d(S=>({...S,step:"burning",isSubmitting:!0,errorMessage:null}));const w=await dn({chainConfig:c,walletId:r,password:j,fromAddress:o,recipientAddress:i.recipientAddress,assetType:i.asset.assetType,amount:i.amount,fee:i.feeAmount??void 0,twoStepSecret:N});return w.status==="password"?(d(S=>({...S,step:"confirm",isSubmitting:!1})),{status:"password"}):w.status==="error"?(d(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"failed",errorMessage:w.message})),{status:"error",message:w.message}):(d(S=>({...S,step:"result",isSubmitting:!1,resultStatus:"success",txHash:w.txHash})),{status:"ok",txHash:w.txHash})},[c,o,i.amount,i.asset,i.feeAmount,i.recipientAddress,r]),x=l.useCallback(()=>{d({...pi,asset:s??null})},[s]);return{state:i,setAmount:f,setAsset:h,goToConfirm:v,goBack:p,submit:b,submitWithTwoStepSecret:y,reset:x,canProceed:g,assetLocked:n}}const fv={ethereum:"Ethereum",bitcoin:"Bitcoin",tron:"Tron",binance:"BSC",bfmeta:"BFMeta",ccchain:"CCChain",pmchain:"PMChain",bfchainv2:"BFChain V2",btgmeta:"BTGMeta",biwmeta:"BIWMeta",ethmeta:"ETHMeta",malibu:"Malibu"};function hi(t){return{assetType:t.symbol,name:t.name,amount:ce.fromFormatted(t.balance,t.decimals??8,t.symbol),decimals:t.decimals??8,logoUrl:t.icon}}function pv(t,s){return{symbol:t.assetType,name:t.name??t.assetType,balance:t.amount.toFormatted(),decimals:t.decimals,chain:s,icon:t.logoUrl}}function _l(){const{t}=L(["transaction","common","security"]),{goBack:s}=Z(),{push:n}=V(),a=nt(),r=Sn(),o=l.useRef(!1),{assetType:c,assetLocked:i}=ae(),d=Ke(),u=ye(),m=wn(),f=At(),h=f.snapshot?tt.getChainById(f,d):null,g=h?.name??fv[d]??d,v=Cn(),p=l.useMemo(()=>h?v.filter(q=>q.symbol.toUpperCase()!==h.symbol.toUpperCase()):[],[v,h]),b=l.useMemo(()=>{if(!c||p.length===0)return null;const q=p.find(K=>K.symbol.toUpperCase()===c.toUpperCase());return q?hi(q):null},[c,p]),y=i==="true",{state:x,setAmount:j,setAsset:N,goToConfirm:w,submit:S,submitWithTwoStepSecret:C,reset:T,canProceed:k}=mv({initialAsset:b??void 0,assetLocked:y,useMock:!1,walletId:u?.id,fromAddress:m?.address,chainConfig:h}),I=l.useCallback(q=>{N(hi(q))},[N]),D=l.useMemo(()=>x.asset?pv(x.asset,d):null,[x.asset,d]),_=x.asset?.amount??null,A=x.asset?.assetType??"TOKEN",R=()=>{w()&&(r.impact("light"),rl(async()=>{o.current||(o.current=!0,await r.impact("medium"),ol(async(q,K)=>{if(!K){const Y=await S(q);return Y.status==="password"?{status:"wallet_lock_invalid"}:Y.status==="two_step_secret_required"?{status:"two_step_secret_required"}:Y.status==="ok"?(o.current=!1,{status:"ok",txHash:Y.txHash}):{status:"error",message:""}}const oe=await C(q,K);return oe.status==="ok"?(o.current=!1,{status:"ok",txHash:oe.txHash}):oe.status==="password"?{status:"two_step_secret_invalid",message:""}:{status:"error",message:oe.status==="error"?"":""}}),n("TransferWalletLockJob",{title:t("security:walletLock.verifyTitle")}))},{minFee:x.feeMinAmount?.toFormatted()??x.feeAmount?.toFormatted()??"0"}),n("TransferConfirmJob",{amount:x.amount?.toFormatted()??"0",symbol:A,toAddress:x.recipientAddress??"",feeAmount:x.feeAmount?.toFormatted()??"0",feeSymbol:x.feeSymbol,feeLoading:x.feeLoading?"true":"false"}))},E=()=>{x.resultStatus==="success"&&r.impact("success"),s()},B=()=>{T()},P=()=>{x.txHash&&a.show(t("sendPage.explorerNotImplemented"))},z=h?.chainKind==="bioforest";return!u||!m?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(H,{title:t("destroyPage.title",""),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("history.noWallet")})})]}):z?x.step==="result"||x.step==="burning"?e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(H,{title:t("destroyPage.resultTitle","")}),e.jsx(no,{status:x.step==="burning"?"pending":x.resultStatus??"pending",amount:x.amount?.toFormatted()??"0",symbol:A,toAddress:x.recipientAddress??"",txHash:x.txHash??void 0,errorMessage:x.errorMessage??void 0,onDone:E,onRetry:x.resultStatus==="failed"?B:void 0,onViewExplorer:x.resultStatus==="success"?P:void 0})]}):e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(H,{title:t("destroyPage.title",""),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(Ct,{chain:d,size:"sm"}),e.jsx("span",{className:"text-sm font-medium",children:g})]}),m?.address&&e.jsxs("div",{className:"flex items-center justify-center gap-1 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[t("sendPage.from"),":"]}),e.jsxs("span",{className:"font-mono",children:[m.address.slice(0,8),"...",m.address.slice(-6)]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("destroyPage.assetLabel","")}),e.jsx(Ji,{selectedAsset:D,assets:p,onSelect:I,disabled:y,excludeAssets:h?[h.symbol]:[],testId:"destroy-asset-selector"}),p.length===0&&e.jsx("p",{className:"text-xs text-muted-foreground",children:t("destroyPage.noDestroyableAssets","")})]}),x.asset&&e.jsx(so,{label:t("destroyPage.amountLabel",""),value:x.amount??void 0,onChange:j,balance:_??void 0,symbol:A,error:x.amountError??void 0}),e.jsx(kt,{variant:"warning",children:t("destroyPage.warning","")}),x.feeAmount&&e.jsx("div",{className:"bg-muted/50 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:t("sendPage.fee","")}),e.jsxs("span",{className:"font-medium",children:[x.feeAmount.toFormatted()," ",x.feeSymbol]})]})}),e.jsx("div",{className:"pt-4",children:e.jsxs(Ee,{variant:"mint",className:"w-full","data-testid":"destroy-continue-button",disabled:!k||p.length===0,onClick:R,children:[e.jsx($s,{className:"-ml-4 mr-2 size-4"}),t("destroyPage.confirm","")]})})]})]}):e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(H,{title:t("destroyPage.title",""),onBack:s}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx($s,{className:"size-16 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground text-center",children:t("destroyPage.notSupported","")})]})]})}_l.__docgenInfo={description:"",methods:[],displayName:"DestroyPage"};const Ml=({params:t})=>e.jsx(Q,{children:e.jsx(ee,{params:t,children:e.jsx(Yi,{children:e.jsx(_l,{})})})});Ml.__docgenInfo={description:"",methods:[],displayName:"DestroyActivity"};const hv={ethereum:"Ethereum",bitcoin:"Bitcoin",tron:"Tron",binance:"BSC",bfmeta:"BFMeta",ccchain:"CCChain",pmchain:"PMChain",bfchainv2:"BFChain V2",btgmeta:"BTGMeta",biwmeta:"BIWMeta",ethmeta:"ETHMeta",malibu:"Malibu"};function Rl(){const{t}=L("transaction"),{goBack:s}=Z(),n=ka(),a=nt(),r=Sn(),o=wn(),c=Ke(),i=hv[c]??c,[d,u]=l.useState(!1),m=o?.address||"",f=async()=>{m&&(await n.write({text:m}),await r.impact("light"),u(!0),a.show(t("receivePage.addressCopied")),setTimeout(()=>u(!1),2e3))},h=async()=>{if(navigator.share&&m)try{await navigator.share({title:t("receivePage.shareTitle"),text:m}),await r.impact("success")}catch{}};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(H,{title:t("receivePage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"text-muted-foreground flex items-center justify-center gap-2",children:[e.jsx(Ct,{chain:c,size:"sm"}),e.jsx("span",{className:"text-sm",children:i})]}),e.jsxs("div",{className:"bg-card flex flex-col items-center gap-4 rounded-2xl p-6 shadow-sm",children:[e.jsx(am,{address:m,chain:c,size:200}),e.jsx("p",{className:"text-muted-foreground text-center text-sm",children:t("receivePage.scanQrCode")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm font-medium",children:t("receivePage.receiveAddress")}),e.jsx("div",{className:"border-border bg-card rounded-xl border p-4",children:e.jsx(He,{address:m,copyable:!0})})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx($,{variant:"outline",className:"flex-1",onClick:f,children:d?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"mr-2 size-4"}),t("receivePage.copied")]}):e.jsxs(e.Fragment,{children:[e.jsx(Di,{className:"mr-2 size-4"}),t("receivePage.copyAddress")]})}),e.jsxs(Ee,{variant:"mint",className:"flex-1",onClick:h,children:[e.jsx(cf,{className:"mr-2 size-4"}),t("receivePage.share")]})]}),e.jsx(kt,{variant:"info",children:t("receivePage.networkWarning",{chain:i})})]})]})}Rl.__docgenInfo={description:"",methods:[],displayName:"ReceivePage"};const Dl=()=>e.jsx(Q,{children:e.jsx(Rl,{})});Dl.__docgenInfo={description:"",methods:[],displayName:"ReceiveActivity"};const zl=()=>e.jsx(Q,{children:e.jsx(Qa,{})});zl.__docgenInfo={description:"",methods:[],displayName:"SettingsActivity"};const xv={"zh-CN":"","zh-TW":"",en:"English",ar:""};function Bl(){const{goBack:t}=Z(),{t:s}=L("settings"),n=fs(),a=r=>{ms.setLanguage(r),t()};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(H,{title:s("languagePage.title"),onBack:t}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:Object.keys(Pi).map((r,o)=>e.jsxs("div",{children:[o>0&&e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsxs("button",{onClick:()=>a(r),className:M("flex w-full items-center justify-between px-4 py-3.5","hover:bg-muted/50 active:bg-muted transition-colors",r===n&&"bg-primary/5"),children:[e.jsx("span",{className:"text-sm font-medium",children:xv[r]}),r===n&&e.jsx(fe,{className:"text-primary size-5"})]})]},r))}),e.jsx("p",{className:"text-muted-foreground mt-4 px-1 text-xs",children:s("languagePage.hint")})]})]})}Bl.__docgenInfo={description:"",methods:[],displayName:"LanguagePage"};const Ll=()=>e.jsx(Q,{children:e.jsx(Bl,{})});Ll.__docgenInfo={description:"",methods:[],displayName:"SettingsLanguageActivity"};function Ol(){const{t}=L("settings"),{goBack:s}=Z(),n=fa(),a=r=>{ms.setCurrency(r),s()};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(H,{title:t("currency.title"),onBack:s}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:Object.keys(Kn).map((r,o)=>e.jsxs("div",{children:[o>0&&e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsxs("button",{onClick:()=>a(r),className:M("flex w-full items-center justify-between px-4 py-3.5","hover:bg-muted/50 active:bg-muted transition-colors",r===n&&"bg-primary/5"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-muted-foreground text-base font-semibold",children:Kn[r].symbol}),e.jsx("span",{className:"text-sm font-medium",children:t(`currency.names.${r}`)})]}),r===n&&e.jsx(fe,{className:"text-primary size-5"})]})]},r))}),e.jsx("p",{className:"text-muted-foreground mt-4 px-1 text-xs",children:t("currency.hint")})]})]})}Ol.__docgenInfo={description:"",methods:[],displayName:"CurrencyPage"};const Fl=()=>e.jsx(Q,{children:e.jsx(Ol,{})});Fl.__docgenInfo={description:"",methods:[],displayName:"SettingsCurrencyActivity"};function gv(t){const{children:s,open:n,defaultOpen:a=!1,onOpenChange:r,onOpenChangeComplete:o,actionsRef:c,handle:i,triggerId:d,defaultTriggerId:u=null}=t,m=Eu(),f=!!m,h=rm(()=>i?.store??new Ru({open:n??a,activeTriggerId:d!==void 0?d:u,modal:!0,disablePointerDismissal:!0,nested:f,role:"alertdialog"})).current;h.useControlledProp("open",n,a),h.useControlledProp("activeTriggerId",d,u),h.useSyncedValue("nested",f),h.useContextCallback("onOpenChange",r),h.useContextCallback("onOpenChangeComplete",o);const g=h.useState("payload");_u({store:h,actionsRef:c,parentContext:m?.store.context});const v=l.useMemo(()=>({store:h}),[h]);return e.jsx(Mu.Provider,{value:v,children:typeof s=="function"?s({payload:g}):s})}function Wl({...t}){return e.jsx(gv,{"data-slot":"alert-dialog",...t})}function $l({...t}){return e.jsx(Ou,{"data-slot":"alert-dialog-portal",...t})}function ql({className:t,...s}){return e.jsx(Fu,{"data-slot":"alert-dialog-overlay",className:M("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 bg-black/10 duration-100 supports-backdrop-filter:backdrop-blur-xs fixed inset-0 isolate z-50",t),...s})}function Hl({className:t,size:s="default",...n}){return e.jsxs($l,{children:[e.jsx(ql,{}),e.jsx(Du,{"data-slot":"alert-dialog-content","data-size":s,className:M("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 data-closed:zoom-out-95 data-open:zoom-in-95 bg-background ring-foreground/10 gap-4 rounded-xl p-4 ring-1 duration-100 data-[size=default]:max-w-xs data-[size=sm]:max-w-xs data-[size=default]:sm:max-w-sm group/alert-dialog-content fixed top-1/2 left-1/2 z-50 grid w-full -translate-x-1/2 -translate-y-1/2 outline-none",t),...n})]})}function Ul({className:t,...s}){return e.jsx("div",{"data-slot":"alert-dialog-header",className:M("grid grid-rows-[auto_1fr] place-items-center gap-1.5 text-center has-data-[slot=alert-dialog-media]:grid-rows-[auto_auto_1fr] has-data-[slot=alert-dialog-media]:gap-x-4 sm:group-data-[size=default]/alert-dialog-content:place-items-start sm:group-data-[size=default]/alert-dialog-content:text-left sm:group-data-[size=default]/alert-dialog-content:has-data-[slot=alert-dialog-media]:grid-rows-[auto_1fr]",t),...s})}function Jl({className:t,...s}){return e.jsx("div",{"data-slot":"alert-dialog-footer",className:M("bg-muted/50 -mx-4 -mb-4 rounded-b-xl border-t p-4 flex flex-col-reverse gap-2 group-data-[size=sm]/alert-dialog-content:grid group-data-[size=sm]/alert-dialog-content:grid-cols-2 sm:flex-row sm:justify-end",t),...s})}function Vl({className:t,...s}){return e.jsx(zu,{"data-slot":"alert-dialog-title",className:M("text-sm font-medium sm:group-data-[size=default]/alert-dialog-content:group-has-data-[slot=alert-dialog-media]/alert-dialog-content:col-start-2",t),...s})}function Kl({className:t,...s}){return e.jsx(Bu,{"data-slot":"alert-dialog-description",className:M("text-muted-foreground *:[a]:hover:text-foreground text-sm text-balance md:text-pretty *:[a]:underline *:[a]:underline-offset-3",t),...s})}function Gl({className:t,...s}){return e.jsx($,{"data-slot":"alert-dialog-action",className:M(t),...s})}function Ql({className:t,variant:s="outline",size:n="default",...a}){return e.jsx(Lu,{"data-slot":"alert-dialog-cancel",className:M(t),render:e.jsx($,{variant:s,size:n}),...a})}Wl.__docgenInfo={description:"",methods:[],displayName:"AlertDialog"};Gl.__docgenInfo={description:"",methods:[],displayName:"AlertDialogAction"};Ql.__docgenInfo={description:"",methods:[],displayName:"AlertDialogCancel",props:{variant:{defaultValue:{value:'"outline"',computed:!1},required:!1},size:{defaultValue:{value:'"default"',computed:!1},required:!1}}};Hl.__docgenInfo={description:"",methods:[],displayName:"AlertDialogContent",props:{size:{required:!1,tsType:{name:"union",raw:'"default" | "sm"',elements:[{name:"literal",value:'"default"'},{name:"literal",value:'"sm"'}]},description:"",defaultValue:{value:'"default"',computed:!1}}}};Kl.__docgenInfo={description:"",methods:[],displayName:"AlertDialogDescription"};Jl.__docgenInfo={description:"",methods:[],displayName:"AlertDialogFooter"};Ul.__docgenInfo={description:"",methods:[],displayName:"AlertDialogHeader"};ql.__docgenInfo={description:"",methods:[],displayName:"AlertDialogOverlay"};$l.__docgenInfo={description:"",methods:[],displayName:"AlertDialogPortal"};Vl.__docgenInfo={description:"",methods:[],displayName:"AlertDialogTitle"};function xi(t){if(typeof t!="object"||t===null||Array.isArray(t))return null;const s=t.id;return typeof s=="string"&&s.trim()!==""?s:null}function vv(t){try{const s=JSON.parse(t),n=Array.isArray(s)?s.map(xi):[xi(s)];return Array.from(new Set(n.filter(a=>typeof a=="string")))}catch{return[]}}function bv(t,s){switch(s){case"default":return t("chainConfig.source.default");case"subscription":return t("chainConfig.source.subscription");case"manual":return t("chainConfig.source.manual")}}function yv(t){switch(t){case"default":return"bg-muted text-muted-foreground";case"subscription":return"bg-blue-500/10 text-blue-600";case"manual":return"bg-amber-500/10 text-amber-700"}}function jv(t){const s=new Map;for(const n of t)s.set(n.id,n);return s}function Yl(){const{goBack:t}=Z(),{t:s}=L("settings"),n=nt(),a=us(),r=Si(),o=ki(),c=Ai(),i=Ti(),d=l.useMemo(()=>jv(o),[o]),[u,m]=l.useState("default"),[f,h]=l.useState(""),[g,v]=l.useState(!1),[p,b]=l.useState([]),y=l.useRef(null),x=l.useRef(null),j=l.useRef(!1);l.useEffect(()=>{ct.initialize()},[]),l.useEffect(()=>{r?.url&&m(r.url)},[r?.url]),l.useEffect(()=>{const k=j.current;if(j.current=c,!k||c)return;const I=y.current;if(I){if(y.current=null,i){n.show(i);return}n.show(s(`chainConfig.toast.${I}`)),I==="manualAdded"&&h("")}},[i,c,s,n]);const N=async()=>{y.current="subscriptionSaved",await ct.setSubscriptionUrl(u)},w=async()=>{y.current="subscriptionRefreshed",await ct.refreshSubscription()},S=async()=>{const k=vv(f),I=new Set(a.map(_=>_.id)),D=k.filter(_=>I.has(_));if(D.length>0){x.current=f,b(D),v(!0);return}y.current="manualAdded",await ct.addManualConfig(f)},C=()=>{x.current=null,b([]),v(!1)},T=async()=>{const k=x.current;x.current=null,b([]),v(!1),k&&(y.current="manualAdded",await ct.addManualConfig(k))};return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(H,{title:s("chainConfig.title"),onBack:t}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx(Wl,{open:g,onOpenChange:k=>{k?v(k):C()},children:e.jsxs(Hl,{children:[e.jsxs(Ul,{children:[e.jsx(Vl,{children:s("chainConfig.manual.duplicate.title")}),e.jsx(Kl,{children:s("chainConfig.manual.duplicate.description")})]}),e.jsx("div",{className:"bg-muted/50 text-muted-foreground rounded-lg px-3 py-2 text-xs font-mono break-all",children:p.join(", ")}),e.jsxs(Jl,{children:[e.jsx(Ql,{onClick:C,children:s("chainConfig.manual.duplicate.cancel")}),e.jsx(Gl,{onClick:T,disabled:c,children:s("chainConfig.manual.duplicate.replace")})]})]})}),i&&e.jsx("div",{className:"border-destructive/20 bg-destructive/5 text-destructive rounded-xl border px-4 py-3 text-sm",children:i}),e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:e.jsxs("div",{className:"space-y-3 px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.subscription.title")}),e.jsx("div",{className:"text-muted-foreground text-xs",children:e.jsx(ro,{ns:"settings",i18nKey:"chainConfig.subscription.description",components:{code:e.jsx("code",{className:"font-mono"})}})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{type:"button",variant:"outline",size:"icon","data-testid":"refresh-subscription-button",onClick:w,disabled:c,"aria-label":s("chainConfig.subscription.refreshAriaLabel"),children:e.jsx(gs,{className:M("size-4",c&&"animate-spin")})}),e.jsx($,{type:"button","data-testid":"save-subscription-button",onClick:N,disabled:c,children:s("chainConfig.subscription.save")})]})]}),e.jsx(Pe,{"data-testid":"subscription-url-input",value:u,onChange:k=>m(k.target.value),placeholder:s("chainConfig.subscription.placeholder"),disabled:c,autoCapitalize:"off",autoCorrect:"off",spellCheck:!1}),r?.lastUpdated&&e.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.subscription.lastUpdated",{value:r.lastUpdated})})]})}),e.jsx("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm","data-testid":"manual-add-section",children:e.jsxs("div",{className:"space-y-3 px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.manual.title")}),e.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.manual.description")})]}),e.jsxs($,{type:"button",variant:"outline","data-testid":"add-chain-button",onClick:S,disabled:c||f.trim()==="",children:[e.jsx(st,{className:"size-4"}),s("chainConfig.manual.add")]})]}),e.jsx("textarea",{"data-testid":"manual-config-textarea",value:f,onChange:k=>h(k.target.value),placeholder:s("chainConfig.manual.placeholder"),rows:5,disabled:c,className:M("bg-background w-full resize-none rounded-lg border px-3 py-3 text-sm","placeholder:text-muted-foreground","focus:ring-ring focus:ring-2 focus:ring-offset-2 focus:outline-none","disabled:cursor-not-allowed disabled:opacity-50"),autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})]})}),e.jsxs("div",{className:"bg-card overflow-hidden rounded-xl shadow-sm",children:[e.jsxs("div",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-sm font-medium",children:s("chainConfig.list.title")}),e.jsx("div",{className:"text-muted-foreground text-xs",children:s("chainConfig.list.description")})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{children:[a.map((k,I)=>{const D=d.get(k.id),_=D?.kind==="incompatible_major",A=bv(s,k.source);return e.jsxs("div",{"data-testid":`chain-item-${k.id}`,children:[I>0&&e.jsx("div",{className:"bg-border mx-4 h-px"}),e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate text-sm font-medium",children:k.name}),e.jsx("span",{className:M("rounded px-2 py-0.5 text-xs",yv(k.source)),children:A})]}),e.jsxs("div",{className:"text-muted-foreground mt-1 flex flex-wrap gap-x-3 gap-y-1 text-xs",children:[e.jsx("span",{className:"font-mono",children:k.id}),e.jsxs("span",{children:["v",k.version]}),e.jsx("span",{children:k.chainKind}),e.jsx("span",{children:k.symbol})]}),D?.kind==="incompatible_major"&&e.jsxs("div",{className:"mt-2 flex items-start gap-2 rounded-lg bg-amber-500/10 px-3 py-2 text-xs text-amber-800",children:[e.jsx(Se,{className:"mt-0.5 size-4 shrink-0"}),e.jsx("div",{children:s("chainConfig.warning.incompatibleMajor",{version:D.version,supportedMajor:D.supportedMajor})})]})]}),e.jsx(Hi,{checked:k.enabled,onCheckedChange:R=>{ct.setChainEnabled(k.id,R)},disabled:c||_,className:M(_&&"cursor-not-allowed opacity-60")})]})})]},k.id)}),a.length===0&&e.jsx("div",{className:"text-muted-foreground px-4 py-8 text-center text-sm",children:s("chainConfig.list.empty")})]})]}),e.jsx("div",{className:"text-muted-foreground px-1 text-xs",children:s("chainConfig.hint")})]})]})}Yl.__docgenInfo={description:"",methods:[],displayName:"ChainConfigPage"};const Xl=()=>e.jsx(Q,{children:e.jsx(Yl,{})});Xl.__docgenInfo={description:"",methods:[],displayName:"SettingsChainsActivity"};const Nv=3e4;function Zl(){const{t}=L("settings"),{goBack:s}=Z(),{push:n}=V(),a=ye(),o=(a?.keyType??"mnemonic")==="arbitrary",[c,i]=l.useState(""),[d,u]=l.useState(!0),m=l.useRef(!1);l.useEffect(()=>{if(c.length>0&&!d){const g=setTimeout(()=>{u(!0)},Nv);return()=>clearTimeout(g)}},[c.length,d]),l.useEffect(()=>{const g=()=>{document.hidden&&c.length>0&&u(!0)};return document.addEventListener("visibilitychange",g),()=>{document.removeEventListener("visibilitychange",g)}},[c.length]),l.useEffect(()=>{m.current||!a?.encryptedMnemonic||(m.current=!0,rt(async g=>{try{const v=await Lt(a.encryptedMnemonic,g);return i(v),u(!1),!0}catch{return!1}}),n("WalletLockConfirmJob",{title:t("viewMnemonic.verifyTitle"),description:t(o?"viewMnemonic.verifyDescKey":"viewMnemonic.verifyDescMnemonic")}))},[a,n,t,o]);const f=()=>{u(g=>!g)};if(!a)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(H,{title:t(o?"viewMnemonic.titleKey":"viewMnemonic.titleMnemonic"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("viewMnemonic.noWallet")})})]});const h=o?[]:c.trim().split(/\s+/).filter(Boolean);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(H,{title:t(o?"viewMnemonic.titleKey":"viewMnemonic.titleMnemonic"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"flex gap-3 rounded-xl bg-amber-500/10 p-4",children:[e.jsx(Se,{className:"size-5 shrink-0 text-amber-500"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("p",{className:"font-medium text-amber-700 dark:text-amber-400",children:t("viewMnemonic.securityTip")}),e.jsx("p",{className:"text-muted-foreground",children:t(o?"viewMnemonic.securityWarningKey":"viewMnemonic.securityWarningMnemonic")})]})]}),c.length>0&&e.jsxs("div",{className:"bg-card space-y-4 rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:o?t("viewMnemonic.charCount",{count:c.length}):t("viewMnemonic.wordCount",{count:h.length})}),e.jsx("button",{onClick:f,className:M("flex items-center gap-1.5 rounded-full px-3 py-1.5 text-xs font-medium","bg-muted hover:bg-muted/80 transition-colors"),children:d?e.jsxs(e.Fragment,{children:[e.jsx(Na,{className:"size-3.5"}),t("viewMnemonic.show")]}):e.jsxs(e.Fragment,{children:[e.jsx(to,{className:"size-3.5"}),t("viewMnemonic.hide")]})})]}),o?e.jsx("textarea",{value:c,readOnly:!0,rows:4,"data-testid":"secret-textarea",className:M("bg-background w-full resize-none rounded-lg border px-3 py-3 font-mono text-sm","focus:outline-none",d?"[-webkit-text-security:disc]":"[-webkit-text-security:none]")}):e.jsx(Xi,{words:h,hidden:d}),!d&&e.jsx("p",{className:"text-muted-foreground text-center text-xs",children:t("viewMnemonic.autoHideNote")})]})]})]})}Zl.__docgenInfo={description:"",methods:[],displayName:"ViewMnemonicPage"};const ed=()=>e.jsx(Q,{children:e.jsx(Zl,{})});ed.__docgenInfo={description:"",methods:[],displayName:"SettingsMnemonicActivity"};function td(){const{t}=L("settings"),{goBack:s}=Z(),n=ye(),[a,r]=l.useState("verify"),[o,c]=l.useState("pattern"),[i,d]=l.useState([]),[u,m]=l.useState(!1),[f,h]=l.useState(!1),g=l.useRef(null),[v,p]=l.useState([]),[b,y]=l.useState(!1),[x,j]=l.useState(null),[N,w]=l.useState(null),S=l.useCallback(()=>{g.current&&(clearTimeout(g.current),g.current=null),m(!1)},[]),C=l.useCallback(_=>{u&&_.length>0&&S(),d(_)},[u,S]),T=l.useCallback(async _=>{if(n?.encryptedMnemonic){h(!0),S();try{const A=St(_);await pt(n.encryptedMnemonic,A)?(d(_),r("setup")):(m(!0),d([]),g.current=setTimeout(()=>{m(!1)},1500))}catch{m(!0),d([]),g.current=setTimeout(()=>{m(!1)},1500)}finally{h(!1)}}},[n,S]),k=l.useCallback((_,A)=>{p(_),y(A),j(null)},[]),I=l.useCallback(async()=>{if(n?.encryptedWalletLock){h(!0),j(null);try{if(!eo(v)){j(t("changeWalletLock.invalidMnemonic")),h(!1);return}const _=v.join(" ");await de.verifyMnemonic(n.id,_)?(w(_),r("setup")):j(t("changeWalletLock.mnemonicVerifyFailed"))}catch{j(t("changeWalletLock.mnemonicVerifyFailed"))}finally{h(!1)}}},[n,v,t]),D=l.useCallback(async _=>{if(n)try{if(o==="mnemonic"&&N)await de.resetWalletLockByMnemonic(n.id,N,_);else{const A=St(i);await de.updateWalletLock(n.id,A,_)}r("success"),setTimeout(()=>{s()},2e3)}catch{r("verify"),d([]),w(null)}},[n,o,N,i,s]);return n?a==="success"?e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(H,{title:t("changeWalletLock.title")}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx("div",{className:"bg-green-500/10 flex size-16 items-center justify-center rounded-full",children:e.jsx(fe,{className:"text-green-500 size-8"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:t("changeWalletLock.success")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:t("changeWalletLock.returning")})]})]})]}):a==="verify"?e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(H,{title:t("changeWalletLock.title"),onBack:s}),e.jsx("div",{className:"flex-1 p-4",children:o==="pattern"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:t("changeWalletLock.verifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("changeWalletLock.verifyDesc")})]}),e.jsx(Kt,{value:i,onChange:C,onComplete:T,minPoints:4,error:u,disabled:f,"data-testid":"verify-pattern-lock"}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx("button",{type:"button",onClick:()=>c("mnemonic"),className:"text-primary hover:text-primary/80 text-sm underline","data-testid":"switch-to-mnemonic",children:t("changeWalletLock.forgotPattern")})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:t("changeWalletLock.mnemonicVerifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("changeWalletLock.mnemonicVerifyDesc")})]}),e.jsx(im,{wordCount:12,onChange:k}),x&&e.jsx("p",{className:"text-destructive mt-4 text-center text-sm",children:x}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx($,{onClick:I,disabled:!b||f,className:"w-full","data-testid":"verify-mnemonic-button",children:t(f?"changeWalletLock.verifying":"changeWalletLock.verifyMnemonic")}),e.jsx("button",{type:"button",onClick:()=>{c("pattern"),p([]),j(null)},className:"text-muted-foreground hover:text-foreground w-full text-center text-sm","data-testid":"switch-to-pattern",children:t("changeWalletLock.usePattern")})]})]})})]}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(H,{title:t("changeWalletLock.title"),onBack:()=>{r("verify"),d([])}}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(ba,{onComplete:D,minPoints:4})})]}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(H,{title:t("changeWalletLock.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("changeWalletLock.noWallet")})})]})}td.__docgenInfo={description:"",methods:[],displayName:"ChangeWalletLockPage"};const sd=()=>e.jsx(Q,{children:e.jsx(td,{})});sd.__docgenInfo={description:"",methods:[],displayName:"SettingsWalletLockActivity"};function nd({initialChain:t}){const{navigate:s,goBack:n}=Z(),a=ye(),r=hn(),o=Ke(),{t:c}=L(["transaction","common"]),{transactions:i,isLoading:d,isFetching:u,filter:m,setFilter:f,refresh:h}=Sa(a?.id),g=l.useMemo(()=>[{value:"all",label:c("history.filter.allTime")},{value:"7d",label:c("history.filter.days7")},{value:"30d",label:c("history.filter.days30")},{value:"90d",label:c("history.filter.days90")}],[c]),v=l.useMemo(()=>[{value:"all",label:c("history.filter.allChains")},...r.map(x=>({value:x.id,label:x.name}))],[c,r]);l.useEffect(()=>{const x=t??o;x&&m.chain!==x&&f({...m,chain:x})},[]);const p=l.useCallback(x=>{if(!x.id){console.warn("[TransactionHistory] Transaction has no id:",x);return}s({to:`/transaction/${x.id}`})},[s]),b=l.useCallback(x=>{f({...m,chain:x})},[m,f]),y=l.useCallback(x=>{f({...m,period:x})},[m,f]);return a?e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(H,{title:c("transaction:history.title"),onBack:n,rightAction:e.jsx("button",{onClick:h,disabled:u,className:M("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80",u&&"animate-spin"),"aria-label":c("common:a11y.refresh"),children:e.jsx(gs,{className:"size-5"})})}),e.jsxs("div",{className:"bg-card border-b px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(po,{className:"text-muted-foreground size-4"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:c("history.filter.chainLabel")}),e.jsxs(Hs,{value:m.chain||"all",onValueChange:x=>b(x),children:[e.jsx(Us,{size:"sm","aria-label":c("common:a11y.selectChain"),children:e.jsx(Js,{children:v.find(x=>x.value===(m.chain||"all"))?.label})}),e.jsx(Vs,{children:v.map(x=>e.jsx(qt,{value:x.value,children:x.label},x.value))})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:c("history.filter.periodLabel")}),e.jsxs(Hs,{value:m.period||"all",onValueChange:x=>y(x),children:[e.jsx(Us,{size:"sm","aria-label":c("common:a11y.selectPeriod"),children:e.jsx(Js,{children:g.find(x=>x.value===(m.period||"all"))?.label})}),e.jsx(Vs,{children:g.map(x=>e.jsx(qt,{value:x.value,children:x.label},x.value))})]})]})]}),e.jsx("p",{className:"text-muted-foreground mt-2 text-xs",children:c("transaction:history.totalRecords",{count:i.length})})]}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(io,{transactions:i,loading:d,onTransactionClick:p,emptyTitle:c("transaction:history.emptyTitle"),emptyDescription:c("transaction:history.emptyDesc"),showChainIcon:!0})})]}):e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(H,{title:c("transaction:history.title"),onBack:n}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:c("transaction:history.noWallet")})})]})}nd.__docgenInfo={description:"",methods:[],displayName:"TransactionHistoryPage",props:{initialChain:{required:!1,tsType:{name:"union",raw:"ChainType | 'all' | undefined",elements:[{name:"ChainType"},{name:"literal",value:"'all'"},{name:"undefined"}]},description:"'all' "}}};const ad=()=>{const t=Tf();return e.jsx(Q,{children:e.jsx(nd,{initialChain:t.chain})})};ad.__docgenInfo={description:"",methods:[],displayName:"HistoryActivity"};function wv(t){if(!t)return null;const[s,n]=t.split("--");return!s||!n?null:{chainId:s,hash:n}}function Cv(t){if(!t)return!1;if(t.type==="swap")return(t.assets??[]).length<2;if(t.type==="approve"||t.type==="interaction"){const s=t.contract?.method,n=t.contract?.methodId;return!s&&!n}return!1}function rd(){const{t}=L(["transaction","common"]),{goBack:s}=Z(),{txId:n}=ae(),a=ye(),r=At(),{transactions:o,isLoading:c}=Sa(a?.id),i=l.useMemo(()=>o.find(E=>E.id===n),[o,n]),d=l.useMemo(()=>wv(n),[n]),u=ps({queryKey:["transaction-detail",n],queryFn:async()=>Ri.getTransaction({id:n}),enabled:!!a?.id&&!!n&&(!i||Cv(i)),staleTime:3e4}),f=u.data??void 0??i,h=c||u.isLoading,g=l.useMemo(()=>{const E=f?.chain??d?.chainId;return E?tt.getChainById(r,E):null},[r,d?.chainId,f?.chain]),v=l.useMemo(()=>{const E=g?.explorer?.queryTx,B=f?.hash??d?.hash;return!E||!B?null:E.replace(":signature",B)},[g?.explorer?.queryTx,d?.hash,f?.hash]),p=l.useCallback(()=>{v&&window.open(v,"_blank","noopener,noreferrer")},[v]),[b,y]=l.useState(!1),x=l.useCallback(async()=>{v&&(await pa.write({text:v}),y(!0),setTimeout(()=>y(!1),2e3))},[v]),j=l.useCallback(()=>{s()},[s]);if(!a)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(H,{title:t("detail.title"),onBack:j}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("history.noWallet")})})]});if(h)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(H,{title:t("detail.title"),onBack:j}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx(En,{className:"h-48"}),e.jsx(En,{className:"h-64"}),e.jsx(En,{className:"h-32"})]})]});if(u.error instanceof pu){const E=d?.hash;return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(H,{title:t("detail.title"),onBack:j}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx("div",{className:"bg-card flex items-center justify-center rounded-xl p-6 shadow-sm",children:e.jsx("p",{className:"text-muted-foreground",children:t("detail.invalidData")})}),E&&e.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:t("detail.hash")}),e.jsx(dr,{text:E,className:"text-muted-foreground text-xs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:p,disabled:!v,className:M("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:[e.jsx(Yn,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:t("detail.openInExplorer")})]}),e.jsx("button",{onClick:x,disabled:!v,className:M("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:b?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"text-green-500 size-4"}),e.jsx("span",{className:"text-sm",children:t("detail.copied")})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ks,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:t("detail.share")})]})})]})]})]})]})}if(!f)return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(H,{title:t("detail.title"),onBack:j}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx("p",{className:"text-muted-foreground",children:t("detail.notFound")})})]});const N=f.type,w=xu(N),S=w.Icon,C=f.type==="swap"?f.assets?.[0]:void 0,T=f.type==="swap"?f.assets?.[1]:void 0,k=f.contract?.address||f.to,I=f.contract?.method,D=f.contract?.methodId,_=I?t(`method.${I}`,{defaultValue:I}):null,A=C?ce.fromRaw(C.value,C.decimals,C.symbol):null,R=T?ce.fromRaw(T.value,T.decimals,T.symbol):null;return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(H,{title:t("detail.title"),onBack:j}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"bg-card flex flex-col items-center gap-3 rounded-xl p-6 shadow-sm",children:[e.jsx("div",{className:M("flex size-16 items-center justify-center rounded-full",w.bg),children:e.jsx(S,{className:M("size-8",w.color)})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:t(`type.${f.type}`,{defaultValue:f.type})}),f.type==="swap"&&A&&R?e.jsxs("div",{className:M("flex items-center justify-center gap-2",w.color),children:[e.jsx(lt,{value:A.toNumber(),symbol:A.symbol,decimals:A.decimals,sign:"never",color:"default",weight:"normal",size:"lg"}),e.jsx("span",{className:"text-lg",children:""}),e.jsx(lt,{value:R.toNumber(),symbol:R.symbol,decimals:R.decimals,sign:"never",color:"default",weight:"normal",size:"lg"})]}):e.jsx(lt,{value:f.type==="send"?-Math.abs(f.amount.toNumber()):f.amount.toNumber(),symbol:f.symbol,sign:w.amountSign,color:"default",weight:"normal",size:"xl",className:w.color})]}),e.jsx(cm,{status:gu(f.status).badgeStatus,label:t(`transaction:status.${f.status}`)})]}),e.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:t("detail.info")}),f.from&&f.to?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.fromAddress")}),e.jsx(He,{address:f.from,copyable:!0,className:"text-sm"})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.toAddress")}),e.jsx(He,{address:f.to,copyable:!0,className:"text-sm"})]})]}):e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:f.type==="send"?t("detail.toAddress"):t("detail.fromAddress")}),e.jsx(He,{address:f.address,copyable:!0,className:"text-sm"})]}),e.jsx("div",{className:"bg-border h-px"}),f.type==="swap"&&(C||T)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.swapFrom")}),e.jsx("span",{className:"text-sm font-medium",children:C?e.jsx(lt,{value:ce.fromRaw(C.value,C.decimals,C.symbol).toNumber(),symbol:C.symbol,decimals:C.decimals,sign:"never",color:"default",size:"sm"}):"-"})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.swapTo")}),e.jsx("span",{className:"text-sm font-medium",children:T?e.jsx(lt,{value:ce.fromRaw(T.value,T.decimals,T.symbol).toNumber(),symbol:T.symbol,decimals:T.decimals,sign:"never",color:"default",size:"sm"}):"-"})]}),e.jsx("div",{className:"bg-border h-px"})]}),(f.type==="approve"||f.type==="interaction"||f.type==="swap")&&k&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.contractAddress")}),e.jsx(He,{address:k,copyable:!0,className:"text-sm"})]}),(f.type==="approve"||f.type==="interaction")&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.method")}),e.jsx("span",{className:"text-sm font-medium font-mono",children:_||D||t("common:unknown")})]}),f.type==="approve"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.spender")}),e.jsx("span",{className:"text-sm font-medium",children:t("common:unknown")})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.allowance")}),e.jsx("span",{className:"text-sm font-medium",children:t("common:unknown")})]})]})]}),e.jsx("div",{className:"bg-border h-px"})]}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.time")}),e.jsx(om,{value:f.timestamp,format:"datetime",className:"text-sm"})]}),e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.network")}),e.jsx("span",{className:"text-sm font-medium capitalize",children:f.chain})]}),f.fee&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.fee")}),e.jsx(va,{amount:f.fee.toNumber(),symbol:f.feeSymbol||f.symbol,className:"text-sm"})]})]}),f.blockNumber&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.blockHeight")}),e.jsx("span",{className:"text-sm font-medium",children:f.blockNumber.toLocaleString()})]})]}),f.confirmations!==void 0&&f.confirmations>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-border h-px"}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t("detail.confirmations")}),e.jsx("span",{className:"text-sm font-medium",children:f.confirmations})]})]})]}),f.hash&&e.jsxs("div",{className:"bg-card space-y-3 rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-muted-foreground text-sm font-medium",children:t("detail.hash")}),e.jsx(dr,{text:f.hash,className:"text-muted-foreground text-xs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:p,disabled:!v,className:M("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:[e.jsx(Yn,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:t("detail.openInExplorer")})]}),e.jsx("button",{onClick:x,disabled:!v,className:M("flex flex-1 items-center justify-center gap-2 rounded-lg py-2.5","bg-background border transition-colors","hover:bg-muted active:bg-muted/80","disabled:opacity-50 disabled:cursor-not-allowed"),children:b?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"text-green-500 size-4"}),e.jsx("span",{className:"text-sm",children:t("detail.copied")})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ks,{className:"size-4"}),e.jsx("span",{className:"text-sm",children:t("detail.share")})]})})]})]})]})]})}rd.__docgenInfo={description:"",methods:[],displayName:"TransactionDetailPage"};const id=({params:t})=>e.jsx(Q,{children:e.jsx(ee,{params:t,children:e.jsx(rd,{})})});id.__docgenInfo={description:"",methods:[],displayName:"TransactionDetailActivity"};const Sv=150;function od({onScan:t,className:s}){const{t:n}=L("scanner"),{t:a}=L("common"),{navigate:r,goBack:o}=Z(),{push:c}=V(),i=No(),d=l.useRef(null),u=l.useRef(null),m=l.useRef(null),f=l.useRef(null),h=l.useRef(!1),g=l.useRef(null),v=l.useRef(t),[p,b]=l.useState("idle"),[y,x]=l.useState(null),[j,N]=l.useState(!1);l.useEffect(()=>{v.current=t},[t]);const w=l.useCallback(_=>{if(_===g.current)return;g.current=_,b("success"),h.current=!1,"vibrate"in navigator&&navigator.vibrate(100);const A=Ki(_);if(v.current)v.current(_,A);else switch(A.type){case"address":case"payment":r({to:"/send",search:{address:A.address,chain:A.chain,amount:A.type==="payment"?A.amount:void 0}});break;case"deeplink":r({to:A.path,search:A.params});break;case"contact":c("ContactAddConfirmJob",{name:A.name,addresses:JSON.stringify(A.addresses),memo:A.memo,avatar:A.avatar});break;case"unknown":r({to:"/send",search:{address:A.content}});break}},[r,c]),S=l.useCallback(()=>{if(h.current)return;h.current=!0,u.current||(u.current=document.createElement("canvas"));const _=async()=>{if(!(!h.current||!d.current||!f.current)){try{const A=await f.current.scanFromVideo(d.current,u.current??void 0);if(A){w(A.content);return}}catch(A){console.error("[Scanner] Scan error:",A)}h.current&&setTimeout(_,Sv)}};_()},[w]),C=l.useCallback(()=>{h.current=!1,m.current&&(m.current.getTracks().forEach(_=>_.stop()),m.current=null)},[]),T=l.useCallback(async()=>{C(),b("requesting"),g.current=null;try{if(!await i.checkPermission()&&!await i.requestPermission()){b("denied");return}const A=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});m.current=A,d.current&&(d.current.srcObject=A,await d.current.play(),S()),b("scanning")}catch(_){console.error("Camera error:",_),b("error"),x(_ instanceof Error?_.message:"Camera initialization failed")}},[i,S,C]);l.useEffect(()=>(f.current=Gi({useWorker:!0}),T(),()=>{C(),f.current?.destroy(),f.current=null}),[]);const k=l.useCallback(()=>{C(),o()},[C,o]),I=l.useCallback(()=>{const _=document.createElement("input");_.type="file",_.accept="image/*",_.onchange=async A=>{const R=A.target.files?.[0];if(R)try{const E=new Image,B=URL.createObjectURL(R);E.onload=async()=>{URL.revokeObjectURL(B);const P=document.createElement("canvas");P.width=E.width,P.height=E.height;const z=P.getContext("2d");if(!z||!f.current){x(n("noQrFound")),b("error");return}z.drawImage(E,0,0);const q=await f.current.scanFromCanvas(P);q?w(q.content):(x(n("noQrFound")),b("error"))},E.onerror=()=>{URL.revokeObjectURL(B),x(n("noQrFound")),b("error")},E.src=B}catch{x(n("noQrFound")),b("error")}},_.click()},[w,n]),D=l.useCallback(async()=>{if(m.current){const _=m.current.getVideoTracks()[0];if(_)try{await _.applyConstraints({advanced:[{torch:!j}]}),N(!j)}catch{}}},[j]);return e.jsxs("div",{className:M("relative flex h-screen flex-col bg-black",s),children:[e.jsxs("div",{className:"absolute top-0 right-0 left-0 z-10 flex items-center justify-between p-4",children:[e.jsx($,{variant:"ghost",size:"icon","data-testid":"back-button",onClick:k,className:"text-white","aria-label":a("a11y.back"),children:e.jsx(Nn,{className:"size-6"})}),e.jsx("h1",{"data-testid":"page-title",className:"text-lg font-medium text-white",children:n("title")}),e.jsx($,{variant:"ghost",size:"icon",onClick:D,className:M("text-white",j&&"text-yellow-400"),"aria-label":n(j?"flashOff":"flashOn"),children:e.jsx(mo,{className:"size-6"})})]}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("video",{ref:d,className:M("absolute inset-0 size-full object-cover",p!=="scanning"&&p!=="success"&&"invisible"),playsInline:!0,muted:!0}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"relative size-64",children:[e.jsx("div",{className:M("absolute top-0 left-0 size-8 border-t-4 border-l-4",p==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:M("absolute top-0 right-0 size-8 border-t-4 border-r-4",p==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:M("absolute bottom-0 left-0 size-8 border-b-4 border-l-4",p==="success"?"border-green-500":"border-primary")}),e.jsx("div",{className:M("absolute right-0 bottom-0 size-8 border-r-4 border-b-4",p==="success"?"border-green-500":"border-primary")}),p==="scanning"&&e.jsx("div",{className:"animate-scan bg-primary absolute right-2 left-2 h-0.5"})]})}),e.jsxs("div",{className:"absolute inset-x-0 bottom-32 text-center",children:[p==="idle"&&e.jsx("p",{className:"text-white/80",children:n("initializing")}),p==="requesting"&&e.jsx("p",{className:"text-white/80",children:n("requestingPermission")}),p==="scanning"&&e.jsx("p",{className:"text-white/80",children:n("scanPrompt")}),p==="success"&&e.jsx("div",{className:"space-y-2",children:e.jsx("p",{className:"text-green-400",children:n("scanSuccess")})}),p==="denied"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-red-400",children:n("permissionDenied")}),e.jsx($,{variant:"outline","data-testid":"retry-button",onClick:T,children:n("retry")})]}),p==="error"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-red-400",children:y||n("error")}),e.jsx($,{variant:"outline","data-testid":"retry-button",onClick:T,children:n("retry")})]})]})]}),e.jsxs("div",{className:"absolute inset-x-0 bottom-0 flex justify-center gap-8 pb-8",children:[e.jsxs($,{variant:"ghost",size:"lg","data-testid":"gallery-button",onClick:I,className:"flex flex-col items-center text-white",children:[e.jsx(co,{className:"mb-1 size-6"}),e.jsx("span",{className:"text-xs",children:n("gallery")})]}),e.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-white/20",children:e.jsx(_m,{className:"size-8 text-white"})}),e.jsx("div",{className:"w-16"})," "]})]})}od.__docgenInfo={description:"",methods:[],displayName:"ScannerPage",props:{onScan:{required:!1,tsType:{name:"union",raw:"((content: string, parsed: ParsedQRContent) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:"Callback when QR code is scanned"},className:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:"Custom class name"}}};const cd=()=>e.jsx(Q,{children:e.jsx(od,{})});cd.__docgenInfo={description:"",methods:[],displayName:"ScannerActivity"};const kv=300*1e3,Ws={ethereum:"Ethereum",bitcoin:"Bitcoin",tron:"Tron",binance:"BSC",bsc:"BSC",bfmeta:"BFMeta",ccchain:"CCChain",pmchain:"PMChain",bfchainv2:"BFChain V2",btgmeta:"BTGMeta",biwmeta:"BIWMeta",ethmeta:"ETHMeta",malibu:"Malibu",ccc:"CCChain"};function ld(t){if(t)return t}function Av(t){return t.map(s=>({id:s.id,name:s.name,address:s.address,balance:""}))}function Tv(t,s){const n=new Map;for(const a of t)for(const r of a.chainAddresses){const o=ld(r.chain);if(!o)continue;const c=n.get(o)??[];c.push({address:r.address,isDefault:a.id===s}),n.set(o,c)}return Array.from(n.entries()).map(([a,r])=>({chain:a,name:Ws[a]??a,addresses:r.map(o=>({address:o.address,isDefault:o.isDefault}))}))}function gi(t){const s=t?.trim().toLowerCase();return s==="true"||s==="1"}function dd(){const{t}=L("authorize"),{t:s}=L("common"),{navigate:n,goBack:a}=Z(),{push:r}=V(),o=nt(),{id:c,type:i,chainName:d,signMessage:u,getMain:m}=ae(),f=le(me,O=>O.currentWalletId),h=le(me,O=>O.wallets),g=le(me,_e.getCurrentWallet),[v,p]=l.useState(null),[b,y]=l.useState(null),[x,j]=l.useState(!1),N=l.useMemo(()=>Av(h),[h]),w=g?.id??h[0]?.id,[S,C]=l.useState(w),T=l.useMemo(()=>ld(d),[d]),[k,I]=l.useState(T);l.useEffect(()=>I(T),[T]);const[D,_]=l.useState(void 0),[A,R]=l.useState(()=>new Set(h.map(O=>O.id))),[E,B]=l.useState(!1);l.useEffect(()=>{C(w)},[w]),l.useEffect(()=>{R(new Set(h.map(O=>O.id)))},[h]);const P=l.useMemo(()=>{const O=["viewAddress","viewPublicKey"];return u?.trim()&&O.push("signMessage"),gi(m)&&O.push("getMain"),O},[m,u]),z=l.useMemo(()=>new gf(Ht,c),[c]),q=l.useMemo(()=>!!u?.trim(),[u]),K=l.useMemo(()=>gi(m),[m]),oe=q||K;l.useEffect(()=>{let O=!1;async function te(){y(null);try{const X=await Ht.getCallerAppInfo(c);if(O)return;p(X)}catch{if(O)return;y(t("error.authFailed"))}}return te(),()=>{O=!0}},[c,t]),l.useEffect(()=>{const O=window.setTimeout(()=>{(async()=>(await z.reject("timeout"),o.show({message:t("error.timeout"),position:"center"}),n({to:"/"})))()},kv);return()=>{window.clearTimeout(O)}},[z,n,t,o]);const Y=l.useMemo(()=>S?h.find(O=>O.id===S)??null:null,[S,h]),J=l.useMemo(()=>Tv(h,f),[h,f]),G=l.useMemo(()=>g?g.chainAddresses.map(O=>O.chain):[],[g]),re=l.useMemo(()=>{if(!(!g||!k))return g.chainAddresses.find(O=>O.chain===k)?.address},[g,k]);l.useEffect(()=>{i==="network"&&(k||I(J[0]?.chain))},[J,k,i]);const je=l.useMemo(()=>h.length===0?!1:i==="main"?!!Y:i==="network"?k?(J.find(O=>O.chain===k)?.addresses.length??0)>0:!1:A.size>0,[J,k,Y,A.size,i,h.length]),Ge=l.useCallback(()=>{a()},[a]),_t=l.useCallback(async()=>{if(!x){j(!0);try{await z.reject("rejected"),n({to:"/"})}finally{j(!1)}}},[z,x,n]),he=l.useCallback(async()=>{if(!(!je||x)){if(oe){rt(async O=>{j(!0);try{const te=u?.trim()??"";let X=[],ue=[];if(i==="main"){if(!Y)return!1;X=z.handleMainAddresses(Y),ue=[Y]}else if(i==="network"){if(!k)return!1;X=z.handleNetworkAddresses(h,k),ue=h}else{const we=h.filter(xe=>A.has(xe.id));X=z.handleAllAddresses(we),ue=we}return X=await z.applySensitiveOptions(X,ue,{password:O,signMessage:te,getMain:K}),await z.approve(X),n({to:"/"}),!0}catch{return!1}finally{j(!1)}}),r("WalletLockConfirmJob",{title:t("passwordConfirm.title")});return}j(!0);try{let O=[];if(i==="main"){if(!Y)return;O=z.handleMainAddresses(Y)}else if(i==="network"){if(!k)return;O=z.handleNetworkAddresses(h,k)}else{const te=h.filter(X=>A.has(X.id));O=z.handleAllAddresses(te)}await z.approve(O),n({to:"/"})}finally{j(!1)}}},[z,je,x,n,oe,K,r,k,Y,A,u,t,i,h]);return i==="network"&&d&&!T?e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(H,{title:t("title.address"),onBack:Ge}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-destructive",children:t("error.unknownChain")}),e.jsx("div",{className:"mt-4",children:e.jsx($,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]}):b?e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(H,{title:t("title.address"),onBack:Ge}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-destructive",children:b}),e.jsx("div",{className:"mt-4",children:e.jsx($,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]}):e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(H,{title:t("title.address"),onBack:Ge}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[v&&e.jsx(oo,{appInfo:v}),e.jsx("div",{className:"px-1 text-sm text-foreground",children:t("address.shareWith")}),e.jsx(dm,{permissions:P}),e.jsx("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:[i==="main"&&t("address.scope.main"),i==="network"&&t("address.scope.network",{chainName:Ws[k??""]??k??""}),i==="all"&&t("address.scope.all")]})}),e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[i==="main"&&e.jsx(um,{wallets:N,...S?{selectedId:S}:{},onSelect:O=>C(O.id)}),i==="network"&&g&&k&&e.jsx("div",{className:"aspect-[1.6/1] w-full",children:e.jsx(Mi,{wallet:g,chain:k,chainName:Ws[k]??k,address:re,priority:"low",onOpenChainSelector:T?void 0:()=>B(!0)})}),i==="all"&&e.jsxs("div",{className:"space-y-2",children:[h.length===0&&e.jsx("div",{className:"py-6 text-center text-sm text-muted-foreground",children:t("address.noWallets")}),h.map(O=>{const te=A.has(O.id);return e.jsxs("button",{type:"button",onClick:()=>{R(X=>{const ue=new Set(X);return ue.has(O.id)?ue.delete(O.id):ue.add(O.id),ue})},className:M("flex w-full items-center justify-between rounded-lg border px-3 py-2 text-left transition-colors","hover:bg-muted/50",te?"border-primary bg-primary/5":"border-border bg-background"),"aria-pressed":te,children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-medium",children:O.name}),e.jsx("div",{className:"truncate font-mono text-xs text-muted-foreground",children:O.address})]}),e.jsx("div",{className:M("flex size-5 items-center justify-center rounded border",te?"border-primary bg-primary text-primary-foreground":"border-border bg-background"),"aria-hidden":"true",children:te?"":""})]},O.id)})]})]})]}),e.jsx("div",{className:"sticky bottom-0 border-t border-border bg-background p-4 safe-area-inset-bottom",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx($,{type:"button",variant:"outline",className:"flex-1",onClick:_t,disabled:x,children:t("button.reject")}),e.jsx($,{type:"button",className:"flex-1",onClick:he,disabled:!je||x,children:t("button.approve")})]})}),E&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/50",onClick:()=>B(!1),children:e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-background rounded-t-2xl",onClick:O=>O.stopPropagation(),children:[e.jsx("div",{className:"flex justify-center py-3",children:e.jsx("div",{className:"h-1 w-10 rounded-full bg-muted"})}),e.jsx("div",{className:"border-b border-border px-4 pb-4",children:e.jsx("h2",{className:"text-center text-lg font-semibold",children:t("address.selectNetwork")})}),e.jsx("div",{className:"max-h-[60vh] space-y-2 overflow-y-auto p-4",children:G.map(O=>{const te=g?.chainAddresses.find(X=>X.chain===O);return e.jsxs("button",{onClick:()=>{I(O),B(!1)},className:M("flex w-full items-center gap-3 rounded-xl p-4 transition-colors",O===k?"bg-primary/10 ring-1 ring-primary":"bg-muted/50 hover:bg-muted"),children:[e.jsx(Ct,{chain:O,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:Ws[O]??O}),e.jsx("div",{className:"font-mono text-xs text-muted-foreground",children:te?.address?Iv(te.address):"---"})]}),O===k&&e.jsx(fe,{className:"size-5 text-primary"})]},O)})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})]})}function Iv(t,s=10,n=8){return t.length<=s+n+3?t:`${t.slice(0,s)}...${t.slice(-n)}`}dd.__docgenInfo={description:"",methods:[],displayName:"AddressAuthPage"};const ud=({params:t})=>e.jsx(Q,{children:e.jsx(ee,{params:t,children:e.jsx(dd,{})})});ud.__docgenInfo={description:"",methods:[],displayName:"AuthorizeAddressActivity"};const Pv=300*1e3;function vi(t){return typeof t=="object"&&t!==null}function De(t,s){const n=t[s];if(typeof n=="string")return n;if(typeof n=="number"&&Number.isFinite(n))return String(n)}function Ev(t,s,n){const a=De(t,s)?.trim();return a?{ok:!0,value:a}:{ok:!1,error:`signaturedata ${n}`}}function ot(t,s){for(const n of s){const a=De(t,n.key)?.trim();if(a)return{ok:!0,value:a}}return{ok:!1,error:`signaturedata ${s.map(n=>n.label).join(" / ")}`}}function _v(t){if(typeof t=="string"){const s=t.trim().toLowerCase();return s==="message"?{ok:!0,value:"message"}:s==="transfer"?{ok:!0,value:"transfer"}:s==="destroy"||s==="destory"?{ok:!0,value:"destory"}:{ok:!1,error:`${t}`}}return typeof t=="number"&&Number.isInteger(t)?t===0?{ok:!0,value:"message"}:t===1?{ok:!0,value:"transfer"}:t===7?{ok:!0,value:"destory"}:{ok:!1,error:`${t}`}:{ok:!1,error:"signaturedata.type "}}function Mv(t){if(t===void 0||t.trim()==="")return{ok:!1,error:" signaturedata "};let s;try{s=JSON.parse(t)}catch{return{ok:!1,error:"signaturedata  JSON"}}if(!Array.isArray(s))return{ok:!1,error:"signaturedata  JSON "};if(s.length===0)return{ok:!1,error:"signaturedata "};const n=s[0];if(!vi(n))return{ok:!1,error:"signaturedata[0] "};const a=_v(n.type);if(!a.ok)return a;const r=ot(n,[{key:"chainName",label:"chainName"},{key:"chain",label:"chain"}]);if(!r.ok)return r;const o=r.value;if(a.value==="message"){const c=ot(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!c.ok)return c;const i=Ev(n,"message","message");return i.ok?{ok:!0,item:{type:"message",payload:{chainName:o,senderAddress:c.value,message:i.value}}}:i}if(a.value==="transfer"){const c=ot(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!c.ok)return c;const i=ot(n,[{key:"receiveAddress",label:"receiveAddress"},{key:"to",label:"to"}]);if(!i.ok)return i;const d=ot(n,[{key:"balance",label:"balance"},{key:"amount",label:"amount"}]);if(!d.ok)return d;const u=De(n,"fee")?.trim(),m=De(n,"assetType")?.trim();let f;const h=n.contractInfo;if(vi(h)){const g=De(h,"assetType")?.trim(),v=h.decimals,p=De(h,"contractAddress")?.trim(),b=typeof v=="number"&&Number.isFinite(v)?v:typeof v=="string"&&v.trim()!==""?Number(v):void 0;g&&p&&typeof b=="number"&&Number.isFinite(b)&&(f={assetType:g,contractAddress:p,decimals:b})}return{ok:!0,item:{type:"transfer",payload:{chainName:o,senderAddress:c.value,receiveAddress:i.value,balance:d.value,...u?{fee:u}:{},...m?{assetType:m}:{},...f?{contractInfo:f}:{}}}}}{const c=ot(n,[{key:"senderAddress",label:"senderAddress"},{key:"from",label:"from"}]);if(!c.ok)return c;const i=ot(n,[{key:"destoryAmount",label:"destoryAmount"},{key:"amount",label:"amount"}]);if(!i.ok)return i;const d=De(n,"destoryAddress")?.trim()??De(n,"to")?.trim()??c.value,u=De(n,"fee")?.trim(),m=De(n,"assetType")?.trim();return{ok:!0,item:{type:"destory",payload:{chainName:o,senderAddress:c.value,destoryAddress:d,destoryAmount:i.value,...u?{fee:u}:{},...m?{assetType:m}:{}}}}}}function Rv(t){return typeof t=="object"&&t!==null&&"senderAddress"in t&&"receiveAddress"in t&&"balance"in t}function Dv(t){return typeof t=="object"&&t!==null&&"senderAddress"in t&&"message"in t&&!("receiveAddress"in t)}function zv(t){return typeof t=="object"&&t!==null&&"senderAddress"in t&&"destoryAddress"in t&&"destoryAmount"in t}function bi(t){return t.contractInfo?.assetType?t.contractInfo.assetType.toUpperCase():t.assetType?t.assetType.toUpperCase():{ethereum:"ETH",bitcoin:"BTC",tron:"TRX",binance:"BNB",bsc:"BNB"}[t.chainName?.toLowerCase()??""]??"TOKEN"}function Bv(t,s,n){const a=parseFloat(t)||0,r=parseFloat(s)||0,o=parseFloat(n??"0")||0,c=r+o;return{sufficient:a>=c,required:c.toString()}}function md(){const{t}=L("authorize"),{t:s}=L("common"),{navigate:n,goBack:a}=Z(),{push:r}=V(),o=nt(),{id:c,signaturedata:i}=ae(),d=le(me,_e.getCurrentWallet),[u,m]=l.useState(null),[f,h]=l.useState(null),[g,v]=l.useState(null),[p,b]=l.useState(!1),y=l.useMemo(()=>new Aa(Ht,c),[c]);l.useEffect(()=>{let D=!1;async function _(){v(null);try{const A=Mv(i);if(!A.ok){v(A.error);return}const R=await Ht.getCallerAppInfo(c);if(D)return;m(R);const E={eventId:c,type:A.item.type,payload:A.item.payload,appName:R.appName,appHome:R.origin,appLogo:R.appIcon};h(E)}catch{if(D)return;v(t("error.authFailed"))}}return _(),()=>{D=!0}},[c,i,t]),l.useEffect(()=>{const D=window.setTimeout(()=>{(async()=>(await y.reject("timeout"),o.show({message:t("error.timeout"),position:"center"}),n({to:"/"})))()},Pv);return()=>{window.clearTimeout(D)}},[y,n,t,o]);const x=l.useMemo(()=>!f||!Rv(f.payload)?null:f.payload,[f]),j=l.useMemo(()=>!f||!Dv(f.payload)?null:f.payload,[f]),N=l.useMemo(()=>!f||!zv(f.payload)?null:f.payload,[f]),w=l.useMemo(()=>{if(!d)return{sufficient:!0,required:"0",walletBalance:"0"};const D=x?{chainName:x.chainName,amount:x.balance,fee:x.fee}:N?{chainName:N.chainName,amount:N.destoryAmount,fee:N.fee}:null;if(!D)return{sufficient:!0,required:"0",walletBalance:"0"};const A=d.chainAddresses.find(E=>E.chain.toLowerCase()===D.chainName?.toLowerCase())?"1.0":"0";return{...Bv(A,D.amount,D.fee),walletBalance:A}},[d,N,x]),S=l.useMemo(()=>x?bi(x):N?bi(N):"TOKEN",[N,x]),C=l.useCallback(()=>{a()},[a]),T=l.useCallback(async()=>{if(!p){b(!0);try{await y.reject(w.sufficient?"rejected":"insufficient_balance"),n({to:"/"})}finally{b(!1)}}},[y,w.sufficient,p,n]),k=l.useCallback(()=>{w.sufficient&&(p||(rt(async D=>{b(!0);try{const _=d?.encryptedMnemonic;if(!_||!f)return!1;let A;if(f.type==="message"){if(!j)return!1;A=await y.handleMessageSign(j,_,D)}else if(f.type==="transfer"){if(!x)return!1;A=await y.handleTransferSign(x,_,D)}else if(f.type==="destory"){if(!N)return!1;A=await y.handleDestroySign(N,_,D)}else return!1;return await y.approve(A),n({to:"/"}),!0}catch{return!1}finally{b(!1)}}),r("WalletLockConfirmJob",{title:t("button.confirm")})))},[y,w.sufficient,d?.encryptedMnemonic,N,p,j,n,r,f,t,x]);if(g)return e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(H,{title:t("title.signature"),onBack:C}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[e.jsx("p",{className:"text-sm text-destructive",children:g}),e.jsx("div",{className:"mt-4",children:e.jsx($,{onClick:()=>n({to:"/"}),className:"w-full",children:s("back")})})]})})]});const I=f?.type==="message"?t("signature.type.message"):f?.type==="destory"?t("signature.type.destroy"):t("title.signature");return e.jsxs("div",{className:"flex min-h-screen flex-col bg-muted/30",children:[e.jsx(H,{title:I,onBack:C}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[u&&e.jsx(oo,{appInfo:u}),e.jsx("div",{className:"px-1 text-sm text-foreground",children:t("signature.reviewTransaction")}),x&&e.jsxs(e.Fragment,{children:[e.jsx(ur,{from:x.senderAddress,to:x.receiveAddress,amount:`${x.balance} ${S}`,...x.fee?{fee:`${x.fee} ${S}`}:{},chainId:x.chainName}),!w.sufficient&&e.jsx(mr,{balance:w.walletBalance,required:w.required,symbol:S})]}),j&&e.jsxs("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:t("signature.messageToSign")}),e.jsx("div",{className:M("rounded-lg bg-muted/50 p-3","font-mono text-sm whitespace-pre-wrap break-all","max-h-48 overflow-y-auto"),children:j.message})]}),N&&e.jsxs(e.Fragment,{children:[e.jsx(ur,{from:N.senderAddress,to:N.destoryAddress,amount:`${N.destoryAmount} ${S}`,...N.fee?{fee:`${N.fee} ${S}`}:{},chainId:N.chainName}),!w.sufficient&&e.jsx(mr,{balance:w.walletBalance,required:w.required,symbol:S})]}),f&&e.jsx("div",{className:"rounded-xl bg-card p-4 shadow-sm",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:[f.type==="transfer"&&t("signature.type.transfer"),f.type==="message"&&t("signature.type.message"),f.type==="destory"&&t("signature.type.destroy")]})})]}),e.jsx("div",{className:"sticky bottom-0 border-t border-border bg-background p-4 safe-area-inset-bottom",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx($,{type:"button",variant:"outline",className:"flex-1",onClick:T,disabled:p,children:t("button.reject")}),e.jsx($,{type:"button",className:"flex-1",onClick:k,disabled:p||!w.sufficient,children:t("button.confirm")})]})})]})}md.__docgenInfo={description:"",methods:[],displayName:"SignatureAuthPage"};const fd=({params:t})=>e.jsx(Q,{children:e.jsx(ee,{params:t,children:e.jsx(md,{})})});fd.__docgenInfo={description:"",methods:[],displayName:"AuthorizeSignatureActivity"};function pd({walletName:t,onEnterWallet:s,className:n}){const{t:a}=L("onboarding");return e.jsxs("div",{"data-testid":"import-success-step",className:M("flex min-h-screen flex-col items-center justify-center px-6 py-8",n),children:[e.jsx("div",{className:"mb-6 flex size-20 items-center justify-center rounded-full bg-green-100 dark:bg-green-900/30",children:e.jsx(Gt,{className:"size-10 text-green-600 dark:text-green-400"})}),e.jsx("h1",{"data-testid":"success-message",className:"mb-2 text-2xl font-bold",children:a("import.success.title")}),e.jsx("p",{className:"text-muted-foreground mb-8 text-center",children:e.jsx(ro,{i18nKey:"import.success.description",ns:"onboarding",values:{name:t},components:{bold:e.jsx("span",{className:"text-foreground font-medium"})}})}),e.jsx("div",{className:"w-full max-w-xs",children:e.jsxs("button",{type:"button","data-testid":"enter-wallet-button",onClick:s,className:M("flex w-full items-center justify-center gap-2 rounded-full py-3 font-medium transition-colors","bg-primary hover:bg-primary/90 text-primary-foreground"),children:[e.jsx("span",{children:a("import.success.enterWallet")}),e.jsx(Ce,{className:"size-5"})]})})]})}pd.__docgenInfo={description:"Success screen shown after wallet import",methods:[],displayName:"ImportWalletSuccess",props:{walletName:{required:!0,tsType:{name:"string"},description:"Wallet name"},onEnterWallet:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback when user chooses to enter wallet"},className:{required:!1,tsType:{name:"string"},description:"Additional class name"}}};function Lv(t){if(!eo(t))throw new Error("Invalid mnemonic");return Kd(t.join(" "))}function Ov(t){return new Set(t.map(s=>s.address.toLowerCase()))}const Un={isDuplicate:!1,type:"none"};function Fv(t){const[s,n]=l.useState(Un),[a,r]=l.useState(!1),[o,c]=l.useState(null),i=l.useCallback(async u=>{r(!0),c(null);try{const m=Lv(u),f=Ov(m),h=await t.getAllAddresses();for(const b of h)if(f.has(b.address.toLowerCase())){const y={isDuplicate:!0,type:"address",matchedWallet:{id:b.walletId,name:b.walletName,importType:"mnemonic",matchedAddress:b.address}};return n(y),y}const v=(await t.getAllMainWallets()).filter(b=>b.importType==="privateKey");for(const b of v)for(const y of b.addresses)if(f.has(y.address.toLowerCase())){const x={isDuplicate:!0,type:"privateKey",matchedWallet:{id:b.id,name:b.name,importType:"privateKey",matchedAddress:y.address}};return n(x),x}const p={isDuplicate:!1,type:"none"};return n(p),p}catch(m){const f=m instanceof Error?m.message:"";return c(f),Un}finally{r(!1)}},[t]),d=l.useCallback(()=>{n(Un),c(null)},[]);return{result:s,isChecking:a,error:o,check:i,reset:d}}const Wv={getAllAddresses:async()=>[],getAllMainWallets:async()=>[],findWalletByAddress:async()=>null};function hd(){const{navigate:t,goBack:s}=Z(),{push:n}=V(),{t:a}=L(["onboarding","common","wallet"]),r=us(),o=At().snapshot,c=Ii(),[i,d]=l.useState("keyType"),[u,m]=l.useState("mnemonic"),[f,h]=l.useState(!1),[g,v]=l.useState([]),[p,b]=l.useState(""),[y,x]=l.useState(null),[j,N]=l.useState([]),[w,S]=l.useState(!1),[C,T]=l.useState(""),[k,I]=l.useState(null),[D,_]=l.useState([]),[A,R]=l.useState(!1);l.useEffect(()=>{!A&&r.length>0&&(_(Zi(r)),R(!0))},[r,A]);const E=Fv(Wv),B=(()=>{switch(i){case"keyType":return 1;case"mnemonic":case"arbitrary":return 2;case"collision":return 2;case"pattern":return 3;case"chains":return 4;case"theme":return 5;case"success":return 5;default:return 1}})(),P=l.useCallback(()=>{switch(i){case"keyType":s();break;case"mnemonic":case"arbitrary":d("keyType"),E.reset();break;case"collision":d("mnemonic"),E.reset();break;case"pattern":d(u==="arbitrary"?"arbitrary":"mnemonic");break;case"chains":d("pattern");break;case"theme":d("chains");break}},[i,s,E,u]),z=l.useCallback(()=>{d("pattern")},[]),q=l.useCallback(he=>{T(he),d("chains")},[]),K=l.useCallback(()=>{if(u==="mnemonic"){d("mnemonic");return}if(f){d("arbitrary");return}Cg(()=>{h(!0),d("arbitrary")}),n("SecurityWarningJob",{})},[u,f,n]),oe=l.useCallback(async he=>{v(he.mnemonic);const O=await E.check(he.mnemonic);if(O.isDuplicate){if(O.type==="address"){console.log("Duplicate detected:",O.matchedWallet?.name);return}else if(O.type==="privateKey"){d("collision");return}}z()},[E,z]),Y=l.useCallback(async()=>{z()},[z]),J=l.useCallback(()=>{d("mnemonic"),E.reset()},[E]),G=l.useCallback(async(he,O)=>{S(!0);try{const te=he.join(" "),ue=(await qi({mnemonic:te,selectedChainIds:D,chainConfigs:r})).map(({chainId:Hd,address:Ud,publicKey:Jd})=>({chain:Hd,address:Ud,publicKey:Jd??"",tokens:[]})),we=ue[0];if(!we)throw new Error("No chain addresses derived");const xe=Gn(we.address),qd=await de.createWallet({name:a("wallet:defaultName"),keyType:"mnemonic",address:we.address,chain:we.chain,chainAddresses:ue,themeHue:xe},te,O,xe);I(qd.id),d("theme")}catch(te){console.error(":",te)}finally{S(!1)}},[r,D,a]),re=l.useCallback(async he=>{const O=p.trim();if(O&&j.length!==0){S(!0);try{const te=j[0];if(!te)throw new Error("No enabled bioforest chains");const X=Gn(te.address),ue=j.map(xe=>({chain:xe.chainId,address:xe.address,publicKey:"",tokens:[]})),we=await de.createWallet({name:a("wallet:defaultName"),keyType:"arbitrary",address:te.address,chain:te.chainId,chainAddresses:ue,themeHue:X},O,he,X);I(we.id),d("theme")}catch(te){console.error(":",te)}finally{S(!1)}}},[j,p,a]),je=l.useCallback(()=>{t({to:"/",replace:!0})},[t]),Ge=l.useCallback(async()=>{if(!w){if(u==="arbitrary"){await re(C);return}g.length!==0&&await G(g,C)}},[re,G,w,u,g,C]),_t=l.useCallback(()=>{t({to:"/"})},[t]);return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[i==="keyType"&&e.jsxs(e.Fragment,{children:[e.jsx(H,{title:a("onboarding:keyType.title"),onBack:P}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(Ze,{total:5,current:B})}),e.jsxs("div",{"data-testid":"key-type-step",className:"flex-1 space-y-6 p-4",children:[e.jsx(mm,{value:u,onChange:he=>{m(he),he==="mnemonic"&&(b(""),N([]))}}),e.jsx($,{type:"button","data-testid":"continue-button",onClick:K,className:"w-full",children:a("common:continue")})]})]}),i==="mnemonic"&&e.jsxs(e.Fragment,{children:[e.jsx(H,{title:a("onboarding:recover.title"),onBack:P}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(Ze,{total:5,current:B})}),e.jsx("div",{"data-testid":"mnemonic-step",className:"flex-1 p-4",children:e.jsx(nm,{onSubmit:oe,isSubmitting:E.isChecking})})]}),i==="arbitrary"&&e.jsxs(e.Fragment,{children:[e.jsx(H,{title:a("onboarding:keyType.arbitrary"),onBack:P}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(Ze,{total:5,current:B})}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsx(fm,{value:p,onChange:he=>{x(null),b(he)},disabled:w}),y&&e.jsxs("div",{className:"bg-destructive/10 text-destructive flex items-start gap-2 rounded-lg px-3 py-2 text-sm",children:[e.jsx(It,{className:"mt-0.5 size-4 shrink-0"}),e.jsx("span",{children:y})]}),e.jsx(pm,{secret:p,enabledBioforestChainConfigs:o?c:void 0,onDerived:N}),e.jsxs($,{type:"button",className:"w-full",disabled:w||p.trim()!==""&&j.length===0,onClick:()=>{if(!p.trim()){x(a("onboarding:arbitraryKey.required"));return}z()},children:[w&&e.jsx(ke,{className:"size-4 animate-spin"}),a("common:continue")]})]})]}),i==="collision"&&e.jsxs(e.Fragment,{children:[e.jsx(H,{title:a("onboarding:recover.addressConflict"),onBack:P}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(Ze,{total:5,current:B})}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(hm,{result:E.result,onConfirm:Y,onCancel:J,isLoading:w})})]}),i==="pattern"&&e.jsxs(e.Fragment,{children:[e.jsx(H,{title:a("onboarding:recover.setWalletLock"),onBack:P}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(Ze,{total:5,current:B})}),e.jsx("div",{"data-testid":"pattern-step",className:"flex-1 p-4",children:e.jsx(ba,{onComplete:q,minPoints:4})})]}),i==="chains"&&e.jsxs(e.Fragment,{children:[e.jsx(H,{title:a("onboarding:chainSelector.title"),onBack:P}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(Ze,{total:5,current:B})}),e.jsx("div",{"data-testid":"chains-step",className:"flex-1 p-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(bs,{icon:Gt,variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:a("onboarding:chainSelector.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:a("onboarding:chainSelector.subtitle")})]}),r.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(be,{})}):e.jsx(wa,{"data-testid":"chain-selector",chains:r,selectedChains:D,onSelectionChange:_}),e.jsx(Ee,{variant:"mint",className:"w-full","data-testid":"chains-continue-button",disabled:D.length===0,onClick:Ge,children:a("common:next")})]})})]}),i==="theme"&&k&&e.jsxs(e.Fragment,{children:[e.jsx(H,{title:a("onboarding:create.themeTitle")}),e.jsx("div",{className:"px-4 pt-4",children:e.jsx(Ze,{total:5,current:B})}),e.jsx("div",{"data-testid":"theme-step",className:"flex-1 p-4",children:e.jsx(In,{mode:"edit-only",walletId:k,onEditOnlyComplete:je})})]}),i==="success"&&e.jsx(pd,{walletName:a("wallet:defaultName"),onEnterWallet:_t})]})}hd.__docgenInfo={description:`Onboarding recover wallet page
Implements wallet recovery with duplicate detection per openspec/changes/add-wallet-recover-duplicate-guards`,methods:[],displayName:"OnboardingRecoverPage"};const xd=()=>e.jsx(Q,{children:e.jsx(hd,{})});xd.__docgenInfo={description:"",methods:[],displayName:"OnboardingRecoverActivity"};const Is={symbol:"USDT",balance:1234.56,fiatValue:"1234.56"},$v=[{id:"1",type:"send",status:"confirmed",amount:ce.fromFormatted("100",6,"USDT"),symbol:"USDT",address:"0xabcd...1234",timestamp:new Date(Date.now()-36e5)},{id:"2",type:"receive",status:"confirmed",amount:ce.fromFormatted("500",6,"USDT"),symbol:"USDT",address:"0x1234...abcd",timestamp:new Date(Date.now()-864e5)}];function gd(){const{t}=L("token"),{navigate:s,goBack:n}=Z();return e.jsxs("div",{className:"flex min-h-screen flex-col",children:[e.jsx(H,{title:Is.symbol,onBack:n}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsx("div",{className:"text-center",children:e.jsx(xm,{value:Is.balance,symbol:Is.symbol,fiatValue:Is.fiatValue,size:"lg"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(Ee,{variant:"mint",className:"flex-1",onClick:()=>s({to:"/send",search:{address:void 0,chain:void 0,amount:void 0}}),children:[e.jsx(vu,{className:"mr-2 size-4"}),t("detail.send")]}),e.jsxs(Ee,{variant:"blue",className:"flex-1",onClick:()=>s({to:"/receive"}),children:[e.jsx(bn,{className:"mr-2 size-4"}),t("detail.receive")]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold",children:t("detail.transactionHistory")}),e.jsx(io,{transactions:$v,emptyTitle:t("detail.noTransactions"),emptyDescription:t("detail.noTransactionsDesc")})]})]})]})}gd.__docgenInfo={description:"",methods:[],displayName:"TokenDetailPage"};const vd=({params:t})=>e.jsx(Q,{children:e.jsx(ee,{params:t,children:e.jsx(gd,{})})});vd.__docgenInfo={description:"",methods:[],displayName:"TokenDetailActivity"};function bd(){const{t}=L("common"),{goBack:s}=Z(),{push:n}=V(),r=le(Ft).contacts,o=le(me,_e.getCurrentWallet),[c,i]=l.useState(""),d=l.useRef(null),u=l.useMemo(()=>c.trim()?pn.searchContacts(Ft.state,c.trim()):r,[r,c]),m=l.useCallback(()=>{s()},[s]),f=l.useCallback(()=>{n("ContactEditJob",{})},[n]),h=l.useCallback(p=>{n("ContactEditJob",{contactId:p.id})},[n]),g=l.useCallback(p=>{n("ContactShareJob",{name:p.name,addresses:JSON.stringify(p.addresses.map(b=>({address:b.address,label:b.label}))),memo:p.memo,avatar:p.avatar})},[n]),v=l.useCallback(p=>{d.current=p,o?.encryptedMnemonic?(rt(async b=>{try{return await pt(o.encryptedMnemonic,b)?(Wt.deleteContact(p.id),d.current=null,!0):!1}catch{return!1}}),n("WalletLockConfirmJob",{title:t("addressBook.deleteTitle"),description:t("addressBook.deleteConfirm",{name:p.name})})):(Wt.deleteContact(p.id),d.current=null)},[o?.encryptedMnemonic,n,t]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(H,{title:t("addressBook.title"),onBack:m,rightAction:e.jsx("button",{onClick:f,className:M("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":t("a11y.addContact"),"data-testid":"address-book-add-button",children:e.jsx(st,{className:"size-5"})})}),e.jsx("div",{className:"px-4 py-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(vs,{className:"text-muted-foreground absolute top-1/2 left-3 size-4 -translate-y-1/2"}),e.jsx("input",{type:"text",value:c,onChange:p=>i(p.target.value),placeholder:t("addressBook.searchPlaceholder"),className:M("border-border bg-background w-full rounded-xl border py-2.5 pr-4 pl-10","focus:ring-primary focus:ring-2 focus:outline-none")})]})}),e.jsx("div",{className:"flex-1 p-4",children:u.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[e.jsx($u,{className:"text-muted-foreground/50 size-12"}),e.jsx("p",{className:"text-muted-foreground",children:t(c?"addressBook.noResults":"addressBook.noContacts")}),!c&&e.jsx("button",{onClick:f,className:M("bg-primary rounded-full px-6 py-2.5 text-sm font-medium text-primary-foreground","hover:bg-primary/90 active:bg-primary/80"),children:t("contact.addTitle")})]}):e.jsx("div",{className:"space-y-2",children:u.map(p=>e.jsx(qv,{contact:p,onShare:()=>g(p),onEdit:()=>h(p),onDelete:()=>v(p)},p.id))})})]})}function qv({contact:t,onEdit:s,onDelete:n,onShare:a}){const{t:r}=L("common"),[o,c]=l.useState(!1);return e.jsx("div",{className:M("bg-card rounded-xl p-4 shadow-sm","transition-colors"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(jn,{src:t.avatar||(t.addresses[0]?.address?bt(t.addresses[0].address):void 0),size:40}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"truncate font-medium",children:t.name}),t.addresses.length>0&&e.jsxs("p",{className:"text-muted-foreground truncate font-mono text-xs",children:[t.addresses[0]?.address,t.addresses.length>1&&` (+${t.addresses.length-1})`]}),t.memo&&e.jsx("p",{className:"text-muted-foreground mt-1 truncate text-xs",children:t.memo})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>c(!o),className:M("rounded-full p-2 transition-colors","hover:bg-muted active:bg-muted/80"),"aria-label":r("a11y.moreActions"),children:e.jsx(gm,{className:"text-muted-foreground size-4"})}),o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>c(!1)}),e.jsxs("div",{className:"bg-popover border-border absolute top-full right-0 z-20 mt-1 w-32 rounded-lg border py-1 shadow-lg",children:[e.jsx("button",{onClick:()=>{c(!1),a()},className:"hover:bg-muted w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.shareContact")}),e.jsx("button",{onClick:()=>{c(!1),s()},className:"hover:bg-muted w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.edit")}),e.jsx("button",{onClick:()=>{c(!1),n()},className:"text-destructive hover:bg-destructive/10 w-full px-4 py-2 text-left text-sm transition-colors",children:r("addressBook.delete")})]})]})]})]})})}bd.__docgenInfo={description:"",methods:[],displayName:"AddressBookPage"};const yd=()=>e.jsx(Q,{children:e.jsx(bd,{})});yd.__docgenInfo={description:"",methods:[],displayName:"AddressBookActivity"};const jd={notifications:[],unreadCount:0,isInitialized:!1},Oe=new Yd(jd),da="bfm_notifications";function Ps(t){try{localStorage.setItem(da,JSON.stringify(t))}catch(s){console.error("Failed to persist notifications:",s)}}function Es(t){return t.filter(s=>!s.read).length}const es={initialize:()=>{try{const t=localStorage.getItem(da);if(t){const s=JSON.parse(t);Oe.setState(()=>({notifications:s,unreadCount:Es(s),isInitialized:!0}))}else Oe.setState(s=>({...s,isInitialized:!0}))}catch(t){console.error("Failed to initialize notifications:",t),Oe.setState(s=>({...s,isInitialized:!0}))}},add:t=>{const s={...t,id:crypto.randomUUID(),timestamp:Date.now(),read:!1};return Oe.setState(n=>{const a=[s,...n.notifications];return Ps(a),{...n,notifications:a,unreadCount:Es(a)}}),s},markRead:t=>{Oe.setState(s=>{const n=s.notifications.map(a=>a.id===t?{...a,read:!0}:a);return Ps(n),{...s,notifications:n,unreadCount:Es(n)}})},markAllRead:()=>{Oe.setState(t=>{const s=t.notifications.map(n=>({...n,read:!0}));return Ps(s),{...t,notifications:s,unreadCount:0}})},remove:t=>{Oe.setState(s=>{const n=s.notifications.filter(a=>a.id!==t);return Ps(n),{...s,notifications:n,unreadCount:Es(n)}})},clearAll:()=>{localStorage.removeItem(da),Oe.setState(()=>jd)}},Hv={transaction:{icon:"",bg:"bg-blue-100 dark:bg-blue-900/30"},security:{icon:"",bg:"bg-red-100 dark:bg-red-900/30"},system:{icon:"",bg:"bg-gray-100 dark:bg-gray-800/30"}};function Uv(){const{t}=L("notification"),s=fs();return l.useCallback(n=>{const r=Date.now()-n,o=Math.floor(r/6e4),c=Math.floor(r/36e5),i=Math.floor(r/864e5);return o<1?t("time.justNow"):o<60?t("time.minutesAgo",{count:o}):c<24?t("time.hoursAgo",{count:c}):i<7?t("time.daysAgo",{count:i}):new Date(n).toLocaleDateString(s)},[t,s])}function Jv({notification:t,onRead:s,onRemove:n,formatRelativeTime:a,t:r}){const o=Hv[t.type],c=l.useCallback(()=>{t.read||s(t.id)},[t.id,t.read,s]);return e.jsxs("div",{onClick:c,className:M("flex cursor-pointer items-start gap-3 rounded-xl p-4 transition-colors",t.read?"bg-muted/30":"bg-card shadow-sm"),children:[e.jsx("div",{className:M("flex size-10 shrink-0 items-center justify-center rounded-full",o.bg),children:e.jsx("span",{className:"text-lg",children:o.icon})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h4",{className:M("font-medium",t.read&&"text-muted-foreground"),children:t.title}),e.jsx("span",{className:"text-muted-foreground shrink-0 text-xs",children:a(t.timestamp)})]}),e.jsx("p",{className:M("mt-1 text-sm",t.read?"text-muted-foreground":"text-foreground/80"),children:t.message}),!t.read&&e.jsx("div",{className:"bg-primary mt-2 flex size-2 rounded-full","aria-label":r("unread")})]}),e.jsx("button",{onClick:i=>{i.stopPropagation(),n(t.id)},className:"text-muted-foreground hover:text-destructive shrink-0 p-1","aria-label":r("delete"),children:e.jsx(Tt,{className:"size-4"})})]})}function Vv({notifications:t,onRead:s,onRemove:n,formatRelativeTime:a,t:r,language:o}){const c=l.useMemo(()=>{const i=new Map,d=new Date().toLocaleDateString(o),u=new Date(Date.now()-864e5).toLocaleDateString(o);for(const m of t){const f=new Date(m.timestamp).toLocaleDateString(o);let h=f;f===d?h=r("time.today"):f===u&&(h=r("time.yesterday"));const g=i.get(h)||[];i.set(h,[...g,m])}return i},[t,o,r]);return t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx("div",{className:"bg-muted mb-4 flex size-16 items-center justify-center rounded-full",children:e.jsx(vm,{className:"text-muted-foreground size-8"})}),e.jsx("h3",{className:"text-lg font-medium",children:r("empty.title")}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm",children:r("empty.desc")})]}):e.jsx("div",{className:"space-y-6",children:Array.from(c.entries()).map(([i,d])=>e.jsxs("div",{children:[e.jsx("h3",{className:"text-muted-foreground mb-2 text-sm font-medium",children:i}),e.jsx("div",{className:"space-y-2",children:d.map(u=>e.jsx(Jv,{notification:u,onRead:s,onRemove:n,formatRelativeTime:a,t:r},u.id))})]},i))})}function Nd(){const{t}=L("notification"),s=fs(),n=Uv(),{goBack:a}=Z(),r=le(Oe);l.useEffect(()=>{r.isInitialized||es.initialize()},[r.isInitialized]);const o=l.useCallback(u=>{es.markRead(u)},[]),c=l.useCallback(u=>{es.remove(u)},[]),i=l.useCallback(()=>{es.markAllRead()},[]),d=l.useCallback(()=>{es.clearAll()},[]);return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(H,{title:t("title"),onBack:a,rightAction:r.unreadCount>0?e.jsxs("button",{onClick:i,className:"text-primary hover:bg-primary/10 flex items-center gap-1 rounded-full px-3 py-1.5 text-sm","aria-label":t("markAllRead"),children:[e.jsx(fe,{className:"size-4"}),t("markAllRead")]}):void 0}),e.jsx("div",{className:"bg-card border-b px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:r.unreadCount>0?t("unreadCount",{count:r.unreadCount}):t("noUnread")}),r.notifications.length>0&&e.jsxs($,{variant:"ghost",size:"sm",onClick:d,className:"text-destructive",children:[e.jsx(Tt,{className:"mr-1 size-4"}),t("clear")]})]})}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(Vv,{notifications:r.notifications,onRead:o,onRemove:c,formatRelativeTime:n,t,language:s})})]})}Nd.__docgenInfo={description:"",methods:[],displayName:"NotificationCenterPage"};const wd=()=>e.jsx(Q,{children:e.jsx(Nd,{})});wd.__docgenInfo={description:"",methods:[],displayName:"NotificationsActivity"};function Kv(t){const s=t.toNumber();return s>=1e9?`${(s/1e9).toFixed(2)}B`:s>=1e6?`${(s/1e6).toFixed(2)}M`:s>=1e3?`${(s/1e3).toFixed(2)}K`:s.toFixed(Math.min(5,8))}function Cd({item:t,onMint:s,className:n}){const{t:a}=L("staking"),r=[{label:a("totalMinted",{asset:t.assetType}),value:t.totalMinted},{label:a("totalCirculation",{asset:t.assetType}),value:t.totalCirculation},{label:a("totalBurned",{asset:t.assetType}),value:t.totalBurned},{label:a("totalStaked",{asset:t.externalAssetType}),value:t.totalStaked}];return e.jsxs("div",{className:M("overflow-hidden rounded-xl shadow-md","bg-gradient-to-b from-primary/90 to-primary",n),children:[e.jsxs("div",{className:"relative grid grid-cols-2 gap-3 p-4",children:[r.map((o,c)=>e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("span",{className:"text-lg font-semibold text-amber-300",children:Kv(o.value)}),e.jsx("span",{className:"text-xs text-primary-foreground/70",children:o.label})]},c)),e.jsx("div",{className:"pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 opacity-20",children:e.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-white/20 text-2xl font-bold text-white",children:t.chain.charAt(0)})})]}),e.jsxs("div",{className:"flex items-center justify-between bg-card px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Je,{symbol:t.externalAssetType,size:"sm"}),e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"font-medium text-foreground",children:t.externalAssetType}),e.jsx("div",{className:"text-muted-foreground",children:t.externalChain})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Je,{symbol:t.assetType,size:"sm"}),e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"font-medium text-foreground",children:t.assetType}),e.jsx("div",{className:"text-muted-foreground",children:t.chain})]})]}),e.jsx($,{size:"sm",variant:"default",className:"rounded-full px-4",onClick:()=>s?.(t),children:a("mint")})]})]})]})}Cd.__docgenInfo={description:"Staking pool card component",methods:[],displayName:"StakingPoolCard",props:{item:{required:!0,tsType:{name:"StakingOverviewItem"},description:""},onMint:{required:!1,tsType:{name:"union",raw:"((item: StakingOverviewItem) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Gv=[{value:"all",label:"allNetworks"},{value:"ETH",label:"Ethereum"},{value:"BSC",label:"BNB Chain"},{value:"TRON",label:"Tron"},{value:"BFMeta",label:"BFMeta"},{value:"BFChain",label:"BFChain"}];function Sd({onMint:t,className:s}){const{t:n}=L("staking"),[a,r]=l.useState(""),[o,c]=l.useState("all"),[i,d]=l.useState(!1),[u,m]=l.useState([]),[f,h]=l.useState(!0);l.useEffect(()=>{let p=!0;return h(!0),jt.getOverview().then(b=>{p&&(m(b),h(!1))}),()=>{p=!1}},[]);const g=l.useMemo(()=>{let p=u;if(a.trim()){const b=a.toLowerCase();p=p.filter(y=>y.assetType.toLowerCase().includes(b)||y.externalAssetType.toLowerCase().includes(b)||y.chain.toLowerCase().includes(b)||y.externalChain.toLowerCase().includes(b))}return o!=="all"&&(p=p.filter(b=>b.chain===o||b.externalChain===o)),p},[u,a,o]),v=p=>{c(p),d(!1)};return f?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[e.jsx(be,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):e.jsxs("div",{className:M("space-y-4",s),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(vs,{className:"text-muted-foreground absolute top-1/2 left-3 size-4 -translate-y-1/2"}),e.jsx(Pe,{type:"text",placeholder:n("searchPlaceholder"),value:a,onChange:p=>r(p.target.value),className:"pl-9"})]}),e.jsxs(ht,{open:i,onOpenChange:d,children:[e.jsx(Wu,{render:e.jsxs($,{variant:"outline",size:"icon",className:"relative",children:[e.jsx(po,{className:"size-4"}),o!=="all"&&e.jsx("span",{className:"bg-primary absolute -top-1 -right-1 size-2 rounded-full"})]})}),e.jsxs(xt,{side:"bottom",className:"h-[60vh]",children:[e.jsx(gt,{children:e.jsx(vt,{children:n("selectNetwork")})}),e.jsx("div",{className:"mt-4 space-y-2",children:Gv.map(p=>e.jsxs("button",{onClick:()=>v(p.value),className:M("flex w-full items-center justify-between rounded-lg px-4 py-3 text-left transition-colors",o===p.value?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("span",{children:p.value==="all"?n("allNetworks"):p.label}),o===p.value&&e.jsx("span",{className:"text-primary",children:""})]},p.value))})]})]})]}),g.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-20",children:e.jsx("p",{className:"text-muted-foreground",children:n("noResults")})}):e.jsx("div",{className:"space-y-4",children:g.map((p,b)=>e.jsx(Cd,{item:p,onMint:t},`${p.chain}-${p.assetType}-${b}`))})]})}Sd.__docgenInfo={description:"Staking overview panel with search and filter",methods:[],displayName:"StakingOverviewPanel",props:{onMint:{required:!1,tsType:{name:"signature",type:"function",raw:"(item: StakingOverviewItem) => void",signature:{arguments:[{type:{name:"StakingOverviewItem"},name:"item"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Qv=["ETH","BSC","TRON"],_s={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron",BFMeta:"BFMeta",BFChain:"BFChain",CCChain:"CCChain",PMChain:"PMChain"},yi={ETH:{BFM:"1000.00",USDT:"5000.00"},BSC:{BFM:"2500.00",USDT:"10000.00",BFC:"500.00"},TRON:{USDT:"8000.00"}};function Yv(t,s){if(!t)return[];const n=[];for(const[a,r]of Object.entries(t))for(const[o,c]of Object.entries(r)){const i=c.supportChain[s];i&&n.push({asset:i.assetType,targetChain:a,targetAsset:o})}return n}function kd({onSuccess:t,className:s}){const{t:n}=L("staking"),[a,r]=l.useState("BSC"),[o,c]=l.useState(""),[i,d]=l.useState(""),[u,m]=l.useState(""),[f,h]=l.useState(""),[g,v]=l.useState(!1),[p,b]=l.useState(!1),[y,x]=l.useState(!0),[j,N]=l.useState(!1),[w,S]=l.useState(null);l.useEffect(()=>{let E=!0;return jt.getRechargeConfig().then(B=>{E&&(S(B),x(!1))}),()=>{E=!1}},[]);const C=l.useMemo(()=>Yv(w,a),[w,a]);l.useEffect(()=>{const E=C[0];E&&!o&&(c(E.asset),d(E.targetChain),m(E.targetAsset))},[C,o]);const T=l.useCallback(E=>{r(E),c(""),d(""),m(""),h(""),v(!1)},[]),k=l.useCallback(E=>{c(E.asset),d(E.targetChain),m(E.targetAsset),b(!1)},[]),I=l.useMemo(()=>yi[a]?.[o]??"0.00",[a,o]),D=l.useCallback(()=>{h(I.replace(/,/g,""))},[I]),_=l.useMemo(()=>{if(!f)return null;const E=parseFloat(f);if(isNaN(E)||E<=0)return n("invalidAmount");const B=parseFloat(I.replace(/,/g,""));return E>B?n("insufficientBalance"):null},[f,I,n]),A=l.useMemo(()=>a&&o&&i&&u&&f&&!_&&!j,[a,o,i,u,f,_,j]),R=l.useCallback(async()=>{if(A){N(!0);try{const E=f.replace(/,/g,""),B={sourceChain:a,sourceAsset:o,amount:ce.fromFormatted(E,18,o),targetChain:i,targetAsset:u},P=await jt.submitMint(B);t?.(P.id)}finally{N(!1)}}},[A,a,o,f,i,u,t]);return y?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(be,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):e.jsxs("div",{className:M("space-y-4",s),children:[e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("sourceChain")}),e.jsxs("button",{type:"button",onClick:()=>v(!0),className:"bg-background mb-3 flex w-full items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-muted flex size-6 items-center justify-center rounded-full text-xs font-bold",children:a.charAt(0)}),e.jsx("span",{className:"font-medium",children:_s[a]})]}),e.jsx(Ce,{className:"text-muted-foreground size-4"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>b(!0),className:"bg-background flex shrink-0 items-center gap-2 rounded-lg px-3 py-2",children:[e.jsx(Je,{symbol:o||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:o||n("selectToken")}),e.jsx(Ce,{className:"text-muted-foreground size-4"})]}),e.jsx("div",{className:"flex-1",children:e.jsx(Pe,{type:"text",inputMode:"decimal",placeholder:"0.00",value:f,onChange:E=>h(E.target.value),className:"border-0 bg-transparent text-right text-lg font-semibold"})})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-muted-foreground",children:[n("availableBalance"),": ",I]}),e.jsx($,{type:"button",variant:"ghost",size:"sm",className:"text-primary h-auto px-2 py-1 text-xs",onClick:D,children:n("max")})]}),_&&e.jsx("div",{className:"text-destructive mt-2 text-xs",children:_})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-muted rounded-full p-2",children:e.jsx(bn,{className:"text-muted-foreground size-4"})})}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("targetChain")}),e.jsxs("div",{className:"bg-background flex items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-primary/20 text-primary flex size-6 items-center justify-center rounded-full text-xs font-bold",children:i.charAt(0)||"?"}),e.jsx("span",{className:"font-medium",children:_s[i]||n("selectToken")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Je,{symbol:u||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:u||"-"})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:n("amount")}),e.jsxs("span",{className:"font-semibold",children:[f||"0.00"," ",u]})]})]}),e.jsx($,{type:"button",size:"lg",className:"w-full",disabled:!A,onClick:R,children:j?e.jsxs(e.Fragment,{children:[e.jsx(be,{size:"sm"}),e.jsx("span",{className:"ml-2",children:n("confirm")})]}):n("confirm")}),e.jsx(ht,{open:g,onOpenChange:v,children:e.jsxs(xt,{side:"bottom",className:"h-[50vh]",children:[e.jsx(gt,{children:e.jsx(vt,{children:n("selectChain")})}),e.jsx("div",{className:"mt-4 space-y-2",children:Qv.map(E=>e.jsxs("button",{onClick:()=>T(E),className:M("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",a===E?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("div",{className:"bg-muted flex size-8 items-center justify-center rounded-full text-sm font-bold",children:E.charAt(0)}),e.jsx("span",{className:"font-medium",children:_s[E]}),a===E&&e.jsx("span",{className:"text-primary ml-auto",children:""})]},E))})]})}),e.jsx(ht,{open:p,onOpenChange:b,children:e.jsxs(xt,{side:"bottom",className:"h-[60vh]",children:[e.jsx(gt,{children:e.jsx(vt,{children:n("selectToken")})}),e.jsx("div",{className:"mt-4 space-y-2",children:C.length===0?e.jsx("p",{className:"text-muted-foreground py-8 text-center",children:n("noResults")}):C.map(E=>e.jsxs("button",{onClick:()=>k(E),className:M("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",o===E.asset?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx(Je,{symbol:E.asset,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:E.asset}),e.jsxs("div",{className:"text-muted-foreground text-xs",children:[" ",_s[E.targetChain]," (",E.targetAsset,")"]})]}),e.jsx("div",{className:"text-muted-foreground text-right text-sm",children:yi[a]?.[E.asset]??"0.00"}),o===E.asset&&e.jsx("span",{className:"text-primary",children:""})]},`${E.targetChain}-${E.asset}`))})]})})]})}kd.__docgenInfo={description:"Mint form component",methods:[],displayName:"MintForm",props:{onSuccess:{required:!1,tsType:{name:"signature",type:"function",raw:"(txId: string) => void",signature:{arguments:[{type:{name:"string"},name:"txId"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Xv=["BFMeta","BFChain","CCChain","PMChain"],Ms={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron",BFMeta:"BFMeta",BFChain:"BFChain",CCChain:"CCChain",PMChain:"PMChain"},ji={BFMeta:{BFM:"5000.00",USDT:"2500.00"},BFChain:{BFC:"1000.00"},CCChain:{},PMChain:{}};function Zv(t,s){if(!t)return[];const n=s.toLowerCase(),a=t[n];if(!a)return[];const r=[];for(const[o,c]of Object.entries(a)){const i=[];c.supportChain.ETH&&i.push("ETH"),c.supportChain.BSC&&i.push("BSC"),c.supportChain.TRON&&i.push("TRON"),i.length>0&&r.push({asset:o,targetChains:i})}return r}function Ad({onSuccess:t,className:s}){const{t:n}=L("staking"),[a,r]=l.useState("BFMeta"),[o,c]=l.useState(""),[i,d]=l.useState(""),[u,m]=l.useState(""),[f,h]=l.useState(!1),[g,v]=l.useState(!1),[p,b]=l.useState(!1),[y,x]=l.useState(!0),[j,N]=l.useState(!1),[w,S]=l.useState(null);l.useEffect(()=>{let P=!0;return jt.getRechargeConfig().then(z=>{P&&(S(z),x(!1))}),()=>{P=!1}},[]);const C=l.useMemo(()=>Zv(w,a),[w,a]),T=l.useMemo(()=>o?C.find(z=>z.asset===o)?.targetChains??[]:[],[C,o]);l.useEffect(()=>{const P=C[0];if(P&&!o){c(P.asset);const z=P.targetChains[0];z&&d(z)}},[C,o]);const k=l.useCallback(P=>{r(P),c(""),d(""),m(""),h(!1)},[]),I=l.useCallback(P=>{c(P.asset);const z=P.targetChains[0];z&&d(z),v(!1)},[]),D=l.useCallback(P=>{d(P),b(!1)},[]),_=l.useMemo(()=>ji[a]?.[o]??"0.00",[a,o]),A=l.useCallback(()=>{m(_.replace(/,/g,""))},[_]),R=l.useMemo(()=>{if(!u)return null;const P=parseFloat(u);if(isNaN(P)||P<=0)return n("invalidAmount");const z=parseFloat(_.replace(/,/g,""));return P>z?n("insufficientBalance"):null},[u,_,n]),E=l.useMemo(()=>a&&o&&i&&u&&!R&&!j,[a,o,i,u,R,j]),B=l.useCallback(async()=>{if(!(!E||!i)){N(!0);try{const P=u.replace(/,/g,""),z={sourceChain:a,sourceAsset:o,amount:ce.fromFormatted(P,8,o),targetChain:i,targetAsset:o},q=await jt.submitBurn(z);t?.(q.id)}finally{N(!1)}}},[E,a,o,u,i,t]);return y?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(be,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:n("loading")})]}):e.jsxs("div",{className:M("space-y-4",s),children:[e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("sourceChain")}),e.jsxs("button",{type:"button",onClick:()=>h(!0),className:"bg-background mb-3 flex w-full items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-primary/20 text-primary flex size-6 items-center justify-center rounded-full text-xs font-bold",children:a.charAt(0)}),e.jsx("span",{className:"font-medium",children:Ms[a]})]}),e.jsx(Ce,{className:"text-muted-foreground size-4"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>v(!0),className:"bg-background flex shrink-0 items-center gap-2 rounded-lg px-3 py-2",children:[e.jsx(Je,{symbol:o||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:o||n("selectToken")}),e.jsx(Ce,{className:"text-muted-foreground size-4"})]}),e.jsx("div",{className:"flex-1",children:e.jsx(Pe,{type:"text",inputMode:"decimal",placeholder:"0.00",value:u,onChange:P=>m(P.target.value),className:"border-0 bg-transparent text-right text-lg font-semibold"})})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-muted-foreground",children:[n("availableBalance"),": ",_]}),e.jsx($,{type:"button",variant:"ghost",size:"sm",className:"text-primary h-auto px-2 py-1 text-xs",onClick:A,children:n("max")})]}),R&&e.jsx("div",{className:"text-destructive mt-2 text-xs",children:R})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-muted rounded-full p-2",children:e.jsx(bn,{className:"text-muted-foreground size-4"})})}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-4",children:[e.jsx("div",{className:"text-muted-foreground mb-2 text-xs",children:n("targetChain")}),e.jsxs("button",{type:"button",onClick:()=>b(!0),disabled:T.length===0,className:"bg-background flex w-full items-center justify-between rounded-lg px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-muted flex size-6 items-center justify-center rounded-full text-xs font-bold",children:i?i.charAt(0):"?"}),e.jsx("span",{className:"font-medium",children:i?Ms[i]:n("selectChain")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Je,{symbol:o||"?",size:"sm"}),e.jsx("span",{className:"font-medium",children:o||"-"}),e.jsx(Ce,{className:"text-muted-foreground size-4"})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:n("amount")}),e.jsxs("span",{className:"font-semibold",children:[u||"0.00"," ",o]})]})]}),e.jsx($,{type:"button",size:"lg",className:"w-full",disabled:!E,onClick:B,children:j?e.jsxs(e.Fragment,{children:[e.jsx(be,{size:"sm"}),e.jsx("span",{className:"ml-2",children:n("confirm")})]}):n("confirm")}),e.jsx(ht,{open:f,onOpenChange:h,children:e.jsxs(xt,{side:"bottom",className:"h-[50vh]",children:[e.jsx(gt,{children:e.jsx(vt,{children:n("selectChain")})}),e.jsx("div",{className:"mt-4 space-y-2",children:Xv.map(P=>e.jsxs("button",{onClick:()=>k(P),className:M("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",a===P?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("div",{className:"bg-primary/20 text-primary flex size-8 items-center justify-center rounded-full text-sm font-bold",children:P.charAt(0)}),e.jsx("span",{className:"font-medium",children:Ms[P]}),a===P&&e.jsx("span",{className:"text-primary ml-auto",children:""})]},P))})]})}),e.jsx(ht,{open:g,onOpenChange:v,children:e.jsxs(xt,{side:"bottom",className:"h-[60vh]",children:[e.jsx(gt,{children:e.jsx(vt,{children:n("selectToken")})}),e.jsx("div",{className:"mt-4 space-y-2",children:C.length===0?e.jsx("p",{className:"text-muted-foreground py-8 text-center",children:n("noResults")}):C.map(P=>e.jsxs("button",{onClick:()=>I(P),className:M("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",o===P.asset?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx(Je,{symbol:P.asset,size:"md"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"font-medium",children:P.asset}),e.jsxs("div",{className:"text-muted-foreground text-xs",children:[" ",P.targetChains.join(", ")]})]}),e.jsx("div",{className:"text-muted-foreground text-right text-sm",children:ji[a]?.[P.asset]??"0.00"}),o===P.asset&&e.jsx("span",{className:"text-primary",children:""})]},P.asset))})]})}),e.jsx(ht,{open:p,onOpenChange:b,children:e.jsxs(xt,{side:"bottom",className:"h-[50vh]",children:[e.jsx(gt,{children:e.jsx(vt,{children:n("selectChain")})}),e.jsx("div",{className:"mt-4 space-y-2",children:T.map(P=>e.jsxs("button",{onClick:()=>D(P),className:M("flex w-full items-center gap-3 rounded-lg px-4 py-3 transition-colors",i===P?"bg-primary/10 text-primary":"hover:bg-muted"),children:[e.jsx("div",{className:"bg-muted flex size-8 items-center justify-center rounded-full text-sm font-bold",children:P.charAt(0)}),e.jsx("span",{className:"font-medium",children:Ms[P]}),i===P&&e.jsx("span",{className:"text-primary ml-auto",children:""})]},P))})]})})]})}Ad.__docgenInfo={description:"Burn form component",methods:[],displayName:"BurnForm",props:{onSuccess:{required:!1,tsType:{name:"signature",type:"function",raw:"(txId: string) => void",signature:{arguments:[{type:{name:"string"},name:"txId"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const Ni={ETH:"Ethereum",BSC:"BNB Chain",TRON:"Tron",BFMeta:"BFMeta",BFChain:"BFChain",CCChain:"CCChain",PMChain:"PMChain"};function eb({status:t}){switch(t){case"pending":return e.jsx(lm,{className:"size-4 text-yellow-500"});case"confirming":return e.jsx(ke,{className:"size-4 animate-spin text-blue-500"});case"confirmed":return e.jsx(Gt,{className:"size-4 text-green-500"});case"failed":return e.jsx(bm,{className:"text-destructive size-4"})}}function tb(t){const n=Date.now()-t;return n<6e4?"Just now":n<36e5?`${Math.floor(n/6e4)}m ago`:n<864e5?`${Math.floor(n/36e5)}h ago`:new Date(t).toLocaleDateString()}function sb(t){const s=t.toNumber();return s>=1e6?`${(s/1e6).toFixed(2)}M`:s>=1e3?`${(s/1e3).toFixed(2)}K`:s.toFixed(4)}function nb({record:t,onClick:s}){const{t:n}=L("staking"),a=t.type==="mint",r=a?Am:uo;return e.jsxs("button",{type:"button",onClick:s,className:"bg-card hover:bg-muted/50 flex w-full items-center gap-3 rounded-lg p-3 text-left transition-colors",children:[e.jsx("div",{className:M("flex size-10 items-center justify-center rounded-full",a?"bg-green-500/10":"bg-orange-500/10"),children:e.jsx(r,{className:M("size-5",a?"text-green-500":"text-orange-500")})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:n(a?"mint":"burn")}),e.jsx(eb,{status:t.status})]}),e.jsxs("div",{className:"text-muted-foreground flex items-center gap-1 text-xs",children:[e.jsx("span",{children:Ni[t.sourceChain]}),e.jsx("span",{children:""}),e.jsx("span",{children:Ni[t.targetChain]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(Je,{symbol:t.sourceAsset,size:"sm"}),e.jsx("span",{className:"font-medium",children:sb(t.sourceAmount)})]}),e.jsx("div",{className:"text-muted-foreground text-xs",children:tb(t.createdAt)})]})]})}function Td({filterType:t="all",onRecordClick:s,className:n}){const{t:a}=L("staking"),[r,o]=l.useState([]),[c,i]=l.useState(!0),[d,u]=l.useState(t==="all"?"all":t);l.useEffect(()=>{let g=!0;return i(!0),jt.getTransactions().then(v=>{g&&(o(v),i(!1))}),()=>{g=!1}},[]);const m=l.useMemo(()=>d==="all"?r:r.filter(g=>g.type===d),[r,d]),f=[{id:"all",label:a("history")},{id:"mint",label:a("mint")},{id:"burn",label:a("burn")}],h=l.useCallback(()=>{i(!0),jt.getTransactions().then(g=>{o(g),i(!1)})},[]);return c?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(be,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:a("loading")})]}):e.jsxs("div",{className:M("space-y-4",n),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[f.map(g=>e.jsx($,{type:"button",variant:d===g.id?"default":"outline",size:"sm",onClick:()=>u(g.id),children:g.label},g.id)),e.jsx($,{type:"button",variant:"ghost",size:"sm",className:"ml-auto",onClick:h,children:a("refresh")})]}),m.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:a("noTransactions")})}):e.jsx("div",{className:"space-y-2",children:m.map(g=>e.jsx(nb,{record:g,onClick:()=>s?.(g)},g.id))})]})}Td.__docgenInfo={description:"Staking record list component",methods:[],displayName:"StakingRecordList",props:{filterType:{required:!1,tsType:{name:"union",raw:"StakingTxType | 'all'",elements:[{name:"StakingTxType"},{name:"literal",value:"'all'"}]},description:"Filter by transaction type",defaultValue:{value:"'all'",computed:!1}},onRecordClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(record: StakingTransaction) => void",signature:{arguments:[{type:{name:"StakingTransaction"},name:"record"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};function Id(){const{t}=L("staking"),{goBack:s}=Z(),[n,a]=l.useState("overview"),r=[{id:"overview",label:t("overview")},{id:"mint",label:t("mint")},{id:"burn",label:t("burn")},{id:"history",label:t("history")}],o=c=>{a("mint")};return e.jsxs("div",{className:"flex min-h-screen flex-col bg-background",children:[e.jsx(H,{title:t("title"),onBack:s}),e.jsx("div",{className:"flex border-b border-border px-4",children:r.map(c=>e.jsx("button",{onClick:()=>a(c.id),className:M("flex-1 py-3 text-sm font-medium transition-colors",n===c.id?"border-b-2 border-primary text-primary":"text-muted-foreground hover:text-foreground"),children:c.label},c.id))}),e.jsxs("div",{className:"flex-1 p-4",children:[n==="overview"&&e.jsx(Sd,{onMint:o}),n==="mint"&&e.jsx(ab,{}),n==="burn"&&e.jsx(rb,{}),n==="history"&&e.jsx(Td,{})]})]})}function ab(){const{t}=L("staking"),s=n=>{console.log("Mint transaction submitted:",n)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:t("mintDescription")}),e.jsx(kd,{onSuccess:s})]})}function rb(){const{t}=L("staking"),s=n=>{console.log("Burn transaction submitted:",n)};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:t("burnDescription")}),e.jsx(Ad,{onSuccess:s})]})}Id.__docgenInfo={description:"Staking page with tab navigation",methods:[],displayName:"StakingPage"};const Pd=()=>e.jsx(Q,{children:e.jsx(Id,{})});Pd.__docgenInfo={description:"",methods:[],displayName:"StakingActivity"};const ib=Vt({assetType:W(),decimals:wt(),amount:W().optional(),useDefaultDecimals:Ue().optional(),logoUrl:W().optional(),contractAddress:W().optional()}),ob=Vt({address:W(),symbol:W(),addressKey:W(),mainWalletId:W(),chain:W(),mnemonic:W().optional(),privateKey:W(),publicKey:W().optional(),isCustomAssets:Ue().optional(),isFreezed:Ue().optional(),assets:qe(ib),name:W(),prohibitChangeName:Ue().optional(),index:wt().optional(),purpose:ga([$e(44),$e(49),$e(84),$e(86)]).optional()}),cb=Vt({chainName:W(),addressKey:W(),address:W(),symbol:W(),mainWalletId:W(),index:wt().optional(),purpose:ga([$e(44),$e(49),$e(84),$e(86)]).optional()});Vt({name:W(),skipBackup:Ue().optional(),importPhrase:W(),importType:W(),addressKeyList:qe(cb),mainWalletId:W(),headSculpture:W(),createTimestamp:wt(),lastBitcoinAddressKey:W().optional()});Vt({addressBookId:W(),name:W(),address:W(),chainList:qe(W()).optional(),remarks:W().optional(),iconName:W().optional(),symbol:W().optional()});Vt({password:W(),passwordTips:W().optional(),lastWalletActivate:ob.optional(),walletLock:Ue().optional(),fingerprintLock:Ue().optional(),fingerprintPay:Ue().optional()});const lb=l.createContext(null);function db(){return l.useContext(lb)}const ub="keyapp_welcome_shown";function Rs(){localStorage.setItem(ub,"1")}function Ed(){const{t}=L("guide"),{navigate:s}=Z(),[n,a]=l.useState(0),r=db(),o=l.useMemo(()=>[{icon:e.jsx(xo,{className:"text-primary size-16"}),title:t("welcome.slides.transfer.title"),description:t("welcome.slides.transfer.description")},{icon:e.jsx(ho,{className:"text-primary size-16"}),title:t("welcome.slides.multichain.title"),description:t("welcome.slides.multichain.description")},{icon:e.jsx(ym,{className:"text-primary size-16"}),title:t("welcome.slides.security.title"),description:t("welcome.slides.security.description")}],[t]),c=o[n];if(!c)return null;const i=l.useCallback(()=>{Rs(),s({to:"/wallet/create"})},[s]),d=l.useCallback(()=>{Rs(),s({to:"/onboarding/recover"})},[s]),u=l.useCallback(()=>{Rs(),s({to:"/onboarding/migrate"})},[s]),m=l.useCallback(()=>{Rs(),s({to:"/"})},[s]),f=l.useCallback(()=>{n<o.length-1&&a(v=>v+1)},[n,o.length]),h=n===o.length-1,g=r?.shouldPromptMigration;return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx("div",{className:"flex justify-end p-4",children:e.jsx($,{variant:"ghost",size:"sm","data-testid":"skip-button",onClick:m,children:t("welcome.skip")})}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center px-8",children:[e.jsx("div",{className:"bg-primary/10 mb-8 flex size-32 items-center justify-center rounded-full",children:c.icon}),e.jsx("h1",{className:"mb-4 text-center text-2xl font-bold",children:c.title}),e.jsx("p",{className:"text-muted-foreground mb-8 max-w-sm text-center",children:c.description}),e.jsx("div",{className:"mb-8 flex gap-2",children:o.map((v,p)=>e.jsx("button",{"data-testid":`slide-dot-${p}`,onClick:()=>a(p),className:M("size-2 rounded-full transition-colors",p===n?"bg-primary":"bg-muted-foreground/30"),"aria-label":t("welcome.goToSlide",{number:p+1})},p))})]}),e.jsx("div",{className:"p-6",children:h?e.jsxs("div",{className:"flex flex-col gap-3",children:[g&&e.jsxs($,{"data-testid":"migrate-button",onClick:u,className:"w-full",size:"lg",variant:"default",children:[e.jsx(ya,{className:"mr-2 size-4"}),t("welcome.migrateFromMpay",{defaultValue:" mpay "})]}),e.jsx($,{"data-testid":"get-started-button",onClick:i,className:"w-full",size:"lg",variant:g?"outline":"default",children:t("welcome.getStarted")}),e.jsx($,{"data-testid":"have-wallet-button",onClick:d,variant:"outline",className:"w-full",size:"lg",children:t("welcome.haveWallet")})]}):e.jsxs($,{"data-testid":"next-button",onClick:f,className:"w-full",size:"lg",children:[t("welcome.next"),e.jsx(Ce,{className:"ml-2 size-4"})]})})]})}Ed.__docgenInfo={description:"",methods:[],displayName:"WelcomeScreen"};const _d=()=>e.jsx(Q,{children:e.jsx(Ed,{})});_d.__docgenInfo={description:"",methods:[],displayName:"WelcomeActivity"};function Md(){const{t}=L(["wallet","onboarding","security","common"]),{goBack:s}=Z(),n=ye(),a=us(),r=Ke(),[o,c]=l.useState("select"),[i,d]=l.useState([]),[u,m]=l.useState([]),[f,h]=l.useState(!1),g=l.useRef(!1);l.useEffect(()=>{!g.current&&n&&(d(n.chainAddresses.map(y=>y.chain)),g.current=!0)},[n]);const v=l.useCallback(()=>{if(!n)return!1;const y=new Set(n.chainAddresses.map(x=>x.chain));return y.size!==i.length?!0:i.some(x=>!y.has(x))},[n,i]),p=l.useCallback(()=>{if(!v()){s();return}c("verify")},[v,s]),b=l.useCallback(async y=>{if(!(!n||y.length<4)){h(!1),c("saving");try{const x=St(y);await de.updateWalletChainAddresses(n.id,i,x,a),!i.includes(r)&&i.length>0&&de.setSelectedChain(i[0]),c("success"),setTimeout(()=>{s()},1500)}catch(x){console.error("Failed to update chain addresses:",x),x instanceof Error&&x.message.includes("decrypt")?(h(!0),m([]),c("verify"),setTimeout(()=>{h(!1)},1500)):c("select")}}},[n,i,a,s]);return n?o==="saving"?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(H,{title:t("wallet:chains.title")}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx(be,{size:"lg"}),e.jsx("p",{className:"text-muted-foreground",children:t("wallet:chains.saving")})]})]}):o==="success"?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(H,{title:t("wallet:chains.title")}),e.jsxs("div",{className:"flex flex-1 flex-col items-center justify-center gap-4 p-4",children:[e.jsx("div",{className:"flex size-16 items-center justify-center rounded-full bg-green-500/10",children:e.jsx(fe,{className:"size-8 text-green-500"})}),e.jsx("p",{className:"font-medium",children:t("wallet:chains.success")})]})]}):o==="verify"?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(H,{title:t("wallet:chains.verifyTitle"),onBack:()=>{c("select"),m([])}}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:t("wallet:chains.verifyTitle")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("wallet:chains.verifyDesc")})]}),e.jsx(Kt,{value:u,onChange:m,onComplete:b,minPoints:4,error:f,"data-testid":"wallet-chains-pattern"})]})]}):e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(H,{title:t("wallet:chains.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-6 p-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(bs,{icon:Gt,variant:"success",size:"lg",className:"mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:t("onboarding:chainSelector.title")}),e.jsx("p",{className:"text-muted-foreground mt-2 text-sm",children:t("onboarding:chainSelector.subtitle")})]}),a.length===0?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(be,{})}):e.jsx(wa,{"data-testid":"wallet-chains-selector",chains:a,selectedChains:i,onSelectionChange:d}),e.jsx(Ee,{variant:"mint",className:"w-full","data-testid":"wallet-chains-save",disabled:i.length===0,onClick:p,children:v()?t("common:save"):t("common:done")})]})]}):e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(H,{title:t("wallet:chains.title"),onBack:s}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-4",children:e.jsx(kt,{variant:"warning",children:t("wallet:chains.noWallet")})})]})}Md.__docgenInfo={description:"",methods:[],displayName:"WalletChainsPage"};const Rd=()=>e.jsx(Q,{children:e.jsx(Md,{})});Rd.__docgenInfo={description:"",methods:[],displayName:"SettingsWalletChainsActivity"};function Jn(t){if(t===0)return"0 B";const s=1024,n=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(s));return`${parseFloat((t/Math.pow(s,a)).toFixed(2))} ${n[a]}`}function Dd(){const{t}=L(["settings","common"]),{goBack:s}=Z(),{push:n}=V(),[a,r]=l.useState(null),[o,c]=l.useState(!0),i=l.useCallback(async()=>{c(!0);try{if(navigator.storage&&navigator.storage.estimate){const u=await navigator.storage.estimate();r({usage:u.usage??0,quota:u.quota??0})}}catch(u){console.error("Failed to get storage estimate:",u)}finally{c(!1)}},[]);l.useEffect(()=>{i()},[i]);const d=a?a.usage/a.quota*100:0;return e.jsxs("div",{className:"bg-muted/30 flex min-h-screen flex-col",children:[e.jsx(H,{title:t("settings:storage.title"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"bg-primary/10 flex size-10 items-center justify-center rounded-full",children:e.jsx(fo,{className:"text-primary size-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:t("settings:storage.usage")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:t("settings:storage.basedOn")})]})]}),o?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(ke,{className:"text-muted-foreground size-6 animate-spin"})}):a?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"bg-muted h-3 w-full overflow-hidden rounded-full",children:e.jsx("div",{className:"bg-primary h-full rounded-full transition-all",style:{width:`${Math.min(d,100)}%`}})}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[t("settings:storage.used"),": ",Jn(a.usage)]}),e.jsxs("span",{className:"text-muted-foreground",children:[t("settings:storage.total"),": ",Jn(a.quota)]})]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:t("settings:storage.usagePercent")}),e.jsxs("span",{className:"font-medium",children:[d.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:t("settings:storage.available")}),e.jsx("span",{className:"font-medium",children:Jn(a.quota-a.usage)})]})]})]}):e.jsx("p",{className:"text-muted-foreground text-center py-4",children:t("settings:storage.unavailable")})]}),e.jsxs("div",{className:"bg-card rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"font-medium mb-2",children:t("settings:storage.clearTitle")}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:t("settings:storage.clearDesc")}),e.jsxs($,{variant:"destructive",className:"w-full",onClick:()=>n("ClearDataConfirmJob",{}),children:[e.jsx(Tt,{className:"size-4 mr-2"}),t("settings:items.clearData")]})]})]})]})}Dd.__docgenInfo={description:"",methods:[],displayName:"SettingsStoragePage"};const zd=()=>e.jsx(Q,{children:e.jsx(Dd,{})});zd.__docgenInfo={description:"",methods:[],displayName:"SettingsStorageActivity"};const Bd=()=>{const{t}=L("common"),{pop:s}=V(),n=le(Nt),[a,r]=l.useState(!1),[o,c]=l.useState(""),[i,d]=l.useState(""),[u,m]=l.useState(!1),[f,h]=l.useState(null),g=async()=>{if(!o.trim()){h(" URL");return}try{new URL(o)}catch{h(" URL ");return}if(n.sources.some(y=>y.url===o)){h("");return}Ie.addSource(o,i||""),c(""),d(""),r(!1),h(null)},v=y=>{Ie.removeSource(y)},p=y=>{Ie.toggleSource(y)},b=async()=>{m(!0);try{await Ja()}catch(y){console.error("Refresh failed:",y)}m(!1)};return e.jsx(Q,{children:e.jsxs("div",{className:"flex flex-col min-h-full bg-background",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-background border-b",children:e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[e.jsx("button",{onClick:()=>s(),className:"p-1.5 rounded-full hover:bg-muted transition-colors","aria-label":t("back",""),children:e.jsx(ao,{className:"size-5",stroke:1.5})}),e.jsx("h1",{className:"flex-1 text-lg font-semibold",children:""}),e.jsx("button",{onClick:b,disabled:u,className:"p-1.5 rounded-full hover:bg-muted transition-colors","aria-label":t("refresh",""),children:e.jsx(gs,{className:M("size-5",u&&"animate-spin"),stroke:1.5})})]})}),e.jsxs("div",{className:"flex-1 p-4 space-y-3",children:[n.sources.map(y=>e.jsx(mb,{source:y,onToggle:()=>p(y.url),onRemove:()=>v(y.url)},y.url)),n.sources.length===0&&e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:""})]}),a?e.jsxs("div",{className:"border-t p-4 bg-background space-y-3",children:[e.jsx("input",{type:"url",value:o,onChange:y=>{c(y.target.value),h(null)},placeholder:" URL (https://...)",className:"w-full px-3 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary"}),e.jsx("input",{type:"text",value:i,onChange:y=>d(y.target.value),placeholder:" ()",className:"w-full px-3 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary"}),f&&e.jsx("p",{className:"text-sm text-destructive",children:f}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{r(!1),c(""),d(""),h(null)},className:"flex-1 py-2 rounded-lg bg-muted hover:bg-muted/80 font-medium",children:""}),e.jsx("button",{onClick:g,className:"flex-1 py-2 rounded-lg bg-primary text-primary-foreground hover:bg-primary/90 font-medium",children:""})]})]}):e.jsx("div",{className:"border-t p-4",children:e.jsxs("button",{onClick:()=>r(!0),className:"w-full py-3 rounded-xl border-2 border-dashed border-muted-foreground/30 hover:border-primary hover:bg-primary/5 transition-colors flex items-center justify-center gap-2 text-muted-foreground hover:text-primary",children:[e.jsx(st,{className:"size-5",stroke:1.5}),e.jsx("span",{children:""})]})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})})};function mb({source:t,onToggle:s,onRemove:n}){const a=t.url==="/ecosystem.json";return e.jsx("div",{className:M("rounded-xl border p-4 transition-colors",t.enabled?"bg-card":"bg-muted/30 opacity-60"),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"rounded-full bg-primary/10 p-2 shrink-0",children:e.jsx(go,{className:"size-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium truncate",children:t.name}),a&&e.jsx("span",{className:"text-xs bg-primary/10 text-primary px-1.5 py-0.5 rounded",children:""})]}),e.jsx("p",{className:"text-sm text-muted-foreground truncate mt-0.5",children:t.url}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[" ",new Date(t.lastUpdated).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[e.jsx("button",{onClick:s,className:M("p-2 rounded-full transition-colors",t.enabled?"bg-green-100 text-green-600 hover:bg-green-200":"bg-muted text-muted-foreground hover:bg-muted/80"),"aria-label":t.enabled?"":"",children:t.enabled?e.jsx(fe,{className:"size-4",stroke:2}):e.jsx(Nn,{className:"size-4",stroke:2})}),!a&&e.jsx("button",{onClick:n,className:"p-2 rounded-full text-muted-foreground hover:text-destructive hover:bg-destructive/10 transition-colors","aria-label":"",children:e.jsx(Tt,{className:"size-4",stroke:1.5})})]})]})})}Bd.__docgenInfo={description:"",methods:[],displayName:"SettingsSourcesActivity"};const wi={defi:"DeFi",nft:"NFT",tools:"",games:"",social:"",exchange:"",other:""};function fb({permission:t,isLast:s}){const n=ku[t],a=n?.risk??"medium",r=a==="high"?Se:Qi,o=a==="high"?"text-red-500":a==="medium"?"text-amber-500":"text-green-500";return e.jsxs("div",{className:M("flex items-start gap-3 py-3",!s&&"border-b border-border/50"),children:[e.jsx(r,{className:M("size-5 mt-0.5 shrink-0",o),stroke:1.5}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm",children:n?.name??t}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:n?.description??""})]})]})}function Rt({label:t,value:s,isLink:n=!1,href:a}){const r=e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-border/50 last:border-0",children:[e.jsx("span",{className:"text-muted-foreground text-sm",children:t}),e.jsxs("span",{className:M("text-sm font-medium",n&&"text-primary flex items-center gap-1"),children:[s,n&&e.jsx(Ce,{className:"size-4"})]})]});return n&&a?e.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",children:r}):r}const Ld=({params:t})=>{const{t:s}=L("common"),{pop:n}=V(),[a,r]=l.useState(null),[o,c]=l.useState(!0),[i,d]=l.useState(!1),u=le(Nt,p=>ha.isAppInstalled(p,t.appId));l.useEffect(()=>{let p=!1;return(async()=>{c(!0),await Fc();let y=ii(t.appId);y||(await Ja({force:!1}),y=ii(t.appId)),!p&&(r(y??null),c(!1))})(),()=>{p=!0}},[t.appId]);const m=l.useCallback(()=>{a&&Ie.installApp(a.id)},[a]),f=l.useCallback(()=>{a&&(Ie.updateAppLastUsed(a.id),Ie.setActiveSubPage("mine"),Fi(a.id,{...a,targetDesktop:"mine"}),n())},[a,n]);if(o)return e.jsx(Q,{children:e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-background",children:e.jsx(be,{size:"lg"})})});if(!a)return e.jsx(Q,{children:e.jsxs("div",{className:"flex min-h-screen flex-col items-center justify-center bg-background gap-4",children:[e.jsx("p",{className:"text-muted-foreground",children:""}),e.jsx("button",{onClick:()=>n(),className:"px-4 py-2 bg-primary text-primary-foreground rounded-full text-sm font-medium",children:""})]})});const h=a.longDescription??a.description,g=h.length>150,v=i||!g?h:h.slice(0,150)+"...";return e.jsx(Q,{children:e.jsxs("div",{className:"flex min-h-screen flex-col bg-background detail-scroll-container",children:[e.jsx("div",{className:"sticky top-0 z-20 bg-background/80 backdrop-blur-xl border-b border-border/50",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[e.jsx("button",{onClick:()=>n(),className:"p-1.5 -ml-1.5 rounded-full hover:bg-muted transition-colors",children:e.jsx(ao,{className:"size-5",stroke:1.5})}),e.jsx("span",{className:"font-semibold truncate max-w-[200px] detail-header-title",children:a.name}),e.jsx("button",{className:"p-1.5 -mr-1.5 rounded-full hover:bg-muted transition-colors",children:e.jsx(Ks,{className:"size-5",stroke:1.5})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto detail-scroller",children:[e.jsxs("div",{className:"px-5 pt-4 pb-5",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(Iu,{src:a.icon,name:a.name,size:"2xl",shadow:"lg",className:"shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0 pt-1",children:[e.jsx("h1",{className:"text-xl font-bold truncate",children:a.name}),e.jsx("p",{className:"text-sm text-muted-foreground mt-0.5 truncate",children:a.author??""}),u?e.jsx("button",{onClick:f,className:"mt-4 px-8 py-2 bg-primary text-primary-foreground rounded-full text-sm font-semibold",children:""}):e.jsx("button",{onClick:m,className:"mt-4 px-8 py-2 bg-primary text-primary-foreground rounded-full text-sm font-semibold",children:""})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-5 text-xs text-muted-foreground",children:[a.category&&e.jsx("span",{className:"font-medium text-foreground",children:wi[a.category]??a.category}),a.beta&&e.jsx("span",{className:"px-2 py-0.5 bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400 rounded-full font-medium",children:"Beta"}),e.jsxs("span",{children:["v",a.version]})]})]}),a.screenshots&&a.screenshots.length>0&&e.jsx("div",{className:"border-t border-border/50",children:e.jsxs("div",{className:"px-5 py-4",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:""}),e.jsx("div",{className:"flex gap-3 overflow-x-auto pb-2 -mx-5 px-5 snap-x snap-mandatory",style:{scrollbarWidth:"none"},children:a.screenshots.map((p,b)=>e.jsx("div",{className:"w-[220px] aspect-[9/19.5] rounded-2xl bg-muted overflow-hidden shrink-0 snap-center shadow-lg ring-1 ring-black/5",children:e.jsx("img",{src:p,alt:`${a.name} screenshot ${b+1}`,className:"w-full h-full object-cover",loading:"lazy",onError:y=>{y.currentTarget.parentElement.style.display="none"}})},b))})]})}),e.jsxs("div",{className:"border-t border-border/50 px-5 py-4",children:[e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:v}),g&&e.jsxs("button",{onClick:()=>d(!i),className:"text-primary text-sm font-medium mt-2 flex items-center gap-1",children:[i?"":"",i?e.jsx(Ui,{className:"size-4"}):e.jsx(Vi,{className:"size-4"})]})]}),a.chains&&a.chains.length>0&&e.jsxs("div",{className:"border-t border-border/50 px-5 py-4",children:[e.jsx("h2",{className:"text-lg font-bold mb-3",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.chains.map(p=>e.jsx("span",{className:"px-3 py-1.5 bg-muted rounded-full text-sm font-medium",children:p},p))})]}),a.permissions&&a.permissions.length>0&&e.jsxs("div",{className:"border-t border-border/50 px-5 py-4",children:[e.jsx("h2",{className:"text-lg font-bold mb-1",children:""}),e.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:""}),e.jsx("div",{className:"bg-muted/50 rounded-2xl px-4",children:a.permissions.map((p,b)=>e.jsx(fb,{permission:p,isLast:b===a.permissions.length-1},p))})]}),a.tags&&a.tags.length>0&&e.jsxs("div",{className:"border-t border-border/50 px-5 py-4",children:[e.jsx("h2",{className:"text-lg font-bold mb-3",children:""}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.tags.map(p=>e.jsxs("span",{className:"px-3 py-1.5 bg-primary/10 text-primary rounded-full text-sm font-medium",children:["#",p]},p))})]}),e.jsxs("div",{className:"border-t border-border/50 px-5 py-4",children:[e.jsx("h2",{className:"text-lg font-bold mb-2",children:""}),e.jsxs("div",{className:"bg-muted/50 rounded-2xl px-4",children:[a.author&&e.jsx(Rt,{label:"",value:a.author}),e.jsx(Rt,{label:"",value:a.version}),a.category&&e.jsx(Rt,{label:"",value:wi[a.category]??a.category}),a.publishedAt&&e.jsx(Rt,{label:"",value:a.publishedAt}),a.updatedAt&&e.jsx(Rt,{label:"",value:a.updatedAt}),a.website&&e.jsx(Rt,{label:"",value:"",isLink:!0,href:a.website})]})]}),e.jsx("div",{className:"h-8"})]})]})})};Ld.__docgenInfo={description:"",methods:[],displayName:"MiniappDetailActivity"};function ds({className:t,...s}){return e.jsx("label",{"data-slot":"label",className:M("gap-2 text-sm leading-none font-medium group-data-[disabled=true]:opacity-50 peer-disabled:opacity-50 flex items-center select-none group-data-[disabled=true]:pointer-events-none peer-disabled:cursor-not-allowed",t),...s})}ds.__docgenInfo={description:"",methods:[],displayName:"Label"};function Ya({className:t,size:s="default",...n}){return e.jsx("div",{"data-slot":"card","data-size":s,className:M("ring-foreground/10 bg-card text-card-foreground gap-4 overflow-hidden rounded-xl py-4 text-sm ring-1 has-data-[slot=card-footer]:pb-0 has-[>img:first-child]:pt-0 data-[size=sm]:gap-3 data-[size=sm]:py-3 data-[size=sm]:has-data-[slot=card-footer]:pb-0 *:[img:first-child]:rounded-t-xl *:[img:last-child]:rounded-b-xl group/card flex flex-col",t),...n})}function Xa({className:t,...s}){return e.jsx("div",{"data-slot":"card-content",className:M("px-4 group-data-[size=sm]/card:px-3",t),...s})}Ya.__docgenInfo={description:"",methods:[],displayName:"Card",props:{size:{required:!1,tsType:{name:"union",raw:'"default" | "sm"',elements:[{name:"literal",value:'"default"'},{name:"literal",value:'"sm"'}]},description:"",defaultValue:{value:'"default"',computed:!1}}}};Xa.__docgenInfo={description:"",methods:[],displayName:"CardContent"};function Od(){const{t}=L(["common","wallet"]),{goBack:s}=Z(),n=hn(),[a,r]=l.useState("ethereum"),[o,c]=l.useState(""),[i,d]=l.useState(""),[u,m]=l.useState(""),{data:f,isLoading:h,isFetching:g}=yf(u,i,!!u&&!!i),v=l.useCallback(()=>{o.trim()&&(d(o.trim()),m(a))},[o,a]),p=l.useCallback(x=>{x.key==="Enter"&&v()},[v]),b=n.filter(x=>x.chainKind==="evm"),y=n.filter(x=>x.chainKind!=="evm");return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(H,{title:t("common:addressLookup.balanceTitle"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ds,{children:t("common:addressLookup.chain")}),e.jsxs(Hs,{value:a,onValueChange:r,children:[e.jsx(Us,{children:e.jsx(Js,{})}),e.jsxs(Vs,{children:[b.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:"EVM"}),b.map(x=>e.jsx(qt,{value:x.id,children:x.name},x.id))]}),y.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:t("common:addressLookup.otherChains")}),y.map(x=>e.jsx(qt,{value:x.id,children:x.name},x.id))]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ds,{children:t("common:addressLookup.address")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Pe,{placeholder:t("common:addressLookup.addressPlaceholder"),value:o,onChange:x=>c(x.target.value),onKeyDown:p,className:"flex-1 font-mono text-sm"}),e.jsx($,{onClick:v,disabled:!o.trim()||g,children:g?e.jsx(be,{size:"sm"}):e.jsx(vs,{className:"size-4"})})]})]}),i&&e.jsx(Ya,{className:M("transition-all",h&&"opacity-50"),children:e.jsx(Xa,{className:"pt-6",children:f?.error?e.jsxs("div",{className:"flex items-center gap-3 text-destructive",children:[e.jsx(It,{className:"size-5 shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t("common:addressLookup.error")}),e.jsx("div",{className:"text-sm opacity-80",children:f.error})]})]}):f?.balance?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-primary/10 flex size-12 items-center justify-center rounded-full",children:e.jsx(Om,{className:"text-primary size-6"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[f.balance.amount.toFormatted()," ",f.balance.symbol]}),e.jsx("div",{className:"text-muted-foreground text-sm",children:t("common:addressLookup.onChain",{chain:n.find(x=>x.id===u)?.name??u})})]})]}):h?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx(be,{size:"lg"})}):null})}),!1]})]})}Od.__docgenInfo={description:"",methods:[],displayName:"AddressBalancePage"};const Fd=()=>e.jsx(Q,{children:e.jsx(Od,{})});Fd.__docgenInfo={description:"",methods:[],displayName:"AddressBalanceActivity"};function pb(t,s){return(parseFloat(t)/Math.pow(10,s)).toLocaleString(void 0,{maximumFractionDigits:6})}function hb(t){return new Date(t).toLocaleString()}function xb({tx:t,address:s}){const n=t.direction==="out"||t.from.toLowerCase()===s.toLowerCase(),a=t.assets.find(i=>i.assetType==="native"||i.assetType==="token"),r=a?a.value:"0",o=a?a.symbol:"",c=a?a.decimals:0;return e.jsxs("div",{className:"flex items-center gap-3 py-3 border-b last:border-b-0",children:[e.jsx("div",{className:`p-2 rounded-full ${n?"bg-red-100 text-red-600":"bg-green-100 text-green-600"}`,children:n?e.jsx(uo,{className:"size-4"}):e.jsx(Sm,{className:"size-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium truncate",children:n?`To: ${t.to}`:`From: ${t.from}`}),e.jsx("div",{className:"text-xs text-muted-foreground",children:hb(t.timestamp)})]}),e.jsxs("div",{className:`text-sm font-medium ${n?"text-red-600":"text-green-600"}`,children:[n?"-":"+",pb(r,c)," ",o]})]})}function Wd(){const{t}=L(["common","wallet"]),{goBack:s}=Z(),n=hn(),[a,r]=l.useState("bfmeta"),[o,c]=l.useState(""),[i,d]=l.useState(""),u=l.useMemo(()=>n.find(S=>S.id===a),[n,a]),{data:m,isLoading:f,isError:h,refetch:g}=Nf({chainId:a,address:i,enabled:!!i}),v=m?.transactions??[],p=m?.supported??!0,b=l.useMemo(()=>{if(!u?.explorer||!i.trim())return null;const{queryAddress:S,url:C}=u.explorer;return S?S.replace(":address",i.trim()):`${C}/address/${i.trim()}`},[u,i]),y=l.useCallback(()=>{o.trim()&&d(o.trim())},[o]),x=l.useCallback(S=>{S.key==="Enter"&&y()},[y]),j=l.useCallback(()=>{b&&window.open(b,"_blank","noopener,noreferrer")},[b]),N=n.filter(S=>S.chainKind==="evm"),w=n.filter(S=>S.chainKind!=="evm");return e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(H,{title:t("common:addressLookup.transactionsTitle"),onBack:s}),e.jsxs("div",{className:"flex-1 space-y-4 p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ds,{children:t("common:addressLookup.chain")}),e.jsxs(Hs,{value:a,onValueChange:r,children:[e.jsx(Us,{children:e.jsx(Js,{})}),e.jsxs(Vs,{children:[N.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:"EVM"}),N.map(S=>e.jsx(qt,{value:S.id,children:S.name},S.id))]}),w.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-muted-foreground px-2 py-1.5 text-xs font-medium",children:t("common:addressLookup.otherChains")}),w.map(S=>e.jsx(qt,{value:S.id,children:S.name},S.id))]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ds,{children:t("common:addressLookup.address")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Pe,{placeholder:t("common:addressLookup.addressPlaceholder"),value:o,onChange:S=>c(S.target.value),onKeyDown:x,className:"flex-1 font-mono text-sm"}),e.jsx($,{onClick:y,disabled:!o.trim()||f,children:f?e.jsx(ke,{className:"size-4 animate-spin"}):e.jsx(vs,{className:"size-4"})})]})]}),i&&e.jsx(Ya,{children:e.jsxs(Xa,{className:"pt-6",children:[f?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ke,{className:"size-6 animate-spin text-muted-foreground"})}):h?e.jsx("div",{className:"text-center py-8 text-destructive",children:t("common:addressLookup.queryError")}):v&&v.length>0?e.jsx("div",{className:"divide-y",children:v.map(S=>e.jsx(xb,{tx:S,address:i},S.hash))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:p?e.jsx("p",{children:t("common:addressLookup.noTransactions")}):e.jsx("p",{children:t("common:addressLookup.useExplorerHint")})}),b&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs($,{variant:p?"outline":"default",size:"sm",className:"w-full gap-2",onClick:j,children:[e.jsx(Yn,{className:"size-4"}),t("common:addressLookup.viewOnExplorer",{name:u?.name??a})]})})]})})]})]})}Wd.__docgenInfo={description:"",methods:[],displayName:"AddressTransactionsPage"};const $d=()=>e.jsx(Q,{children:e.jsx(Wd,{})});$d.__docgenInfo={description:"",methods:[],displayName:"AddressTransactionsActivity"};const{useFlow:V}=Op({transitionDuration:350,plugins:[Fp(),mh({theme:"cupertino"}),Ax({routes:{MainTabsActivity:"/",WalletListActivity:"/wallet/list",WalletConfigActivity:"/wallet/:walletId",WalletCreateActivity:"/wallet/create",SendActivity:"/send",DestroyActivity:"/destroy",ReceiveActivity:"/receive",SettingsActivity:"/settings",SettingsLanguageActivity:"/settings/language",SettingsCurrencyActivity:"/settings/currency",SettingsChainsActivity:"/settings/chains",SettingsMnemonicActivity:"/settings/mnemonic",SettingsWalletLockActivity:"/settings/wallet-lock",SettingsWalletChainsActivity:"/settings/wallet-chains",SettingsStorageActivity:"/settings/storage",HistoryActivity:"/history",TransactionDetailActivity:"/transaction/:txId",ScannerActivity:"/scanner",AuthorizeAddressActivity:"/authorize/address/:id",AuthorizeSignatureActivity:"/authorize/signature/:id",OnboardingRecoverActivity:"/onboarding/recover",TokenDetailActivity:"/token/:tokenId",AddressBookActivity:"/address-book",NotificationsActivity:"/notifications",StakingActivity:"/staking",WelcomeActivity:"/welcome",SettingsSourcesActivity:"/settings/sources",MiniappDetailActivity:"/miniapp/:appId/detail",AddressBalanceActivity:"/address-balance",AddressTransactionsActivity:"/address-transactions",ChainSelectorJob:"/job/chain-selector",WalletRenameJob:"/job/wallet-rename/:walletId",WalletDeleteJob:"/job/wallet-delete/:walletId",WalletLockConfirmJob:"/job/wallet-lock-confirm",TwoStepSecretConfirmJob:"/job/two-step-secret-confirm",SetTwoStepSecretJob:"/job/set-two-step-secret",MnemonicOptionsJob:"/job/mnemonic-options",ContactEditJob:"/job/contact-edit",ContactPickerJob:"/job/contact-picker",WalletAddJob:"/job/wallet-add",WalletListJob:"/job/wallet-list",SecurityWarningJob:"/job/security-warning",TransferConfirmJob:"/job/transfer-confirm",TransferWalletLockJob:"/job/transfer-wallet-lock",FeeEditJob:"/job/fee-edit",ScannerJob:"/job/scanner",ContactAddConfirmJob:"/job/contact-add-confirm",ContactShareJob:"/job/contact-share",ClearDataConfirmJob:"/job/clear-data-confirm",WalletPickerJob:"/job/wallet-picker",SigningConfirmJob:"/job/signing-confirm",PermissionRequestJob:"/job/permission-request",MiniappTransferConfirmJob:"/job/miniapp-transfer-confirm",MiniappDestroyConfirmJob:"/job/miniapp-destroy-confirm",MiniappSignTransactionJob:"/job/miniapp-sign-transaction",ChainSwitchConfirmJob:"/job/chain-switch-confirm"},fallbackActivity:()=>"MainTabsActivity",useHash:!0,urlPatternOptions:{segmentValueCharset:"a-zA-Z0-9-._~ %"}})],activities:{MainTabsActivity:wl,WalletListActivity:Sl,WalletConfigActivity:kl,WalletCreateActivity:Tl,SendActivity:El,DestroyActivity:Ml,ReceiveActivity:Dl,SettingsActivity:zl,SettingsLanguageActivity:Ll,SettingsCurrencyActivity:Fl,SettingsChainsActivity:Xl,SettingsMnemonicActivity:ed,SettingsWalletLockActivity:sd,SettingsWalletChainsActivity:Rd,SettingsStorageActivity:zd,HistoryActivity:ad,TransactionDetailActivity:id,ScannerActivity:cd,AuthorizeAddressActivity:ud,AuthorizeSignatureActivity:fd,OnboardingRecoverActivity:xd,TokenDetailActivity:vd,AddressBookActivity:yd,NotificationsActivity:wd,StakingActivity:Pd,WelcomeActivity:_d,SettingsSourcesActivity:Bd,MiniappDetailActivity:Ld,AddressBalanceActivity:Fd,AddressTransactionsActivity:$d,ChainSelectorJob:Hc,WalletRenameJob:Jc,WalletDeleteJob:Vc,WalletLockConfirmJob:Kc,TwoStepSecretConfirmJob:Gc,SetTwoStepSecretJob:Xc,MnemonicOptionsJob:Zc,ContactEditJob:el,ContactPickerJob:tl,WalletAddJob:sl,WalletListJob:nl,SecurityWarningJob:al,TransferConfirmJob:il,TransferWalletLockJob:cl,FeeEditJob:Yc,ScannerJob:ll,ContactAddConfirmJob:dl,ContactShareJob:ul,ClearDataConfirmJob:ml,WalletPickerJob:fl,SigningConfirmJob:pl,PermissionRequestJob:hl,MiniappTransferConfirmJob:xl,MiniappDestroyConfirmJob:bl,MiniappSignTransactionJob:yl,ChainSwitchConfirmJob:jl}});function gb(t,s){const n=Math.abs(t-s);return Math.min(n,360-n)}function vb(t,s,n=30){if(s.length===0)return 1;let a=180;for(const r of s){const o=gb(t,r);o<a&&(a=o)}return a<n?a/n:1}function bb(t){return Zd.map(s=>({...s,weight:vb(s.hue,t)}))}function In({mode:t,walletId:s,onEditOnlyComplete:n,className:a}){const{t:r}=L(["wallet","onboarding","common"]),{push:o}=V(),c=Pt(),i=c.find(z=>z.id===s),d=Ke(),u=_i(),[m,f]=l.useState(t==="edit-only"?"edit":t),[h,g]=l.useState(""),[v,p]=l.useState(0),b=l.useRef(null),[y,x]=l.useState(!1),j=l.useMemo(()=>c.filter(z=>z.id!==s).map(z=>z.themeHue),[c,s]),N=l.useMemo(()=>bb(j),[j]);l.useEffect(()=>{i&&(g(i.name),p(i.themeHue))},[i]);const w=l.useMemo(()=>i?.chainAddresses.find(z=>z.chain===d)??i?.chainAddresses[0],[i,d]),S=l.useCallback(z=>{if(!b.current)return;const q=b.current.getBoundingClientRect(),oe=Math.max(0,Math.min(z-q.left,q.width))/q.width,Y=Math.round(oe*3600)/10;p(Y)},[]),C=z=>{z.stopPropagation(),x(!0),S(z.clientX)},T=z=>{z.stopPropagation(),x(!0),z.touches[0]&&S(z.touches[0].clientX)};l.useEffect(()=>{if(!y)return;const z=oe=>S(oe.clientX),q=oe=>{oe.touches[0]&&S(oe.touches[0].clientX)},K=()=>x(!1);return document.addEventListener("mousemove",z),document.addEventListener("mouseup",K),document.addEventListener("touchmove",q),document.addEventListener("touchend",K),()=>{document.removeEventListener("mousemove",z),document.removeEventListener("mouseup",K),document.removeEventListener("touchmove",q),document.removeEventListener("touchend",K)}},[y,S]);const k=l.useCallback(()=>{o("ChainSelectorJob",{})},[o]),I=l.useCallback(()=>{i&&(g(i.name),p(i.themeHue)),f("edit")},[i]),D=l.useCallback(async()=>{if(!i)return;const z=h.trim();z&&z!==i.name&&await de.updateWalletName(i.id,z),v!==i.themeHue&&await de.updateWalletThemeHue(i.id,v),f("default")},[i,h,v]),_=l.useCallback(()=>{i&&(g(i.name),p(i.themeHue)),f("default")},[i]),A=l.useCallback(async()=>{if(!i)return;const z=h.trim();z&&z!==i.name&&await de.updateWalletName(i.id,z),v!==i.themeHue&&await de.updateWalletThemeHue(i.id,v),n?.()},[i,h,v,n]),R=l.useCallback(async()=>{i&&(await de.setCurrentWallet(i.id),o("SettingsMnemonicActivity",{}))},[i,o]),E=l.useCallback(()=>{i&&o("WalletDeleteJob",{walletId:i.id})},[i,o]);if(!i)return e.jsx("div",{className:M("text-muted-foreground p-4 text-center",a),children:r("wallet:detail.notFound")});const B=m==="edit"||t==="edit-only"?v:i.themeHue,P=m==="edit"||t==="edit-only";return e.jsxs("div",{className:M("space-y-6",a),children:[e.jsx("div",{className:"flex justify-center px-4",children:e.jsx("div",{className:"aspect-[1.6/1] w-full max-w-[360px]",children:e.jsx(Mi,{wallet:{...i,name:P?h:i.name,themeHue:B},themeHue:B,walletNameTestId:"wallet-config-preview-name",chain:w?.chain,chainName:w?.chain||"",address:w?.address||i.address,chainIconUrl:u[w?.chain??""],onOpenChainSelector:k})})}),P?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-muted-foreground text-sm",children:r("onboarding:theme.walletName")}),e.jsx(Pe,{value:h,onChange:z=>g(z.target.value),placeholder:r("wallet:defaultName"),maxLength:20,className:"text-center"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:r("onboarding:theme.customColor")}),e.jsxs("span",{className:"text-muted-foreground font-mono",children:[v.toFixed(1),""]})]}),e.jsxs("div",{ref:b,className:"relative h-8 cursor-pointer touch-none rounded-full",style:{background:"linear-gradient(to right, oklch(0.6 0.25 0), oklch(0.6 0.25 60), oklch(0.6 0.25 120), oklch(0.6 0.25 180), oklch(0.6 0.25 240), oklch(0.6 0.25 300), oklch(0.6 0.25 360))"},onMouseDown:C,onTouchStart:T,children:[j.map((z,q)=>e.jsx("div",{className:"absolute top-0 h-full w-0.5 bg-black/30",style:{left:`${z/360*100}%`},title:r("onboarding:theme.usedColor")},q)),e.jsx("div",{className:"absolute top-1/2 -translate-x-1/2 -translate-y-1/2",style:{left:`${v/360*100}%`},children:e.jsx("div",{className:"size-6 rounded-full border-2 border-white shadow-md",style:{backgroundColor:`oklch(0.6 0.25 ${v})`}})})]})]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-3",children:N.map(z=>{const q=Math.abs(v-z.hue)<.5,K=z.weight<.5;return e.jsx("button",{type:"button",onClick:()=>p(z.hue),className:M("relative size-10 rounded-full transition-all","ring-offset-background focus-visible:ring-ring focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:outline-none",q&&"ring-primary ring-2 ring-offset-2",K&&"opacity-50"),style:{backgroundColor:z.color},title:z.name,children:q&&e.jsx(fe,{className:"absolute inset-0 m-auto size-5 text-white drop-shadow-md"})},z.hue)})})]}),t==="edit-only"?e.jsx($,{className:"w-full",onClick:A,disabled:!h.trim(),"data-testid":"theme-complete-button",style:{"--primary-hue":v,"--primary":`oklch(var(--primary-lightness) var(--primary-saturation) ${v})`},children:r("common:confirm")}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx($,{variant:"outline",className:"flex-1",onClick:_,children:r("common:cancel")}),e.jsx($,{className:"flex-1",onClick:D,disabled:!h.trim(),style:{"--primary-hue":v,"--primary":`oklch(var(--primary-lightness) var(--primary-saturation) ${v})`},children:r("common:save")})]})]}):e.jsxs("div",{className:"flex justify-center gap-8",children:[e.jsxs("button",{onClick:I,className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"bg-primary/10 text-primary group-hover:bg-primary/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:e.jsx(sf,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:r("wallet:detail.editName")})]}),e.jsxs("button",{onClick:R,className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"bg-primary/10 text-primary group-hover:bg-primary/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:e.jsx(Ca,{className:"size-5"})}),e.jsx("span",{className:"text-xs font-medium",children:r("wallet:detail.exportMnemonic")})]}),e.jsxs("button",{onClick:E,className:"group flex flex-col items-center gap-1.5",children:[e.jsx("div",{className:"bg-destructive/10 text-destructive group-hover:bg-destructive/20 flex size-12 items-center justify-center rounded-full transition-all active:scale-95",children:e.jsx(Tt,{className:"size-5"})}),e.jsx("span",{className:"text-destructive text-xs font-medium",children:r("wallet:detail.deleteWallet")})]})]})]})}In.__docgenInfo={description:`
- default: + edit
- edit:  default  default
- edit-only: / onEditOnlyComplete`,methods:[],displayName:"WalletConfig",props:{mode:{required:!0,tsType:{name:"union",raw:"'edit-only' | 'default' | 'edit'",elements:[{name:"literal",value:"'edit-only'"},{name:"literal",value:"'default'"},{name:"literal",value:"'edit'"}]},description:""},walletId:{required:!0,tsType:{name:"string"},description:""},onEditOnlyComplete:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};export{bd as A,Yl as C,_l as D,Vm as I,Bl as L,Nd as N,Rl as R,ve as S,rd as T,Zl as V,In as W,Wd as a,nd as b,Oe as c,td as d,Ol as e,ts as f,Qa as g,Cl as h,es as n};
