import"./jsQR-DT4BPpM7.js";const m=/^0x[a-fA-F0-9]{40}$/,f=/^(1[a-zA-HJ-NP-Z1-9]{25,34}|3[a-zA-HJ-NP-Z1-9]{25,34}|bc1[a-zA-HJ-NP-Z0-9]{39,59})$/,y=/^T[a-zA-HJ-NP-Z1-9]{33}$/;function R(e){return m.test(e)?"ethereum":f.test(e)?"bitcoin":y.test(e)?"tron":"unknown"}function b(e){const t=e.replace("ethereum:",""),s=t.indexOf("?"),n=s>=0?t.slice(0,s):t,c=s>=0?t.slice(s+1):"",a=(n.split("/")[0]??"").split("@")[0]??"";if(!c)return{type:"address",chain:"ethereum",address:a};const i=new URLSearchParams(c),d=i.get("value")??void 0,u=i.get("data")??void 0,o=i.get("gasLimit")??i.get("gas")??void 0,p=i.get("gasPrice")??void 0,h=i.get("chainId"),g=h?parseInt(h,10):void 0;return d||u?{type:"payment",chain:"ethereum",address:a,amount:d,data:u,gasLimit:o,gasPrice:p,chainId:g}:{type:"address",chain:"ethereum",address:a}}function v(e){const t=e.replace("bitcoin:",""),s=t.indexOf("?"),n=s>=0?t.slice(0,s):t,c=s>=0?t.slice(s+1):"";if(!c)return{type:"address",chain:"bitcoin",address:n};const a=new URLSearchParams(c).get("amount");if(a){const i=Math.round(parseFloat(a)*1e8).toString();return{type:"payment",chain:"bitcoin",address:n,amount:i}}return{type:"address",chain:"bitcoin",address:n}}function x(e){const t=e.replace("tron:",""),s=t.indexOf("?"),n=s>=0?t.slice(0,s):t,c=s>=0?t.slice(s+1):"";if(!c)return{type:"address",chain:"tron",address:n};const r=new URLSearchParams(c),a=r.get("amount")??r.get("value")??void 0;return a?{type:"payment",chain:"tron",address:n,amount:a}:{type:"address",chain:"tron",address:n}}function l(e){if(e.startsWith("{")&&e.includes('"type":"contact"')){try{const o=JSON.parse(e);if(o.type==="contact"&&o.name&&Array.isArray(o.addresses)&&o.addresses.length>0)return{type:"contact",name:o.name,addresses:o.addresses.map(p=>({address:p.address,label:p.label||p.chainType||p.chain})),memo:o.memo,avatar:o.avatar}}catch{}return null}if(!e.startsWith("contact://"))return null;const t=e.replace("contact://",""),s=t.indexOf("?"),n=decodeURIComponent(s>=0?t.slice(0,s):t),c=s>=0?t.slice(s+1):"";if(!n)return null;const r=new URLSearchParams(c),a=[],i=r.get("eth");i&&m.test(i)&&a.push({address:i,label:r.get("eth_label")||"ETH"});const d=r.get("btc");d&&f.test(d)&&a.push({address:d,label:r.get("btc_label")||"BTC"});const u=r.get("trx");return u&&y.test(u)&&a.push({address:u,label:r.get("trx_label")||"TRX"}),a.length===0?null:{type:"contact",name:n,addresses:a,memo:r.get("memo")?decodeURIComponent(r.get("memo")):void 0,avatar:r.get("avatar")?decodeURIComponent(r.get("avatar")):void 0}}function P(e){return JSON.stringify({type:"contact",name:e.name,addresses:e.addresses.map(t=>({address:t.address,label:t.label})),avatar:e.avatar})}function I(e){let t=e;if(e.startsWith("http://")||e.startsWith("https://")){const i=e.indexOf("#");if(i===-1)return null;t=e.slice(i)}if(!t.startsWith("#/"))return null;const s=t.slice(1),n=s.indexOf("?"),c=n>=0?s.slice(0,n):s,r=n>=0?s.slice(n+1):"",a={};if(r){const i=new URLSearchParams(r);for(const[d,u]of i)a[d]=u}return{type:"deeplink",path:c,params:a,raw:e}}function A(e){const t=e.trim();if(t.startsWith("ethereum:"))return b(t);if(t.startsWith("bitcoin:"))return v(t);if(t.startsWith("tron:"))return x(t);if(t.startsWith("contact://")){const n=l(t);if(n)return n}if(t.startsWith("{")&&t.includes('"type":"contact"')){const n=l(t);if(n)return n}if(t.startsWith("#/")||t.startsWith("http")&&t.includes("#/")){const n=I(t);if(n)return n}const s=R(t);return s!=="unknown"?{type:"address",chain:s,address:t}:{type:"unknown",content:t}}export{P as g,A as p};
