import{g as N}from"./iframe-BuDZgClS.js";import{r as C}from"./nacl-fast-B5nUr3jS.js";function I(l,v){for(var o=0;o<v.length;o++){const x=v[o];if(typeof x!="string"&&!Array.isArray(x)){for(const i in x)if(i!=="default"&&!(i in l)){const s=Object.getOwnPropertyDescriptor(x,i);s&&Object.defineProperty(l,i,s.get?s:{enumerable:!0,get:()=>x[i]})}}}return Object.freeze(Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}))}var b={exports:{}},R=b.exports,j;function T(){return j||(j=1,(function(l){(function(v,o){l.exports?l.exports=o(C()):v.ed2curve=o(v.nacl)})(R,function(v){if(!v)throw new Error("tweetnacl not loaded");var o=function(n){var f,e=new Float64Array(16);if(n)for(f=0;f<n.length;f++)e[f]=n[f];return e},x=o(),i=o([1]),s=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),U=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function y(n){var f,e;for(e=0;e<16;e++)n[e]+=65536,f=Math.floor(n[e]/65536),n[(e+1)*(e<15?1:0)]+=f-1+37*(f-1)*(e===15?1:0),n[e]-=f*65536}function k(n,f,e){for(var r,c=~(e-1),t=0;t<16;t++)r=c&(n[t]^f[t]),n[t]^=r,f[t]^=r}function E(n,f){var e;for(e=0;e<16;e++)n[e]=f[2*e]+(f[2*e+1]<<8);n[15]&=32767}function w(n,f,e){var r;for(r=0;r<16;r++)n[r]=f[r]+e[r]|0}function g(n,f,e){var r;for(r=0;r<16;r++)n[r]=f[r]-e[r]|0}function u(n,f,e){var r,c,t=new Float64Array(31);for(r=0;r<31;r++)t[r]=0;for(r=0;r<16;r++)for(c=0;c<16;c++)t[r+c]+=f[r]*e[c];for(r=0;r<15;r++)t[r]+=38*t[r+16];for(r=0;r<16;r++)n[r]=t[r];y(n),y(n)}function d(n,f){u(n,f,f)}function O(n,f){var e=o(),r;for(r=0;r<16;r++)e[r]=f[r];for(r=253;r>=0;r--)d(e,e),r!==2&&r!==4&&u(e,e,f);for(r=0;r<16;r++)n[r]=e[r]}function p(n,f){var e,r,c,t=o(),a=o();for(e=0;e<16;e++)a[e]=f[e];for(y(a),y(a),y(a),r=0;r<2;r++){for(t[0]=a[0]-65517,e=1;e<15;e++)t[e]=a[e]-65535-(t[e-1]>>16&1),t[e-1]&=65535;t[15]=a[15]-32767-(t[14]>>16&1),c=t[15]>>16&1,t[14]&=65535,k(a,t,1-c)}for(e=0;e<16;e++)n[2*e]=a[e]&255,n[2*e+1]=a[e]>>8}function S(n){var f=new Uint8Array(32);return p(f,n),f[0]&1}function q(n,f,e,r,c){var t,a=0;for(t=0;t<c;t++)a|=n[f+t]^e[r+t];return(1&a-1>>>8)-1}function F(n,f,e,r){return q(n,f,e,r,32)}function A(n,f){var e=new Uint8Array(32),r=new Uint8Array(32);return p(e,n),p(r,f),F(e,0,r,0)}function D(n,f){var e=o(),r;for(r=0;r<16;r++)e[r]=f[r];for(r=250;r>=0;r--)d(e,e),r!==1&&u(e,e,f);for(r=0;r<16;r++)n[r]=e[r]}function M(n,f){var e;for(e=0;e<16;e++)n[e]=f[e]|0}function $(n,f){var e=o(),r=o(),c=o(),t=o(),a=o(),h=o(),_=o();return M(n[2],i),E(n[1],f),d(c,n[1]),u(t,c,s),g(c,c,n[2]),w(t,n[2],t),d(a,t),d(h,a),u(_,h,a),u(e,_,c),u(e,e,t),D(e,e),u(e,e,c),u(e,e,t),u(e,e,t),u(n[0],e,t),d(r,n[0]),u(r,r,t),A(r,c)&&u(n[0],n[0],U),d(r,n[0]),u(r,r,t),A(r,c)?-1:(S(n[0])===f[31]>>7&&g(n[0],x,n[0]),u(n[3],n[0],n[1]),0)}function K(n){var f=new Uint8Array(32),e=[o(),o(),o(),o()],r=o(),c=o();if($(e,n))return null;var t=e[1];return w(r,i,t),g(c,i,t),O(c,c),u(r,r,c),p(f,r),f}function m(n){var f=new Uint8Array(64),e=new Uint8Array(32),r;for(v.lowlevel.crypto_hash(f,n,32),f[0]&=248,f[31]&=127,f[31]|=64,r=0;r<32;r++)e[r]=f[r];for(r=0;r<64;r++)f[r]=0;return e}function z(n){var f=K(n.publicKey);return f?{publicKey:f,secretKey:m(n.secretKey)}:null}return{convertPublicKey:K,convertSecretKey:m,convertKeyPair:z}})})(b)),b.exports}var P=T();const Z=N(P),H=I({__proto__:null,default:Z},[P]);export{H as e};
