import{u as S,r as n,j as s}from"./iframe-CHpnNFF-.js";import{c as g}from"./utils-CDN07tui.js";import{S as _,a as z}from"./swiper-DK5F_JhY.js";import{u as Y,C as D}from"./swiper-sync-context-BVgHL61L.js";import{e as I,b as E,d as j,o as O}from"./index-DKgzbvrF.js";import{u as W}from"./useTranslation-Cn35rriq.js";import{c as B}from"./createReactComponent-BBuOTQib.js";import{I as N}from"./ecosystem-desktop-BIv-jvBj.js";import{a as R}from"./IconTrash-DhVV1Rgj.js";import{I as q}from"./IconWallet-DtaLI9AW.js";import{I as V}from"./IconSettings-DD94lZwD.js";const F=[["path",{d:"M19 4a3 3 0 0 1 3 3v10a3 3 0 0 1 -3 3h-14a3 3 0 0 1 -3 -3v-10a3 3 0 0 1 3 -3zm-12.99 3l-.127 .007a1 1 0 0 0 .117 1.993l.127 -.007a1 1 0 0 0 -.117 -1.993zm3 0l-.127 .007a1 1 0 0 0 .117 1.993l.127 -.007a1 1 0 0 0 -.117 -1.993z",key:"svg-0"}]],C=B("filled","app-window-filled","AppWindowFilled",F),k=["discover","mine","stack"],G={discover:R,mine:N,stack:C};function H(u,d){const i=u.length-1,{onSwiper:p,controlledSwiper:f}=Y("ecosystem-indicator","ecosystem-main"),a=n.useRef(null);n.useEffect(()=>{a.current&&(a.current.allowTouchMove=d)},[d]);const[h,v]=n.useState(0),y=i>0?h*i:0,b=t=>{const o=Math.abs(y-t);return Math.max(0,1-o)};return{icon:s.jsx(_,{className:"!w-15 !h-10 -my-2.5",modules:[D],controller:{control:f},onSwiper:t=>{a.current=t,p(t)},onProgress:(t,o)=>v(o),slidesPerView:"auto",centeredSlides:!0,spaceBetween:8,allowTouchMove:d,resistance:!0,resistanceRatio:.5,children:u.map((t,o)=>{const c=G[t],w=b(o);return s.jsx(z,{className:"!w-5 !flex !items-center !justify-center cursor-pointer",children:s.jsx(c,{className:g("size-5 transition-opacity duration-100",d?"text-primary":"text-muted-foreground"),style:{opacity:w},stroke:1.5})},t)})}),label:s.jsx("div",{className:"flex items-center justify-center gap-1 h-4",children:u.map((t,o)=>{const c=Math.round(y)===o;return s.jsx("span",{className:g("size-1 rounded-full transition-all duration-200",c?"bg-primary scale-125":"bg-muted-foreground/40")},t)})})}}function L({activeTab:u,onTabChange:d,className:T}){const{t:i}=W("common"),p=S(I,e=>e.activeSubPage),f=S(I,e=>e.availableSubPages),a=S(j,e=>E.getApps(e).length>0),h=S(j,E.hasRunningStackApps),v=u==="ecosystem",y=n.useMemo(()=>f?.length?f:h?k:k.filter(e=>e!=="stack"),[f,h]),b=H(y,v),t=n.useMemo(()=>p==="stack"||a?C:p==="mine"?N:R,[p,a]),o=n.useMemo(()=>[{id:"wallet",label:i("a11y.tabWallet"),icon:q},{id:"ecosystem",label:i("a11y.tabEcosystem","生态"),icon:t},{id:"settings",label:i("a11y.tabSettings"),icon:V}],[i,t]),c=n.useRef({startY:0,startTime:0}),w=30,M=.3,P=n.useCallback(e=>{const l=e.touches[0];l&&(c.current={startY:l.clientY,startTime:Date.now()})},[]),A=n.useCallback(e=>{const l=e.changedTouches[0];if(!l)return;const r=c.current.startY-l.clientY,x=Date.now()-c.current.startTime,m=r/x;a&&(r>w||m>M)&&(e.preventDefault(),O())},[a]);return s.jsx("div",{"data-testid":"tab-bar",className:g("fixed bottom-0 left-0 right-0 z-50","border-t bg-background/80 backdrop-blur-xl supports-[backdrop-filter]:bg-background/60","pb-[env(safe-area-inset-bottom)]",T),style:{height:"var(--tab-bar-height)"},children:s.jsx("div",{className:"mx-auto flex h-[52px] max-w-md",children:o.map(e=>{const l=e.icon,r=u===e.id,x=e.label,m=e.id==="ecosystem";return s.jsxs("button",{onClick:()=>d(e.id),onTouchStart:m?P:void 0,onTouchEnd:m?A:void 0,"data-testid":`tab-${e.id}`,className:g("flex flex-1 flex-col items-center justify-center gap-1 transition-colors",r?"text-primary":"text-muted-foreground"),"aria-label":x,"aria-current":r?"page":void 0,children:[s.jsxs("div",{className:"relative",children:[m?b.icon:s.jsx(l,{className:g("size-5",r&&"text-primary"),stroke:1.5}),m&&a&&!r&&s.jsx("span",{className:"absolute -top-0.5 -right-0.5 size-2 rounded-full bg-primary"})]}),m&&r?b.label:s.jsx("span",{className:"text-xs font-medium",children:x})]},e.id)})})})}L.__docgenInfo={description:"",methods:[],displayName:"TabBar",props:{activeTab:{required:!0,tsType:{name:"union",raw:'"wallet" | "ecosystem" | "settings"',elements:[{name:"literal",value:'"wallet"'},{name:"literal",value:'"ecosystem"'},{name:"literal",value:'"settings"'}]},description:""},onTabChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(tab: TabId) => void",signature:{arguments:[{type:{name:"union",raw:'"wallet" | "ecosystem" | "settings"',elements:[{name:"literal",value:'"wallet"'},{name:"literal",value:'"ecosystem"'},{name:"literal",value:'"settings"'}]},name:"tab"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};export{L as T};
