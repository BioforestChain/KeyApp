import{B as O}from"./polyfills-BATEtbik.js";import{N as P,O as H,Q as j,R as C,T as $,U as G,V as k,W as B,X as q,_ as f,o as a,j as r,s as e,n as t,p as A,r as x,m as U,e as N,S as F,g as K,Y as V,c as X}from"./page-BL_iZuG4.js";import{L,M as Y,f as z,T as J,t as Q,N as I,d as Z,O as ee}from"./index-15D1tlVU.js";const te=({url:n,onError:s,headers:l,disableBatch:d,loggerColor:c=typeof L=="object"&&Array.isArray(L.argv)&&L.argv.includes("--no-color")})=>P({links:[H({colorMode:c===!1?"none":void 0}),...s?[j({retry(o){return s&&s(Y(o,"op","error")),!1}})]:[],C({condition:o=>o.type==="subscription",true:q({url:n,eventSourceOptions:()=>({withCredentials:!0,headers:{}}),transformer:B}),false:C({condition:o=>k(o.input)||d===!0,true:G({url:n,headers:l?async o=>l(o.op):void 0,fetch:(o,T)=>fetch(new Request(o,{credentials:"include",...T})),transformer:{deserialize:B.deserialize,serialize(o){return k(o)?o:B.serialize(o)}}}),false:$({url:n,headers:l?async o=>l(o.opList):void 0,fetch:(o,T)=>fetch(new Request(o,{credentials:"include",...T})),transformer:B})})})]}),ae=z.toast;await z.loadModule(J);const re=async(n,s={open:!0,autoDestroy:!0})=>{const l=ae.create({text:n,position:s.position||"bottom",closeTimeout:s.closeTimeout||2e3,cssClass:s.cssClass||"!bg-primary"});s.autoDestroy&&l.once("closed",()=>{l.destroy()});let d;return l.on("open",()=>{d?.reject("open"),d=Promise.withResolvers()}),l.on("closed",()=>{d?.resolve(),d=void 0}),s.open&&l.open(),Q(l,{get closed(){return d?.promise}})},i=f(["Tron","Ethereum","Binance","BIWMeta","Malibu","BFMeta"]),u=f(["TRON","ETH","BSC","BIWMETA","BFMCHAIN","BFMCHAIN"]);i.enum.BIWMeta,i.enum.Malibu,i.enum.BFMeta,u.enum.BIWMETA,u.enum.BFMCHAIN,u.enum.BFMCHAIN;u.enum.BIWMETA+"",i.enum.BIWMeta,u.enum.BFMCHAIN+"",i.enum.BFMeta,u.enum.ETH+"",i.enum.Ethereum,u.enum.BSC+"",i.enum.Binance,u.enum.TRON+"",i.enum.Tron;const be={[i.enum.BIWMeta]:u.enum.BIWMETA,[i.enum.BFMeta]:u.enum.BFMCHAIN,[i.enum.Malibu]:u.enum.BFMCHAIN,[i.enum.Ethereum]:u.enum.ETH,[i.enum.Binance]:u.enum.BSC,[i.enum.Tron]:u.enum.TRON};a({uid:e(),superiorId:e(),beforeSuperiorIdList:A(a({superiorId:e(),time:t()})).optional(),address:e(),addressList:A(a({chainName:i,address:e()})),nickname:e(),mobile:e().optional(),level:t(),exp:t(),createTime:t(),token:e(),freeze:r().optional()});a({level:t(),exp:t()}).array();const ne=a({assetId:e(),priority:t().int(),configs:x(e(),U()).default({})});a({enableLevelUpCompositeDeduction:r(),priorityList:A(ne)});a({manualPaymentPendingMs:t().int().nonnegative()});a({promoted:r(),withdrawal:r(),signInRewardEnabled:r(),newUserRewardEnabled:r(),withdrawalAMGTDestory:r(),withdrawalByAMGTFromUSDT:r(),withdrawalAddAMGTFromUSDT:r(),withdrawalByAMGTFromBIW:r(),withdrawalAddAMGTFromBIW:r(),withdrawalBIWDestory:r(),withdrawalMLBDestory:r(),withdrawalByMLBFromUSDT:r(),withdrawalAddMLBFromUSDT:r(),withdrawalDEXTDestory:r(),withdrawalByDEXTFromUSDT:r(),withdrawalAddDEXTFromUSDT:r()});a({ratio:e().array().length(2),mini:t(),usdt2biw:e().array().length(2),usdt2amgt:e().array().length(2),usdt2mlb:e().array().length(2),usdt2dext:e().array().length(2),allowAutoUpdate:r(),autoUpdateThrottle:t(),lastAutoUpdateTime:t(),withdrawalLimit:A(t().array().length(2))});const se=a({usdt2tron:e().array().length(2),usdt2bsc:e().array().length(2),usdt2eth:e().array().length(2),usdt2biw:e().array().length(2),usdt2mlb:e().array().length(2),usdt2dext:e().array().length(2),usdt2amgt:e().array().length(2),usdt2biw_usdt:e().array().length(2),usdt2mlb_usdt:e().array().length(2),allowAutoUpdate:r(),autoUpdateThrottle:t(),lastAutoUpdateTime:t()}),oe=a({maxRelationshipLevel:t(),chainName:i,assetType:e(),token:e(),endpoint:e(),amountExpression:e(),matchs:x(e(),a({exp:e(),with:e(),result:e()}).array())});oe.array();a({relationshipLevel:t(),toLevel:t(),targetLevel:t()});const ie=f(["airdrop-freeze"]);a({title:e(),type:ie,enabled:r(),unfreezeEnabled:r(),rewards:A(a({chain:i,assetType:e(),amount:e()}))});const le=a({type:f(["success","error","warn","info"]),text:e(),time:t()}),ue=a({toAddress:e(),fromAddress:e(),amount:e(),timestamp:t(),trsInfo:a({chain:u,info:N([a({contractAddress:e(),trs:U()}),a({assetType:e(),trs:U()})])}),trsId:e()}),de=f(["idle","awaiting-payment","processing-deduction","succeeded","failed"]);a({tid:e(),fromUid:e(),toUid:e(),toLevel:t(),reqExp:t(),gotExp:t(),logs:le.array(),exchangeConfigSnapshot:se.omit({allowAutoUpdate:!0,autoUpdateThrottle:!0,lastAutoUpdateTime:!0}),pendingUntil:t().optional(),status:de.default("idle"),transactions:ue.array(),deductionAssetInfo:a({assetType:e(),chainName:i}).optional()});const R=f(["manual","fixed"]);a({id:e().uuid(),chain_name:i,asset_type:e().min(1),ratio_to_usdt:e().regex(/^\d+:\d+$/,"æ¯”ä¾‹æ ¼å¼å¿…é¡»ä¸º 'number:number'"),decimal:t().int().min(0).default(8),source:R,enabled:r().default(!0),remark:e().optional(),updated_at:t(),updated_by:e().optional()});a({id:e().uuid().optional(),chain_name:i,asset_type:e().min(1),ratio_to_usdt:e().regex(/^\d+:\d+$/,"æ¯”ä¾‹æ ¼å¼å¿…é¡»ä¸º 'number:number'"),decimal:t().int().min(0).default(8),source:R,enabled:r().default(!0),remark:e().optional()});const ce=async(n,s,l={})=>{const{transformer:d=JSON,storage:c=localStorage}=l,o=typeof s=="function"?s:()=>s,T=await(async()=>{let v,w=await c.getItem(n);if(w)try{v=d.parse(w)}catch(S){console.warn("useInfo_json parse error:",S,w)}let y;v==null?(y=o(),c.setItem(n,d.stringify(y))):y=v;let M=!1;return new Proxy(y,{get:function(S,b){return Reflect.get(y,b)},set:function(S,b,D){return Reflect.set(y,b,D),M===!1&&(M=!0,queueMicrotask(()=>{d.stringify(y)!==w&&h.emit(y),M=!1})),!0}})})(),h=new F(T);return h.on(v=>{const w=d.stringify(v);return w===void 0||w==="null"?c.removeItem(n):c.setItem(n,w)}),h},p=f(["Tron","Ethereum","Binance","BIWMeta"]),g=f(["TRON","ETH","BSC","BIWMETA"]);g.enum.BIWMETA+"",p.enum.BIWMeta,g.enum.ETH+"",p.enum.Ethereum,g.enum.BSC+"",p.enum.Binance,g.enum.TRON+"",p.enum.Tron;p.enum.BIWMeta+"",g.enum.BIWMETA,p.enum.Ethereum+"",g.enum.ETH,p.enum.Binance+"",g.enum.BSC,p.enum.Tron+"",g.enum.TRON;a({uid:e(),superiorId:e(),address:e(),addressList:A(a({chainName:p,address:e()})),nickname:e(),mobile:e().optional(),level:t(),exp:t(),createTime:t(),token:e(),freeze:r().optional()});a({level:t(),exp:t()}).array();a({promoted:r(),withdrawal:r(),withdrawalAMGTDestory:r(),withdrawalByAMGTFromUSDT:r(),withdrawalAddAMGTFromUSDT:r(),withdrawalByAMGTFromBIW:r(),withdrawalAddAMGTFromBIW:r(),withdrawalBIWDestory:r()});a({ratio:e().array().length(2),mini:t(),usdt2biw:e().array().length(2),usdt2amgt:e().array().length(2),allowAutoUpdate:r(),autoUpdateThrottle:t(),lastAutoUpdateTime:t()});const me=a({usdt2tron:e().array().length(2),usdt2bsc:e().array().length(2),usdt2eth:e().array().length(2),usdt2biw:e().array().length(2),usdt2amgt:e().array().length(2),usdt2biw_usdt:e().array().length(2),allowAutoUpdate:r(),autoUpdateThrottle:t(),lastAutoUpdateTime:t()}),pe=a({maxRelationshipLevel:t(),chainName:p,assetType:e(),token:e(),endpoint:e(),amountExpression:e(),matchs:x(e(),a({exp:e(),with:e(),result:e()}).array())});pe.array();a({relationshipLevel:t(),toLevel:t(),targetLevel:t()});const ge=a({type:f(["success","error","warn","info"]),text:e(),time:t()}),fe=a({toAddress:e(),fromAddress:e(),amount:e(),timestamp:t(),trsInfo:a({chain:g,info:N([a({contractAddress:e(),trs:U()}),a({assetType:e(),trs:U()})])}),trsId:e()});a({tid:e(),fromUid:e(),toUid:e(),toLevel:t(),reqExp:t(),gotExp:t(),logs:ge.array(),exchangeConfigSnapshot:me.omit({allowAutoUpdate:!0,autoUpdateThrottle:!0,lastAutoUpdateTime:!0}),transactions:fe.array()});const he=I(),Le=I(),xe=I(),_e=I(),Ce=I(),we=I(),ke=I(),W="ðŸ‘¨â€ðŸ‘©â€ðŸ‘¦â€ðŸ‘¦appUserInfo",ye="ðŸ‘¨â€ðŸ‘©â€ðŸ‘¦â€ðŸ‘¦appUserMain",_="ðŸ‘¨â€ðŸ‘©â€ðŸ‘¦â€ðŸ‘¦external_user_id",m=await ce(W,()=>({uid:"",superiorId:"",address:"",addressList:[],nickname:"",mobile:"",level:0,exp:0,createTime:0,token:"",rwaExp:"0"})),Te=async n=>{if(n==m.value.uid){const s=await E.user.getUserInfo.query(),l=await K().trpcClient.profile.getProfileUseExp.query(Ae());if(s.level-1>=0){const c=(await E.user.getLevelUpTasks.query()).find(o=>o.toLevel==s.level);if(c){const o=c.logs.find(h=>h.type==="success"),T=c.logs.find(h=>h.type==="info"&&h.text=="upgrade confirmation");o&&!T&&(he.emit(s.level),await E.user.addLogToLevelUp.mutate({tid:c.tid,type:"info",text:"upgrade confirmation"}))}}return console.log("get User",s),s?.uid==m.value.uid?(Object.assign(m.value,{...s,rwaExp:l}),localStorage.setItem(W,JSON.stringify(m.value)),m.emit(m.value),!0):!1}return!1};(async()=>{for(;;){await Z(3e4);const n=m.value;n.uid&&await Te(n.uid)}})();const Ie=new F({expired:!1}),Ae=()=>localStorage.getItem(_)||"",Ne=n=>(localStorage.setItem(_,n),n),Fe=()=>{localStorage.removeItem("rwa-app-token"),localStorage.removeItem(ye),localStorage.removeItem(_),V(),m.value={uid:"",superiorId:"",createTime:0,address:"",addressList:[],nickname:"",mobile:"",level:0,exp:0,token:""},m.emit(m.value),we.emit(!0)},E=te({url:new URL("trpc","https://inviteapi.bfmeta.info/").href,headers:()=>{const n=localStorage.getItem("rwa-app-token");return n?{Authorization:`Bearer ${n}`}:{}},onError(n){if(n.error?.message||n.error.shape?.message){const s=n.error?.message||n.error.shape?.message;s==="ç™»å½•å·²è¿‡æœŸ"&&(Ie.value={expired:!0}),s&&re(s)}}}),ve=ee(()=>E.login.signcodePublicKey.query()),ze=async n=>{const s=O.from(`${Date.now()}`),l=await ve();return await X.signUtil.asymmetricEncrypt(s,l,n)};export{ye as S,Ae as a,m as b,Fe as c,E as d,we as e,Le as f,ze as g,be as h,ke as i,_e as j,xe as k,Ie as l,Ce as m,he as o,Ne as s,re as t,Te as u,i as z};
