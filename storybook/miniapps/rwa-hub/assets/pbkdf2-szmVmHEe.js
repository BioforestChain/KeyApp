import{c as m}from"./hmac-V5N88g4C.js";import{g as I,a as U}from"./WASMInterface-BB6uMQo8.js";function g(e,t,b,r,d){const u=new Uint8Array(r),c=new Uint8Array(t.length+4),w=new DataView(c.buffer),o=I(t),y=new Uint8Array(o.buffer,o.byteOffset,o.length);c.set(y);let f=0;const h=e.digestSize,p=Math.ceil(r/h);let a,i;for(let n=1;n<=p;n++){w.setUint32(t.length,n),e.init(),e.update(c),a=e.digest("binary"),i=a.slice();for(let l=1;l<b;l++){e.init(),e.update(i),i=e.digest("binary");for(let s=0;s<h;s++)a[s]^=i[s]}u.set(a.subarray(0,r-f),f),f+=h}if(d==="hex"){const n=new Uint8Array(r*2);return U(n,u,r)}return u}const v=e=>{if(!e||typeof e!="object")throw new Error("Invalid options parameter. It requires an object.");if(!Number.isInteger(e.iterations)||e.iterations<1)throw new Error("Iterations should be a positive number");if(!Number.isInteger(e.hashLength)||e.hashLength<1)throw new Error("Hash length should be a positive number");if(e.outputType===void 0&&(e.outputType="binary"),!["hex","binary"].includes(e.outputType))throw new Error(`Insupported output type ${e.outputType}. Valid values: ['hex', 'binary']`)},E=async e=>{const t=await e.hashFunction;if(!t)throw new Error('Invalid hash function is provided! Usage: pbkdf2("password", "salt", 1000, 32, createSHA1()).');return k({...e,hashFunction:t})},k=e=>{if(!e.hashFunction)throw new Error('Invalid hash function is provided! Usage: pbkdf2Sync("password", "salt", 1000, 32, createSHA1Sync()).');v(e);const t=m(e.hashFunction,e.password);return g(t,e.salt,e.iterations,e.hashLength,e.outputType)};export{E as a,k as p};
