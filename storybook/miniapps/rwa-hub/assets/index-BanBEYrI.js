import{p as B,a as T}from"./pbkdf2-CsemIPQR.js";import{c as I}from"./sha256-ee5_68YR.js";import{c as g,a as k}from"./sha512-DZTP63bZ.js";import{B as e,a as N}from"./bioforestChainBundle-CAVzb9HK.js";import{getDefaultWordlist as l}from"./wordlists-BoecE3r7.js";import"./hmac-CMC3_Bam.js";import"./WASMInterface-CIe9o4E6.js";import"./page-BL_iZuG4.js";import"./index-15D1tlVU.js";import"./polyfills-BATEtbik.js";const x=(n,t,r,o,i)=>{const c=B({hashFunction:g(),password:n,salt:t,iterations:r,hashLength:o,outputType:"binary"});return e.from(c)},A=async(n,t,r,o,i)=>{const c=await T({hashFunction:k(),password:n,salt:t,iterations:r,hashLength:o,outputType:"binary"});return e.from(c)},C=n=>I().update(n).digest(),p="Invalid mnemonic",u="Invalid entropy",D="Invalid mnemonic checksum",d=`A wordlist is required but a default could not be found.
Please pass a 2048 word array explicitly.`;function f(n){return(n||"").normalize("NFKD")}function y(n){return parseInt(n,2)}function w(n){let t="";for(let r=0;r<n.length;r++){const o=n[r];t+=o.toString(2).padStart(8,"0")}return t}function E(n){const r=n.length*8/32,o=C(n);return w(o).slice(0,r)}function S(n){return"mnemonic"+(n||"")}function U(n,t){const r=e.from(f(n),"utf8"),o=e.from(S(f(t)),"utf8");return x(r,o,2048,64)}function W(n,t){const r=e.from(f(n),"utf8"),o=e.from(S(f(t)),"utf8");return A(r,o,2048,64)}function M(n,t){if(t=t||l()?.wordlist,!t)throw new Error(d);const r=f(n).split(" ");if(r.length%3!==0)throw new Error(p);const o=r.map(b=>{const h=t.indexOf(b);if(h===-1)throw new Error(p);return h.toString(2).padStart(11,"0")}).join(""),i=Math.floor(o.length/33)*32,c=o.slice(0,i),a=o.slice(i),s=c.match(/(.{1,8})/g).map(y);if(s.length<16)throw new Error(u);if(s.length%4!==0)throw new Error(u);const m=e.from(s);if(E(m)!==a)throw new Error(D);return m.toString("hex")}function v(n,t){if(e.isBuffer(n)||(n=e.from(n,"hex")),t=t||l()?.wordlist,!t)throw new Error(d);if(n.length<16)throw new TypeError(u);if(n.length%4!==0)throw new TypeError(u);const r=w(Array.from(n)),o=E(n),a=(r+o).match(/(.{1,11})/g).map(s=>{const m=y(s);return t[m]});return t[0]==="あいこくしん"?a.join("　"):a.join(" ")}function $(n,t=N,r){if(n=n||128,n%32!==0)throw new TypeError(u);return v(e.from(t(n/8)),r)}function q(n,t){try{M(n,t)}catch{return!1}return!0}export{v as entropyToMnemonic,$ as generateMnemonic,M as mnemonicToEntropy,W as mnemonicToSeed,U as mnemonicToSeedSync,f as normalize,q as validateMnemonic};
