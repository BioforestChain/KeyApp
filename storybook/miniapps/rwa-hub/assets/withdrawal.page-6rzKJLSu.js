import{r as m,j as e,f as F}from"./index-AshhoVut.js";import{N as X}from"./icon.component-Bbnu8uvo.js";import{P as U}from"./preloader-Cr80DtbA.js";import{C as z,A as Y}from"./nilai-dialog-Dbtzo5f5.js";import{O as k,P as C,Q as Z,R as L,S as G,U as H,V as J,W as K,X as T,M as tt,Y as et,Z as st,_ as it,a0 as rt}from"./messages-D1uWWbBR.js";import{u as at}from"./use_flow-Buvyb0TW.js";import{B as A}from"./dialog-w37VgwE_.js";import{L as nt}from"./input-BIdqiBhy.js";import{L as x}from"./list-item-C_pVthwN.js";import{N as ot,a as lt}from"./navbar-CWXVbsHK.js";import{d as mt,P as ut}from"./page-BnBmgj2e.js";import{u as dt}from"./use_refresh-BXPRqJ_V.js";import{B as o}from"./big-Dt19vo1Q.js";import{L as ct}from"./list-DOTUY-rD.js";import{d as D,t as p,k as ht,b as ft}from"./dex-api-WCaY78Dk.js";import"./use_easy_state-BCfQ0rqw.js";import"./list-DTz1iW3n.js";const Dt=mt(({chainName:c,assetType:a,decimals:i,amount:v,...w})=>{const[P]=at(ft),[R,$]=m.useState(!0),[W,q]=m.useState(!1),[y,j]=m.useState(!1),[h,_]=m.useState(""),[u,E]=m.useState(""),[f,g]=m.useState(""),I=m.useRef({ratio:["5","100"],mini:.5,usdt2biw:["1","1"],usdt2amgt:["1","1"],usdt2mlb:["10","1"],usdt2dext:["1","10"],withdrawalLimit:[[0,100],[60,100],[65,100],[70,100],[75,100],[80,100],[85,100],[90,100],[95,100],[100,100]]}),d=(t,s)=>{const r=new o(t);return S(r.div(Math.pow(10,s)).toFixed(18),s)};function S(t,s=8,r=!1){const[l,n=""]=String(t).split("."),B=n.slice(0,s),N=B.length>0?`${l}.${B}`:l;return r?N:N.replace(/(?:\.0*|(\.\d+?)0+)$/,"$1")}m.useEffect(()=>{D.admin.getWithdrawalConfig.query().then(t=>{if($(!1),I.current=t,a==="BFM"){const s=String(o(t.mini).div(t.usdt2mlb[0]).mul(t.usdt2mlb[1]).mul(10**i)).split(".")[0];_(d(s,i))}else if(a==="DEXT"){const s=String(o(t.mini).div(t.usdt2dext[0]).mul(t.usdt2dext[1]).mul(10**i)).split(".")[0];_(d(s,i))}else _(String(t.mini))}).catch(t=>{throw p(String(t?.message||t)),t})},[]);const M=t=>{const s=I.current;if(!t||isNaN(+t))g("");else{t=o(t).mul(10**i).toString().split(".")[0];const r=BigInt(t)*BigInt(s.ratio[0])/BigInt(s.ratio[1]);let l="0";if(a==="BFM"){const n=BigInt(String(o(s.mini).div(s.usdt2mlb[0]).mul(s.usdt2mlb[1]).mul(10**i)).split(".")[0]);l=n>r?n.toString():r.toString(),g(l)}else if(a==="DEXT"){const n=BigInt(String(o(s.mini).div(s.usdt2dext[0]).mul(s.usdt2dext[1]).mul(10**i)).split(".")[0]);l=n>r?n.toString():r.toString(),g(l)}else{const n=BigInt(o(s.mini).mul(1e8).toString());l=n>r?n.toString():r.toString(),g(l)}}},O=async()=>{F.preloader.show();try{await D.user.withdrawal.mutate({chainName:c,assetType:a,amount:o(u).mul(10**i).toString().split(".")[0]}),j(!1),ht.emit({success:!0}),p(rt()),w.safeF7Navigater.withdrawalList({props:{assetType:a,chainName:c},reloadCurrent:!0})}finally{F.preloader.hide()}},Q=dt(),b=t=>{let s=t?S(t,i,!0):"";if(s){const r=d(v,i);o(r).lt(s)&&(s=r),s=S(s,8,!0)}M(s),E(s),Q()},V=t=>{const s=(t.target?.value||"").trim();b(s)};return e.jsxs(ut,{name:"withdrawal",style:{"--f7-toolbar-bottom-height":"3.25rem"},children:[e.jsx(ot,{title:k(),backLink:!0,children:e.jsx(lt,{children:e.jsx("div",{onClick:()=>{w.safeF7Navigater.withdrawalList({props:{assetType:a,chainName:c}})},children:e.jsx(X,{className:"icon-7",name:"common-order"})})})}),e.jsx("div",{className:"bg-gray min-h-full w-full pt-5",children:R?e.jsx(U,{size:32,className:"mx-auto mt-0 !block",color:"black"}):e.jsxs(e.Fragment,{children:[e.jsxs(ct,{strongIos:!0,dividersIos:!0,insetIos:!0,className:"mt-0",children:[e.jsxs(nt,{type:"number",value:u,placeholder:C(),onChange:V,children:[e.jsxs("div",{slot:"label",className:"text-text",children:[Z(),h&&e.jsxs(e.Fragment,{children:["(",L({amount:h,assetType:a}),")"]})]}),e.jsx(A,{slot:"input",className:"text-gradient absolute right-0 top-1",onClick:()=>b(d(v,i)),children:G()})]}),e.jsxs(x,{children:[e.jsx("div",{slot:"header",className:"text-text",children:H()}),e.jsxs("div",{slot:"title",children:[f?d(f,i):"--"," ",e.jsx("span",{className:"text-sm",children:a})]})]}),e.jsx(x,{title:c,children:e.jsx("div",{slot:"header",className:"text-text",children:J()})}),e.jsx(x,{title:a,children:e.jsx("div",{slot:"header",className:"text-text",children:K()})}),e.jsxs(x,{children:[e.jsx("div",{slot:"header",className:"text-text",children:T()}),e.jsx("div",{slot:"title",className:"text-wrap break-all",children:P.addressList.find(t=>t.chainName===c)?.address})]})]}),e.jsx(A,{className:"mx-5 bg-primary py-5 text-lg !text-white",onClick:()=>{if(!u||isNaN(+u)){p(C());return}if(+u<=+h){p(L({amount:h,assetType:a}));return}j(!0)},children:k()})]})}),e.jsxs(z,{open:y,title:et(),confirmText:tt(),onRequireClose:()=>{j(!1)},onConfirmCallback:()=>O(),children:[u&&f&&o(u).minus(d(f,i)).toString()," ",a]}),e.jsx(Y,{open:W,onRequireClose:()=>{q(!1),w.f7router.back()},title:it(),children:st()})]})});export{Dt as default};
