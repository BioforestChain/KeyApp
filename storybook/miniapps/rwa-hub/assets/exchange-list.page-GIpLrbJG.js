import{r as m,j as e}from"./index-15D1tlVU.js";import"./pull-to-refresh-BMqB5p-4.js";import{N as p}from"./navbar-DAOi6kaL.js";import{d as h,P as g,g as u}from"./page-BL_iZuG4.js";import{g as b,a as j}from"./icon.component-DqZ9lCdm.js";import{L as N}from"./loading-page-data-CCKDne7Y.js";import{N as v}from"./no-data-CDzRffdr.js";import"./organization-profile.model-CAD2aKmP.js";import{f as x,a as d}from"./asset-type-balance-BGw1Ilcq.js";import{f as y}from"./date-time-format-CBKMROy6.js";import{u as _}from"./use_easy_state-D4HEqK2h.js";import{u as w}from"./use_page_query_state-DR-eHdQu.js";import{u as P}from"./use_refresh-BOPBhM6q.js";import{g as I}from"./setting.page-DIHCe7FA.js";import"./messages-T-UDpzuG.js";import"./polyfills-BATEtbik.js";import"./preloader-DItl4yqJ.js";import"./dex-api-54xdAOHY.js";import"./big-Dt19vo1Q.js";import"./dialog-DgNFENJS.js";import"./nilai-dialog-YTWh9anD.js";import"./use_flow-CkeMNJ0N.js";import"./list-item-CsDeqkSQ.js";import"./list-C2Pi8W4W.js";import"./noop-ChEnm3CV.js";const Z=h(a=>{_("all");const c=m.useRef({el:null});P();const l=u(),i=w([],1,async(s,n)=>{const r=await l.trpcClient.exchange.getUserExchangeList.query({page:n,pageSize:20});s.push(...r.data.map(f=>({...f,showMoreInfo:!1})));const o=s;return{content:o,nextPage:n+1,end:o.length>=r.total}});m.useEffect(()=>{i.loadFirst()},[]);const t=async s=>{await i.loadFirst(),i.onPtrRefresh(s)};return e.jsxs(g,{name:"exchange-list",style:{"--f7-page-toolbar-bottom-offset":"0"},ref:c,...i.f7PagePtrProps,onPtrRefresh:t,...i.f7PageInfiniteProps,children:[e.jsx(p,{title:"我的兑换",className:"text-white !filter-none",backLink:!0,color:"white",style:{"--f7-bars-bg-color-rgb":"100,15,243","--f7-bars-border-color":"transparent"}}),e.jsx("div",{className:"min-h-full bg-white p-4 pb-[5rem]",children:i.render({loading:()=>e.jsx(N,{}),listEmpty:()=>e.jsx(v,{}),listItem:(s,n,r)=>e.jsx("div",{className:"mb-3",onClick:()=>{a.safeF7Navigater.exchangeDetail({props:{id:s.id}})},children:e.jsx(D,{userExchange:s,...a})},s.id)})})]})}),D=({userExchange:a,hideTips:c,safeF7Navigater:l,...i})=>{const t=a.exchangeInfo;let s="";const n=I();let r="bg-primary text-white";const o=Date.now();return t.start_at&&t.start_at<o&&t.end_at&&t.end_at<o&&(s="失败",r="text-white bg-red"),a.status=="success"&&(s="已完成",r="text-primary border-primary border-tiny border-solid"),a.status=="untreated"&&(s="确认中"),e.jsxs("div",{className:"card_bg bg-gray rounded-4 p-4",children:[e.jsxs("div",{className:"mb-4 flex items-center text-sm",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:b(t.exchange_info.asset_type,t.exchange_info.chainName),alt:"",className:"h-9 w-9"}),e.jsx("img",{src:j(t.exchange_info.chainName),alt:"",className:"absolute -bottom-1 -right-0.5 h-5 w-5"})]}),e.jsxs("div",{className:"ml-2",children:[e.jsx("div",{className:"text-base font-bold text-title",children:t.exchange_info.asset_type}),e.jsx("div",{className:"text-xs text-subtext",children:t.exchange_info.chainName})]}),!c&&e.jsx("div",{className:"ml-auto flex items-center justify-end",children:e.jsx("span",{className:`rounded-full px-4 py-1.5 ${r}`,children:s})})]}),e.jsxs("div",{className:"mb-2 flex items-center justify-between text-text",children:[e.jsx("div",{children:"兑换费用"}),e.jsxs("div",{className:"text-title",children:[x(d(String(BigInt(t.exchange_info.price2U??"0")*BigInt(a.quantity)),8,n)),"USDT(",t.exchange_info.chainName,")"]})]}),e.jsxs("div",{className:"mb-2 flex items-center justify-between text-text",children:[e.jsx("div",{children:"兑换数量"}),e.jsxs("div",{className:"text-title",children:[x(d(String(BigInt(t.exchange_info.amount)*BigInt(a.quantity)),8,n)),t.exchange_info.asset_type]})]}),e.jsxs("div",{className:"mb-2 flex items-center justify-between text-text",children:[e.jsx("div",{children:"兑换时间"}),e.jsx("div",{className:"text-title",children:y(a.created_at)})]}),e.jsxs("div",{className:"mb-2 flex items-center justify-between text-text",children:[e.jsx("div",{children:"兑换ID"}),e.jsx("div",{className:"text-xs text-subtext",children:a.id})]})]})};export{D as UserExchangeItem,Z as default};
