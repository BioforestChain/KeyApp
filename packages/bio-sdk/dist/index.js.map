{"version":3,"file":"index.js","sources":["../src/types.ts","../src/events.ts","../src/provider.ts","../src/ethereum-provider.ts","../src/tron-provider.ts","../src/chain-id.ts","../src/index.ts"],"sourcesContent":["/**\n * Bio SDK Types\n * EIP-1193 style provider interface for Bio ecosystem\n */\n\n/** Account information */\nexport interface BioAccount {\n  address: string\n  chain: string\n  name?: string\n  /** Public key (hex encoded) */\n  publicKey: string\n}\n\n/** Transfer parameters */\nexport interface TransferParams {\n  from: string\n  to: string\n  amount: string\n  chain: string\n  asset?: string\n}\n\n/** Unsigned transaction payload (chain-specific) */\nexport interface BioUnsignedTransaction {\n  chainId: string\n  data: unknown\n}\n\n/** Signed transaction payload (chain-specific) */\nexport interface BioSignedTransaction {\n  chainId: string\n  data: unknown\n  signature: string\n}\n\n/** Provider request arguments */\nexport interface RequestArguments {\n  method: string\n  params?: unknown[]\n}\n\n/** Provider RPC error */\nexport interface ProviderRpcError extends Error {\n  code: number\n  data?: unknown\n}\n\n/** Event handler type */\nexport type EventHandler<T = unknown> = (...args: T[]) => void\n\n/**\n * Bio Provider Interface (EIP-1193 style)\n */\nexport interface BioProvider {\n  /** Make a request to the provider */\n  request<T = unknown>(args: RequestArguments): Promise<T>\n\n  /** Subscribe to an event */\n  on(event: string, handler: EventHandler): void\n\n  /** Unsubscribe from an event */\n  off(event: string, handler: EventHandler): void\n\n  /** Check if connected */\n  isConnected(): boolean\n}\n\n/**\n * Bio method definitions\n */\nexport interface BioMethods {\n  /** Request wallet accounts (shows connection UI) */\n  bio_requestAccounts: () => Promise<BioAccount[]>\n\n  /** Get connected accounts (no UI) */\n  bio_accounts: () => Promise<BioAccount[]>\n\n  /** Select an account (shows account picker UI) */\n  bio_selectAccount: (opts?: { chain?: string }) => Promise<BioAccount>\n\n  /** Pick another wallet address (shows wallet picker UI) */\n  bio_pickWallet: (opts?: { chain?: string; exclude?: string }) => Promise<BioAccount>\n\n  /** Sign a message, returns signature and public key (hex) */\n  bio_signMessage: (params: { message: string; address: string }) => Promise<{ signature: string; publicKey: string }>\n\n  /** Sign typed data, returns signature and public key (hex) */\n  bio_signTypedData: (params: { data: object; address: string }) => Promise<{ signature: string; publicKey: string }>\n\n  /** Create an unsigned transaction (no signature, no broadcast) */\n  bio_createTransaction: (params: TransferParams) => Promise<BioUnsignedTransaction>\n\n  /** Sign an unsigned transaction (requires user confirmation) */\n  bio_signTransaction: (params: { from: string; chain: string; unsignedTx: BioUnsignedTransaction }) => Promise<BioSignedTransaction>\n\n  /** Send a transaction */\n  bio_sendTransaction: (params: TransferParams) => Promise<{ txHash: string }>\n\n  /** Get current chain ID */\n  bio_chainId: () => Promise<string>\n\n  /** Get balance */\n  bio_getBalance: (params: { address: string; chain: string }) => Promise<string>\n\n  /** Close splash screen (indicates app is ready) */\n  bio_closeSplashScreen: () => Promise<void>\n}\n\n/**\n * Bio event definitions\n */\nexport interface BioEvents {\n  /** Emitted when accounts change */\n  accountsChanged: (accounts: BioAccount[]) => void\n\n  /** Emitted when chain changes */\n  chainChanged: (chainId: string) => void\n\n  /** Emitted when connected */\n  connect: (info: { chainId: string }) => void\n\n  /** Emitted when disconnected */\n  disconnect: (error: { code: number; message: string }) => void\n}\n\n/** Method names */\nexport type BioMethodName = keyof BioMethods\n\n/** Event names */\nexport type BioEventName = keyof BioEvents\n\n/** RPC error codes */\nexport const BioErrorCodes = {\n  USER_REJECTED: 4001,\n  UNAUTHORIZED: 4100,\n  UNSUPPORTED_METHOD: 4200,\n  DISCONNECTED: 4900,\n  CHAIN_DISCONNECTED: 4901,\n  INTERNAL_ERROR: -32603,\n  INVALID_PARAMS: -32602,\n  METHOD_NOT_FOUND: -32601,\n} as const\n\n/** Create a provider RPC error */\nexport function createProviderError(code: number, message: string, data?: unknown): ProviderRpcError {\n  const error = new Error(message) as ProviderRpcError\n  error.code = code\n  error.data = data\n  return error\n}\n","/**\n * Event emitter for Bio SDK\n */\n\nimport type { EventHandler } from './types'\n\nexport class EventEmitter {\n  private handlers = new Map<string, Set<EventHandler>>()\n\n  on(event: string, handler: EventHandler): void {\n    let handlers = this.handlers.get(event)\n    if (!handlers) {\n      handlers = new Set()\n      this.handlers.set(event, handlers)\n    }\n    handlers.add(handler)\n  }\n\n  off(event: string, handler: EventHandler): void {\n    const handlers = this.handlers.get(event)\n    if (handlers) {\n      handlers.delete(handler)\n      if (handlers.size === 0) {\n        this.handlers.delete(event)\n      }\n    }\n  }\n\n  emit(event: string, ...args: unknown[]): void {\n    const handlers = this.handlers.get(event)\n    if (handlers) {\n      handlers.forEach((handler) => {\n        try {\n          handler(...args)\n        } catch (error) {\n          console.error(`[BioSDK] Error in event handler for \"${event}\":`, error)\n        }\n      })\n    }\n  }\n\n  removeAllListeners(event?: string): void {\n    if (event) {\n      this.handlers.delete(event)\n    } else {\n      this.handlers.clear()\n    }\n  }\n}\n","/**\n * Bio Provider Implementation\n * Communicates with KeyApp host via postMessage\n */\n\nimport type { BioProvider, RequestArguments, EventHandler } from './types'\nimport { BioErrorCodes, createProviderError } from './types'\nimport { EventEmitter } from './events'\n\n/** Message sent to host */\ninterface RequestMessage {\n  type: 'bio_request'\n  id: string\n  method: string\n  params?: unknown[]\n}\n\n/** Response from host */\ninterface ResponseMessage {\n  type: 'bio_response'\n  id: string\n  success: boolean\n  result?: unknown\n  error?: { code: number; message: string; data?: unknown }\n}\n\n/** Event from host */\ninterface EventMessage {\n  type: 'bio_event'\n  event: string\n  args: unknown[]\n}\n\ntype HostMessage = ResponseMessage | EventMessage\n\nexport class BioProviderImpl implements BioProvider {\n  private events = new EventEmitter()\n  private pendingRequests = new Map<string, {\n    resolve: (value: unknown) => void\n    reject: (error: Error) => void\n  }>()\n  private requestIdCounter = 0\n  private connected = false\n  private readonly targetOrigin: string\n\n  constructor(targetOrigin = '*') {\n    this.targetOrigin = targetOrigin\n    this.setupMessageListener()\n    this.connect()\n  }\n\n  private setupMessageListener(): void {\n    window.addEventListener('message', this.handleMessage.bind(this))\n  }\n\n  private handleMessage(event: MessageEvent): void {\n    const data = event.data as HostMessage\n    if (!data || typeof data !== 'object') return\n\n    if (data.type === 'bio_response') {\n      this.handleResponse(data)\n    } else if (data.type === 'bio_event') {\n      this.handleEvent(data)\n    }\n  }\n\n  private handleResponse(message: ResponseMessage): void {\n    const pending = this.pendingRequests.get(message.id)\n    if (!pending) return\n\n    this.pendingRequests.delete(message.id)\n\n    if (message.success) {\n      pending.resolve(message.result)\n    } else {\n      const error = message.error ?? { code: BioErrorCodes.INTERNAL_ERROR, message: 'Unknown error' }\n      pending.reject(createProviderError(error.code, error.message, error.data))\n    }\n  }\n\n  private handleEvent(message: EventMessage): void {\n    this.events.emit(message.event, ...message.args)\n\n    // Handle built-in events\n    if (message.event === 'connect') {\n      this.connected = true\n    } else if (message.event === 'disconnect') {\n      this.connected = false\n    }\n  }\n\n  private connect(): void {\n    // Send handshake to host\n    this.postMessage({\n      type: 'bio_request',\n      id: this.generateId(),\n      method: 'bio_connect',\n      params: [],\n    })\n  }\n\n  private generateId(): string {\n    return `bio_${Date.now()}_${++this.requestIdCounter}`\n  }\n\n  private postMessage(message: RequestMessage): void {\n    if (window.parent === window) {\n      console.warn('[BioSDK] Not running in iframe, cannot communicate with host')\n      return\n    }\n    window.parent.postMessage(message, this.targetOrigin)\n  }\n\n  async request<T = unknown>(args: RequestArguments): Promise<T> {\n    const id = this.generateId()\n\n    return new Promise<T>((resolve, reject) => {\n      this.pendingRequests.set(id, {\n        resolve: resolve as (value: unknown) => void,\n        reject,\n      })\n\n      this.postMessage({\n        type: 'bio_request',\n        id,\n        method: args.method,\n        params: args.params,\n      })\n\n      // Timeout after 5 minutes (for user interactions)\n      setTimeout(() => {\n        if (this.pendingRequests.has(id)) {\n          this.pendingRequests.delete(id)\n          reject(createProviderError(BioErrorCodes.INTERNAL_ERROR, 'Request timeout'))\n        }\n      }, 5 * 60 * 1000)\n    })\n  }\n\n  on(event: string, handler: EventHandler): void {\n    this.events.on(event, handler)\n  }\n\n  off(event: string, handler: EventHandler): void {\n    this.events.off(event, handler)\n  }\n\n  isConnected(): boolean {\n    return this.connected\n  }\n}\n","/**\n * Ethereum Provider (EIP-1193 Compatible)\n *\n * Provides window.ethereum for EVM-compatible dApps.\n * Communicates with KeyApp host via postMessage.\n */\n\nimport { EventEmitter } from './events'\nimport { BioErrorCodes, createProviderError, type ProviderRpcError } from './types'\nimport { toHexChainId, parseHexChainId, getKeyAppChainId, EVM_CHAIN_IDS } from './chain-id'\n\n/** EIP-1193 Request Arguments */\nexport interface EthRequestArguments {\n  method: string\n  params?: unknown[] | Record<string, unknown>\n}\n\n/** EIP-1193 Provider Connect Info */\nexport interface ProviderConnectInfo {\n  chainId: string\n}\n\n/** EIP-1193 Provider Message */\nexport interface ProviderMessage {\n  type: string\n  data: unknown\n}\n\n/** Transaction request (eth_sendTransaction) */\nexport interface TransactionRequest {\n  from: string\n  to?: string\n  value?: string\n  data?: string\n  gas?: string\n  gasPrice?: string\n  maxFeePerGas?: string\n  maxPriorityFeePerGas?: string\n  nonce?: string\n}\n\n/** Message sent to host */\ninterface RequestMessage {\n  type: 'eth_request'\n  id: string\n  method: string\n  params?: unknown[]\n}\n\n/** Response from host */\ninterface ResponseMessage {\n  type: 'eth_response'\n  id: string\n  success: boolean\n  result?: unknown\n  error?: { code: number; message: string; data?: unknown }\n}\n\n/** Event from host */\ninterface EventMessage {\n  type: 'eth_event'\n  event: string\n  args: unknown[]\n}\n\ntype HostMessage = ResponseMessage | EventMessage\n\n/**\n * EIP-1193 Ethereum Provider Implementation\n */\nexport class EthereumProvider {\n  private events = new EventEmitter()\n  private pendingRequests = new Map<string, {\n    resolve: (value: unknown) => void\n    reject: (error: Error) => void\n  }>()\n  private requestIdCounter = 0\n  private connected = false\n  private currentChainId: string | null = null\n  private accounts: string[] = []\n  private readonly targetOrigin: string\n\n  // EIP-1193 required properties\n  readonly isMetaMask = false\n  readonly isKeyApp = true\n\n  constructor(targetOrigin = '*') {\n    this.targetOrigin = targetOrigin\n    this.setupMessageListener()\n  }\n\n  private setupMessageListener(): void {\n    window.addEventListener('message', this.handleMessage.bind(this))\n  }\n\n  private handleMessage(event: MessageEvent): void {\n    const data = event.data as HostMessage\n    if (!data || typeof data !== 'object') return\n\n    if (data.type === 'eth_response') {\n      this.handleResponse(data)\n    } else if (data.type === 'eth_event') {\n      this.handleEvent(data)\n    }\n  }\n\n  private handleResponse(message: ResponseMessage): void {\n    const pending = this.pendingRequests.get(message.id)\n    if (!pending) return\n\n    this.pendingRequests.delete(message.id)\n\n    if (message.success) {\n      pending.resolve(message.result)\n    } else {\n      const error = message.error ?? { code: BioErrorCodes.INTERNAL_ERROR, message: 'Unknown error' }\n      pending.reject(createProviderError(error.code, error.message, error.data))\n    }\n  }\n\n  private handleEvent(message: EventMessage): void {\n    this.events.emit(message.event, ...message.args)\n\n    // Handle built-in events\n    if (message.event === 'connect') {\n      this.connected = true\n      const info = message.args[0] as ProviderConnectInfo\n      this.currentChainId = info?.chainId ?? null\n    } else if (message.event === 'disconnect') {\n      this.connected = false\n      this.accounts = []\n    } else if (message.event === 'chainChanged') {\n      this.currentChainId = message.args[0] as string\n    } else if (message.event === 'accountsChanged') {\n      this.accounts = message.args[0] as string[]\n    }\n  }\n\n  private generateId(): string {\n    return `eth_${Date.now()}_${++this.requestIdCounter}`\n  }\n\n  private postMessage(message: RequestMessage): void {\n    if (window.parent === window) {\n      console.warn('[EthereumProvider] Not running in iframe, cannot communicate with host')\n      return\n    }\n    window.parent.postMessage(message, this.targetOrigin)\n  }\n\n  /**\n   * EIP-1193 request method\n   */\n  async request<T = unknown>(args: EthRequestArguments): Promise<T> {\n    const { method, params } = args\n    const paramsArray = Array.isArray(params) ? params : params ? [params] : []\n\n    const id = this.generateId()\n\n    return new Promise<T>((resolve, reject) => {\n      this.pendingRequests.set(id, {\n        resolve: resolve as (value: unknown) => void,\n        reject,\n      })\n\n      this.postMessage({\n        type: 'eth_request',\n        id,\n        method,\n        params: paramsArray,\n      })\n\n      // Timeout after 5 minutes (for user interactions)\n      setTimeout(() => {\n        if (this.pendingRequests.has(id)) {\n          this.pendingRequests.delete(id)\n          reject(createProviderError(BioErrorCodes.INTERNAL_ERROR, 'Request timeout'))\n        }\n      }, 5 * 60 * 1000)\n    })\n  }\n\n  /**\n   * Subscribe to an event\n   */\n  on(event: string, handler: (...args: unknown[]) => void): this {\n    this.events.on(event, handler)\n    return this\n  }\n\n  /**\n   * Unsubscribe from an event\n   */\n  off(event: string, handler: (...args: unknown[]) => void): this {\n    this.events.off(event, handler)\n    return this\n  }\n\n  /**\n   * Alias for off (Node.js EventEmitter compatibility)\n   */\n  removeListener(event: string, handler: (...args: unknown[]) => void): this {\n    return this.off(event, handler)\n  }\n\n  /**\n   * Add listener that fires only once\n   */\n  once(event: string, handler: (...args: unknown[]) => void): this {\n    const wrapper = (...args: unknown[]) => {\n      this.off(event, wrapper)\n      handler(...args)\n    }\n    this.on(event, wrapper)\n    return this\n  }\n\n  /**\n   * EIP-1193 isConnected method\n   */\n  isConnected(): boolean {\n    return this.connected\n  }\n\n  /**\n   * Get current chain ID (cached)\n   */\n  get chainId(): string | null {\n    return this.currentChainId\n  }\n\n  /**\n   * Get selected address (first account)\n   */\n  get selectedAddress(): string | null {\n    return this.accounts[0] ?? null\n  }\n\n  // ============================================\n  // Legacy methods (for backwards compatibility)\n  // ============================================\n\n  /**\n   * @deprecated Use request({ method: 'eth_requestAccounts' })\n   */\n  async enable(): Promise<string[]> {\n    return this.request({ method: 'eth_requestAccounts' })\n  }\n\n  /**\n   * @deprecated Use request()\n   */\n  send(method: string, params?: unknown[]): Promise<unknown> {\n    return this.request({ method, params })\n  }\n\n  /**\n   * @deprecated Use request()\n   */\n  sendAsync(\n    payload: { method: string; params?: unknown[]; id?: number },\n    callback: (error: Error | null, result?: { result: unknown }) => void\n  ): void {\n    this.request({ method: payload.method, params: payload.params })\n      .then((result) => callback(null, { result }))\n      .catch((error) => callback(error))\n  }\n}\n\n// Extend Window interface\ndeclare global {\n  interface Window {\n    ethereum?: EthereumProvider\n  }\n}\n\n/**\n * Initialize and inject the Ethereum provider into window.ethereum\n */\nexport function initEthereumProvider(targetOrigin = '*'): EthereumProvider {\n  if (typeof window === 'undefined') {\n    throw new Error('[EthereumProvider] Cannot initialize: window is not defined')\n  }\n\n  if (window.ethereum) {\n    console.warn('[EthereumProvider] Provider already exists, returning existing instance')\n    return window.ethereum\n  }\n\n  const provider = new EthereumProvider(targetOrigin)\n  window.ethereum = provider\n\n  console.log('[EthereumProvider] Provider initialized')\n  return provider\n}\n","/**\n * Tron Provider (TronLink Compatible)\n *\n * Provides window.tronWeb and window.tronLink for Tron dApps.\n * Communicates with KeyApp host via postMessage.\n */\n\nimport { EventEmitter } from './events'\nimport { BioErrorCodes, createProviderError } from './types'\n\n/** Tron address format */\nexport interface TronAddress {\n  base58: string\n  hex: string\n}\n\n/** TronLink request arguments (EIP-1193 style) */\nexport interface TronRequestArguments {\n  method: string\n  params?: unknown\n}\n\n/** Message sent to host */\ninterface RequestMessage {\n  type: 'tron_request'\n  id: string\n  method: string\n  params?: unknown[]\n}\n\n/** Response from host */\ninterface ResponseMessage {\n  type: 'tron_response'\n  id: string\n  success: boolean\n  result?: unknown\n  error?: { code: number; message: string; data?: unknown }\n}\n\n/** Event from host */\ninterface EventMessage {\n  type: 'tron_event'\n  event: string\n  args: unknown[]\n}\n\ntype HostMessage = ResponseMessage | EventMessage\n\n/**\n * TronLink-compatible Provider\n */\nexport class TronLinkProvider {\n  private events = new EventEmitter()\n  private pendingRequests = new Map<string, {\n    resolve: (value: unknown) => void\n    reject: (error: Error) => void\n  }>()\n  private requestIdCounter = 0\n  private readonly targetOrigin: string\n\n  constructor(targetOrigin = '*') {\n    this.targetOrigin = targetOrigin\n    this.setupMessageListener()\n  }\n\n  private setupMessageListener(): void {\n    window.addEventListener('message', this.handleMessage.bind(this))\n  }\n\n  private handleMessage(event: MessageEvent): void {\n    const data = event.data as HostMessage\n    if (!data || typeof data !== 'object') return\n\n    if (data.type === 'tron_response') {\n      this.handleResponse(data)\n    } else if (data.type === 'tron_event') {\n      this.handleEvent(data)\n    }\n  }\n\n  private handleResponse(message: ResponseMessage): void {\n    const pending = this.pendingRequests.get(message.id)\n    if (!pending) return\n\n    this.pendingRequests.delete(message.id)\n\n    if (message.success) {\n      pending.resolve(message.result)\n    } else {\n      const error = message.error ?? { code: BioErrorCodes.INTERNAL_ERROR, message: 'Unknown error' }\n      pending.reject(createProviderError(error.code, error.message, error.data))\n    }\n  }\n\n  private handleEvent(message: EventMessage): void {\n    this.events.emit(message.event, ...message.args)\n  }\n\n  private generateId(): string {\n    return `tron_${Date.now()}_${++this.requestIdCounter}`\n  }\n\n  private postMessage(message: RequestMessage): void {\n    if (window.parent === window) {\n      console.warn('[TronLinkProvider] Not running in iframe, cannot communicate with host')\n      return\n    }\n    window.parent.postMessage(message, this.targetOrigin)\n  }\n\n  /**\n   * TronLink request method (EIP-1193 style)\n   */\n  async request<T = unknown>(args: TronRequestArguments): Promise<T> {\n    const { method, params } = args\n    const paramsArray = Array.isArray(params) ? params : params !== undefined ? [params] : []\n\n    const id = this.generateId()\n\n    return new Promise<T>((resolve, reject) => {\n      this.pendingRequests.set(id, {\n        resolve: resolve as (value: unknown) => void,\n        reject,\n      })\n\n      this.postMessage({\n        type: 'tron_request',\n        id,\n        method,\n        params: paramsArray,\n      })\n\n      // Timeout after 5 minutes\n      setTimeout(() => {\n        if (this.pendingRequests.has(id)) {\n          this.pendingRequests.delete(id)\n          reject(createProviderError(BioErrorCodes.INTERNAL_ERROR, 'Request timeout'))\n        }\n      }, 5 * 60 * 1000)\n    })\n  }\n\n  on(event: string, handler: (...args: unknown[]) => void): this {\n    this.events.on(event, handler)\n    return this\n  }\n\n  off(event: string, handler: (...args: unknown[]) => void): this {\n    this.events.off(event, handler)\n    return this\n  }\n}\n\n/**\n * TronWeb-compatible API\n * Provides the subset of TronWeb API that KeyApp supports\n */\nexport class TronWebProvider {\n  private tronLink: TronLinkProvider\n  private _ready = false\n  private _defaultAddress: TronAddress = { base58: '', hex: '' }\n\n  /** TRX operations */\n  readonly trx: TronWebTrx\n\n  constructor(tronLink: TronLinkProvider) {\n    this.tronLink = tronLink\n    this.trx = new TronWebTrx(tronLink)\n\n    // Listen for account changes\n    tronLink.on('accountsChanged', (accounts: unknown) => {\n      if (Array.isArray(accounts) && accounts.length > 0) {\n        const addr = accounts[0] as TronAddress\n        this._defaultAddress = addr\n        this._ready = true\n      } else {\n        this._defaultAddress = { base58: '', hex: '' }\n        this._ready = false\n      }\n    })\n  }\n\n  /** Whether TronWeb is ready (connected) */\n  get ready(): boolean {\n    return this._ready\n  }\n\n  /** Current default address */\n  get defaultAddress(): TronAddress {\n    return this._defaultAddress\n  }\n\n  /**\n   * Set default address (called by host after connection)\n   */\n  setAddress(address: TronAddress): void {\n    this._defaultAddress = address\n    this._ready = true\n  }\n\n  /**\n   * Check if an address is valid\n   */\n  isAddress(address: string): boolean {\n    // Basic validation: base58 starts with T, hex starts with 41\n    if (address.startsWith('T')) {\n      return address.length === 34\n    }\n    if (address.startsWith('41')) {\n      return address.length === 42\n    }\n    return false\n  }\n\n  /**\n   * Convert address to hex format\n   */\n  address = {\n    toHex: (base58: string): string => {\n      // This is a stub - actual conversion requires TronWeb library\n      // KeyApp will handle the conversion on the host side\n      return base58\n    },\n    fromHex: (hex: string): string => {\n      return hex\n    },\n  }\n}\n\n/**\n * TronWeb.trx operations\n */\nclass TronWebTrx {\n  private tronLink: TronLinkProvider\n\n  constructor(tronLink: TronLinkProvider) {\n    this.tronLink = tronLink\n  }\n\n  /**\n   * Sign a transaction\n   */\n  async sign(transaction: unknown): Promise<unknown> {\n    return this.tronLink.request({\n      method: 'tron_signTransaction',\n      params: transaction,\n    })\n  }\n\n  /**\n   * Send raw transaction (broadcast)\n   */\n  async sendRawTransaction(signedTransaction: unknown): Promise<unknown> {\n    return this.tronLink.request({\n      method: 'tron_sendRawTransaction',\n      params: signedTransaction,\n    })\n  }\n\n  /**\n   * Get account balance\n   */\n  async getBalance(address: string): Promise<number> {\n    return this.tronLink.request({\n      method: 'tron_getBalance',\n      params: address,\n    })\n  }\n\n  /**\n   * Get account info\n   */\n  async getAccount(address: string): Promise<unknown> {\n    return this.tronLink.request({\n      method: 'tron_getAccount',\n      params: address,\n    })\n  }\n}\n\n// Extend Window interface\ndeclare global {\n  interface Window {\n    tronLink?: TronLinkProvider\n    tronWeb?: TronWebProvider\n  }\n}\n\n/**\n * Initialize and inject the Tron providers\n */\nexport function initTronProvider(targetOrigin = '*'): { tronLink: TronLinkProvider; tronWeb: TronWebProvider } {\n  if (typeof window === 'undefined') {\n    throw new Error('[TronProvider] Cannot initialize: window is not defined')\n  }\n\n  if (window.tronLink && window.tronWeb) {\n    console.warn('[TronProvider] Providers already exist, returning existing instances')\n    return { tronLink: window.tronLink, tronWeb: window.tronWeb }\n  }\n\n  const tronLink = new TronLinkProvider(targetOrigin)\n  const tronWeb = new TronWebProvider(tronLink)\n\n  window.tronLink = tronLink\n  window.tronWeb = tronWeb\n\n  console.log('[TronProvider] Providers initialized')\n  return { tronLink, tronWeb }\n}\n","/**\n * Chain ID utilities\n * Maps between KeyApp internal chain IDs and standard chain IDs\n */\n\n/** EVM Chain ID mapping (decimal) */\nexport const EVM_CHAIN_IDS: Record<string, number> = {\n  ethereum: 1,\n  binance: 56,\n  // Future chains\n  // polygon: 137,\n  // arbitrum: 42161,\n  // optimism: 10,\n} as const\n\n/** Reverse mapping: EVM chainId -> KeyApp chain ID */\nexport const EVM_CHAIN_ID_TO_KEYAPP: Record<number, string> = Object.fromEntries(\n  Object.entries(EVM_CHAIN_IDS).map(([key, value]) => [value, key])\n)\n\n/** API chain name to KeyApp chain ID mapping */\nexport const API_CHAIN_TO_KEYAPP: Record<string, string> = {\n  ETH: 'ethereum',\n  BSC: 'binance',\n  TRON: 'tron',\n  BFMCHAIN: 'bfmeta',\n  BFCHAIN: 'bfchain',\n  // Lowercase variants\n  eth: 'ethereum',\n  bsc: 'binance',\n  tron: 'tron',\n  bfmchain: 'bfmeta',\n  bfchain: 'bfchain',\n} as const\n\n/** KeyApp chain ID to display name */\nexport const CHAIN_DISPLAY_NAMES: Record<string, string> = {\n  ethereum: 'Ethereum',\n  binance: 'BNB Smart Chain',\n  tron: 'Tron',\n  bfmeta: 'BFMeta',\n  bfchain: 'BFChain',\n} as const\n\n/**\n * Convert decimal chain ID to hex string (EIP-155 format)\n * @example toHexChainId(56) => '0x38'\n */\nexport function toHexChainId(chainId: number): string {\n  return `0x${chainId.toString(16)}`\n}\n\n/**\n * Parse hex chain ID to decimal\n * @example parseHexChainId('0x38') => 56\n */\nexport function parseHexChainId(hexChainId: string): number {\n  if (!hexChainId.startsWith('0x')) {\n    throw new Error(`Invalid hex chain ID: ${hexChainId}`)\n  }\n  return parseInt(hexChainId, 16)\n}\n\n/**\n * Get KeyApp chain ID from EVM hex chain ID\n * @example getKeyAppChainId('0x38') => 'binance'\n */\nexport function getKeyAppChainId(hexChainId: string): string | null {\n  const decimal = parseHexChainId(hexChainId)\n  return EVM_CHAIN_ID_TO_KEYAPP[decimal] ?? null\n}\n\n/**\n * Get EVM hex chain ID from KeyApp chain ID\n * @example getEvmChainId('binance') => '0x38'\n */\nexport function getEvmChainId(keyAppChainId: string): string | null {\n  const decimal = EVM_CHAIN_IDS[keyAppChainId]\n  return decimal ? toHexChainId(decimal) : null\n}\n\n/**\n * Check if a chain is EVM compatible\n */\nexport function isEvmChain(chainId: string): boolean {\n  return chainId in EVM_CHAIN_IDS\n}\n\n/**\n * Normalize API chain name to KeyApp chain ID\n * @example normalizeChainId('BSC') => 'binance'\n */\nexport function normalizeChainId(chainName: string): string {\n  return API_CHAIN_TO_KEYAPP[chainName] ?? chainName.toLowerCase()\n}\n","/**\n * Bio SDK - Client SDK for Bio Ecosystem MiniApps\n *\n * Injects providers for multi-chain dApp support:\n * - `window.bio` - BioChain + KeyApp wallet features\n * - `window.ethereum` - EVM-compatible chains (ETH, BSC)\n * - `window.tronWeb` / `window.tronLink` - Tron chain\n *\n * @example\n * ```typescript\n * import '@biochain/bio-sdk'\n *\n * // BioChain operations\n * const accounts = await window.bio.request({ method: 'bio_requestAccounts' })\n *\n * // EVM operations (ETH, BSC)\n * const ethAccounts = await window.ethereum.request({ method: 'eth_requestAccounts' })\n *\n * // Tron operations\n * const tronAccounts = await window.tronLink.request({ method: 'tron_requestAccounts' })\n * ```\n */\n\nimport { BioProviderImpl } from './provider'\nimport { EthereumProvider, initEthereumProvider } from './ethereum-provider'\nimport { TronLinkProvider, TronWebProvider, initTronProvider } from './tron-provider'\nimport type { BioProvider } from './types'\n\n// Re-export types\nexport * from './types'\nexport * from './chain-id'\nexport { EventEmitter } from './events'\nexport { BioProviderImpl } from './provider'\nexport { EthereumProvider, initEthereumProvider } from './ethereum-provider'\nexport { TronLinkProvider, TronWebProvider, initTronProvider } from './tron-provider'\n\n// Extend Window interface (bio is declared in types.ts already for ethereum/tron)\ndeclare global {\n  interface Window {\n    bio?: BioProvider\n  }\n}\n\n/**\n * Initialize and inject the Bio provider into window.bio\n */\nexport function initBioProvider(targetOrigin = '*'): BioProvider {\n  if (typeof window === 'undefined') {\n    throw new Error('[BioSDK] Cannot initialize: window is not defined')\n  }\n\n  if (window.bio) {\n    console.warn('[BioSDK] Provider already exists, returning existing instance')\n    return window.bio\n  }\n\n  const provider = new BioProviderImpl(targetOrigin)\n  window.bio = provider\n\n  console.log('[BioSDK] Provider initialized')\n  return provider\n}\n\n/**\n * Initialize all providers (bio, ethereum, tron)\n */\nexport function initAllProviders(targetOrigin = '*'): {\n  bio: BioProvider\n  ethereum: EthereumProvider\n  tronLink: TronLinkProvider\n  tronWeb: TronWebProvider\n} {\n  const bio = initBioProvider(targetOrigin)\n  const ethereum = initEthereumProvider(targetOrigin)\n  const { tronLink, tronWeb } = initTronProvider(targetOrigin)\n\n  return { bio, ethereum, tronLink, tronWeb }\n}\n\n// Auto-initialize if running in browser\nif (typeof window !== 'undefined') {\n  const init = () => {\n    initBioProvider()\n    initEthereumProvider()\n    initTronProvider()\n  }\n\n  // Use a slight delay to ensure DOM is ready\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', init)\n  } else {\n    init()\n  }\n}\n"],"names":[],"mappings":"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"}